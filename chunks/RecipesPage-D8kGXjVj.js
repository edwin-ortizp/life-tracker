import{j as e}from"./ui-vendor-DGxrBG5B.js";import{r as i}from"./react-vendor-B6CgFIIW.js";import{C as V,c as U,a as Z,b as J,e as Q,P as Y}from"./PageLayout-Db-iUE0_.js";import{B as w}from"../assets/index-DHFvqX11.js";import{I as f}from"./input-DS5ck5rx.js";import{S as F,a as D,b as R,c as E,d as h}from"./select-B0o55zn9.js";import{M as z,u as _}from"./useRecipes-ByivUohq.js";import{D as K,a as W,b as X,c as ee,d as se}from"./dialog-D_bWg3ym.js";import{L as d}from"./label-J6Ezm96h.js";import{T as k}from"./textarea-DHVXqkMl.js";import{h as ae}from"./chart-vendor-DS0HZnUf.js";import"./firebase-B1tATv4n.js";import"./utils-vendor-zid8MmOQ.js";import"./index-4hsSYOGr.js";const te=({open:m,onOpenChange:g,onSave:v,recipe:t})=>{const[u,x]=i.useState(""),[o,l]=i.useState(""),[p,r]=i.useState(""),[C,j]=i.useState(""),[S,N]=i.useState("fácil"),[y,s]=i.useState(""),[n,c]=i.useState(""),[b,I]=i.useState(""),[B,L]=i.useState(""),[O,A]=i.useState(""),[q,M]=i.useState("breakfast");i.useEffect(()=>{t?(x(t.name),l(t.description||""),r(t.ingredients.map(a=>`${a.quantity} ${a.name}`).join(`
`)),j(t.instructions),N(t.difficulty||"fácil"),s(t.prepTime!==void 0?String(t.prepTime):""),c(String(t.nutrition.calories)),I(String(t.nutrition.protein)),L(String(t.nutrition.carbs)),A(String(t.nutrition.fat)),M(t.mealType)):(x(""),l(""),r(""),j(""),N("fácil"),s(""),c(""),I(""),L(""),A(""),M("breakfast"))},[t,m]);const G=()=>{const a=p.split(`
`).map(P=>P.trim()).filter(Boolean).map(P=>{const[$,...H]=P.split(" ");return{quantity:$,name:H.join(" ")}}),T={name:u,ingredients:a,description:o.trim()||void 0,difficulty:S,prepTime:y?Number(y):void 0,instructions:C,nutrition:{calories:Number(n)||0,protein:Number(b)||0,carbs:Number(B)||0,fat:Number(O)||0},mealType:q};t?v(T,t.id):v(T),g(!1)};return e.jsx(K,{open:m,onOpenChange:g,children:e.jsxs(W,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(X,{children:e.jsxs(ee,{children:[t?"Editar":"Agregar"," Receta"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"name",children:"Nombre"}),e.jsx(f,{id:"name",value:u,onChange:a=>x(a.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"description",children:"Descripción (opcional)"}),e.jsx(k,{id:"description",value:o,onChange:a=>l(a.target.value),className:"min-h-[80px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"difficulty",children:"Dificultad"}),e.jsxs(F,{value:S,onValueChange:a=>N(a),children:[e.jsx(D,{id:"difficulty",children:e.jsx(R,{})}),e.jsxs(E,{children:[e.jsx(h,{value:"fácil",children:"Fácil"}),e.jsx(h,{value:"media",children:"Media"}),e.jsx(h,{value:"difícil",children:"Difícil"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"prepTime",children:"Tiempo (min)"}),e.jsx(f,{id:"prepTime",type:"number",value:y,onChange:a=>s(a.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"ingredients",children:"Ingredientes (uno por línea)"}),e.jsx(k,{id:"ingredients",value:p,onChange:a=>r(a.target.value),className:"min-h-[120px]"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"instructions",children:"Instrucciones"}),e.jsx(k,{id:"instructions",value:C,onChange:a=>j(a.target.value),className:"min-h-[120px]"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"calories",children:"Calorías"}),e.jsx(f,{id:"calories",type:"number",value:n,onChange:a=>c(a.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"protein",children:"Proteína (g)"}),e.jsx(f,{id:"protein",type:"number",value:b,onChange:a=>I(a.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"carbs",children:"Carbs (g)"}),e.jsx(f,{id:"carbs",type:"number",value:B,onChange:a=>L(a.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"fat",children:"Grasa (g)"}),e.jsx(f,{id:"fat",type:"number",value:O,onChange:a=>A(a.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{htmlFor:"mealType",children:"Tipo de comida"}),e.jsxs(F,{value:q,onValueChange:a=>M(a),children:[e.jsx(D,{id:"mealType",children:e.jsx(R,{})}),e.jsx(E,{children:Object.entries(z).map(([a,T])=>e.jsx(h,{value:a,children:T.title},a))})]})]})]}),e.jsx(se,{children:e.jsx(w,{onClick:G,children:"Guardar"})})]})})},ie=({recipes:m})=>{const g=()=>{const v=m.reduce((l,p)=>{const r=p.mealType;return l[r]||(l[r]=[]),l[r].push(p),l},{}),t=JSON.stringify(v,null,2),u=new Blob([t],{type:"application/json"}),x=URL.createObjectURL(u),o=document.createElement("a");o.href=x,o.download="recipes.json",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(x)};return e.jsxs(w,{variant:"outline",size:"sm",onClick:g,className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Exportar recetas"]})},ne=()=>{const{recipes:m,addRecipe:g,updateRecipe:v}=_(),[t,u]=i.useState(!1),[x,o]=i.useState(null),[l,p]=i.useState(""),[r,C]=i.useState(""),[j,S]=i.useState("az"),N=i.useMemo(()=>{let s=m.filter(c=>c.name.toLowerCase().includes(l.toLowerCase()));r&&(s=s.filter(c=>c.mealType===r));const n=[...s];return n.sort((c,b)=>j==="az"?c.name.localeCompare(b.name):b.name.localeCompare(c.name)),n},[m,l,r,j]),y=(s,n)=>{n?v(n,s):g(s)};return e.jsxs(V,{className:"w-full h-full flex flex-col",children:[e.jsxs(U,{className:"p-4 space-y-4 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Recetas"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ie,{recipes:m}),e.jsx(w,{onClick:()=>u(!0),children:"Agregar"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[e.jsx(f,{placeholder:"Buscar",value:l,onChange:s=>p(s.target.value),className:"sm:w-60"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(F,{value:j,onValueChange:s=>S(s),children:[e.jsx(D,{className:"w-32",children:e.jsx(R,{placeholder:"Ordenar"})}),e.jsxs(E,{children:[e.jsx(h,{value:"az",children:"Nombre A-Z"}),e.jsx(h,{value:"za",children:"Nombre Z-A"})]})]}),e.jsxs(F,{value:r||"all",onValueChange:s=>C(s==="all"?"":s),children:[e.jsx(D,{className:"w-40",children:e.jsx(R,{placeholder:"Tipo"})}),e.jsxs(E,{children:[e.jsx(h,{value:"all",children:"Todos"}),Object.entries(z).map(([s,n])=>e.jsx(h,{value:s,children:n.title},s))]})]})]})]}),N.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No hay recetas guardadas"}):e.jsx("div",{className:"space-y-4",children:N.map(s=>e.jsxs(V,{children:[e.jsxs(Z,{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(J,{className:"text-base",children:s.name}),e.jsx(Q,{children:z[s.mealType].title})]}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{o(s),u(!0)},children:"Editar"})]}),e.jsxs(U,{className:"space-y-2",children:[s.description&&e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.description}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Dificultad:"})," ",s.difficulty||"N/A"," |"," ",e.jsx("span",{className:"font-medium",children:"Tiempo:"})," ",s.prepTime?`${s.prepTime} min`:"N/A"]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Ingredientes:"}),e.jsx("ul",{className:"list-disc pl-4 text-sm",children:s.ingredients.map((n,c)=>e.jsxs("li",{children:[n.quantity," ",n.name]},c))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Instrucciones:"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.instructions})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Información Nutricional:"}),e.jsxs("p",{className:"text-sm",children:[s.nutrition.calories," kcal |"," ",s.nutrition.protein,"g P |"," ",s.nutrition.carbs,"g C |"," ",s.nutrition.fat,"g G"]})]})]})]},s.id))})]}),e.jsx(te,{open:t,onOpenChange:s=>{s||o(null),u(s)},onSave:y,recipe:x||void 0})]})},Ne=()=>e.jsx(Y,{noPadding:!0,className:"h-full",children:e.jsx(ne,{})});export{Ne as default};
