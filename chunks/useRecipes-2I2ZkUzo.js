import{ad as h,ac as T,U as b,as as E,ae as C}from"./chart-vendor-DS0HZnUf.js";import{r as c}from"./react-vendor-B6CgFIIW.js";import{u as R,d}from"../assets/index-CZllZBvh.js";import{q as S,w as A,l as p,h as D,k as u,t as M,e as m,u as k,n as w}from"./firebase-B1tATv4n.js";const _={breakfast:{icon:h,title:"Desayuno",color:"bg-amber-100",hoverColor:"hover:bg-amber-200",order:1},morningSnack:{icon:T,title:"Media MaÃ±ana",color:"bg-orange-100",hoverColor:"hover:bg-orange-200",order:2},lunch:{icon:b,title:"Almuerzo",color:"bg-emerald-100",hoverColor:"hover:bg-emerald-200",order:3},afternoonSnack:{icon:E,title:"Merienda",color:"bg-purple-100",hoverColor:"hover:bg-purple-200",order:4},dinner:{icon:C,title:"Cena",color:"bg-indigo-100",hoverColor:"hover:bg-indigo-200",order:5}},j=()=>{const{user:a}=R(),[v,l]=c.useState([]),[g,o]=c.useState("idle"),[y,n]=c.useState(null);return c.useEffect(()=>{if(!a){l([]);return}o("loading");const i=S(p(d,"recipes"),A("userId","==",a.uid)),e=D(i,s=>{const t=s.docs.map(f=>{const r=f.data();return{id:f.id,name:r.name,ingredients:r.ingredients||[],instructions:r.instructions||"",nutrition:r.nutrition||{calories:0,protein:0,carbs:0,fat:0},mealType:r.mealType,...r.description&&{description:r.description},...r.difficulty&&{difficulty:r.difficulty},...r.prepTime!==void 0&&{prepTime:r.prepTime},...r.favorite!==void 0&&{favorite:r.favorite}}});l(t),o("idle")},s=>{n(s instanceof Error?s.message:"Error al cargar"),o("error")});return()=>e()},[a]),{recipes:v,status:g,error:y,addRecipe:async i=>{if(!a){n("Usuario no autenticado");return}o("saving"),n(null);try{const e={name:i.name,ingredients:i.ingredients,instructions:i.instructions,nutrition:i.nutrition,mealType:i.mealType,userId:a.uid,createdAt:u(),updatedAt:u()};i.description&&(e.description=i.description),i.difficulty&&(e.difficulty=i.difficulty),i.prepTime!==void 0&&(e.prepTime=i.prepTime),i.favorite!==void 0&&(e.favorite=i.favorite),await M(p(d,"recipes"),e),o("idle")}catch(e){n(e instanceof Error?e.message:"Error al guardar"),o("error")}},updateRecipe:async(i,e)=>{if(!a){n("Usuario no autenticado");return}o("saving"),n(null);try{const s=m(d,"recipes",i),t={updatedAt:u()};e.name!==void 0&&(t.name=e.name),e.ingredients!==void 0&&(t.ingredients=e.ingredients),e.instructions!==void 0&&(t.instructions=e.instructions),e.nutrition!==void 0&&(t.nutrition=e.nutrition),e.mealType!==void 0&&(t.mealType=e.mealType),e.description!==void 0&&(t.description=e.description),e.difficulty!==void 0&&(t.difficulty=e.difficulty),e.prepTime!==void 0&&(t.prepTime=e.prepTime),e.favorite!==void 0&&(t.favorite=e.favorite),await k(s,t),o("idle")}catch(s){n(s instanceof Error?s.message:"Error al actualizar"),o("error")}},deleteRecipe:async i=>{if(!a){n("Usuario no autenticado");return}o("saving"),n(null);try{await w(m(d,"recipes",i)),o("idle")}catch(e){n(e instanceof Error?e.message:"Error al eliminar"),o("error")}}}};export{_ as M,j as u};
