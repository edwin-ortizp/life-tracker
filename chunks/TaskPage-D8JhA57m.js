import{j as e}from"./ui-vendor-DGxrBG5B.js";import{r as i}from"./react-vendor-B6CgFIIW.js";import{T as Ge,a as He,b as Y,c as U}from"./tabs-ByakvzMK.js";import{C as W,c as q,a as Pe,b as Re,P as Ne}from"./PageLayout-FLWEEaav.js";import{a as Ye,T as Ue}from"./index-DWb4v-pl.js";import{B as E,a as be,u as Je,d as Qe}from"../assets/index-B6EFx1d9.js";import{q as Xe,p as Ze,r as es,w as ss,l as as,m as ts}from"./firebase-B1tATv4n.js";import{C as ce,a as ls,T as Be,B as rs,b as ns}from"./TaskAiReprioritize-1jrcuOej.js";import{S as I,a as P,b as R,c as B,d as O}from"./select-CTSe6FW1.js";import{I as is}from"./input-CcWp4fVQ.js";import"./textarea-D04ZjWHU.js";import"./dialog-k0qgUnZO.js";import{t as J}from"./dates-LQzD1DbF.js";import{f as we}from"./formatTime-BWrFzjSW.js";import{H as De,a5 as os,X as me,a6 as ds,_ as cs,t as xe,R as Te,k as ms,l as us,m as xs,Y as hs,n as Se,N as ps,o as ke,P as js,p as fs,q as gs}from"./chart-vendor-DS0HZnUf.js";import{j as _,m as ys,n as ue,s as vs,e as Ns,q as Q,i as z,r as F,t as le,u as bs}from"./utils-vendor-zid8MmOQ.js";import{u as Fe,R as $e,T as Ve}from"./useTaskData-Lf6Jc_fm.js";import"./progress-BiVUpgIE.js";import"./tokens-lK1rltPv.js";import"./marked.esm-BiyRy7sW.js";import"./alert-dialog-Ca0SjAEQ.js";import"./ai-9sQAZSA0.js";import"./MoodAiSuggestion-BvXqNA2B.js";import"./index-DuocBWKh.js";import"./accordion-BNO5WezD.js";import"./alert-C-AwMOWp.js";import"./index-4hsSYOGr.js";import"./checkbox-CR16L7R9.js";const Ce={all:"Todas las fechas",today:"Hoy",tomorrow:"Mañana",week:"Esta semana",month:"Este mes",overdue:"Vencidas",noDate:"Sin fecha"},Oe={all:"Todas",do:"do",decide:"decide",delegate:"delegate",delete:"delete"},Ee={all:"Todas",none:"Sin tamaño",pequeña:"pequeña",mediana:"mediana",grande:"grande"},re={all:"Todas",yes:"Sí",no:"No"},Ae={all:"Todas",t60:"≤1h",t120:"≤2h",t180:"≤3h",none:"Sin estimación"},Le={default:"Predeterminado",priorityAsc:"Prioridad ↓",priorityDesc:"Prioridad ↑",durationAsc:"Duración ↓",durationDesc:"Duración ↑"},ws=({tasks:f,onToggle:v,onDelete:N,onEdit:D,onView:p,onMove:c,onAdd:S,onFilteredTasksChange:x})=>{const[T,g]=i.useState(null),[o,b]=i.useState("all"),[l,m]=i.useState("today"),[u,j]=i.useState("all"),[h,w]=i.useState("all"),[n,k]=i.useState("all"),[d,A]=i.useState("all"),[C,he]=i.useState("all"),[X,pe]=i.useState("default"),[je,_e]=i.useState(!1),[$,ne]=i.useState(""),L=i.useMemo(()=>{let s=f.filter(a=>!a.isRecurrent&&!a.isPrivate);if($.trim()){const a=$.toLowerCase().trim();s=s.filter(r=>r.title.toLowerCase().includes(a)||r.description&&r.description.toLowerCase().includes(a))}if(o!=="all"&&(s=s.filter(a=>a.category===o)),u!=="all"&&(s=s.filter(a=>a.priority===u)),h!=="all"&&(h==="none"?s=s.filter(a=>!a.size):s=s.filter(a=>a.size===h)),C!=="all")if(C==="none")s=s.filter(a=>a.estimatedTime===void 0);else{const r={t60:60,t120:120,t180:180,all:1/0,none:0}[C];s=s.filter(M=>(M.estimatedTime??1/0)<=r)}n!=="all"&&(s=s.filter(a=>{const r=a.priority==="do"||a.priority==="delegate";return n==="yes"?r:!r})),d!=="all"&&(s=s.filter(a=>{const r=a.priority==="do"||a.priority==="decide";return d==="yes"?r:!r}));const t=new Date,y=_(t),G=ys(t),ie=ue(t),oe=vs(t),se=Ns(t),H=Q(y,1),de=z(H);switch(l){case"today":return s.filter(a=>a.dueDate&&le(a.dueDate,{start:y,end:z(t)}));case"tomorrow":return s.filter(a=>a.dueDate&&le(a.dueDate,{start:H,end:de}));case"week":return s.filter(a=>a.dueDate&&le(a.dueDate,{start:G,end:ie}));case"month":return s.filter(a=>a.dueDate&&le(a.dueDate,{start:oe,end:se}));case"overdue":return s.filter(a=>a.dueDate&&F(a.dueDate,y));case"noDate":return s.filter(a=>!a.dueDate);default:return s}},[f,o,u,h,n,d,C,l,$]);i.useEffect(()=>{x==null||x(L)},[L,x]);const K=i.useMemo(()=>$.trim()!==""||o!=="all"||l!=="today"||u!=="all"||h!=="all"||n!=="all"||d!=="all"||C!=="all",[$,o,l,u,h,n,d,C]),fe=()=>{ne(""),b("all"),m("today"),j("all"),w("all"),k("all"),A("all"),he("all"),pe("default")},Z=i.useMemo(()=>{const s=new Date,t=_(s),y=z(s),G=Q(_(s),1),ie=z(G),oe=ue(s),se={do:0,decide:1,delegate:2,delete:3},H=L.reduce((a,r)=>(r.dueDate&&F(r.dueDate,t)?a.overdue.push(r):r.dueDate?F(r.dueDate,y)?a.today.push(r):F(r.dueDate,ie)?a.tomorrow.push(r):F(r.dueDate,oe)?a.thisWeek.push(r):a.future.push(r):a.noDate.push(r),a),{overdue:[],today:[],tomorrow:[],thisWeek:[],future:[],noDate:[]}),de=(a,r)=>{var ye,ve;const M=se[a.priority||"none"]??4,V=se[r.priority||"none"]??4,ae=a.estimatedTime??1/0,te=r.estimatedTime??1/0;switch(X){case"priorityAsc":if(M!==V)return V-M;break;case"priorityDesc":if(M!==V)return M-V;break;case"durationAsc":if(ae!==te)return ae-te;break;case"durationDesc":if(ae!==te)return te-ae;break;default:if(M!==V)return M-V}return a.dueDate&&r.dueDate?a.dueDate.getTime()-r.dueDate.getTime():!a.dueDate&&!r.dueDate?(((ye=r.createdAt)==null?void 0:ye.seconds)||0)-(((ve=a.createdAt)==null?void 0:ve.seconds)||0):a.dueDate?-1:1};return Object.values(H).forEach(a=>{a.sort(de)}),H},[L,X]),ee=i.useMemo(()=>{const s={overdue:0,today:0,tomorrow:0,thisWeek:0,future:0,noDate:0};return Object.keys(Z).forEach(t=>{s[t]=Z[t].reduce((y,G)=>y+(G.estimatedTime||0),0)}),s},[Z]),ze=i.useMemo(()=>Object.values(ee).reduce((s,t)=>s+t,0),[ee]),We=[{key:"overdue",title:"Vencidas"},{key:"today",title:"Para Hoy"},{key:"tomorrow",title:"Mañana"},{key:"thisWeek",title:"Esta Semana"},{key:"future",title:"Próximamente"},{key:"noDate",title:"Sin Fecha"}],ge=s=>{const t=new Date;switch(s){case"overdue":return J(Q(_(t),-1));case"today":return J(t);case"tomorrow":return J(Q(_(t),1));case"thisWeek":return J(ue(t));case"future":return J(bs(t,1));case"noDate":default:return null}},qe=s=>{T&&(c(T.id,ge(s)),g(null))},Ke=()=>{const s=L.map(y=>({nombre:y.title,descripción:y.description||"",categoria:ce[y.category],prioridad:y.priority||"sin prioridad",tamaño:y.size||"sin tamaño",fecha:y.dueDate?new Date(y.dueDate).toLocaleDateString("es-ES"):"sin fecha",completada:y.completed?"Sí":"No"})),t=JSON.stringify(s,null,2);navigator.clipboard.writeText(t).then(()=>{be.success(`${s.length} tareas filtradas copiadas al portapapeles`)}).catch(()=>{be.error("Error al copiar las tareas")})};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-end items-center text-xs text-gray-500 gap-1",children:[e.jsx(De,{className:"w-3 h-3"}),we(ze)]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 items-stretch sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(is,{placeholder:"Buscar tareas por nombre...",value:$,onChange:s=>ne(s.target.value),className:"pl-10 pr-10"}),$&&e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>ne(""),className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(me,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"md:hidden flex gap-2",children:[e.jsxs(E,{variant:K?"default":"outline",onClick:()=>_e(!je),className:`flex items-center gap-2 ${K?"bg-blue-600 hover:bg-blue-700":""}`,children:[e.jsx(ds,{className:"w-4 h-4"}),"Filtros",K&&e.jsx("span",{className:"bg-white text-blue-600 rounded-full px-2 py-0.5 text-xs font-medium",children:"Activos"})]}),K&&e.jsx(E,{variant:"ghost",onClick:fe,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(me,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"hidden md:flex",children:K&&e.jsxs(E,{variant:"ghost",onClick:fe,className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Limpiar filtros"]})})]}),e.jsx("div",{className:`${je?"block":"hidden md:block"}`,children:e.jsxs("div",{className:"flex flex-wrap items-end gap-3 md:gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Categoría"}),e.jsxs(I,{value:o,onValueChange:s=>b(s),children:[e.jsx(P,{className:`w-32 ${o!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{children:o==="all"?"Todas":ce[o]})}),e.jsxs(B,{children:[e.jsx(O,{value:"all",children:"Todas"}),Object.values(ls).map(s=>e.jsx(O,{value:s,children:ce[s]},s))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Fecha"}),e.jsxs(I,{value:l,onValueChange:s=>m(s),children:[e.jsx(P,{className:`w-32 ${l!=="today"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{children:Ce[l]})}),e.jsx(B,{children:Object.entries(Ce).map(([s,t])=>e.jsx(O,{value:s,children:t},s))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Prioridad"}),e.jsxs(I,{value:u,onValueChange:s=>j(s),children:[e.jsx(P,{className:`w-24 ${u!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{children:Oe[u]})}),e.jsx(B,{children:Object.entries(Oe).map(([s,t])=>e.jsx(O,{value:s,children:t},s))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Tamaño"}),e.jsxs(I,{value:h,onValueChange:s=>w(s),children:[e.jsx(P,{className:`w-24 ${h!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{children:Ee[h]})}),e.jsx(B,{children:Object.entries(Ee).map(([s,t])=>e.jsx(O,{value:s,children:t},s))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Urgente"}),e.jsxs(I,{value:n,onValueChange:s=>k(s),children:[e.jsx(P,{className:`w-20 ${n!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{children:re[n]})}),e.jsx(B,{children:Object.entries(re).map(([s,t])=>e.jsx(O,{value:s,children:t},s))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Importante"}),e.jsxs(I,{value:d,onValueChange:s=>A(s),children:[e.jsx(P,{className:`w-20 ${d!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{children:re[d]})}),e.jsx(B,{children:Object.entries(re).map(([s,t])=>e.jsx(O,{value:s,children:t},s))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Estimado"}),e.jsxs(I,{value:C,onValueChange:s=>he(s),children:[e.jsx(P,{className:`w-24 ${C!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(R,{children:Ae[C]})}),e.jsx(B,{children:Object.entries(Ae).map(([s,t])=>e.jsx(O,{value:s,children:t},s))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ordenar"}),e.jsxs(I,{value:X,onValueChange:s=>pe(s),children:[e.jsx(P,{className:"w-28",children:e.jsx(R,{children:Le[X]})}),e.jsx(B,{children:Object.entries(Le).map(([s,t])=>e.jsx(O,{value:s,children:t},s))})]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Exportar filtradas"}),e.jsxs(E,{variant:"outline",size:"sm",onClick:Ke,className:"flex items-center gap-1 min-w-fit",disabled:L.length===0,title:`Copia al portapapeles las ${L.length} tareas que se muestran actualmente con todos los filtros aplicados`,children:[e.jsx(cs,{className:"w-3 h-3"}),e.jsxs("span",{className:"whitespace-nowrap",children:["Copiar visibles (",L.length,")"]})]})]})})]})}),e.jsx("div",{className:"flex flex-col lg:flex-row items-start gap-2 lg:gap-4 overflow-x-auto pb-2 p-2 lg:p-3 rounded bg-gradient-to-br from-blue-50 via-indigo-50 to-indigo-100",children:We.map(s=>e.jsxs("div",{className:"w-full lg:w-[16rem] xl:w-[18rem] lg:flex-shrink-0 space-y-2",onDragOver:t=>t.preventDefault(),onDrop:()=>qe(s.key),children:[e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("h3",{className:"font-medium text-xs lg:text-sm text-gray-500 uppercase tracking-wider flex items-center gap-1",children:[s.title,ee[s.key]>0&&e.jsxs("span",{className:"text-[10px] text-gray-400 flex items-center gap-1",children:[e.jsx(De,{className:"w-3 h-3"}),we(ee[s.key])]})]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(E,{size:"icon",variant:"ghost",onClick:()=>S(ge(s.key)),className:"h-6 w-6 lg:h-8 lg:w-8",children:e.jsx(xe,{className:"w-3 h-3 lg:w-4 lg:h-4"})})})]}),Z[s.key].map(t=>e.jsx("div",{draggable:!0,onDragStart:()=>g(t),onDragEnd:()=>g(null),children:e.jsx(Be,{task:t,onToggle:v,onDelete:N,onEdit:D,onView:p,onMove:c,variant:"kanban",showCategoryLabel:o==="all"})},t.id))]},s.key))})]})},Ds={do:{color:"bg-red-500",text:"Hacer (urgente + importante)",label:"🔥 do"},decide:{color:"bg-orange-500",text:"Decidir (importante)",label:"🤔 decide"},delegate:{color:"bg-blue-500",text:"Delegar (urgente)",label:"📤 delegate"},delete:{color:"bg-gray-400",text:"Eliminar (sin prioridad)",label:"🗑️ delete"}},Ts=()=>e.jsxs("div",{className:"mt-6 text-sm",children:[e.jsx("h2",{className:"font-medium mb-2",children:"Convenciones de prioridad"}),e.jsx("ul",{className:"space-y-1",children:Object.entries(Ds).map(([f,v])=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:`text-xs font-normal px-2 py-0.5 text-white ${v.color}`,children:v.label}),e.jsx("span",{children:v.text})]},f))})]}),Me={morning:"🌅",afternoon:"🏙️",evening:"🌙"},Ss=({task:f,onAssign:v,onView:N})=>{const D=(p,c)=>{p.stopPropagation(),v(f.id,c)};return e.jsx(W,{onClick:()=>N==null?void 0:N(f),className:"bg-white hover:shadow p-2 cursor-pointer space-y-2",children:e.jsxs(q,{className:"p-0 space-y-2",children:[e.jsx("span",{className:"text-sm font-medium break-words line-clamp-2 block",children:f.title}),e.jsx("div",{className:"flex gap-1",children:Object.keys(Me).map(p=>e.jsx(E,{size:"icon",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-muted",title:`Asignar a ${p}`,onClick:c=>D(c,p),children:Me[p]},p))})]})})},ks=["morning","afternoon","evening"],Cs=({tasks:f,onToggle:v,onDelete:N,onEdit:D,onView:p,onAssignTimeOfDay:c})=>{const S=_(new Date),x=z(S),T=Q(S,1),g=z(T),o={overdue:{morning:[],afternoon:[],evening:[]},today:{morning:[],afternoon:[],evening:[]},tomorrow:{morning:[],afternoon:[],evening:[]}},b=[];return f.forEach(l=>{if(!l.dueDate||!l.timeOfDay){b.push(l);return}F(l.dueDate,S)?o.overdue[l.timeOfDay].push(l):F(l.dueDate,x)?o.today[l.timeOfDay].push(l):F(l.dueDate,g)?o.tomorrow[l.timeOfDay].push(l):b.push(l)}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsx("div",{className:"min-w-[700px] grid grid-cols-3 gap-2",children:[{key:"overdue",label:"Vencidas"},{key:"today",label:"Hoy"},{key:"tomorrow",label:"Mañana"}].map(({key:l,label:m})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-center text-sm font-medium",children:m}),ks.map(u=>e.jsxs("div",{className:"min-h-[6rem] border rounded p-1 space-y-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:ns[u]}),o[l][u].map(j=>e.jsx(Be,{task:j,onToggle:v,onDelete:N,onEdit:D,onView:p,variant:"list"},j.id))]},u))]},l))})}),b.length>0&&e.jsxs("div",{className:"w-56 space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Sin asignar"}),b.map(l=>e.jsx(Ss,{task:l,onView:p,onAssign:c},l.id))]})]})},Os=()=>{const{tasks:f,status:v,error:N,showRecurrenceModal:D,currentTask:p,modalMode:c,addTask:S,editTask:x,toggleTask:T,deleteTask:g,completeRecurrentTask:o,setShowRecurrenceModal:b,openEditModal:l,openCreateModal:m}=Fe(),[u,j]=i.useState(null),[h,w]=i.useState(!1);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(W,{children:[e.jsx(Pe,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Re,{children:"Calendario"}),e.jsxs("div",{className:"flex items-center gap-4",children:[v==="saving"&&e.jsx("span",{className:"text-xs text-blue-500",children:"Guardando..."}),e.jsxs(E,{onClick:()=>m(),size:"sm",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Nueva Tarea"]})]})]})}),e.jsxs(q,{children:[e.jsx(Cs,{tasks:f,onToggle:T,onDelete:g,onEdit:l,onAssignTimeOfDay:(n,k)=>x(n,{timeOfDay:k}),onView:n=>{j(n),w(!0)}}),N&&e.jsx("p",{className:"text-sm text-red-500 mt-4",children:N})]})]}),e.jsx($e,{isOpen:D,onClose:()=>b(),onConfirm:n=>{c==="complete"?o(n):c==="edit"?x(p.id,n):S(n)},task:p||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:c}),e.jsx(Ve,{task:u,isOpen:h,onClose:()=>w(!1),onEdit:n=>{w(!1),l(n)}})]})},Es=()=>{const{tasks:f,status:v,error:N,showRecurrenceModal:D,currentTask:p,modalMode:c,addTask:S,editTask:x,toggleTask:T,deleteTask:g,completeRecurrentTask:o,setShowRecurrenceModal:b,openEditModal:l,openCreateModal:m}=Fe(),[u,j]=i.useState(null),[h,w]=i.useState(!1),[n,k]=i.useState([]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(W,{className:"w-full",children:[e.jsx(Pe,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Re,{children:"Tablero Kanban"}),e.jsxs("div",{className:"flex items-center gap-4",children:[v==="saving"&&e.jsx("span",{className:"text-xs text-blue-500",children:"Guardando..."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{tasks:n,onUpdate:(d,A)=>x(d,A)}),e.jsxs(E,{onClick:()=>m(),size:"sm",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Nueva Tarea"]})]})]})]})}),e.jsxs(q,{className:"overflow-x-auto",children:[e.jsx(ws,{tasks:f,onToggle:T,onDelete:g,onEdit:l,onView:d=>{j(d),w(!0)},onMove:(d,A)=>x(d,{dueDate:A??void 0}),onAdd:d=>m(d??void 0),onFilteredTasksChange:k}),N&&e.jsx("p",{className:"text-sm text-red-500 mt-4",children:N})]})]}),e.jsx($e,{isOpen:D,onClose:()=>b(),onConfirm:d=>{c==="complete"?o(d):c==="edit"?x(p.id,d):S(d)},task:p||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:c}),e.jsx(Ve,{task:u,isOpen:h,onClose:()=>w(!1),onEdit:d=>{w(!1),l(d)},onToggle:(d,A)=>T(d,A)}),e.jsx(Ts,{})]})},Ie=["#0088FE","#00C49F","#FFBB28","#FF8042"],ra=({defaultTab:f="list"})=>{const[v,N]=i.useState([]),[D,p]=i.useState([]),{user:c}=Je();i.useEffect(()=>{c&&S()},[c]);const S=async()=>{if(!c)return;const x=Xe(as(Qe,"tasks"),ss("userId","==",c.uid),es("createdAt","desc"),Ze(100)),g=(await ts(x)).docs.map(m=>m.data()),o=g.reduce((m,u)=>{var h,w,n,k;const j=((k=(n=(w=(h=u.createdAt)==null?void 0:h.toDate)==null?void 0:w.call(h))==null?void 0:n.toISOString)==null?void 0:k.call(n).split("T")[0])||"unknown";return m[j]||(m[j]={date:j,completed:0,pending:0}),m[j][u.completed?"completed":"pending"]++,m},{});N(Object.values(o));const b=g.filter(m=>m.completed).length,l=g.filter(m=>!m.completed).length;p([{name:"Completadas",value:b},{name:"Pendientes",value:l}])};return c?e.jsxs(Ne,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestor de Tareas"}),e.jsx("p",{className:"text-gray-500",children:"Organiza y gestiona tus tareas pendientes y completadas"})]}),e.jsxs(Ge,{defaultValue:f,className:"space-y-4",children:[e.jsxs(He,{children:[e.jsx(Y,{value:"list",children:"Lista de Tareas"}),e.jsx(Y,{value:"kanban",children:"Kanban"}),e.jsx(Y,{value:"analytics",children:"Análisis"}),e.jsx(Y,{value:"week",children:"Calendario"}),e.jsx(Y,{value:"settings",children:"Configuración"})]}),e.jsx(U,{value:"list",className:"space-y-4",children:e.jsx(Ue,{})}),e.jsx(U,{value:"kanban",className:"space-y-4",children:e.jsx(Es,{})}),e.jsx(U,{value:"week",className:"space-y-4",children:e.jsx(Os,{})}),e.jsx(U,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 xl:grid-cols-2 gap-4 lg:gap-6 xl:gap-8 desktop-grid-responsive",children:[e.jsx(W,{className:"desktop-card-enhanced",children:e.jsxs(q,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Progreso de Tareas"}),e.jsx("div",{className:"h-64 lg:h-80",children:e.jsx(Te,{width:"100%",height:"100%",children:e.jsxs(ms,{data:v,children:[e.jsx(us,{strokeDasharray:"3 3"}),e.jsx(xs,{dataKey:"date"}),e.jsx(hs,{}),e.jsx(Se,{}),e.jsx(ps,{}),e.jsx(ke,{type:"monotone",dataKey:"completed",name:"Completadas",stroke:"#8884d8"}),e.jsx(ke,{type:"monotone",dataKey:"pending",name:"Pendientes",stroke:"#82ca9d"})]})})})]})}),e.jsx(W,{className:"desktop-card-enhanced",children:e.jsxs(q,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Estado General"}),e.jsx("div",{className:"h-64 lg:h-80",children:e.jsx(Te,{width:"100%",height:"100%",children:e.jsxs(js,{children:[e.jsx(fs,{data:D,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({cx:x,cy:T,midAngle:g,innerRadius:o,outerRadius:b,percent:l,name:m})=>{const u=Math.PI/180,j=25+o+(b-o),h=x+j*Math.cos(-g*u),w=T+j*Math.sin(-g*u);return e.jsx("text",{x:h,y:w,fill:"#888",textAnchor:h>x?"start":"end",dominantBaseline:"central",children:`${m} (${(l*100).toFixed(0)}%)`})},children:D.map(x=>e.jsx(gs,{fill:Ie[x%Ie.length]},`cell-${x}`))}),e.jsx(Se,{})]})})})]})})]})}),e.jsx(U,{value:"settings",className:"space-y-4",children:e.jsxs(W,{children:[e.jsx(q,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Configuración de Tareas"})}),"          "]})})]})]}):e.jsx(Ne,{children:e.jsx("div",{className:"text-center py-8",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesión para ver tus tareas"})})})};export{ra as default};
