import{j as e}from"./ui-vendor-DGxrBG5B.js";import{r}from"./react-vendor-B6CgFIIW.js";import{C as H,c as J,P as Q}from"./PageLayout-Bn46ZyXr.js";import{B as S,a as U,T as K,b as V,e as M,f as _}from"../assets/index-DU2Ks861.js";import{h as Y,ao as O,ap as W,aq as X,ar as ee,u as se,g as ae,z as le,w as te}from"./chart-vendor-DS0HZnUf.js";import{T as re,a as oe,b as G,c as R}from"./tabs-bfLr-SaA.js";import{u as ne}from"./useShoppingList-D1he0Ux9.js";import{D as ce,a as ie,b as de,c as ue,d as xe}from"./dialog--KSabO_H.js";import{L as F}from"./label-B9FvmO8L.js";import{I as B}from"./input-D2so7NiP.js";import{T as he}from"./textarea-BoOEmm0d.js";import{S as C,a as N,b as k,c as b,d as o}from"./select-BbsFjDoU.js";import{C as I}from"./checkbox-aQK6cwtx.js";import"./firebase-B1tATv4n.js";import"./utils-vendor-zid8MmOQ.js";import"./index-4hsSYOGr.js";const me=["aseo","otro"],je=({items:l})=>{const h=()=>{const v=l.filter(c=>{if(!c.category)return!0;const d=c.category.toLowerCase();return!me.some(i=>d.includes(i))}),j={"in-stock":"en_stock","low-stock":"stock_bajo","to-buy":"pendiente_compra"},n=v.reduce((c,d)=>{const i=j[d.status]||d.status;return c[i]||(c[i]=[]),c[i].push({name:d.name,quantity:d.quantity}),c},{}),p=JSON.stringify(n,null,2);navigator.clipboard.writeText(p).then(()=>{U.success("Ingredientes copiados al portapapeles")})};return e.jsxs(S,{variant:"outline",size:"sm",onClick:h,className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-4 h-4"}),"Exportar ingredientes disponibles"]})},Z=[{value:"Aseo y Limpieza",emoji:"ðŸ§¹"},{value:"Bebidas",emoji:"ðŸ¥¤"},{value:"Carnes y Pescados",emoji:"ðŸ¥©"},{value:"Cereales y Granos",emoji:"ðŸŒ¾"},{value:"Condimentos y Especias",emoji:"ðŸ§‚"},{value:"Congelados",emoji:"â„ï¸"},{value:"Cuidado Personal",emoji:"ðŸ§´"},{value:"Enlatados y Conservas",emoji:"ðŸ¥«"},{value:"Frutas y Verduras",emoji:"ðŸŽ"},{value:"LÃ¡cteos y Huevos",emoji:"ðŸ¥›"},{value:"PanaderÃ­a",emoji:"ðŸž"},{value:"Snacks y Dulces",emoji:"ðŸª"},{value:"Mascotas",emoji:"ðŸ¶"},{value:"Otro",emoji:"ðŸ“¦"}],pe=Z.reduce((l,h)=>(l[h.value]=h.emoji,l),{}),ge=Z.map(l=>l.value),D=l=>{if(!l)return"";const h=pe[l];return h?`${h} ${l}`:l},ye=["Ã‰xito","D1","Ara","Dollarcity","Olimpica (SAO)","Jumbo","Plaza de mercado","PanaderÃ­a","DroguerÃ­a","Otro"],ve=({open:l,onOpenChange:h,onSave:v,onDelete:j,item:n})=>{const[p,c]=r.useState(""),[d,i]=r.useState(1),[y,m]=r.useState(""),[g,f]=r.useState(""),[w,T]=r.useState(""),[z,P]=r.useState("to-buy");r.useEffect(()=>{n?(c(n.name),i(n.quantity),m(n.price?String(n.price):""),f(n.category||""),T(n.place||""),P(n.status)):(c(""),i(1),m(""),f(""),T(""),P("to-buy"))},[n,l]);const A=()=>{const s={quantity:Number(d),status:z};y&&y.trim()!==""&&(s.price=Number(y)),g&&g.trim()!==""&&(s.category=g),w&&w.trim()!==""&&(s.place=w),n?v({...s,name:p},n.id):p.split(`
`).map(t=>t.trim()).filter(Boolean).forEach(t=>v({...s,name:t})),h(!1)};return e.jsx(ce,{open:l,onOpenChange:h,children:e.jsxs(ie,{className:"sm:max-w-md",children:[e.jsx(de,{children:e.jsxs(ue,{children:[n?"Editar":"Agregar"," Ãtem"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(F,{htmlFor:"names",children:["Nombre",n?"":"s"]}),n?e.jsx(B,{id:"names",value:p,onChange:s=>c(s.target.value)}):e.jsx(he,{id:"names",value:p,onChange:s=>c(s.target.value),placeholder:"Un producto por lÃ­nea",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(F,{htmlFor:"quantity",children:"Cantidad"}),e.jsx(B,{id:"quantity",type:"number",value:d,onChange:s=>i(Number(s.target.value))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(F,{htmlFor:"price",children:"Precio"}),e.jsx(B,{id:"price",type:"number",value:y,onChange:s=>m(s.target.value)})]})]}),"          ",e.jsxs("div",{className:"space-y-1",children:[e.jsx(F,{htmlFor:"category",children:"CategorÃ­a"}),e.jsxs(C,{value:g,onValueChange:f,children:[e.jsx(N,{id:"category",children:e.jsx(k,{placeholder:"Seleccionar categorÃ­a"})}),e.jsx(b,{children:ge.map(s=>e.jsx(o,{value:s,children:D(s)},s))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(F,{htmlFor:"place",children:"Lugar de compra"}),e.jsxs(C,{value:w,onValueChange:T,children:[e.jsx(N,{id:"place",children:e.jsx(k,{placeholder:"Seleccionar lugar"})}),e.jsx(b,{children:ye.map(s=>e.jsx(o,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(F,{htmlFor:"status",children:"Estado"}),e.jsxs(C,{value:z,onValueChange:s=>P(s),children:[e.jsx(N,{id:"status",children:e.jsx(k,{})}),e.jsxs(b,{children:[e.jsx(o,{value:"in-stock",children:"En Stock"}),e.jsx(o,{value:"to-buy",children:"Por Comprar"}),e.jsx(o,{value:"low-stock",children:"Poco Stock"})]})]})]})]}),e.jsxs(xe,{className:"flex justify-between",children:[n&&j?e.jsx(S,{variant:"destructive",onClick:()=>{j(n.id),h(!1)},children:"Eliminar"}):e.jsx("span",{}),e.jsx(S,{onClick:A,children:"Guardar"})]})]})})},$=[{key:"to-buy",title:"Por Comprar"},{key:"low-stock",title:"Poco Stock"},{key:"in-stock",title:"En Stock"}],fe={"to-buy":O,"low-stock":X,"in-stock":ee},Ce=({items:l,onMove:h,onView:v})=>{const[j,n]=r.useState(""),[p,c]=r.useState("az"),[d,i]=r.useState(""),[y,m]=r.useState(""),[g,f]=r.useState(""),[w,T]=r.useState(!1),z=r.useMemo(()=>Array.from(new Set(l.map(s=>s.place).filter(Boolean))),[l]),P=r.useMemo(()=>Array.from(new Set(l.map(s=>s.category).filter(Boolean))),[l]),A=r.useMemo(()=>{let s=l.filter(t=>t.name.toLowerCase().includes(j.toLowerCase()));d&&(s=s.filter(t=>t.place===d)),y&&(s=s.filter(t=>t.status===y)),g&&(s=s.filter(t=>t.category===g)),w&&(s=s.filter(t=>t.status==="to-buy"));let x=[...s];switch(p){case"az":x.sort((t,E)=>t.name.localeCompare(E.name));break;case"za":x.sort((t,E)=>E.name.localeCompare(t.name));break;case"category":x.sort((t,E)=>(t.category||"").localeCompare(E.category||""));break}return x},[l,j,d,y,g,w,p]);return e.jsx(K,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[e.jsx(B,{placeholder:"Buscar",value:j,onChange:s=>n(s.target.value),className:"sm:w-60"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(C,{value:p,onValueChange:s=>c(s),children:[e.jsx(N,{className:"w-36",children:e.jsx(k,{placeholder:"Ordenar"})}),e.jsxs(b,{children:[e.jsx(o,{value:"az",children:"Nombre A-Z"}),e.jsx(o,{value:"za",children:"Nombre Z-A"}),e.jsx(o,{value:"category",children:"CategorÃ­a"})]})]}),e.jsxs(C,{value:d||"all",onValueChange:s=>i(s==="all"?"":s),children:[e.jsx(N,{className:"w-36",children:e.jsx(k,{placeholder:"Lugar"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"Todos los lugares"}),z.map(s=>e.jsx(o,{value:s,children:s},s))]})]}),e.jsxs(C,{value:y||"all",onValueChange:s=>m(s==="all"?"":s),children:[e.jsx(N,{className:"w-36",children:e.jsx(k,{placeholder:"Estado"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"Todos"}),e.jsx(o,{value:"to-buy",children:"Por Comprar"}),e.jsx(o,{value:"in-stock",children:"En Stock"}),e.jsx(o,{value:"low-stock",children:"Poco Stock"})]})]}),e.jsxs(C,{value:g||"all",onValueChange:s=>f(s==="all"?"":s),children:[e.jsx(N,{className:"w-44",children:e.jsx(k,{placeholder:"CategorÃ­a"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"Todas"}),P.map(s=>e.jsx(o,{value:s,children:D(s)},s))]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(I,{checked:w,onCheckedChange:s=>T(!!s)}),e.jsx(O,{className:"w-4 h-4"}),"Lista activa"]})]})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:$.map(s=>e.jsxs("div",{className:"w-64 flex-shrink-0 space-y-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-500 uppercase tracking-wider",children:s.title}),A.filter(x=>x.status===s.key).map(x=>e.jsxs("div",{className:"bg-white shadow-sm border rounded-lg p-2 space-y-1 cursor-pointer",onClick:()=>v(x),children:[e.jsx("div",{className:"font-medium",children:x.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[x.quantity," - ",x.category&&D(x.category)]}),e.jsxs("div",{className:"flex justify-end gap-2 text-xs",children:[$.filter(t=>t.key!==s.key).map(t=>{const E=fe[t.key];return e.jsxs(V,{children:[e.jsx(M,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"icon",onClick:a=>{a.stopPropagation(),h(x.id,t.key)},children:e.jsx(E,{className:"w-4 h-4"})})}),e.jsxs(_,{children:["Mover a ",t.title]})]},t.key)}),e.jsxs(V,{children:[e.jsx(M,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"icon",onClick:t=>{t.stopPropagation(),v(x)},children:e.jsx(W,{className:"w-4 h-4"})})}),e.jsx(_,{children:"Ver detalles"})]})]})]},x.id))]},s.key))})]})})},Ne=({items:l,onEdit:h,onDelete:v,onUpdate:j})=>{const[n,p]=r.useState(""),[c,d]=r.useState("az"),[i,y]=r.useState(""),[m,g]=r.useState(""),[f,w]=r.useState(""),[T,z]=r.useState(!1),[P,A]=r.useState(!1),s=r.useMemo(()=>Array.from(new Set(l.map(a=>a.place).filter(Boolean))),[l]),x=r.useMemo(()=>Array.from(new Set(l.map(a=>a.category).filter(Boolean))),[l]),t=r.useMemo(()=>{let a=l.filter(u=>u.name.toLowerCase().includes(n.toLowerCase()));i&&(a=a.filter(u=>u.place===i)),m&&(a=a.filter(u=>u.status===m)),f&&(f==="__empty"?a=a.filter(u=>!u.category):a=a.filter(u=>u.category===f)),P&&(a=a.filter(u=>u.price===void 0)),T&&(a=a.filter(u=>u.status==="to-buy"));let L=[...a];switch(c){case"az":L.sort((u,q)=>u.name.localeCompare(q.name));break;case"za":L.sort((u,q)=>q.name.localeCompare(u.name));break;case"category":L.sort((u,q)=>(u.category||"").localeCompare(q.category||""));break}return L},[l,n,i,m,f,P,T,c]),E=r.useMemo(()=>t.reduce((a,L)=>L.status==="to-buy"&&L.price!==void 0?a+L.price*L.quantity:a,0),[t]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[e.jsx(B,{placeholder:"Buscar",value:n,onChange:a=>p(a.target.value),className:"sm:w-60"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(C,{value:c,onValueChange:a=>d(a),children:[e.jsx(N,{className:"w-36",children:e.jsx(k,{placeholder:"Ordenar"})}),e.jsxs(b,{children:[e.jsx(o,{value:"az",children:"Nombre A-Z"}),e.jsx(o,{value:"za",children:"Nombre Z-A"}),e.jsx(o,{value:"category",children:"CategorÃ­a"})]})]}),e.jsxs(C,{value:i||"all",onValueChange:a=>y(a==="all"?"":a),children:[e.jsx(N,{className:"w-36",children:e.jsx(k,{placeholder:"Lugar"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"Todos los lugares"}),s.map(a=>e.jsx(o,{value:a,children:a},a))]})]}),e.jsxs(C,{value:m||"all",onValueChange:a=>g(a==="all"?"":a),children:[e.jsx(N,{className:"w-36",children:e.jsx(k,{placeholder:"Estado"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"Todos"}),e.jsx(o,{value:"to-buy",children:"Por Comprar"}),e.jsx(o,{value:"in-stock",children:"En Stock"}),e.jsx(o,{value:"low-stock",children:"Poco Stock"})]})]}),e.jsxs(C,{value:f||"all",onValueChange:a=>w(a==="all"?"":a),children:[e.jsx(N,{className:"w-44",children:e.jsx(k,{placeholder:"CategorÃ­a"})}),e.jsxs(b,{children:[e.jsx(o,{value:"all",children:"Todas"}),e.jsx(o,{value:"__empty",children:"Sin categorÃ­a"}),x.map(a=>e.jsx(o,{value:a,children:D(a)},a))]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(I,{checked:P,onCheckedChange:a=>A(!!a)}),"Sin precio"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(I,{checked:T,onCheckedChange:a=>z(!!a)}),e.jsx(O,{className:"w-4 h-4"}),"Lista activa"]})]})]}),e.jsxs("div",{className:"text-right font-medium",children:["Total pendiente: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(E)]}),e.jsx("div",{className:"space-y-2",children:t.map(a=>e.jsxs("div",{className:"bg-white shadow-sm border rounded-lg p-3 flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:a.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Cantidad: ",a.quantity,a.category&&` â€¢ ${D(a.category)}`,a.place&&` â€¢ ${a.place}`]}),e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs ${a.status==="in-stock"?"bg-green-100 text-green-800":a.status==="low-stock"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:a.status==="in-stock"?"En Stock":a.status==="low-stock"?"Poco Stock":"Por Comprar"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>j(a.id,{quantity:a.quantity+1}),children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>a.quantity>1&&j(a.id,{quantity:a.quantity-1}),children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>h(a),children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>v(a.id),children:e.jsx(te,{className:"h-4 w-4"})})]})]},a.id))})]})},ke=()=>{const{items:l,addItem:h,updateItem:v,deleteItem:j,moveItem:n}=ne(),[p,c]=r.useState(!1),[d,i]=r.useState(null),y=(m,g)=>{g?v(g,m):h(m)};return e.jsxs(H,{className:"w-full h-full flex flex-col",children:[e.jsxs(J,{className:"p-4 space-y-4 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Lista de Compras"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(je,{items:l}),e.jsx(S,{onClick:()=>c(!0),children:"Agregar"})]})]}),e.jsxs(re,{defaultValue:"kanban",className:"w-full",children:[e.jsxs(oe,{className:"mb-4",children:[e.jsx(G,{value:"kanban",children:"Kanban"}),e.jsx(G,{value:"list",children:"Lista"})]}),l.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-lg",children:"No hay elementos en tu lista"}),e.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar" para comenzar'})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{value:"kanban",children:e.jsx(Ce,{items:l,onMove:n,onView:i})}),e.jsx(R,{value:"list",children:e.jsx(Ne,{items:l,onEdit:i,onDelete:j,onUpdate:v})})]})]})]}),e.jsx(ve,{open:p||!!d,onOpenChange:()=>{c(!1),i(null)},onSave:y,onDelete:m=>j(m),item:d||void 0})]})},Me=()=>e.jsx(Q,{noPadding:!0,className:"h-full",children:e.jsx(ke,{})});export{Me as default};
