import{r as p,R as lM,j as e,c as W0,P as Gt,b as vi,d as bi,e as Nc,D as K0,C as X0,u as Sa,f as wc,g as Mr,h as Q0,A as hf,i as Nt,k as Z0,O as Sc,l as ff,m as Cc,n as Nu,T as Ec,o as Tc,p as pf,q as xf,s as te,t as oM,v as OC,w as RC,W as cM,x as dM,y as fi,z as IC,a as Wl,B as nl,E as zC,F as LC,G as PC,H as BC,I as gf,J as uM,K as mM,L as $C,M as HC,N as hM,S as UC,Q as VC,U as fM,V as YC,X as qC,Y as FC,Z as GC,_ as WC,$ as KC,a0 as XC,a1 as pM,a2 as xM,a3 as gM,a4 as yf,a5 as QC,a6 as ZC,a7 as yM,a8 as vM,a9 as bM}from"../chunks/ui-vendor-DFSxxUjO.js";import{r as jM,a as NM,g as wM}from"../chunks/react-vendor-Cgg2GOmP.js";import{c as SM}from"../chunks/supabase-D_kvcy1s.js";import{c as CM,a as Dc,b as cg,d as kd,e as Ad,f as EM,g as Jt,s as ka,h as ps,i as vf,j as J0,k as Kl,l as Ua,m as nc,n as rc,o as an,p as wu,q as Xl,r as Mh,t as JC,u as TM,v as uc,w as ey,x as DM,y as sw,z as nw,A as kM}from"../chunks/utils-vendor-kD8SHcTY.js";import{L as AM,D as no,a as mc,S as hl,b as bf,B as ro,T as pi,U as e1,C as _M,K as t1,c as mu,F as a1,d as s1,e as Oh,f as wn,X as Fa,g as rn,h as ty,i as xi,j as Rh,k as Ih,l as Or,W as t0,m as hc,n as MM,V as OM,o as RM,p as Sh,q as zh,r as cr,A as fl,P as Bs,s as n1,t as jf,u as lr,v as ay,w as kc,x as Aa,y as It,z as hs,E as sy,G as a0,H as s0,I as r1,J as i1,M as l1,N as xs,O as o1,Q as n0,R as c1,Y as d1,Z as u1,_ as fc,$ as os,a0 as Rr,a1 as m1,a2 as h1,a3 as Su,a4 as gn,a5 as ol,a6 as ii,a7 as kr,a8 as Jn,a9 as yn,aa as li,ab as ui,ac as _s,ad as Vn,ae as Cu,af as IM,ag as pc,ah as ny,ai as Ac,aj as fo,ak as Eu,al as zM,am as LM,an as hu,ao as f1,ap as p1,aq as io,ar as ry,as as iy,at as ly,au as PM,av as Nf,aw as r0,ax as lo,ay as Sn,az as x1,aA as g1,aB as y1,aC as i0,aD as xc,aE as BM,aF as v1,aG as l0,aH as $M,aI as oi,aJ as HM,aK as b1,aL as xl,aM as gl,aN as oy,aO as j1,aP as UM,aQ as rw,aR as o0,aS as VM,aT as c0,aU as d0,aV as iw,aW as YM,aX as qM,aY as N1,aZ as lw,a_ as FM}from"../chunks/chart-vendor-DWJW0H3R.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(l){if(l.ep)return;l.ep=!0;const o=s(l);fetch(l.href,o)}})();var dg={exports:{}},_d={},ug={exports:{}},mg={};var ow;function GM(){return ow||(ow=1,(function(t){function a(I,O){var Y=I.length;I.push(O);e:for(;0<Y;){var le=Y-1>>>1,re=I[le];if(0<l(re,O))I[le]=O,I[Y]=re,Y=le;else break e}}function s(I){return I.length===0?null:I[0]}function r(I){if(I.length===0)return null;var O=I[0],Y=I.pop();if(Y!==O){I[0]=Y;e:for(var le=0,re=I.length,Q=re>>>1;le<Q;){var q=2*(le+1)-1,M=I[q],W=q+1,ie=I[W];if(0>l(M,Y))W<re&&0>l(ie,M)?(I[le]=ie,I[W]=Y,le=W):(I[le]=M,I[q]=Y,le=q);else if(W<re&&0>l(ie,Y))I[le]=ie,I[W]=Y,le=W;else break e}}return O}function l(I,O){var Y=I.sortIndex-O.sortIndex;return Y!==0?Y:I.id-O.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var d=Date,u=d.now();t.unstable_now=function(){return d.now()-u}}var m=[],h=[],g=1,x=null,y=3,v=!1,b=!1,N=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function D(I){for(var O=s(h);O!==null;){if(O.callback===null)r(h);else if(O.startTime<=I)r(h),O.sortIndex=O.expirationTime,a(m,O);else break;O=s(h)}}function k(I){if(N=!1,D(I),!b)if(s(m)!==null)b=!0,_||(_=!0,G());else{var O=s(h);O!==null&&H(k,O.startTime-I)}}var _=!1,R=-1,L=5,U=-1;function V(){return S?!0:!(t.unstable_now()-U<L)}function F(){if(S=!1,_){var I=t.unstable_now();U=I;var O=!0;try{e:{b=!1,N&&(N=!1,E(R),R=-1),v=!0;var Y=y;try{t:{for(D(I),x=s(m);x!==null&&!(x.expirationTime>I&&V());){var le=x.callback;if(typeof le=="function"){x.callback=null,y=x.priorityLevel;var re=le(x.expirationTime<=I);if(I=t.unstable_now(),typeof re=="function"){x.callback=re,D(I),O=!0;break t}x===s(m)&&r(m),D(I)}else r(m);x=s(m)}if(x!==null)O=!0;else{var Q=s(h);Q!==null&&H(k,Q.startTime-I),O=!1}}break e}finally{x=null,y=Y,v=!1}O=void 0}}finally{O?G():_=!1}}}var G;if(typeof T=="function")G=function(){T(F)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,z=$.port2;$.port1.onmessage=F,G=function(){z.postMessage(null)}}else G=function(){w(F,0)};function H(I,O){R=w(function(){I(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(I){switch(y){case 1:case 2:case 3:var O=3;break;default:O=y}var Y=y;y=O;try{return I()}finally{y=Y}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(I,O){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var Y=y;y=I;try{return O()}finally{y=Y}},t.unstable_scheduleCallback=function(I,O,Y){var le=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?le+Y:le):Y=le,I){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Y+re,I={id:g++,callback:O,priorityLevel:I,startTime:Y,expirationTime:re,sortIndex:-1},Y>le?(I.sortIndex=Y,a(h,I),s(m)===null&&I===s(h)&&(N?(E(R),R=-1):N=!0,H(k,Y-le))):(I.sortIndex=re,a(m,I),b||v||(b=!0,_||(_=!0,G()))),I},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(I){var O=y;return function(){var Y=y;y=O;try{return I.apply(this,arguments)}finally{y=Y}}}})(mg)),mg}var cw;function WM(){return cw||(cw=1,ug.exports=GM()),ug.exports}var dw;function KM(){if(dw)return _d;dw=1;var t=WM(),a=jM(),s=NM();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function o(n){var i=n,c=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(c=i.return),n=i.return;while(n)}return i.tag===3?c:null}function d(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function m(n){if(o(n)!==n)throw Error(r(188))}function h(n){var i=n.alternate;if(!i){if(i=o(n),i===null)throw Error(r(188));return i!==n?null:n}for(var c=n,f=i;;){var j=c.return;if(j===null)break;var C=j.alternate;if(C===null){if(f=j.return,f!==null){c=f;continue}break}if(j.child===C.child){for(C=j.child;C;){if(C===c)return m(j),n;if(C===f)return m(j),i;C=C.sibling}throw Error(r(188))}if(c.return!==f.return)c=j,f=C;else{for(var A=!1,B=j.child;B;){if(B===c){A=!0,c=j,f=C;break}if(B===f){A=!0,f=j,c=C;break}B=B.sibling}if(!A){for(B=C.child;B;){if(B===c){A=!0,c=C,f=j;break}if(B===f){A=!0,f=C,c=j;break}B=B.sibling}if(!A)throw Error(r(189))}}if(c.alternate!==f)throw Error(r(190))}if(c.tag!==3)throw Error(r(188));return c.stateNode.current===c?n:i}function g(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=g(n),i!==null)return i;n=n.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),T=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function G(n){return n===null||typeof n!="object"?null:(n=F&&n[F]||n["@@iterator"],typeof n=="function"?n:null)}var $=Symbol.for("react.client.reference");function z(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===$?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case N:return"Fragment";case w:return"Profiler";case S:return"StrictMode";case k:return"Suspense";case _:return"SuspenseList";case U:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case T:return n.displayName||"Context";case E:return(n._context.displayName||"Context")+".Consumer";case D:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case R:return i=n.displayName||null,i!==null?i:z(n.type)||"Memo";case L:i=n._payload,n=n._init;try{return z(n(i))}catch{}}return null}var H=Array.isArray,I=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},le=[],re=-1;function Q(n){return{current:n}}function q(n){0>re||(n.current=le[re],le[re]=null,re--)}function M(n,i){re++,le[re]=n.current,n.current=i}var W=Q(null),ie=Q(null),ve=Q(null),K=Q(null);function oe(n,i){switch(M(ve,i),M(ie,n),M(W,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?EN(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=EN(i),n=TN(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}q(W),M(W,n)}function _e(){q(W),q(ie),q(ve)}function je(n){n.memoizedState!==null&&M(K,n);var i=W.current,c=TN(i,n.type);i!==c&&(M(ie,n),M(W,c))}function Ie(n){ie.current===n&&(q(W),q(ie)),K.current===n&&(q(K),Cd._currentValue=Y)}var ge,Be;function ke(n){if(ge===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);ge=i&&i[1]||"",Be=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ge+n+Be}var gt=!1;function Dt(n,i){if(!n||gt)return"";gt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(i){var Se=function(){throw Error()};if(Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(pe){var ue=pe}Reflect.construct(n,[],Se)}else{try{Se.call()}catch(pe){ue=pe}n.call(Se.prototype)}}else{try{throw Error()}catch(pe){ue=pe}(Se=n())&&typeof Se.catch=="function"&&Se.catch(function(){})}}catch(pe){if(pe&&ue&&typeof pe.stack=="string")return[pe.stack,ue.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=f.DetermineComponentFrameRoot(),A=C[0],B=C[1];if(A&&B){var Z=A.split(`
`),de=B.split(`
`);for(j=f=0;f<Z.length&&!Z[f].includes("DetermineComponentFrameRoot");)f++;for(;j<de.length&&!de[j].includes("DetermineComponentFrameRoot");)j++;if(f===Z.length||j===de.length)for(f=Z.length-1,j=de.length-1;1<=f&&0<=j&&Z[f]!==de[j];)j--;for(;1<=f&&0<=j;f--,j--)if(Z[f]!==de[j]){if(f!==1||j!==1)do if(f--,j--,0>j||Z[f]!==de[j]){var be=`
`+Z[f].replace(" at new "," at ");return n.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",n.displayName)),be}while(1<=f&&0<=j);break}}}finally{gt=!1,Error.prepareStackTrace=c}return(c=n?n.displayName||n.name:"")?ke(c):""}function kt(n,i){switch(n.tag){case 26:case 27:case 5:return ke(n.type);case 16:return ke("Lazy");case 13:return n.child!==i&&i!==null?ke("Suspense Fallback"):ke("Suspense");case 19:return ke("SuspenseList");case 0:case 15:return Dt(n.type,!1);case 11:return Dt(n.type.render,!1);case 1:return Dt(n.type,!0);case 31:return ke("Activity");default:return""}}function ja(n){try{var i="",c=null;do i+=kt(n,c),c=n,n=n.return;while(n);return i}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Wt=Object.prototype.hasOwnProperty,Vt=t.unstable_scheduleCallback,X=t.unstable_cancelCallback,se=t.unstable_shouldYield,me=t.unstable_requestPaint,Oe=t.unstable_now,Re=t.unstable_getCurrentPriorityLevel,Ee=t.unstable_ImmediatePriority,Pe=t.unstable_UserBlockingPriority,Je=t.unstable_NormalPriority,rt=t.unstable_LowPriority,Et=t.unstable_IdlePriority,Kt=t.log,Ne=t.unstable_setDisableYieldValue,Ve=null,nt=null;function bt(n){if(typeof Kt=="function"&&Ne(n),nt&&typeof nt.setStrictMode=="function")try{nt.setStrictMode(Ve,n)}catch{}}var Pt=Math.clz32?Math.clz32:qe,_a=Math.log,Ma=Math.LN2;function qe(n){return n>>>=0,n===0?32:31-(_a(n)/Ma|0)|0}var dt=256,jt=262144,Xe=4194304;function et(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function $e(n,i,c){var f=n.pendingLanes;if(f===0)return 0;var j=0,C=n.suspendedLanes,A=n.pingedLanes;n=n.warmLanes;var B=f&134217727;return B!==0?(f=B&~C,f!==0?j=et(f):(A&=B,A!==0?j=et(A):c||(c=B&~n,c!==0&&(j=et(c))))):(B=f&~C,B!==0?j=et(B):A!==0?j=et(A):c||(c=f&~n,c!==0&&(j=et(c)))),j===0?0:i!==0&&i!==j&&(i&C)===0&&(C=j&-j,c=i&-i,C>=c||C===32&&(c&4194048)!==0)?i:j}function Ae(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function Fe(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lt(){var n=Xe;return Xe<<=1,(Xe&62914560)===0&&(Xe=4194304),n}function Xt(n){for(var i=[],c=0;31>c;c++)i.push(n);return i}function ht(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function ct(n,i,c,f,j,C){var A=n.pendingLanes;n.pendingLanes=c,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=c,n.entangledLanes&=c,n.errorRecoveryDisabledLanes&=c,n.shellSuspendCounter=0;var B=n.entanglements,Z=n.expirationTimes,de=n.hiddenUpdates;for(c=A&~c;0<c;){var be=31-Pt(c),Se=1<<be;B[be]=0,Z[be]=-1;var ue=de[be];if(ue!==null)for(de[be]=null,be=0;be<ue.length;be++){var pe=ue[be];pe!==null&&(pe.lane&=-536870913)}c&=~Se}f!==0&&pa(n,f,0),C!==0&&j===0&&n.tag!==0&&(n.suspendedLanes|=C&~(A&~i))}function pa(n,i,c){n.pendingLanes|=i,n.suspendedLanes&=~i;var f=31-Pt(i);n.entangledLanes|=i,n.entanglements[f]=n.entanglements[f]|1073741824|c&261930}function qt(n,i){var c=n.entangledLanes|=i;for(n=n.entanglements;c;){var f=31-Pt(c),j=1<<f;j&i|n[f]&i&&(n[f]|=i),c&=~j}}function da(n,i){var c=i&-i;return c=(c&42)!==0?1:Na(c),(c&(n.suspendedLanes|i))!==0?0:c}function Na(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function xa(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function ys(){var n=O.p;return n!==0?n:(n=window.event,n===void 0?32:XN(n.type))}function on(n,i){var c=O.p;try{return O.p=n,i()}finally{O.p=c}}var cs=Math.random().toString(36).slice(2),Pa="__reactFiber$"+cs,wa="__reactProps$"+cs,Gn="__reactContainer$"+cs,Ei="__reactEvents$"+cs,yo="__reactListeners$"+cs,vo="__reactHandles$"+cs,Te="__reactResources$"+cs,He="__reactMarker$"+cs;function J(n){delete n[Pa],delete n[wa],delete n[Ei],delete n[yo],delete n[vo]}function Me(n){var i=n[Pa];if(i)return i;for(var c=n.parentNode;c;){if(i=c[Gn]||c[Pa]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(n=RN(n);n!==null;){if(c=n[Pa])return c;n=RN(n)}return i}n=c,c=n.parentNode}return null}function Ye(n){if(n=n[Pa]||n[Gn]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function la(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function Oa(n){var i=n[Te];return i||(i=n[Te]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function At(n){n[He]=!0}var vs=new Set,Tn={};function Ys(n,i){yr(n,i),yr(n+"Capture",i)}function yr(n,i){for(Tn[n]=i,n=0;n<i.length;n++)vs.add(i[n])}var ss=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),$c={},Hc={};function Jk(n){return Wt.call(Hc,n)?!0:Wt.call($c,n)?!1:ss.test(n)?Hc[n]=!0:($c[n]=!0,!1)}function Yu(n,i,c){if(Jk(i))if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var f=i.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+c)}}function qu(n,i,c){if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+c)}}function Pr(n,i,c,f){if(f===null)n.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(c);return}n.setAttributeNS(i,c,""+f)}}function Dn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function yv(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function eA(n,i,c){var f=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var j=f.get,C=f.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return j.call(this)},set:function(A){c=""+A,C.call(this,A)}}),Object.defineProperty(n,i,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(A){c=""+A},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function ap(n){if(!n._valueTracker){var i=yv(n)?"checked":"value";n._valueTracker=eA(n,i,""+n[i])}}function vv(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var c=i.getValue(),f="";return n&&(f=yv(n)?n.checked?"true":"false":n.value),n=f,n!==c?(i.setValue(n),!0):!1}function Fu(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var tA=/[\n"\\]/g;function kn(n){return n.replace(tA,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function sp(n,i,c,f,j,C,A,B){n.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?n.type=A:n.removeAttribute("type"),i!=null?A==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Dn(i)):n.value!==""+Dn(i)&&(n.value=""+Dn(i)):A!=="submit"&&A!=="reset"||n.removeAttribute("value"),i!=null?np(n,A,Dn(i)):c!=null?np(n,A,Dn(c)):f!=null&&n.removeAttribute("value"),j==null&&C!=null&&(n.defaultChecked=!!C),j!=null&&(n.checked=j&&typeof j!="function"&&typeof j!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?n.name=""+Dn(B):n.removeAttribute("name")}function bv(n,i,c,f,j,C,A,B){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(n.type=C),i!=null||c!=null){if(!(C!=="submit"&&C!=="reset"||i!=null)){ap(n);return}c=c!=null?""+Dn(c):"",i=i!=null?""+Dn(i):c,B||i===n.value||(n.value=i),n.defaultValue=i}f=f??j,f=typeof f!="function"&&typeof f!="symbol"&&!!f,n.checked=B?n.checked:!!f,n.defaultChecked=!!f,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(n.name=A),ap(n)}function np(n,i,c){i==="number"&&Fu(n.ownerDocument)===n||n.defaultValue===""+c||(n.defaultValue=""+c)}function bo(n,i,c,f){if(n=n.options,i){i={};for(var j=0;j<c.length;j++)i["$"+c[j]]=!0;for(c=0;c<n.length;c++)j=i.hasOwnProperty("$"+n[c].value),n[c].selected!==j&&(n[c].selected=j),j&&f&&(n[c].defaultSelected=!0)}else{for(c=""+Dn(c),i=null,j=0;j<n.length;j++){if(n[j].value===c){n[j].selected=!0,f&&(n[j].defaultSelected=!0);return}i!==null||n[j].disabled||(i=n[j])}i!==null&&(i.selected=!0)}}function jv(n,i,c){if(i!=null&&(i=""+Dn(i),i!==n.value&&(n.value=i),c==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=c!=null?""+Dn(c):""}function Nv(n,i,c,f){if(i==null){if(f!=null){if(c!=null)throw Error(r(92));if(H(f)){if(1<f.length)throw Error(r(93));f=f[0]}c=f}c==null&&(c=""),i=c}c=Dn(i),n.defaultValue=c,f=n.textContent,f===c&&f!==""&&f!==null&&(n.value=f),ap(n)}function jo(n,i){if(i){var c=n.firstChild;if(c&&c===n.lastChild&&c.nodeType===3){c.nodeValue=i;return}}n.textContent=i}var aA=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wv(n,i,c){var f=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":f?n.setProperty(i,c):typeof c!="number"||c===0||aA.has(i)?i==="float"?n.cssFloat=c:n[i]=(""+c).trim():n[i]=c+"px"}function Sv(n,i,c){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||i!=null&&i.hasOwnProperty(f)||(f.indexOf("--")===0?n.setProperty(f,""):f==="float"?n.cssFloat="":n[f]="");for(var j in i)f=i[j],i.hasOwnProperty(j)&&c[j]!==f&&wv(n,j,f)}else for(var C in i)i.hasOwnProperty(C)&&wv(n,C,i[C])}function rp(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sA=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),nA=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gu(n){return nA.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Br(){}var ip=null;function lp(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var No=null,wo=null;function Cv(n){var i=Ye(n);if(i&&(n=i.stateNode)){var c=n[wa]||null;e:switch(n=i.stateNode,i.type){case"input":if(sp(n,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=n;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+kn(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var f=c[i];if(f!==n&&f.form===n.form){var j=f[wa]||null;if(!j)throw Error(r(90));sp(f,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(i=0;i<c.length;i++)f=c[i],f.form===n.form&&vv(f)}break e;case"textarea":jv(n,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&bo(n,!!c.multiple,i,!1)}}}var op=!1;function Ev(n,i,c){if(op)return n(i,c);op=!0;try{var f=n(i);return f}finally{if(op=!1,(No!==null||wo!==null)&&(Rm(),No&&(i=No,n=wo,wo=No=null,Cv(i),n)))for(i=0;i<n.length;i++)Cv(n[i])}}function Uc(n,i){var c=n.stateNode;if(c===null)return null;var f=c[wa]||null;if(f===null)return null;c=f[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(c&&typeof c!="function")throw Error(r(231,i,typeof c));return c}var $r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cp=!1;if($r)try{var Vc={};Object.defineProperty(Vc,"passive",{get:function(){cp=!0}}),window.addEventListener("test",Vc,Vc),window.removeEventListener("test",Vc,Vc)}catch{cp=!1}var Ti=null,dp=null,Wu=null;function Tv(){if(Wu)return Wu;var n,i=dp,c=i.length,f,j="value"in Ti?Ti.value:Ti.textContent,C=j.length;for(n=0;n<c&&i[n]===j[n];n++);var A=c-n;for(f=1;f<=A&&i[c-f]===j[C-f];f++);return Wu=j.slice(n,1<f?1-f:void 0)}function Ku(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Xu(){return!0}function Dv(){return!1}function qs(n){function i(c,f,j,C,A){this._reactName=c,this._targetInst=j,this.type=f,this.nativeEvent=C,this.target=A,this.currentTarget=null;for(var B in n)n.hasOwnProperty(B)&&(c=n[B],this[B]=c?c(C):C[B]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Xu:Dv,this.isPropagationStopped=Dv,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Xu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Xu)},persist:function(){},isPersistent:Xu}),i}var El={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qu=qs(El),Yc=x({},El,{view:0,detail:0}),rA=qs(Yc),up,mp,qc,Zu=x({},Yc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fp,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==qc&&(qc&&n.type==="mousemove"?(up=n.screenX-qc.screenX,mp=n.screenY-qc.screenY):mp=up=0,qc=n),up)},movementY:function(n){return"movementY"in n?n.movementY:mp}}),kv=qs(Zu),iA=x({},Zu,{dataTransfer:0}),lA=qs(iA),oA=x({},Yc,{relatedTarget:0}),hp=qs(oA),cA=x({},El,{animationName:0,elapsedTime:0,pseudoElement:0}),dA=qs(cA),uA=x({},El,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),mA=qs(uA),hA=x({},El,{data:0}),Av=qs(hA),fA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gA(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=xA[n])?!!i[n]:!1}function fp(){return gA}var yA=x({},Yc,{key:function(n){if(n.key){var i=fA[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Ku(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?pA[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fp,charCode:function(n){return n.type==="keypress"?Ku(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ku(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),vA=qs(yA),bA=x({},Zu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_v=qs(bA),jA=x({},Yc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fp}),NA=qs(jA),wA=x({},El,{propertyName:0,elapsedTime:0,pseudoElement:0}),SA=qs(wA),CA=x({},Zu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),EA=qs(CA),TA=x({},El,{newState:0,oldState:0}),DA=qs(TA),kA=[9,13,27,32],pp=$r&&"CompositionEvent"in window,Fc=null;$r&&"documentMode"in document&&(Fc=document.documentMode);var AA=$r&&"TextEvent"in window&&!Fc,Mv=$r&&(!pp||Fc&&8<Fc&&11>=Fc),Ov=" ",Rv=!1;function Iv(n,i){switch(n){case"keyup":return kA.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zv(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var So=!1;function _A(n,i){switch(n){case"compositionend":return zv(i);case"keypress":return i.which!==32?null:(Rv=!0,Ov);case"textInput":return n=i.data,n===Ov&&Rv?null:n;default:return null}}function MA(n,i){if(So)return n==="compositionend"||!pp&&Iv(n,i)?(n=Tv(),Wu=dp=Ti=null,So=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Mv&&i.locale!=="ko"?null:i.data;default:return null}}var OA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lv(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!OA[n.type]:i==="textarea"}function Pv(n,i,c,f){No?wo?wo.push(f):wo=[f]:No=f,i=Hm(i,"onChange"),0<i.length&&(c=new Qu("onChange","change",null,c,f),n.push({event:c,listeners:i}))}var Gc=null,Wc=null;function RA(n){bN(n,0)}function Ju(n){var i=la(n);if(vv(i))return n}function Bv(n,i){if(n==="change")return i}var $v=!1;if($r){var xp;if($r){var gp="oninput"in document;if(!gp){var Hv=document.createElement("div");Hv.setAttribute("oninput","return;"),gp=typeof Hv.oninput=="function"}xp=gp}else xp=!1;$v=xp&&(!document.documentMode||9<document.documentMode)}function Uv(){Gc&&(Gc.detachEvent("onpropertychange",Vv),Wc=Gc=null)}function Vv(n){if(n.propertyName==="value"&&Ju(Wc)){var i=[];Pv(i,Wc,n,lp(n)),Ev(RA,i)}}function IA(n,i,c){n==="focusin"?(Uv(),Gc=i,Wc=c,Gc.attachEvent("onpropertychange",Vv)):n==="focusout"&&Uv()}function zA(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ju(Wc)}function LA(n,i){if(n==="click")return Ju(i)}function PA(n,i){if(n==="input"||n==="change")return Ju(i)}function BA(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var cn=typeof Object.is=="function"?Object.is:BA;function Kc(n,i){if(cn(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var c=Object.keys(n),f=Object.keys(i);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var j=c[f];if(!Wt.call(i,j)||!cn(n[j],i[j]))return!1}return!0}function Yv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function qv(n,i){var c=Yv(n);n=0;for(var f;c;){if(c.nodeType===3){if(f=n+c.textContent.length,n<=i&&f>=i)return{node:c,offset:i-n};n=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Yv(c)}}function Fv(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Fv(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Gv(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Fu(n.document);i instanceof n.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)n=i.contentWindow;else break;i=Fu(n.document)}return i}function yp(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var $A=$r&&"documentMode"in document&&11>=document.documentMode,Co=null,vp=null,Xc=null,bp=!1;function Wv(n,i,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;bp||Co==null||Co!==Fu(f)||(f=Co,"selectionStart"in f&&yp(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Xc&&Kc(Xc,f)||(Xc=f,f=Hm(vp,"onSelect"),0<f.length&&(i=new Qu("onSelect","select",null,i,c),n.push({event:i,listeners:f}),i.target=Co)))}function Tl(n,i){var c={};return c[n.toLowerCase()]=i.toLowerCase(),c["Webkit"+n]="webkit"+i,c["Moz"+n]="moz"+i,c}var Eo={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionrun:Tl("Transition","TransitionRun"),transitionstart:Tl("Transition","TransitionStart"),transitioncancel:Tl("Transition","TransitionCancel"),transitionend:Tl("Transition","TransitionEnd")},jp={},Kv={};$r&&(Kv=document.createElement("div").style,"AnimationEvent"in window||(delete Eo.animationend.animation,delete Eo.animationiteration.animation,delete Eo.animationstart.animation),"TransitionEvent"in window||delete Eo.transitionend.transition);function Dl(n){if(jp[n])return jp[n];if(!Eo[n])return n;var i=Eo[n],c;for(c in i)if(i.hasOwnProperty(c)&&c in Kv)return jp[n]=i[c];return n}var Xv=Dl("animationend"),Qv=Dl("animationiteration"),Zv=Dl("animationstart"),HA=Dl("transitionrun"),UA=Dl("transitionstart"),VA=Dl("transitioncancel"),Jv=Dl("transitionend"),eb=new Map,Np="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Np.push("scrollEnd");function Wn(n,i){eb.set(n,i),Ys(i,[n])}var em=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},An=[],To=0,wp=0;function tm(){for(var n=To,i=wp=To=0;i<n;){var c=An[i];An[i++]=null;var f=An[i];An[i++]=null;var j=An[i];An[i++]=null;var C=An[i];if(An[i++]=null,f!==null&&j!==null){var A=f.pending;A===null?j.next=j:(j.next=A.next,A.next=j),f.pending=j}C!==0&&tb(c,j,C)}}function am(n,i,c,f){An[To++]=n,An[To++]=i,An[To++]=c,An[To++]=f,wp|=f,n.lanes|=f,n=n.alternate,n!==null&&(n.lanes|=f)}function Sp(n,i,c,f){return am(n,i,c,f),sm(n)}function kl(n,i){return am(n,null,null,i),sm(n)}function tb(n,i,c){n.lanes|=c;var f=n.alternate;f!==null&&(f.lanes|=c);for(var j=!1,C=n.return;C!==null;)C.childLanes|=c,f=C.alternate,f!==null&&(f.childLanes|=c),C.tag===22&&(n=C.stateNode,n===null||n._visibility&1||(j=!0)),n=C,C=C.return;return n.tag===3?(C=n.stateNode,j&&i!==null&&(j=31-Pt(c),n=C.hiddenUpdates,f=n[j],f===null?n[j]=[i]:f.push(i),i.lane=c|536870912),C):null}function sm(n){if(50<yd)throw yd=0,Ox=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Do={};function YA(n,i,c,f){this.tag=n,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(n,i,c,f){return new YA(n,i,c,f)}function Cp(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Hr(n,i){var c=n.alternate;return c===null?(c=dn(n.tag,i,n.key,n.mode),c.elementType=n.elementType,c.type=n.type,c.stateNode=n.stateNode,c.alternate=n,n.alternate=c):(c.pendingProps=i,c.type=n.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=n.flags&65011712,c.childLanes=n.childLanes,c.lanes=n.lanes,c.child=n.child,c.memoizedProps=n.memoizedProps,c.memoizedState=n.memoizedState,c.updateQueue=n.updateQueue,i=n.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=n.sibling,c.index=n.index,c.ref=n.ref,c.refCleanup=n.refCleanup,c}function ab(n,i){n.flags&=65011714;var c=n.alternate;return c===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=c.childLanes,n.lanes=c.lanes,n.child=c.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=c.memoizedProps,n.memoizedState=c.memoizedState,n.updateQueue=c.updateQueue,n.type=c.type,i=c.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function nm(n,i,c,f,j,C){var A=0;if(f=n,typeof n=="function")Cp(n)&&(A=1);else if(typeof n=="string")A=K_(n,c,W.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case U:return n=dn(31,c,i,j),n.elementType=U,n.lanes=C,n;case N:return Al(c.children,j,C,i);case S:A=8,j|=24;break;case w:return n=dn(12,c,i,j|2),n.elementType=w,n.lanes=C,n;case k:return n=dn(13,c,i,j),n.elementType=k,n.lanes=C,n;case _:return n=dn(19,c,i,j),n.elementType=_,n.lanes=C,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case T:A=10;break e;case E:A=9;break e;case D:A=11;break e;case R:A=14;break e;case L:A=16,f=null;break e}A=29,c=Error(r(130,n===null?"null":typeof n,"")),f=null}return i=dn(A,c,i,j),i.elementType=n,i.type=f,i.lanes=C,i}function Al(n,i,c,f){return n=dn(7,n,f,i),n.lanes=c,n}function Ep(n,i,c){return n=dn(6,n,null,i),n.lanes=c,n}function sb(n){var i=dn(18,null,null,0);return i.stateNode=n,i}function Tp(n,i,c){return i=dn(4,n.children!==null?n.children:[],n.key,i),i.lanes=c,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var nb=new WeakMap;function _n(n,i){if(typeof n=="object"&&n!==null){var c=nb.get(n);return c!==void 0?c:(i={value:n,source:i,stack:ja(i)},nb.set(n,i),i)}return{value:n,source:i,stack:ja(i)}}var ko=[],Ao=0,rm=null,Qc=0,Mn=[],On=0,Di=null,vr=1,br="";function Ur(n,i){ko[Ao++]=Qc,ko[Ao++]=rm,rm=n,Qc=i}function rb(n,i,c){Mn[On++]=vr,Mn[On++]=br,Mn[On++]=Di,Di=n;var f=vr;n=br;var j=32-Pt(f)-1;f&=~(1<<j),c+=1;var C=32-Pt(i)+j;if(30<C){var A=j-j%5;C=(f&(1<<A)-1).toString(32),f>>=A,j-=A,vr=1<<32-Pt(i)+j|c<<j|f,br=C+n}else vr=1<<C|c<<j|f,br=n}function Dp(n){n.return!==null&&(Ur(n,1),rb(n,1,0))}function kp(n){for(;n===rm;)rm=ko[--Ao],ko[Ao]=null,Qc=ko[--Ao],ko[Ao]=null;for(;n===Di;)Di=Mn[--On],Mn[On]=null,br=Mn[--On],Mn[On]=null,vr=Mn[--On],Mn[On]=null}function ib(n,i){Mn[On++]=vr,Mn[On++]=br,Mn[On++]=Di,vr=i.id,br=i.overflow,Di=n}var bs=null,Ca=null,Yt=!1,ki=null,Rn=!1,Ap=Error(r(519));function Ai(n){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Zc(_n(i,n)),Ap}function lb(n){var i=n.stateNode,c=n.type,f=n.memoizedProps;switch(i[Pa]=n,i[wa]=f,c){case"dialog":$t("cancel",i),$t("close",i);break;case"iframe":case"object":case"embed":$t("load",i);break;case"video":case"audio":for(c=0;c<bd.length;c++)$t(bd[c],i);break;case"source":$t("error",i);break;case"img":case"image":case"link":$t("error",i),$t("load",i);break;case"details":$t("toggle",i);break;case"input":$t("invalid",i),bv(i,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":$t("invalid",i);break;case"textarea":$t("invalid",i),Nv(i,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||f.suppressHydrationWarning===!0||SN(i.textContent,c)?(f.popover!=null&&($t("beforetoggle",i),$t("toggle",i)),f.onScroll!=null&&$t("scroll",i),f.onScrollEnd!=null&&$t("scrollend",i),f.onClick!=null&&(i.onclick=Br),i=!0):i=!1,i||Ai(n,!0)}function ob(n){for(bs=n.return;bs;)switch(bs.tag){case 5:case 31:case 13:Rn=!1;return;case 27:case 3:Rn=!0;return;default:bs=bs.return}}function _o(n){if(n!==bs)return!1;if(!Yt)return ob(n),Yt=!0,!1;var i=n.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=n.type,c=!(c!=="form"&&c!=="button")||Wx(n.type,n.memoizedProps)),c=!c),c&&Ca&&Ai(n),ob(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Ca=ON(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Ca=ON(n)}else i===27?(i=Ca,Yi(n.type)?(n=Jx,Jx=null,Ca=n):Ca=i):Ca=bs?zn(n.stateNode.nextSibling):null;return!0}function _l(){Ca=bs=null,Yt=!1}function _p(){var n=ki;return n!==null&&(Ks===null?Ks=n:Ks.push.apply(Ks,n),ki=null),n}function Zc(n){ki===null?ki=[n]:ki.push(n)}var Mp=Q(null),Ml=null,Vr=null;function _i(n,i,c){M(Mp,i._currentValue),i._currentValue=c}function Yr(n){n._currentValue=Mp.current,q(Mp)}function Op(n,i,c){for(;n!==null;){var f=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,f!==null&&(f.childLanes|=i)):f!==null&&(f.childLanes&i)!==i&&(f.childLanes|=i),n===c)break;n=n.return}}function Rp(n,i,c,f){var j=n.child;for(j!==null&&(j.return=n);j!==null;){var C=j.dependencies;if(C!==null){var A=j.child;C=C.firstContext;e:for(;C!==null;){var B=C;C=j;for(var Z=0;Z<i.length;Z++)if(B.context===i[Z]){C.lanes|=c,B=C.alternate,B!==null&&(B.lanes|=c),Op(C.return,c,n),f||(A=null);break e}C=B.next}}else if(j.tag===18){if(A=j.return,A===null)throw Error(r(341));A.lanes|=c,C=A.alternate,C!==null&&(C.lanes|=c),Op(A,c,n),A=null}else A=j.child;if(A!==null)A.return=j;else for(A=j;A!==null;){if(A===n){A=null;break}if(j=A.sibling,j!==null){j.return=A.return,A=j;break}A=A.return}j=A}}function Mo(n,i,c,f){n=null;for(var j=i,C=!1;j!==null;){if(!C){if((j.flags&524288)!==0)C=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var A=j.alternate;if(A===null)throw Error(r(387));if(A=A.memoizedProps,A!==null){var B=j.type;cn(j.pendingProps.value,A.value)||(n!==null?n.push(B):n=[B])}}else if(j===K.current){if(A=j.alternate,A===null)throw Error(r(387));A.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(n!==null?n.push(Cd):n=[Cd])}j=j.return}n!==null&&Rp(i,n,c,f),i.flags|=262144}function im(n){for(n=n.firstContext;n!==null;){if(!cn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ol(n){Ml=n,Vr=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function js(n){return cb(Ml,n)}function lm(n,i){return Ml===null&&Ol(n),cb(n,i)}function cb(n,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},Vr===null){if(n===null)throw Error(r(308));Vr=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Vr=Vr.next=i;return c}var qA=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(c,f){n.push(f)}};this.abort=function(){i.aborted=!0,n.forEach(function(c){return c()})}},FA=t.unstable_scheduleCallback,GA=t.unstable_NormalPriority,Ka={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ip(){return{controller:new qA,data:new Map,refCount:0}}function Jc(n){n.refCount--,n.refCount===0&&FA(GA,function(){n.controller.abort()})}var ed=null,zp=0,Oo=0,Ro=null;function WA(n,i){if(ed===null){var c=ed=[];zp=0,Oo=Bx(),Ro={status:"pending",value:void 0,then:function(f){c.push(f)}}}return zp++,i.then(db,db),i}function db(){if(--zp===0&&ed!==null){Ro!==null&&(Ro.status="fulfilled");var n=ed;ed=null,Oo=0,Ro=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function KA(n,i){var c=[],f={status:"pending",value:null,reason:null,then:function(j){c.push(j)}};return n.then(function(){f.status="fulfilled",f.value=i;for(var j=0;j<c.length;j++)(0,c[j])(i)},function(j){for(f.status="rejected",f.reason=j,j=0;j<c.length;j++)(0,c[j])(void 0)}),f}var ub=I.S;I.S=function(n,i){Wj=Oe(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&WA(n,i),ub!==null&&ub(n,i)};var Rl=Q(null);function Lp(){var n=Rl.current;return n!==null?n:ga.pooledCache}function om(n,i){i===null?M(Rl,Rl.current):M(Rl,i.pool)}function mb(){var n=Lp();return n===null?null:{parent:Ka._currentValue,pool:n}}var Io=Error(r(460)),Pp=Error(r(474)),cm=Error(r(542)),dm={then:function(){}};function hb(n){return n=n.status,n==="fulfilled"||n==="rejected"}function fb(n,i,c){switch(c=n[c],c===void 0?n.push(i):c!==i&&(i.then(Br,Br),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,xb(n),n;default:if(typeof i.status=="string")i.then(Br,Br);else{if(n=ga,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(f){if(i.status==="pending"){var j=i;j.status="fulfilled",j.value=f}},function(f){if(i.status==="pending"){var j=i;j.status="rejected",j.reason=f}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,xb(n),n}throw zl=i,Io}}function Il(n){try{var i=n._init;return i(n._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(zl=c,Io):c}}var zl=null;function pb(){if(zl===null)throw Error(r(459));var n=zl;return zl=null,n}function xb(n){if(n===Io||n===cm)throw Error(r(483))}var zo=null,td=0;function um(n){var i=td;return td+=1,zo===null&&(zo=[]),fb(zo,n,i)}function ad(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function mm(n,i){throw i.$$typeof===y?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function gb(n){function i(ne,ee){if(n){var ce=ne.deletions;ce===null?(ne.deletions=[ee],ne.flags|=16):ce.push(ee)}}function c(ne,ee){if(!n)return null;for(;ee!==null;)i(ne,ee),ee=ee.sibling;return null}function f(ne){for(var ee=new Map;ne!==null;)ne.key!==null?ee.set(ne.key,ne):ee.set(ne.index,ne),ne=ne.sibling;return ee}function j(ne,ee){return ne=Hr(ne,ee),ne.index=0,ne.sibling=null,ne}function C(ne,ee,ce){return ne.index=ce,n?(ce=ne.alternate,ce!==null?(ce=ce.index,ce<ee?(ne.flags|=67108866,ee):ce):(ne.flags|=67108866,ee)):(ne.flags|=1048576,ee)}function A(ne){return n&&ne.alternate===null&&(ne.flags|=67108866),ne}function B(ne,ee,ce,we){return ee===null||ee.tag!==6?(ee=Ep(ce,ne.mode,we),ee.return=ne,ee):(ee=j(ee,ce),ee.return=ne,ee)}function Z(ne,ee,ce,we){var at=ce.type;return at===N?be(ne,ee,ce.props.children,we,ce.key):ee!==null&&(ee.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===L&&Il(at)===ee.type)?(ee=j(ee,ce.props),ad(ee,ce),ee.return=ne,ee):(ee=nm(ce.type,ce.key,ce.props,null,ne.mode,we),ad(ee,ce),ee.return=ne,ee)}function de(ne,ee,ce,we){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ce.containerInfo||ee.stateNode.implementation!==ce.implementation?(ee=Tp(ce,ne.mode,we),ee.return=ne,ee):(ee=j(ee,ce.children||[]),ee.return=ne,ee)}function be(ne,ee,ce,we,at){return ee===null||ee.tag!==7?(ee=Al(ce,ne.mode,we,at),ee.return=ne,ee):(ee=j(ee,ce),ee.return=ne,ee)}function Se(ne,ee,ce){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=Ep(""+ee,ne.mode,ce),ee.return=ne,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case v:return ce=nm(ee.type,ee.key,ee.props,null,ne.mode,ce),ad(ce,ee),ce.return=ne,ce;case b:return ee=Tp(ee,ne.mode,ce),ee.return=ne,ee;case L:return ee=Il(ee),Se(ne,ee,ce)}if(H(ee)||G(ee))return ee=Al(ee,ne.mode,ce,null),ee.return=ne,ee;if(typeof ee.then=="function")return Se(ne,um(ee),ce);if(ee.$$typeof===T)return Se(ne,lm(ne,ee),ce);mm(ne,ee)}return null}function ue(ne,ee,ce,we){var at=ee!==null?ee.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return at!==null?null:B(ne,ee,""+ce,we);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case v:return ce.key===at?Z(ne,ee,ce,we):null;case b:return ce.key===at?de(ne,ee,ce,we):null;case L:return ce=Il(ce),ue(ne,ee,ce,we)}if(H(ce)||G(ce))return at!==null?null:be(ne,ee,ce,we,null);if(typeof ce.then=="function")return ue(ne,ee,um(ce),we);if(ce.$$typeof===T)return ue(ne,ee,lm(ne,ce),we);mm(ne,ce)}return null}function pe(ne,ee,ce,we,at){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return ne=ne.get(ce)||null,B(ee,ne,""+we,at);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case v:return ne=ne.get(we.key===null?ce:we.key)||null,Z(ee,ne,we,at);case b:return ne=ne.get(we.key===null?ce:we.key)||null,de(ee,ne,we,at);case L:return we=Il(we),pe(ne,ee,ce,we,at)}if(H(we)||G(we))return ne=ne.get(ce)||null,be(ee,ne,we,at,null);if(typeof we.then=="function")return pe(ne,ee,ce,um(we),at);if(we.$$typeof===T)return pe(ne,ee,ce,lm(ee,we),at);mm(ee,we)}return null}function Ge(ne,ee,ce,we){for(var at=null,ea=null,Qe=ee,Ct=ee=0,Ut=null;Qe!==null&&Ct<ce.length;Ct++){Qe.index>Ct?(Ut=Qe,Qe=null):Ut=Qe.sibling;var ta=ue(ne,Qe,ce[Ct],we);if(ta===null){Qe===null&&(Qe=Ut);break}n&&Qe&&ta.alternate===null&&i(ne,Qe),ee=C(ta,ee,Ct),ea===null?at=ta:ea.sibling=ta,ea=ta,Qe=Ut}if(Ct===ce.length)return c(ne,Qe),Yt&&Ur(ne,Ct),at;if(Qe===null){for(;Ct<ce.length;Ct++)Qe=Se(ne,ce[Ct],we),Qe!==null&&(ee=C(Qe,ee,Ct),ea===null?at=Qe:ea.sibling=Qe,ea=Qe);return Yt&&Ur(ne,Ct),at}for(Qe=f(Qe);Ct<ce.length;Ct++)Ut=pe(Qe,ne,Ct,ce[Ct],we),Ut!==null&&(n&&Ut.alternate!==null&&Qe.delete(Ut.key===null?Ct:Ut.key),ee=C(Ut,ee,Ct),ea===null?at=Ut:ea.sibling=Ut,ea=Ut);return n&&Qe.forEach(function(Ki){return i(ne,Ki)}),Yt&&Ur(ne,Ct),at}function ot(ne,ee,ce,we){if(ce==null)throw Error(r(151));for(var at=null,ea=null,Qe=ee,Ct=ee=0,Ut=null,ta=ce.next();Qe!==null&&!ta.done;Ct++,ta=ce.next()){Qe.index>Ct?(Ut=Qe,Qe=null):Ut=Qe.sibling;var Ki=ue(ne,Qe,ta.value,we);if(Ki===null){Qe===null&&(Qe=Ut);break}n&&Qe&&Ki.alternate===null&&i(ne,Qe),ee=C(Ki,ee,Ct),ea===null?at=Ki:ea.sibling=Ki,ea=Ki,Qe=Ut}if(ta.done)return c(ne,Qe),Yt&&Ur(ne,Ct),at;if(Qe===null){for(;!ta.done;Ct++,ta=ce.next())ta=Se(ne,ta.value,we),ta!==null&&(ee=C(ta,ee,Ct),ea===null?at=ta:ea.sibling=ta,ea=ta);return Yt&&Ur(ne,Ct),at}for(Qe=f(Qe);!ta.done;Ct++,ta=ce.next())ta=pe(Qe,ne,Ct,ta.value,we),ta!==null&&(n&&ta.alternate!==null&&Qe.delete(ta.key===null?Ct:ta.key),ee=C(ta,ee,Ct),ea===null?at=ta:ea.sibling=ta,ea=ta);return n&&Qe.forEach(function(iM){return i(ne,iM)}),Yt&&Ur(ne,Ct),at}function ha(ne,ee,ce,we){if(typeof ce=="object"&&ce!==null&&ce.type===N&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case v:e:{for(var at=ce.key;ee!==null;){if(ee.key===at){if(at=ce.type,at===N){if(ee.tag===7){c(ne,ee.sibling),we=j(ee,ce.props.children),we.return=ne,ne=we;break e}}else if(ee.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===L&&Il(at)===ee.type){c(ne,ee.sibling),we=j(ee,ce.props),ad(we,ce),we.return=ne,ne=we;break e}c(ne,ee);break}else i(ne,ee);ee=ee.sibling}ce.type===N?(we=Al(ce.props.children,ne.mode,we,ce.key),we.return=ne,ne=we):(we=nm(ce.type,ce.key,ce.props,null,ne.mode,we),ad(we,ce),we.return=ne,ne=we)}return A(ne);case b:e:{for(at=ce.key;ee!==null;){if(ee.key===at)if(ee.tag===4&&ee.stateNode.containerInfo===ce.containerInfo&&ee.stateNode.implementation===ce.implementation){c(ne,ee.sibling),we=j(ee,ce.children||[]),we.return=ne,ne=we;break e}else{c(ne,ee);break}else i(ne,ee);ee=ee.sibling}we=Tp(ce,ne.mode,we),we.return=ne,ne=we}return A(ne);case L:return ce=Il(ce),ha(ne,ee,ce,we)}if(H(ce))return Ge(ne,ee,ce,we);if(G(ce)){if(at=G(ce),typeof at!="function")throw Error(r(150));return ce=at.call(ce),ot(ne,ee,ce,we)}if(typeof ce.then=="function")return ha(ne,ee,um(ce),we);if(ce.$$typeof===T)return ha(ne,ee,lm(ne,ce),we);mm(ne,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ee!==null&&ee.tag===6?(c(ne,ee.sibling),we=j(ee,ce),we.return=ne,ne=we):(c(ne,ee),we=Ep(ce,ne.mode,we),we.return=ne,ne=we),A(ne)):c(ne,ee)}return function(ne,ee,ce,we){try{td=0;var at=ha(ne,ee,ce,we);return zo=null,at}catch(Qe){if(Qe===Io||Qe===cm)throw Qe;var ea=dn(29,Qe,null,ne.mode);return ea.lanes=we,ea.return=ne,ea}}}var Ll=gb(!0),yb=gb(!1),Mi=!1;function Bp(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $p(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Oi(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ri(n,i,c){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,(ra&2)!==0){var j=f.pending;return j===null?i.next=i:(i.next=j.next,j.next=i),f.pending=i,i=sm(n),tb(n,null,c),i}return am(n,f,i,c),sm(n)}function sd(n,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var f=i.lanes;f&=n.pendingLanes,c|=f,i.lanes=c,qt(n,c)}}function Hp(n,i){var c=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var j=null,C=null;if(c=c.firstBaseUpdate,c!==null){do{var A={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};C===null?j=C=A:C=C.next=A,c=c.next}while(c!==null);C===null?j=C=i:C=C.next=i}else j=C=i;c={baseState:f.baseState,firstBaseUpdate:j,lastBaseUpdate:C,shared:f.shared,callbacks:f.callbacks},n.updateQueue=c;return}n=c.lastBaseUpdate,n===null?c.firstBaseUpdate=i:n.next=i,c.lastBaseUpdate=i}var Up=!1;function nd(){if(Up){var n=Ro;if(n!==null)throw n}}function rd(n,i,c,f){Up=!1;var j=n.updateQueue;Mi=!1;var C=j.firstBaseUpdate,A=j.lastBaseUpdate,B=j.shared.pending;if(B!==null){j.shared.pending=null;var Z=B,de=Z.next;Z.next=null,A===null?C=de:A.next=de,A=Z;var be=n.alternate;be!==null&&(be=be.updateQueue,B=be.lastBaseUpdate,B!==A&&(B===null?be.firstBaseUpdate=de:B.next=de,be.lastBaseUpdate=Z))}if(C!==null){var Se=j.baseState;A=0,be=de=Z=null,B=C;do{var ue=B.lane&-536870913,pe=ue!==B.lane;if(pe?(Ht&ue)===ue:(f&ue)===ue){ue!==0&&ue===Oo&&(Up=!0),be!==null&&(be=be.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var Ge=n,ot=B;ue=i;var ha=c;switch(ot.tag){case 1:if(Ge=ot.payload,typeof Ge=="function"){Se=Ge.call(ha,Se,ue);break e}Se=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=ot.payload,ue=typeof Ge=="function"?Ge.call(ha,Se,ue):Ge,ue==null)break e;Se=x({},Se,ue);break e;case 2:Mi=!0}}ue=B.callback,ue!==null&&(n.flags|=64,pe&&(n.flags|=8192),pe=j.callbacks,pe===null?j.callbacks=[ue]:pe.push(ue))}else pe={lane:ue,tag:B.tag,payload:B.payload,callback:B.callback,next:null},be===null?(de=be=pe,Z=Se):be=be.next=pe,A|=ue;if(B=B.next,B===null){if(B=j.shared.pending,B===null)break;pe=B,B=pe.next,pe.next=null,j.lastBaseUpdate=pe,j.shared.pending=null}}while(!0);be===null&&(Z=Se),j.baseState=Z,j.firstBaseUpdate=de,j.lastBaseUpdate=be,C===null&&(j.shared.lanes=0),Bi|=A,n.lanes=A,n.memoizedState=Se}}function vb(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function bb(n,i){var c=n.callbacks;if(c!==null)for(n.callbacks=null,n=0;n<c.length;n++)vb(c[n],i)}var Lo=Q(null),hm=Q(0);function jb(n,i){n=Jr,M(hm,n),M(Lo,i),Jr=n|i.baseLanes}function Vp(){M(hm,Jr),M(Lo,Lo.current)}function Yp(){Jr=hm.current,q(Lo),q(hm)}var un=Q(null),In=null;function Ii(n){var i=n.alternate;M(Ga,Ga.current&1),M(un,n),In===null&&(i===null||Lo.current!==null||i.memoizedState!==null)&&(In=n)}function qp(n){M(Ga,Ga.current),M(un,n),In===null&&(In=n)}function Nb(n){n.tag===22?(M(Ga,Ga.current),M(un,n),In===null&&(In=n)):zi()}function zi(){M(Ga,Ga.current),M(un,un.current)}function mn(n){q(un),In===n&&(In=null),q(Ga)}var Ga=Q(0);function fm(n){for(var i=n;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Qx(c)||Zx(c)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var qr=0,St=null,ua=null,Xa=null,pm=!1,Po=!1,Pl=!1,xm=0,id=0,Bo=null,XA=0;function Ba(){throw Error(r(321))}function Fp(n,i){if(i===null)return!1;for(var c=0;c<i.length&&c<n.length;c++)if(!cn(n[c],i[c]))return!1;return!0}function Gp(n,i,c,f,j,C){return qr=C,St=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,I.H=n===null||n.memoizedState===null?rj:ox,Pl=!1,C=c(f,j),Pl=!1,Po&&(C=Sb(i,c,f,j)),wb(n),C}function wb(n){I.H=cd;var i=ua!==null&&ua.next!==null;if(qr=0,Xa=ua=St=null,pm=!1,id=0,Bo=null,i)throw Error(r(300));n===null||Qa||(n=n.dependencies,n!==null&&im(n)&&(Qa=!0))}function Sb(n,i,c,f){St=n;var j=0;do{if(Po&&(Bo=null),id=0,Po=!1,25<=j)throw Error(r(301));if(j+=1,Xa=ua=null,n.updateQueue!=null){var C=n.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}I.H=ij,C=i(c,f)}while(Po);return C}function QA(){var n=I.H,i=n.useState()[0];return i=typeof i.then=="function"?ld(i):i,n=n.useState()[0],(ua!==null?ua.memoizedState:null)!==n&&(St.flags|=1024),i}function Wp(){var n=xm!==0;return xm=0,n}function Kp(n,i,c){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~c}function Xp(n){if(pm){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}pm=!1}qr=0,Xa=ua=St=null,Po=!1,id=xm=0,Bo=null}function Os(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xa===null?St.memoizedState=Xa=n:Xa=Xa.next=n,Xa}function Wa(){if(ua===null){var n=St.alternate;n=n!==null?n.memoizedState:null}else n=ua.next;var i=Xa===null?St.memoizedState:Xa.next;if(i!==null)Xa=i,ua=n;else{if(n===null)throw St.alternate===null?Error(r(467)):Error(r(310));ua=n,n={memoizedState:ua.memoizedState,baseState:ua.baseState,baseQueue:ua.baseQueue,queue:ua.queue,next:null},Xa===null?St.memoizedState=Xa=n:Xa=Xa.next=n}return Xa}function gm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ld(n){var i=id;return id+=1,Bo===null&&(Bo=[]),n=fb(Bo,n,i),i=St,(Xa===null?i.memoizedState:Xa.next)===null&&(i=i.alternate,I.H=i===null||i.memoizedState===null?rj:ox),n}function ym(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return ld(n);if(n.$$typeof===T)return js(n)}throw Error(r(438,String(n)))}function Qp(n){var i=null,c=St.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var f=St.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(i={data:f.data.map(function(j){return j.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=gm(),St.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(n),f=0;f<n;f++)c[f]=V;return i.index++,c}function Fr(n,i){return typeof i=="function"?i(n):i}function vm(n){var i=Wa();return Zp(i,ua,n)}function Zp(n,i,c){var f=n.queue;if(f===null)throw Error(r(311));f.lastRenderedReducer=c;var j=n.baseQueue,C=f.pending;if(C!==null){if(j!==null){var A=j.next;j.next=C.next,C.next=A}i.baseQueue=j=C,f.pending=null}if(C=n.baseState,j===null)n.memoizedState=C;else{i=j.next;var B=A=null,Z=null,de=i,be=!1;do{var Se=de.lane&-536870913;if(Se!==de.lane?(Ht&Se)===Se:(qr&Se)===Se){var ue=de.revertLane;if(ue===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),Se===Oo&&(be=!0);else if((qr&ue)===ue){de=de.next,ue===Oo&&(be=!0);continue}else Se={lane:0,revertLane:de.revertLane,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},Z===null?(B=Z=Se,A=C):Z=Z.next=Se,St.lanes|=ue,Bi|=ue;Se=de.action,Pl&&c(C,Se),C=de.hasEagerState?de.eagerState:c(C,Se)}else ue={lane:Se,revertLane:de.revertLane,gesture:de.gesture,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},Z===null?(B=Z=ue,A=C):Z=Z.next=ue,St.lanes|=Se,Bi|=Se;de=de.next}while(de!==null&&de!==i);if(Z===null?A=C:Z.next=B,!cn(C,n.memoizedState)&&(Qa=!0,be&&(c=Ro,c!==null)))throw c;n.memoizedState=C,n.baseState=A,n.baseQueue=Z,f.lastRenderedState=C}return j===null&&(f.lanes=0),[n.memoizedState,f.dispatch]}function Jp(n){var i=Wa(),c=i.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=n;var f=c.dispatch,j=c.pending,C=i.memoizedState;if(j!==null){c.pending=null;var A=j=j.next;do C=n(C,A.action),A=A.next;while(A!==j);cn(C,i.memoizedState)||(Qa=!0),i.memoizedState=C,i.baseQueue===null&&(i.baseState=C),c.lastRenderedState=C}return[C,f]}function Cb(n,i,c){var f=St,j=Wa(),C=Yt;if(C){if(c===void 0)throw Error(r(407));c=c()}else c=i();var A=!cn((ua||j).memoizedState,c);if(A&&(j.memoizedState=c,Qa=!0),j=j.queue,ax(Db.bind(null,f,j,n),[n]),j.getSnapshot!==i||A||Xa!==null&&Xa.memoizedState.tag&1){if(f.flags|=2048,$o(9,{destroy:void 0},Tb.bind(null,f,j,c,i),null),ga===null)throw Error(r(349));C||(qr&127)!==0||Eb(f,i,c)}return c}function Eb(n,i,c){n.flags|=16384,n={getSnapshot:i,value:c},i=St.updateQueue,i===null?(i=gm(),St.updateQueue=i,i.stores=[n]):(c=i.stores,c===null?i.stores=[n]:c.push(n))}function Tb(n,i,c,f){i.value=c,i.getSnapshot=f,kb(i)&&Ab(n)}function Db(n,i,c){return c(function(){kb(i)&&Ab(n)})}function kb(n){var i=n.getSnapshot;n=n.value;try{var c=i();return!cn(n,c)}catch{return!0}}function Ab(n){var i=kl(n,2);i!==null&&Xs(i,n,2)}function ex(n){var i=Os();if(typeof n=="function"){var c=n;if(n=c(),Pl){bt(!0);try{c()}finally{bt(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fr,lastRenderedState:n},i}function _b(n,i,c,f){return n.baseState=c,Zp(n,ua,typeof f=="function"?f:Fr)}function ZA(n,i,c,f,j){if(Nm(n))throw Error(r(485));if(n=i.action,n!==null){var C={payload:j,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){C.listeners.push(A)}};I.T!==null?c(!0):C.isTransition=!1,f(C),c=i.pending,c===null?(C.next=i.pending=C,Mb(i,C)):(C.next=c.next,i.pending=c.next=C)}}function Mb(n,i){var c=i.action,f=i.payload,j=n.state;if(i.isTransition){var C=I.T,A={};I.T=A;try{var B=c(j,f),Z=I.S;Z!==null&&Z(A,B),Ob(n,i,B)}catch(de){tx(n,i,de)}finally{C!==null&&A.types!==null&&(C.types=A.types),I.T=C}}else try{C=c(j,f),Ob(n,i,C)}catch(de){tx(n,i,de)}}function Ob(n,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){Rb(n,i,f)},function(f){return tx(n,i,f)}):Rb(n,i,c)}function Rb(n,i,c){i.status="fulfilled",i.value=c,Ib(i),n.state=c,i=n.pending,i!==null&&(c=i.next,c===i?n.pending=null:(c=c.next,i.next=c,Mb(n,c)))}function tx(n,i,c){var f=n.pending;if(n.pending=null,f!==null){f=f.next;do i.status="rejected",i.reason=c,Ib(i),i=i.next;while(i!==f)}n.action=null}function Ib(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function zb(n,i){return i}function Lb(n,i){if(Yt){var c=ga.formState;if(c!==null){e:{var f=St;if(Yt){if(Ca){t:{for(var j=Ca,C=Rn;j.nodeType!==8;){if(!C){j=null;break t}if(j=zn(j.nextSibling),j===null){j=null;break t}}C=j.data,j=C==="F!"||C==="F"?j:null}if(j){Ca=zn(j.nextSibling),f=j.data==="F!";break e}}Ai(f)}f=!1}f&&(i=c[0])}}return c=Os(),c.memoizedState=c.baseState=i,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zb,lastRenderedState:i},c.queue=f,c=aj.bind(null,St,f),f.dispatch=c,f=ex(!1),C=lx.bind(null,St,!1,f.queue),f=Os(),j={state:i,dispatch:null,action:n,pending:null},f.queue=j,c=ZA.bind(null,St,j,C,c),j.dispatch=c,f.memoizedState=n,[i,c,!1]}function Pb(n){var i=Wa();return Bb(i,ua,n)}function Bb(n,i,c){if(i=Zp(n,i,zb)[0],n=vm(Fr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var f=ld(i)}catch(A){throw A===Io?cm:A}else f=i;i=Wa();var j=i.queue,C=j.dispatch;return c!==i.memoizedState&&(St.flags|=2048,$o(9,{destroy:void 0},JA.bind(null,j,c),null)),[f,C,n]}function JA(n,i){n.action=i}function $b(n){var i=Wa(),c=ua;if(c!==null)return Bb(i,c,n);Wa(),i=i.memoizedState,c=Wa();var f=c.queue.dispatch;return c.memoizedState=n,[i,f,!1]}function $o(n,i,c,f){return n={tag:n,create:c,deps:f,inst:i,next:null},i=St.updateQueue,i===null&&(i=gm(),St.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=n.next=n:(f=c.next,c.next=n,n.next=f,i.lastEffect=n),n}function Hb(){return Wa().memoizedState}function bm(n,i,c,f){var j=Os();St.flags|=n,j.memoizedState=$o(1|i,{destroy:void 0},c,f===void 0?null:f)}function jm(n,i,c,f){var j=Wa();f=f===void 0?null:f;var C=j.memoizedState.inst;ua!==null&&f!==null&&Fp(f,ua.memoizedState.deps)?j.memoizedState=$o(i,C,c,f):(St.flags|=n,j.memoizedState=$o(1|i,C,c,f))}function Ub(n,i){bm(8390656,8,n,i)}function ax(n,i){jm(2048,8,n,i)}function e_(n){St.flags|=4;var i=St.updateQueue;if(i===null)i=gm(),St.updateQueue=i,i.events=[n];else{var c=i.events;c===null?i.events=[n]:c.push(n)}}function Vb(n){var i=Wa().memoizedState;return e_({ref:i,nextImpl:n}),function(){if((ra&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function Yb(n,i){return jm(4,2,n,i)}function qb(n,i){return jm(4,4,n,i)}function Fb(n,i){if(typeof i=="function"){n=n();var c=i(n);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Gb(n,i,c){c=c!=null?c.concat([n]):null,jm(4,4,Fb.bind(null,i,n),c)}function sx(){}function Wb(n,i){var c=Wa();i=i===void 0?null:i;var f=c.memoizedState;return i!==null&&Fp(i,f[1])?f[0]:(c.memoizedState=[n,i],n)}function Kb(n,i){var c=Wa();i=i===void 0?null:i;var f=c.memoizedState;if(i!==null&&Fp(i,f[1]))return f[0];if(f=n(),Pl){bt(!0);try{n()}finally{bt(!1)}}return c.memoizedState=[f,i],f}function nx(n,i,c){return c===void 0||(qr&1073741824)!==0&&(Ht&261930)===0?n.memoizedState=i:(n.memoizedState=c,n=Xj(),St.lanes|=n,Bi|=n,c)}function Xb(n,i,c,f){return cn(c,i)?c:Lo.current!==null?(n=nx(n,c,f),cn(n,i)||(Qa=!0),n):(qr&42)===0||(qr&1073741824)!==0&&(Ht&261930)===0?(Qa=!0,n.memoizedState=c):(n=Xj(),St.lanes|=n,Bi|=n,i)}function Qb(n,i,c,f,j){var C=O.p;O.p=C!==0&&8>C?C:8;var A=I.T,B={};I.T=B,lx(n,!1,i,c);try{var Z=j(),de=I.S;if(de!==null&&de(B,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var be=KA(Z,f);od(n,i,be,pn(n))}else od(n,i,f,pn(n))}catch(Se){od(n,i,{then:function(){},status:"rejected",reason:Se},pn())}finally{O.p=C,A!==null&&B.types!==null&&(A.types=B.types),I.T=A}}function t_(){}function rx(n,i,c,f){if(n.tag!==5)throw Error(r(476));var j=Zb(n).queue;Qb(n,j,i,Y,c===null?t_:function(){return Jb(n),c(f)})}function Zb(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fr,lastRenderedState:Y},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Fr,lastRenderedState:c},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function Jb(n){var i=Zb(n);i.next===null&&(i=n.alternate.memoizedState),od(n,i.next.queue,{},pn())}function ix(){return js(Cd)}function ej(){return Wa().memoizedState}function tj(){return Wa().memoizedState}function a_(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var c=pn();n=Oi(c);var f=Ri(i,n,c);f!==null&&(Xs(f,i,c),sd(f,i,c)),i={cache:Ip()},n.payload=i;return}i=i.return}}function s_(n,i,c){var f=pn();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Nm(n)?sj(i,c):(c=Sp(n,i,c,f),c!==null&&(Xs(c,n,f),nj(c,i,f)))}function aj(n,i,c){var f=pn();od(n,i,c,f)}function od(n,i,c,f){var j={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Nm(n))sj(i,j);else{var C=n.alternate;if(n.lanes===0&&(C===null||C.lanes===0)&&(C=i.lastRenderedReducer,C!==null))try{var A=i.lastRenderedState,B=C(A,c);if(j.hasEagerState=!0,j.eagerState=B,cn(B,A))return am(n,i,j,0),ga===null&&tm(),!1}catch{}if(c=Sp(n,i,j,f),c!==null)return Xs(c,n,f),nj(c,i,f),!0}return!1}function lx(n,i,c,f){if(f={lane:2,revertLane:Bx(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Nm(n)){if(i)throw Error(r(479))}else i=Sp(n,c,f,2),i!==null&&Xs(i,n,2)}function Nm(n){var i=n.alternate;return n===St||i!==null&&i===St}function sj(n,i){Po=pm=!0;var c=n.pending;c===null?i.next=i:(i.next=c.next,c.next=i),n.pending=i}function nj(n,i,c){if((c&4194048)!==0){var f=i.lanes;f&=n.pendingLanes,c|=f,i.lanes=c,qt(n,c)}}var cd={readContext:js,use:ym,useCallback:Ba,useContext:Ba,useEffect:Ba,useImperativeHandle:Ba,useLayoutEffect:Ba,useInsertionEffect:Ba,useMemo:Ba,useReducer:Ba,useRef:Ba,useState:Ba,useDebugValue:Ba,useDeferredValue:Ba,useTransition:Ba,useSyncExternalStore:Ba,useId:Ba,useHostTransitionStatus:Ba,useFormState:Ba,useActionState:Ba,useOptimistic:Ba,useMemoCache:Ba,useCacheRefresh:Ba};cd.useEffectEvent=Ba;var rj={readContext:js,use:ym,useCallback:function(n,i){return Os().memoizedState=[n,i===void 0?null:i],n},useContext:js,useEffect:Ub,useImperativeHandle:function(n,i,c){c=c!=null?c.concat([n]):null,bm(4194308,4,Fb.bind(null,i,n),c)},useLayoutEffect:function(n,i){return bm(4194308,4,n,i)},useInsertionEffect:function(n,i){bm(4,2,n,i)},useMemo:function(n,i){var c=Os();i=i===void 0?null:i;var f=n();if(Pl){bt(!0);try{n()}finally{bt(!1)}}return c.memoizedState=[f,i],f},useReducer:function(n,i,c){var f=Os();if(c!==void 0){var j=c(i);if(Pl){bt(!0);try{c(i)}finally{bt(!1)}}}else j=i;return f.memoizedState=f.baseState=j,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:j},f.queue=n,n=n.dispatch=s_.bind(null,St,n),[f.memoizedState,n]},useRef:function(n){var i=Os();return n={current:n},i.memoizedState=n},useState:function(n){n=ex(n);var i=n.queue,c=aj.bind(null,St,i);return i.dispatch=c,[n.memoizedState,c]},useDebugValue:sx,useDeferredValue:function(n,i){var c=Os();return nx(c,n,i)},useTransition:function(){var n=ex(!1);return n=Qb.bind(null,St,n.queue,!0,!1),Os().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,c){var f=St,j=Os();if(Yt){if(c===void 0)throw Error(r(407));c=c()}else{if(c=i(),ga===null)throw Error(r(349));(Ht&127)!==0||Eb(f,i,c)}j.memoizedState=c;var C={value:c,getSnapshot:i};return j.queue=C,Ub(Db.bind(null,f,C,n),[n]),f.flags|=2048,$o(9,{destroy:void 0},Tb.bind(null,f,C,c,i),null),c},useId:function(){var n=Os(),i=ga.identifierPrefix;if(Yt){var c=br,f=vr;c=(f&~(1<<32-Pt(f)-1)).toString(32)+c,i="_"+i+"R_"+c,c=xm++,0<c&&(i+="H"+c.toString(32)),i+="_"}else c=XA++,i="_"+i+"r_"+c.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:ix,useFormState:Lb,useActionState:Lb,useOptimistic:function(n){var i=Os();i.memoizedState=i.baseState=n;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=lx.bind(null,St,!0,c),c.dispatch=i,[n,i]},useMemoCache:Qp,useCacheRefresh:function(){return Os().memoizedState=a_.bind(null,St)},useEffectEvent:function(n){var i=Os(),c={impl:n};return i.memoizedState=c,function(){if((ra&2)!==0)throw Error(r(440));return c.impl.apply(void 0,arguments)}}},ox={readContext:js,use:ym,useCallback:Wb,useContext:js,useEffect:ax,useImperativeHandle:Gb,useInsertionEffect:Yb,useLayoutEffect:qb,useMemo:Kb,useReducer:vm,useRef:Hb,useState:function(){return vm(Fr)},useDebugValue:sx,useDeferredValue:function(n,i){var c=Wa();return Xb(c,ua.memoizedState,n,i)},useTransition:function(){var n=vm(Fr)[0],i=Wa().memoizedState;return[typeof n=="boolean"?n:ld(n),i]},useSyncExternalStore:Cb,useId:ej,useHostTransitionStatus:ix,useFormState:Pb,useActionState:Pb,useOptimistic:function(n,i){var c=Wa();return _b(c,ua,n,i)},useMemoCache:Qp,useCacheRefresh:tj};ox.useEffectEvent=Vb;var ij={readContext:js,use:ym,useCallback:Wb,useContext:js,useEffect:ax,useImperativeHandle:Gb,useInsertionEffect:Yb,useLayoutEffect:qb,useMemo:Kb,useReducer:Jp,useRef:Hb,useState:function(){return Jp(Fr)},useDebugValue:sx,useDeferredValue:function(n,i){var c=Wa();return ua===null?nx(c,n,i):Xb(c,ua.memoizedState,n,i)},useTransition:function(){var n=Jp(Fr)[0],i=Wa().memoizedState;return[typeof n=="boolean"?n:ld(n),i]},useSyncExternalStore:Cb,useId:ej,useHostTransitionStatus:ix,useFormState:$b,useActionState:$b,useOptimistic:function(n,i){var c=Wa();return ua!==null?_b(c,ua,n,i):(c.baseState=n,[n,c.queue.dispatch])},useMemoCache:Qp,useCacheRefresh:tj};ij.useEffectEvent=Vb;function cx(n,i,c,f){i=n.memoizedState,c=c(f,i),c=c==null?i:x({},i,c),n.memoizedState=c,n.lanes===0&&(n.updateQueue.baseState=c)}var dx={enqueueSetState:function(n,i,c){n=n._reactInternals;var f=pn(),j=Oi(f);j.payload=i,c!=null&&(j.callback=c),i=Ri(n,j,f),i!==null&&(Xs(i,n,f),sd(i,n,f))},enqueueReplaceState:function(n,i,c){n=n._reactInternals;var f=pn(),j=Oi(f);j.tag=1,j.payload=i,c!=null&&(j.callback=c),i=Ri(n,j,f),i!==null&&(Xs(i,n,f),sd(i,n,f))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var c=pn(),f=Oi(c);f.tag=2,i!=null&&(f.callback=i),i=Ri(n,f,c),i!==null&&(Xs(i,n,c),sd(i,n,c))}};function lj(n,i,c,f,j,C,A){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,C,A):i.prototype&&i.prototype.isPureReactComponent?!Kc(c,f)||!Kc(j,C):!0}function oj(n,i,c,f){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,f),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,f),i.state!==n&&dx.enqueueReplaceState(i,i.state,null)}function Bl(n,i){var c=i;if("ref"in i){c={};for(var f in i)f!=="ref"&&(c[f]=i[f])}if(n=n.defaultProps){c===i&&(c=x({},c));for(var j in n)c[j]===void 0&&(c[j]=n[j])}return c}function cj(n){em(n)}function dj(n){console.error(n)}function uj(n){em(n)}function wm(n,i){try{var c=n.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(f){setTimeout(function(){throw f})}}function mj(n,i,c){try{var f=n.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function ux(n,i,c){return c=Oi(c),c.tag=3,c.payload={element:null},c.callback=function(){wm(n,i)},c}function hj(n){return n=Oi(n),n.tag=3,n}function fj(n,i,c,f){var j=c.type.getDerivedStateFromError;if(typeof j=="function"){var C=f.value;n.payload=function(){return j(C)},n.callback=function(){mj(i,c,f)}}var A=c.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(n.callback=function(){mj(i,c,f),typeof j!="function"&&($i===null?$i=new Set([this]):$i.add(this));var B=f.stack;this.componentDidCatch(f.value,{componentStack:B!==null?B:""})})}function n_(n,i,c,f,j){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(i=c.alternate,i!==null&&Mo(i,c,j,!0),c=un.current,c!==null){switch(c.tag){case 31:case 13:return In===null?Im():c.alternate===null&&$a===0&&($a=3),c.flags&=-257,c.flags|=65536,c.lanes=j,f===dm?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([f]):i.add(f),zx(n,f,j)),!1;case 22:return c.flags|=65536,f===dm?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([f]):c.add(f)),zx(n,f,j)),!1}throw Error(r(435,c.tag))}return zx(n,f,j),Im(),!1}if(Yt)return i=un.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=j,f!==Ap&&(n=Error(r(422),{cause:f}),Zc(_n(n,c)))):(f!==Ap&&(i=Error(r(423),{cause:f}),Zc(_n(i,c))),n=n.current.alternate,n.flags|=65536,j&=-j,n.lanes|=j,f=_n(f,c),j=ux(n.stateNode,f,j),Hp(n,j),$a!==4&&($a=2)),!1;var C=Error(r(520),{cause:f});if(C=_n(C,c),gd===null?gd=[C]:gd.push(C),$a!==4&&($a=2),i===null)return!0;f=_n(f,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,n=j&-j,c.lanes|=n,n=ux(c.stateNode,f,n),Hp(c,n),!1;case 1:if(i=c.type,C=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&($i===null||!$i.has(C))))return c.flags|=65536,j&=-j,c.lanes|=j,j=hj(j),fj(j,n,c,f),Hp(c,j),!1}c=c.return}while(c!==null);return!1}var mx=Error(r(461)),Qa=!1;function Ns(n,i,c,f){i.child=n===null?yb(i,null,c,f):Ll(i,n.child,c,f)}function pj(n,i,c,f,j){c=c.render;var C=i.ref;if("ref"in f){var A={};for(var B in f)B!=="ref"&&(A[B]=f[B])}else A=f;return Ol(i),f=Gp(n,i,c,A,C,j),B=Wp(),n!==null&&!Qa?(Kp(n,i,j),Gr(n,i,j)):(Yt&&B&&Dp(i),i.flags|=1,Ns(n,i,f,j),i.child)}function xj(n,i,c,f,j){if(n===null){var C=c.type;return typeof C=="function"&&!Cp(C)&&C.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=C,gj(n,i,C,f,j)):(n=nm(c.type,null,f,i,i.mode,j),n.ref=i.ref,n.return=i,i.child=n)}if(C=n.child,!bx(n,j)){var A=C.memoizedProps;if(c=c.compare,c=c!==null?c:Kc,c(A,f)&&n.ref===i.ref)return Gr(n,i,j)}return i.flags|=1,n=Hr(C,f),n.ref=i.ref,n.return=i,i.child=n}function gj(n,i,c,f,j){if(n!==null){var C=n.memoizedProps;if(Kc(C,f)&&n.ref===i.ref)if(Qa=!1,i.pendingProps=f=C,bx(n,j))(n.flags&131072)!==0&&(Qa=!0);else return i.lanes=n.lanes,Gr(n,i,j)}return hx(n,i,c,f,j)}function yj(n,i,c,f){var j=f.children,C=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((i.flags&128)!==0){if(C=C!==null?C.baseLanes|c:c,n!==null){for(f=i.child=n.child,j=0;f!==null;)j=j|f.lanes|f.childLanes,f=f.sibling;f=j&~C}else f=0,i.child=null;return vj(n,i,C,c,f)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&om(i,C!==null?C.cachePool:null),C!==null?jb(i,C):Vp(),Nb(i);else return f=i.lanes=536870912,vj(n,i,C!==null?C.baseLanes|c:c,c,f)}else C!==null?(om(i,C.cachePool),jb(i,C),zi(),i.memoizedState=null):(n!==null&&om(i,null),Vp(),zi());return Ns(n,i,j,c),i.child}function dd(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function vj(n,i,c,f,j){var C=Lp();return C=C===null?null:{parent:Ka._currentValue,pool:C},i.memoizedState={baseLanes:c,cachePool:C},n!==null&&om(i,null),Vp(),Nb(i),n!==null&&Mo(n,i,f,!0),i.childLanes=j,null}function Sm(n,i){return i=Em({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function bj(n,i,c){return Ll(i,n.child,null,c),n=Sm(i,i.pendingProps),n.flags|=2,mn(i),i.memoizedState=null,n}function r_(n,i,c){var f=i.pendingProps,j=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Yt){if(f.mode==="hidden")return n=Sm(i,f),i.lanes=536870912,dd(null,n);if(qp(i),(n=Ca)?(n=MN(n,Rn),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Di!==null?{id:vr,overflow:br}:null,retryLane:536870912,hydrationErrors:null},c=sb(n),c.return=i,i.child=c,bs=i,Ca=null)):n=null,n===null)throw Ai(i);return i.lanes=536870912,null}return Sm(i,f)}var C=n.memoizedState;if(C!==null){var A=C.dehydrated;if(qp(i),j)if(i.flags&256)i.flags&=-257,i=bj(n,i,c);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(r(558));else if(Qa||Mo(n,i,c,!1),j=(c&n.childLanes)!==0,Qa||j){if(f=ga,f!==null&&(A=da(f,c),A!==0&&A!==C.retryLane))throw C.retryLane=A,kl(n,A),Xs(f,n,A),mx;Im(),i=bj(n,i,c)}else n=C.treeContext,Ca=zn(A.nextSibling),bs=i,Yt=!0,ki=null,Rn=!1,n!==null&&ib(i,n),i=Sm(i,f),i.flags|=4096;return i}return n=Hr(n.child,{mode:f.mode,children:f.children}),n.ref=i.ref,i.child=n,n.return=i,n}function Cm(n,i){var c=i.ref;if(c===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(r(284));(n===null||n.ref!==c)&&(i.flags|=4194816)}}function hx(n,i,c,f,j){return Ol(i),c=Gp(n,i,c,f,void 0,j),f=Wp(),n!==null&&!Qa?(Kp(n,i,j),Gr(n,i,j)):(Yt&&f&&Dp(i),i.flags|=1,Ns(n,i,c,j),i.child)}function jj(n,i,c,f,j,C){return Ol(i),i.updateQueue=null,c=Sb(i,f,c,j),wb(n),f=Wp(),n!==null&&!Qa?(Kp(n,i,C),Gr(n,i,C)):(Yt&&f&&Dp(i),i.flags|=1,Ns(n,i,c,C),i.child)}function Nj(n,i,c,f,j){if(Ol(i),i.stateNode===null){var C=Do,A=c.contextType;typeof A=="object"&&A!==null&&(C=js(A)),C=new c(f,C),i.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=dx,i.stateNode=C,C._reactInternals=i,C=i.stateNode,C.props=f,C.state=i.memoizedState,C.refs={},Bp(i),A=c.contextType,C.context=typeof A=="object"&&A!==null?js(A):Do,C.state=i.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(cx(i,c,A,f),C.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(A=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),A!==C.state&&dx.enqueueReplaceState(C,C.state,null),rd(i,f,C,j),nd(),C.state=i.memoizedState),typeof C.componentDidMount=="function"&&(i.flags|=4194308),f=!0}else if(n===null){C=i.stateNode;var B=i.memoizedProps,Z=Bl(c,B);C.props=Z;var de=C.context,be=c.contextType;A=Do,typeof be=="object"&&be!==null&&(A=js(be));var Se=c.getDerivedStateFromProps;be=typeof Se=="function"||typeof C.getSnapshotBeforeUpdate=="function",B=i.pendingProps!==B,be||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(B||de!==A)&&oj(i,C,f,A),Mi=!1;var ue=i.memoizedState;C.state=ue,rd(i,f,C,j),nd(),de=i.memoizedState,B||ue!==de||Mi?(typeof Se=="function"&&(cx(i,c,Se,f),de=i.memoizedState),(Z=Mi||lj(i,c,Z,f,ue,de,A))?(be||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(i.flags|=4194308)):(typeof C.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=f,i.memoizedState=de),C.props=f,C.state=de,C.context=A,f=Z):(typeof C.componentDidMount=="function"&&(i.flags|=4194308),f=!1)}else{C=i.stateNode,$p(n,i),A=i.memoizedProps,be=Bl(c,A),C.props=be,Se=i.pendingProps,ue=C.context,de=c.contextType,Z=Do,typeof de=="object"&&de!==null&&(Z=js(de)),B=c.getDerivedStateFromProps,(de=typeof B=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(A!==Se||ue!==Z)&&oj(i,C,f,Z),Mi=!1,ue=i.memoizedState,C.state=ue,rd(i,f,C,j),nd();var pe=i.memoizedState;A!==Se||ue!==pe||Mi||n!==null&&n.dependencies!==null&&im(n.dependencies)?(typeof B=="function"&&(cx(i,c,B,f),pe=i.memoizedState),(be=Mi||lj(i,c,be,f,ue,pe,Z)||n!==null&&n.dependencies!==null&&im(n.dependencies))?(de||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(f,pe,Z),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(f,pe,Z)),typeof C.componentDidUpdate=="function"&&(i.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof C.componentDidUpdate!="function"||A===n.memoizedProps&&ue===n.memoizedState||(i.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&ue===n.memoizedState||(i.flags|=1024),i.memoizedProps=f,i.memoizedState=pe),C.props=f,C.state=pe,C.context=Z,f=be):(typeof C.componentDidUpdate!="function"||A===n.memoizedProps&&ue===n.memoizedState||(i.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||A===n.memoizedProps&&ue===n.memoizedState||(i.flags|=1024),f=!1)}return C=f,Cm(n,i),f=(i.flags&128)!==0,C||f?(C=i.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:C.render(),i.flags|=1,n!==null&&f?(i.child=Ll(i,n.child,null,j),i.child=Ll(i,null,c,j)):Ns(n,i,c,j),i.memoizedState=C.state,n=i.child):n=Gr(n,i,j),n}function wj(n,i,c,f){return _l(),i.flags|=256,Ns(n,i,c,f),i.child}var fx={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function px(n){return{baseLanes:n,cachePool:mb()}}function xx(n,i,c){return n=n!==null?n.childLanes&~c:0,i&&(n|=fn),n}function Sj(n,i,c){var f=i.pendingProps,j=!1,C=(i.flags&128)!==0,A;if((A=C)||(A=n!==null&&n.memoizedState===null?!1:(Ga.current&2)!==0),A&&(j=!0,i.flags&=-129),A=(i.flags&32)!==0,i.flags&=-33,n===null){if(Yt){if(j?Ii(i):zi(),(n=Ca)?(n=MN(n,Rn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Di!==null?{id:vr,overflow:br}:null,retryLane:536870912,hydrationErrors:null},c=sb(n),c.return=i,i.child=c,bs=i,Ca=null)):n=null,n===null)throw Ai(i);return Zx(n)?i.lanes=32:i.lanes=536870912,null}var B=f.children;return f=f.fallback,j?(zi(),j=i.mode,B=Em({mode:"hidden",children:B},j),f=Al(f,j,c,null),B.return=i,f.return=i,B.sibling=f,i.child=B,f=i.child,f.memoizedState=px(c),f.childLanes=xx(n,A,c),i.memoizedState=fx,dd(null,f)):(Ii(i),gx(i,B))}var Z=n.memoizedState;if(Z!==null&&(B=Z.dehydrated,B!==null)){if(C)i.flags&256?(Ii(i),i.flags&=-257,i=yx(n,i,c)):i.memoizedState!==null?(zi(),i.child=n.child,i.flags|=128,i=null):(zi(),B=f.fallback,j=i.mode,f=Em({mode:"visible",children:f.children},j),B=Al(B,j,c,null),B.flags|=2,f.return=i,B.return=i,f.sibling=B,i.child=f,Ll(i,n.child,null,c),f=i.child,f.memoizedState=px(c),f.childLanes=xx(n,A,c),i.memoizedState=fx,i=dd(null,f));else if(Ii(i),Zx(B)){if(A=B.nextSibling&&B.nextSibling.dataset,A)var de=A.dgst;A=de,f=Error(r(419)),f.stack="",f.digest=A,Zc({value:f,source:null,stack:null}),i=yx(n,i,c)}else if(Qa||Mo(n,i,c,!1),A=(c&n.childLanes)!==0,Qa||A){if(A=ga,A!==null&&(f=da(A,c),f!==0&&f!==Z.retryLane))throw Z.retryLane=f,kl(n,f),Xs(A,n,f),mx;Qx(B)||Im(),i=yx(n,i,c)}else Qx(B)?(i.flags|=192,i.child=n.child,i=null):(n=Z.treeContext,Ca=zn(B.nextSibling),bs=i,Yt=!0,ki=null,Rn=!1,n!==null&&ib(i,n),i=gx(i,f.children),i.flags|=4096);return i}return j?(zi(),B=f.fallback,j=i.mode,Z=n.child,de=Z.sibling,f=Hr(Z,{mode:"hidden",children:f.children}),f.subtreeFlags=Z.subtreeFlags&65011712,de!==null?B=Hr(de,B):(B=Al(B,j,c,null),B.flags|=2),B.return=i,f.return=i,f.sibling=B,i.child=f,dd(null,f),f=i.child,B=n.child.memoizedState,B===null?B=px(c):(j=B.cachePool,j!==null?(Z=Ka._currentValue,j=j.parent!==Z?{parent:Z,pool:Z}:j):j=mb(),B={baseLanes:B.baseLanes|c,cachePool:j}),f.memoizedState=B,f.childLanes=xx(n,A,c),i.memoizedState=fx,dd(n.child,f)):(Ii(i),c=n.child,n=c.sibling,c=Hr(c,{mode:"visible",children:f.children}),c.return=i,c.sibling=null,n!==null&&(A=i.deletions,A===null?(i.deletions=[n],i.flags|=16):A.push(n)),i.child=c,i.memoizedState=null,c)}function gx(n,i){return i=Em({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function Em(n,i){return n=dn(22,n,null,i),n.lanes=0,n}function yx(n,i,c){return Ll(i,n.child,null,c),n=gx(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function Cj(n,i,c){n.lanes|=i;var f=n.alternate;f!==null&&(f.lanes|=i),Op(n.return,i,c)}function vx(n,i,c,f,j,C){var A=n.memoizedState;A===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:j,treeForkCount:C}:(A.isBackwards=i,A.rendering=null,A.renderingStartTime=0,A.last=f,A.tail=c,A.tailMode=j,A.treeForkCount=C)}function Ej(n,i,c){var f=i.pendingProps,j=f.revealOrder,C=f.tail;f=f.children;var A=Ga.current,B=(A&2)!==0;if(B?(A=A&1|2,i.flags|=128):A&=1,M(Ga,A),Ns(n,i,f,c),f=Yt?Qc:0,!B&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Cj(n,c,i);else if(n.tag===19)Cj(n,c,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(j){case"forwards":for(c=i.child,j=null;c!==null;)n=c.alternate,n!==null&&fm(n)===null&&(j=c),c=c.sibling;c=j,c===null?(j=i.child,i.child=null):(j=c.sibling,c.sibling=null),vx(i,!1,j,c,C,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,j=i.child,i.child=null;j!==null;){if(n=j.alternate,n!==null&&fm(n)===null){i.child=j;break}n=j.sibling,j.sibling=c,c=j,j=n}vx(i,!0,c,null,C,f);break;case"together":vx(i,!1,null,null,void 0,f);break;default:i.memoizedState=null}return i.child}function Gr(n,i,c){if(n!==null&&(i.dependencies=n.dependencies),Bi|=i.lanes,(c&i.childLanes)===0)if(n!==null){if(Mo(n,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,c=Hr(n,n.pendingProps),i.child=c,c.return=i;n.sibling!==null;)n=n.sibling,c=c.sibling=Hr(n,n.pendingProps),c.return=i;c.sibling=null}return i.child}function bx(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&im(n)))}function i_(n,i,c){switch(i.tag){case 3:oe(i,i.stateNode.containerInfo),_i(i,Ka,n.memoizedState.cache),_l();break;case 27:case 5:je(i);break;case 4:oe(i,i.stateNode.containerInfo);break;case 10:_i(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,qp(i),null;break;case 13:var f=i.memoizedState;if(f!==null)return f.dehydrated!==null?(Ii(i),i.flags|=128,null):(c&i.child.childLanes)!==0?Sj(n,i,c):(Ii(i),n=Gr(n,i,c),n!==null?n.sibling:null);Ii(i);break;case 19:var j=(n.flags&128)!==0;if(f=(c&i.childLanes)!==0,f||(Mo(n,i,c,!1),f=(c&i.childLanes)!==0),j){if(f)return Ej(n,i,c);i.flags|=128}if(j=i.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),M(Ga,Ga.current),f)break;return null;case 22:return i.lanes=0,yj(n,i,c,i.pendingProps);case 24:_i(i,Ka,n.memoizedState.cache)}return Gr(n,i,c)}function Tj(n,i,c){if(n!==null)if(n.memoizedProps!==i.pendingProps)Qa=!0;else{if(!bx(n,c)&&(i.flags&128)===0)return Qa=!1,i_(n,i,c);Qa=(n.flags&131072)!==0}else Qa=!1,Yt&&(i.flags&1048576)!==0&&rb(i,Qc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var f=i.pendingProps;if(n=Il(i.elementType),i.type=n,typeof n=="function")Cp(n)?(f=Bl(n,f),i.tag=1,i=Nj(null,i,n,f,c)):(i.tag=0,i=hx(null,i,n,f,c));else{if(n!=null){var j=n.$$typeof;if(j===D){i.tag=11,i=pj(null,i,n,f,c);break e}else if(j===R){i.tag=14,i=xj(null,i,n,f,c);break e}}throw i=z(n)||n,Error(r(306,i,""))}}return i;case 0:return hx(n,i,i.type,i.pendingProps,c);case 1:return f=i.type,j=Bl(f,i.pendingProps),Nj(n,i,f,j,c);case 3:e:{if(oe(i,i.stateNode.containerInfo),n===null)throw Error(r(387));f=i.pendingProps;var C=i.memoizedState;j=C.element,$p(n,i),rd(i,f,null,c);var A=i.memoizedState;if(f=A.cache,_i(i,Ka,f),f!==C.cache&&Rp(i,[Ka],c,!0),nd(),f=A.element,C.isDehydrated)if(C={element:f,isDehydrated:!1,cache:A.cache},i.updateQueue.baseState=C,i.memoizedState=C,i.flags&256){i=wj(n,i,f,c);break e}else if(f!==j){j=_n(Error(r(424)),i),Zc(j),i=wj(n,i,f,c);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Ca=zn(n.firstChild),bs=i,Yt=!0,ki=null,Rn=!0,c=yb(i,null,f,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(_l(),f===j){i=Gr(n,i,c);break e}Ns(n,i,f,c)}i=i.child}return i;case 26:return Cm(n,i),n===null?(c=PN(i.type,null,i.pendingProps,null))?i.memoizedState=c:Yt||(c=i.type,n=i.pendingProps,f=Um(ve.current).createElement(c),f[Pa]=i,f[wa]=n,ws(f,c,n),At(f),i.stateNode=f):i.memoizedState=PN(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return je(i),n===null&&Yt&&(f=i.stateNode=IN(i.type,i.pendingProps,ve.current),bs=i,Rn=!0,j=Ca,Yi(i.type)?(Jx=j,Ca=zn(f.firstChild)):Ca=j),Ns(n,i,i.pendingProps.children,c),Cm(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Yt&&((j=f=Ca)&&(f=z_(f,i.type,i.pendingProps,Rn),f!==null?(i.stateNode=f,bs=i,Ca=zn(f.firstChild),Rn=!1,j=!0):j=!1),j||Ai(i)),je(i),j=i.type,C=i.pendingProps,A=n!==null?n.memoizedProps:null,f=C.children,Wx(j,C)?f=null:A!==null&&Wx(j,A)&&(i.flags|=32),i.memoizedState!==null&&(j=Gp(n,i,QA,null,null,c),Cd._currentValue=j),Cm(n,i),Ns(n,i,f,c),i.child;case 6:return n===null&&Yt&&((n=c=Ca)&&(c=L_(c,i.pendingProps,Rn),c!==null?(i.stateNode=c,bs=i,Ca=null,n=!0):n=!1),n||Ai(i)),null;case 13:return Sj(n,i,c);case 4:return oe(i,i.stateNode.containerInfo),f=i.pendingProps,n===null?i.child=Ll(i,null,f,c):Ns(n,i,f,c),i.child;case 11:return pj(n,i,i.type,i.pendingProps,c);case 7:return Ns(n,i,i.pendingProps,c),i.child;case 8:return Ns(n,i,i.pendingProps.children,c),i.child;case 12:return Ns(n,i,i.pendingProps.children,c),i.child;case 10:return f=i.pendingProps,_i(i,i.type,f.value),Ns(n,i,f.children,c),i.child;case 9:return j=i.type._context,f=i.pendingProps.children,Ol(i),j=js(j),f=f(j),i.flags|=1,Ns(n,i,f,c),i.child;case 14:return xj(n,i,i.type,i.pendingProps,c);case 15:return gj(n,i,i.type,i.pendingProps,c);case 19:return Ej(n,i,c);case 31:return r_(n,i,c);case 22:return yj(n,i,c,i.pendingProps);case 24:return Ol(i),f=js(Ka),n===null?(j=Lp(),j===null&&(j=ga,C=Ip(),j.pooledCache=C,C.refCount++,C!==null&&(j.pooledCacheLanes|=c),j=C),i.memoizedState={parent:f,cache:j},Bp(i),_i(i,Ka,j)):((n.lanes&c)!==0&&($p(n,i),rd(i,null,null,c),nd()),j=n.memoizedState,C=i.memoizedState,j.parent!==f?(j={parent:f,cache:f},i.memoizedState=j,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=j),_i(i,Ka,f)):(f=C.cache,_i(i,Ka,f),f!==j.cache&&Rp(i,[Ka],c,!0))),Ns(n,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function Wr(n){n.flags|=4}function jx(n,i,c,f,j){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(j&335544128)===j)if(n.stateNode.complete)n.flags|=8192;else if(eN())n.flags|=8192;else throw zl=dm,Pp}else n.flags&=-16777217}function Dj(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!VN(i))if(eN())n.flags|=8192;else throw zl=dm,Pp}function Tm(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?lt():536870912,n.lanes|=i,Yo|=i)}function ud(n,i){if(!Yt)switch(n.tailMode){case"hidden":i=n.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?n.tail=null:c.sibling=null;break;case"collapsed":c=n.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function Ea(n){var i=n.alternate!==null&&n.alternate.child===n.child,c=0,f=0;if(i)for(var j=n.child;j!==null;)c|=j.lanes|j.childLanes,f|=j.subtreeFlags&65011712,f|=j.flags&65011712,j.return=n,j=j.sibling;else for(j=n.child;j!==null;)c|=j.lanes|j.childLanes,f|=j.subtreeFlags,f|=j.flags,j.return=n,j=j.sibling;return n.subtreeFlags|=f,n.childLanes=c,i}function l_(n,i,c){var f=i.pendingProps;switch(kp(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ea(i),null;case 1:return Ea(i),null;case 3:return c=i.stateNode,f=null,n!==null&&(f=n.memoizedState.cache),i.memoizedState.cache!==f&&(i.flags|=2048),Yr(Ka),_e(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(_o(i)?Wr(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,_p())),Ea(i),null;case 26:var j=i.type,C=i.memoizedState;return n===null?(Wr(i),C!==null?(Ea(i),Dj(i,C)):(Ea(i),jx(i,j,null,f,c))):C?C!==n.memoizedState?(Wr(i),Ea(i),Dj(i,C)):(Ea(i),i.flags&=-16777217):(n=n.memoizedProps,n!==f&&Wr(i),Ea(i),jx(i,j,n,f,c)),null;case 27:if(Ie(i),c=ve.current,j=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&Wr(i);else{if(!f){if(i.stateNode===null)throw Error(r(166));return Ea(i),null}n=W.current,_o(i)?lb(i):(n=IN(j,f,c),i.stateNode=n,Wr(i))}return Ea(i),null;case 5:if(Ie(i),j=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==f&&Wr(i);else{if(!f){if(i.stateNode===null)throw Error(r(166));return Ea(i),null}if(C=W.current,_o(i))lb(i);else{var A=Um(ve.current);switch(C){case 1:C=A.createElementNS("http://www.w3.org/2000/svg",j);break;case 2:C=A.createElementNS("http://www.w3.org/1998/Math/MathML",j);break;default:switch(j){case"svg":C=A.createElementNS("http://www.w3.org/2000/svg",j);break;case"math":C=A.createElementNS("http://www.w3.org/1998/Math/MathML",j);break;case"script":C=A.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof f.is=="string"?A.createElement("select",{is:f.is}):A.createElement("select"),f.multiple?C.multiple=!0:f.size&&(C.size=f.size);break;default:C=typeof f.is=="string"?A.createElement(j,{is:f.is}):A.createElement(j)}}C[Pa]=i,C[wa]=f;e:for(A=i.child;A!==null;){if(A.tag===5||A.tag===6)C.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===i)break e;for(;A.sibling===null;){if(A.return===null||A.return===i)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}i.stateNode=C;e:switch(ws(C,j,f),j){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Wr(i)}}return Ea(i),jx(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,c),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==f&&Wr(i);else{if(typeof f!="string"&&i.stateNode===null)throw Error(r(166));if(n=ve.current,_o(i)){if(n=i.stateNode,c=i.memoizedProps,f=null,j=bs,j!==null)switch(j.tag){case 27:case 5:f=j.memoizedProps}n[Pa]=i,n=!!(n.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||SN(n.nodeValue,c)),n||Ai(i,!0)}else n=Um(n).createTextNode(f),n[Pa]=i,i.stateNode=n}return Ea(i),null;case 31:if(c=i.memoizedState,n===null||n.memoizedState!==null){if(f=_o(i),c!==null){if(n===null){if(!f)throw Error(r(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[Pa]=i}else _l(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ea(i),n=!1}else c=_p(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=c),n=!0;if(!n)return i.flags&256?(mn(i),i):(mn(i),null);if((i.flags&128)!==0)throw Error(r(558))}return Ea(i),null;case 13:if(f=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(j=_o(i),f!==null&&f.dehydrated!==null){if(n===null){if(!j)throw Error(r(318));if(j=i.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));j[Pa]=i}else _l(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ea(i),j=!1}else j=_p(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=j),j=!0;if(!j)return i.flags&256?(mn(i),i):(mn(i),null)}return mn(i),(i.flags&128)!==0?(i.lanes=c,i):(c=f!==null,n=n!==null&&n.memoizedState!==null,c&&(f=i.child,j=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(j=f.alternate.memoizedState.cachePool.pool),C=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(C=f.memoizedState.cachePool.pool),C!==j&&(f.flags|=2048)),c!==n&&c&&(i.child.flags|=8192),Tm(i,i.updateQueue),Ea(i),null);case 4:return _e(),n===null&&Vx(i.stateNode.containerInfo),Ea(i),null;case 10:return Yr(i.type),Ea(i),null;case 19:if(q(Ga),f=i.memoizedState,f===null)return Ea(i),null;if(j=(i.flags&128)!==0,C=f.rendering,C===null)if(j)ud(f,!1);else{if($a!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(C=fm(n),C!==null){for(i.flags|=128,ud(f,!1),n=C.updateQueue,i.updateQueue=n,Tm(i,n),i.subtreeFlags=0,n=c,c=i.child;c!==null;)ab(c,n),c=c.sibling;return M(Ga,Ga.current&1|2),Yt&&Ur(i,f.treeForkCount),i.child}n=n.sibling}f.tail!==null&&Oe()>Mm&&(i.flags|=128,j=!0,ud(f,!1),i.lanes=4194304)}else{if(!j)if(n=fm(C),n!==null){if(i.flags|=128,j=!0,n=n.updateQueue,i.updateQueue=n,Tm(i,n),ud(f,!0),f.tail===null&&f.tailMode==="hidden"&&!C.alternate&&!Yt)return Ea(i),null}else 2*Oe()-f.renderingStartTime>Mm&&c!==536870912&&(i.flags|=128,j=!0,ud(f,!1),i.lanes=4194304);f.isBackwards?(C.sibling=i.child,i.child=C):(n=f.last,n!==null?n.sibling=C:i.child=C,f.last=C)}return f.tail!==null?(n=f.tail,f.rendering=n,f.tail=n.sibling,f.renderingStartTime=Oe(),n.sibling=null,c=Ga.current,M(Ga,j?c&1|2:c&1),Yt&&Ur(i,f.treeForkCount),n):(Ea(i),null);case 22:case 23:return mn(i),Yp(),f=i.memoizedState!==null,n!==null?n.memoizedState!==null!==f&&(i.flags|=8192):f&&(i.flags|=8192),f?(c&536870912)!==0&&(i.flags&128)===0&&(Ea(i),i.subtreeFlags&6&&(i.flags|=8192)):Ea(i),c=i.updateQueue,c!==null&&Tm(i,c.retryQueue),c=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),f=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),f!==c&&(i.flags|=2048),n!==null&&q(Rl),null;case 24:return c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Yr(Ka),Ea(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function o_(n,i){switch(kp(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Yr(Ka),_e(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return Ie(i),null;case 31:if(i.memoizedState!==null){if(mn(i),i.alternate===null)throw Error(r(340));_l()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(mn(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));_l()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return q(Ga),null;case 4:return _e(),null;case 10:return Yr(i.type),null;case 22:case 23:return mn(i),Yp(),n!==null&&q(Rl),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Yr(Ka),null;case 25:return null;default:return null}}function kj(n,i){switch(kp(i),i.tag){case 3:Yr(Ka),_e();break;case 26:case 27:case 5:Ie(i);break;case 4:_e();break;case 31:i.memoizedState!==null&&mn(i);break;case 13:mn(i);break;case 19:q(Ga);break;case 10:Yr(i.type);break;case 22:case 23:mn(i),Yp(),n!==null&&q(Rl);break;case 24:Yr(Ka)}}function md(n,i){try{var c=i.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var j=f.next;c=j;do{if((c.tag&n)===n){f=void 0;var C=c.create,A=c.inst;f=C(),A.destroy=f}c=c.next}while(c!==j)}}catch(B){ca(i,i.return,B)}}function Li(n,i,c){try{var f=i.updateQueue,j=f!==null?f.lastEffect:null;if(j!==null){var C=j.next;f=C;do{if((f.tag&n)===n){var A=f.inst,B=A.destroy;if(B!==void 0){A.destroy=void 0,j=i;var Z=c,de=B;try{de()}catch(be){ca(j,Z,be)}}}f=f.next}while(f!==C)}}catch(be){ca(i,i.return,be)}}function Aj(n){var i=n.updateQueue;if(i!==null){var c=n.stateNode;try{bb(i,c)}catch(f){ca(n,n.return,f)}}}function _j(n,i,c){c.props=Bl(n.type,n.memoizedProps),c.state=n.memoizedState;try{c.componentWillUnmount()}catch(f){ca(n,i,f)}}function hd(n,i){try{var c=n.ref;if(c!==null){switch(n.tag){case 26:case 27:case 5:var f=n.stateNode;break;case 30:f=n.stateNode;break;default:f=n.stateNode}typeof c=="function"?n.refCleanup=c(f):c.current=f}}catch(j){ca(n,i,j)}}function jr(n,i){var c=n.ref,f=n.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(j){ca(n,i,j)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(j){ca(n,i,j)}else c.current=null}function Mj(n){var i=n.type,c=n.memoizedProps,f=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(j){ca(n,n.return,j)}}function Nx(n,i,c){try{var f=n.stateNode;A_(f,n.type,c,i),f[wa]=i}catch(j){ca(n,n.return,j)}}function Oj(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Yi(n.type)||n.tag===4}function wx(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Oj(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Yi(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Sx(n,i,c){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(n,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(n),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Br));else if(f!==4&&(f===27&&Yi(n.type)&&(c=n.stateNode,i=null),n=n.child,n!==null))for(Sx(n,i,c),n=n.sibling;n!==null;)Sx(n,i,c),n=n.sibling}function Dm(n,i,c){var f=n.tag;if(f===5||f===6)n=n.stateNode,i?c.insertBefore(n,i):c.appendChild(n);else if(f!==4&&(f===27&&Yi(n.type)&&(c=n.stateNode),n=n.child,n!==null))for(Dm(n,i,c),n=n.sibling;n!==null;)Dm(n,i,c),n=n.sibling}function Rj(n){var i=n.stateNode,c=n.memoizedProps;try{for(var f=n.type,j=i.attributes;j.length;)i.removeAttributeNode(j[0]);ws(i,f,c),i[Pa]=n,i[wa]=c}catch(C){ca(n,n.return,C)}}var Kr=!1,Za=!1,Cx=!1,Ij=typeof WeakSet=="function"?WeakSet:Set,ds=null;function c_(n,i){if(n=n.containerInfo,Fx=Km,n=Gv(n),yp(n)){if("selectionStart"in n)var c={start:n.selectionStart,end:n.selectionEnd};else e:{c=(c=n.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var j=f.anchorOffset,C=f.focusNode;f=f.focusOffset;try{c.nodeType,C.nodeType}catch{c=null;break e}var A=0,B=-1,Z=-1,de=0,be=0,Se=n,ue=null;t:for(;;){for(var pe;Se!==c||j!==0&&Se.nodeType!==3||(B=A+j),Se!==C||f!==0&&Se.nodeType!==3||(Z=A+f),Se.nodeType===3&&(A+=Se.nodeValue.length),(pe=Se.firstChild)!==null;)ue=Se,Se=pe;for(;;){if(Se===n)break t;if(ue===c&&++de===j&&(B=A),ue===C&&++be===f&&(Z=A),(pe=Se.nextSibling)!==null)break;Se=ue,ue=Se.parentNode}Se=pe}c=B===-1||Z===-1?null:{start:B,end:Z}}else c=null}c=c||{start:0,end:0}}else c=null;for(Gx={focusedElem:n,selectionRange:c},Km=!1,ds=i;ds!==null;)if(i=ds,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,ds=n;else for(;ds!==null;){switch(i=ds,C=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(c=0;c<n.length;c++)j=n[c],j.ref.impl=j.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&C!==null){n=void 0,c=i,j=C.memoizedProps,C=C.memoizedState,f=c.stateNode;try{var Ge=Bl(c.type,j);n=f.getSnapshotBeforeUpdate(Ge,C),f.__reactInternalSnapshotBeforeUpdate=n}catch(ot){ca(c,c.return,ot)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,c=n.nodeType,c===9)Xx(n);else if(c===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Xx(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,ds=n;break}ds=i.return}}function zj(n,i,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Qr(n,c),f&4&&md(5,c);break;case 1:if(Qr(n,c),f&4)if(n=c.stateNode,i===null)try{n.componentDidMount()}catch(A){ca(c,c.return,A)}else{var j=Bl(c.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(j,i,n.__reactInternalSnapshotBeforeUpdate)}catch(A){ca(c,c.return,A)}}f&64&&Aj(c),f&512&&hd(c,c.return);break;case 3:if(Qr(n,c),f&64&&(n=c.updateQueue,n!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{bb(n,i)}catch(A){ca(c,c.return,A)}}break;case 27:i===null&&f&4&&Rj(c);case 26:case 5:Qr(n,c),i===null&&f&4&&Mj(c),f&512&&hd(c,c.return);break;case 12:Qr(n,c);break;case 31:Qr(n,c),f&4&&Bj(n,c);break;case 13:Qr(n,c),f&4&&$j(n,c),f&64&&(n=c.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(c=y_.bind(null,c),P_(n,c))));break;case 22:if(f=c.memoizedState!==null||Kr,!f){i=i!==null&&i.memoizedState!==null||Za,j=Kr;var C=Za;Kr=f,(Za=i)&&!C?Zr(n,c,(c.subtreeFlags&8772)!==0):Qr(n,c),Kr=j,Za=C}break;case 30:break;default:Qr(n,c)}}function Lj(n){var i=n.alternate;i!==null&&(n.alternate=null,Lj(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&J(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Ta=null,Fs=!1;function Xr(n,i,c){for(c=c.child;c!==null;)Pj(n,i,c),c=c.sibling}function Pj(n,i,c){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(Ve,c)}catch{}switch(c.tag){case 26:Za||jr(c,i),Xr(n,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Za||jr(c,i);var f=Ta,j=Fs;Yi(c.type)&&(Ta=c.stateNode,Fs=!1),Xr(n,i,c),Nd(c.stateNode),Ta=f,Fs=j;break;case 5:Za||jr(c,i);case 6:if(f=Ta,j=Fs,Ta=null,Xr(n,i,c),Ta=f,Fs=j,Ta!==null)if(Fs)try{(Ta.nodeType===9?Ta.body:Ta.nodeName==="HTML"?Ta.ownerDocument.body:Ta).removeChild(c.stateNode)}catch(C){ca(c,i,C)}else try{Ta.removeChild(c.stateNode)}catch(C){ca(c,i,C)}break;case 18:Ta!==null&&(Fs?(n=Ta,AN(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,c.stateNode),Zo(n)):AN(Ta,c.stateNode));break;case 4:f=Ta,j=Fs,Ta=c.stateNode.containerInfo,Fs=!0,Xr(n,i,c),Ta=f,Fs=j;break;case 0:case 11:case 14:case 15:Li(2,c,i),Za||Li(4,c,i),Xr(n,i,c);break;case 1:Za||(jr(c,i),f=c.stateNode,typeof f.componentWillUnmount=="function"&&_j(c,i,f)),Xr(n,i,c);break;case 21:Xr(n,i,c);break;case 22:Za=(f=Za)||c.memoizedState!==null,Xr(n,i,c),Za=f;break;default:Xr(n,i,c)}}function Bj(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Zo(n)}catch(c){ca(i,i.return,c)}}}function $j(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Zo(n)}catch(c){ca(i,i.return,c)}}function d_(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new Ij),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new Ij),i;default:throw Error(r(435,n.tag))}}function km(n,i){var c=d_(n);i.forEach(function(f){if(!c.has(f)){c.add(f);var j=v_.bind(null,n,f);f.then(j,j)}})}function Gs(n,i){var c=i.deletions;if(c!==null)for(var f=0;f<c.length;f++){var j=c[f],C=n,A=i,B=A;e:for(;B!==null;){switch(B.tag){case 27:if(Yi(B.type)){Ta=B.stateNode,Fs=!1;break e}break;case 5:Ta=B.stateNode,Fs=!1;break e;case 3:case 4:Ta=B.stateNode.containerInfo,Fs=!0;break e}B=B.return}if(Ta===null)throw Error(r(160));Pj(C,A,j),Ta=null,Fs=!1,C=j.alternate,C!==null&&(C.return=null),j.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Hj(i,n),i=i.sibling}var Kn=null;function Hj(n,i){var c=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Gs(i,n),Ws(n),f&4&&(Li(3,n,n.return),md(3,n),Li(5,n,n.return));break;case 1:Gs(i,n),Ws(n),f&512&&(Za||c===null||jr(c,c.return)),f&64&&Kr&&(n=n.updateQueue,n!==null&&(f=n.callbacks,f!==null&&(c=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var j=Kn;if(Gs(i,n),Ws(n),f&512&&(Za||c===null||jr(c,c.return)),f&4){var C=c!==null?c.memoizedState:null;if(f=n.memoizedState,c===null)if(f===null)if(n.stateNode===null){e:{f=n.type,c=n.memoizedProps,j=j.ownerDocument||j;t:switch(f){case"title":C=j.getElementsByTagName("title")[0],(!C||C[He]||C[Pa]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=j.createElement(f),j.head.insertBefore(C,j.querySelector("head > title"))),ws(C,f,c),C[Pa]=n,At(C),f=C;break e;case"link":var A=HN("link","href",j).get(f+(c.href||""));if(A){for(var B=0;B<A.length;B++)if(C=A[B],C.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&C.getAttribute("rel")===(c.rel==null?null:c.rel)&&C.getAttribute("title")===(c.title==null?null:c.title)&&C.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){A.splice(B,1);break t}}C=j.createElement(f),ws(C,f,c),j.head.appendChild(C);break;case"meta":if(A=HN("meta","content",j).get(f+(c.content||""))){for(B=0;B<A.length;B++)if(C=A[B],C.getAttribute("content")===(c.content==null?null:""+c.content)&&C.getAttribute("name")===(c.name==null?null:c.name)&&C.getAttribute("property")===(c.property==null?null:c.property)&&C.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&C.getAttribute("charset")===(c.charSet==null?null:c.charSet)){A.splice(B,1);break t}}C=j.createElement(f),ws(C,f,c),j.head.appendChild(C);break;default:throw Error(r(468,f))}C[Pa]=n,At(C),f=C}n.stateNode=f}else UN(j,n.type,n.stateNode);else n.stateNode=$N(j,f,n.memoizedProps);else C!==f?(C===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):C.count--,f===null?UN(j,n.type,n.stateNode):$N(j,f,n.memoizedProps)):f===null&&n.stateNode!==null&&Nx(n,n.memoizedProps,c.memoizedProps)}break;case 27:Gs(i,n),Ws(n),f&512&&(Za||c===null||jr(c,c.return)),c!==null&&f&4&&Nx(n,n.memoizedProps,c.memoizedProps);break;case 5:if(Gs(i,n),Ws(n),f&512&&(Za||c===null||jr(c,c.return)),n.flags&32){j=n.stateNode;try{jo(j,"")}catch(Ge){ca(n,n.return,Ge)}}f&4&&n.stateNode!=null&&(j=n.memoizedProps,Nx(n,j,c!==null?c.memoizedProps:j)),f&1024&&(Cx=!0);break;case 6:if(Gs(i,n),Ws(n),f&4){if(n.stateNode===null)throw Error(r(162));f=n.memoizedProps,c=n.stateNode;try{c.nodeValue=f}catch(Ge){ca(n,n.return,Ge)}}break;case 3:if(qm=null,j=Kn,Kn=Vm(i.containerInfo),Gs(i,n),Kn=j,Ws(n),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Zo(i.containerInfo)}catch(Ge){ca(n,n.return,Ge)}Cx&&(Cx=!1,Uj(n));break;case 4:f=Kn,Kn=Vm(n.stateNode.containerInfo),Gs(i,n),Ws(n),Kn=f;break;case 12:Gs(i,n),Ws(n);break;case 31:Gs(i,n),Ws(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,km(n,f)));break;case 13:Gs(i,n),Ws(n),n.child.flags&8192&&n.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(_m=Oe()),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,km(n,f)));break;case 22:j=n.memoizedState!==null;var Z=c!==null&&c.memoizedState!==null,de=Kr,be=Za;if(Kr=de||j,Za=be||Z,Gs(i,n),Za=be,Kr=de,Ws(n),f&8192)e:for(i=n.stateNode,i._visibility=j?i._visibility&-2:i._visibility|1,j&&(c===null||Z||Kr||Za||$l(n)),c=null,i=n;;){if(i.tag===5||i.tag===26){if(c===null){Z=c=i;try{if(C=Z.stateNode,j)A=C.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{B=Z.stateNode;var Se=Z.memoizedProps.style,ue=Se!=null&&Se.hasOwnProperty("display")?Se.display:null;B.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(Ge){ca(Z,Z.return,Ge)}}}else if(i.tag===6){if(c===null){Z=i;try{Z.stateNode.nodeValue=j?"":Z.memoizedProps}catch(Ge){ca(Z,Z.return,Ge)}}}else if(i.tag===18){if(c===null){Z=i;try{var pe=Z.stateNode;j?_N(pe,!0):_N(Z.stateNode,!1)}catch(Ge){ca(Z,Z.return,Ge)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}f&4&&(f=n.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,km(n,c))));break;case 19:Gs(i,n),Ws(n),f&4&&(f=n.updateQueue,f!==null&&(n.updateQueue=null,km(n,f)));break;case 30:break;case 21:break;default:Gs(i,n),Ws(n)}}function Ws(n){var i=n.flags;if(i&2){try{for(var c,f=n.return;f!==null;){if(Oj(f)){c=f;break}f=f.return}if(c==null)throw Error(r(160));switch(c.tag){case 27:var j=c.stateNode,C=wx(n);Dm(n,C,j);break;case 5:var A=c.stateNode;c.flags&32&&(jo(A,""),c.flags&=-33);var B=wx(n);Dm(n,B,A);break;case 3:case 4:var Z=c.stateNode.containerInfo,de=wx(n);Sx(n,de,Z);break;default:throw Error(r(161))}}catch(be){ca(n,n.return,be)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Uj(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;Uj(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function Qr(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)zj(n,i.alternate,i),i=i.sibling}function $l(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Li(4,i,i.return),$l(i);break;case 1:jr(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&_j(i,i.return,c),$l(i);break;case 27:Nd(i.stateNode);case 26:case 5:jr(i,i.return),$l(i);break;case 22:i.memoizedState===null&&$l(i);break;case 30:$l(i);break;default:$l(i)}n=n.sibling}}function Zr(n,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var f=i.alternate,j=n,C=i,A=C.flags;switch(C.tag){case 0:case 11:case 15:Zr(j,C,c),md(4,C);break;case 1:if(Zr(j,C,c),f=C,j=f.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(de){ca(f,f.return,de)}if(f=C,j=f.updateQueue,j!==null){var B=f.stateNode;try{var Z=j.shared.hiddenCallbacks;if(Z!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Z.length;j++)vb(Z[j],B)}catch(de){ca(f,f.return,de)}}c&&A&64&&Aj(C),hd(C,C.return);break;case 27:Rj(C);case 26:case 5:Zr(j,C,c),c&&f===null&&A&4&&Mj(C),hd(C,C.return);break;case 12:Zr(j,C,c);break;case 31:Zr(j,C,c),c&&A&4&&Bj(j,C);break;case 13:Zr(j,C,c),c&&A&4&&$j(j,C);break;case 22:C.memoizedState===null&&Zr(j,C,c),hd(C,C.return);break;case 30:break;default:Zr(j,C,c)}i=i.sibling}}function Ex(n,i){var c=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(c=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==c&&(n!=null&&n.refCount++,c!=null&&Jc(c))}function Tx(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Jc(n))}function Xn(n,i,c,f){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Vj(n,i,c,f),i=i.sibling}function Vj(n,i,c,f){var j=i.flags;switch(i.tag){case 0:case 11:case 15:Xn(n,i,c,f),j&2048&&md(9,i);break;case 1:Xn(n,i,c,f);break;case 3:Xn(n,i,c,f),j&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Jc(n)));break;case 12:if(j&2048){Xn(n,i,c,f),n=i.stateNode;try{var C=i.memoizedProps,A=C.id,B=C.onPostCommit;typeof B=="function"&&B(A,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(Z){ca(i,i.return,Z)}}else Xn(n,i,c,f);break;case 31:Xn(n,i,c,f);break;case 13:Xn(n,i,c,f);break;case 23:break;case 22:C=i.stateNode,A=i.alternate,i.memoizedState!==null?C._visibility&2?Xn(n,i,c,f):fd(n,i):C._visibility&2?Xn(n,i,c,f):(C._visibility|=2,Ho(n,i,c,f,(i.subtreeFlags&10256)!==0||!1)),j&2048&&Ex(A,i);break;case 24:Xn(n,i,c,f),j&2048&&Tx(i.alternate,i);break;default:Xn(n,i,c,f)}}function Ho(n,i,c,f,j){for(j=j&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var C=n,A=i,B=c,Z=f,de=A.flags;switch(A.tag){case 0:case 11:case 15:Ho(C,A,B,Z,j),md(8,A);break;case 23:break;case 22:var be=A.stateNode;A.memoizedState!==null?be._visibility&2?Ho(C,A,B,Z,j):fd(C,A):(be._visibility|=2,Ho(C,A,B,Z,j)),j&&de&2048&&Ex(A.alternate,A);break;case 24:Ho(C,A,B,Z,j),j&&de&2048&&Tx(A.alternate,A);break;default:Ho(C,A,B,Z,j)}i=i.sibling}}function fd(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=n,f=i,j=f.flags;switch(f.tag){case 22:fd(c,f),j&2048&&Ex(f.alternate,f);break;case 24:fd(c,f),j&2048&&Tx(f.alternate,f);break;default:fd(c,f)}i=i.sibling}}var pd=8192;function Uo(n,i,c){if(n.subtreeFlags&pd)for(n=n.child;n!==null;)Yj(n,i,c),n=n.sibling}function Yj(n,i,c){switch(n.tag){case 26:Uo(n,i,c),n.flags&pd&&n.memoizedState!==null&&X_(c,Kn,n.memoizedState,n.memoizedProps);break;case 5:Uo(n,i,c);break;case 3:case 4:var f=Kn;Kn=Vm(n.stateNode.containerInfo),Uo(n,i,c),Kn=f;break;case 22:n.memoizedState===null&&(f=n.alternate,f!==null&&f.memoizedState!==null?(f=pd,pd=16777216,Uo(n,i,c),pd=f):Uo(n,i,c));break;default:Uo(n,i,c)}}function qj(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function xd(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];ds=f,Gj(f,n)}qj(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Fj(n),n=n.sibling}function Fj(n){switch(n.tag){case 0:case 11:case 15:xd(n),n.flags&2048&&Li(9,n,n.return);break;case 3:xd(n);break;case 12:xd(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,Am(n)):xd(n);break;default:xd(n)}}function Am(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var f=i[c];ds=f,Gj(f,n)}qj(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Li(8,i,i.return),Am(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,Am(i));break;default:Am(i)}n=n.sibling}}function Gj(n,i){for(;ds!==null;){var c=ds;switch(c.tag){case 0:case 11:case 15:Li(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Jc(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,ds=f;else e:for(c=n;ds!==null;){f=ds;var j=f.sibling,C=f.return;if(Lj(f),f===c){ds=null;break e}if(j!==null){j.return=C,ds=j;break e}ds=C}}}var u_={getCacheForType:function(n){var i=js(Ka),c=i.data.get(n);return c===void 0&&(c=n(),i.data.set(n,c)),c},cacheSignal:function(){return js(Ka).controller.signal}},m_=typeof WeakMap=="function"?WeakMap:Map,ra=0,ga=null,Bt=null,Ht=0,oa=0,hn=null,Pi=!1,Vo=!1,Dx=!1,Jr=0,$a=0,Bi=0,Hl=0,kx=0,fn=0,Yo=0,gd=null,Ks=null,Ax=!1,_m=0,Wj=0,Mm=1/0,Om=null,$i=null,ns=0,Hi=null,qo=null,ei=0,_x=0,Mx=null,Kj=null,yd=0,Ox=null;function pn(){return(ra&2)!==0&&Ht!==0?Ht&-Ht:I.T!==null?Bx():ys()}function Xj(){if(fn===0)if((Ht&536870912)===0||Yt){var n=jt;jt<<=1,(jt&3932160)===0&&(jt=262144),fn=n}else fn=536870912;return n=un.current,n!==null&&(n.flags|=32),fn}function Xs(n,i,c){(n===ga&&(oa===2||oa===9)||n.cancelPendingCommit!==null)&&(Fo(n,0),Ui(n,Ht,fn,!1)),ht(n,c),((ra&2)===0||n!==ga)&&(n===ga&&((ra&2)===0&&(Hl|=c),$a===4&&Ui(n,Ht,fn,!1)),Nr(n))}function Qj(n,i,c){if((ra&6)!==0)throw Error(r(327));var f=!c&&(i&127)===0&&(i&n.expiredLanes)===0||Ae(n,i),j=f?p_(n,i):Ix(n,i,!0),C=f;do{if(j===0){Vo&&!f&&Ui(n,i,0,!1);break}else{if(c=n.current.alternate,C&&!h_(c)){j=Ix(n,i,!1),C=!1;continue}if(j===2){if(C=i,n.errorRecoveryDisabledLanes&C)var A=0;else A=n.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){i=A;e:{var B=n;j=gd;var Z=B.current.memoizedState.isDehydrated;if(Z&&(Fo(B,A).flags|=256),A=Ix(B,A,!1),A!==2){if(Dx&&!Z){B.errorRecoveryDisabledLanes|=C,Hl|=C,j=4;break e}C=Ks,Ks=j,C!==null&&(Ks===null?Ks=C:Ks.push.apply(Ks,C))}j=A}if(C=!1,j!==2)continue}}if(j===1){Fo(n,0),Ui(n,i,0,!0);break}e:{switch(f=n,C=j,C){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Ui(f,i,fn,!Pi);break e;case 2:Ks=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(j=_m+300-Oe(),10<j)){if(Ui(f,i,fn,!Pi),$e(f,0,!0)!==0)break e;ei=i,f.timeoutHandle=DN(Zj.bind(null,f,c,Ks,Om,Ax,i,fn,Hl,Yo,Pi,C,"Throttled",-0,0),j);break e}Zj(f,c,Ks,Om,Ax,i,fn,Hl,Yo,Pi,C,null,-0,0)}}break}while(!0);Nr(n)}function Zj(n,i,c,f,j,C,A,B,Z,de,be,Se,ue,pe){if(n.timeoutHandle=-1,Se=i.subtreeFlags,Se&8192||(Se&16785408)===16785408){Se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Br},Yj(i,C,Se);var Ge=(C&62914560)===C?_m-Oe():(C&4194048)===C?Wj-Oe():0;if(Ge=Q_(Se,Ge),Ge!==null){ei=C,n.cancelPendingCommit=Ge(iN.bind(null,n,i,C,c,f,j,A,B,Z,be,Se,null,ue,pe)),Ui(n,C,A,!de);return}}iN(n,i,C,c,f,j,A,B,Z)}function h_(n){for(var i=n;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var j=c[f],C=j.getSnapshot;j=j.value;try{if(!cn(C(),j))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ui(n,i,c,f){i&=~kx,i&=~Hl,n.suspendedLanes|=i,n.pingedLanes&=~i,f&&(n.warmLanes|=i),f=n.expirationTimes;for(var j=i;0<j;){var C=31-Pt(j),A=1<<C;f[C]=-1,j&=~A}c!==0&&pa(n,c,i)}function Rm(){return(ra&6)===0?(vd(0),!1):!0}function Rx(){if(Bt!==null){if(oa===0)var n=Bt.return;else n=Bt,Vr=Ml=null,Xp(n),zo=null,td=0,n=Bt;for(;n!==null;)kj(n.alternate,n),n=n.return;Bt=null}}function Fo(n,i){var c=n.timeoutHandle;c!==-1&&(n.timeoutHandle=-1,O_(c)),c=n.cancelPendingCommit,c!==null&&(n.cancelPendingCommit=null,c()),ei=0,Rx(),ga=n,Bt=c=Hr(n.current,null),Ht=i,oa=0,hn=null,Pi=!1,Vo=Ae(n,i),Dx=!1,Yo=fn=kx=Hl=Bi=$a=0,Ks=gd=null,Ax=!1,(i&8)!==0&&(i|=i&32);var f=n.entangledLanes;if(f!==0)for(n=n.entanglements,f&=i;0<f;){var j=31-Pt(f),C=1<<j;i|=n[j],f&=~C}return Jr=i,tm(),c}function Jj(n,i){St=null,I.H=cd,i===Io||i===cm?(i=pb(),oa=3):i===Pp?(i=pb(),oa=4):oa=i===mx?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,hn=i,Bt===null&&($a=1,wm(n,_n(i,n.current)))}function eN(){var n=un.current;return n===null?!0:(Ht&4194048)===Ht?In===null:(Ht&62914560)===Ht||(Ht&536870912)!==0?n===In:!1}function tN(){var n=I.H;return I.H=cd,n===null?cd:n}function aN(){var n=I.A;return I.A=u_,n}function Im(){$a=4,Pi||(Ht&4194048)!==Ht&&un.current!==null||(Vo=!0),(Bi&134217727)===0&&(Hl&134217727)===0||ga===null||Ui(ga,Ht,fn,!1)}function Ix(n,i,c){var f=ra;ra|=2;var j=tN(),C=aN();(ga!==n||Ht!==i)&&(Om=null,Fo(n,i)),i=!1;var A=$a;e:do try{if(oa!==0&&Bt!==null){var B=Bt,Z=hn;switch(oa){case 8:Rx(),A=6;break e;case 3:case 2:case 9:case 6:un.current===null&&(i=!0);var de=oa;if(oa=0,hn=null,Go(n,B,Z,de),c&&Vo){A=0;break e}break;default:de=oa,oa=0,hn=null,Go(n,B,Z,de)}}f_(),A=$a;break}catch(be){Jj(n,be)}while(!0);return i&&n.shellSuspendCounter++,Vr=Ml=null,ra=f,I.H=j,I.A=C,Bt===null&&(ga=null,Ht=0,tm()),A}function f_(){for(;Bt!==null;)sN(Bt)}function p_(n,i){var c=ra;ra|=2;var f=tN(),j=aN();ga!==n||Ht!==i?(Om=null,Mm=Oe()+500,Fo(n,i)):Vo=Ae(n,i);e:do try{if(oa!==0&&Bt!==null){i=Bt;var C=hn;t:switch(oa){case 1:oa=0,hn=null,Go(n,i,C,1);break;case 2:case 9:if(hb(C)){oa=0,hn=null,nN(i);break}i=function(){oa!==2&&oa!==9||ga!==n||(oa=7),Nr(n)},C.then(i,i);break e;case 3:oa=7;break e;case 4:oa=5;break e;case 7:hb(C)?(oa=0,hn=null,nN(i)):(oa=0,hn=null,Go(n,i,C,7));break;case 5:var A=null;switch(Bt.tag){case 26:A=Bt.memoizedState;case 5:case 27:var B=Bt;if(A?VN(A):B.stateNode.complete){oa=0,hn=null;var Z=B.sibling;if(Z!==null)Bt=Z;else{var de=B.return;de!==null?(Bt=de,zm(de)):Bt=null}break t}}oa=0,hn=null,Go(n,i,C,5);break;case 6:oa=0,hn=null,Go(n,i,C,6);break;case 8:Rx(),$a=6;break e;default:throw Error(r(462))}}x_();break}catch(be){Jj(n,be)}while(!0);return Vr=Ml=null,I.H=f,I.A=j,ra=c,Bt!==null?0:(ga=null,Ht=0,tm(),$a)}function x_(){for(;Bt!==null&&!se();)sN(Bt)}function sN(n){var i=Tj(n.alternate,n,Jr);n.memoizedProps=n.pendingProps,i===null?zm(n):Bt=i}function nN(n){var i=n,c=i.alternate;switch(i.tag){case 15:case 0:i=jj(c,i,i.pendingProps,i.type,void 0,Ht);break;case 11:i=jj(c,i,i.pendingProps,i.type.render,i.ref,Ht);break;case 5:Xp(i);default:kj(c,i),i=Bt=ab(i,Jr),i=Tj(c,i,Jr)}n.memoizedProps=n.pendingProps,i===null?zm(n):Bt=i}function Go(n,i,c,f){Vr=Ml=null,Xp(i),zo=null,td=0;var j=i.return;try{if(n_(n,j,i,c,Ht)){$a=1,wm(n,_n(c,n.current)),Bt=null;return}}catch(C){if(j!==null)throw Bt=j,C;$a=1,wm(n,_n(c,n.current)),Bt=null;return}i.flags&32768?(Yt||f===1?n=!0:Vo||(Ht&536870912)!==0?n=!1:(Pi=n=!0,(f===2||f===9||f===3||f===6)&&(f=un.current,f!==null&&f.tag===13&&(f.flags|=16384))),rN(i,n)):zm(i)}function zm(n){var i=n;do{if((i.flags&32768)!==0){rN(i,Pi);return}n=i.return;var c=l_(i.alternate,i,Jr);if(c!==null){Bt=c;return}if(i=i.sibling,i!==null){Bt=i;return}Bt=i=n}while(i!==null);$a===0&&($a=5)}function rN(n,i){do{var c=o_(n.alternate,n);if(c!==null){c.flags&=32767,Bt=c;return}if(c=n.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(n=n.sibling,n!==null)){Bt=n;return}Bt=n=c}while(n!==null);$a=6,Bt=null}function iN(n,i,c,f,j,C,A,B,Z){n.cancelPendingCommit=null;do Lm();while(ns!==0);if((ra&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(C=i.lanes|i.childLanes,C|=wp,ct(n,c,C,A,B,Z),n===ga&&(Bt=ga=null,Ht=0),qo=i,Hi=n,ei=c,_x=C,Mx=j,Kj=f,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,b_(Je,function(){return uN(),null})):(n.callbackNode=null,n.callbackPriority=0),f=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||f){f=I.T,I.T=null,j=O.p,O.p=2,A=ra,ra|=4;try{c_(n,i,c)}finally{ra=A,O.p=j,I.T=f}}ns=1,lN(),oN(),cN()}}function lN(){if(ns===1){ns=0;var n=Hi,i=qo,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=I.T,I.T=null;var f=O.p;O.p=2;var j=ra;ra|=4;try{Hj(i,n);var C=Gx,A=Gv(n.containerInfo),B=C.focusedElem,Z=C.selectionRange;if(A!==B&&B&&B.ownerDocument&&Fv(B.ownerDocument.documentElement,B)){if(Z!==null&&yp(B)){var de=Z.start,be=Z.end;if(be===void 0&&(be=de),"selectionStart"in B)B.selectionStart=de,B.selectionEnd=Math.min(be,B.value.length);else{var Se=B.ownerDocument||document,ue=Se&&Se.defaultView||window;if(ue.getSelection){var pe=ue.getSelection(),Ge=B.textContent.length,ot=Math.min(Z.start,Ge),ha=Z.end===void 0?ot:Math.min(Z.end,Ge);!pe.extend&&ot>ha&&(A=ha,ha=ot,ot=A);var ne=qv(B,ot),ee=qv(B,ha);if(ne&&ee&&(pe.rangeCount!==1||pe.anchorNode!==ne.node||pe.anchorOffset!==ne.offset||pe.focusNode!==ee.node||pe.focusOffset!==ee.offset)){var ce=Se.createRange();ce.setStart(ne.node,ne.offset),pe.removeAllRanges(),ot>ha?(pe.addRange(ce),pe.extend(ee.node,ee.offset)):(ce.setEnd(ee.node,ee.offset),pe.addRange(ce))}}}}for(Se=[],pe=B;pe=pe.parentNode;)pe.nodeType===1&&Se.push({element:pe,left:pe.scrollLeft,top:pe.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Se.length;B++){var we=Se[B];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}Km=!!Fx,Gx=Fx=null}finally{ra=j,O.p=f,I.T=c}}n.current=i,ns=2}}function oN(){if(ns===2){ns=0;var n=Hi,i=qo,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=I.T,I.T=null;var f=O.p;O.p=2;var j=ra;ra|=4;try{zj(n,i.alternate,i)}finally{ra=j,O.p=f,I.T=c}}ns=3}}function cN(){if(ns===4||ns===3){ns=0,me();var n=Hi,i=qo,c=ei,f=Kj;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?ns=5:(ns=0,qo=Hi=null,dN(n,n.pendingLanes));var j=n.pendingLanes;if(j===0&&($i=null),xa(c),i=i.stateNode,nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(Ve,i,void 0,(i.current.flags&128)===128)}catch{}if(f!==null){i=I.T,j=O.p,O.p=2,I.T=null;try{for(var C=n.onRecoverableError,A=0;A<f.length;A++){var B=f[A];C(B.value,{componentStack:B.stack})}}finally{I.T=i,O.p=j}}(ei&3)!==0&&Lm(),Nr(n),j=n.pendingLanes,(c&261930)!==0&&(j&42)!==0?n===Ox?yd++:(yd=0,Ox=n):yd=0,vd(0)}}function dN(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,Jc(i)))}function Lm(){return lN(),oN(),cN(),uN()}function uN(){if(ns!==5)return!1;var n=Hi,i=_x;_x=0;var c=xa(ei),f=I.T,j=O.p;try{O.p=32>c?32:c,I.T=null,c=Mx,Mx=null;var C=Hi,A=ei;if(ns=0,qo=Hi=null,ei=0,(ra&6)!==0)throw Error(r(331));var B=ra;if(ra|=4,Fj(C.current),Vj(C,C.current,A,c),ra=B,vd(0,!1),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(Ve,C)}catch{}return!0}finally{O.p=j,I.T=f,dN(n,i)}}function mN(n,i,c){i=_n(c,i),i=ux(n.stateNode,i,2),n=Ri(n,i,2),n!==null&&(ht(n,2),Nr(n))}function ca(n,i,c){if(n.tag===3)mN(n,n,c);else for(;i!==null;){if(i.tag===3){mN(i,n,c);break}else if(i.tag===1){var f=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&($i===null||!$i.has(f))){n=_n(c,n),c=hj(2),f=Ri(i,c,2),f!==null&&(fj(c,f,i,n),ht(f,2),Nr(f));break}}i=i.return}}function zx(n,i,c){var f=n.pingCache;if(f===null){f=n.pingCache=new m_;var j=new Set;f.set(i,j)}else j=f.get(i),j===void 0&&(j=new Set,f.set(i,j));j.has(c)||(Dx=!0,j.add(c),n=g_.bind(null,n,i,c),i.then(n,n))}function g_(n,i,c){var f=n.pingCache;f!==null&&f.delete(i),n.pingedLanes|=n.suspendedLanes&c,n.warmLanes&=~c,ga===n&&(Ht&c)===c&&($a===4||$a===3&&(Ht&62914560)===Ht&&300>Oe()-_m?(ra&2)===0&&Fo(n,0):kx|=c,Yo===Ht&&(Yo=0)),Nr(n)}function hN(n,i){i===0&&(i=lt()),n=kl(n,i),n!==null&&(ht(n,i),Nr(n))}function y_(n){var i=n.memoizedState,c=0;i!==null&&(c=i.retryLane),hN(n,c)}function v_(n,i){var c=0;switch(n.tag){case 31:case 13:var f=n.stateNode,j=n.memoizedState;j!==null&&(c=j.retryLane);break;case 19:f=n.stateNode;break;case 22:f=n.stateNode._retryCache;break;default:throw Error(r(314))}f!==null&&f.delete(i),hN(n,c)}function b_(n,i){return Vt(n,i)}var Pm=null,Wo=null,Lx=!1,Bm=!1,Px=!1,Vi=0;function Nr(n){n!==Wo&&n.next===null&&(Wo===null?Pm=Wo=n:Wo=Wo.next=n),Bm=!0,Lx||(Lx=!0,N_())}function vd(n,i){if(!Px&&Bm){Px=!0;do for(var c=!1,f=Pm;f!==null;){if(n!==0){var j=f.pendingLanes;if(j===0)var C=0;else{var A=f.suspendedLanes,B=f.pingedLanes;C=(1<<31-Pt(42|n)+1)-1,C&=j&~(A&~B),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(c=!0,gN(f,C))}else C=Ht,C=$e(f,f===ga?C:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(C&3)===0||Ae(f,C)||(c=!0,gN(f,C));f=f.next}while(c);Px=!1}}function j_(){fN()}function fN(){Bm=Lx=!1;var n=0;Vi!==0&&M_()&&(n=Vi);for(var i=Oe(),c=null,f=Pm;f!==null;){var j=f.next,C=pN(f,i);C===0?(f.next=null,c===null?Pm=j:c.next=j,j===null&&(Wo=c)):(c=f,(n!==0||(C&3)!==0)&&(Bm=!0)),f=j}ns!==0&&ns!==5||vd(n),Vi!==0&&(Vi=0)}function pN(n,i){for(var c=n.suspendedLanes,f=n.pingedLanes,j=n.expirationTimes,C=n.pendingLanes&-62914561;0<C;){var A=31-Pt(C),B=1<<A,Z=j[A];Z===-1?((B&c)===0||(B&f)!==0)&&(j[A]=Fe(B,i)):Z<=i&&(n.expiredLanes|=B),C&=~B}if(i=ga,c=Ht,c=$e(n,n===i?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f=n.callbackNode,c===0||n===i&&(oa===2||oa===9)||n.cancelPendingCommit!==null)return f!==null&&f!==null&&X(f),n.callbackNode=null,n.callbackPriority=0;if((c&3)===0||Ae(n,c)){if(i=c&-c,i===n.callbackPriority)return i;switch(f!==null&&X(f),xa(c)){case 2:case 8:c=Pe;break;case 32:c=Je;break;case 268435456:c=Et;break;default:c=Je}return f=xN.bind(null,n),c=Vt(c,f),n.callbackPriority=i,n.callbackNode=c,i}return f!==null&&f!==null&&X(f),n.callbackPriority=2,n.callbackNode=null,2}function xN(n,i){if(ns!==0&&ns!==5)return n.callbackNode=null,n.callbackPriority=0,null;var c=n.callbackNode;if(Lm()&&n.callbackNode!==c)return null;var f=Ht;return f=$e(n,n===ga?f:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),f===0?null:(Qj(n,f,i),pN(n,Oe()),n.callbackNode!=null&&n.callbackNode===c?xN.bind(null,n):null)}function gN(n,i){if(Lm())return null;Qj(n,i,!0)}function N_(){R_(function(){(ra&6)!==0?Vt(Ee,j_):fN()})}function Bx(){if(Vi===0){var n=Oo;n===0&&(n=dt,dt<<=1,(dt&261888)===0&&(dt=256)),Vi=n}return Vi}function yN(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Gu(""+n)}function vN(n,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,n.id&&c.setAttribute("form",n.id),i.parentNode.insertBefore(c,i),n=new FormData(n),c.parentNode.removeChild(c),n}function w_(n,i,c,f,j){if(i==="submit"&&c&&c.stateNode===j){var C=yN((j[wa]||null).action),A=f.submitter;A&&(i=(i=A[wa]||null)?yN(i.formAction):A.getAttribute("formAction"),i!==null&&(C=i,A=null));var B=new Qu("action","action",null,f,j);n.push({event:B,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Vi!==0){var Z=A?vN(j,A):new FormData(j);rx(c,{pending:!0,data:Z,method:j.method,action:C},null,Z)}}else typeof C=="function"&&(B.preventDefault(),Z=A?vN(j,A):new FormData(j),rx(c,{pending:!0,data:Z,method:j.method,action:C},C,Z))},currentTarget:j}]})}}for(var $x=0;$x<Np.length;$x++){var Hx=Np[$x],S_=Hx.toLowerCase(),C_=Hx[0].toUpperCase()+Hx.slice(1);Wn(S_,"on"+C_)}Wn(Xv,"onAnimationEnd"),Wn(Qv,"onAnimationIteration"),Wn(Zv,"onAnimationStart"),Wn("dblclick","onDoubleClick"),Wn("focusin","onFocus"),Wn("focusout","onBlur"),Wn(HA,"onTransitionRun"),Wn(UA,"onTransitionStart"),Wn(VA,"onTransitionCancel"),Wn(Jv,"onTransitionEnd"),yr("onMouseEnter",["mouseout","mouseover"]),yr("onMouseLeave",["mouseout","mouseover"]),yr("onPointerEnter",["pointerout","pointerover"]),yr("onPointerLeave",["pointerout","pointerover"]),Ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ys("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),E_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bd));function bN(n,i){i=(i&4)!==0;for(var c=0;c<n.length;c++){var f=n[c],j=f.event;f=f.listeners;e:{var C=void 0;if(i)for(var A=f.length-1;0<=A;A--){var B=f[A],Z=B.instance,de=B.currentTarget;if(B=B.listener,Z!==C&&j.isPropagationStopped())break e;C=B,j.currentTarget=de;try{C(j)}catch(be){em(be)}j.currentTarget=null,C=Z}else for(A=0;A<f.length;A++){if(B=f[A],Z=B.instance,de=B.currentTarget,B=B.listener,Z!==C&&j.isPropagationStopped())break e;C=B,j.currentTarget=de;try{C(j)}catch(be){em(be)}j.currentTarget=null,C=Z}}}}function $t(n,i){var c=i[Ei];c===void 0&&(c=i[Ei]=new Set);var f=n+"__bubble";c.has(f)||(jN(i,n,2,!1),c.add(f))}function Ux(n,i,c){var f=0;i&&(f|=4),jN(c,n,f,i)}var $m="_reactListening"+Math.random().toString(36).slice(2);function Vx(n){if(!n[$m]){n[$m]=!0,vs.forEach(function(c){c!=="selectionchange"&&(E_.has(c)||Ux(c,!1,n),Ux(c,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[$m]||(i[$m]=!0,Ux("selectionchange",!1,i))}}function jN(n,i,c,f){switch(XN(i)){case 2:var j=eM;break;case 8:j=tM;break;default:j=ng}c=j.bind(null,i,c,n),j=void 0,!cp||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(j=!0),f?j!==void 0?n.addEventListener(i,c,{capture:!0,passive:j}):n.addEventListener(i,c,!0):j!==void 0?n.addEventListener(i,c,{passive:j}):n.addEventListener(i,c,!1)}function Yx(n,i,c,f,j){var C=f;if((i&1)===0&&(i&2)===0&&f!==null)e:for(;;){if(f===null)return;var A=f.tag;if(A===3||A===4){var B=f.stateNode.containerInfo;if(B===j)break;if(A===4)for(A=f.return;A!==null;){var Z=A.tag;if((Z===3||Z===4)&&A.stateNode.containerInfo===j)return;A=A.return}for(;B!==null;){if(A=Me(B),A===null)return;if(Z=A.tag,Z===5||Z===6||Z===26||Z===27){f=C=A;continue e}B=B.parentNode}}f=f.return}Ev(function(){var de=C,be=lp(c),Se=[];e:{var ue=eb.get(n);if(ue!==void 0){var pe=Qu,Ge=n;switch(n){case"keypress":if(Ku(c)===0)break e;case"keydown":case"keyup":pe=vA;break;case"focusin":Ge="focus",pe=hp;break;case"focusout":Ge="blur",pe=hp;break;case"beforeblur":case"afterblur":pe=hp;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pe=kv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pe=lA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pe=NA;break;case Xv:case Qv:case Zv:pe=dA;break;case Jv:pe=SA;break;case"scroll":case"scrollend":pe=rA;break;case"wheel":pe=EA;break;case"copy":case"cut":case"paste":pe=mA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pe=_v;break;case"toggle":case"beforetoggle":pe=DA}var ot=(i&4)!==0,ha=!ot&&(n==="scroll"||n==="scrollend"),ne=ot?ue!==null?ue+"Capture":null:ue;ot=[];for(var ee=de,ce;ee!==null;){var we=ee;if(ce=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||ce===null||ne===null||(we=Uc(ee,ne),we!=null&&ot.push(jd(ee,we,ce))),ha)break;ee=ee.return}0<ot.length&&(ue=new pe(ue,Ge,null,c,be),Se.push({event:ue,listeners:ot}))}}if((i&7)===0){e:{if(ue=n==="mouseover"||n==="pointerover",pe=n==="mouseout"||n==="pointerout",ue&&c!==ip&&(Ge=c.relatedTarget||c.fromElement)&&(Me(Ge)||Ge[Gn]))break e;if((pe||ue)&&(ue=be.window===be?be:(ue=be.ownerDocument)?ue.defaultView||ue.parentWindow:window,pe?(Ge=c.relatedTarget||c.toElement,pe=de,Ge=Ge?Me(Ge):null,Ge!==null&&(ha=o(Ge),ot=Ge.tag,Ge!==ha||ot!==5&&ot!==27&&ot!==6)&&(Ge=null)):(pe=null,Ge=de),pe!==Ge)){if(ot=kv,we="onMouseLeave",ne="onMouseEnter",ee="mouse",(n==="pointerout"||n==="pointerover")&&(ot=_v,we="onPointerLeave",ne="onPointerEnter",ee="pointer"),ha=pe==null?ue:la(pe),ce=Ge==null?ue:la(Ge),ue=new ot(we,ee+"leave",pe,c,be),ue.target=ha,ue.relatedTarget=ce,we=null,Me(be)===de&&(ot=new ot(ne,ee+"enter",Ge,c,be),ot.target=ce,ot.relatedTarget=ha,we=ot),ha=we,pe&&Ge)t:{for(ot=T_,ne=pe,ee=Ge,ce=0,we=ne;we;we=ot(we))ce++;we=0;for(var at=ee;at;at=ot(at))we++;for(;0<ce-we;)ne=ot(ne),ce--;for(;0<we-ce;)ee=ot(ee),we--;for(;ce--;){if(ne===ee||ee!==null&&ne===ee.alternate){ot=ne;break t}ne=ot(ne),ee=ot(ee)}ot=null}else ot=null;pe!==null&&NN(Se,ue,pe,ot,!1),Ge!==null&&ha!==null&&NN(Se,ha,Ge,ot,!0)}}e:{if(ue=de?la(de):window,pe=ue.nodeName&&ue.nodeName.toLowerCase(),pe==="select"||pe==="input"&&ue.type==="file")var ea=Bv;else if(Lv(ue))if($v)ea=PA;else{ea=zA;var Qe=IA}else pe=ue.nodeName,!pe||pe.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?de&&rp(de.elementType)&&(ea=Bv):ea=LA;if(ea&&(ea=ea(n,de))){Pv(Se,ea,c,be);break e}Qe&&Qe(n,ue,de),n==="focusout"&&de&&ue.type==="number"&&de.memoizedProps.value!=null&&np(ue,"number",ue.value)}switch(Qe=de?la(de):window,n){case"focusin":(Lv(Qe)||Qe.contentEditable==="true")&&(Co=Qe,vp=de,Xc=null);break;case"focusout":Xc=vp=Co=null;break;case"mousedown":bp=!0;break;case"contextmenu":case"mouseup":case"dragend":bp=!1,Wv(Se,c,be);break;case"selectionchange":if($A)break;case"keydown":case"keyup":Wv(Se,c,be)}var Ct;if(pp)e:{switch(n){case"compositionstart":var Ut="onCompositionStart";break e;case"compositionend":Ut="onCompositionEnd";break e;case"compositionupdate":Ut="onCompositionUpdate";break e}Ut=void 0}else So?Iv(n,c)&&(Ut="onCompositionEnd"):n==="keydown"&&c.keyCode===229&&(Ut="onCompositionStart");Ut&&(Mv&&c.locale!=="ko"&&(So||Ut!=="onCompositionStart"?Ut==="onCompositionEnd"&&So&&(Ct=Tv()):(Ti=be,dp="value"in Ti?Ti.value:Ti.textContent,So=!0)),Qe=Hm(de,Ut),0<Qe.length&&(Ut=new Av(Ut,n,null,c,be),Se.push({event:Ut,listeners:Qe}),Ct?Ut.data=Ct:(Ct=zv(c),Ct!==null&&(Ut.data=Ct)))),(Ct=AA?_A(n,c):MA(n,c))&&(Ut=Hm(de,"onBeforeInput"),0<Ut.length&&(Qe=new Av("onBeforeInput","beforeinput",null,c,be),Se.push({event:Qe,listeners:Ut}),Qe.data=Ct)),w_(Se,n,de,c,be)}bN(Se,i)})}function jd(n,i,c){return{instance:n,listener:i,currentTarget:c}}function Hm(n,i){for(var c=i+"Capture",f=[];n!==null;){var j=n,C=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||C===null||(j=Uc(n,c),j!=null&&f.unshift(jd(n,j,C)),j=Uc(n,i),j!=null&&f.push(jd(n,j,C))),n.tag===3)return f;n=n.return}return[]}function T_(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function NN(n,i,c,f,j){for(var C=i._reactName,A=[];c!==null&&c!==f;){var B=c,Z=B.alternate,de=B.stateNode;if(B=B.tag,Z!==null&&Z===f)break;B!==5&&B!==26&&B!==27||de===null||(Z=de,j?(de=Uc(c,C),de!=null&&A.unshift(jd(c,de,Z))):j||(de=Uc(c,C),de!=null&&A.push(jd(c,de,Z)))),c=c.return}A.length!==0&&n.push({event:i,listeners:A})}var D_=/\r\n?/g,k_=/\u0000|\uFFFD/g;function wN(n){return(typeof n=="string"?n:""+n).replace(D_,`
`).replace(k_,"")}function SN(n,i){return i=wN(i),wN(n)===i}function ma(n,i,c,f,j,C){switch(c){case"children":typeof f=="string"?i==="body"||i==="textarea"&&f===""||jo(n,f):(typeof f=="number"||typeof f=="bigint")&&i!=="body"&&jo(n,""+f);break;case"className":qu(n,"class",f);break;case"tabIndex":qu(n,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":qu(n,c,f);break;case"style":Sv(n,f,C);break;case"data":if(i!=="object"){qu(n,"data",f);break}case"src":case"href":if(f===""&&(i!=="a"||c!=="href")){n.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(c);break}f=Gu(""+f),n.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){n.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(c==="formAction"?(i!=="input"&&ma(n,i,"name",j.name,j,null),ma(n,i,"formEncType",j.formEncType,j,null),ma(n,i,"formMethod",j.formMethod,j,null),ma(n,i,"formTarget",j.formTarget,j,null)):(ma(n,i,"encType",j.encType,j,null),ma(n,i,"method",j.method,j,null),ma(n,i,"target",j.target,j,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){n.removeAttribute(c);break}f=Gu(""+f),n.setAttribute(c,f);break;case"onClick":f!=null&&(n.onclick=Br);break;case"onScroll":f!=null&&$t("scroll",n);break;case"onScrollEnd":f!=null&&$t("scrollend",n);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(c=f.__html,c!=null){if(j.children!=null)throw Error(r(60));n.innerHTML=c}}break;case"multiple":n.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":n.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){n.removeAttribute("xlink:href");break}c=Gu(""+f),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,""+f):n.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,""):n.removeAttribute(c);break;case"capture":case"download":f===!0?n.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?n.setAttribute(c,f):n.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?n.setAttribute(c,f):n.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?n.removeAttribute(c):n.setAttribute(c,f);break;case"popover":$t("beforetoggle",n),$t("toggle",n),Yu(n,"popover",f);break;case"xlinkActuate":Pr(n,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Pr(n,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Pr(n,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Pr(n,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Pr(n,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Pr(n,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Pr(n,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Pr(n,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Pr(n,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Yu(n,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=sA.get(c)||c,Yu(n,c,f))}}function qx(n,i,c,f,j,C){switch(c){case"style":Sv(n,f,C);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(r(61));if(c=f.__html,c!=null){if(j.children!=null)throw Error(r(60));n.innerHTML=c}}break;case"children":typeof f=="string"?jo(n,f):(typeof f=="number"||typeof f=="bigint")&&jo(n,""+f);break;case"onScroll":f!=null&&$t("scroll",n);break;case"onScrollEnd":f!=null&&$t("scrollend",n);break;case"onClick":f!=null&&(n.onclick=Br);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Tn.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(j=c.endsWith("Capture"),i=c.slice(2,j?c.length-7:void 0),C=n[wa]||null,C=C!=null?C[c]:null,typeof C=="function"&&n.removeEventListener(i,C,j),typeof f=="function")){typeof C!="function"&&C!==null&&(c in n?n[c]=null:n.hasAttribute(c)&&n.removeAttribute(c)),n.addEventListener(i,f,j);break e}c in n?n[c]=f:f===!0?n.setAttribute(c,""):Yu(n,c,f)}}}function ws(n,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$t("error",n),$t("load",n);var f=!1,j=!1,C;for(C in c)if(c.hasOwnProperty(C)){var A=c[C];if(A!=null)switch(C){case"src":f=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:ma(n,i,C,A,c,null)}}j&&ma(n,i,"srcSet",c.srcSet,c,null),f&&ma(n,i,"src",c.src,c,null);return;case"input":$t("invalid",n);var B=C=A=j=null,Z=null,de=null;for(f in c)if(c.hasOwnProperty(f)){var be=c[f];if(be!=null)switch(f){case"name":j=be;break;case"type":A=be;break;case"checked":Z=be;break;case"defaultChecked":de=be;break;case"value":C=be;break;case"defaultValue":B=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(r(137,i));break;default:ma(n,i,f,be,c,null)}}bv(n,C,B,Z,de,A,j,!1);return;case"select":$t("invalid",n),f=A=C=null;for(j in c)if(c.hasOwnProperty(j)&&(B=c[j],B!=null))switch(j){case"value":C=B;break;case"defaultValue":A=B;break;case"multiple":f=B;default:ma(n,i,j,B,c,null)}i=C,c=A,n.multiple=!!f,i!=null?bo(n,!!f,i,!1):c!=null&&bo(n,!!f,c,!0);return;case"textarea":$t("invalid",n),C=j=f=null;for(A in c)if(c.hasOwnProperty(A)&&(B=c[A],B!=null))switch(A){case"value":f=B;break;case"defaultValue":j=B;break;case"children":C=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(r(91));break;default:ma(n,i,A,B,c,null)}Nv(n,f,j,C);return;case"option":for(Z in c)c.hasOwnProperty(Z)&&(f=c[Z],f!=null)&&(Z==="selected"?n.selected=f&&typeof f!="function"&&typeof f!="symbol":ma(n,i,Z,f,c,null));return;case"dialog":$t("beforetoggle",n),$t("toggle",n),$t("cancel",n),$t("close",n);break;case"iframe":case"object":$t("load",n);break;case"video":case"audio":for(f=0;f<bd.length;f++)$t(bd[f],n);break;case"image":$t("error",n),$t("load",n);break;case"details":$t("toggle",n);break;case"embed":case"source":case"link":$t("error",n),$t("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in c)if(c.hasOwnProperty(de)&&(f=c[de],f!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:ma(n,i,de,f,c,null)}return;default:if(rp(i)){for(be in c)c.hasOwnProperty(be)&&(f=c[be],f!==void 0&&qx(n,i,be,f,c,void 0));return}}for(B in c)c.hasOwnProperty(B)&&(f=c[B],f!=null&&ma(n,i,B,f,c,null))}function A_(n,i,c,f){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,C=null,A=null,B=null,Z=null,de=null,be=null;for(pe in c){var Se=c[pe];if(c.hasOwnProperty(pe)&&Se!=null)switch(pe){case"checked":break;case"value":break;case"defaultValue":Z=Se;default:f.hasOwnProperty(pe)||ma(n,i,pe,null,f,Se)}}for(var ue in f){var pe=f[ue];if(Se=c[ue],f.hasOwnProperty(ue)&&(pe!=null||Se!=null))switch(ue){case"type":C=pe;break;case"name":j=pe;break;case"checked":de=pe;break;case"defaultChecked":be=pe;break;case"value":A=pe;break;case"defaultValue":B=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,i));break;default:pe!==Se&&ma(n,i,ue,pe,f,Se)}}sp(n,A,B,Z,de,be,C,j);return;case"select":pe=A=B=ue=null;for(C in c)if(Z=c[C],c.hasOwnProperty(C)&&Z!=null)switch(C){case"value":break;case"multiple":pe=Z;default:f.hasOwnProperty(C)||ma(n,i,C,null,f,Z)}for(j in f)if(C=f[j],Z=c[j],f.hasOwnProperty(j)&&(C!=null||Z!=null))switch(j){case"value":ue=C;break;case"defaultValue":B=C;break;case"multiple":A=C;default:C!==Z&&ma(n,i,j,C,f,Z)}i=B,c=A,f=pe,ue!=null?bo(n,!!c,ue,!1):!!f!=!!c&&(i!=null?bo(n,!!c,i,!0):bo(n,!!c,c?[]:"",!1));return;case"textarea":pe=ue=null;for(B in c)if(j=c[B],c.hasOwnProperty(B)&&j!=null&&!f.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:ma(n,i,B,null,f,j)}for(A in f)if(j=f[A],C=c[A],f.hasOwnProperty(A)&&(j!=null||C!=null))switch(A){case"value":ue=j;break;case"defaultValue":pe=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(r(91));break;default:j!==C&&ma(n,i,A,j,f,C)}jv(n,ue,pe);return;case"option":for(var Ge in c)ue=c[Ge],c.hasOwnProperty(Ge)&&ue!=null&&!f.hasOwnProperty(Ge)&&(Ge==="selected"?n.selected=!1:ma(n,i,Ge,null,f,ue));for(Z in f)ue=f[Z],pe=c[Z],f.hasOwnProperty(Z)&&ue!==pe&&(ue!=null||pe!=null)&&(Z==="selected"?n.selected=ue&&typeof ue!="function"&&typeof ue!="symbol":ma(n,i,Z,ue,f,pe));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ot in c)ue=c[ot],c.hasOwnProperty(ot)&&ue!=null&&!f.hasOwnProperty(ot)&&ma(n,i,ot,null,f,ue);for(de in f)if(ue=f[de],pe=c[de],f.hasOwnProperty(de)&&ue!==pe&&(ue!=null||pe!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(r(137,i));break;default:ma(n,i,de,ue,f,pe)}return;default:if(rp(i)){for(var ha in c)ue=c[ha],c.hasOwnProperty(ha)&&ue!==void 0&&!f.hasOwnProperty(ha)&&qx(n,i,ha,void 0,f,ue);for(be in f)ue=f[be],pe=c[be],!f.hasOwnProperty(be)||ue===pe||ue===void 0&&pe===void 0||qx(n,i,be,ue,f,pe);return}}for(var ne in c)ue=c[ne],c.hasOwnProperty(ne)&&ue!=null&&!f.hasOwnProperty(ne)&&ma(n,i,ne,null,f,ue);for(Se in f)ue=f[Se],pe=c[Se],!f.hasOwnProperty(Se)||ue===pe||ue==null&&pe==null||ma(n,i,Se,ue,f,pe)}function CN(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function __(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var j=c[f],C=j.transferSize,A=j.initiatorType,B=j.duration;if(C&&B&&CN(A)){for(A=0,B=j.responseEnd,f+=1;f<c.length;f++){var Z=c[f],de=Z.startTime;if(de>B)break;var be=Z.transferSize,Se=Z.initiatorType;be&&CN(Se)&&(Z=Z.responseEnd,A+=be*(Z<B?1:(B-de)/(Z-de)))}if(--f,i+=8*(C+A)/(j.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Fx=null,Gx=null;function Um(n){return n.nodeType===9?n:n.ownerDocument}function EN(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function TN(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Wx(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Kx=null;function M_(){var n=window.event;return n&&n.type==="popstate"?n===Kx?!1:(Kx=n,!0):(Kx=null,!1)}var DN=typeof setTimeout=="function"?setTimeout:void 0,O_=typeof clearTimeout=="function"?clearTimeout:void 0,kN=typeof Promise=="function"?Promise:void 0,R_=typeof queueMicrotask=="function"?queueMicrotask:typeof kN<"u"?function(n){return kN.resolve(null).then(n).catch(I_)}:DN;function I_(n){setTimeout(function(){throw n})}function Yi(n){return n==="head"}function AN(n,i){var c=i,f=0;do{var j=c.nextSibling;if(n.removeChild(c),j&&j.nodeType===8)if(c=j.data,c==="/$"||c==="/&"){if(f===0){n.removeChild(j),Zo(i);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Nd(n.ownerDocument.documentElement);else if(c==="head"){c=n.ownerDocument.head,Nd(c);for(var C=c.firstChild;C;){var A=C.nextSibling,B=C.nodeName;C[He]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&C.rel.toLowerCase()==="stylesheet"||c.removeChild(C),C=A}}else c==="body"&&Nd(n.ownerDocument.body);c=j}while(c);Zo(i)}function _N(n,i){var c=n;n=0;do{var f=c.nextSibling;if(c.nodeType===1?i?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(i?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(n===0)break;n--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||n++;c=f}while(c)}function Xx(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Xx(c),J(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}n.removeChild(c)}}function z_(n,i,c,f){for(;n.nodeType===1;){var j=c;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!f&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(f){if(!n[He])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(C=n.getAttribute("rel"),C==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(C!==j.rel||n.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||n.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||n.getAttribute("title")!==(j.title==null?null:j.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(C=n.getAttribute("src"),(C!==(j.src==null?null:j.src)||n.getAttribute("type")!==(j.type==null?null:j.type)||n.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&C&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var C=j.name==null?null:""+j.name;if(j.type==="hidden"&&n.getAttribute("name")===C)return n}else return n;if(n=zn(n.nextSibling),n===null)break}return null}function L_(n,i,c){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!c||(n=zn(n.nextSibling),n===null))return null;return n}function MN(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=zn(n.nextSibling),n===null))return null;return n}function Qx(n){return n.data==="$?"||n.data==="$~"}function Zx(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function P_(n,i){var c=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||c.readyState!=="loading")i();else{var f=function(){i(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),n._reactRetry=f}}function zn(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Jx=null;function ON(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var c=n.data;if(c==="/$"||c==="/&"){if(i===0)return zn(n.nextSibling);i--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||i++}n=n.nextSibling}return null}function RN(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var c=n.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(i===0)return n;i--}else c!=="/$"&&c!=="/&"||i++}n=n.previousSibling}return null}function IN(n,i,c){switch(i=Um(c),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Nd(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);J(n)}var Ln=new Map,zN=new Set;function Vm(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ti=O.d;O.d={f:B_,r:$_,D:H_,C:U_,L:V_,m:Y_,X:F_,S:q_,M:G_};function B_(){var n=ti.f(),i=Rm();return n||i}function $_(n){var i=Ye(n);i!==null&&i.tag===5&&i.type==="form"?Jb(i):ti.r(n)}var Ko=typeof document>"u"?null:document;function LN(n,i,c){var f=Ko;if(f&&typeof i=="string"&&i){var j=kn(i);j='link[rel="'+n+'"][href="'+j+'"]',typeof c=="string"&&(j+='[crossorigin="'+c+'"]'),zN.has(j)||(zN.add(j),n={rel:n,crossOrigin:c,href:i},f.querySelector(j)===null&&(i=f.createElement("link"),ws(i,"link",n),At(i),f.head.appendChild(i)))}}function H_(n){ti.D(n),LN("dns-prefetch",n,null)}function U_(n,i){ti.C(n,i),LN("preconnect",n,i)}function V_(n,i,c){ti.L(n,i,c);var f=Ko;if(f&&n&&i){var j='link[rel="preload"][as="'+kn(i)+'"]';i==="image"&&c&&c.imageSrcSet?(j+='[imagesrcset="'+kn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(j+='[imagesizes="'+kn(c.imageSizes)+'"]')):j+='[href="'+kn(n)+'"]';var C=j;switch(i){case"style":C=Xo(n);break;case"script":C=Qo(n)}Ln.has(C)||(n=x({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:n,as:i},c),Ln.set(C,n),f.querySelector(j)!==null||i==="style"&&f.querySelector(wd(C))||i==="script"&&f.querySelector(Sd(C))||(i=f.createElement("link"),ws(i,"link",n),At(i),f.head.appendChild(i)))}}function Y_(n,i){ti.m(n,i);var c=Ko;if(c&&n){var f=i&&typeof i.as=="string"?i.as:"script",j='link[rel="modulepreload"][as="'+kn(f)+'"][href="'+kn(n)+'"]',C=j;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Qo(n)}if(!Ln.has(C)&&(n=x({rel:"modulepreload",href:n},i),Ln.set(C,n),c.querySelector(j)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Sd(C)))return}f=c.createElement("link"),ws(f,"link",n),At(f),c.head.appendChild(f)}}}function q_(n,i,c){ti.S(n,i,c);var f=Ko;if(f&&n){var j=Oa(f).hoistableStyles,C=Xo(n);i=i||"default";var A=j.get(C);if(!A){var B={loading:0,preload:null};if(A=f.querySelector(wd(C)))B.loading=5;else{n=x({rel:"stylesheet",href:n,"data-precedence":i},c),(c=Ln.get(C))&&eg(n,c);var Z=A=f.createElement("link");At(Z),ws(Z,"link",n),Z._p=new Promise(function(de,be){Z.onload=de,Z.onerror=be}),Z.addEventListener("load",function(){B.loading|=1}),Z.addEventListener("error",function(){B.loading|=2}),B.loading|=4,Ym(A,i,f)}A={type:"stylesheet",instance:A,count:1,state:B},j.set(C,A)}}}function F_(n,i){ti.X(n,i);var c=Ko;if(c&&n){var f=Oa(c).hoistableScripts,j=Qo(n),C=f.get(j);C||(C=c.querySelector(Sd(j)),C||(n=x({src:n,async:!0},i),(i=Ln.get(j))&&tg(n,i),C=c.createElement("script"),At(C),ws(C,"link",n),c.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},f.set(j,C))}}function G_(n,i){ti.M(n,i);var c=Ko;if(c&&n){var f=Oa(c).hoistableScripts,j=Qo(n),C=f.get(j);C||(C=c.querySelector(Sd(j)),C||(n=x({src:n,async:!0,type:"module"},i),(i=Ln.get(j))&&tg(n,i),C=c.createElement("script"),At(C),ws(C,"link",n),c.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},f.set(j,C))}}function PN(n,i,c,f){var j=(j=ve.current)?Vm(j):null;if(!j)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Xo(c.href),c=Oa(j).hoistableStyles,f=c.get(i),f||(f={type:"style",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){n=Xo(c.href);var C=Oa(j).hoistableStyles,A=C.get(n);if(A||(j=j.ownerDocument||j,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(n,A),(C=j.querySelector(wd(n)))&&!C._p&&(A.instance=C,A.state.loading=5),Ln.has(n)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ln.set(n,c),C||W_(j,n,c,A.state))),i&&f===null)throw Error(r(528,""));return A}if(i&&f!==null)throw Error(r(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Qo(c),c=Oa(j).hoistableScripts,f=c.get(i),f||(f={type:"script",instance:null,count:0,state:null},c.set(i,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function Xo(n){return'href="'+kn(n)+'"'}function wd(n){return'link[rel="stylesheet"]['+n+"]"}function BN(n){return x({},n,{"data-precedence":n.precedence,precedence:null})}function W_(n,i,c,f){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?f.loading=1:(i=n.createElement("link"),f.preload=i,i.addEventListener("load",function(){return f.loading|=1}),i.addEventListener("error",function(){return f.loading|=2}),ws(i,"link",c),At(i),n.head.appendChild(i))}function Qo(n){return'[src="'+kn(n)+'"]'}function Sd(n){return"script[async]"+n}function $N(n,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var f=n.querySelector('style[data-href~="'+kn(c.href)+'"]');if(f)return i.instance=f,At(f),f;var j=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(n.ownerDocument||n).createElement("style"),At(f),ws(f,"style",j),Ym(f,c.precedence,n),i.instance=f;case"stylesheet":j=Xo(c.href);var C=n.querySelector(wd(j));if(C)return i.state.loading|=4,i.instance=C,At(C),C;f=BN(c),(j=Ln.get(j))&&eg(f,j),C=(n.ownerDocument||n).createElement("link"),At(C);var A=C;return A._p=new Promise(function(B,Z){A.onload=B,A.onerror=Z}),ws(C,"link",f),i.state.loading|=4,Ym(C,c.precedence,n),i.instance=C;case"script":return C=Qo(c.src),(j=n.querySelector(Sd(C)))?(i.instance=j,At(j),j):(f=c,(j=Ln.get(C))&&(f=x({},c),tg(f,j)),n=n.ownerDocument||n,j=n.createElement("script"),At(j),ws(j,"link",f),n.head.appendChild(j),i.instance=j);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(f=i.instance,i.state.loading|=4,Ym(f,c.precedence,n));return i.instance}function Ym(n,i,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=f.length?f[f.length-1]:null,C=j,A=0;A<f.length;A++){var B=f[A];if(B.dataset.precedence===i)C=B;else if(C!==j)break}C?C.parentNode.insertBefore(n,C.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(n,i.firstChild))}function eg(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function tg(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var qm=null;function HN(n,i,c){if(qm===null){var f=new Map,j=qm=new Map;j.set(c,f)}else j=qm,f=j.get(c),f||(f=new Map,j.set(c,f));if(f.has(n))return f;for(f.set(n,null),c=c.getElementsByTagName(n),j=0;j<c.length;j++){var C=c[j];if(!(C[He]||C[Pa]||n==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var A=C.getAttribute(i)||"";A=n+A;var B=f.get(A);B?B.push(C):f.set(A,[C])}}return f}function UN(n,i,c){n=n.ownerDocument||n,n.head.insertBefore(c,i==="title"?n.querySelector("head > title"):null)}function K_(n,i,c){if(c===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function VN(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function X_(n,i,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var j=Xo(f.href),C=i.querySelector(wd(j));if(C){i=C._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Fm.bind(n),i.then(n,n)),c.state.loading|=4,c.instance=C,At(C);return}C=i.ownerDocument||i,f=BN(f),(j=Ln.get(j))&&eg(f,j),C=C.createElement("link"),At(C);var A=C;A._p=new Promise(function(B,Z){A.onload=B,A.onerror=Z}),ws(C,"link",f),c.instance=C}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(c,i),(i=c.state.preload)&&(c.state.loading&3)===0&&(n.count++,c=Fm.bind(n),i.addEventListener("load",c),i.addEventListener("error",c))}}var ag=0;function Q_(n,i){return n.stylesheets&&n.count===0&&Wm(n,n.stylesheets),0<n.count||0<n.imgCount?function(c){var f=setTimeout(function(){if(n.stylesheets&&Wm(n,n.stylesheets),n.unsuspend){var C=n.unsuspend;n.unsuspend=null,C()}},6e4+i);0<n.imgBytes&&ag===0&&(ag=62500*__());var j=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Wm(n,n.stylesheets),n.unsuspend)){var C=n.unsuspend;n.unsuspend=null,C()}},(n.imgBytes>ag?50:800)+i);return n.unsuspend=c,function(){n.unsuspend=null,clearTimeout(f),clearTimeout(j)}}:null}function Fm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Wm(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Gm=null;function Wm(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Gm=new Map,i.forEach(Z_,n),Gm=null,Fm.call(n))}function Z_(n,i){if(!(i.state.loading&4)){var c=Gm.get(n);if(c)var f=c.get(null);else{c=new Map,Gm.set(n,c);for(var j=n.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<j.length;C++){var A=j[C];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(c.set(A.dataset.precedence,A),f=A)}f&&c.set(null,f)}j=i.instance,A=j.getAttribute("data-precedence"),C=c.get(A)||f,C===f&&c.set(null,j),c.set(A,j),this.count++,f=Fm.bind(this),j.addEventListener("load",f),j.addEventListener("error",f),C?C.parentNode.insertBefore(j,C.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(j,n.firstChild)),i.state.loading|=4}}var Cd={$$typeof:T,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function J_(n,i,c,f,j,C,A,B,Z){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Xt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xt(0),this.hiddenUpdates=Xt(null),this.identifierPrefix=f,this.onUncaughtError=j,this.onCaughtError=C,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function YN(n,i,c,f,j,C,A,B,Z,de,be,Se){return n=new J_(n,i,c,A,Z,de,be,Se,B),i=1,C===!0&&(i|=24),C=dn(3,null,null,i),n.current=C,C.stateNode=n,i=Ip(),i.refCount++,n.pooledCache=i,i.refCount++,C.memoizedState={element:f,isDehydrated:c,cache:i},Bp(C),n}function qN(n){return n?(n=Do,n):Do}function FN(n,i,c,f,j,C){j=qN(j),f.context===null?f.context=j:f.pendingContext=j,f=Oi(i),f.payload={element:c},C=C===void 0?null:C,C!==null&&(f.callback=C),c=Ri(n,f,i),c!==null&&(Xs(c,n,i),sd(c,n,i))}function GN(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var c=n.retryLane;n.retryLane=c!==0&&c<i?c:i}}function sg(n,i){GN(n,i),(n=n.alternate)&&GN(n,i)}function WN(n){if(n.tag===13||n.tag===31){var i=kl(n,67108864);i!==null&&Xs(i,n,67108864),sg(n,67108864)}}function KN(n){if(n.tag===13||n.tag===31){var i=pn();i=Na(i);var c=kl(n,i);c!==null&&Xs(c,n,i),sg(n,i)}}var Km=!0;function eM(n,i,c,f){var j=I.T;I.T=null;var C=O.p;try{O.p=2,ng(n,i,c,f)}finally{O.p=C,I.T=j}}function tM(n,i,c,f){var j=I.T;I.T=null;var C=O.p;try{O.p=8,ng(n,i,c,f)}finally{O.p=C,I.T=j}}function ng(n,i,c,f){if(Km){var j=rg(f);if(j===null)Yx(n,i,f,Xm,c),QN(n,f);else if(sM(j,n,i,c,f))f.stopPropagation();else if(QN(n,f),i&4&&-1<aM.indexOf(n)){for(;j!==null;){var C=Ye(j);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var A=et(C.pendingLanes);if(A!==0){var B=C;for(B.pendingLanes|=2,B.entangledLanes|=2;A;){var Z=1<<31-Pt(A);B.entanglements[1]|=Z,A&=~Z}Nr(C),(ra&6)===0&&(Mm=Oe()+500,vd(0))}}break;case 31:case 13:B=kl(C,2),B!==null&&Xs(B,C,2),Rm(),sg(C,2)}if(C=rg(f),C===null&&Yx(n,i,f,Xm,c),C===j)break;j=C}j!==null&&f.stopPropagation()}else Yx(n,i,f,null,c)}}function rg(n){return n=lp(n),ig(n)}var Xm=null;function ig(n){if(Xm=null,n=Me(n),n!==null){var i=o(n);if(i===null)n=null;else{var c=i.tag;if(c===13){if(n=d(i),n!==null)return n;n=null}else if(c===31){if(n=u(i),n!==null)return n;n=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Xm=n,null}function XN(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Re()){case Ee:return 2;case Pe:return 8;case Je:case rt:return 32;case Et:return 268435456;default:return 32}default:return 32}}var lg=!1,qi=null,Fi=null,Gi=null,Ed=new Map,Td=new Map,Wi=[],aM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function QN(n,i){switch(n){case"focusin":case"focusout":qi=null;break;case"dragenter":case"dragleave":Fi=null;break;case"mouseover":case"mouseout":Gi=null;break;case"pointerover":case"pointerout":Ed.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Td.delete(i.pointerId)}}function Dd(n,i,c,f,j,C){return n===null||n.nativeEvent!==C?(n={blockedOn:i,domEventName:c,eventSystemFlags:f,nativeEvent:C,targetContainers:[j]},i!==null&&(i=Ye(i),i!==null&&WN(i)),n):(n.eventSystemFlags|=f,i=n.targetContainers,j!==null&&i.indexOf(j)===-1&&i.push(j),n)}function sM(n,i,c,f,j){switch(i){case"focusin":return qi=Dd(qi,n,i,c,f,j),!0;case"dragenter":return Fi=Dd(Fi,n,i,c,f,j),!0;case"mouseover":return Gi=Dd(Gi,n,i,c,f,j),!0;case"pointerover":var C=j.pointerId;return Ed.set(C,Dd(Ed.get(C)||null,n,i,c,f,j)),!0;case"gotpointercapture":return C=j.pointerId,Td.set(C,Dd(Td.get(C)||null,n,i,c,f,j)),!0}return!1}function ZN(n){var i=Me(n.target);if(i!==null){var c=o(i);if(c!==null){if(i=c.tag,i===13){if(i=d(c),i!==null){n.blockedOn=i,on(n.priority,function(){KN(c)});return}}else if(i===31){if(i=u(c),i!==null){n.blockedOn=i,on(n.priority,function(){KN(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){n.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Qm(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var c=rg(n.nativeEvent);if(c===null){c=n.nativeEvent;var f=new c.constructor(c.type,c);ip=f,c.target.dispatchEvent(f),ip=null}else return i=Ye(c),i!==null&&WN(i),n.blockedOn=c,!1;i.shift()}return!0}function JN(n,i,c){Qm(n)&&c.delete(i)}function nM(){lg=!1,qi!==null&&Qm(qi)&&(qi=null),Fi!==null&&Qm(Fi)&&(Fi=null),Gi!==null&&Qm(Gi)&&(Gi=null),Ed.forEach(JN),Td.forEach(JN)}function Zm(n,i){n.blockedOn===i&&(n.blockedOn=null,lg||(lg=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,nM)))}var Jm=null;function ew(n){Jm!==n&&(Jm=n,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Jm===n&&(Jm=null);for(var i=0;i<n.length;i+=3){var c=n[i],f=n[i+1],j=n[i+2];if(typeof f!="function"){if(ig(f||c)===null)continue;break}var C=Ye(c);C!==null&&(n.splice(i,3),i-=3,rx(C,{pending:!0,data:j,method:c.method,action:f},f,j))}}))}function Zo(n){function i(Z){return Zm(Z,n)}qi!==null&&Zm(qi,n),Fi!==null&&Zm(Fi,n),Gi!==null&&Zm(Gi,n),Ed.forEach(i),Td.forEach(i);for(var c=0;c<Wi.length;c++){var f=Wi[c];f.blockedOn===n&&(f.blockedOn=null)}for(;0<Wi.length&&(c=Wi[0],c.blockedOn===null);)ZN(c),c.blockedOn===null&&Wi.shift();if(c=(n.ownerDocument||n).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var j=c[f],C=c[f+1],A=j[wa]||null;if(typeof C=="function")A||ew(c);else if(A){var B=null;if(C&&C.hasAttribute("formAction")){if(j=C,A=C[wa]||null)B=A.formAction;else if(ig(j)!==null)continue}else B=A.action;typeof B=="function"?c[f+1]=B:(c.splice(f,3),f-=3),ew(c)}}}function tw(){function n(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(A){return j=A})},focusReset:"manual",scroll:"manual"})}function i(){j!==null&&(j(),j=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,j=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),j!==null&&(j(),j=null)}}}function og(n){this._internalRoot=n}eh.prototype.render=og.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var c=i.current,f=pn();FN(c,f,n,i,null,null)},eh.prototype.unmount=og.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;FN(n.current,2,null,n,null,null),Rm(),i[Gn]=null}};function eh(n){this._internalRoot=n}eh.prototype.unstable_scheduleHydration=function(n){if(n){var i=ys();n={blockedOn:null,target:n,priority:i};for(var c=0;c<Wi.length&&i!==0&&i<Wi[c].priority;c++);Wi.splice(c,0,n),c===0&&ZN(n)}};var aw=a.version;if(aw!=="19.2.3")throw Error(r(527,aw,"19.2.3"));O.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=h(i),n=n!==null?g(n):null,n=n===null?null:n.stateNode,n};var rM={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var th=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!th.isDisabled&&th.supportsFiber)try{Ve=th.inject(rM),nt=th}catch{}}return _d.createRoot=function(n,i){if(!l(n))throw Error(r(299));var c=!1,f="",j=cj,C=dj,A=uj;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(j=i.onUncaughtError),i.onCaughtError!==void 0&&(C=i.onCaughtError),i.onRecoverableError!==void 0&&(A=i.onRecoverableError)),i=YN(n,1,!1,null,null,c,f,null,j,C,A,tw),n[Gn]=i.current,Vx(n),new og(i)},_d.hydrateRoot=function(n,i,c){if(!l(n))throw Error(r(299));var f=!1,j="",C=cj,A=dj,B=uj,Z=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(j=c.identifierPrefix),c.onUncaughtError!==void 0&&(C=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(B=c.onRecoverableError),c.formState!==void 0&&(Z=c.formState)),i=YN(n,1,!0,i,c??null,f,j,Z,C,A,B,tw),i.context=qN(null),c=i.current,f=pn(),f=Na(f),j=Oi(f),j.callback=null,Ri(c,j,f),c=f,i.current.lanes=c,ht(i,c),Nr(i),n[Gn]=i.current,Vx(n),new eh(i)},_d.version="19.2.3",_d}var uw;function XM(){if(uw)return dg.exports;uw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(a){console.error(a)}}return t(),dg.exports=KM(),dg.exports}var QM=XM();const ZM=wM(QM);var mw="popstate";function JM(t={}){function a(r,l){let{pathname:o,search:d,hash:u}=r.location;return u0("",{pathname:o,search:d,hash:u},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function s(r,l){return typeof l=="string"?l:fu(l)}return t4(a,s,null,t)}function ts(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function Cn(t,a){if(!t){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function e4(){return Math.random().toString(36).substring(2,10)}function hw(t,a){return{usr:t.state,key:t.key,idx:a}}function u0(t,a,s=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof a=="string"?Tu(a):a,state:s,key:a&&a.key||r||e4()}}function fu({pathname:t="/",search:a="",hash:s=""}){return a&&a!=="?"&&(t+=a.charAt(0)==="?"?a:"?"+a),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Tu(t){let a={};if(t){let s=t.indexOf("#");s>=0&&(a.hash=t.substring(s),t=t.substring(0,s));let r=t.indexOf("?");r>=0&&(a.search=t.substring(r),t=t.substring(0,r)),t&&(a.pathname=t)}return a}function t4(t,a,s,r={}){let{window:l=document.defaultView,v5Compat:o=!1}=r,d=l.history,u="POP",m=null,h=g();h==null&&(h=0,d.replaceState({...d.state,idx:h},""));function g(){return(d.state||{idx:null}).idx}function x(){u="POP";let S=g(),w=S==null?null:S-h;h=S,m&&m({action:u,location:N.location,delta:w})}function y(S,w){u="PUSH";let E=u0(N.location,S,w);h=g()+1;let T=hw(E,h),D=N.createHref(E);try{d.pushState(T,"",D)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;l.location.assign(D)}o&&m&&m({action:u,location:N.location,delta:1})}function v(S,w){u="REPLACE";let E=u0(N.location,S,w);h=g();let T=hw(E,h),D=N.createHref(E);d.replaceState(T,"",D),o&&m&&m({action:u,location:N.location,delta:0})}function b(S){return a4(S)}let N={get action(){return u},get location(){return t(l,d)},listen(S){if(m)throw new Error("A history only accepts one active listener");return l.addEventListener(mw,x),m=S,()=>{l.removeEventListener(mw,x),m=null}},createHref(S){return a(l,S)},createURL:b,encodeLocation(S){let w=b(S);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:y,replace:v,go(S){return d.go(S)}};return N}function a4(t,a=!1){let s="http://localhost";typeof window<"u"&&(s=window.location.origin!=="null"?window.location.origin:window.location.href),ts(s,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:fu(t);return r=r.replace(/ $/,"%20"),!a&&r.startsWith("//")&&(r=s+r),new URL(r,s)}function w1(t,a,s="/"){return s4(t,a,s,!1)}function s4(t,a,s,r){let l=typeof a=="string"?Tu(a):a,o=gi(l.pathname||"/",s);if(o==null)return null;let d=S1(t);n4(d);let u=null;for(let m=0;u==null&&m<d.length;++m){let h=p4(o);u=h4(d[m],h,r)}return u}function S1(t,a=[],s=[],r="",l=!1){let o=(d,u,m=l,h)=>{let g={relativePath:h===void 0?d.path||"":h,caseSensitive:d.caseSensitive===!0,childrenIndex:u,route:d};if(g.relativePath.startsWith("/")){if(!g.relativePath.startsWith(r)&&m)return;ts(g.relativePath.startsWith(r),`Absolute route path "${g.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),g.relativePath=g.relativePath.slice(r.length)}let x=hi([r,g.relativePath]),y=s.concat(g);d.children&&d.children.length>0&&(ts(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),S1(d.children,a,y,x,m)),!(d.path==null&&!d.index)&&a.push({path:x,score:u4(x,d.index),routesMeta:y})};return t.forEach((d,u)=>{if(d.path===""||!d.path?.includes("?"))o(d,u);else for(let m of C1(d.path))o(d,u,!0,m)}),a}function C1(t){let a=t.split("/");if(a.length===0)return[];let[s,...r]=a,l=s.endsWith("?"),o=s.replace(/\?$/,"");if(r.length===0)return l?[o,""]:[o];let d=C1(r.join("/")),u=[];return u.push(...d.map(m=>m===""?o:[o,m].join("/"))),l&&u.push(...d),u.map(m=>t.startsWith("/")&&m===""?"/":m)}function n4(t){t.sort((a,s)=>a.score!==s.score?s.score-a.score:m4(a.routesMeta.map(r=>r.childrenIndex),s.routesMeta.map(r=>r.childrenIndex)))}var r4=/^:[\w-]+$/,i4=3,l4=2,o4=1,c4=10,d4=-2,fw=t=>t==="*";function u4(t,a){let s=t.split("/"),r=s.length;return s.some(fw)&&(r+=d4),a&&(r+=l4),s.filter(l=>!fw(l)).reduce((l,o)=>l+(r4.test(o)?i4:o===""?o4:c4),r)}function m4(t,a){return t.length===a.length&&t.slice(0,-1).every((r,l)=>r===a[l])?t[t.length-1]-a[a.length-1]:0}function h4(t,a,s=!1){let{routesMeta:r}=t,l={},o="/",d=[];for(let u=0;u<r.length;++u){let m=r[u],h=u===r.length-1,g=o==="/"?a:a.slice(o.length)||"/",x=Lh({path:m.relativePath,caseSensitive:m.caseSensitive,end:h},g),y=m.route;if(!x&&h&&s&&!r[r.length-1].route.index&&(x=Lh({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},g)),!x)return null;Object.assign(l,x.params),d.push({params:l,pathname:hi([o,x.pathname]),pathnameBase:v4(hi([o,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(o=hi([o,x.pathnameBase]))}return d}function Lh(t,a){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,r]=f4(t.path,t.caseSensitive,t.end),l=a.match(s);if(!l)return null;let o=l[0],d=o.replace(/(.)\/+$/,"$1"),u=l.slice(1);return{params:r.reduce((h,{paramName:g,isOptional:x},y)=>{if(g==="*"){let b=u[y]||"";d=o.slice(0,o.length-b.length).replace(/(.)\/+$/,"$1")}const v=u[y];return x&&!v?h[g]=void 0:h[g]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:d,pattern:t}}function f4(t,a=!1,s=!0){Cn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,u,m)=>(r.push({paramName:u,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,a?void 0:"i"),r]}function p4(t){try{return t.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return Cn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${a}).`),t}}function gi(t,a){if(a==="/")return t;if(!t.toLowerCase().startsWith(a.toLowerCase()))return null;let s=a.endsWith("/")?a.length-1:a.length,r=t.charAt(s);return r&&r!=="/"?null:t.slice(s)||"/"}var E1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,x4=t=>E1.test(t);function g4(t,a="/"){let{pathname:s,search:r="",hash:l=""}=typeof t=="string"?Tu(t):t,o;if(s)if(x4(s))o=s;else{if(s.includes("//")){let d=s;s=s.replace(/\/\/+/g,"/"),Cn(!1,`Pathnames cannot have embedded double slashes - normalizing ${d} -> ${s}`)}s.startsWith("/")?o=pw(s.substring(1),"/"):o=pw(s,a)}else o=a;return{pathname:o,search:b4(r),hash:j4(l)}}function pw(t,a){let s=a.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?s.length>1&&s.pop():l!=="."&&s.push(l)}),s.length>1?s.join("/"):"/"}function hg(t,a,s,r){return`Cannot include a '${t}' character in a manually specified \`to.${a}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function y4(t){return t.filter((a,s)=>s===0||a.route.path&&a.route.path.length>0)}function cy(t){let a=y4(t);return a.map((s,r)=>r===a.length-1?s.pathname:s.pathnameBase)}function dy(t,a,s,r=!1){let l;typeof t=="string"?l=Tu(t):(l={...t},ts(!l.pathname||!l.pathname.includes("?"),hg("?","pathname","search",l)),ts(!l.pathname||!l.pathname.includes("#"),hg("#","pathname","hash",l)),ts(!l.search||!l.search.includes("#"),hg("#","search","hash",l)));let o=t===""||l.pathname==="",d=o?"/":l.pathname,u;if(d==null)u=s;else{let x=a.length-1;if(!r&&d.startsWith("..")){let y=d.split("/");for(;y[0]==="..";)y.shift(),x-=1;l.pathname=y.join("/")}u=x>=0?a[x]:"/"}let m=g4(l,u),h=d&&d!=="/"&&d.endsWith("/"),g=(o||d===".")&&s.endsWith("/");return!m.pathname.endsWith("/")&&(h||g)&&(m.pathname+="/"),m}var hi=t=>t.join("/").replace(/\/\/+/g,"/"),v4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),b4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,j4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,N4=class{constructor(t,a,s,r=!1){this.status=t,this.statusText=a||"",this.internal=r,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}};function w4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function S4(t){return t.map(a=>a.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var T1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function D1(t,a){let s=t;if(typeof s!="string"||!E1.test(s))return{absoluteURL:void 0,isExternal:!1,to:s};let r=s,l=!1;if(T1)try{let o=new URL(window.location.href),d=s.startsWith("//")?new URL(o.protocol+s):new URL(s),u=gi(d.pathname,a);d.origin===o.origin&&u!=null?s=u+d.search+d.hash:l=!0}catch{Cn(!1,`<Link to="${s}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:l,to:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var k1=["POST","PUT","PATCH","DELETE"];new Set(k1);var C4=["GET",...k1];new Set(C4);var _c=p.createContext(null);_c.displayName="DataRouter";var wf=p.createContext(null);wf.displayName="DataRouterState";var E4=p.createContext(!1),A1=p.createContext({isTransitioning:!1});A1.displayName="ViewTransition";var T4=p.createContext(new Map);T4.displayName="Fetchers";var D4=p.createContext(null);D4.displayName="Await";var En=p.createContext(null);En.displayName="Navigation";var Sf=p.createContext(null);Sf.displayName="Location";var qn=p.createContext({outlet:null,matches:[],isDataRoute:!1});qn.displayName="Route";var uy=p.createContext(null);uy.displayName="RouteError";var _1="REACT_ROUTER_ERROR",k4="REDIRECT",A4="ROUTE_ERROR_RESPONSE";function _4(t){if(t.startsWith(`${_1}:${k4}:{`))try{let a=JSON.parse(t.slice(28));if(typeof a=="object"&&a&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.location=="string"&&typeof a.reloadDocument=="boolean"&&typeof a.replace=="boolean")return a}catch{}}function M4(t){if(t.startsWith(`${_1}:${A4}:{`))try{let a=JSON.parse(t.slice(40));if(typeof a=="object"&&a&&typeof a.status=="number"&&typeof a.statusText=="string")return new N4(a.status,a.statusText,a.data)}catch{}}function O4(t,{relative:a}={}){ts(Mc(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:r}=p.useContext(En),{hash:l,pathname:o,search:d}=Du(t,{relative:a}),u=o;return s!=="/"&&(u=o==="/"?s:hi([s,o])),r.createHref({pathname:u,search:d,hash:l})}function Mc(){return p.useContext(Sf)!=null}function gs(){return ts(Mc(),"useLocation() may be used only in the context of a <Router> component."),p.useContext(Sf).location}var M1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function O1(t){p.useContext(En).static||p.useLayoutEffect(t)}function it(){let{isDataRoute:t}=p.useContext(qn);return t?W4():R4()}function R4(){ts(Mc(),"useNavigate() may be used only in the context of a <Router> component.");let t=p.useContext(_c),{basename:a,navigator:s}=p.useContext(En),{matches:r}=p.useContext(qn),{pathname:l}=gs(),o=JSON.stringify(cy(r)),d=p.useRef(!1);return O1(()=>{d.current=!0}),p.useCallback((m,h={})=>{if(Cn(d.current,M1),!d.current)return;if(typeof m=="number"){s.go(m);return}let g=dy(m,JSON.parse(o),l,h.relative==="path");t==null&&a!=="/"&&(g.pathname=g.pathname==="/"?a:hi([a,g.pathname])),(h.replace?s.replace:s.push)(g,h.state,h)},[a,s,o,l,t])}var I4=p.createContext(null);function z4(t){let a=p.useContext(qn).outlet;return p.useMemo(()=>a&&p.createElement(I4.Provider,{value:t},a),[a,t])}function Ss(){let{matches:t}=p.useContext(qn),a=t[t.length-1];return a?a.params:{}}function Du(t,{relative:a}={}){let{matches:s}=p.useContext(qn),{pathname:r}=gs(),l=JSON.stringify(cy(s));return p.useMemo(()=>dy(t,JSON.parse(l),r,a==="path"),[t,l,r,a])}function L4(t,a){return R1(t)}function R1(t,a,s,r,l){ts(Mc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=p.useContext(En),{matches:d}=p.useContext(qn),u=d[d.length-1],m=u?u.params:{},h=u?u.pathname:"/",g=u?u.pathnameBase:"/",x=u&&u.route;{let E=x&&x.path||"";z1(h,!x||E.endsWith("*")||E.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${E}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${E}"> to <Route path="${E==="/"?"*":`${E}/*`}">.`)}let y=gs(),v;v=y;let b=v.pathname||"/",N=b;if(g!=="/"){let E=g.replace(/^\//,"").split("/");N="/"+b.replace(/^\//,"").split("/").slice(E.length).join("/")}let S=w1(t,{pathname:N});return Cn(x||S!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Cn(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),U4(S&&S.map(E=>Object.assign({},E,{params:Object.assign({},m,E.params),pathname:hi([g,o.encodeLocation?o.encodeLocation(E.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?g:hi([g,o.encodeLocation?o.encodeLocation(E.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:E.pathnameBase])})),d,s,r,l)}function P4(){let t=G4(),a=w4(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},d=null;return console.error("Error handled by React Router default ErrorBoundary:",t),d=p.createElement(p.Fragment,null,p.createElement("p",null," Hey developer "),p.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",p.createElement("code",{style:o},"ErrorBoundary")," or"," ",p.createElement("code",{style:o},"errorElement")," prop on your route.")),p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},a),s?p.createElement("pre",{style:l},s):null,d)}var B4=p.createElement(P4,null),I1=class extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,a){return a.location!==t.location||a.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:a.error,location:a.location,revalidation:t.revalidation||a.revalidation}}componentDidCatch(t,a){this.props.onError?this.props.onError(t,a):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const s=M4(t.digest);s&&(t=s)}let a=t!==void 0?p.createElement(qn.Provider,{value:this.props.routeContext},p.createElement(uy.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?p.createElement($4,{error:t},a):a}};I1.contextType=E4;var fg=new WeakMap;function $4({children:t,error:a}){let{basename:s}=p.useContext(En);if(typeof a=="object"&&a&&"digest"in a&&typeof a.digest=="string"){let r=_4(a.digest);if(r){let l=fg.get(a);if(l)throw l;let o=D1(r.location,s);if(T1&&!fg.get(a))if(o.isExternal||r.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const d=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:r.replace}));throw fg.set(a,d),d}return p.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return t}function H4({routeContext:t,match:a,children:s}){let r=p.useContext(_c);return r&&r.static&&r.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=a.route.id),p.createElement(qn.Provider,{value:t},s)}function U4(t,a=[],s=null,r=null,l=null){if(t==null){if(!s)return null;if(s.errors)t=s.matches;else if(a.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let o=t,d=s?.errors;if(d!=null){let g=o.findIndex(x=>x.route.id&&d?.[x.route.id]!==void 0);ts(g>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),o=o.slice(0,Math.min(o.length,g+1))}let u=!1,m=-1;if(s)for(let g=0;g<o.length;g++){let x=o[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(m=g),x.route.id){let{loaderData:y,errors:v}=s,b=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!v||v[x.route.id]===void 0);if(x.route.lazy||b){u=!0,m>=0?o=o.slice(0,m+1):o=[o[0]];break}}}let h=s&&r?(g,x)=>{r(g,{location:s.location,params:s.matches?.[0]?.params??{},unstable_pattern:S4(s.matches),errorInfo:x})}:void 0;return o.reduceRight((g,x,y)=>{let v,b=!1,N=null,S=null;s&&(v=d&&x.route.id?d[x.route.id]:void 0,N=x.route.errorElement||B4,u&&(m<0&&y===0?(z1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,S=null):m===y&&(b=!0,S=x.route.hydrateFallbackElement||null)));let w=a.concat(o.slice(0,y+1)),E=()=>{let T;return v?T=N:b?T=S:x.route.Component?T=p.createElement(x.route.Component,null):x.route.element?T=x.route.element:T=g,p.createElement(H4,{match:x,routeContext:{outlet:g,matches:w,isDataRoute:s!=null},children:T})};return s&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?p.createElement(I1,{location:s.location,revalidation:s.revalidation,component:N,error:v,children:E(),routeContext:{outlet:null,matches:w,isDataRoute:!0},onError:h}):E()},null)}function my(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function V4(t){let a=p.useContext(_c);return ts(a,my(t)),a}function Y4(t){let a=p.useContext(wf);return ts(a,my(t)),a}function q4(t){let a=p.useContext(qn);return ts(a,my(t)),a}function hy(t){let a=q4(t),s=a.matches[a.matches.length-1];return ts(s.route.id,`${t} can only be used on routes that contain a unique "id"`),s.route.id}function F4(){return hy("useRouteId")}function G4(){let t=p.useContext(uy),a=Y4("useRouteError"),s=hy("useRouteError");return t!==void 0?t:a.errors?.[s]}function W4(){let{router:t}=V4("useNavigate"),a=hy("useNavigate"),s=p.useRef(!1);return O1(()=>{s.current=!0}),p.useCallback(async(l,o={})=>{Cn(s.current,M1),s.current&&(typeof l=="number"?await t.navigate(l):await t.navigate(l,{fromRouteId:a,...o}))},[t,a])}var xw={};function z1(t,a,s){!a&&!xw[t]&&(xw[t]=!0,Cn(!1,s))}p.memo(K4);function K4({routes:t,future:a,state:s,onError:r}){return R1(t,void 0,s,r,a)}function Ft({to:t,replace:a,state:s,relative:r}){ts(Mc(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=p.useContext(En);Cn(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=p.useContext(qn),{pathname:d}=gs(),u=it(),m=dy(t,cy(o),d,r==="path"),h=JSON.stringify(m);return p.useEffect(()=>{u(JSON.parse(h),{replace:a,state:s,relative:r})},[u,h,r,a,s]),null}function X4(t){return z4(t.context)}function Q4({basename:t="/",children:a=null,location:s,navigationType:r="POP",navigator:l,static:o=!1,unstable_useTransitions:d}){ts(!Mc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),m=p.useMemo(()=>({basename:u,navigator:l,static:o,unstable_useTransitions:d,future:{}}),[u,l,o,d]);typeof s=="string"&&(s=Tu(s));let{pathname:h="/",search:g="",hash:x="",state:y=null,key:v="default"}=s,b=p.useMemo(()=>{let N=gi(h,u);return N==null?null:{location:{pathname:N,search:g,hash:x,state:y,key:v},navigationType:r}},[u,h,g,x,y,v,r]);return Cn(b!=null,`<Router basename="${u}"> is not able to match the URL "${h}${g}${x}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:p.createElement(En.Provider,{value:m},p.createElement(Sf.Provider,{children:a,value:b}))}var Ch="get",Eh="application/x-www-form-urlencoded";function Cf(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function Z4(t){return Cf(t)&&t.tagName.toLowerCase()==="button"}function J4(t){return Cf(t)&&t.tagName.toLowerCase()==="form"}function eO(t){return Cf(t)&&t.tagName.toLowerCase()==="input"}function tO(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function aO(t,a){return t.button===0&&(!a||a==="_self")&&!tO(t)}function m0(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((a,s)=>{let r=t[s];return a.concat(Array.isArray(r)?r.map(l=>[s,l]):[[s,r]])},[]))}function sO(t,a){let s=m0(t);return a&&a.forEach((r,l)=>{s.has(l)||a.getAll(l).forEach(o=>{s.append(l,o)})}),s}var ah=null;function nO(){if(ah===null)try{new FormData(document.createElement("form"),0),ah=!1}catch{ah=!0}return ah}var rO=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function pg(t){return t!=null&&!rO.has(t)?(Cn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Eh}"`),null):t}function iO(t,a){let s,r,l,o,d;if(J4(t)){let u=t.getAttribute("action");r=u?gi(u,a):null,s=t.getAttribute("method")||Ch,l=pg(t.getAttribute("enctype"))||Eh,o=new FormData(t)}else if(Z4(t)||eO(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=t.getAttribute("formaction")||u.getAttribute("action");if(r=m?gi(m,a):null,s=t.getAttribute("formmethod")||u.getAttribute("method")||Ch,l=pg(t.getAttribute("formenctype"))||pg(u.getAttribute("enctype"))||Eh,o=new FormData(u,t),!nO()){let{name:h,type:g,value:x}=t;if(g==="image"){let y=h?`${h}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else h&&o.append(h,x)}}else{if(Cf(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=Ch,r=null,l=Eh,d=t}return o&&l==="text/plain"&&(d=o,o=void 0),{action:r,method:s.toLowerCase(),encType:l,formData:o,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function fy(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function lO(t,a,s){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${s}`:a&&gi(r.pathname,a)==="/"?r.pathname=`${a.replace(/\/$/,"")}/_root.${s}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${s}`,r}async function oO(t,a){if(t.id in a)return a[t.id];try{let s=await import(t.module);return a[t.id]=s,s}catch(s){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function cO(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function dO(t,a,s){let r=await Promise.all(t.map(async l=>{let o=a.routes[l.route.id];if(o){let d=await oO(o,s);return d.links?d.links():[]}return[]}));return fO(r.flat(1).filter(cO).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function gw(t,a,s,r,l,o){let d=(m,h)=>s[h]?m.route.id!==s[h].route.id:!0,u=(m,h)=>s[h].pathname!==m.pathname||s[h].route.path?.endsWith("*")&&s[h].params["*"]!==m.params["*"];return o==="assets"?a.filter((m,h)=>d(m,h)||u(m,h)):o==="data"?a.filter((m,h)=>{let g=r.routes[m.route.id];if(!g||!g.hasLoader)return!1;if(d(m,h)||u(m,h))return!0;if(m.route.shouldRevalidate){let x=m.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:s[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function uO(t,a,{includeHydrateFallback:s}={}){return mO(t.map(r=>{let l=a.routes[r.route.id];if(!l)return[];let o=[l.module];return l.clientActionModule&&(o=o.concat(l.clientActionModule)),l.clientLoaderModule&&(o=o.concat(l.clientLoaderModule)),s&&l.hydrateFallbackModule&&(o=o.concat(l.hydrateFallbackModule)),l.imports&&(o=o.concat(l.imports)),o}).flat(1))}function mO(t){return[...new Set(t)]}function hO(t){let a={},s=Object.keys(t).sort();for(let r of s)a[r]=t[r];return a}function fO(t,a){let s=new Set;return new Set(a),t.reduce((r,l)=>{let o=JSON.stringify(hO(l));return s.has(o)||(s.add(o),r.push({key:o,link:l})),r},[])}function L1(){let t=p.useContext(_c);return fy(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function pO(){let t=p.useContext(wf);return fy(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var py=p.createContext(void 0);py.displayName="FrameworkContext";function P1(){let t=p.useContext(py);return fy(t,"You must render this element inside a <HydratedRouter> element"),t}function xO(t,a){let s=p.useContext(py),[r,l]=p.useState(!1),[o,d]=p.useState(!1),{onFocus:u,onBlur:m,onMouseEnter:h,onMouseLeave:g,onTouchStart:x}=a,y=p.useRef(null);p.useEffect(()=>{if(t==="render"&&d(!0),t==="viewport"){let N=w=>{w.forEach(E=>{d(E.isIntersecting)})},S=new IntersectionObserver(N,{threshold:.5});return y.current&&S.observe(y.current),()=>{S.disconnect()}}},[t]),p.useEffect(()=>{if(r){let N=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(N)}}},[r]);let v=()=>{l(!0)},b=()=>{l(!1),d(!1)};return s?t!=="intent"?[o,y,{}]:[o,y,{onFocus:Md(u,v),onBlur:Md(m,b),onMouseEnter:Md(h,v),onMouseLeave:Md(g,b),onTouchStart:Md(x,v)}]:[!1,y,{}]}function Md(t,a){return s=>{t&&t(s),s.defaultPrevented||a(s)}}function gO({page:t,...a}){let{router:s}=L1(),r=p.useMemo(()=>w1(s.routes,t,s.basename),[s.routes,t,s.basename]);return r?p.createElement(vO,{page:t,matches:r,...a}):null}function yO(t){let{manifest:a,routeModules:s}=P1(),[r,l]=p.useState([]);return p.useEffect(()=>{let o=!1;return dO(t,a,s).then(d=>{o||l(d)}),()=>{o=!0}},[t,a,s]),r}function vO({page:t,matches:a,...s}){let r=gs(),{manifest:l,routeModules:o}=P1(),{basename:d}=L1(),{loaderData:u,matches:m}=pO(),h=p.useMemo(()=>gw(t,a,m,l,r,"data"),[t,a,m,l,r]),g=p.useMemo(()=>gw(t,a,m,l,r,"assets"),[t,a,m,l,r]),x=p.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let b=new Set,N=!1;if(a.forEach(w=>{let E=l.routes[w.route.id];!E||!E.hasLoader||(!h.some(T=>T.route.id===w.route.id)&&w.route.id in u&&o[w.route.id]?.shouldRevalidate||E.hasClientLoader?N=!0:b.add(w.route.id))}),b.size===0)return[];let S=lO(t,d,"data");return N&&b.size>0&&S.searchParams.set("_routes",a.filter(w=>b.has(w.route.id)).map(w=>w.route.id).join(",")),[S.pathname+S.search]},[d,u,r,l,h,a,t,o]),y=p.useMemo(()=>uO(g,l),[g,l]),v=yO(g);return p.createElement(p.Fragment,null,x.map(b=>p.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...s})),y.map(b=>p.createElement("link",{key:b,rel:"modulepreload",href:b,...s})),v.map(({key:b,link:N})=>p.createElement("link",{key:b,nonce:s.nonce,...N})))}function bO(...t){return a=>{t.forEach(s=>{typeof s=="function"?s(a):s!=null&&(s.current=a)})}}var jO=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{jO&&(window.__reactRouterVersion="7.11.0")}catch{}function NO({basename:t,children:a,unstable_useTransitions:s,window:r}){let l=p.useRef();l.current==null&&(l.current=JM({window:r,v5Compat:!0}));let o=l.current,[d,u]=p.useState({action:o.action,location:o.location}),m=p.useCallback(h=>{s===!1?u(h):p.startTransition(()=>u(h))},[s]);return p.useLayoutEffect(()=>o.listen(m),[o,m]),p.createElement(Q4,{basename:t,children:a,location:d.location,navigationType:d.action,navigator:o,unstable_useTransitions:s})}var B1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,La=p.forwardRef(function({onClick:a,discover:s="render",prefetch:r="none",relative:l,reloadDocument:o,replace:d,state:u,target:m,to:h,preventScrollReset:g,viewTransition:x,unstable_defaultShouldRevalidate:y,...v},b){let{basename:N,unstable_useTransitions:S}=p.useContext(En),w=typeof h=="string"&&B1.test(h),E=D1(h,N);h=E.to;let T=O4(h,{relative:l}),[D,k,_]=xO(r,v),R=EO(h,{replace:d,state:u,target:m,preventScrollReset:g,relative:l,viewTransition:x,unstable_defaultShouldRevalidate:y,unstable_useTransitions:S});function L(V){a&&a(V),V.defaultPrevented||R(V)}let U=p.createElement("a",{...v,..._,href:E.absoluteURL||T,onClick:E.isExternal||o?a:L,ref:bO(b,k),target:m,"data-discover":!w&&s==="render"?"true":void 0});return D&&!w?p.createElement(p.Fragment,null,U,p.createElement(gO,{page:T})):U});La.displayName="Link";var wO=p.forwardRef(function({"aria-current":a="page",caseSensitive:s=!1,className:r="",end:l=!1,style:o,to:d,viewTransition:u,children:m,...h},g){let x=Du(d,{relative:h.relative}),y=gs(),v=p.useContext(wf),{navigator:b,basename:N}=p.useContext(En),S=v!=null&&_O(x)&&u===!0,w=b.encodeLocation?b.encodeLocation(x).pathname:x.pathname,E=y.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;s||(E=E.toLowerCase(),T=T?T.toLowerCase():null,w=w.toLowerCase()),T&&N&&(T=gi(T,N)||T);const D=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let k=E===w||!l&&E.startsWith(w)&&E.charAt(D)==="/",_=T!=null&&(T===w||!l&&T.startsWith(w)&&T.charAt(w.length)==="/"),R={isActive:k,isPending:_,isTransitioning:S},L=k?a:void 0,U;typeof r=="function"?U=r(R):U=[r,k?"active":null,_?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let V=typeof o=="function"?o(R):o;return p.createElement(La,{...h,"aria-current":L,className:U,ref:g,style:V,to:d,viewTransition:u},typeof m=="function"?m(R):m)});wO.displayName="NavLink";var SO=p.forwardRef(({discover:t="render",fetcherKey:a,navigate:s,reloadDocument:r,replace:l,state:o,method:d=Ch,action:u,onSubmit:m,relative:h,preventScrollReset:g,viewTransition:x,unstable_defaultShouldRevalidate:y,...v},b)=>{let{unstable_useTransitions:N}=p.useContext(En),S=kO(),w=AO(u,{relative:h}),E=d.toLowerCase()==="get"?"get":"post",T=typeof u=="string"&&B1.test(u),D=k=>{if(m&&m(k),k.defaultPrevented)return;k.preventDefault();let _=k.nativeEvent.submitter,R=_?.getAttribute("formmethod")||d,L=()=>S(_||k.currentTarget,{fetcherKey:a,method:R,navigate:s,replace:l,state:o,relative:h,preventScrollReset:g,viewTransition:x,unstable_defaultShouldRevalidate:y});N&&s!==!1?p.startTransition(()=>L()):L()};return p.createElement("form",{ref:b,method:E,action:w,onSubmit:r?m:D,...v,"data-discover":!T&&t==="render"?"true":void 0})});SO.displayName="Form";function CO(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $1(t){let a=p.useContext(_c);return ts(a,CO(t)),a}function EO(t,{target:a,replace:s,state:r,preventScrollReset:l,relative:o,viewTransition:d,unstable_defaultShouldRevalidate:u,unstable_useTransitions:m}={}){let h=it(),g=gs(),x=Du(t,{relative:o});return p.useCallback(y=>{if(aO(y,a)){y.preventDefault();let v=s!==void 0?s:fu(g)===fu(x),b=()=>h(t,{replace:v,state:r,preventScrollReset:l,relative:o,viewTransition:d,unstable_defaultShouldRevalidate:u});m?p.startTransition(()=>b()):b()}},[g,h,x,s,r,a,t,l,o,d,u,m])}function Ef(t){Cn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let a=p.useRef(m0(t)),s=p.useRef(!1),r=gs(),l=p.useMemo(()=>sO(r.search,s.current?null:a.current),[r.search]),o=it(),d=p.useCallback((u,m)=>{const h=m0(typeof u=="function"?u(new URLSearchParams(l)):u);s.current=!0,o("?"+h,m)},[o,l]);return[l,d]}var TO=0,DO=()=>`__${String(++TO)}__`;function kO(){let{router:t}=$1("useSubmit"),{basename:a}=p.useContext(En),s=F4(),r=t.fetch,l=t.navigate;return p.useCallback(async(o,d={})=>{let{action:u,method:m,encType:h,formData:g,body:x}=iO(o,a);if(d.navigate===!1){let y=d.fetcherKey||DO();await r(y,s,d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:g,body:x,formMethod:d.method||m,formEncType:d.encType||h,flushSync:d.flushSync})}else await l(d.action||u,{unstable_defaultShouldRevalidate:d.unstable_defaultShouldRevalidate,preventScrollReset:d.preventScrollReset,formData:g,body:x,formMethod:d.method||m,formEncType:d.encType||h,replace:d.replace,state:d.state,fromRouteId:s,flushSync:d.flushSync,viewTransition:d.viewTransition})},[r,l,a,s])}function AO(t,{relative:a}={}){let{basename:s}=p.useContext(En),r=p.useContext(qn);ts(r,"useFormAction must be used inside a RouteContext");let[l]=r.matches.slice(-1),o={...Du(t||".",{relative:a})},d=gs();if(t==null){o.search=d.search;let u=new URLSearchParams(o.search),m=u.getAll("index");if(m.some(g=>g==="")){u.delete("index"),m.filter(x=>x).forEach(x=>u.append("index",x));let g=u.toString();o.search=g?`?${g}`:""}}return(!t||t===".")&&l.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),s!=="/"&&(o.pathname=o.pathname==="/"?s:hi([s,o.pathname])),fu(o)}function _O(t,{relative:a}={}){let s=p.useContext(A1);ts(s!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=$1("useViewTransitionState"),l=Du(t,{relative:a});if(!s.isTransitioning)return!1;let o=gi(s.currentLocation.pathname,r)||s.currentLocation.pathname,d=gi(s.nextLocation.pathname,r)||s.nextLocation.pathname;return Lh(l.pathname,d)!=null||Lh(l.pathname,o)!=null}const MO="modulepreload",OO=function(t){return"/life-tracker/"+t},yw={},RO=function(a,s,r){let l=Promise.resolve();if(s&&s.length>0){let m=function(h){return Promise.all(h.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),u=d?.nonce||d?.getAttribute("nonce");l=m(s.map(h=>{if(h=OO(h),h in yw)return;yw[h]=!0;const g=h.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${x}`))return;const y=document.createElement("link");if(y.rel=g?"stylesheet":MO,g||(y.as="script"),y.crossOrigin="",y.href=h,u&&y.setAttribute("nonce",u),document.head.appendChild(y),g)return new Promise((v,b)=>{y.addEventListener("load",v),y.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(d){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=d,window.dispatchEvent(u),!u.defaultPrevented)throw d}return l.then(d=>{for(const u of d||[])u.status==="rejected"&&o(u.reason);return a().catch(o)})};function IO(t={}){const{immediate:a=!1,onNeedRefresh:s,onOfflineReady:r,onRegistered:l,onRegisteredSW:o,onRegisterError:d}=t;let u,m;const h=async(x=!0)=>{await m};async function g(){if("serviceWorker"in navigator){if(u=await RO(async()=>{const{Workbox:x}=await import("../chunks/workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:x}},[]).then(({Workbox:x})=>new x("/life-tracker/service-worker.js",{scope:"/life-tracker/",type:"classic"})).catch(x=>{d?.(x)}),!u)return;u.addEventListener("activated",x=>{(x.isUpdate||x.isExternal)&&window.location.reload()}),u.addEventListener("installed",x=>{x.isUpdate||r?.()}),u.register({immediate:a}).then(x=>{o?o("/life-tracker/service-worker.js",x):l?.(x)}).catch(x=>{d?.(x)})}}return m=g(),h}const zO="https://tpcjwhnrcrisgcqjfjqg.supabase.co",LO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRwY2p3aG5yY3Jpc2djcWpmanFnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjczNjQwMzIsImV4cCI6MjA4Mjk0MDAzMn0.l3SKUDorBgQcIJkBdOYLtQMs0800jSLMchEILwFejJw",ze=SM(zO,LO,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});function st(){const[t,a]=p.useState(null),[s,r]=p.useState(!0);return p.useEffect(()=>{ze.auth.getSession().then(({data:{session:m}})=>{a(m?.user??null),r(!1)});const{data:{subscription:u}}=ze.auth.onAuthStateChange((m,h)=>{a(h?.user??null),r(!1)});return()=>u.unsubscribe()},[]),{user:t,loading:s,signIn:async(u,m)=>{try{const{data:h,error:g}=await ze.auth.signInWithPassword({email:u,password:m});if(g)throw g;return h}catch(h){throw console.error("Error al iniciar sesin:",h),h}},signUp:async(u,m)=>{try{const{data:h,error:g}=await ze.auth.signUp({email:u,password:m});if(g)throw g;return h}catch(h){throw console.error("Error al registrarse:",h),h}},signOut:async()=>{try{const{error:u}=await ze.auth.signOut();if(u)throw u}catch(u){throw console.error("Error al cerrar sesin:",u),u}}}}const ku=()=>{const[t,a]=p.useState(()=>{if(typeof window>"u")return{deviceType:"desktop",orientation:"landscape",isMobile:!1,isTablet:!1,isDesktop:!0,screenWidth:1920,screenHeight:1080,shouldShowDesktopNav:!0};const s=window.innerWidth,r=window.innerHeight,l=s<768,o=s>=768&&s<1024,d=s>=1024,u=s>=768;return{deviceType:s<768?"mobile":s<1024?"tablet":"desktop",orientation:s<r?"portrait":"landscape",isMobile:l,isTablet:o,isDesktop:d,screenWidth:s,screenHeight:r,shouldShowDesktopNav:u}});return p.useEffect(()=>{const s=()=>{const l=window.innerWidth,o=window.innerHeight,d=l<768,u=l>=768&&l<1024,m=l>=1024,h=l>=768;a({deviceType:l<768?"mobile":l<1024?"tablet":"desktop",orientation:l<o?"portrait":"landscape",isMobile:d,isTablet:u,isDesktop:m,screenWidth:l,screenHeight:o,shouldShowDesktopNav:h})},r=()=>{setTimeout(s,100)};return window.addEventListener("resize",s),window.addEventListener("orientationchange",r),()=>{window.removeEventListener("resize",s),window.removeEventListener("orientationchange",r)}},[]),t},PO=()=>{const[t,a]=p.useState(!1),[s,r]=p.useState(!1),[l,o]=p.useState(null);return p.useEffect(()=>{const u=window.matchMedia("(display-mode: standalone)").matches,m=window.navigator.standalone===!0;a(u||m);const h=g=>{g.preventDefault(),o(g),r(!0)};return window.addEventListener("beforeinstallprompt",h),()=>{window.removeEventListener("beforeinstallprompt",h)}},[]),{isInstalled:t,canInstall:s,promptInstall:async()=>{if(!l)return!1;l.prompt();const{outcome:u}=await l.userChoice;return u==="accepted"?(r(!1),o(null),!0):!1}}};var BO=Symbol.for("react.lazy"),Ph=lM[" use ".trim().toString()];function $O(t){return typeof t=="object"&&t!==null&&"then"in t}function H1(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===BO&&"_payload"in t&&$O(t._payload)}function Tf(t){const a=UO(t),s=p.forwardRef((r,l)=>{let{children:o,...d}=r;H1(o)&&typeof Ph=="function"&&(o=Ph(o._payload));const u=p.Children.toArray(o),m=u.find(YO);if(m){const h=m.props.children,g=u.map(x=>x===m?p.Children.count(h)>1?p.Children.only(null):p.isValidElement(h)?h.props.children:null:x);return e.jsx(a,{...d,ref:l,children:p.isValidElement(h)?p.cloneElement(h,void 0,g):null})}return e.jsx(a,{...d,ref:l,children:o})});return s.displayName=`${t}.Slot`,s}var HO=Tf("Slot");function UO(t){const a=p.forwardRef((s,r)=>{let{children:l,...o}=s;if(H1(l)&&typeof Ph=="function"&&(l=Ph(l._payload)),p.isValidElement(l)){const d=FO(l),u=qO(o,l.props);return l.type!==p.Fragment&&(u.ref=r?W0(r,d):d),p.cloneElement(l,u)}return p.Children.count(l)>1?p.Children.only(null):null});return a.displayName=`${t}.SlotClone`,a}var VO=Symbol("radix.slottable");function YO(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===VO}function qO(t,a){const s={...a};for(const r in a){const l=t[r],o=a[r];/^on[A-Z]/.test(r)?l&&o?s[r]=(...u)=>{const m=o(...u);return l(...u),m}:l&&(s[r]=l):r==="style"?s[r]={...l,...o}:r==="className"&&(s[r]=[l,o].filter(Boolean).join(" "))}return{...t,...s}}function FO(t){let a=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=a&&"isReactWarning"in a&&a.isReactWarning;return s?t.ref:(a=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=a&&"isReactWarning"in a&&a.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}const GO=(t,a)=>{const s=new Array(t.length+a.length);for(let r=0;r<t.length;r++)s[r]=t[r];for(let r=0;r<a.length;r++)s[t.length+r]=a[r];return s},WO=(t,a)=>({classGroupId:t,validator:a}),U1=(t=new Map,a=null,s)=>({nextPart:t,validators:a,classGroupId:s}),Bh="-",vw=[],KO="arbitrary..",XO=t=>{const a=ZO(t),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:d=>{if(d.startsWith("[")&&d.endsWith("]"))return QO(d);const u=d.split(Bh),m=u[0]===""&&u.length>1?1:0;return V1(u,m,a)},getConflictingClassGroupIds:(d,u)=>{if(u){const m=r[d],h=s[d];return m?h?GO(h,m):m:h||vw}return s[d]||vw}}},V1=(t,a,s)=>{if(t.length-a===0)return s.classGroupId;const l=t[a],o=s.nextPart.get(l);if(o){const h=V1(t,a+1,o);if(h)return h}const d=s.validators;if(d===null)return;const u=a===0?t.join(Bh):t.slice(a).join(Bh),m=d.length;for(let h=0;h<m;h++){const g=d[h];if(g.validator(u))return g.classGroupId}},QO=t=>t.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const a=t.slice(1,-1),s=a.indexOf(":"),r=a.slice(0,s);return r?KO+r:void 0})(),ZO=t=>{const{theme:a,classGroups:s}=t;return JO(s,a)},JO=(t,a)=>{const s=U1();for(const r in t){const l=t[r];xy(l,s,r,a)}return s},xy=(t,a,s,r)=>{const l=t.length;for(let o=0;o<l;o++){const d=t[o];eR(d,a,s,r)}},eR=(t,a,s,r)=>{if(typeof t=="string"){tR(t,a,s);return}if(typeof t=="function"){aR(t,a,s,r);return}sR(t,a,s,r)},tR=(t,a,s)=>{const r=t===""?a:Y1(a,t);r.classGroupId=s},aR=(t,a,s,r)=>{if(nR(t)){xy(t(r),a,s,r);return}a.validators===null&&(a.validators=[]),a.validators.push(WO(s,t))},sR=(t,a,s,r)=>{const l=Object.entries(t),o=l.length;for(let d=0;d<o;d++){const[u,m]=l[d];xy(m,Y1(a,u),s,r)}},Y1=(t,a)=>{let s=t;const r=a.split(Bh),l=r.length;for(let o=0;o<l;o++){const d=r[o];let u=s.nextPart.get(d);u||(u=U1(),s.nextPart.set(d,u)),s=u}return s},nR=t=>"isThemeGetter"in t&&t.isThemeGetter===!0,rR=t=>{if(t<1)return{get:()=>{},set:()=>{}};let a=0,s=Object.create(null),r=Object.create(null);const l=(o,d)=>{s[o]=d,a++,a>t&&(a=0,r=s,s=Object.create(null))};return{get(o){let d=s[o];if(d!==void 0)return d;if((d=r[o])!==void 0)return l(o,d),d},set(o,d){o in s?s[o]=d:l(o,d)}}},h0="!",bw=":",iR=[],jw=(t,a,s,r,l)=>({modifiers:t,hasImportantModifier:a,baseClassName:s,maybePostfixModifierPosition:r,isExternal:l}),lR=t=>{const{prefix:a,experimentalParseClassName:s}=t;let r=l=>{const o=[];let d=0,u=0,m=0,h;const g=l.length;for(let N=0;N<g;N++){const S=l[N];if(d===0&&u===0){if(S===bw){o.push(l.slice(m,N)),m=N+1;continue}if(S==="/"){h=N;continue}}S==="["?d++:S==="]"?d--:S==="("?u++:S===")"&&u--}const x=o.length===0?l:l.slice(m);let y=x,v=!1;x.endsWith(h0)?(y=x.slice(0,-1),v=!0):x.startsWith(h0)&&(y=x.slice(1),v=!0);const b=h&&h>m?h-m:void 0;return jw(o,v,y,b)};if(a){const l=a+bw,o=r;r=d=>d.startsWith(l)?o(d.slice(l.length)):jw(iR,!1,d,void 0,!0)}if(s){const l=r;r=o=>s({className:o,parseClassName:l})}return r},oR=t=>{const a=new Map;return t.orderSensitiveModifiers.forEach((s,r)=>{a.set(s,1e6+r)}),s=>{const r=[];let l=[];for(let o=0;o<s.length;o++){const d=s[o],u=d[0]==="[",m=a.has(d);u||m?(l.length>0&&(l.sort(),r.push(...l),l=[]),r.push(d)):l.push(d)}return l.length>0&&(l.sort(),r.push(...l)),r}},cR=t=>({cache:rR(t.cacheSize),parseClassName:lR(t),sortModifiers:oR(t),...XO(t)}),dR=/\s+/,uR=(t,a)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:l,sortModifiers:o}=a,d=[],u=t.trim().split(dR);let m="";for(let h=u.length-1;h>=0;h-=1){const g=u[h],{isExternal:x,modifiers:y,hasImportantModifier:v,baseClassName:b,maybePostfixModifierPosition:N}=s(g);if(x){m=g+(m.length>0?" "+m:m);continue}let S=!!N,w=r(S?b.substring(0,N):b);if(!w){if(!S){m=g+(m.length>0?" "+m:m);continue}if(w=r(b),!w){m=g+(m.length>0?" "+m:m);continue}S=!1}const E=y.length===0?"":y.length===1?y[0]:o(y).join(":"),T=v?E+h0:E,D=T+w;if(d.indexOf(D)>-1)continue;d.push(D);const k=l(w,S);for(let _=0;_<k.length;++_){const R=k[_];d.push(T+R)}m=g+(m.length>0?" "+m:m)}return m},mR=(...t)=>{let a=0,s,r,l="";for(;a<t.length;)(s=t[a++])&&(r=q1(s))&&(l&&(l+=" "),l+=r);return l},q1=t=>{if(typeof t=="string")return t;let a,s="";for(let r=0;r<t.length;r++)t[r]&&(a=q1(t[r]))&&(s&&(s+=" "),s+=a);return s},hR=(t,...a)=>{let s,r,l,o;const d=m=>{const h=a.reduce((g,x)=>x(g),t());return s=cR(h),r=s.cache.get,l=s.cache.set,o=u,u(m)},u=m=>{const h=r(m);if(h)return h;const g=uR(m,s);return l(m,g),g};return o=d,(...m)=>o(mR(...m))},fR=[],rs=t=>{const a=s=>s[t]||fR;return a.isThemeGetter=!0,a},F1=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,G1=/^\((?:(\w[\w-]*):)?(.+)\)$/i,pR=/^\d+\/\d+$/,xR=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,gR=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,yR=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,vR=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,bR=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Jo=t=>pR.test(t),_t=t=>!!t&&!Number.isNaN(Number(t)),Xi=t=>!!t&&Number.isInteger(Number(t)),xg=t=>t.endsWith("%")&&_t(t.slice(0,-1)),ai=t=>xR.test(t),jR=()=>!0,NR=t=>gR.test(t)&&!yR.test(t),W1=()=>!1,wR=t=>vR.test(t),SR=t=>bR.test(t),CR=t=>!We(t)&&!Ke(t),ER=t=>Oc(t,Q1,W1),We=t=>F1.test(t),Ul=t=>Oc(t,Z1,NR),gg=t=>Oc(t,_R,_t),Nw=t=>Oc(t,K1,W1),TR=t=>Oc(t,X1,SR),sh=t=>Oc(t,J1,wR),Ke=t=>G1.test(t),Od=t=>Rc(t,Z1),DR=t=>Rc(t,MR),ww=t=>Rc(t,K1),kR=t=>Rc(t,Q1),AR=t=>Rc(t,X1),nh=t=>Rc(t,J1,!0),Oc=(t,a,s)=>{const r=F1.exec(t);return r?r[1]?a(r[1]):s(r[2]):!1},Rc=(t,a,s=!1)=>{const r=G1.exec(t);return r?r[1]?a(r[1]):s:!1},K1=t=>t==="position"||t==="percentage",X1=t=>t==="image"||t==="url",Q1=t=>t==="length"||t==="size"||t==="bg-size",Z1=t=>t==="length",_R=t=>t==="number",MR=t=>t==="family-name",J1=t=>t==="shadow",OR=()=>{const t=rs("color"),a=rs("font"),s=rs("text"),r=rs("font-weight"),l=rs("tracking"),o=rs("leading"),d=rs("breakpoint"),u=rs("container"),m=rs("spacing"),h=rs("radius"),g=rs("shadow"),x=rs("inset-shadow"),y=rs("text-shadow"),v=rs("drop-shadow"),b=rs("blur"),N=rs("perspective"),S=rs("aspect"),w=rs("ease"),E=rs("animate"),T=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[...D(),Ke,We],_=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto","contain","none"],L=()=>[Ke,We,m],U=()=>[Jo,"full","auto",...L()],V=()=>[Xi,"none","subgrid",Ke,We],F=()=>["auto",{span:["full",Xi,Ke,We]},Xi,Ke,We],G=()=>[Xi,"auto",Ke,We],$=()=>["auto","min","max","fr",Ke,We],z=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],H=()=>["start","end","center","stretch","center-safe","end-safe"],I=()=>["auto",...L()],O=()=>[Jo,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...L()],Y=()=>[t,Ke,We],le=()=>[...D(),ww,Nw,{position:[Ke,We]}],re=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Q=()=>["auto","cover","contain",kR,ER,{size:[Ke,We]}],q=()=>[xg,Od,Ul],M=()=>["","none","full",h,Ke,We],W=()=>["",_t,Od,Ul],ie=()=>["solid","dashed","dotted","double"],ve=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>[_t,xg,ww,Nw],oe=()=>["","none",b,Ke,We],_e=()=>["none",_t,Ke,We],je=()=>["none",_t,Ke,We],Ie=()=>[_t,Ke,We],ge=()=>[Jo,"full",...L()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ai],breakpoint:[ai],color:[jR],container:[ai],"drop-shadow":[ai],ease:["in","out","in-out"],font:[CR],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ai],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ai],shadow:[ai],spacing:["px",_t],text:[ai],"text-shadow":[ai],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Jo,We,Ke,S]}],container:["container"],columns:[{columns:[_t,We,Ke,u]}],"break-after":[{"break-after":T()}],"break-before":[{"break-before":T()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:_()}],"overflow-x":[{"overflow-x":_()}],"overflow-y":[{"overflow-y":_()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:U()}],"inset-x":[{"inset-x":U()}],"inset-y":[{"inset-y":U()}],start:[{start:U()}],end:[{end:U()}],top:[{top:U()}],right:[{right:U()}],bottom:[{bottom:U()}],left:[{left:U()}],visibility:["visible","invisible","collapse"],z:[{z:[Xi,"auto",Ke,We]}],basis:[{basis:[Jo,"full","auto",u,...L()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[_t,Jo,"auto","initial","none",We]}],grow:[{grow:["",_t,Ke,We]}],shrink:[{shrink:["",_t,Ke,We]}],order:[{order:[Xi,"first","last","none",Ke,We]}],"grid-cols":[{"grid-cols":V()}],"col-start-end":[{col:F()}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":V()}],"row-start-end":[{row:F()}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":$()}],"auto-rows":[{"auto-rows":$()}],gap:[{gap:L()}],"gap-x":[{"gap-x":L()}],"gap-y":[{"gap-y":L()}],"justify-content":[{justify:[...z(),"normal"]}],"justify-items":[{"justify-items":[...H(),"normal"]}],"justify-self":[{"justify-self":["auto",...H()]}],"align-content":[{content:["normal",...z()]}],"align-items":[{items:[...H(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...H(),{baseline:["","last"]}]}],"place-content":[{"place-content":z()}],"place-items":[{"place-items":[...H(),"baseline"]}],"place-self":[{"place-self":["auto",...H()]}],p:[{p:L()}],px:[{px:L()}],py:[{py:L()}],ps:[{ps:L()}],pe:[{pe:L()}],pt:[{pt:L()}],pr:[{pr:L()}],pb:[{pb:L()}],pl:[{pl:L()}],m:[{m:I()}],mx:[{mx:I()}],my:[{my:I()}],ms:[{ms:I()}],me:[{me:I()}],mt:[{mt:I()}],mr:[{mr:I()}],mb:[{mb:I()}],ml:[{ml:I()}],"space-x":[{"space-x":L()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":L()}],"space-y-reverse":["space-y-reverse"],size:[{size:O()}],w:[{w:[u,"screen",...O()]}],"min-w":[{"min-w":[u,"screen","none",...O()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[d]},...O()]}],h:[{h:["screen","lh",...O()]}],"min-h":[{"min-h":["screen","lh","none",...O()]}],"max-h":[{"max-h":["screen","lh",...O()]}],"font-size":[{text:["base",s,Od,Ul]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Ke,gg]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",xg,We]}],"font-family":[{font:[DR,We,a]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[l,Ke,We]}],"line-clamp":[{"line-clamp":[_t,"none",Ke,gg]}],leading:[{leading:[o,...L()]}],"list-image":[{"list-image":["none",Ke,We]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ke,We]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Y()}],"text-color":[{text:Y()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ie(),"wavy"]}],"text-decoration-thickness":[{decoration:[_t,"from-font","auto",Ke,Ul]}],"text-decoration-color":[{decoration:Y()}],"underline-offset":[{"underline-offset":[_t,"auto",Ke,We]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ke,We]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ke,We]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:le()}],"bg-repeat":[{bg:re()}],"bg-size":[{bg:Q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Xi,Ke,We],radial:["",Ke,We],conic:[Xi,Ke,We]},AR,TR]}],"bg-color":[{bg:Y()}],"gradient-from-pos":[{from:q()}],"gradient-via-pos":[{via:q()}],"gradient-to-pos":[{to:q()}],"gradient-from":[{from:Y()}],"gradient-via":[{via:Y()}],"gradient-to":[{to:Y()}],rounded:[{rounded:M()}],"rounded-s":[{"rounded-s":M()}],"rounded-e":[{"rounded-e":M()}],"rounded-t":[{"rounded-t":M()}],"rounded-r":[{"rounded-r":M()}],"rounded-b":[{"rounded-b":M()}],"rounded-l":[{"rounded-l":M()}],"rounded-ss":[{"rounded-ss":M()}],"rounded-se":[{"rounded-se":M()}],"rounded-ee":[{"rounded-ee":M()}],"rounded-es":[{"rounded-es":M()}],"rounded-tl":[{"rounded-tl":M()}],"rounded-tr":[{"rounded-tr":M()}],"rounded-br":[{"rounded-br":M()}],"rounded-bl":[{"rounded-bl":M()}],"border-w":[{border:W()}],"border-w-x":[{"border-x":W()}],"border-w-y":[{"border-y":W()}],"border-w-s":[{"border-s":W()}],"border-w-e":[{"border-e":W()}],"border-w-t":[{"border-t":W()}],"border-w-r":[{"border-r":W()}],"border-w-b":[{"border-b":W()}],"border-w-l":[{"border-l":W()}],"divide-x":[{"divide-x":W()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":W()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ie(),"hidden","none"]}],"divide-style":[{divide:[...ie(),"hidden","none"]}],"border-color":[{border:Y()}],"border-color-x":[{"border-x":Y()}],"border-color-y":[{"border-y":Y()}],"border-color-s":[{"border-s":Y()}],"border-color-e":[{"border-e":Y()}],"border-color-t":[{"border-t":Y()}],"border-color-r":[{"border-r":Y()}],"border-color-b":[{"border-b":Y()}],"border-color-l":[{"border-l":Y()}],"divide-color":[{divide:Y()}],"outline-style":[{outline:[...ie(),"none","hidden"]}],"outline-offset":[{"outline-offset":[_t,Ke,We]}],"outline-w":[{outline:["",_t,Od,Ul]}],"outline-color":[{outline:Y()}],shadow:[{shadow:["","none",g,nh,sh]}],"shadow-color":[{shadow:Y()}],"inset-shadow":[{"inset-shadow":["none",x,nh,sh]}],"inset-shadow-color":[{"inset-shadow":Y()}],"ring-w":[{ring:W()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Y()}],"ring-offset-w":[{"ring-offset":[_t,Ul]}],"ring-offset-color":[{"ring-offset":Y()}],"inset-ring-w":[{"inset-ring":W()}],"inset-ring-color":[{"inset-ring":Y()}],"text-shadow":[{"text-shadow":["none",y,nh,sh]}],"text-shadow-color":[{"text-shadow":Y()}],opacity:[{opacity:[_t,Ke,We]}],"mix-blend":[{"mix-blend":[...ve(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ve()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[_t]}],"mask-image-linear-from-pos":[{"mask-linear-from":K()}],"mask-image-linear-to-pos":[{"mask-linear-to":K()}],"mask-image-linear-from-color":[{"mask-linear-from":Y()}],"mask-image-linear-to-color":[{"mask-linear-to":Y()}],"mask-image-t-from-pos":[{"mask-t-from":K()}],"mask-image-t-to-pos":[{"mask-t-to":K()}],"mask-image-t-from-color":[{"mask-t-from":Y()}],"mask-image-t-to-color":[{"mask-t-to":Y()}],"mask-image-r-from-pos":[{"mask-r-from":K()}],"mask-image-r-to-pos":[{"mask-r-to":K()}],"mask-image-r-from-color":[{"mask-r-from":Y()}],"mask-image-r-to-color":[{"mask-r-to":Y()}],"mask-image-b-from-pos":[{"mask-b-from":K()}],"mask-image-b-to-pos":[{"mask-b-to":K()}],"mask-image-b-from-color":[{"mask-b-from":Y()}],"mask-image-b-to-color":[{"mask-b-to":Y()}],"mask-image-l-from-pos":[{"mask-l-from":K()}],"mask-image-l-to-pos":[{"mask-l-to":K()}],"mask-image-l-from-color":[{"mask-l-from":Y()}],"mask-image-l-to-color":[{"mask-l-to":Y()}],"mask-image-x-from-pos":[{"mask-x-from":K()}],"mask-image-x-to-pos":[{"mask-x-to":K()}],"mask-image-x-from-color":[{"mask-x-from":Y()}],"mask-image-x-to-color":[{"mask-x-to":Y()}],"mask-image-y-from-pos":[{"mask-y-from":K()}],"mask-image-y-to-pos":[{"mask-y-to":K()}],"mask-image-y-from-color":[{"mask-y-from":Y()}],"mask-image-y-to-color":[{"mask-y-to":Y()}],"mask-image-radial":[{"mask-radial":[Ke,We]}],"mask-image-radial-from-pos":[{"mask-radial-from":K()}],"mask-image-radial-to-pos":[{"mask-radial-to":K()}],"mask-image-radial-from-color":[{"mask-radial-from":Y()}],"mask-image-radial-to-color":[{"mask-radial-to":Y()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":D()}],"mask-image-conic-pos":[{"mask-conic":[_t]}],"mask-image-conic-from-pos":[{"mask-conic-from":K()}],"mask-image-conic-to-pos":[{"mask-conic-to":K()}],"mask-image-conic-from-color":[{"mask-conic-from":Y()}],"mask-image-conic-to-color":[{"mask-conic-to":Y()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:le()}],"mask-repeat":[{mask:re()}],"mask-size":[{mask:Q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ke,We]}],filter:[{filter:["","none",Ke,We]}],blur:[{blur:oe()}],brightness:[{brightness:[_t,Ke,We]}],contrast:[{contrast:[_t,Ke,We]}],"drop-shadow":[{"drop-shadow":["","none",v,nh,sh]}],"drop-shadow-color":[{"drop-shadow":Y()}],grayscale:[{grayscale:["",_t,Ke,We]}],"hue-rotate":[{"hue-rotate":[_t,Ke,We]}],invert:[{invert:["",_t,Ke,We]}],saturate:[{saturate:[_t,Ke,We]}],sepia:[{sepia:["",_t,Ke,We]}],"backdrop-filter":[{"backdrop-filter":["","none",Ke,We]}],"backdrop-blur":[{"backdrop-blur":oe()}],"backdrop-brightness":[{"backdrop-brightness":[_t,Ke,We]}],"backdrop-contrast":[{"backdrop-contrast":[_t,Ke,We]}],"backdrop-grayscale":[{"backdrop-grayscale":["",_t,Ke,We]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[_t,Ke,We]}],"backdrop-invert":[{"backdrop-invert":["",_t,Ke,We]}],"backdrop-opacity":[{"backdrop-opacity":[_t,Ke,We]}],"backdrop-saturate":[{"backdrop-saturate":[_t,Ke,We]}],"backdrop-sepia":[{"backdrop-sepia":["",_t,Ke,We]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":L()}],"border-spacing-x":[{"border-spacing-x":L()}],"border-spacing-y":[{"border-spacing-y":L()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ke,We]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[_t,"initial",Ke,We]}],ease:[{ease:["linear","initial",w,Ke,We]}],delay:[{delay:[_t,Ke,We]}],animate:[{animate:["none",E,Ke,We]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[N,Ke,We]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:_e()}],"rotate-x":[{"rotate-x":_e()}],"rotate-y":[{"rotate-y":_e()}],"rotate-z":[{"rotate-z":_e()}],scale:[{scale:je()}],"scale-x":[{"scale-x":je()}],"scale-y":[{"scale-y":je()}],"scale-z":[{"scale-z":je()}],"scale-3d":["scale-3d"],skew:[{skew:Ie()}],"skew-x":[{"skew-x":Ie()}],"skew-y":[{"skew-y":Ie()}],transform:[{transform:[Ke,We,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ge()}],"translate-x":[{"translate-x":ge()}],"translate-y":[{"translate-y":ge()}],"translate-z":[{"translate-z":ge()}],"translate-none":["translate-none"],accent:[{accent:Y()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Y()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ke,We]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ke,We]}],fill:[{fill:["none",...Y()]}],"stroke-w":[{stroke:[_t,Od,Ul,gg]}],stroke:[{stroke:["none",...Y()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},RR=hR(OR);function he(...t){return RR(CM(t))}const gy=Dc("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 touch-manipulation active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-md",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"gradient-bg-primary text-white shadow-lg border-0 hover:opacity-90",glass:"glass-card text-gray-700 hover:bg-white/30 backdrop-blur-sm border border-white/20"},size:{default:"h-10 md:h-11 px-4 py-2",sm:"h-8 md:h-9 rounded-md px-3 text-xs md:text-sm",lg:"h-12 md:h-13 rounded-md px-8 text-sm md:text-base",icon:"h-10 w-10 md:h-11 md:w-11",touch:"h-11 md:h-12 px-6 py-3 text-base md:text-lg min-w-[44px]"}},defaultVariants:{variant:"default",size:"default"}}),P=p.forwardRef(({className:t,variant:a,size:s,asChild:r=!1,...l},o)=>{const d=r?HO:"button";return e.jsx(d,{className:he(gy({variant:a,size:s,className:t})),ref:o,...l})});P.displayName="Button";var IR=Symbol("radix.slottable");function zR(t){const a=({children:s})=>e.jsx(e.Fragment,{children:s});return a.displayName=`${t}.Slottable`,a.__radixId=IR,a}var eE=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),LR="VisuallyHidden",tE=p.forwardRef((t,a)=>e.jsx(Gt.span,{...t,ref:a,style:{...eE,...t.style}}));tE.displayName=LR;var PR=tE,[Df,T7]=vi("Tooltip",[Nc]),kf=Nc(),aE="TooltipProvider",BR=700,f0="tooltip.open",[$R,yy]=Df(aE),sE=t=>{const{__scopeTooltip:a,delayDuration:s=BR,skipDelayDuration:r=300,disableHoverableContent:l=!1,children:o}=t,d=p.useRef(!0),u=p.useRef(!1),m=p.useRef(0);return p.useEffect(()=>{const h=m.current;return()=>window.clearTimeout(h)},[]),e.jsx($R,{scope:a,isOpenDelayedRef:d,delayDuration:s,onOpen:p.useCallback(()=>{window.clearTimeout(m.current),d.current=!1},[]),onClose:p.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>d.current=!0,r)},[r]),isPointerInTransitRef:u,onPointerInTransitChange:p.useCallback(h=>{u.current=h},[]),disableHoverableContent:l,children:o})};sE.displayName=aE;var pu="Tooltip",[HR,Af]=Df(pu),nE=t=>{const{__scopeTooltip:a,children:s,open:r,defaultOpen:l,onOpenChange:o,disableHoverableContent:d,delayDuration:u}=t,m=yy(pu,t.__scopeTooltip),h=kf(a),[g,x]=p.useState(null),y=wc(),v=p.useRef(0),b=d??m.disableHoverableContent,N=u??m.delayDuration,S=p.useRef(!1),[w,E]=Mr({prop:r,defaultProp:l??!1,onChange:R=>{R?(m.onOpen(),document.dispatchEvent(new CustomEvent(f0))):m.onClose(),o?.(R)},caller:pu}),T=p.useMemo(()=>w?S.current?"delayed-open":"instant-open":"closed",[w]),D=p.useCallback(()=>{window.clearTimeout(v.current),v.current=0,S.current=!1,E(!0)},[E]),k=p.useCallback(()=>{window.clearTimeout(v.current),v.current=0,E(!1)},[E]),_=p.useCallback(()=>{window.clearTimeout(v.current),v.current=window.setTimeout(()=>{S.current=!0,E(!0),v.current=0},N)},[N,E]);return p.useEffect(()=>()=>{v.current&&(window.clearTimeout(v.current),v.current=0)},[]),e.jsx(Q0,{...h,children:e.jsx(HR,{scope:a,contentId:y,open:w,stateAttribute:T,trigger:g,onTriggerChange:x,onTriggerEnter:p.useCallback(()=>{m.isOpenDelayedRef.current?_():D()},[m.isOpenDelayedRef,_,D]),onTriggerLeave:p.useCallback(()=>{b?k():(window.clearTimeout(v.current),v.current=0)},[k,b]),onOpen:D,onClose:k,disableHoverableContent:b,children:s})})};nE.displayName=pu;var p0="TooltipTrigger",rE=p.forwardRef((t,a)=>{const{__scopeTooltip:s,...r}=t,l=Af(p0,s),o=yy(p0,s),d=kf(s),u=p.useRef(null),m=Sa(a,u,l.onTriggerChange),h=p.useRef(!1),g=p.useRef(!1),x=p.useCallback(()=>h.current=!1,[]);return p.useEffect(()=>()=>document.removeEventListener("pointerup",x),[x]),e.jsx(hf,{asChild:!0,...d,children:e.jsx(Gt.button,{"aria-describedby":l.open?l.contentId:void 0,"data-state":l.stateAttribute,...r,ref:m,onPointerMove:Nt(t.onPointerMove,y=>{y.pointerType!=="touch"&&!g.current&&!o.isPointerInTransitRef.current&&(l.onTriggerEnter(),g.current=!0)}),onPointerLeave:Nt(t.onPointerLeave,()=>{l.onTriggerLeave(),g.current=!1}),onPointerDown:Nt(t.onPointerDown,()=>{l.open&&l.onClose(),h.current=!0,document.addEventListener("pointerup",x,{once:!0})}),onFocus:Nt(t.onFocus,()=>{h.current||l.onOpen()}),onBlur:Nt(t.onBlur,l.onClose),onClick:Nt(t.onClick,l.onClose)})})});rE.displayName=p0;var UR="TooltipPortal",[D7,VR]=Df(UR,{forceMount:void 0}),gc="TooltipContent",iE=p.forwardRef((t,a)=>{const s=VR(gc,t.__scopeTooltip),{forceMount:r=s.forceMount,side:l="top",...o}=t,d=Af(gc,t.__scopeTooltip);return e.jsx(bi,{present:r||d.open,children:d.disableHoverableContent?e.jsx(lE,{side:l,...o,ref:a}):e.jsx(YR,{side:l,...o,ref:a})})}),YR=p.forwardRef((t,a)=>{const s=Af(gc,t.__scopeTooltip),r=yy(gc,t.__scopeTooltip),l=p.useRef(null),o=Sa(a,l),[d,u]=p.useState(null),{trigger:m,onClose:h}=s,g=l.current,{onPointerInTransitChange:x}=r,y=p.useCallback(()=>{u(null),x(!1)},[x]),v=p.useCallback((b,N)=>{const S=b.currentTarget,w={x:b.clientX,y:b.clientY},E=KR(w,S.getBoundingClientRect()),T=XR(w,E),D=QR(N.getBoundingClientRect()),k=JR([...T,...D]);u(k),x(!0)},[x]);return p.useEffect(()=>()=>y(),[y]),p.useEffect(()=>{if(m&&g){const b=S=>v(S,g),N=S=>v(S,m);return m.addEventListener("pointerleave",b),g.addEventListener("pointerleave",N),()=>{m.removeEventListener("pointerleave",b),g.removeEventListener("pointerleave",N)}}},[m,g,v,y]),p.useEffect(()=>{if(d){const b=N=>{const S=N.target,w={x:N.clientX,y:N.clientY},E=m?.contains(S)||g?.contains(S),T=!ZR(w,d);E?y():T&&(y(),h())};return document.addEventListener("pointermove",b),()=>document.removeEventListener("pointermove",b)}},[m,g,d,h,y]),e.jsx(lE,{...t,ref:o})}),[qR,FR]=Df(pu,{isInside:!1}),GR=zR("TooltipContent"),lE=p.forwardRef((t,a)=>{const{__scopeTooltip:s,children:r,"aria-label":l,onEscapeKeyDown:o,onPointerDownOutside:d,...u}=t,m=Af(gc,s),h=kf(s),{onClose:g}=m;return p.useEffect(()=>(document.addEventListener(f0,g),()=>document.removeEventListener(f0,g)),[g]),p.useEffect(()=>{if(m.trigger){const x=y=>{y.target?.contains(m.trigger)&&g()};return window.addEventListener("scroll",x,{capture:!0}),()=>window.removeEventListener("scroll",x,{capture:!0})}},[m.trigger,g]),e.jsx(K0,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:x=>x.preventDefault(),onDismiss:g,children:e.jsxs(X0,{"data-state":m.stateAttribute,...h,...u,ref:a,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(GR,{children:r}),e.jsx(qR,{scope:s,isInside:!0,children:e.jsx(PR,{id:m.contentId,role:"tooltip",children:l||r})})]})})});iE.displayName=gc;var oE="TooltipArrow",WR=p.forwardRef((t,a)=>{const{__scopeTooltip:s,...r}=t,l=kf(s);return FR(oE,s).isInside?null:e.jsx(Z0,{...l,...r,ref:a})});WR.displayName=oE;function KR(t,a){const s=Math.abs(a.top-t.y),r=Math.abs(a.bottom-t.y),l=Math.abs(a.right-t.x),o=Math.abs(a.left-t.x);switch(Math.min(s,r,l,o)){case o:return"left";case l:return"right";case s:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function XR(t,a,s=5){const r=[];switch(a){case"top":r.push({x:t.x-s,y:t.y+s},{x:t.x+s,y:t.y+s});break;case"bottom":r.push({x:t.x-s,y:t.y-s},{x:t.x+s,y:t.y-s});break;case"left":r.push({x:t.x+s,y:t.y-s},{x:t.x+s,y:t.y+s});break;case"right":r.push({x:t.x-s,y:t.y-s},{x:t.x-s,y:t.y+s});break}return r}function QR(t){const{top:a,right:s,bottom:r,left:l}=t;return[{x:l,y:a},{x:s,y:a},{x:s,y:r},{x:l,y:r}]}function ZR(t,a){const{x:s,y:r}=t;let l=!1;for(let o=0,d=a.length-1;o<a.length;d=o++){const u=a[o],m=a[d],h=u.x,g=u.y,x=m.x,y=m.y;g>r!=y>r&&s<(x-h)*(r-g)/(y-g)+h&&(l=!l)}return l}function JR(t){const a=t.slice();return a.sort((s,r)=>s.x<r.x?-1:s.x>r.x?1:s.y<r.y?-1:s.y>r.y?1:0),e3(a)}function e3(t){if(t.length<=1)return t.slice();const a=[];for(let r=0;r<t.length;r++){const l=t[r];for(;a.length>=2;){const o=a[a.length-1],d=a[a.length-2];if((o.x-d.x)*(l.y-d.y)>=(o.y-d.y)*(l.x-d.x))a.pop();else break}a.push(l)}a.pop();const s=[];for(let r=t.length-1;r>=0;r--){const l=t[r];for(;s.length>=2;){const o=s[s.length-1],d=s[s.length-2];if((o.x-d.x)*(l.y-d.y)>=(o.y-d.y)*(l.x-d.x))s.pop();else break}s.push(l)}return s.pop(),a.length===1&&s.length===1&&a[0].x===s[0].x&&a[0].y===s[0].y?a:a.concat(s)}var t3=sE,a3=nE,s3=rE,cE=iE;const Vs=t3,va=a3,ba=s3,fa=p.forwardRef(({className:t,sideOffset:a=4,...s},r)=>e.jsx(cE,{ref:r,sideOffset:a,className:he("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));fa.displayName=cE.displayName;const ae={auth:{login:"/login"},home:"/",settings:"/settings",goals:{base:"/goals",detail:t=>`/goals/${t}`},stats:{home:"/stats"},habit:{base:"/habit",defaultView:"tracker",view:t=>`/habit/view/${t}`,config:"/habit/config",run:t=>`/habit/${t}/run`},task:{base:"/task",defaultView:"list",view:t=>`/task/view/${t}`,config:"/task/config",run:t=>`/task/${t}/run`,legacy:{list:"/task/list",kanban:"/task/kanban",calendar:"/task/calendar",tasksCalendar:"/tasks/calendar",kanbanRoot:"/kanban"}},mood:{base:"/mood",defaultView:"tracker",view:t=>`/mood/view/${t}`,config:"/mood/config"},pomodoro:{base:"/pomodoro",defaultView:"timer",view:t=>`/pomodoro/view/${t}`,config:"/pomodoro/config"},exercise:{base:"/exercise",defaultView:"daily",view:t=>`/exercise/view/${t}`,config:"/exercise/config"},water:{base:"/water",defaultView:"daily",view:t=>`/water/view/${t}`,config:"/water/config"},journal:{base:"/journal",defaultView:"entries",view:t=>`/journal/view/${t}`,config:"/journal/config"},negativeHabits:{base:"/negative",defaultView:"weekly",view:t=>`/negative/view/${t}`,config:"/negative/config"},meal:{base:"/meal",defaultView:"weekly",view:t=>`/meal/view/${t}`,config:"/meal/config"},shoppingList:{base:"/shopping-list",defaultView:"list",view:t=>`/shopping-list/view/${t}`,config:"/shopping-list/config",run:"/shopping/run",legacy:{list:"/shopping-list/list",kanban:"/shopping-list/kanban"}},recipes:{base:"/recipes",defaultView:"list",view:t=>`/recipes/view/${t}`,config:"/recipes/config",detail:t=>`/recipes/${t}`},preparedMeals:{base:"/prepared-meals",defaultView:"list",view:t=>`/prepared-meals/view/${t}`,config:"/prepared-meals/config"},relationships:{base:"/relationships",index:"/relationships",defaultView:"board",view:t=>`/relationships/view/${t}`,detail:t=>`/relationships/${t}`}},x0=[{icon:AM,label:"Inicio",path:ae.home},{icon:no,label:"Hidratacion",path:ae.water.view("daily")},{icon:mc,label:"Ejercicio",path:ae.exercise.view("daily")},{icon:hl,label:"Habitos",path:ae.habit.view("tracker")},{icon:bf,label:"Estado",path:ae.mood.view("tracker")},{icon:ro,label:"Diario",path:ae.journal.view("entries")},{icon:pi,label:"Pomodoro",path:ae.pomodoro.view("timer")},{icon:e1,label:"Comidas",path:ae.meal.view("weekly")},{icon:_M,label:"Tareas",path:ae.task.view("list")},{icon:t1,label:"Kanban",path:ae.task.view("kanban")},{icon:mu,label:"Relaciones",path:ae.relationships.index},{icon:a1,label:"Objetivos",path:ae.goals.base},{icon:s1,label:"Estadisticas",path:ae.stats.home},{icon:Oh,label:"Habitos Negativos",path:ae.negativeHabits.view("weekly")}],n3=({isExpanded:t,navigate:a})=>{const{user:s}=st(),r=u=>u?u.split(" ").map(m=>m.charAt(0)).join("").toUpperCase().slice(0,2):"U",l=t?"w-10 h-10":"w-8 h-8",o=t?"text-sm":"text-xs",d=e.jsxs("div",{className:"flex items-center space-x-3 w-full",children:[e.jsx("div",{className:"relative flex-shrink-0",children:e.jsx("div",{className:`${l} rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold ${o} border-2 border-white/20`,children:r(s?.email)})}),t&&e.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 truncate",children:s?.email?.split("@")[0]||"Usuario"}),e.jsx("span",{className:"text-xs text-gray-500 truncate",children:s?.email})]})]});return t?e.jsx(P,{variant:"ghost",className:"w-full h-auto p-4 hover:bg-white/20 rounded-xl transition-colors duration-150 flex items-center justify-start",onClick:()=>a(ae.settings),children:d}):e.jsx(Vs,{children:e.jsxs(va,{delayDuration:0,children:[e.jsx(ba,{asChild:!0,children:e.jsx(P,{variant:"ghost",className:"w-full h-auto p-1.5 hover:bg-white/20 rounded-xl transition-colors duration-150 flex items-center justify-center",onClick:()=>a(ae.settings),children:d})}),e.jsx(fa,{side:"right",className:"bg-black text-white border-gray-700",children:e.jsx("p",{children:"Perfil y configuracion"})})]})})},r3=()=>{const t=gs(),a=it(),[s,r]=p.useState(()=>localStorage.getItem("desktop-nav-expanded")==="true");p.useEffect(()=>{localStorage.setItem("desktop-nav-expanded",JSON.stringify(s)),document.documentElement.style.setProperty("--desktop-nav-width",s?"256px":"64px")},[s]);const l=({icon:o,label:d,path:u,onClick:m})=>{const h=u.includes("/view/")?u.split("/view/")[0]:u,g=h==="/"?t.pathname==="/":t.pathname.startsWith(h),x=e.jsxs(e.Fragment,{children:[e.jsx(o,{className:`w-5 h-5 flex-shrink-0 ${g?"text-white":"text-gray-600"}`}),s&&e.jsx("span",{className:`ml-3 font-medium truncate ${g?"text-white":"text-gray-700"}`,children:d})]}),y=`
      w-full flex items-center justify-start rounded-xl transition-colors duration-150
      ${s?"px-4 py-3":"p-3"}
      ${g?"gradient-bg-primary text-white shadow-lg":"hover:bg-white/20"}
    `;return s?e.jsx(P,{variant:"ghost",className:y,onClick:()=>m?m():a(u),children:x}):e.jsx(Vs,{children:e.jsxs(va,{delayDuration:0,children:[e.jsx(ba,{asChild:!0,children:e.jsx(P,{variant:"ghost",className:y,onClick:()=>m?m():a(u),children:x})}),e.jsx(fa,{side:"right",className:"bg-black text-white border-gray-700",children:e.jsx("p",{children:d})})]})})};return e.jsxs("aside",{className:`hidden md:flex flex-col h-screen fixed top-0 left-0 transition-all duration-300 glass-card z-50 border-r-0
      ${s?"w-64":"w-16"}`,children:[e.jsx("div",{className:`border-b border-white/20 ${s?"p-4":"p-1.5"}`,children:e.jsx(n3,{isExpanded:s,navigate:a})}),e.jsx("nav",{className:"flex-1 p-3 overflow-y-auto",children:e.jsx("div",{className:"space-y-1",children:x0.map(o=>e.jsx(l,{icon:o.icon,label:o.label,path:o.path},o.path))})}),e.jsx("div",{className:"p-3 border-t border-white/20",children:e.jsx(P,{variant:"ghost",size:"icon",title:"Expand/Collapse Menu",onClick:()=>r(!s),className:"w-full p-2 hover:bg-white/20 rounded-lg",children:e.jsx(wn,{className:`w-4 h-4 transform transition-transform duration-200
            ${s?"rotate-180":""}`})})})]})},i3=pf,l3=xf,o3=ff,dE=p.forwardRef(({className:t,...a},s)=>e.jsx(Sc,{className:he("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));dE.displayName=Sc.displayName;const c3=Dc("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),uE=p.forwardRef(({side:t="right",className:a,children:s,...r},l)=>e.jsxs(o3,{children:[e.jsx(dE,{}),e.jsxs(Cc,{ref:l,className:he(c3({side:t}),a),...r,children:[s,e.jsxs(Nu,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Fa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));uE.displayName=Cc.displayName;const mE=({className:t,...a})=>e.jsx("div",{className:he("flex flex-col space-y-2 text-center sm:text-left",t),...a});mE.displayName="SheetHeader";const hE=p.forwardRef(({className:t,...a},s)=>e.jsx(Ec,{ref:s,className:he("text-lg font-semibold text-foreground",t),...a}));hE.displayName=Ec.displayName;const d3=p.forwardRef(({className:t,...a},s)=>e.jsx(Tc,{ref:s,className:he("text-sm text-muted-foreground",t),...a}));d3.displayName=Tc.displayName;const u3=()=>{const t=gs(),a=it(),{signOut:s}=st(),[r,l]=p.useState(!1),o=async()=>{try{l(!1),await s(),a(ae.auth.login)}catch(g){console.error("Error al cerrar sesin:",g)}},d=x0.slice(0,4),u=x0.slice(4),m=[{icon:ty,label:"Agua +250ml",path:ae.water.view("daily"),action:"quick-water"},{icon:bf,label:"Registrar Animo",path:ae.mood.view("tracker"),action:"quick-mood"},{icon:xi,label:"Marcar Habito",path:ae.habit.view("tracker"),action:"quick-habit"},{icon:Rh,label:"Nueva Tarea",path:ae.task.view("list"),action:"quick-task"},{icon:Ih,label:"Resumen Hoy",path:ae.stats.home,action:"quick-stats"}],h=({icon:g,label:x,path:y,onClick:v})=>{const b=y.includes("/view/")?y.split("/view/")[0]:y,N=b==="/"?t.pathname==="/":t.pathname.startsWith(b);return e.jsxs(P,{variant:"ghost",className:`flex flex-col items-center justify-center h-auto px-2 py-2 text-xs rounded-xl transition-all duration-300 active:scale-95 touch-manipulation
          ${N?"text-blue-600 bg-blue-50 shadow-sm scale-105":"text-gray-600 hover:text-blue-600 hover:bg-blue-50/50 hover:scale-105"}`,onClick:()=>{v?v():a(y),l(!1)},children:[e.jsx(g,{className:`w-5 h-5 sm:w-6 sm:h-6 ${N?"animate-pulse":""}`}),e.jsx("span",{className:"mt-1 font-medium leading-tight",children:x})]})};return e.jsx("div",{className:"md:hidden",children:e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-200 z-30 shadow-lg",children:e.jsxs("nav",{className:"flex justify-around items-center px-1 py-1 max-w-screen-sm mx-auto",children:[d.map(g=>e.jsx(h,{icon:g.icon,label:g.label,path:g.path},g.path)),e.jsxs(i3,{open:r,onOpenChange:l,children:[e.jsx(l3,{asChild:!0,children:e.jsxs(P,{variant:"ghost",className:`flex flex-col items-center justify-center h-auto px-2 py-2 text-xs rounded-xl transition-all duration-300 active:scale-95 touch-manipulation
                  ${r?"text-blue-600 bg-blue-50 scale-105":"text-gray-600 hover:bg-blue-50/50 hover:scale-105"}`,children:[e.jsx(rn,{className:`w-5 h-5 sm:w-6 sm:h-6 transform transition-transform duration-300
                  ${r?"rotate-180":""}`}),e.jsx("span",{className:"mt-1 font-medium leading-tight",children:"Ms"})]})}),e.jsxs(uE,{side:"bottom",className:"rounded-t-2xl bg-white/95 backdrop-blur-md border-t border-gray-200 max-w-screen-sm mx-auto",children:[e.jsx(mE,{className:"mb-4",children:e.jsx(hE,{className:"text-center text-lg font-semibold text-gray-800",children:"Ms opciones"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-3 px-2",children:"Acceso Rpido"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 px-2",children:m.map(g=>e.jsxs(P,{variant:"outline",className:"flex items-center gap-2 h-auto p-3 text-left justify-start bg-gradient-to-r from-blue-50 to-purple-50 hover:from-blue-100 hover:to-purple-100 border-blue-200",onClick:()=>{a(g.path),l(!1)},children:[e.jsx(g.icon,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:g.label})]},g.action))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-3 px-2",children:"Todas las Opciones"}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 p-2",children:u.map(g=>e.jsx(h,{icon:g.icon,label:g.label,path:g.path,onClick:g.path==="/logout"?o:void 0},g.path))})]})]})]})]})})})},m3=()=>{const{shouldShowDesktopNav:t}=ku(),a=!t;return e.jsx(e.Fragment,{children:a?e.jsx(u3,{}):e.jsx(r3,{})})},h3=()=>{const{canInstall:t,promptInstall:a,isInstalled:s}=PO(),[r,l]=p.useState(!1),[o,d]=p.useState(!1);p.useEffect(()=>{if(t&&!s&&!o){const h=setTimeout(()=>{l(!0)},1e4);return()=>clearTimeout(h)}},[t,s,o]);const u=async()=>{await a()&&l(!1)},m=()=>{l(!1),d(!0),sessionStorage.setItem("pwa-install-dismissed","true")};return s||!t||!r||sessionStorage.getItem("pwa-install-dismissed")?null:e.jsx("div",{className:"fixed bottom-20 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-white rounded-lg shadow-lg border border-gray-200 p-4 z-50 animate-in slide-in-from-bottom-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Or,{className:"w-5 h-5 text-blue-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Instalar Life Tracker"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Instala la app para un acceso ms rpido y funciones offline."}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(P,{size:"sm",onClick:u,className:"text-xs px-3 py-1 h-auto",children:"Instalar"}),e.jsx(P,{variant:"ghost",size:"sm",onClick:m,className:"text-xs px-3 py-1 h-auto",children:"Ahora no"})]})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:m,className:"flex-shrink-0 p-1 h-auto w-auto",children:e.jsx(Fa,{className:"w-4 h-4"})})]})})},f3=()=>{const[t,a]=p.useState(navigator.onLine),[s,r]=p.useState(!1),[l,o]=p.useState(!1);p.useEffect(()=>{const u=()=>{a(!0),r(!1)},m=()=>{a(!1),r(!0),setTimeout(()=>r(!1),5e3)},h=()=>{o(!0)};return window.addEventListener("online",u),window.addEventListener("offline",m),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",g=>{g.data&&g.data.type==="SKIP_WAITING"&&h()}),()=>{window.removeEventListener("online",u),window.removeEventListener("offline",m)}},[]);const d=()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(u=>{u&&u.waiting&&(u.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:!t&&e.jsxs("div",{className:"flex items-center gap-1 bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs",children:[e.jsx(t0,{className:"w-3 h-3"}),e.jsx("span",{children:"Offline"})]})}),s&&e.jsxs("div",{className:"fixed top-16 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-orange-50 border border-orange-200 rounded-lg p-3 z-50 animate-in slide-in-from-top-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t0,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"text-orange-800 text-sm font-medium",children:"Sin conexin"})]}),e.jsx("p",{className:"text-orange-700 text-xs mt-1",children:"Sin conexin. La aplicacin est disponible en modo offline."})]}),l&&e.jsxs("div",{className:"fixed top-16 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-blue-50 border border-blue-200 rounded-lg p-3 z-50 animate-in slide-in-from-top-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hc,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-blue-800 text-sm font-medium",children:"Actualizacin disponible"})]}),e.jsx("p",{className:"text-blue-700 text-xs mt-1",children:"Hay una nueva versin disponible."}),e.jsx(P,{size:"sm",onClick:d,className:"mt-2 text-xs px-3 py-1 h-auto",children:"Actualizar"})]})]})},p3=({children:t})=>{const{isMobile:a}=ku(),[s,r]=p.useState(0),[l,o]=p.useState(!1);return p.useEffect(()=>{if(!a)return;let d=0,u=0,m=!0;const h=y=>{d=y.touches[0].clientY,m=window.scrollY===0},g=y=>{if(!m)return;u=y.touches[0].clientY;const v=u-d;v>0&&v<150&&(o(!0),r(v),y.preventDefault())},x=()=>{l&&s>100&&window.location.reload(),o(!1),r(0)};return document.addEventListener("touchstart",h,{passive:!1}),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",x),()=>{document.removeEventListener("touchstart",h),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",x)}},[a,l,s]),a?e.jsxs("div",{className:"relative",children:[l&&e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-blue-500 text-white text-center py-2 text-sm transition-transform duration-200",style:{transform:`translateY(${Math.min(s-50,0)}px)`,opacity:s/100},children:s>100?"Suelta para actualizar!":"Tira hacia abajo para actualizar"}),t]}):e.jsx(e.Fragment,{children:t})},Au=()=>{const[t,a]=p.useState(typeof navigator<"u"?navigator.onLine:!0);return p.useEffect(()=>{const s=()=>a(!0),r=()=>a(!1);return window.addEventListener("online",s),window.addEventListener("offline",r),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}},[]),{isOnline:t}},vy=()=>{const[t,a]=p.useState("default"),[s,r]=p.useState({enabled:!1,sound:!0,vibration:!0}),l=p.useRef(null),o=p.useRef(null),d=p.useCallback(()=>"Notification"in window,[]),u=p.useCallback(async()=>{if(!d())return!1;try{const v=await Notification.requestPermission();return a(v),v==="granted"}catch(v){return console.error("Error requesting notification permission:",v),!1}},[]),m=p.useCallback(async(v,b)=>{if(!(!d()||t!=="granted"))try{if("serviceWorker"in navigator){const S=await navigator.serviceWorker.getRegistration();if(S){await S.showNotification(v,{icon:"/icon-192x192.png",silent:!s.sound,...b});return}}const N=new Notification(v,{icon:"/icon-192x192.png",silent:!s.sound,...b});N.onclick=()=>{window.focus(),N.close()}}catch(N){console.error("Error sending notification:",N)}},[t,s,d]),h=p.useCallback(async(v,b)=>{if(!(!d()||t!=="granted"))try{if("serviceWorker"in navigator){const S=await navigator.serviceWorker.getRegistration();if(S){await S.showNotification(v,{body:b,icon:"/icon-192x192.png",silent:!s.sound,requireInteraction:!0,tag:"pomodoro-active"});return}}l.current?.close();const N=new Notification(v,{body:b,icon:"/icon-192x192.png",silent:!s.sound,requireInteraction:!0,tag:"pomodoro-active"});N.onclick=()=>{window.focus(),N.close()},l.current=N}catch(N){console.error("Error sending persistent notification:",N)}},[t,s,d]),g=p.useCallback((v,b,N=6e4)=>{h(v,b()),o.current!==null&&clearInterval(o.current),o.current=window.setInterval(()=>{h(v,b())},N)},[h]),x=p.useCallback(async()=>{if(o.current&&(clearInterval(o.current),o.current=null),l.current&&(l.current.close(),l.current=null),"serviceWorker"in navigator)try{const v=await navigator.serviceWorker.getRegistration();v&&(await v.getNotifications({tag:"pomodoro-active"})).forEach(N=>N.close())}catch(v){console.error("Error closing persistent notification:",v)}},[]);p.useEffect(()=>{const v=localStorage.getItem("pomodoroNotificationPrefs");if(v)try{r(JSON.parse(v))}catch{console.warn("Invalid pomodoro prefs in storage")}d()&&a(Notification.permission)},[]);const y=p.useCallback(v=>{r(b=>{const N={...b,...v};return localStorage.setItem("pomodoroNotificationPrefs",JSON.stringify(N)),N})},[]);return{supported:d(),permission:t,preferences:s,requestPermission:u,sendNotification:m,updatePreferences:y,startPersistentNotification:g,stopPersistentNotification:x}},Sw=1800,Vl="active-pomodoro-timer",fE=()=>{const[t,a]=p.useState(0),[s,r]=p.useState(!1),l=p.useRef(null),o=p.useRef(!1),d=p.useRef(null),{preferences:u,permission:m,sendNotification:h}=vy(),g=()=>{try{const E=localStorage.getItem(Vl);if(!E)return null;const T=JSON.parse(E);return(Date.now()-T.startTime)/1e3>=T.duration?(localStorage.removeItem(Vl),null):T}catch(E){return console.error("Error reading pomodoro timer from localStorage:",E),localStorage.removeItem(Vl),null}},x=E=>Math.floor((Date.now()-E)/1e3),y=E=>{const T=Math.floor(E/60),D=Math.floor(E%60);return`${T<10?"0":""}${T}:${D<10?"0":""}${D}`},v=()=>{if(u.sound)try{const E=new(window.AudioContext||window.webkitAudioContext),T=E.createOscillator(),D=E.createGain();T.connect(D),D.connect(E.destination),T.frequency.setValueAtTime(880,E.currentTime),T.frequency.setValueAtTime(660,E.currentTime+.1),T.frequency.setValueAtTime(523,E.currentTime+.2),D.gain.setValueAtTime(.3,E.currentTime),D.gain.exponentialRampToValueAtTime(.01,E.currentTime+.8),T.start(E.currentTime),T.stop(E.currentTime+.8),setTimeout(()=>{E.close()},1e3)}catch(E){console.warn("No se pudo reproducir el sonido de finalizacin:",E)}},b=()=>{o.current||(o.current=!0,d.current&&(console.log("Notificando completacin a usePomodoroTimer..."),d.current(Sw)),v(),u.enabled&&m==="granted"&&h("Pomodoro completado! ",{body:"Has completado exitosamente tu sesin de concentracin",requireInteraction:!0}),setTimeout(()=>{localStorage.removeItem(Vl),r(!1),a(0),o.current=!1},500))};p.useEffect(()=>{const E=g();E&&(r(!0),a(x(E.startTime)))},[]),p.useEffect(()=>(s?l.current=window.setInterval(()=>{const E=g();if(E){const T=x(E.startTime);a(T),T>=E.duration&&b()}else r(!1),a(0)},1e3):l.current!==null&&window.clearInterval(l.current),()=>{l.current!==null&&window.clearInterval(l.current)}),[s]);const N=E=>{d.current=E},S=()=>{const E={startTime:Date.now(),duration:Sw,isActive:!0};localStorage.setItem(Vl,JSON.stringify(E)),r(!0),a(0),o.current=!1},w=()=>{localStorage.removeItem(Vl),r(!1),a(0),o.current=!1};return p.useEffect(()=>{const E=T=>{if(T.key===Vl){const D=g();D?(r(!0),a(x(D.startTime))):(r(!1),a(0))}};return window.addEventListener("storage",E),()=>window.removeEventListener("storage",E)},[]),{time:t,isActive:s,formattedTime:y(t),startTimer:S,stopTimer:w,setOnCompletion:N}},x3=()=>{const t=gs(),a=it(),{isOnline:s}=Au(),{isActive:r,formattedTime:l}=fE(),{supported:o,permission:d,preferences:u,requestPermission:m,sendNotification:h,updatePreferences:g}=vy(),x=w=>{const E=[[ae.water.base,"Hidratacion"],[ae.exercise.base,"Ejercicio"],[ae.habit.base,"Habitos"],[ae.mood.base,"Estado de Animo"],[ae.journal.base,"Diario"],[ae.pomodoro.base,"Pomodoro"],[ae.meal.base,"Comidas"],[ae.task.base,"Tareas"],[ae.negativeHabits.base,"Habitos Negativos"],[ae.settings,"Configuracion"]];return w===ae.home?"Inicio":E.find(([D])=>w.startsWith(D))?.[1]||"Life Tracker"},y=r,v=async()=>{o&&(d==="default"?await m()&&(g({enabled:!0}),h(" Notificaciones activadas",{body:"Recibiras notificaciones cuando terminen los Pomodoros",requireInteraction:!1})):d==="granted"&&h(" Prueba de notificacion",{body:"Las notificaciones estan funcionando correctamente",requireInteraction:!1}))},b=()=>{g({sound:!u.sound})},S=o?d==="denied"?{icon:Sh,tooltip:"Notificaciones bloqueadas",color:"text-red-400"}:d==="default"?{icon:zh,tooltip:"Click para activar notificaciones",color:"text-yellow-400"}:u.enabled?{icon:zh,tooltip:"Notificaciones activadas",color:"text-green-400"}:{icon:Sh,tooltip:"Notificaciones desactivadas",color:"text-gray-400"}:{icon:Sh,tooltip:"Notificaciones no soportadas",color:"text-gray-500"};return e.jsxs("footer",{className:"hidden md:flex w-full h-6 bg-[#007ACC] text-white text-xs items-center justify-between px-4 border-t border-[#005a9e] select-none",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("div",{className:"flex items-center space-x-1",children:s?e.jsxs(e.Fragment,{children:[e.jsx(MM,{className:"w-3 h-3"}),e.jsx("span",{children:"En linea"})]}):e.jsxs(e.Fragment,{children:[e.jsx(t0,{className:"w-3 h-3"}),e.jsx("span",{children:"Sin conexion"})]})})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx("span",{className:"font-medium",children:x(t.pathname)})})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[y&&e.jsxs("button",{type:"button",onClick:()=>a(ae.pomodoro.view("timer")),className:"flex items-center space-x-2 bg-[#005a9e] px-2 py-1 rounded hover:bg-[#007ACC] transition-colors",children:[e.jsx(pi,{className:"w-3 h-3"}),e.jsx("span",{className:"font-mono",children:l}),e.jsx("span",{className:"text-xs",children:"Transcurrido"})]}),!y&&e.jsxs("button",{type:"button",onClick:()=>a(ae.pomodoro.view("timer")),className:"flex items-center space-x-1 hover:bg-[#005a9e] px-2 py-1 rounded transition-colors",children:[e.jsx(pi,{className:"w-3 h-3"}),e.jsx("span",{children:"Pomodoro"})]}),o&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{type:"button",onClick:v,className:"flex items-center space-x-1 hover:bg-[#005a9e] px-1 py-0.5 rounded transition-colors group",title:S.tooltip,children:e.jsx(S.icon,{className:`w-3 h-3 ${S.color}`})}),d==="granted"&&e.jsx("button",{type:"button",onClick:b,className:"flex items-center hover:bg-[#005a9e] px-1 py-0.5 rounded transition-colors",title:u.sound?"Sonido activado":"Sonido desactivado",children:u.sound?e.jsx(OM,{className:"w-3 h-3 text-green-400"}):e.jsx(RM,{className:"w-3 h-3 text-gray-400"})})]}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx("span",{className:"text-[#87CEEB]",children:"Life Tracker v1.0"})})]})]})};var g3=(t,a,s,r,l,o,d,u)=>{let m=document.documentElement,h=["light","dark"];function g(v){(Array.isArray(t)?t:[t]).forEach(b=>{let N=b==="class",S=N&&o?l.map(w=>o[w]||w):l;N?(m.classList.remove(...S),m.classList.add(o&&o[v]?o[v]:v)):m.setAttribute(b,v)}),x(v)}function x(v){u&&h.includes(v)&&(m.style.colorScheme=v)}function y(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)g(r);else try{let v=localStorage.getItem(a)||s,b=d&&v==="system"?y():v;g(b)}catch{}},y3=p.createContext(void 0),v3={setTheme:t=>{},themes:[]},b3=()=>{var t;return(t=p.useContext(y3))!=null?t:v3};p.memo(({forcedTheme:t,storageKey:a,attribute:s,enableSystem:r,enableColorScheme:l,defaultTheme:o,value:d,themes:u,nonce:m,scriptProps:h})=>{let g=JSON.stringify([s,a,o,t,u,d,r,l]).slice(1,-1);return p.createElement("script",{...h,suppressHydrationWarning:!0,nonce:typeof window>"u"?m:"",dangerouslySetInnerHTML:{__html:`(${g3.toString()})(${g})`}})});function j3(t){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",a.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}const N3=t=>{switch(t){case"success":return C3;case"info":return T3;case"warning":return E3;case"error":return D3;default:return null}},w3=Array(12).fill(0),S3=({visible:t,className:a})=>te.createElement("div",{className:["sonner-loading-wrapper",a].filter(Boolean).join(" "),"data-visible":t},te.createElement("div",{className:"sonner-spinner"},w3.map((s,r)=>te.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),C3=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),E3=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),T3=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),D3=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),k3=te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},te.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),te.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),A3=()=>{const[t,a]=te.useState(document.hidden);return te.useEffect(()=>{const s=()=>{a(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),t};let g0=1;class _3{constructor(){this.subscribe=a=>(this.subscribers.push(a),()=>{const s=this.subscribers.indexOf(a);this.subscribers.splice(s,1)}),this.publish=a=>{this.subscribers.forEach(s=>s(a))},this.addToast=a=>{this.publish(a),this.toasts=[...this.toasts,a]},this.create=a=>{var s;const{message:r,...l}=a,o=typeof a?.id=="number"||((s=a.id)==null?void 0:s.length)>0?a.id:g0++,d=this.toasts.find(m=>m.id===o),u=a.dismissible===void 0?!0:a.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),d?this.toasts=this.toasts.map(m=>m.id===o?(this.publish({...m,...a,id:o,title:r}),{...m,...a,id:o,dismissible:u,title:r}):m):this.addToast({title:r,...l,dismissible:u,id:o}),o},this.dismiss=a=>(a?(this.dismissedToasts.add(a),requestAnimationFrame(()=>this.subscribers.forEach(s=>s({id:a,dismiss:!0})))):this.toasts.forEach(s=>{this.subscribers.forEach(r=>r({id:s.id,dismiss:!0}))}),a),this.message=(a,s)=>this.create({...s,message:a}),this.error=(a,s)=>this.create({...s,message:a,type:"error"}),this.success=(a,s)=>this.create({...s,type:"success",message:a}),this.info=(a,s)=>this.create({...s,type:"info",message:a}),this.warning=(a,s)=>this.create({...s,type:"warning",message:a}),this.loading=(a,s)=>this.create({...s,type:"loading",message:a}),this.promise=(a,s)=>{if(!s)return;let r;s.loading!==void 0&&(r=this.create({...s,promise:a,type:"loading",message:s.loading,description:typeof s.description!="function"?s.description:void 0}));const l=Promise.resolve(a instanceof Function?a():a);let o=r!==void 0,d;const u=l.then(async h=>{if(d=["resolve",h],te.isValidElement(h))o=!1,this.create({id:r,type:"default",message:h});else if(O3(h)&&!h.ok){o=!1;const x=typeof s.error=="function"?await s.error(`HTTP error! status: ${h.status}`):s.error,y=typeof s.description=="function"?await s.description(`HTTP error! status: ${h.status}`):s.description,b=typeof x=="object"&&!te.isValidElement(x)?x:{message:x};this.create({id:r,type:"error",description:y,...b})}else if(h instanceof Error){o=!1;const x=typeof s.error=="function"?await s.error(h):s.error,y=typeof s.description=="function"?await s.description(h):s.description,b=typeof x=="object"&&!te.isValidElement(x)?x:{message:x};this.create({id:r,type:"error",description:y,...b})}else if(s.success!==void 0){o=!1;const x=typeof s.success=="function"?await s.success(h):s.success,y=typeof s.description=="function"?await s.description(h):s.description,b=typeof x=="object"&&!te.isValidElement(x)?x:{message:x};this.create({id:r,type:"success",description:y,...b})}}).catch(async h=>{if(d=["reject",h],s.error!==void 0){o=!1;const g=typeof s.error=="function"?await s.error(h):s.error,x=typeof s.description=="function"?await s.description(h):s.description,v=typeof g=="object"&&!te.isValidElement(g)?g:{message:g};this.create({id:r,type:"error",description:x,...v})}}).finally(()=>{o&&(this.dismiss(r),r=void 0),s.finally==null||s.finally.call(s)}),m=()=>new Promise((h,g)=>u.then(()=>d[0]==="reject"?g(d[1]):h(d[1])).catch(g));return typeof r!="string"&&typeof r!="number"?{unwrap:m}:Object.assign(r,{unwrap:m})},this.custom=(a,s)=>{const r=s?.id||g0++;return this.create({jsx:a(r),id:r,...s}),r},this.getActiveToasts=()=>this.toasts.filter(a=>!this.dismissedToasts.has(a.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Zs=new _3,M3=(t,a)=>{const s=a?.id||g0++;return Zs.addToast({title:t,...a,id:s}),s},O3=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",R3=M3,I3=()=>Zs.toasts,z3=()=>Zs.getActiveToasts(),ut=Object.assign(R3,{success:Zs.success,info:Zs.info,warning:Zs.warning,error:Zs.error,custom:Zs.custom,message:Zs.message,promise:Zs.promise,dismiss:Zs.dismiss,loading:Zs.loading},{getHistory:I3,getToasts:z3});j3("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function rh(t){return t.label!==void 0}const L3=3,P3="24px",B3="16px",Cw=4e3,$3=356,H3=14,U3=45,V3=200;function wr(...t){return t.filter(Boolean).join(" ")}function Y3(t){const[a,s]=t.split("-"),r=[];return a&&r.push(a),s&&r.push(s),r}const q3=t=>{var a,s,r,l,o,d,u,m,h;const{invert:g,toast:x,unstyled:y,interacting:v,setHeights:b,visibleToasts:N,heights:S,index:w,toasts:E,expanded:T,removeToast:D,defaultRichColors:k,closeButton:_,style:R,cancelButtonStyle:L,actionButtonStyle:U,className:V="",descriptionClassName:F="",duration:G,position:$,gap:z,expandByDefault:H,classNames:I,icons:O,closeButtonAriaLabel:Y="Close toast"}=t,[le,re]=te.useState(null),[Q,q]=te.useState(null),[M,W]=te.useState(!1),[ie,ve]=te.useState(!1),[K,oe]=te.useState(!1),[_e,je]=te.useState(!1),[Ie,ge]=te.useState(!1),[Be,ke]=te.useState(0),[gt,Dt]=te.useState(0),kt=te.useRef(x.duration||G||Cw),ja=te.useRef(null),Wt=te.useRef(null),Vt=w===0,X=w+1<=N,se=x.type,me=x.dismissible!==!1,Oe=x.className||"",Re=x.descriptionClassName||"",Ee=te.useMemo(()=>S.findIndex($e=>$e.toastId===x.id)||0,[S,x.id]),Pe=te.useMemo(()=>{var $e;return($e=x.closeButton)!=null?$e:_},[x.closeButton,_]),Je=te.useMemo(()=>x.duration||G||Cw,[x.duration,G]),rt=te.useRef(0),Et=te.useRef(0),Kt=te.useRef(0),Ne=te.useRef(null),[Ve,nt]=$.split("-"),bt=te.useMemo(()=>S.reduce(($e,Ae,Fe)=>Fe>=Ee?$e:$e+Ae.height,0),[S,Ee]),Pt=A3(),_a=x.invert||g,Ma=se==="loading";Et.current=te.useMemo(()=>Ee*z+bt,[Ee,bt]),te.useEffect(()=>{kt.current=Je},[Je]),te.useEffect(()=>{W(!0)},[]),te.useEffect(()=>{const $e=Wt.current;if($e){const Ae=$e.getBoundingClientRect().height;return Dt(Ae),b(Fe=>[{toastId:x.id,height:Ae,position:x.position},...Fe]),()=>b(Fe=>Fe.filter(lt=>lt.toastId!==x.id))}},[b,x.id]),te.useLayoutEffect(()=>{if(!M)return;const $e=Wt.current,Ae=$e.style.height;$e.style.height="auto";const Fe=$e.getBoundingClientRect().height;$e.style.height=Ae,Dt(Fe),b(lt=>lt.find(ht=>ht.toastId===x.id)?lt.map(ht=>ht.toastId===x.id?{...ht,height:Fe}:ht):[{toastId:x.id,height:Fe,position:x.position},...lt])},[M,x.title,x.description,b,x.id,x.jsx,x.action,x.cancel]);const qe=te.useCallback(()=>{ve(!0),ke(Et.current),b($e=>$e.filter(Ae=>Ae.toastId!==x.id)),setTimeout(()=>{D(x)},V3)},[x,D,b,Et]);te.useEffect(()=>{if(x.promise&&se==="loading"||x.duration===1/0||x.type==="loading")return;let $e;return T||v||Pt?(()=>{if(Kt.current<rt.current){const lt=new Date().getTime()-rt.current;kt.current=kt.current-lt}Kt.current=new Date().getTime()})():kt.current!==1/0&&(rt.current=new Date().getTime(),$e=setTimeout(()=>{x.onAutoClose==null||x.onAutoClose.call(x,x),qe()},kt.current)),()=>clearTimeout($e)},[T,v,x,se,Pt,qe]),te.useEffect(()=>{x.delete&&(qe(),x.onDismiss==null||x.onDismiss.call(x,x))},[qe,x.delete]);function dt(){var $e;if(O?.loading){var Ae;return te.createElement("div",{className:wr(I?.loader,x==null||(Ae=x.classNames)==null?void 0:Ae.loader,"sonner-loader"),"data-visible":se==="loading"},O.loading)}return te.createElement(S3,{className:wr(I?.loader,x==null||($e=x.classNames)==null?void 0:$e.loader),visible:se==="loading"})}const jt=x.icon||O?.[se]||N3(se);var Xe,et;return te.createElement("li",{tabIndex:0,ref:Wt,className:wr(V,Oe,I?.toast,x==null||(a=x.classNames)==null?void 0:a.toast,I?.default,I?.[se],x==null||(s=x.classNames)==null?void 0:s[se]),"data-sonner-toast":"","data-rich-colors":(Xe=x.richColors)!=null?Xe:k,"data-styled":!(x.jsx||x.unstyled||y),"data-mounted":M,"data-promise":!!x.promise,"data-swiped":Ie,"data-removed":ie,"data-visible":X,"data-y-position":Ve,"data-x-position":nt,"data-index":w,"data-front":Vt,"data-swiping":K,"data-dismissible":me,"data-type":se,"data-invert":_a,"data-swipe-out":_e,"data-swipe-direction":Q,"data-expanded":!!(T||H&&M),"data-testid":x.testId,style:{"--index":w,"--toasts-before":w,"--z-index":E.length-w,"--offset":`${ie?Be:Et.current}px`,"--initial-height":H?"auto":`${gt}px`,...R,...x.style},onDragEnd:()=>{oe(!1),re(null),Ne.current=null},onPointerDown:$e=>{$e.button!==2&&(Ma||!me||(ja.current=new Date,ke(Et.current),$e.target.setPointerCapture($e.pointerId),$e.target.tagName!=="BUTTON"&&(oe(!0),Ne.current={x:$e.clientX,y:$e.clientY})))},onPointerUp:()=>{var $e,Ae,Fe;if(_e||!me)return;Ne.current=null;const lt=Number((($e=Wt.current)==null?void 0:$e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Xt=Number(((Ae=Wt.current)==null?void 0:Ae.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ht=new Date().getTime()-((Fe=ja.current)==null?void 0:Fe.getTime()),ct=le==="x"?lt:Xt,pa=Math.abs(ct)/ht;if(Math.abs(ct)>=U3||pa>.11){ke(Et.current),x.onDismiss==null||x.onDismiss.call(x,x),q(le==="x"?lt>0?"right":"left":Xt>0?"down":"up"),qe(),je(!0);return}else{var qt,da;(qt=Wt.current)==null||qt.style.setProperty("--swipe-amount-x","0px"),(da=Wt.current)==null||da.style.setProperty("--swipe-amount-y","0px")}ge(!1),oe(!1),re(null)},onPointerMove:$e=>{var Ae,Fe,lt;if(!Ne.current||!me||((Ae=window.getSelection())==null?void 0:Ae.toString().length)>0)return;const ht=$e.clientY-Ne.current.y,ct=$e.clientX-Ne.current.x;var pa;const qt=(pa=t.swipeDirections)!=null?pa:Y3($);!le&&(Math.abs(ct)>1||Math.abs(ht)>1)&&re(Math.abs(ct)>Math.abs(ht)?"x":"y");let da={x:0,y:0};const Na=xa=>1/(1.5+Math.abs(xa)/20);if(le==="y"){if(qt.includes("top")||qt.includes("bottom"))if(qt.includes("top")&&ht<0||qt.includes("bottom")&&ht>0)da.y=ht;else{const xa=ht*Na(ht);da.y=Math.abs(xa)<Math.abs(ht)?xa:ht}}else if(le==="x"&&(qt.includes("left")||qt.includes("right")))if(qt.includes("left")&&ct<0||qt.includes("right")&&ct>0)da.x=ct;else{const xa=ct*Na(ct);da.x=Math.abs(xa)<Math.abs(ct)?xa:ct}(Math.abs(da.x)>0||Math.abs(da.y)>0)&&ge(!0),(Fe=Wt.current)==null||Fe.style.setProperty("--swipe-amount-x",`${da.x}px`),(lt=Wt.current)==null||lt.style.setProperty("--swipe-amount-y",`${da.y}px`)}},Pe&&!x.jsx&&se!=="loading"?te.createElement("button",{"aria-label":Y,"data-disabled":Ma,"data-close-button":!0,onClick:Ma||!me?()=>{}:()=>{qe(),x.onDismiss==null||x.onDismiss.call(x,x)},className:wr(I?.closeButton,x==null||(r=x.classNames)==null?void 0:r.closeButton)},(et=O?.close)!=null?et:k3):null,(se||x.icon||x.promise)&&x.icon!==null&&(O?.[se]!==null||x.icon)?te.createElement("div",{"data-icon":"",className:wr(I?.icon,x==null||(l=x.classNames)==null?void 0:l.icon)},x.promise||x.type==="loading"&&!x.icon?x.icon||dt():null,x.type!=="loading"?jt:null):null,te.createElement("div",{"data-content":"",className:wr(I?.content,x==null||(o=x.classNames)==null?void 0:o.content)},te.createElement("div",{"data-title":"",className:wr(I?.title,x==null||(d=x.classNames)==null?void 0:d.title)},x.jsx?x.jsx:typeof x.title=="function"?x.title():x.title),x.description?te.createElement("div",{"data-description":"",className:wr(F,Re,I?.description,x==null||(u=x.classNames)==null?void 0:u.description)},typeof x.description=="function"?x.description():x.description):null),te.isValidElement(x.cancel)?x.cancel:x.cancel&&rh(x.cancel)?te.createElement("button",{"data-button":!0,"data-cancel":!0,style:x.cancelButtonStyle||L,onClick:$e=>{rh(x.cancel)&&me&&(x.cancel.onClick==null||x.cancel.onClick.call(x.cancel,$e),qe())},className:wr(I?.cancelButton,x==null||(m=x.classNames)==null?void 0:m.cancelButton)},x.cancel.label):null,te.isValidElement(x.action)?x.action:x.action&&rh(x.action)?te.createElement("button",{"data-button":!0,"data-action":!0,style:x.actionButtonStyle||U,onClick:$e=>{rh(x.action)&&(x.action.onClick==null||x.action.onClick.call(x.action,$e),!$e.defaultPrevented&&qe())},className:wr(I?.actionButton,x==null||(h=x.classNames)==null?void 0:h.actionButton)},x.action.label):null)};function Ew(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function F3(t,a){const s={};return[t,a].forEach((r,l)=>{const o=l===1,d=o?"--mobile-offset":"--offset",u=o?B3:P3;function m(h){["top","right","bottom","left"].forEach(g=>{s[`${d}-${g}`]=typeof h=="number"?`${h}px`:h})}typeof r=="number"||typeof r=="string"?m(r):typeof r=="object"?["top","right","bottom","left"].forEach(h=>{r[h]===void 0?s[`${d}-${h}`]=u:s[`${d}-${h}`]=typeof r[h]=="number"?`${r[h]}px`:r[h]}):m(u)}),s}const G3=te.forwardRef(function(a,s){const{id:r,invert:l,position:o="bottom-right",hotkey:d=["altKey","KeyT"],expand:u,closeButton:m,className:h,offset:g,mobileOffset:x,theme:y="light",richColors:v,duration:b,style:N,visibleToasts:S=L3,toastOptions:w,dir:E=Ew(),gap:T=H3,icons:D,containerAriaLabel:k="Notifications"}=a,[_,R]=te.useState([]),L=te.useMemo(()=>r?_.filter(M=>M.toasterId===r):_.filter(M=>!M.toasterId),[_,r]),U=te.useMemo(()=>Array.from(new Set([o].concat(L.filter(M=>M.position).map(M=>M.position)))),[L,o]),[V,F]=te.useState([]),[G,$]=te.useState(!1),[z,H]=te.useState(!1),[I,O]=te.useState(y!=="system"?y:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Y=te.useRef(null),le=d.join("+").replace(/Key/g,"").replace(/Digit/g,""),re=te.useRef(null),Q=te.useRef(!1),q=te.useCallback(M=>{R(W=>{var ie;return(ie=W.find(ve=>ve.id===M.id))!=null&&ie.delete||Zs.dismiss(M.id),W.filter(({id:ve})=>ve!==M.id)})},[]);return te.useEffect(()=>Zs.subscribe(M=>{if(M.dismiss){requestAnimationFrame(()=>{R(W=>W.map(ie=>ie.id===M.id?{...ie,delete:!0}:ie))});return}setTimeout(()=>{oM.flushSync(()=>{R(W=>{const ie=W.findIndex(ve=>ve.id===M.id);return ie!==-1?[...W.slice(0,ie),{...W[ie],...M},...W.slice(ie+1)]:[M,...W]})})})}),[_]),te.useEffect(()=>{if(y!=="system"){O(y);return}if(y==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?O("dark"):O("light")),typeof window>"u")return;const M=window.matchMedia("(prefers-color-scheme: dark)");try{M.addEventListener("change",({matches:W})=>{O(W?"dark":"light")})}catch{M.addListener(({matches:ie})=>{try{O(ie?"dark":"light")}catch(ve){console.error(ve)}})}},[y]),te.useEffect(()=>{_.length<=1&&$(!1)},[_]),te.useEffect(()=>{const M=W=>{var ie;if(d.every(oe=>W[oe]||W.code===oe)){var K;$(!0),(K=Y.current)==null||K.focus()}W.code==="Escape"&&(document.activeElement===Y.current||(ie=Y.current)!=null&&ie.contains(document.activeElement))&&$(!1)};return document.addEventListener("keydown",M),()=>document.removeEventListener("keydown",M)},[d]),te.useEffect(()=>{if(Y.current)return()=>{re.current&&(re.current.focus({preventScroll:!0}),re.current=null,Q.current=!1)}},[Y.current]),te.createElement("section",{ref:s,"aria-label":`${k} ${le}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},U.map((M,W)=>{var ie;const[ve,K]=M.split("-");return L.length?te.createElement("ol",{key:M,dir:E==="auto"?Ew():E,tabIndex:-1,ref:Y,className:h,"data-sonner-toaster":!0,"data-sonner-theme":I,"data-y-position":ve,"data-x-position":K,style:{"--front-toast-height":`${((ie=V[0])==null?void 0:ie.height)||0}px`,"--width":`${$3}px`,"--gap":`${T}px`,...N,...F3(g,x)},onBlur:oe=>{Q.current&&!oe.currentTarget.contains(oe.relatedTarget)&&(Q.current=!1,re.current&&(re.current.focus({preventScroll:!0}),re.current=null))},onFocus:oe=>{oe.target instanceof HTMLElement&&oe.target.dataset.dismissible==="false"||Q.current||(Q.current=!0,re.current=oe.relatedTarget)},onMouseEnter:()=>$(!0),onMouseMove:()=>$(!0),onMouseLeave:()=>{z||$(!1)},onDragEnd:()=>$(!1),onPointerDown:oe=>{oe.target instanceof HTMLElement&&oe.target.dataset.dismissible==="false"||H(!0)},onPointerUp:()=>H(!1)},L.filter(oe=>!oe.position&&W===0||oe.position===M).map((oe,_e)=>{var je,Ie;return te.createElement(q3,{key:oe.id,icons:D,index:_e,toast:oe,defaultRichColors:v,duration:(je=w?.duration)!=null?je:b,className:w?.className,descriptionClassName:w?.descriptionClassName,invert:l,visibleToasts:S,closeButton:(Ie=w?.closeButton)!=null?Ie:m,interacting:z,position:M,style:w?.style,unstyled:w?.unstyled,classNames:w?.classNames,cancelButtonStyle:w?.cancelButtonStyle,actionButtonStyle:w?.actionButtonStyle,closeButtonAriaLabel:w?.closeButtonAriaLabel,removeToast:q,toasts:L.filter(ge=>ge.position==oe.position),heights:V.filter(ge=>ge.position==oe.position),setHeights:F,expandByDefault:u,gap:T,expanded:G,swipeDirections:a.swipeDirections})})):null}))}),W3=({...t})=>{const{theme:a="system"}=b3();return e.jsx(G3,{theme:a,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},K3=()=>e.jsx(p3,{children:e.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden",children:[e.jsx(m3,{}),e.jsxs("div",{className:"flex-1 flex flex-col main-content-adaptive overflow-hidden",children:[e.jsx("div",{className:"pt-0 flex-1 flex flex-col overflow-hidden",children:e.jsx("main",{className:"flex-1 overflow-auto scroll-container",children:e.jsx(X4,{})})}),e.jsx(x3,{}),e.jsx("div",{className:"pb-16 md:pb-0"})]}),e.jsx(f3,{}),e.jsx(h3,{}),e.jsx(W3,{})]})});function Tw(){const[t,a]=p.useState(""),[s,r]=p.useState(""),[l,o]=p.useState(!1),[d,u]=p.useState(""),[m,h]=p.useState(!1),{signIn:g,signUp:x}=st(),y=async v=>{v.preventDefault(),u(""),h(!0);try{l?(await x(t,s),alert("Cuenta creada! Revisa tu email para confirmar tu cuenta.")):await g(t,s)}catch(b){u(b.message||"Error al procesar la solicitud")}finally{h(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow-md",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-center text-gray-900",children:l?"Crear Cuenta":"Iniciar Sesin"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Life Tracker - Tu asistente de productividad"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[d&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:d}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:t,onChange:v=>a(v.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"tu@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Contrasea"}),e.jsx("input",{id:"password",type:"password",value:s,onChange:v=>r(v.target.value),required:!0,minLength:6,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Mnimo 6 caracteres"})]}),e.jsx("button",{type:"submit",disabled:m,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Procesando...":l?"Registrarse":"Entrar"})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>{o(!l),u("")},className:"text-sm text-blue-600 hover:underline",children:l?"Ya tienes cuenta? Inicia sesin":"No tienes cuenta? Regstrate"})})]})})}function by(t){const a=p.useRef({value:t,previous:t});return p.useMemo(()=>(a.current.value!==t&&(a.current.previous=a.current.value,a.current.value=t),a.current.previous),[t])}var _f="Checkbox",[X3,k7]=vi(_f),[Q3,jy]=X3(_f);function Z3(t){const{__scopeCheckbox:a,checked:s,children:r,defaultChecked:l,disabled:o,form:d,name:u,onCheckedChange:m,required:h,value:g="on",internal_do_not_use_render:x}=t,[y,v]=Mr({prop:s,defaultProp:l??!1,onChange:m,caller:_f}),[b,N]=p.useState(null),[S,w]=p.useState(null),E=p.useRef(!1),T=b?!!d||!!b.closest("form"):!0,D={checked:y,disabled:o,setChecked:v,control:b,setControl:N,name:u,form:d,value:g,hasConsumerStoppedPropagationRef:E,required:h,defaultChecked:ul(l)?!1:l,isFormControl:T,bubbleInput:S,setBubbleInput:w};return e.jsx(Q3,{scope:a,...D,children:J3(x)?x(D):r})}var pE="CheckboxTrigger",xE=p.forwardRef(({__scopeCheckbox:t,onKeyDown:a,onClick:s,...r},l)=>{const{control:o,value:d,disabled:u,checked:m,required:h,setControl:g,setChecked:x,hasConsumerStoppedPropagationRef:y,isFormControl:v,bubbleInput:b}=jy(pE,t),N=Sa(l,g),S=p.useRef(m);return p.useEffect(()=>{const w=o?.form;if(w){const E=()=>x(S.current);return w.addEventListener("reset",E),()=>w.removeEventListener("reset",E)}},[o,x]),e.jsx(Gt.button,{type:"button",role:"checkbox","aria-checked":ul(m)?"mixed":m,"aria-required":h,"data-state":jE(m),"data-disabled":u?"":void 0,disabled:u,value:d,...r,ref:N,onKeyDown:Nt(a,w=>{w.key==="Enter"&&w.preventDefault()}),onClick:Nt(s,w=>{x(E=>ul(E)?!0:!E),b&&v&&(y.current=w.isPropagationStopped(),y.current||w.stopPropagation())})})});xE.displayName=pE;var Ny=p.forwardRef((t,a)=>{const{__scopeCheckbox:s,name:r,checked:l,defaultChecked:o,required:d,disabled:u,value:m,onCheckedChange:h,form:g,...x}=t;return e.jsx(Z3,{__scopeCheckbox:s,checked:l,defaultChecked:o,disabled:u,required:d,onCheckedChange:h,name:r,form:g,value:m,internal_do_not_use_render:({isFormControl:y})=>e.jsxs(e.Fragment,{children:[e.jsx(xE,{...x,ref:a,__scopeCheckbox:s}),y&&e.jsx(bE,{__scopeCheckbox:s})]})})});Ny.displayName=_f;var gE="CheckboxIndicator",yE=p.forwardRef((t,a)=>{const{__scopeCheckbox:s,forceMount:r,...l}=t,o=jy(gE,s);return e.jsx(bi,{present:r||ul(o.checked)||o.checked===!0,children:e.jsx(Gt.span,{"data-state":jE(o.checked),"data-disabled":o.disabled?"":void 0,...l,ref:a,style:{pointerEvents:"none",...t.style}})})});yE.displayName=gE;var vE="CheckboxBubbleInput",bE=p.forwardRef(({__scopeCheckbox:t,...a},s)=>{const{control:r,hasConsumerStoppedPropagationRef:l,checked:o,defaultChecked:d,required:u,disabled:m,name:h,value:g,form:x,bubbleInput:y,setBubbleInput:v}=jy(vE,t),b=Sa(s,v),N=by(o),S=OC(r);p.useEffect(()=>{const E=y;if(!E)return;const T=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(T,"checked").set,_=!l.current;if(N!==o&&k){const R=new Event("click",{bubbles:_});E.indeterminate=ul(o),k.call(E,ul(o)?!1:o),E.dispatchEvent(R)}},[y,N,o,l]);const w=p.useRef(ul(o)?!1:o);return e.jsx(Gt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:d??w.current,required:u,disabled:m,name:h,value:g,form:x,...a,tabIndex:-1,ref:b,style:{...a.style,...S,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});bE.displayName=vE;function J3(t){return typeof t=="function"}function ul(t){return t==="indeterminate"}function jE(t){return ul(t)?"indeterminate":t?"checked":"unchecked"}const Va=p.forwardRef(({className:t,...a},s)=>e.jsx(Ny,{ref:s,className:he("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:e.jsx(yE,{className:he("flex items-center justify-center text-current"),children:e.jsx(cr,{className:"h-4 w-4"})})}));Va.displayName=Ny.displayName;const nn=[{id:1,name:"Tomar Agua (maana)",icon:"",timeOfDay:"morning",goal:"5 min",baseTime:"05:50",steps:["Llenar un vaso con agua","Beber lentamente"]},{id:2,name:"Ejercicio",icon:"",timeOfDay:"morning",goal:"40 min",baseTime:"07:00",steps:["Preparar el equipo","Hacer calentamiento","Realizar ejercicio principal","Hacer enfriamiento","Estirar msculos"]},{id:3,name:"Ducha fria",icon:"",timeOfDay:"morning",goal:"10 min",baseTime:"08:15",steps:["Preparar toalla","Graduar temperatura del agua","Entrar lentamente","Respirar profundamente","Secar completamente"]},{id:4,name:"Desayuno",icon:"",timeOfDay:"morning",goal:"30 min",baseTime:"08:30",steps:["Preparar ingredientes","Cocinar alimentos","Servir en plato","Comer sin distracciones","Lavar los platos"]},{id:5,name:"Lavarme los dientes",icon:"",timeOfDay:"morning",goal:"2 min",baseTime:"09:00",steps:["Preparar cepillo y pasta","Cepillar durante 2 minutos","Enjuagar boca","Limpiar cepillo"]},{id:6,name:"Seda Dental",icon:"",timeOfDay:"morning",goal:"2 min",baseTime:"09:05",steps:["Tomar hilo dental","Limpiar entre cada diente","Enjuagar boca","Guardar hilo dental"]},{id:7,name:"Tender la cama",icon:"",timeOfDay:"morning",goal:"3 min",baseTime:"09:10",steps:["Estirar sbanas","Acomodar almohadas","Doblar cobijas","Verificar que est ordenada"]},{id:20,name:"Lavar loza del desayuno",icon:"",timeOfDay:"morning",goal:"10 min",baseTime:"09:15",steps:["Fregar los platos","Enjuagar y secar"]},{id:22,name:"Aplicarme bloqueador solar",icon:"",timeOfDay:"morning",goal:"5 min",baseTime:"09:30",steps:["Aplicar bloqueador en cara","Aplicar bloqueador en cuello"]},{id:8,name:"Almuerzo",icon:"",timeOfDay:"afternoon",goal:"60 min",baseTime:"12:30",steps:["Planificar el men","Preparar ingredientes","Cocinar platos","Servir comida","Comer tranquilamente","Lavar platos"]},{id:9,name:"Siesta",icon:"",timeOfDay:"afternoon",goal:"15 min",baseTime:"13:00",steps:["Encontrar lugar cmodo","Cerrar ojos","Respirar profundamente","Relajarse completamente"]},{id:10,name:"Lavarme los dientes",icon:"",timeOfDay:"afternoon",goal:"2 min",baseTime:"13:15",steps:["Preparar cepillo y pasta","Cepillar durante 2 minutos","Enjuagar boca","Limpiar cepillo"]},{id:11,name:"Seda Dental",icon:"",timeOfDay:"afternoon",goal:"2 min",baseTime:"13:30",steps:["Tomar hilo dental","Limpiar entre cada diente","Enjuagar boca","Guardar hilo dental"]},{id:19,name:"Tomar agua (tarde)",icon:"",timeOfDay:"afternoon",goal:"5 min",baseTime:"15:00",steps:["Llenar un vaso con agua","Beber lentamente"]},{id:12,name:"Cena",icon:"",timeOfDay:"night",goal:"30 min",baseTime:"19:45",steps:["Elegir alimentos ligeros","Cocinar sin prisa","Cenar temprano","Lavar platos"]},{id:13,name:"Lavarme los dientes",icon:"",timeOfDay:"night",goal:"2 min",baseTime:"20:00",steps:["Preparar cepillo y pasta","Cepillar durante 2 minutos","Enjuagar boca","Limpiar cepillo"]},{id:14,name:"Seda Dental",icon:"",timeOfDay:"night",goal:"2 min",baseTime:"20:15",steps:["Tomar hilo dental","Limpiar entre cada diente","Enjuagar boca","Guardar hilo dental"]},{id:15,name:"Llevar el diario",icon:"",timeOfDay:"night",goal:"10 min",baseTime:"20:30",steps:["Abrir el diario","Reflexionar sobre el da","Escribir pensamientos","Cerrar y guardar"]},{id:16,name:"Botar algo que no sirva",icon:"",timeOfDay:"night",goal:"10 min",baseTime:"20:45",steps:["Buscar objetos innecesarios","Evaluar si sirven","Desechar responsablemente","Limpiar el rea"]},{id:17,name:"Organizar la cocina",icon:"",timeOfDay:"night",goal:"15 min",baseTime:"21:00",steps:["Lavar platos pendientes","Guardar utensilios","Limpiar superficies","Organizar despensa"]},{id:18,name:"Lectura",icon:"",timeOfDay:"night",goal:"5 min",baseTime:"21:15",steps:["Elegir libro","Encontrar lugar cmodo","Leer sin distracciones","Marcar pgina"]},{id:21,name:"Lista de pendientes",icon:"",timeOfDay:"night",goal:"15 min",baseTime:"21:30",steps:["Revisar tareas pendientes","Priorizar actividades","Anotar nuevas tareas"]},{id:23,name:"Alistar la ropa para maana",icon:"",timeOfDay:"night",goal:"5 min",baseTime:"21:45",steps:["Seleccionar ropa adecuada","Preparar accesorios"]}],NE={1:"bg-blue-500",2:"bg-green-500",3:"bg-yellow-500",4:"bg-orange-500",5:"bg-purple-500",6:"bg-pink-500",7:"bg-red-500",8:"bg-teal-500",9:"bg-indigo-500",10:"bg-gray-500",11:"bg-lime-500",12:"bg-amber-500",13:"bg-cyan-500",14:"bg-fuchsia-500",15:"bg-rose-500",16:"bg-violet-500",17:"bg-sky-500",18:"bg-emerald-500",19:"bg-indigo-500",20:"bg-yellow-600",21:"bg-pink-600",22:"bg-blue-600",23:"bg-green-600"};class $h{static client=ze;static async getHabitCompletionsByRange(a,s,r){return ze.from("habit_completions").select("habit_id, date, completed").eq("user_id",a).gte("date",s).lte("date",r)}static async upsertHabitCompletion(a){return ze.from("habit_completions").upsert({user_id:a.userId,habit_id:a.habitId,date:a.date,completed:a.completed},{onConflict:"user_id,habit_id,date"})}static table(a){return ze.from(a)}}const e5={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},t5=(t,a,s)=>{let r;const l=e5[t];return typeof l=="string"?r=l:a===1?r=l.one:r=l.other.replace("{{count}}",a.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"en "+r:"hace "+r:r},a5={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},s5={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},n5={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},r5={date:cg({formats:a5,defaultWidth:"full"}),time:cg({formats:s5,defaultWidth:"full"}),dateTime:cg({formats:n5,defaultWidth:"full"})},i5={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},l5={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},o5=(t,a,s,r)=>a.getHours()!==1?l5[t]:i5[t],c5={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},d5={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},u5={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},m5={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},h5={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},f5={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},p5=(t,a)=>Number(t)+"",x5={ordinalNumber:p5,era:kd({values:c5,defaultWidth:"wide"}),quarter:kd({values:d5,defaultWidth:"wide",argumentCallback:t=>Number(t)-1}),month:kd({values:u5,defaultWidth:"wide"}),day:kd({values:m5,defaultWidth:"wide"}),dayPeriod:kd({values:h5,defaultWidth:"wide",formattingValues:f5,defaultFormattingWidth:"wide"})},g5=/^(\d+)()?/i,y5=/\d+/i,v5={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},b5={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},j5={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},N5={any:[/1/i,/2/i,/3/i,/4/i]},w5={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},S5={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},C5={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},E5={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},T5={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},D5={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},k5={ordinalNumber:EM({matchPattern:g5,parsePattern:y5,valueCallback:function(t){return parseInt(t,10)}}),era:Ad({matchPatterns:v5,defaultMatchWidth:"wide",parsePatterns:b5,defaultParseWidth:"any"}),quarter:Ad({matchPatterns:j5,defaultMatchWidth:"wide",parsePatterns:N5,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ad({matchPatterns:w5,defaultMatchWidth:"wide",parsePatterns:S5,defaultParseWidth:"any"}),day:Ad({matchPatterns:C5,defaultMatchWidth:"wide",parsePatterns:E5,defaultParseWidth:"any"}),dayPeriod:Ad({matchPatterns:T5,defaultMatchWidth:"any",parsePatterns:D5,defaultParseWidth:"any"})},As={code:"es",formatDistance:t5,formatLong:r5,formatRelative:o5,localize:x5,match:k5,options:{weekStartsOn:1,firstWeekContainsDate:1}},Ue=(t=new Date)=>{const a=new Date(t.getTime());return a.setHours(0,0,0,0),a.toISOString().split("T")[0]},rl=t=>{const a=new Date(t);return a.setHours(12,0,0,0),a},Hh=t=>{const a=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],s=t.getDate(),r=a[t.getMonth()],l=t.getFullYear();let o=t.getHours();const d=t.getMinutes().toString().padStart(2,"0"),u=t.getSeconds().toString().padStart(2,"0"),m=o>=12?"p.m.":"a.m.";o=o%12,o=o||12;const h=-t.getTimezoneOffset(),g=Math.abs(Math.floor(h/60)),x=h>=0?"+":"-";return`${s} de ${r} de ${l}, ${o}:${d}:${u} ${m} UTC${x}${g}`},$n=(t,a,s)=>{const r=new Date(t);return r.setHours(a,s,0,0),{timestamp:r.getTime(),utcOffset:-r.getTimezoneOffset(),formatted:Hh(r)}},A5=(t=new Date,a="daily",s=1)=>{const r=ka(t);switch(a){case"daily":return ps(r,1);case"weekly":return J0(r,1);case"monthly":return vf(r,1);case"custom":return ps(r,s);default:return r}},wE=(t,a,s)=>{const r=Jt(t,"'prximo' EEEE",{locale:As});switch(a){case"daily":return`Diariamente (${r})`;case"weekly":return`Semanalmente (${r})`;case"monthly":return`Mensualmente (${Jt(t,"'prximo' d 'de' MMMM",{locale:As})})`;case"custom":return`Cada ${s} da${s!==1?"s":""} (${r})`;default:return""}},_5=t=>{const a=t.getTimezoneOffset();return new Date(t.getTime()-a*60*1e3).toISOString().split("T")[0]},M5=t=>Jt(t,"EEEE, d 'de' MMMM 'de' yyyy",{locale:As}),O5=t=>Array.from({length:12},(a,s)=>({name:new Date(t,s).toLocaleString("es",{month:"short"}),days:new Date(t,s+1,0).getDate(),number:s+1})),xu=(t,a,s)=>{if(!a)return;if(!t){const o=new Date(s);return o.setHours(o.getHours()+1),o}const r=a.getTime()-t.getTime();if(r<=0){const o=new Date(s);return o.setHours(o.getHours()+1),o}const l=new Date(s.getTime()+r);return l.getTime()<=s.getTime()&&l.setMinutes(l.getMinutes()+30),l},R5=(t,a=50,s=30)=>t/a*s,wy=(t,a=50,s=30)=>t/s*a,Dw=(t,a=new Date,s=6)=>{const r=R5(t),l=new Date(a);return l.setHours(s,0,0,0),l.setMinutes(r),l},kw=(t,a=15)=>{const s=t.getMinutes(),r=Math.round(s/a)*a,l=new Date(t);return l.setMinutes(r,0,0),l},SE=(t,a=6)=>{const s=t.getHours(),r=t.getMinutes(),l=(s-a)*60+r;return wy(l)},I5=t=>{const a=new Date(t),s=a.getDay(),r=new Date(a);r.setDate(a.getDate()-s),r.setHours(0,0,0,0);const l=new Date(r);return l.setDate(r.getDate()+6),l.setHours(23,59,59,999),{start:r,end:l}},CE=t=>{const a=new Date(t.getFullYear(),t.getMonth(),1);a.setHours(0,0,0,0);const s=new Date(t.getFullYear(),t.getMonth()+1,0);return s.setHours(23,59,59,999),{start:a,end:s}},Mf=t=>{const{user:a}=st(),[s,r]=p.useState({}),[l,o]=p.useState("idle"),[d,u]=p.useState(null),m=Ue(t),[h,g]=m.split("-"),x=`${h}-${g}`;return p.useEffect(()=>{if(!a)return;(async()=>{try{o("pending"),u(null);const b=`${x}-01`,N=new Date(Number(h),Number(g),0).getDate(),S=`${x}-${String(N).padStart(2,"0")}`,{data:w,error:E}=await $h.getHabitCompletionsByRange(a.id,b,S);if(E)throw E;const T={};(w||[]).forEach(D=>{const k=`${D.habit_id}_${D.date}`;T[k]=D.completed}),r(T),o("saved")}catch(b){console.error("Error loading daily habit data:",b),u(b instanceof Error?b.message:"Error loading habits"),o("error")}})()},[a,x]),{completedHabits:s,status:l,error:d,toggleHabit:async(v,b)=>{if(!a)return;o("saving"),u(null);const N=`${v}_${b}`,S=!s[N];r(w=>({...w,[N]:S}));try{const{error:w}=await $h.upsertHabitCompletion({userId:a.id,habitId:v,date:b,completed:S});if(w)throw w;o("saved")}catch(w){console.error("Error toggling habit:",w),u(w instanceof Error?w.message:"Error updating habit"),o("error"),r(E=>({...E,[N]:!S}))}}}},z5=({autoStart:t=!0}={})=>{const[a,s]=p.useState(0),[r,l]=p.useState(!1),[o,d]=p.useState(!1),[u,m]=p.useState(null),[h,g]=p.useState(0),x=p.useRef(null),y=p.useCallback(E=>{const T=Math.floor(E/3600),D=Math.floor(E%3600/60),k=E%60;return[T,D,k].map(R=>String(R).padStart(2,"0")).join(":")},[]),v=p.useCallback(()=>{l(!0),d(!1),m(Date.now())},[]),b=p.useCallback(()=>{if(r&&!o&&u){d(!0);const E=Date.now(),T=Math.floor((E-u)/1e3);g(D=>D+T)}},[r,o,u]),N=p.useCallback(()=>{r&&o&&(d(!1),m(Date.now()))},[r,o]),S=p.useCallback(()=>{x.current&&(clearInterval(x.current),x.current=null),l(!1),d(!1),g(0),m(null),s(0)},[]),w=p.useCallback(()=>{S(),t&&setTimeout(()=>v(),50)},[t,v,S]);return p.useEffect(()=>(r&&!o&&u?x.current=window.setInterval(()=>{const E=Date.now(),T=Math.floor((E-u)/1e3);s(h+T)},1e3):x.current&&(window.clearInterval(x.current),x.current=null),()=>{x.current&&(window.clearInterval(x.current),x.current=null)}),[r,o,u,h]),p.useEffect(()=>{t&&v()},[t,v]),p.useEffect(()=>()=>{x.current&&(window.clearInterval(x.current),x.current=null)},[]),{time:a,isActive:r,isPaused:o,formattedTime:y(a),startTimer:v,pauseTimer:b,resumeTimer:N,stopTimer:S,resetTimer:w}};var L5=Symbol("radix.slottable");function P5(t){const a=({children:s})=>e.jsx(e.Fragment,{children:s});return a.displayName=`${t}.Slottable`,a.__radixId=L5,a}var EE="AlertDialog",[B5,A7]=vi(EE,[RC]),ji=RC(),TE=t=>{const{__scopeAlertDialog:a,...s}=t,r=ji(a);return e.jsx(pf,{...r,...s,modal:!0})};TE.displayName=EE;var $5="AlertDialogTrigger",DE=p.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...r}=t,l=ji(s);return e.jsx(xf,{...l,...r,ref:a})});DE.displayName=$5;var H5="AlertDialogPortal",kE=t=>{const{__scopeAlertDialog:a,...s}=t,r=ji(a);return e.jsx(ff,{...r,...s})};kE.displayName=H5;var U5="AlertDialogOverlay",AE=p.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...r}=t,l=ji(s);return e.jsx(Sc,{...l,...r,ref:a})});AE.displayName=U5;var ic="AlertDialogContent",[V5,Y5]=B5(ic),q5=P5("AlertDialogContent"),_E=p.forwardRef((t,a)=>{const{__scopeAlertDialog:s,children:r,...l}=t,o=ji(s),d=p.useRef(null),u=Sa(a,d),m=p.useRef(null);return e.jsx(cM,{contentName:ic,titleName:ME,docsSlug:"alert-dialog",children:e.jsx(V5,{scope:s,cancelRef:m,children:e.jsxs(Cc,{role:"alertdialog",...o,...l,ref:u,onOpenAutoFocus:Nt(l.onOpenAutoFocus,h=>{h.preventDefault(),m.current?.focus({preventScroll:!0})}),onPointerDownOutside:h=>h.preventDefault(),onInteractOutside:h=>h.preventDefault(),children:[e.jsx(q5,{children:r}),e.jsx(G5,{contentRef:d})]})})})});_E.displayName=ic;var ME="AlertDialogTitle",OE=p.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...r}=t,l=ji(s);return e.jsx(Ec,{...l,...r,ref:a})});OE.displayName=ME;var RE="AlertDialogDescription",IE=p.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...r}=t,l=ji(s);return e.jsx(Tc,{...l,...r,ref:a})});IE.displayName=RE;var F5="AlertDialogAction",zE=p.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...r}=t,l=ji(s);return e.jsx(Nu,{...l,...r,ref:a})});zE.displayName=F5;var LE="AlertDialogCancel",PE=p.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...r}=t,{cancelRef:l}=Y5(LE,s),o=ji(s),d=Sa(a,l);return e.jsx(Nu,{...o,...r,ref:d})});PE.displayName=LE;var G5=({contentRef:t})=>{const a=`\`${ic}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ic}\` by passing a \`${RE}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ic}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null},W5=TE,K5=DE,X5=kE,BE=AE,$E=_E,HE=zE,UE=PE,VE=OE,YE=IE;const Ir=W5,Ni=K5,Q5=X5,qE=p.forwardRef(({className:t,...a},s)=>e.jsx(BE,{className:he("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));qE.displayName=BE.displayName;const dr=p.forwardRef(({className:t,...a},s)=>e.jsxs(Q5,{children:[e.jsx(qE,{}),e.jsx($E,{ref:s,className:he("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a})]}));dr.displayName=$E.displayName;const ur=({className:t,...a})=>e.jsx("div",{className:he("flex flex-col space-y-2 text-center sm:text-left",t),...a});ur.displayName="AlertDialogHeader";const mr=({className:t,...a})=>e.jsx("div",{className:he("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});mr.displayName="AlertDialogFooter";const hr=p.forwardRef(({className:t,...a},s)=>e.jsx(VE,{ref:s,className:he("text-lg font-semibold",t),...a}));hr.displayName=VE.displayName;const fr=p.forwardRef(({className:t,...a},s)=>e.jsx(YE,{ref:s,className:he("text-sm text-muted-foreground",t),...a}));fr.displayName=YE.displayName;const pr=p.forwardRef(({className:t,...a},s)=>e.jsx(HE,{ref:s,className:he(gy(),t),...a}));pr.displayName=HE.displayName;const xr=p.forwardRef(({className:t,...a},s)=>e.jsx(UE,{ref:s,className:he(gy({variant:"outline"}),"mt-2 sm:mt-0",t),...a}));xr.displayName=UE.displayName;const Z5=t=>{const a=["bg-gradient-to-br from-blue-900 via-blue-950 to-slate-900","bg-gradient-to-br from-emerald-900 via-teal-900 to-slate-900","bg-gradient-to-br from-purple-900 via-indigo-900 to-slate-900","bg-gradient-to-br from-amber-900 via-orange-900 to-slate-900","bg-gradient-to-br from-rose-900 via-pink-900 to-slate-900","bg-gradient-to-br from-cyan-900 via-blue-900 to-slate-900","bg-gradient-to-br from-violet-900 via-purple-900 to-slate-900","bg-gradient-to-br from-teal-900 via-emerald-900 to-slate-900","bg-gradient-to-br from-indigo-900 via-blue-900 to-slate-900","bg-gradient-to-br from-green-900 via-emerald-900 to-slate-900"];return a[t%a.length]};function J5(){const{habitId:t}=Ss(),a=it(),s=gs(),r=new Date(s.state?.date||new Date),{completedHabits:l,toggleHabit:o}=Mf(r),[d,u]=p.useState([]),{formattedTime:m,isActive:h,isPaused:g,startTimer:x,pauseTimer:y,resumeTimer:v,stopTimer:b}=z5(),N=nn.find(F=>F.id===Number(t)),S=Ue(r),w=`${t}_${S}`,E=l[w]||!1,T=p.useMemo(()=>Z5(Number(t)),[t]),D=N?.steps||[],k=D.length;if(p.useEffect(()=>{d.length===0&&k>0&&u(new Array(k).fill(!1))},[d.length,k]),!N)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 text-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Hbito no encontrado"}),e.jsx(P,{onClick:()=>a(-1),variant:"outline",className:"text-white border-white hover:bg-white hover:text-gray-900",children:"Volver"})]})});const _=F=>{const G=[...d];G[F]=!G[F],u(G)},R=()=>{h?g?v():y():x()},L=async()=>{try{b(),await o(Number(t),S),a(-1)}catch(F){console.error("Error completing habit:",F)}},U=d.filter(Boolean).length,V=k>0?U/k*100:0;return e.jsx("div",{className:`min-h-screen flex flex-col ${T} text-white`,children:e.jsxs("div",{className:"flex-1 flex flex-col p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs(P,{variant:"ghost",className:"text-white hover:bg-white/20 text-lg font-semibold drop-shadow-lg px-6 py-3",onClick:()=>a(-1),children:[e.jsx(fl,{className:"w-5 h-5 mr-2"}),"Volver"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl font-mono font-bold drop-shadow-xl bg-black/30 px-6 py-3 rounded-lg backdrop-blur-sm border border-white/20",children:m}),e.jsx("div",{className:"mt-2",children:e.jsx(P,{onClick:R,className:"bg-white/20 hover:bg-white/30 text-white px-4 py-2 text-sm font-semibold backdrop-blur-sm",children:h?g?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),"Reanudar"]}):e.jsxs(e.Fragment,{children:[e.jsx(n1,{className:"w-4 h-4 mr-2"}),"Pausar"]}):e.jsxs(e.Fragment,{children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),"Iniciar"]})})})]})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-8xl mb-4",children:N.icon}),e.jsx("h1",{className:"text-4xl font-bold drop-shadow-xl mb-2",children:N.name}),e.jsx("p",{className:"text-xl text-white/80 drop-shadow-lg",children:N.goal})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"w-full bg-black/20 rounded-full h-3 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white h-3 rounded-full transition-all duration-300",style:{width:`${V}%`}})}),e.jsxs("div",{className:"text-center mt-2 text-white/80",children:[V.toFixed(0),"% completado"]})]}),k>0&&e.jsx("div",{className:"flex-1 mb-8",children:e.jsxs("div",{className:"bg-black/20 backdrop-blur-sm rounded-2xl p-6 mx-auto max-w-3xl",children:[e.jsx("h2",{className:"text-2xl font-semibold drop-shadow-lg mb-6 text-center",children:"Pasos a seguir"}),e.jsx("div",{className:"space-y-4",children:D.map((F,G)=>e.jsxs("div",{className:`flex items-center gap-4 p-4 rounded-lg transition-all duration-200 ${d[G]?"bg-green-500/20 border border-green-400/30":"bg-white/10 border border-white/20 hover:bg-white/20"}`,children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Va,{checked:d[G]||!1,onCheckedChange:()=>_(G),className:"scale-125"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-white/60 min-w-[60px]",children:["Paso ",G+1]}),e.jsx("p",{className:`text-lg font-medium drop-shadow-lg ${d[G]?"line-through text-white/70":"text-white"}`,children:F})]})})]},G))})]})}),e.jsx("div",{className:"mt-auto",children:e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsxs(P,{className:"w-full bg-green-600 hover:bg-green-700 text-white px-8 py-4 text-xl font-semibold shadow-xl drop-shadow-lg border border-green-500",children:[e.jsx(xi,{className:"w-6 h-6 mr-3"}),E?"Hbito Completado":"Completar Hbito"]})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:E?"Desmarcar Hbito":"Completar Hbito"}),e.jsx(fr,{children:E?"Ests seguro de que quieres desmarcar este hbito como completado?":"Ests seguro de que quieres marcar este hbito como completado?"})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"Cancelar"}),e.jsx(pr,{onClick:L,className:"bg-green-600 hover:bg-green-700",children:E?"S, desmarcar":"S, completar"})]})]})]})})]})})}const Mt=pf,FE=xf,eI=ff,GE=p.forwardRef(({className:t,...a},s)=>e.jsx(Sc,{ref:s,className:he("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a}));GE.displayName=Sc.displayName;const Tt=p.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(eI,{children:[e.jsx(GE,{}),e.jsxs(Cc,{ref:r,className:he("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,"aria-describedby":s["aria-describedby"],children:[a,e.jsxs(Nu,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Fa,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Tt.displayName=Cc.displayName;const Ot=({className:t,...a})=>e.jsx("div",{className:he("flex flex-col space-y-1.5 text-center sm:text-left",t),...a});Ot.displayName="DialogHeader";const Cs=({className:t,...a})=>e.jsx("div",{className:he("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});Cs.displayName="DialogFooter";const Rt=p.forwardRef(({className:t,...a},s)=>e.jsx(Ec,{ref:s,className:he("text-lg font-semibold leading-none tracking-tight",t),...a}));Rt.displayName=Ec.displayName;const Ms=p.forwardRef(({className:t,...a},s)=>e.jsx(Tc,{ref:s,className:he("text-sm text-muted-foreground",t),...a}));Ms.displayName=Tc.displayName;function y0(t,[a,s]){return Math.min(s,Math.max(a,t))}function tI(t){const a=aI(t),s=p.forwardRef((r,l)=>{const{children:o,...d}=r,u=p.Children.toArray(o),m=u.find(nI);if(m){const h=m.props.children,g=u.map(x=>x===m?p.Children.count(h)>1?p.Children.only(null):p.isValidElement(h)?h.props.children:null:x);return e.jsx(a,{...d,ref:l,children:p.isValidElement(h)?p.cloneElement(h,void 0,g):null})}return e.jsx(a,{...d,ref:l,children:o})});return s.displayName=`${t}.Slot`,s}function aI(t){const a=p.forwardRef((s,r)=>{const{children:l,...o}=s;if(p.isValidElement(l)){const d=iI(l),u=rI(o,l.props);return l.type!==p.Fragment&&(u.ref=r?W0(r,d):d),p.cloneElement(l,u)}return p.Children.count(l)>1?p.Children.only(null):null});return a.displayName=`${t}.SlotClone`,a}var sI=Symbol("radix.slottable");function nI(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===sI}function rI(t,a){const s={...a};for(const r in a){const l=t[r],o=a[r];/^on[A-Z]/.test(r)?l&&o?s[r]=(...u)=>{const m=o(...u);return l(...u),m}:l&&(s[r]=l):r==="style"?s[r]={...l,...o}:r==="className"&&(s[r]=[l,o].filter(Boolean).join(" "))}return{...t,...s}}function iI(t){let a=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=a&&"isReactWarning"in a&&a.isReactWarning;return s?t.ref:(a=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=a&&"isReactWarning"in a&&a.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var lI=[" ","Enter","ArrowUp","ArrowDown"],oI=[" ","Enter"],oo="Select",[Of,Rf,cI]=dM(oo),[Ic,_7]=vi(oo,[cI,Nc]),If=Nc(),[dI,yl]=Ic(oo),[uI,mI]=Ic(oo),WE=t=>{const{__scopeSelect:a,children:s,open:r,defaultOpen:l,onOpenChange:o,value:d,defaultValue:u,onValueChange:m,dir:h,name:g,autoComplete:x,disabled:y,required:v,form:b}=t,N=If(a),[S,w]=p.useState(null),[E,T]=p.useState(null),[D,k]=p.useState(!1),_=gf(h),[R,L]=Mr({prop:r,defaultProp:l??!1,onChange:o,caller:oo}),[U,V]=Mr({prop:d,defaultProp:u,onChange:m,caller:oo}),F=p.useRef(null),G=S?b||!!S.closest("form"):!0,[$,z]=p.useState(new Set),H=Array.from($).map(I=>I.props.value).join(";");return e.jsx(Q0,{...N,children:e.jsxs(dI,{required:v,scope:a,trigger:S,onTriggerChange:w,valueNode:E,onValueNodeChange:T,valueNodeHasChildren:D,onValueNodeHasChildrenChange:k,contentId:wc(),value:U,onValueChange:V,open:R,onOpenChange:L,dir:_,triggerPointerDownPosRef:F,disabled:y,children:[e.jsx(Of.Provider,{scope:a,children:e.jsx(uI,{scope:t.__scopeSelect,onNativeOptionAdd:p.useCallback(I=>{z(O=>new Set(O).add(I))},[]),onNativeOptionRemove:p.useCallback(I=>{z(O=>{const Y=new Set(O);return Y.delete(I),Y})},[]),children:s})}),G?e.jsxs(yT,{"aria-hidden":!0,required:v,tabIndex:-1,name:g,autoComplete:x,value:U,onChange:I=>V(I.target.value),disabled:y,form:b,children:[U===void 0?e.jsx("option",{value:""}):null,Array.from($)]},H):null]})})};WE.displayName=oo;var KE="SelectTrigger",XE=p.forwardRef((t,a)=>{const{__scopeSelect:s,disabled:r=!1,...l}=t,o=If(s),d=yl(KE,s),u=d.disabled||r,m=Sa(a,d.onTriggerChange),h=Rf(s),g=p.useRef("touch"),[x,y,v]=bT(N=>{const S=h().filter(T=>!T.disabled),w=S.find(T=>T.value===d.value),E=jT(S,N,w);E!==void 0&&d.onValueChange(E.value)}),b=N=>{u||(d.onOpenChange(!0),v()),N&&(d.triggerPointerDownPosRef.current={x:Math.round(N.pageX),y:Math.round(N.pageY)})};return e.jsx(hf,{asChild:!0,...o,children:e.jsx(Gt.button,{type:"button",role:"combobox","aria-controls":d.contentId,"aria-expanded":d.open,"aria-required":d.required,"aria-autocomplete":"none",dir:d.dir,"data-state":d.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":vT(d.value)?"":void 0,...l,ref:m,onClick:Nt(l.onClick,N=>{N.currentTarget.focus(),g.current!=="mouse"&&b(N)}),onPointerDown:Nt(l.onPointerDown,N=>{g.current=N.pointerType;const S=N.target;S.hasPointerCapture(N.pointerId)&&S.releasePointerCapture(N.pointerId),N.button===0&&N.ctrlKey===!1&&N.pointerType==="mouse"&&(b(N),N.preventDefault())}),onKeyDown:Nt(l.onKeyDown,N=>{const S=x.current!=="";!(N.ctrlKey||N.altKey||N.metaKey)&&N.key.length===1&&y(N.key),!(S&&N.key===" ")&&lI.includes(N.key)&&(b(),N.preventDefault())})})})});XE.displayName=KE;var QE="SelectValue",ZE=p.forwardRef((t,a)=>{const{__scopeSelect:s,className:r,style:l,children:o,placeholder:d="",...u}=t,m=yl(QE,s),{onValueNodeHasChildrenChange:h}=m,g=o!==void 0,x=Sa(a,m.onValueNodeChange);return fi(()=>{h(g)},[h,g]),e.jsx(Gt.span,{...u,ref:x,style:{pointerEvents:"none"},children:vT(m.value)?e.jsx(e.Fragment,{children:d}):o})});ZE.displayName=QE;var hI="SelectIcon",JE=p.forwardRef((t,a)=>{const{__scopeSelect:s,children:r,...l}=t;return e.jsx(Gt.span,{"aria-hidden":!0,...l,ref:a,children:r||""})});JE.displayName=hI;var fI="SelectPortal",eT=t=>e.jsx(IC,{asChild:!0,...t});eT.displayName=fI;var co="SelectContent",tT=p.forwardRef((t,a)=>{const s=yl(co,t.__scopeSelect),[r,l]=p.useState();if(fi(()=>{l(new DocumentFragment)},[]),!s.open){const o=r;return o?Wl.createPortal(e.jsx(aT,{scope:t.__scopeSelect,children:e.jsx(Of.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),o):null}return e.jsx(sT,{...t,ref:a})});tT.displayName=co;var Qn=10,[aT,vl]=Ic(co),pI="SelectContentImpl",xI=tI("SelectContent.RemoveScroll"),sT=p.forwardRef((t,a)=>{const{__scopeSelect:s,position:r="item-aligned",onCloseAutoFocus:l,onEscapeKeyDown:o,onPointerDownOutside:d,side:u,sideOffset:m,align:h,alignOffset:g,arrowPadding:x,collisionBoundary:y,collisionPadding:v,sticky:b,hideWhenDetached:N,avoidCollisions:S,...w}=t,E=yl(co,s),[T,D]=p.useState(null),[k,_]=p.useState(null),R=Sa(a,K=>D(K)),[L,U]=p.useState(null),[V,F]=p.useState(null),G=Rf(s),[$,z]=p.useState(!1),H=p.useRef(!1);p.useEffect(()=>{if(T)return zC(T)},[T]),LC();const I=p.useCallback(K=>{const[oe,..._e]=G().map(ge=>ge.ref.current),[je]=_e.slice(-1),Ie=document.activeElement;for(const ge of K)if(ge===Ie||(ge?.scrollIntoView({block:"nearest"}),ge===oe&&k&&(k.scrollTop=0),ge===je&&k&&(k.scrollTop=k.scrollHeight),ge?.focus(),document.activeElement!==Ie))return},[G,k]),O=p.useCallback(()=>I([L,T]),[I,L,T]);p.useEffect(()=>{$&&O()},[$,O]);const{onOpenChange:Y,triggerPointerDownPosRef:le}=E;p.useEffect(()=>{if(T){let K={x:0,y:0};const oe=je=>{K={x:Math.abs(Math.round(je.pageX)-(le.current?.x??0)),y:Math.abs(Math.round(je.pageY)-(le.current?.y??0))}},_e=je=>{K.x<=10&&K.y<=10?je.preventDefault():T.contains(je.target)||Y(!1),document.removeEventListener("pointermove",oe),le.current=null};return le.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",_e,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",_e,{capture:!0})}}},[T,Y,le]),p.useEffect(()=>{const K=()=>Y(!1);return window.addEventListener("blur",K),window.addEventListener("resize",K),()=>{window.removeEventListener("blur",K),window.removeEventListener("resize",K)}},[Y]);const[re,Q]=bT(K=>{const oe=G().filter(Ie=>!Ie.disabled),_e=oe.find(Ie=>Ie.ref.current===document.activeElement),je=jT(oe,K,_e);je&&setTimeout(()=>je.ref.current.focus())}),q=p.useCallback((K,oe,_e)=>{const je=!H.current&&!_e;(E.value!==void 0&&E.value===oe||je)&&(U(K),je&&(H.current=!0))},[E.value]),M=p.useCallback(()=>T?.focus(),[T]),W=p.useCallback((K,oe,_e)=>{const je=!H.current&&!_e;(E.value!==void 0&&E.value===oe||je)&&F(K)},[E.value]),ie=r==="popper"?v0:nT,ve=ie===v0?{side:u,sideOffset:m,align:h,alignOffset:g,arrowPadding:x,collisionBoundary:y,collisionPadding:v,sticky:b,hideWhenDetached:N,avoidCollisions:S}:{};return e.jsx(aT,{scope:s,content:T,viewport:k,onViewportChange:_,itemRefCallback:q,selectedItem:L,onItemLeave:M,itemTextRefCallback:W,focusSelectedItem:O,selectedItemText:V,position:r,isPositioned:$,searchRef:re,children:e.jsx(PC,{as:xI,allowPinchZoom:!0,children:e.jsx(BC,{asChild:!0,trapped:E.open,onMountAutoFocus:K=>{K.preventDefault()},onUnmountAutoFocus:Nt(l,K=>{E.trigger?.focus({preventScroll:!0}),K.preventDefault()}),children:e.jsx(K0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:d,onFocusOutside:K=>K.preventDefault(),onDismiss:()=>E.onOpenChange(!1),children:e.jsx(ie,{role:"listbox",id:E.contentId,"data-state":E.open?"open":"closed",dir:E.dir,onContextMenu:K=>K.preventDefault(),...w,...ve,onPlaced:()=>z(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:Nt(w.onKeyDown,K=>{const oe=K.ctrlKey||K.altKey||K.metaKey;if(K.key==="Tab"&&K.preventDefault(),!oe&&K.key.length===1&&Q(K.key),["ArrowUp","ArrowDown","Home","End"].includes(K.key)){let je=G().filter(Ie=>!Ie.disabled).map(Ie=>Ie.ref.current);if(["ArrowUp","End"].includes(K.key)&&(je=je.slice().reverse()),["ArrowUp","ArrowDown"].includes(K.key)){const Ie=K.target,ge=je.indexOf(Ie);je=je.slice(ge+1)}setTimeout(()=>I(je)),K.preventDefault()}})})})})})})});sT.displayName=pI;var gI="SelectItemAlignedPosition",nT=p.forwardRef((t,a)=>{const{__scopeSelect:s,onPlaced:r,...l}=t,o=yl(co,s),d=vl(co,s),[u,m]=p.useState(null),[h,g]=p.useState(null),x=Sa(a,R=>g(R)),y=Rf(s),v=p.useRef(!1),b=p.useRef(!0),{viewport:N,selectedItem:S,selectedItemText:w,focusSelectedItem:E}=d,T=p.useCallback(()=>{if(o.trigger&&o.valueNode&&u&&h&&N&&S&&w){const R=o.trigger.getBoundingClientRect(),L=h.getBoundingClientRect(),U=o.valueNode.getBoundingClientRect(),V=w.getBoundingClientRect();if(o.dir!=="rtl"){const Ie=V.left-L.left,ge=U.left-Ie,Be=R.left-ge,ke=R.width+Be,gt=Math.max(ke,L.width),Dt=window.innerWidth-Qn,kt=y0(ge,[Qn,Math.max(Qn,Dt-gt)]);u.style.minWidth=ke+"px",u.style.left=kt+"px"}else{const Ie=L.right-V.right,ge=window.innerWidth-U.right-Ie,Be=window.innerWidth-R.right-ge,ke=R.width+Be,gt=Math.max(ke,L.width),Dt=window.innerWidth-Qn,kt=y0(ge,[Qn,Math.max(Qn,Dt-gt)]);u.style.minWidth=ke+"px",u.style.right=kt+"px"}const F=y(),G=window.innerHeight-Qn*2,$=N.scrollHeight,z=window.getComputedStyle(h),H=parseInt(z.borderTopWidth,10),I=parseInt(z.paddingTop,10),O=parseInt(z.borderBottomWidth,10),Y=parseInt(z.paddingBottom,10),le=H+I+$+Y+O,re=Math.min(S.offsetHeight*5,le),Q=window.getComputedStyle(N),q=parseInt(Q.paddingTop,10),M=parseInt(Q.paddingBottom,10),W=R.top+R.height/2-Qn,ie=G-W,ve=S.offsetHeight/2,K=S.offsetTop+ve,oe=H+I+K,_e=le-oe;if(oe<=W){const Ie=F.length>0&&S===F[F.length-1].ref.current;u.style.bottom="0px";const ge=h.clientHeight-N.offsetTop-N.offsetHeight,Be=Math.max(ie,ve+(Ie?M:0)+ge+O),ke=oe+Be;u.style.height=ke+"px"}else{const Ie=F.length>0&&S===F[0].ref.current;u.style.top="0px";const Be=Math.max(W,H+N.offsetTop+(Ie?q:0)+ve)+_e;u.style.height=Be+"px",N.scrollTop=oe-W+N.offsetTop}u.style.margin=`${Qn}px 0`,u.style.minHeight=re+"px",u.style.maxHeight=G+"px",r?.(),requestAnimationFrame(()=>v.current=!0)}},[y,o.trigger,o.valueNode,u,h,N,S,w,o.dir,r]);fi(()=>T(),[T]);const[D,k]=p.useState();fi(()=>{h&&k(window.getComputedStyle(h).zIndex)},[h]);const _=p.useCallback(R=>{R&&b.current===!0&&(T(),E?.(),b.current=!1)},[T,E]);return e.jsx(vI,{scope:s,contentWrapper:u,shouldExpandOnScrollRef:v,onScrollButtonChange:_,children:e.jsx("div",{ref:m,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:D},children:e.jsx(Gt.div,{...l,ref:x,style:{boxSizing:"border-box",maxHeight:"100%",...l.style}})})})});nT.displayName=gI;var yI="SelectPopperPosition",v0=p.forwardRef((t,a)=>{const{__scopeSelect:s,align:r="start",collisionPadding:l=Qn,...o}=t,d=If(s);return e.jsx(X0,{...d,...o,ref:a,align:r,collisionPadding:l,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});v0.displayName=yI;var[vI,Sy]=Ic(co,{}),b0="SelectViewport",rT=p.forwardRef((t,a)=>{const{__scopeSelect:s,nonce:r,...l}=t,o=vl(b0,s),d=Sy(b0,s),u=Sa(a,o.onViewportChange),m=p.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),e.jsx(Of.Slot,{scope:s,children:e.jsx(Gt.div,{"data-radix-select-viewport":"",role:"presentation",...l,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...l.style},onScroll:Nt(l.onScroll,h=>{const g=h.currentTarget,{contentWrapper:x,shouldExpandOnScrollRef:y}=d;if(y?.current&&x){const v=Math.abs(m.current-g.scrollTop);if(v>0){const b=window.innerHeight-Qn*2,N=parseFloat(x.style.minHeight),S=parseFloat(x.style.height),w=Math.max(N,S);if(w<b){const E=w+v,T=Math.min(b,E),D=E-T;x.style.height=T+"px",x.style.bottom==="0px"&&(g.scrollTop=D>0?D:0,x.style.justifyContent="flex-end")}}}m.current=g.scrollTop})})})]})});rT.displayName=b0;var iT="SelectGroup",[bI,jI]=Ic(iT),NI=p.forwardRef((t,a)=>{const{__scopeSelect:s,...r}=t,l=wc();return e.jsx(bI,{scope:s,id:l,children:e.jsx(Gt.div,{role:"group","aria-labelledby":l,...r,ref:a})})});NI.displayName=iT;var lT="SelectLabel",oT=p.forwardRef((t,a)=>{const{__scopeSelect:s,...r}=t,l=jI(lT,s);return e.jsx(Gt.div,{id:l.id,...r,ref:a})});oT.displayName=lT;var Uh="SelectItem",[wI,cT]=Ic(Uh),dT=p.forwardRef((t,a)=>{const{__scopeSelect:s,value:r,disabled:l=!1,textValue:o,...d}=t,u=yl(Uh,s),m=vl(Uh,s),h=u.value===r,[g,x]=p.useState(o??""),[y,v]=p.useState(!1),b=Sa(a,E=>m.itemRefCallback?.(E,r,l)),N=wc(),S=p.useRef("touch"),w=()=>{l||(u.onValueChange(r),u.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(wI,{scope:s,value:r,disabled:l,textId:N,isSelected:h,onItemTextChange:p.useCallback(E=>{x(T=>T||(E?.textContent??"").trim())},[]),children:e.jsx(Of.ItemSlot,{scope:s,value:r,disabled:l,textValue:g,children:e.jsx(Gt.div,{role:"option","aria-labelledby":N,"data-highlighted":y?"":void 0,"aria-selected":h&&y,"data-state":h?"checked":"unchecked","aria-disabled":l||void 0,"data-disabled":l?"":void 0,tabIndex:l?void 0:-1,...d,ref:b,onFocus:Nt(d.onFocus,()=>v(!0)),onBlur:Nt(d.onBlur,()=>v(!1)),onClick:Nt(d.onClick,()=>{S.current!=="mouse"&&w()}),onPointerUp:Nt(d.onPointerUp,()=>{S.current==="mouse"&&w()}),onPointerDown:Nt(d.onPointerDown,E=>{S.current=E.pointerType}),onPointerMove:Nt(d.onPointerMove,E=>{S.current=E.pointerType,l?m.onItemLeave?.():S.current==="mouse"&&E.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Nt(d.onPointerLeave,E=>{E.currentTarget===document.activeElement&&m.onItemLeave?.()}),onKeyDown:Nt(d.onKeyDown,E=>{m.searchRef?.current!==""&&E.key===" "||(oI.includes(E.key)&&w(),E.key===" "&&E.preventDefault())})})})})});dT.displayName=Uh;var Xd="SelectItemText",uT=p.forwardRef((t,a)=>{const{__scopeSelect:s,className:r,style:l,...o}=t,d=yl(Xd,s),u=vl(Xd,s),m=cT(Xd,s),h=mI(Xd,s),[g,x]=p.useState(null),y=Sa(a,w=>x(w),m.onItemTextChange,w=>u.itemTextRefCallback?.(w,m.value,m.disabled)),v=g?.textContent,b=p.useMemo(()=>e.jsx("option",{value:m.value,disabled:m.disabled,children:v},m.value),[m.disabled,m.value,v]),{onNativeOptionAdd:N,onNativeOptionRemove:S}=h;return fi(()=>(N(b),()=>S(b)),[N,S,b]),e.jsxs(e.Fragment,{children:[e.jsx(Gt.span,{id:m.textId,...o,ref:y}),m.isSelected&&d.valueNode&&!d.valueNodeHasChildren?Wl.createPortal(o.children,d.valueNode):null]})});uT.displayName=Xd;var mT="SelectItemIndicator",hT=p.forwardRef((t,a)=>{const{__scopeSelect:s,...r}=t;return cT(mT,s).isSelected?e.jsx(Gt.span,{"aria-hidden":!0,...r,ref:a}):null});hT.displayName=mT;var j0="SelectScrollUpButton",fT=p.forwardRef((t,a)=>{const s=vl(j0,t.__scopeSelect),r=Sy(j0,t.__scopeSelect),[l,o]=p.useState(!1),d=Sa(a,r.onScrollButtonChange);return fi(()=>{if(s.viewport&&s.isPositioned){let u=function(){const h=m.scrollTop>0;o(h)};const m=s.viewport;return u(),m.addEventListener("scroll",u),()=>m.removeEventListener("scroll",u)}},[s.viewport,s.isPositioned]),l?e.jsx(xT,{...t,ref:d,onAutoScroll:()=>{const{viewport:u,selectedItem:m}=s;u&&m&&(u.scrollTop=u.scrollTop-m.offsetHeight)}}):null});fT.displayName=j0;var N0="SelectScrollDownButton",pT=p.forwardRef((t,a)=>{const s=vl(N0,t.__scopeSelect),r=Sy(N0,t.__scopeSelect),[l,o]=p.useState(!1),d=Sa(a,r.onScrollButtonChange);return fi(()=>{if(s.viewport&&s.isPositioned){let u=function(){const h=m.scrollHeight-m.clientHeight,g=Math.ceil(m.scrollTop)<h;o(g)};const m=s.viewport;return u(),m.addEventListener("scroll",u),()=>m.removeEventListener("scroll",u)}},[s.viewport,s.isPositioned]),l?e.jsx(xT,{...t,ref:d,onAutoScroll:()=>{const{viewport:u,selectedItem:m}=s;u&&m&&(u.scrollTop=u.scrollTop+m.offsetHeight)}}):null});pT.displayName=N0;var xT=p.forwardRef((t,a)=>{const{__scopeSelect:s,onAutoScroll:r,...l}=t,o=vl("SelectScrollButton",s),d=p.useRef(null),u=Rf(s),m=p.useCallback(()=>{d.current!==null&&(window.clearInterval(d.current),d.current=null)},[]);return p.useEffect(()=>()=>m(),[m]),fi(()=>{u().find(g=>g.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[u]),e.jsx(Gt.div,{"aria-hidden":!0,...l,ref:a,style:{flexShrink:0,...l.style},onPointerDown:Nt(l.onPointerDown,()=>{d.current===null&&(d.current=window.setInterval(r,50))}),onPointerMove:Nt(l.onPointerMove,()=>{o.onItemLeave?.(),d.current===null&&(d.current=window.setInterval(r,50))}),onPointerLeave:Nt(l.onPointerLeave,()=>{m()})})}),SI="SelectSeparator",gT=p.forwardRef((t,a)=>{const{__scopeSelect:s,...r}=t;return e.jsx(Gt.div,{"aria-hidden":!0,...r,ref:a})});gT.displayName=SI;var w0="SelectArrow",CI=p.forwardRef((t,a)=>{const{__scopeSelect:s,...r}=t,l=If(s),o=yl(w0,s),d=vl(w0,s);return o.open&&d.position==="popper"?e.jsx(Z0,{...l,...r,ref:a}):null});CI.displayName=w0;var EI="SelectBubbleInput",yT=p.forwardRef(({__scopeSelect:t,value:a,...s},r)=>{const l=p.useRef(null),o=Sa(r,l),d=by(a);return p.useEffect(()=>{const u=l.current;if(!u)return;const m=window.HTMLSelectElement.prototype,g=Object.getOwnPropertyDescriptor(m,"value").set;if(d!==a&&g){const x=new Event("change",{bubbles:!0});g.call(u,a),u.dispatchEvent(x)}},[d,a]),e.jsx(Gt.select,{...s,style:{...eE,...s.style},ref:o,defaultValue:a})});yT.displayName=EI;function vT(t){return t===""||t===void 0}function bT(t){const a=nl(t),s=p.useRef(""),r=p.useRef(0),l=p.useCallback(d=>{const u=s.current+d;a(u),(function m(h){s.current=h,window.clearTimeout(r.current),h!==""&&(r.current=window.setTimeout(()=>m(""),1e3))})(u)},[a]),o=p.useCallback(()=>{s.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[s,l,o]}function jT(t,a,s){const l=a.length>1&&Array.from(a).every(h=>h===a[0])?a[0]:a,o=s?t.indexOf(s):-1;let d=TI(t,Math.max(o,0));l.length===1&&(d=d.filter(h=>h!==s));const m=d.find(h=>h.textValue.toLowerCase().startsWith(l.toLowerCase()));return m!==s?m:void 0}function TI(t,a){return t.map((s,r)=>t[(a+r)%t.length])}var DI=WE,NT=XE,kI=ZE,AI=JE,_I=eT,wT=tT,MI=rT,ST=oT,CT=dT,OI=uT,RI=hT,ET=fT,TT=pT,DT=gT;const yt=DI,vt=kI,ft=p.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(NT,{ref:r,className:he("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[a,e.jsx(AI,{asChild:!0,children:e.jsx(rn,{className:"h-4 w-4 opacity-50"})})]}));ft.displayName=NT.displayName;const kT=p.forwardRef(({className:t,...a},s)=>e.jsx(ET,{ref:s,className:he("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(jf,{className:"h-4 w-4"})}));kT.displayName=ET.displayName;const AT=p.forwardRef(({className:t,...a},s)=>e.jsx(TT,{ref:s,className:he("flex cursor-default items-center justify-center py-1",t),...a,children:e.jsx(rn,{className:"h-4 w-4"})}));AT.displayName=TT.displayName;const pt=p.forwardRef(({className:t,children:a,position:s="popper",...r},l)=>e.jsx(_I,{children:e.jsxs(wT,{ref:l,className:he("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...r,children:[e.jsx(kT,{}),e.jsx(MI,{className:he("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),e.jsx(AT,{})]})}));pt.displayName=wT.displayName;const II=p.forwardRef(({className:t,...a},s)=>e.jsx(ST,{ref:s,className:he("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a}));II.displayName=ST.displayName;const Le=p.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(CT,{ref:r,className:he("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(RI,{children:e.jsx(cr,{className:"h-4 w-4"})})}),e.jsx(OI,{children:a})]}));Le.displayName=CT.displayName;const zI=p.forwardRef(({className:t,...a},s)=>e.jsx(DT,{ref:s,className:he("-mx-1 my-1 h-px bg-muted",t),...a}));zI.displayName=DT.displayName;class ih{static client=ze;static table(a){return ze.from(a)}}const bl=()=>{const{user:t}=st(),[a,s]=p.useState([]),[r,l]=p.useState("idle"),[o,d]=p.useState(null),u=p.useCallback(async()=>{if(!t){s([]);return}l("loading"),d(null);try{const{data:y,error:v}=await ih.table("shopping_items").select("*").eq("user_id",t.id);if(v)throw v;if(!y||y.length===0){s([]),l("idle");return}const b=y.map(N=>({id:N.id,name:N.name||"",stock:N.stock||0,toBuy:N.to_buy||0,status:N.status||"to-buy",...N.price!==void 0&&{price:N.price},...N.category&&{category:N.category},...N.place&&{place:N.place},...N.consume_by&&{consumeBy:N.consume_by},...N.next_purchase&&{nextPurchase:N.next_purchase},...N.barcode&&{barcode:N.barcode},unit:N.unit||"units"}));s(b),l("idle")}catch(y){d(y instanceof Error?y.message:"Error al cargar"),l("error"),s([])}},[t]);p.useEffect(()=>{u()},[u]);const m=async y=>{if(!t){d("Usuario no autenticado");return}l("saving"),d(null);try{const v=a.find(S=>S.name.toLowerCase()===y.name.toLowerCase());if(v){const S=v.stock+Number(y.stock);v.status==="low-stock"?await h(v.id,{stock:S}):v.status==="to-buy"?await h(v.id,{stock:S,status:"in-stock"}):await h(v.id,{stock:S}),l("idle");return}const b={user_id:t.id,name:y.name,stock:Number(y.stock),to_buy:Number(y.toBuy),status:y.status,unit:y.unit||"units",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};y.price!==void 0&&y.price!==null&&!isNaN(Number(y.price))&&(b.price=Number(y.price)),y.category&&typeof y.category=="string"&&y.category.trim()!==""&&(b.category=y.category.trim()),y.place&&typeof y.place=="string"&&y.place.trim()!==""&&(b.place=y.place.trim()),y.consumeBy&&typeof y.consumeBy=="string"&&y.consumeBy.trim()!==""&&(b.consume_by=y.consumeBy.trim()),y.nextPurchase&&(b.next_purchase=!0),y.barcode&&typeof y.barcode=="string"&&y.barcode.trim()!==""&&(b.barcode=y.barcode.trim());const{error:N}=await ih.table("shopping_items").insert(b);if(N)throw N;await u(),l("idle")}catch(v){const b=v instanceof Error?v.message:"Error al guardar";d(b),l("error")}},h=async(y,v)=>{if(!t){d("Usuario no autenticado");return}s(b=>b.map(N=>N.id===y?{...N,...v}:N)),l("saving"),d(null);try{const b={updated_at:new Date().toISOString()};v.name!==void 0&&(b.name=v.name),v.stock!==void 0&&(b.stock=Number(v.stock)),v.toBuy!==void 0&&(b.to_buy=Number(v.toBuy)),v.status!==void 0&&(b.status=v.status),v.price!==void 0&&(v.price===null||isNaN(Number(v.price))?b.price=null:b.price=Number(v.price)),v.category!==void 0&&(typeof v.category=="string"&&v.category.trim()!==""?b.category=v.category.trim():b.category=null),v.place!==void 0&&(typeof v.place=="string"&&v.place.trim()!==""?b.place=v.place.trim():b.place=null),v.consumeBy!==void 0&&(typeof v.consumeBy=="string"&&v.consumeBy.trim()!==""?b.consume_by=v.consumeBy.trim():b.consume_by=null),v.nextPurchase!==void 0&&(b.next_purchase=v.nextPurchase),v.unit!==void 0&&(b.unit=v.unit),v.barcode!==void 0&&(typeof v.barcode=="string"&&v.barcode.trim()!==""?b.barcode=v.barcode.trim():b.barcode=null);const{error:N}=await ih.table("shopping_items").update(b).eq("id",y);if(N)throw N;l("idle")}catch(b){await u();const N=b instanceof Error?b.message:"Error al actualizar";d(N),l("error")}};return{items:a,status:r,error:o,addItem:m,updateItem:h,deleteItem:async y=>{if(!t){d("Usuario no autenticado");return}const v=a;s(b=>b.filter(N=>N.id!==y)),l("saving"),d(null);try{const{error:b}=await ih.table("shopping_items").delete().eq("id",y);if(b)throw b;l("idle")}catch(b){s(v);const N=b instanceof Error?b.message:"Error al eliminar";d(N),l("error")}},moveItem:(y,v)=>{const b=a.find(S=>S.id===y);if(!b)return;const N={status:v};v==="in-stock"&&b.toBuy>0&&(N.stock=b.stock+b.toBuy,N.toBuy=0),v==="low-stock"&&b.toBuy>0&&(N.stock=b.stock+b.toBuy,N.toBuy=0),v==="to-buy"&&b.status==="in-stock"&&b.toBuy===0&&(N.toBuy=Math.max(1,b.stock),N.stock=0),v==="low-stock"&&b.status==="to-buy"&&(b.toBuy>0&&b.stock===0?(N.stock=b.toBuy,N.toBuy=0):b.stock===0&&(N.stock=1)),h(y,N)},loadShoppingList:u}},LI=({onComplete:t}={})=>{const[a,s]=p.useState(null),[r,l]=p.useState(0),[o,d]=p.useState(!1),[u,m]=p.useState(!1),h=p.useRef(null);p.useEffect(()=>(o&&!u&&a?h.current=window.setInterval(()=>{l(Date.now()-a)},1e3):h.current&&(window.clearInterval(h.current),h.current=null),()=>{h.current&&window.clearInterval(h.current)}),[o,u,a]);const g=S=>{const w=Math.floor(S/1e3),E=Math.floor(w/3600),T=Math.floor(w%3600/60),D=w%60;return E>0?`${E.toString().padStart(2,"0")}:${T.toString().padStart(2,"0")}:${D.toString().padStart(2,"0")}`:`${T.toString().padStart(2,"0")}:${D.toString().padStart(2,"0")}`},x=()=>{const S=Date.now();s(S),l(0),d(!0),m(!1)},y=()=>{m(!0)},v=()=>{if(a){const S=Date.now();s(S-r),m(!1)}},b=()=>{d(!1),m(!1),s(null),l(0)},N=()=>{b(),t?.()};return{formattedTime:g(r),elapsedTime:r,isActive:o,isPaused:u,startTimer:x,pauseTimer:y,resumeTimer:v,stopTimer:b,completeSession:N}},Vh=["xito","D1","Ara","Dollarcity","Olimpica (SAO)","Jumbo","Plaza de mercado","Panadera","Droguera","Otro"],PI={units:"u",grams:"g",milliliters:"ml"},BI=t=>{const a=["bg-gradient-to-br from-slate-800 via-slate-900 to-black","bg-gradient-to-br from-blue-900 via-blue-950 to-slate-900","bg-gradient-to-br from-indigo-900 via-purple-900 to-slate-900","bg-gradient-to-br from-emerald-900 via-teal-900 to-slate-900","bg-gradient-to-br from-purple-900 via-indigo-900 to-slate-900","bg-gradient-to-br from-teal-900 via-cyan-900 to-slate-900","bg-gradient-to-br from-gray-900 via-slate-900 to-zinc-900","bg-gradient-to-br from-orange-900 via-red-900 to-slate-900"],r=t.split("").reduce((l,o)=>l+o.charCodeAt(0),0)%a.length;return a[r]};function $I(){const t=it(),{items:a,updateItem:s}=bl(),[r,l]=p.useState(""),[o,d]=p.useState(!0),[u,m]=p.useState([]),[h,g]=p.useState(!1),{formattedTime:x,isActive:y,isPaused:v,startTimer:b,pauseTimer:N,resumeTimer:S,stopTimer:w,completeSession:E}=LI({onComplete:()=>t(-1)}),T=p.useMemo(()=>r?a.filter(G=>G.place===r&&G.toBuy>0).map(G=>({...G,purchased:!1})):[],[a,r]);p.useEffect(()=>{m(T)},[T]);const D=p.useMemo(()=>{const G=u.reduce((H,I)=>I.price?H+I.price*I.toBuy:H,0),$=u.reduce((H,I)=>I.purchased&&I.price?H+I.price*I.toBuy:H,0),z=u.reduce((H,I)=>!I.purchased&&I.price?H+I.price*I.toBuy:H,0);return{totalEstimated:G,totalPurchased:$,totalRemaining:z}},[u]),k=p.useMemo(()=>BI(r),[r]),_=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}),R=G=>{l(G),d(!1),b()},L=G=>{m($=>$.map(z=>z.id===G?{...z,purchased:!z.purchased}:z))},U=G=>{m($=>$.map(z=>({...z,purchased:G})))},V=async()=>{const G=u.filter($=>$.purchased);if(G.length!==0){g(!0);try{await Promise.all(G.map($=>s($.id,{stock:$.stock+$.toBuy,toBuy:0,status:"in-stock"}))),m($=>$.map(z=>z.purchased?{...z,stock:z.stock+z.toBuy,toBuy:0,status:"in-stock"}:z))}finally{g(!1)}}},F=async()=>{await V(),E()};return o?e.jsx(Mt,{open:o,onOpenChange:d,children:e.jsxs(Tt,{className:"sm:max-w-md",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"En qu tienda vas a comprar?"})}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs(yt,{onValueChange:R,children:[e.jsx(ft,{children:e.jsx(vt,{placeholder:"Selecciona una tienda"})}),e.jsx(pt,{children:Vh.map(G=>e.jsx(Le,{value:G,children:G},G))})]})}),e.jsx(Cs,{children:e.jsx(P,{variant:"outline",onClick:()=>t(-1),children:"Cancelar"})})]})}):u.length===0?e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-900 text-white p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(lr,{className:"w-16 h-16 mx-auto text-gray-400"}),e.jsx("h1",{className:"text-3xl font-bold",children:"No hay productos para comprar"}),e.jsxs("p",{className:"text-xl text-gray-300",children:["No tienes productos marcados para comprar en ",r]}),e.jsx(P,{variant:"outline",className:"text-white border-white hover:bg-white/20",onClick:()=>t(-1),children:" Volver"})]})}):e.jsxs("div",{className:`min-h-screen flex flex-col ${k} text-white`,children:[e.jsxs("div",{className:"flex justify-between items-center p-4 bg-black/20 backdrop-blur-sm",children:[e.jsxs(P,{variant:"ghost",className:"text-white hover:bg-white/20 text-lg font-semibold",onClick:()=>t(-1),children:[e.jsx(fl,{className:"w-5 h-5 mr-2"}),"Volver"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-white/80 mb-1",children:r}),e.jsx("div",{className:"text-3xl font-mono font-bold bg-black/30 px-4 py-2 rounded-lg backdrop-blur-sm border border-white/20",children:x})]}),e.jsx("div",{className:"w-20"})," "]}),e.jsx("div",{className:"flex gap-2 justify-center p-4 bg-black/10",children:y?e.jsxs(e.Fragment,{children:[v?e.jsxs(P,{onClick:S,className:"bg-green-700 hover:bg-green-800 text-white px-6 py-2 font-semibold",children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),"Reanudar"]}):e.jsxs(P,{onClick:N,className:"bg-amber-600 hover:bg-amber-700 text-white px-6 py-2 font-semibold",children:[e.jsx(n1,{className:"w-4 h-4 mr-2"}),"Pausar"]}),e.jsxs(P,{onClick:w,className:"bg-red-700 hover:bg-red-800 text-white px-6 py-2 font-semibold",children:[e.jsx(ay,{className:"w-4 h-4 mr-2"}),"Detener"]})]}):e.jsxs(P,{onClick:b,className:"bg-green-700 hover:bg-green-800 text-white px-6 py-2 font-semibold",children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),"Iniciar"]})}),e.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsx(P,{variant:"outline",className:"text-white border-white/40 hover:bg-white/10",onClick:()=>U(!0),children:"Marcar todos"}),e.jsx(P,{variant:"outline",className:"text-white border-white/40 hover:bg-white/10",onClick:()=>U(!1),children:"Limpiar todos"})]}),u.map(G=>e.jsx("div",{className:`bg-black/20 backdrop-blur-sm border border-white/20 rounded-lg p-4 transition-all duration-300 ${G.purchased?"opacity-60 bg-green-900/20":""}`,children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Va,{checked:G.purchased,onCheckedChange:()=>L(G.id),className:"scale-125"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`text-lg font-medium ${G.purchased?"line-through text-white/70":""}`,children:G.name}),e.jsxs("div",{className:"text-sm text-white/80",children:["Cantidad: ",G.toBuy," ",PI[G.unit||"units"],G.price&&e.jsxs("span",{className:"ml-4",children:["Precio unitario: ",_.format(G.price)]})]})]}),G.price&&e.jsx("div",{className:`text-right ${G.purchased?"line-through text-white/70":""}`,children:e.jsx("div",{className:"text-lg font-bold",children:_.format(G.price*G.toBuy)})})]})},G.id))]}),e.jsxs("div",{className:"bg-black/30 backdrop-blur-sm border-t border-white/20 p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm text-white/80",children:[e.jsx("span",{children:"Total estimado:"}),e.jsx("span",{children:_.format(D.totalEstimated)})]}),e.jsxs("div",{className:"flex justify-between text-sm text-green-400",children:[e.jsx("span",{children:"Ya comprado:"}),e.jsx("span",{children:_.format(D.totalPurchased)})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t border-white/20 pt-3",children:[e.jsx("span",{children:"Falta por comprar:"}),e.jsx("span",{children:_.format(D.totalRemaining)})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[e.jsx(P,{className:"w-full bg-emerald-700 hover:bg-emerald-800 text-white py-3 text-lg font-semibold",onClick:V,disabled:h,children:h?"Aplicando...":"Aplicar compras"}),e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsxs(P,{className:"w-full bg-blue-700 hover:bg-blue-800 text-white py-3 text-lg font-semibold",children:[e.jsx(lr,{className:"w-5 h-5 mr-2"}),"Terminar Compras"]})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Terminar Compras"}),e.jsx(fr,{children:"Ests seguro de que quieres terminar la sesin de compras? El cronmetro se detendr y volvers a la vista anterior."})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"Continuar comprando"}),e.jsx(pr,{onClick:F,className:"bg-blue-600 hover:bg-blue-700",children:"S, terminar"})]})]})]})]})]})]})}const HI=()=>{const{user:t,signOut:a}=st();return t?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm",children:t.email}),e.jsx(P,{variant:"outline",onClick:a,children:"Cerrar sesin"})]}):null},jl=({selectedDate:t,onChange:a})=>{const[s,r]=p.useState(!1);p.useEffect(()=>{const h=()=>{r(window.innerWidth<768)};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]);const l=()=>{const h=new Date(t);h.setDate(h.getDate()-1),a(h)},o=()=>{const h=new Date(t);h.setDate(h.getDate()+1),a(h)},d=()=>{a(new Date)},u=h=>s?h.toLocaleDateString("es-ES",{weekday:"short",month:"short",day:"numeric"}):h.toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),m=h=>{const g=new Date;return h.toDateString()===g.toDateString()};return e.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200 rounded-2xl p-4 mb-6 shadow-sm md:p-6 md:mb-8",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 md:gap-4",children:[e.jsx(P,{variant:"outline",size:"icon",onClick:l,className:"rounded-full border-2 bg-white/80 w-8 h-8 md:w-10 md:h-10 touch-manipulation active:scale-95 transition-transform",children:e.jsx(kc,{className:"w-3 h-3 md:w-4 md:h-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("h2",{className:"text-sm md:text-xl font-semibold bg-gradient-to-r from-gray-700 to-gray-900 bg-clip-text text-transparent capitalize",children:u(t)}),!m(t)&&e.jsxs(P,{variant:"ghost",className:"text-xs md:text-sm mt-1 md:mt-2 rounded-full h-6 md:h-auto px-2 md:px-4 touch-manipulation active:scale-95 transition-transform",onClick:d,children:[e.jsx(Aa,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Ir a hoy"}),e.jsx("span",{className:"md:hidden",children:"Hoy"})]}),m(t)&&e.jsx("div",{className:"inline-flex items-center px-2 md:px-3 py-1 mt-1 md:mt-2 rounded-full bg-green-100 text-green-800 text-xs font-medium",children:"Hoy"})]}),e.jsx(P,{variant:"outline",size:"icon",onClick:o,className:"rounded-full border-2 bg-white/80 w-8 h-8 md:w-10 md:h-10 touch-manipulation active:scale-95 transition-transform",children:e.jsx(wn,{className:"w-3 h-3 md:w-4 md:h-4"})})]})})},wi=({children:t,className:a,fullHeight:s=!1,noPadding:r=!1,showFloatingButton:l=!1,onFloatingButtonClick:o,floatingButtonLabel:d="Agregar"})=>r?e.jsxs("div",{className:he("h-full",a),children:[t,l&&e.jsx(P,{onClick:o,className:"fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow z-50 md:hidden",size:"icon",title:d,children:e.jsx(It,{className:"h-6 w-6"})})]}):e.jsxs("div",{className:he(s?"h-full flex flex-col":"min-h-full","px-3 sm:px-4 md:px-6 lg:px-8 xl:px-12 2xl:px-16","pt-4 md:pt-6 lg:pt-8","pb-4 md:pb-6 lg:pb-8",a),children:[e.jsx("div",{className:he(s?"flex-1 flex flex-col":"","space-y-4 sm:space-y-6 md:space-y-8 lg:space-y-10","max-w-screen-2xl mx-auto w-full","container-wide"),children:t}),l&&e.jsx(P,{onClick:o,className:"fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow z-50 md:hidden",size:"icon",title:d,children:e.jsx(It,{className:"h-6 w-6"})})]}),_T=p.forwardRef(({className:t,variant:a="default",...s},r)=>{const l={default:"bg-card text-card-foreground border shadow-sm",glass:"glass-card text-card-foreground",gradient:"gradient-bg-primary text-white border-0 shadow-lg",elevated:"bg-card text-card-foreground border-0 shadow-lg hover:shadow-xl transition-shadow duration-300"};return e.jsx("div",{ref:r,className:he("rounded-xl transition-all duration-300",l[a],t),...s})});_T.displayName="ModernCard";const UI=p.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:he("flex flex-col space-y-1.5 p-6",t),...a}));UI.displayName="ModernCardHeader";const VI=p.forwardRef(({className:t,gradient:a,...s},r)=>e.jsx("h3",{ref:r,className:he("text-2xl font-semibold leading-none tracking-tight",a&&"bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",t),...s}));VI.displayName="ModernCardTitle";const YI=p.forwardRef(({className:t,...a},s)=>e.jsx("p",{ref:s,className:he("text-sm text-muted-foreground",t),...a}));YI.displayName="ModernCardDescription";const qI=p.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:he("p-6 pt-0",t),...a}));qI.displayName="ModernCardContent";const FI=p.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:he("flex items-center p-6 pt-0",t),...a}));FI.displayName="ModernCardFooter";const zc=({title:t,icon:a,variant:s="compact",children:r,className:l,onClick:o,loading:d=!1,error:u})=>{const m=he("transition-all duration-200",o&&"cursor-pointer hover:shadow-md hover:scale-[1.02]",l),h=he("flex items-center gap-2 mb-2",s==="compact"&&"mb-1"),g=he("space-y-2",s==="compact"&&"space-y-1",s==="chart"&&"space-y-3"),x={compact:"p-3",detailed:"p-4",chart:"p-4"};return e.jsx(_T,{className:m,variant:"default",onClick:o,children:e.jsxs("div",{className:x[s],children:[e.jsxs("div",{className:h,children:[e.jsx(a,{className:he("text-blue-600",s==="compact"?"w-4 h-4":"w-5 h-5")}),e.jsx("h3",{className:he("font-medium text-gray-800",s==="compact"?"text-sm":"text-base"),children:t})]}),d&&e.jsxs("div",{className:"animate-pulse space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),u&&e.jsxs("div",{className:"text-red-500 text-sm",children:["Error: ",u]}),!d&&!u&&e.jsx("div",{className:g,children:r})]})})},GI={water:"Agua",dairy:"Lcteos",caffeine:"Cafena",hydration:"Hidratacin",soda:"Gaseosas",alcohol:"Alcohol",other:"Otros"},Ar={water:{name:"Agua",icon:"Droplet",hydrationFactor:1,color:"text-blue-500",amounts:[100,200,300],category:"water"},sparklingWater:{name:"Agua con gas",icon:"Waves",hydrationFactor:1,color:"text-blue-400",amounts:[100,200,300],category:"water"},flavoredWater:{name:"Agua saborizada",icon:"Droplets",hydrationFactor:.95,color:"text-blue-300",amounts:[100,200,300],category:"water"},milk:{name:"Leche",icon:"Milk",hydrationFactor:.9,color:"text-blue-500",amounts:[100,200,300],category:"dairy"},chocolate:{name:"Chocolate",icon:"Milk",hydrationFactor:.8,color:"text-brown-500",amounts:[100,200,300],category:"dairy"},colagranulada:{name:"Cola Granulada",icon:"Milk",hydrationFactor:.9,color:"text-red-500",amounts:[100,200,300],category:"dairy"},ensure:{name:"Ensure / Pediasure",icon:"Milk",hydrationFactor:.9,color:"text-red-500",amounts:[100,200,300],category:"dairy"},yogurt:{name:"Yogurt",icon:"Milk",hydrationFactor:.6,color:"text-amber-600",amounts:[100,200,300],category:"dairy"},coffee:{name:"Caf",icon:"Coffee",hydrationFactor:.8,color:"text-amber-800",amounts:[100,200,300],category:"caffeine"},energyDrink:{name:"Energizante",icon:"Zap",hydrationFactor:.6,color:"text-yellow-500",amounts:[100,250,500],category:"caffeine"},juice:{name:"Jugo",icon:"Cherry",hydrationFactor:.85,color:"text-orange-500",amounts:[100,200,300],category:"hydration"},sportsdrink:{name:"Bebida deportiva",icon:"Dumbbell",hydrationFactor:.9,color:"text-green-500",amounts:[250,500,750],category:"hydration"},soup:{name:"Sopa",icon:"Soup",hydrationFactor:.6,color:"text-orange-500",amounts:[200,400,600],category:"other"},soda:{name:"Gaseosa",icon:"CircleDot",hydrationFactor:.6,color:"text-purple-500",amounts:[200,350,500],category:"soda"},beer:{name:"Cerveza",icon:"Beer",hydrationFactor:.8,color:"text-yellow-600",amounts:[330,500,750],category:"alcohol"},aguardiente:{name:"Aguardiente",icon:"Beer",hydrationFactor:.2,color:"text-yellow-600",amounts:[50,100,200],category:"alcohol"},wine:{name:"Vino",icon:"Wine",hydrationFactor:.1,color:"text-red-600",amounts:[150,250,750],category:"alcohol"},aromatica:{name:"Aromtica",icon:"Coffee",hydrationFactor:.95,color:"text-green-600",amounts:[100,200,300],category:"other"},iceCream:{name:"Helado",icon:"Cookie",hydrationFactor:.4,color:"text-cyan-400",amounts:[50,100,150],category:"other"},granizado:{name:"Granizado",icon:"Cookie",hydrationFactor:.8,color:"text-blue-300",amounts:[150,250,350],category:"hydration"},tea:{name:"T",icon:"Coffee",hydrationFactor:.9,color:"text-green-500",amounts:[100,200,300],category:"caffeine"}};class bn{static client=ze;static async getDrinkLogs(a,s){return ze.from("drink_logs").select("*").eq("user_id",a).eq("date",s).order("timestamp",{ascending:!0}).returns()}static async getDrinkLogsRange(a,s,r){return ze.from("drink_logs").select("date, hydration_value, amount").eq("user_id",a).gte("date",s).lte("date",r).order("date",{ascending:!0}).returns()}static async insertDrinkLog(a){return ze.from("drink_logs").insert({user_id:a.userId,date:a.date,drink_type:a.drinkType,amount:a.amount,hydration_value:a.hydrationValue,timestamp:a.timestamp,time:a.time})}static async updateDrinkLog(a){return ze.from("drink_logs").update({drink_type:a.drinkType,amount:a.amount,hydration_value:a.hydrationValue,timestamp:a.timestamp,time:a.time}).eq("user_id",a.userId).eq("date",a.date).eq("timestamp",a.originalTimestamp)}static async deleteDrinkLog(a,s,r){return ze.from("drink_logs").delete().eq("user_id",a).eq("date",s).eq("timestamp",r)}static async getDrinkTypes(a){return ze.from("drink_types").select("*").eq("user_id",a).order("name",{ascending:!0})}static async createDrinkType(a){return ze.from("drink_types").insert({user_id:a.userId,name:a.name,hydration_factor:a.hydrationFactor,color:a.color,icon:a.icon,category:a.category})}static async updateDrinkType(a,s){return ze.from("drink_types").update({user_id:s.userId,name:s.name,hydration_factor:s.hydrationFactor,color:s.color,icon:s.icon,category:s.category}).eq("id",a)}static async deleteDrinkType(a){return ze.from("drink_types").delete().eq("id",a)}static subscribeDrinkTypes(a,s){return ze.channel("drink_types_changes").on("postgres_changes",{event:"*",schema:"public",table:"drink_types",filter:`user_id=eq.${a}`},s).subscribe()}static async getWaterIntakeRange(a,s,r){return ze.from("water_intake").select("date, drink_type, amount_ml").eq("user_id",a).gte("date",s).lte("date",r).order("date",{ascending:!0}).returns()}}const MT=t=>{const[a,s]=p.useState(0),[r,l]=p.useState([]),[o,d]=p.useState("idle"),[u,m]=p.useState(null),{user:h}=st(),g=N=>N.reduce((S,w)=>S+w.hydration,0),x=async()=>{if(h){m(null),d("pending");try{const N=Ue(t),{data:S,error:w}=await bn.getDrinkLogs(h.id,N);if(w)throw w;const E=(S||[]).map(D=>({type:D.drink_type,amount:D.amount,hydration:D.hydration_value,timestamp:D.timestamp.toString(),time:D.time})),T=g(E);s(T),l(E),d("saved")}catch(N){console.error("Error loading water data:",N),m(N instanceof Error?N.message:"Error al cargar datos de hidratacin"),d("error")}}};return p.useEffect(()=>{x()},[h,t]),{intake:a,drinks:r,status:o,error:u,addDrink:async(N,S)=>{if(!h)return;d("saving"),m(null);const w=new Date,E=$n(t,w.getHours(),w.getMinutes()),T=S*Ar[N].hydrationFactor,D={type:N,amount:S,hydration:T,timestamp:E.timestamp.toString(),time:w.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1})},k=[...r,D],_=g(k);l(k),s(_);try{const R=Ue(t),{error:L}=await bn.insertDrinkLog({userId:h.id,date:R,drinkType:N,amount:S,hydrationValue:T,timestamp:parseInt(E.timestamp.toString()),time:D.time});if(L)throw L;d("saved")}catch(R){console.error("Error adding drink:",R),l(r),s(a),m(R instanceof Error?R.message:"Error al guardar"),d("error")}},editDrink:async(N,S)=>{if(!h)return;d("saving"),m(null);const w=Ue(t),E=r[N];try{const[T,D]=S.time.split(":").map(Number),k=$n(t,T,D),_=S.amount*Ar[S.type].hydrationFactor,R={...S,timestamp:k.timestamp.toString(),hydration:_},L=[...r];L[N]=R;const U=g(L);l(L),s(U);const{error:V}=await bn.updateDrinkLog({userId:h.id,date:w,originalTimestamp:parseInt(E.timestamp),drinkType:S.type,amount:S.amount,hydrationValue:_,timestamp:parseInt(k.timestamp.toString()),time:S.time});if(V)throw V;d("saved")}catch(T){console.error("Error editing drink:",T),l(r),s(a),m(T instanceof Error?T.message:"Error al editar"),d("error")}},deleteDrink:async N=>{if(!h)return;d("saving"),m(null);const S=Ue(t),w=r[N];try{const E=r.filter((k,_)=>_!==N),T=g(E);l(E),s(T);const{error:D}=await bn.deleteDrinkLog(h.id,S,parseInt(w.timestamp));if(D)throw D;d("saved")}catch(E){console.error("Error deleting drink:",E);const T=[...r];T.splice(N,0,w),l(T),s(g(T)),m(E instanceof Error?E.message:"Error al eliminar"),d("error")}},loadWaterData:x}},Rd=new Map,Id=new Map;function Si(t,a){const{user:s}=st(),[r,l]=p.useState(a),[o,d]=p.useState("idle"),[u,m]=p.useState(null),h=p.useRef(!1),g=p.useCallback(async()=>{if(!s||h.current)return;const y=`${s.id}_${t}`;if(Rd.has(y)){const b=Rd.get(y);l({...a,...b}),h.current=!0;return}if(Id.has(y))try{const b=await Id.get(y);l({...a,...b}),h.current=!0;return}catch{}d("loading"),m(null);const v=(async()=>{try{const{data:b,error:N}=await ze.from("module_settings").select("settings").eq("user_id",s.id).eq("module",t).single();if(N&&N.code!=="PGRST116")throw N;const S=b?.settings||{};return Rd.set(y,S),Id.delete(y),S}catch(b){throw Id.delete(y),b}})();Id.set(y,v);try{const b=await v;l({...a,...b}),d("idle"),h.current=!0}catch(b){m(b.message),d("error")}},[s,t]);return p.useEffect(()=>{g()},[g]),{settings:r,status:o,error:u,saveSettings:async y=>{if(!s)return;d("saving"),m(null);const v=r,b=`${s.id}_${t}`;try{const N={...r,...y};l(N),d("saved");const S=Object.fromEntries(Object.entries(y).filter(([,D])=>D!==void 0&&!(typeof D=="number"&&isNaN(D)))),E={...Rd.get(b)||{},...S},{error:T}=await ze.from("module_settings").upsert({user_id:s.id,module:t,settings:E},{onConflict:"user_id,module"});if(T)throw T;Rd.set(b,E)}catch(N){throw l(v),m(N.message),d("error"),N}},refetch:g}}const WI=({date:t,variant:a="compact"})=>{const s=it(),{intake:r,status:l,addDrink:o}=MT(t),{settings:d}=Si("water",{dailyGoalMl:2e3}),u=l==="saving"||l==="pending",m=async b=>{b.stopPropagation(),await o("water",100)},h=async b=>{b.stopPropagation(),await o("water",300)},g=async b=>{b.stopPropagation(),await o("water",600)},x=r||0,y=Number(d.dailyGoalMl)>0?Number(d.dailyGoalMl):2e3,v=Math.min(x/y*100,100);return e.jsx(zc,{title:"Hidratacin",icon:ty,variant:a,loading:u,onClick:()=>s(ae.water.view("daily")),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[x,"ml"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["de ",y,"ml (",v.toFixed(0),"%)"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1 min-w-0",children:[e.jsx(P,{size:"sm",variant:"outline",onClick:m,className:"px-1 py-1 text-xs bg-blue-50 hover:bg-blue-100 border-blue-200 min-w-0 flex-shrink-0",disabled:u,children:a==="detailed"?"100ml":"100"}),e.jsx(P,{size:"sm",variant:"outline",onClick:h,className:"px-1 py-1 text-xs bg-blue-50 hover:bg-blue-100 border-blue-200 min-w-0 flex-shrink-0",disabled:u,children:a==="detailed"?"300ml":"300"}),e.jsx(P,{size:"sm",variant:"outline",onClick:g,className:"px-1 py-1 text-xs bg-blue-50 hover:bg-blue-100 border-blue-200 min-w-0 flex-shrink-0",disabled:u,children:a==="detailed"?"600ml":"600"})]})]}),a==="detailed"&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${v}%`}})})]})})};class sn{static client=ze;static async getMoodStates(a){return ze.from("mood_states").select("*").eq("user_id",a).order("value",{ascending:!1})}static subscribeMoodStates(a,s){return ze.channel("mood_states_changes").on("postgres_changes",{event:"*",schema:"public",table:"mood_states",filter:`user_id=eq.${a}`},s).subscribe()}static async createMoodState(a){return ze.from("mood_states").insert({user_id:a.userId,emoji:a.emoji,text:a.text,value:a.value,category:a.category})}static async updateMoodState(a,s){return ze.from("mood_states").update({user_id:s.userId,emoji:s.emoji,text:s.text,value:s.value,category:s.category}).eq("id",a)}static async deleteMoodState(a){return ze.from("mood_states").delete().eq("id",a)}static async getMoodEntriesByDate(a,s){return ze.from("mood_entries").select("*").eq("user_id",a).eq("date",s).order("timestamp",{ascending:!0})}static async insertMoodEntry(a){return ze.from("mood_entries").insert({user_id:a.userId,date:a.date,emoji:a.emoji,text:a.text,value:a.value,time:a.time,timestamp:a.timestamp})}static async updateMoodEntry(a){return ze.from("mood_entries").update({emoji:a.emoji,text:a.text,value:a.value,time:a.time,timestamp:a.timestamp}).eq("user_id",a.userId).eq("date",a.date).eq("timestamp",a.originalTimestamp)}static async deleteMoodEntry(a,s,r){return ze.from("mood_entries").delete().eq("user_id",a).eq("date",s).eq("timestamp",r)}static async getEnergyEntriesByDate(a,s){return ze.from("energy_entries").select("*").eq("user_id",a).eq("date",s).order("timestamp",{ascending:!0})}static async insertEnergyEntry(a){return ze.from("energy_entries").insert({user_id:a.userId,date:a.date,level:a.level,comment:a.comment,time:a.time,timestamp:a.timestamp})}static async updateEnergyEntry(a){return ze.from("energy_entries").update({level:a.level,comment:a.comment,time:a.time,timestamp:a.timestamp}).eq("user_id",a.userId).eq("date",a.date).eq("timestamp",a.originalTimestamp)}static async deleteEnergyEntry(a,s,r){return ze.from("energy_entries").delete().eq("user_id",a).eq("date",s).eq("timestamp",r)}}const Cy=()=>{const[t,a]=p.useState([]),[s,r]=p.useState(!0),[l,o]=p.useState(null),{user:d}=st();p.useEffect(()=>{if(!d){r(!1);return}u();const x=sn.subscribeMoodStates(d.id,()=>{u()});return()=>{x.unsubscribe()}},[d]);const u=async()=>{if(d){r(!0),o(null);try{const{data:x,error:y}=await sn.getMoodStates(d.id);if(y)throw y;a(x||[])}catch(x){o(x instanceof Error?x.message:"Error al cargar estados de nimo"),console.error("Error loading mood states:",x)}finally{r(!1)}}};return{moodStates:t,loading:s,error:l,getMoodStateById:x=>t.find(y=>y.id===x),getMoodStateByText:x=>t.find(y=>y.text===x),getMoodValue:x=>t.find(v=>v.text===x)?.value??5,reload:u}},OT=t=>{const[a,s]=p.useState([]),[r,l]=p.useState("idle"),[o,d]=p.useState(null),{user:u}=st(),{getMoodValue:m}=Cy(),h=async()=>{if(u)try{l("pending");const v=Ue(t),{data:b,error:N}=await sn.getMoodEntriesByDate(u.id,v);if(N)throw N;const S=(b||[]).map(w=>({emoji:w.emoji,text:w.text,value:w.value,time:w.time,timestamp:w.timestamp}));s(S),l("saved")}catch(v){console.error("Error loading mood data:",v),d(v instanceof Error?v.message:"Error al cargar estado de nimo"),l("error")}};return p.useEffect(()=>{h()},[u,t]),{moodHistory:a,status:r,error:o,addMood:async v=>{if(!u)return;l("saving"),d(null);const b=Ue(t),N=a;try{const S=new Date,w=$n(t,S.getHours(),S.getMinutes()),E={emoji:v.emoji,text:v.text,timestamp:w.timestamp,time:S.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),value:m(v.text)},T=[...a,E];s(T),l("saved");const{error:D}=await sn.insertMoodEntry({userId:u.id,date:b,emoji:E.emoji,text:E.text,value:E.value??m(E.text),time:E.time,timestamp:E.timestamp});if(D)throw D}catch(S){s(N),console.error("Mood - Error al guardar:",S),d(S instanceof Error?S.message:"Error al guardar"),l("error")}},updateMood:async(v,b)=>{if(!u)return;l("saving"),d(null);const N=Ue(t),S=a;try{const w=a.map(T=>T.timestamp===v?b:T);s(w),l("saved");const{error:E}=await sn.updateMoodEntry({userId:u.id,date:N,originalTimestamp:v,emoji:b.emoji,text:b.text,value:b.value??m(b.text),time:b.time,timestamp:b.timestamp});if(E)throw E}catch(w){s(S),console.error("Mood - Error al actualizar:",w),d(w instanceof Error?w.message:"Error al actualizar"),l("error")}},deleteMood:async v=>{if(!u)return;l("saving"),d(null);const b=Ue(t),N=a;try{const S=a.filter(E=>E.timestamp!==v);s(S),l("saved");const{error:w}=await sn.deleteMoodEntry(u.id,b,v);if(w)throw w}catch(S){s(N),console.error("Mood - Error al eliminar:",S),d(S instanceof Error?S.message:"Error al eliminar"),l("error")}},loadMoodData:h}},KI=t=>{if(t.length===0)return 0;const a=t.reduce((s,r)=>s+(r.value??5),0);return Math.round(a/t.length*10)/10},XI=({date:t,variant:a="compact"})=>{const s=it(),{moodHistory:r,status:l}=OT(t),o=l==="saving"||l==="pending",d=r||[],u=d.length,m=d.length>0?KI(d):0,h=d[d.length-1],g=x=>x>=8?"":x>=6?"":x>=4?"":x>=2?"":"";return e.jsx(zc,{title:"Estado de nimo",icon:bf,variant:a,loading:o,onClick:()=>s(ae.mood.view("tracker")),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:u>0?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:h?.emoji||g(m)}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[m.toFixed(1),"/10"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[u," registro",u>1?"s":""]})]})]})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:""}),e.jsx("p",{className:"text-sm text-gray-500",children:"Sin registros"})]})}),e.jsxs(P,{size:"sm",variant:"outline",onClick:x=>{x.stopPropagation(),s(ae.mood.view("tracker"))},className:"flex items-center gap-1",children:[e.jsx(It,{className:"w-3 h-3"}),a==="detailed"&&"Registrar"]})]}),a==="detailed"&&h&&e.jsxs("div",{className:"text-xs text-gray-600 p-2 bg-gray-50 rounded",children:[e.jsx("p",{className:"font-medium",children:"ltimo registro:"}),e.jsxs("p",{children:['"',h.text,'" - ',h.time]})]})]})})},QI=({date:t,variant:a="compact"})=>{const s=it(),{completedHabits:r,status:l,toggleHabit:o}=Mf(t),d=l==="saving"||l==="pending",[u,m]=p.useState(!1),h=Ue(t),g=nn.length,x=Object.entries(r).filter(([S,w])=>S.endsWith(`_${h}`)&&w).length,y=g>0?x/g*100:0,b=nn.find(S=>{const w=`${S.id}_${h}`;return!r[w]}),N=async()=>{if(b&&!u){m(!0);try{await o(b.id,h)}catch(S){console.error("Error toggling habit:",S)}finally{m(!1)}}};return e.jsx(zc,{title:"Hbitos",icon:xi,variant:a,loading:d,onClick:()=>s(ae.habit.view("tracker")),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[x,"/",g]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[y.toFixed(0),"% completado"]})]}),b&&e.jsxs("button",{onClick:S=>{S.stopPropagation(),N()},disabled:u,className:"flex items-center gap-1 text-xs px-2 py-1 bg-green-50 hover:bg-green-100 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[u?e.jsx(hs,{className:"w-3 h-3 animate-spin"}):e.jsx(sy,{className:"w-3 h-3"}),a==="detailed"?b.name:b.icon]})]}),a==="detailed"&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${y}%`}})}),b&&e.jsxs("p",{className:"text-xs text-gray-600",children:["Siguiente: ",b.name]})]})]})})};class Yl{static client=ze;static table(a){return ze.from(a)}}const{entries:RT,setPrototypeOf:Aw,isFrozen:ZI,getPrototypeOf:JI,getOwnPropertyDescriptor:ez}=Object;let{freeze:$s,seal:Yn,create:S0}=Object,{apply:C0,construct:E0}=typeof Reflect<"u"&&Reflect;$s||($s=function(a){return a});Yn||(Yn=function(a){return a});C0||(C0=function(a,s){for(var r=arguments.length,l=new Array(r>2?r-2:0),o=2;o<r;o++)l[o-2]=arguments[o];return a.apply(s,l)});E0||(E0=function(a){for(var s=arguments.length,r=new Array(s>1?s-1:0),l=1;l<s;l++)r[l-1]=arguments[l];return new a(...r)});const lh=Hs(Array.prototype.forEach),tz=Hs(Array.prototype.lastIndexOf),_w=Hs(Array.prototype.pop),zd=Hs(Array.prototype.push),az=Hs(Array.prototype.splice),Th=Hs(String.prototype.toLowerCase),yg=Hs(String.prototype.toString),vg=Hs(String.prototype.match),Ld=Hs(String.prototype.replace),sz=Hs(String.prototype.indexOf),nz=Hs(String.prototype.trim),Zn=Hs(Object.prototype.hasOwnProperty),Rs=Hs(RegExp.prototype.test),Pd=rz(TypeError);function Hs(t){return function(a){a instanceof RegExp&&(a.lastIndex=0);for(var s=arguments.length,r=new Array(s>1?s-1:0),l=1;l<s;l++)r[l-1]=arguments[l];return C0(t,a,r)}}function rz(t){return function(){for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return E0(t,s)}}function zt(t,a){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Th;Aw&&Aw(t,null);let r=a.length;for(;r--;){let l=a[r];if(typeof l=="string"){const o=s(l);o!==l&&(ZI(a)||(a[r]=o),l=o)}t[l]=!0}return t}function iz(t){for(let a=0;a<t.length;a++)Zn(t,a)||(t[a]=null);return t}function Cr(t){const a=S0(null);for(const[s,r]of RT(t))Zn(t,s)&&(Array.isArray(r)?a[s]=iz(r):r&&typeof r=="object"&&r.constructor===Object?a[s]=Cr(r):a[s]=r);return a}function Bd(t,a){for(;t!==null;){const r=ez(t,a);if(r){if(r.get)return Hs(r.get);if(typeof r.value=="function")return Hs(r.value)}t=JI(t)}function s(){return null}return s}const Mw=$s(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),bg=$s(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),jg=$s(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),lz=$s(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ng=$s(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),oz=$s(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ow=$s(["#text"]),Rw=$s(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),wg=$s(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Iw=$s(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),oh=$s(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),cz=Yn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),dz=Yn(/<%[\w\W]*|[\w\W]*%>/gm),uz=Yn(/\$\{[\w\W]*/gm),mz=Yn(/^data-[\-\w.\u00B7-\uFFFF]+$/),hz=Yn(/^aria-[\-\w]+$/),IT=Yn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),fz=Yn(/^(?:\w+script|data):/i),pz=Yn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zT=Yn(/^html$/i),xz=Yn(/^[a-z][.\w]*(-[.\w]+)+$/i);var zw=Object.freeze({__proto__:null,ARIA_ATTR:hz,ATTR_WHITESPACE:pz,CUSTOM_ELEMENT:xz,DATA_ATTR:mz,DOCTYPE_NAME:zT,ERB_EXPR:dz,IS_ALLOWED_URI:IT,IS_SCRIPT_OR_DATA:fz,MUSTACHE_EXPR:cz,TMPLIT_EXPR:uz});const $d={element:1,text:3,progressingInstruction:7,comment:8,document:9},gz=function(){return typeof window>"u"?null:window},yz=function(a,s){if(typeof a!="object"||typeof a.createPolicy!="function")return null;let r=null;const l="data-tt-policy-suffix";s&&s.hasAttribute(l)&&(r=s.getAttribute(l));const o="dompurify"+(r?"#"+r:"");try{return a.createPolicy(o,{createHTML(d){return d},createScriptURL(d){return d}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Lw=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function LT(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gz();const a=He=>LT(He);if(a.version="3.3.1",a.removed=[],!t||!t.document||t.document.nodeType!==$d.document||!t.Element)return a.isSupported=!1,a;let{document:s}=t;const r=s,l=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:d,Node:u,Element:m,NodeFilter:h,NamedNodeMap:g=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:x,DOMParser:y,trustedTypes:v}=t,b=m.prototype,N=Bd(b,"cloneNode"),S=Bd(b,"remove"),w=Bd(b,"nextSibling"),E=Bd(b,"childNodes"),T=Bd(b,"parentNode");if(typeof d=="function"){const He=s.createElement("template");He.content&&He.content.ownerDocument&&(s=He.content.ownerDocument)}let D,k="";const{implementation:_,createNodeIterator:R,createDocumentFragment:L,getElementsByTagName:U}=s,{importNode:V}=r;let F=Lw();a.isSupported=typeof RT=="function"&&typeof T=="function"&&_&&_.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:G,ERB_EXPR:$,TMPLIT_EXPR:z,DATA_ATTR:H,ARIA_ATTR:I,IS_SCRIPT_OR_DATA:O,ATTR_WHITESPACE:Y,CUSTOM_ELEMENT:le}=zw;let{IS_ALLOWED_URI:re}=zw,Q=null;const q=zt({},[...Mw,...bg,...jg,...Ng,...Ow]);let M=null;const W=zt({},[...Rw,...wg,...Iw,...oh]);let ie=Object.seal(S0(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ve=null,K=null;const oe=Object.seal(S0(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let _e=!0,je=!0,Ie=!1,ge=!0,Be=!1,ke=!0,gt=!1,Dt=!1,kt=!1,ja=!1,Wt=!1,Vt=!1,X=!0,se=!1;const me="user-content-";let Oe=!0,Re=!1,Ee={},Pe=null;const Je=zt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let rt=null;const Et=zt({},["audio","video","img","source","image","track"]);let Kt=null;const Ne=zt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ve="http://www.w3.org/1998/Math/MathML",nt="http://www.w3.org/2000/svg",bt="http://www.w3.org/1999/xhtml";let Pt=bt,_a=!1,Ma=null;const qe=zt({},[Ve,nt,bt],yg);let dt=zt({},["mi","mo","mn","ms","mtext"]),jt=zt({},["annotation-xml"]);const Xe=zt({},["title","style","font","a","script"]);let et=null;const $e=["application/xhtml+xml","text/html"],Ae="text/html";let Fe=null,lt=null;const Xt=s.createElement("form"),ht=function(J){return J instanceof RegExp||J instanceof Function},ct=function(){let J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(lt&&lt===J)){if((!J||typeof J!="object")&&(J={}),J=Cr(J),et=$e.indexOf(J.PARSER_MEDIA_TYPE)===-1?Ae:J.PARSER_MEDIA_TYPE,Fe=et==="application/xhtml+xml"?yg:Th,Q=Zn(J,"ALLOWED_TAGS")?zt({},J.ALLOWED_TAGS,Fe):q,M=Zn(J,"ALLOWED_ATTR")?zt({},J.ALLOWED_ATTR,Fe):W,Ma=Zn(J,"ALLOWED_NAMESPACES")?zt({},J.ALLOWED_NAMESPACES,yg):qe,Kt=Zn(J,"ADD_URI_SAFE_ATTR")?zt(Cr(Ne),J.ADD_URI_SAFE_ATTR,Fe):Ne,rt=Zn(J,"ADD_DATA_URI_TAGS")?zt(Cr(Et),J.ADD_DATA_URI_TAGS,Fe):Et,Pe=Zn(J,"FORBID_CONTENTS")?zt({},J.FORBID_CONTENTS,Fe):Je,ve=Zn(J,"FORBID_TAGS")?zt({},J.FORBID_TAGS,Fe):Cr({}),K=Zn(J,"FORBID_ATTR")?zt({},J.FORBID_ATTR,Fe):Cr({}),Ee=Zn(J,"USE_PROFILES")?J.USE_PROFILES:!1,_e=J.ALLOW_ARIA_ATTR!==!1,je=J.ALLOW_DATA_ATTR!==!1,Ie=J.ALLOW_UNKNOWN_PROTOCOLS||!1,ge=J.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Be=J.SAFE_FOR_TEMPLATES||!1,ke=J.SAFE_FOR_XML!==!1,gt=J.WHOLE_DOCUMENT||!1,ja=J.RETURN_DOM||!1,Wt=J.RETURN_DOM_FRAGMENT||!1,Vt=J.RETURN_TRUSTED_TYPE||!1,kt=J.FORCE_BODY||!1,X=J.SANITIZE_DOM!==!1,se=J.SANITIZE_NAMED_PROPS||!1,Oe=J.KEEP_CONTENT!==!1,Re=J.IN_PLACE||!1,re=J.ALLOWED_URI_REGEXP||IT,Pt=J.NAMESPACE||bt,dt=J.MATHML_TEXT_INTEGRATION_POINTS||dt,jt=J.HTML_INTEGRATION_POINTS||jt,ie=J.CUSTOM_ELEMENT_HANDLING||{},J.CUSTOM_ELEMENT_HANDLING&&ht(J.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ie.tagNameCheck=J.CUSTOM_ELEMENT_HANDLING.tagNameCheck),J.CUSTOM_ELEMENT_HANDLING&&ht(J.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ie.attributeNameCheck=J.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),J.CUSTOM_ELEMENT_HANDLING&&typeof J.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ie.allowCustomizedBuiltInElements=J.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Be&&(je=!1),Wt&&(ja=!0),Ee&&(Q=zt({},Ow),M=[],Ee.html===!0&&(zt(Q,Mw),zt(M,Rw)),Ee.svg===!0&&(zt(Q,bg),zt(M,wg),zt(M,oh)),Ee.svgFilters===!0&&(zt(Q,jg),zt(M,wg),zt(M,oh)),Ee.mathMl===!0&&(zt(Q,Ng),zt(M,Iw),zt(M,oh))),J.ADD_TAGS&&(typeof J.ADD_TAGS=="function"?oe.tagCheck=J.ADD_TAGS:(Q===q&&(Q=Cr(Q)),zt(Q,J.ADD_TAGS,Fe))),J.ADD_ATTR&&(typeof J.ADD_ATTR=="function"?oe.attributeCheck=J.ADD_ATTR:(M===W&&(M=Cr(M)),zt(M,J.ADD_ATTR,Fe))),J.ADD_URI_SAFE_ATTR&&zt(Kt,J.ADD_URI_SAFE_ATTR,Fe),J.FORBID_CONTENTS&&(Pe===Je&&(Pe=Cr(Pe)),zt(Pe,J.FORBID_CONTENTS,Fe)),J.ADD_FORBID_CONTENTS&&(Pe===Je&&(Pe=Cr(Pe)),zt(Pe,J.ADD_FORBID_CONTENTS,Fe)),Oe&&(Q["#text"]=!0),gt&&zt(Q,["html","head","body"]),Q.table&&(zt(Q,["tbody"]),delete ve.tbody),J.TRUSTED_TYPES_POLICY){if(typeof J.TRUSTED_TYPES_POLICY.createHTML!="function")throw Pd('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof J.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Pd('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');D=J.TRUSTED_TYPES_POLICY,k=D.createHTML("")}else D===void 0&&(D=yz(v,l)),D!==null&&typeof k=="string"&&(k=D.createHTML(""));$s&&$s(J),lt=J}},pa=zt({},[...bg,...jg,...lz]),qt=zt({},[...Ng,...oz]),da=function(J){let Me=T(J);(!Me||!Me.tagName)&&(Me={namespaceURI:Pt,tagName:"template"});const Ye=Th(J.tagName),la=Th(Me.tagName);return Ma[J.namespaceURI]?J.namespaceURI===nt?Me.namespaceURI===bt?Ye==="svg":Me.namespaceURI===Ve?Ye==="svg"&&(la==="annotation-xml"||dt[la]):!!pa[Ye]:J.namespaceURI===Ve?Me.namespaceURI===bt?Ye==="math":Me.namespaceURI===nt?Ye==="math"&&jt[la]:!!qt[Ye]:J.namespaceURI===bt?Me.namespaceURI===nt&&!jt[la]||Me.namespaceURI===Ve&&!dt[la]?!1:!qt[Ye]&&(Xe[Ye]||!pa[Ye]):!!(et==="application/xhtml+xml"&&Ma[J.namespaceURI]):!1},Na=function(J){zd(a.removed,{element:J});try{T(J).removeChild(J)}catch{S(J)}},xa=function(J,Me){try{zd(a.removed,{attribute:Me.getAttributeNode(J),from:Me})}catch{zd(a.removed,{attribute:null,from:Me})}if(Me.removeAttribute(J),J==="is")if(ja||Wt)try{Na(Me)}catch{}else try{Me.setAttribute(J,"")}catch{}},ys=function(J){let Me=null,Ye=null;if(kt)J="<remove></remove>"+J;else{const At=vg(J,/^[\r\n\t ]+/);Ye=At&&At[0]}et==="application/xhtml+xml"&&Pt===bt&&(J='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+J+"</body></html>");const la=D?D.createHTML(J):J;if(Pt===bt)try{Me=new y().parseFromString(la,et)}catch{}if(!Me||!Me.documentElement){Me=_.createDocument(Pt,"template",null);try{Me.documentElement.innerHTML=_a?k:la}catch{}}const Oa=Me.body||Me.documentElement;return J&&Ye&&Oa.insertBefore(s.createTextNode(Ye),Oa.childNodes[0]||null),Pt===bt?U.call(Me,gt?"html":"body")[0]:gt?Me.documentElement:Oa},on=function(J){return R.call(J.ownerDocument||J,J,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null)},cs=function(J){return J instanceof x&&(typeof J.nodeName!="string"||typeof J.textContent!="string"||typeof J.removeChild!="function"||!(J.attributes instanceof g)||typeof J.removeAttribute!="function"||typeof J.setAttribute!="function"||typeof J.namespaceURI!="string"||typeof J.insertBefore!="function"||typeof J.hasChildNodes!="function")},Pa=function(J){return typeof u=="function"&&J instanceof u};function wa(He,J,Me){lh(He,Ye=>{Ye.call(a,J,Me,lt)})}const Gn=function(J){let Me=null;if(wa(F.beforeSanitizeElements,J,null),cs(J))return Na(J),!0;const Ye=Fe(J.nodeName);if(wa(F.uponSanitizeElement,J,{tagName:Ye,allowedTags:Q}),ke&&J.hasChildNodes()&&!Pa(J.firstElementChild)&&Rs(/<[/\w!]/g,J.innerHTML)&&Rs(/<[/\w!]/g,J.textContent)||J.nodeType===$d.progressingInstruction||ke&&J.nodeType===$d.comment&&Rs(/<[/\w]/g,J.data))return Na(J),!0;if(!(oe.tagCheck instanceof Function&&oe.tagCheck(Ye))&&(!Q[Ye]||ve[Ye])){if(!ve[Ye]&&yo(Ye)&&(ie.tagNameCheck instanceof RegExp&&Rs(ie.tagNameCheck,Ye)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(Ye)))return!1;if(Oe&&!Pe[Ye]){const la=T(J)||J.parentNode,Oa=E(J)||J.childNodes;if(Oa&&la){const At=Oa.length;for(let vs=At-1;vs>=0;--vs){const Tn=N(Oa[vs],!0);Tn.__removalCount=(J.__removalCount||0)+1,la.insertBefore(Tn,w(J))}}}return Na(J),!0}return J instanceof m&&!da(J)||(Ye==="noscript"||Ye==="noembed"||Ye==="noframes")&&Rs(/<\/no(script|embed|frames)/i,J.innerHTML)?(Na(J),!0):(Be&&J.nodeType===$d.text&&(Me=J.textContent,lh([G,$,z],la=>{Me=Ld(Me,la," ")}),J.textContent!==Me&&(zd(a.removed,{element:J.cloneNode()}),J.textContent=Me)),wa(F.afterSanitizeElements,J,null),!1)},Ei=function(J,Me,Ye){if(X&&(Me==="id"||Me==="name")&&(Ye in s||Ye in Xt))return!1;if(!(je&&!K[Me]&&Rs(H,Me))){if(!(_e&&Rs(I,Me))){if(!(oe.attributeCheck instanceof Function&&oe.attributeCheck(Me,J))){if(!M[Me]||K[Me]){if(!(yo(J)&&(ie.tagNameCheck instanceof RegExp&&Rs(ie.tagNameCheck,J)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(J))&&(ie.attributeNameCheck instanceof RegExp&&Rs(ie.attributeNameCheck,Me)||ie.attributeNameCheck instanceof Function&&ie.attributeNameCheck(Me,J))||Me==="is"&&ie.allowCustomizedBuiltInElements&&(ie.tagNameCheck instanceof RegExp&&Rs(ie.tagNameCheck,Ye)||ie.tagNameCheck instanceof Function&&ie.tagNameCheck(Ye))))return!1}else if(!Kt[Me]){if(!Rs(re,Ld(Ye,Y,""))){if(!((Me==="src"||Me==="xlink:href"||Me==="href")&&J!=="script"&&sz(Ye,"data:")===0&&rt[J])){if(!(Ie&&!Rs(O,Ld(Ye,Y,"")))){if(Ye)return!1}}}}}}}return!0},yo=function(J){return J!=="annotation-xml"&&vg(J,le)},vo=function(J){wa(F.beforeSanitizeAttributes,J,null);const{attributes:Me}=J;if(!Me||cs(J))return;const Ye={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M,forceKeepAttr:void 0};let la=Me.length;for(;la--;){const Oa=Me[la],{name:At,namespaceURI:vs,value:Tn}=Oa,Ys=Fe(At),yr=Tn;let ss=At==="value"?yr:nz(yr);if(Ye.attrName=Ys,Ye.attrValue=ss,Ye.keepAttr=!0,Ye.forceKeepAttr=void 0,wa(F.uponSanitizeAttribute,J,Ye),ss=Ye.attrValue,se&&(Ys==="id"||Ys==="name")&&(xa(At,J),ss=me+ss),ke&&Rs(/((--!?|])>)|<\/(style|title|textarea)/i,ss)){xa(At,J);continue}if(Ys==="attributename"&&vg(ss,"href")){xa(At,J);continue}if(Ye.forceKeepAttr)continue;if(!Ye.keepAttr){xa(At,J);continue}if(!ge&&Rs(/\/>/i,ss)){xa(At,J);continue}Be&&lh([G,$,z],Hc=>{ss=Ld(ss,Hc," ")});const $c=Fe(J.nodeName);if(!Ei($c,Ys,ss)){xa(At,J);continue}if(D&&typeof v=="object"&&typeof v.getAttributeType=="function"&&!vs)switch(v.getAttributeType($c,Ys)){case"TrustedHTML":{ss=D.createHTML(ss);break}case"TrustedScriptURL":{ss=D.createScriptURL(ss);break}}if(ss!==yr)try{vs?J.setAttributeNS(vs,At,ss):J.setAttribute(At,ss),cs(J)?Na(J):_w(a.removed)}catch{xa(At,J)}}wa(F.afterSanitizeAttributes,J,null)},Te=function He(J){let Me=null;const Ye=on(J);for(wa(F.beforeSanitizeShadowDOM,J,null);Me=Ye.nextNode();)wa(F.uponSanitizeShadowNode,Me,null),Gn(Me),vo(Me),Me.content instanceof o&&He(Me.content);wa(F.afterSanitizeShadowDOM,J,null)};return a.sanitize=function(He){let J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Me=null,Ye=null,la=null,Oa=null;if(_a=!He,_a&&(He="<!-->"),typeof He!="string"&&!Pa(He))if(typeof He.toString=="function"){if(He=He.toString(),typeof He!="string")throw Pd("dirty is not a string, aborting")}else throw Pd("toString is not a function");if(!a.isSupported)return He;if(Dt||ct(J),a.removed=[],typeof He=="string"&&(Re=!1),Re){if(He.nodeName){const Tn=Fe(He.nodeName);if(!Q[Tn]||ve[Tn])throw Pd("root node is forbidden and cannot be sanitized in-place")}}else if(He instanceof u)Me=ys("<!---->"),Ye=Me.ownerDocument.importNode(He,!0),Ye.nodeType===$d.element&&Ye.nodeName==="BODY"||Ye.nodeName==="HTML"?Me=Ye:Me.appendChild(Ye);else{if(!ja&&!Be&&!gt&&He.indexOf("<")===-1)return D&&Vt?D.createHTML(He):He;if(Me=ys(He),!Me)return ja?null:Vt?k:""}Me&&kt&&Na(Me.firstChild);const At=on(Re?He:Me);for(;la=At.nextNode();)Gn(la),vo(la),la.content instanceof o&&Te(la.content);if(Re)return He;if(ja){if(Wt)for(Oa=L.call(Me.ownerDocument);Me.firstChild;)Oa.appendChild(Me.firstChild);else Oa=Me;return(M.shadowroot||M.shadowrootmode)&&(Oa=V.call(r,Oa,!0)),Oa}let vs=gt?Me.outerHTML:Me.innerHTML;return gt&&Q["!doctype"]&&Me.ownerDocument&&Me.ownerDocument.doctype&&Me.ownerDocument.doctype.name&&Rs(zT,Me.ownerDocument.doctype.name)&&(vs="<!DOCTYPE "+Me.ownerDocument.doctype.name+`>
`+vs),Be&&lh([G,$,z],Tn=>{vs=Ld(vs,Tn," ")}),D&&Vt?D.createHTML(vs):vs},a.setConfig=function(){let He=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ct(He),Dt=!0},a.clearConfig=function(){lt=null,Dt=!1},a.isValidAttribute=function(He,J,Me){lt||ct({});const Ye=Fe(He),la=Fe(J);return Ei(Ye,la,Me)},a.addHook=function(He,J){typeof J=="function"&&zd(F[He],J)},a.removeHook=function(He,J){if(J!==void 0){const Me=tz(F[He],J);return Me===-1?void 0:az(F[He],Me,1)[0]}return _w(F[He])},a.removeHooks=function(He){F[He]=[]},a.removeAllHooks=function(){F=Lw()},a}var uo=LT();function Ey(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var po=Ey();function PT(t){po=t}var Jd={exec:()=>null};function aa(t,a=""){let s=typeof t=="string"?t:t.source,r={replace:(l,o)=>{let d=typeof o=="string"?o:o.source;return d=d.replace(Ps.caret,"$1"),s=s.replace(l,d),r},getRegex:()=>new RegExp(s,a)};return r}var vz=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Ps={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},bz=/^(?:[ \t]*(?:\n|$))+/,jz=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Nz=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,_u=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,wz=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ty=/(?:[*+-]|\d{1,9}[.)])/,BT=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,$T=aa(BT).replace(/bull/g,Ty).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Sz=aa(BT).replace(/bull/g,Ty).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Dy=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Cz=/^[^\n]+/,ky=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Ez=aa(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ky).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Tz=aa(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ty).getRegex(),zf="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Ay=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Dz=aa("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Ay).replace("tag",zf).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),HT=aa(Dy).replace("hr",_u).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",zf).getRegex(),kz=aa(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",HT).getRegex(),_y={blockquote:kz,code:jz,def:Ez,fences:Nz,heading:wz,hr:_u,html:Dz,lheading:$T,list:Tz,newline:bz,paragraph:HT,table:Jd,text:Cz},Pw=aa("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",_u).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",zf).getRegex(),Az={..._y,lheading:Sz,table:Pw,paragraph:aa(Dy).replace("hr",_u).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Pw).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",zf).getRegex()},_z={..._y,html:aa(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Ay).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Jd,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:aa(Dy).replace("hr",_u).replace("heading",` *#{1,6} *[^
]`).replace("lheading",$T).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Mz=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Oz=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,UT=/^( {2,}|\\)\n(?!\s*$)/,Rz=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Lf=/[\p{P}\p{S}]/u,My=/[\s\p{P}\p{S}]/u,VT=/[^\s\p{P}\p{S}]/u,Iz=aa(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,My).getRegex(),YT=/(?!~)[\p{P}\p{S}]/u,zz=/(?!~)[\s\p{P}\p{S}]/u,Lz=/(?:[^\s\p{P}\p{S}]|~)/u,Pz=aa(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",vz?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),qT=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Bz=aa(qT,"u").replace(/punct/g,Lf).getRegex(),$z=aa(qT,"u").replace(/punct/g,YT).getRegex(),FT="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Hz=aa(FT,"gu").replace(/notPunctSpace/g,VT).replace(/punctSpace/g,My).replace(/punct/g,Lf).getRegex(),Uz=aa(FT,"gu").replace(/notPunctSpace/g,Lz).replace(/punctSpace/g,zz).replace(/punct/g,YT).getRegex(),Vz=aa("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,VT).replace(/punctSpace/g,My).replace(/punct/g,Lf).getRegex(),Yz=aa(/\\(punct)/,"gu").replace(/punct/g,Lf).getRegex(),qz=aa(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Fz=aa(Ay).replace("(?:-->|$)","-->").getRegex(),Gz=aa("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Fz).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Yh=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Wz=aa(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Yh).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),GT=aa(/^!?\[(label)\]\[(ref)\]/).replace("label",Yh).replace("ref",ky).getRegex(),WT=aa(/^!?\[(ref)\](?:\[\])?/).replace("ref",ky).getRegex(),Kz=aa("reflink|nolink(?!\\()","g").replace("reflink",GT).replace("nolink",WT).getRegex(),Bw=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Oy={_backpedal:Jd,anyPunctuation:Yz,autolink:qz,blockSkip:Pz,br:UT,code:Oz,del:Jd,emStrongLDelim:Bz,emStrongRDelimAst:Hz,emStrongRDelimUnd:Vz,escape:Mz,link:Wz,nolink:WT,punctuation:Iz,reflink:GT,reflinkSearch:Kz,tag:Gz,text:Rz,url:Jd},Xz={...Oy,link:aa(/^!?\[(label)\]\((.*?)\)/).replace("label",Yh).getRegex(),reflink:aa(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Yh).getRegex()},T0={...Oy,emStrongRDelimAst:Uz,emStrongLDelim:$z,url:aa(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",Bw).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:aa(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",Bw).getRegex()},Qz={...T0,br:aa(UT).replace("{2,}","*").getRegex(),text:aa(T0.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ch={normal:_y,gfm:Az,pedantic:_z},Hd={normal:Oy,gfm:T0,breaks:Qz,pedantic:Xz},Zz={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$w=t=>Zz[t];function ri(t,a){if(a){if(Ps.escapeTest.test(t))return t.replace(Ps.escapeReplace,$w)}else if(Ps.escapeTestNoEncode.test(t))return t.replace(Ps.escapeReplaceNoEncode,$w);return t}function Hw(t){try{t=encodeURI(t).replace(Ps.percentDecode,"%")}catch{return null}return t}function Uw(t,a){let s=t.replace(Ps.findPipe,(o,d,u)=>{let m=!1,h=d;for(;--h>=0&&u[h]==="\\";)m=!m;return m?"|":" |"}),r=s.split(Ps.splitPipe),l=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),a)if(r.length>a)r.splice(a);else for(;r.length<a;)r.push("");for(;l<r.length;l++)r[l]=r[l].trim().replace(Ps.slashPipe,"|");return r}function Ud(t,a,s){let r=t.length;if(r===0)return"";let l=0;for(;l<r&&t.charAt(r-l-1)===a;)l++;return t.slice(0,r-l)}function Jz(t,a){if(t.indexOf(a[1])===-1)return-1;let s=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===a[0])s++;else if(t[r]===a[1]&&(s--,s<0))return r;return s>0?-2:-1}function Vw(t,a,s,r,l){let o=a.href,d=a.title||null,u=t[1].replace(l.other.outputLinkReplace,"$1");r.state.inLink=!0;let m={type:t[0].charAt(0)==="!"?"image":"link",raw:s,href:o,title:d,text:u,tokens:r.inlineTokens(u)};return r.state.inLink=!1,m}function eL(t,a,s){let r=t.match(s.other.indentCodeCompensation);if(r===null)return a;let l=r[1];return a.split(`
`).map(o=>{let d=o.match(s.other.beginningSpace);if(d===null)return o;let[u]=d;return u.length>=l.length?o.slice(l.length):o}).join(`
`)}var qh=class{options;rules;lexer;constructor(t){this.options=t||po}space(t){let a=this.rules.block.newline.exec(t);if(a&&a[0].length>0)return{type:"space",raw:a[0]}}code(t){let a=this.rules.block.code.exec(t);if(a){let s=a[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:a[0],codeBlockStyle:"indented",text:this.options.pedantic?s:Ud(s,`
`)}}}fences(t){let a=this.rules.block.fences.exec(t);if(a){let s=a[0],r=eL(s,a[3]||"",this.rules);return{type:"code",raw:s,lang:a[2]?a[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):a[2],text:r}}}heading(t){let a=this.rules.block.heading.exec(t);if(a){let s=a[2].trim();if(this.rules.other.endingHash.test(s)){let r=Ud(s,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(s=r.trim())}return{type:"heading",raw:a[0],depth:a[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(t){let a=this.rules.block.hr.exec(t);if(a)return{type:"hr",raw:Ud(a[0],`
`)}}blockquote(t){let a=this.rules.block.blockquote.exec(t);if(a){let s=Ud(a[0],`
`).split(`
`),r="",l="",o=[];for(;s.length>0;){let d=!1,u=[],m;for(m=0;m<s.length;m++)if(this.rules.other.blockquoteStart.test(s[m]))u.push(s[m]),d=!0;else if(!d)u.push(s[m]);else break;s=s.slice(m);let h=u.join(`
`),g=h.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${h}`:h,l=l?`${l}
${g}`:g;let x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(g,o,!0),this.lexer.state.top=x,s.length===0)break;let y=o.at(-1);if(y?.type==="code")break;if(y?.type==="blockquote"){let v=y,b=v.raw+`
`+s.join(`
`),N=this.blockquote(b);o[o.length-1]=N,r=r.substring(0,r.length-v.raw.length)+N.raw,l=l.substring(0,l.length-v.text.length)+N.text;break}else if(y?.type==="list"){let v=y,b=v.raw+`
`+s.join(`
`),N=this.list(b);o[o.length-1]=N,r=r.substring(0,r.length-y.raw.length)+N.raw,l=l.substring(0,l.length-v.raw.length)+N.raw,s=b.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:l}}}list(t){let a=this.rules.block.list.exec(t);if(a){let s=a[1].trim(),r=s.length>1,l={type:"list",raw:"",ordered:r,start:r?+s.slice(0,-1):"",loose:!1,items:[]};s=r?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=r?s:"[*+-]");let o=this.rules.other.listItemRegex(s),d=!1;for(;t;){let m=!1,h="",g="";if(!(a=o.exec(t))||this.rules.block.hr.test(t))break;h=a[0],t=t.substring(h.length);let x=a[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,N=>" ".repeat(3*N.length)),y=t.split(`
`,1)[0],v=!x.trim(),b=0;if(this.options.pedantic?(b=2,g=x.trimStart()):v?b=a[1].length+1:(b=a[2].search(this.rules.other.nonSpaceChar),b=b>4?1:b,g=x.slice(b),b+=a[1].length),v&&this.rules.other.blankLine.test(y)&&(h+=y+`
`,t=t.substring(y.length+1),m=!0),!m){let N=this.rules.other.nextBulletRegex(b),S=this.rules.other.hrRegex(b),w=this.rules.other.fencesBeginRegex(b),E=this.rules.other.headingBeginRegex(b),T=this.rules.other.htmlBeginRegex(b);for(;t;){let D=t.split(`
`,1)[0],k;if(y=D,this.options.pedantic?(y=y.replace(this.rules.other.listReplaceNesting,"  "),k=y):k=y.replace(this.rules.other.tabCharGlobal,"    "),w.test(y)||E.test(y)||T.test(y)||N.test(y)||S.test(y))break;if(k.search(this.rules.other.nonSpaceChar)>=b||!y.trim())g+=`
`+k.slice(b);else{if(v||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||w.test(x)||E.test(x)||S.test(x))break;g+=`
`+y}!v&&!y.trim()&&(v=!0),h+=D+`
`,t=t.substring(D.length+1),x=k.slice(b)}}l.loose||(d?l.loose=!0:this.rules.other.doubleBlankLine.test(h)&&(d=!0)),l.items.push({type:"list_item",raw:h,task:!!this.options.gfm&&this.rules.other.listIsTask.test(g),loose:!1,text:g,tokens:[]}),l.raw+=h}let u=l.items.at(-1);if(u)u.raw=u.raw.trimEnd(),u.text=u.text.trimEnd();else return;l.raw=l.raw.trimEnd();for(let m of l.items){if(this.lexer.state.top=!1,m.tokens=this.lexer.blockTokens(m.text,[]),m.task){if(m.text=m.text.replace(this.rules.other.listReplaceTask,""),m.tokens[0]?.type==="text"||m.tokens[0]?.type==="paragraph"){m.tokens[0].raw=m.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),m.tokens[0].text=m.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let g=this.lexer.inlineQueue.length-1;g>=0;g--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[g].src)){this.lexer.inlineQueue[g].src=this.lexer.inlineQueue[g].src.replace(this.rules.other.listReplaceTask,"");break}}let h=this.rules.other.listTaskCheckbox.exec(m.raw);if(h){let g={type:"checkbox",raw:h[0]+" ",checked:h[0]!=="[ ]"};m.checked=g.checked,l.loose?m.tokens[0]&&["paragraph","text"].includes(m.tokens[0].type)&&"tokens"in m.tokens[0]&&m.tokens[0].tokens?(m.tokens[0].raw=g.raw+m.tokens[0].raw,m.tokens[0].text=g.raw+m.tokens[0].text,m.tokens[0].tokens.unshift(g)):m.tokens.unshift({type:"paragraph",raw:g.raw,text:g.raw,tokens:[g]}):m.tokens.unshift(g)}}if(!l.loose){let h=m.tokens.filter(x=>x.type==="space"),g=h.length>0&&h.some(x=>this.rules.other.anyLine.test(x.raw));l.loose=g}}if(l.loose)for(let m of l.items){m.loose=!0;for(let h of m.tokens)h.type==="text"&&(h.type="paragraph")}return l}}html(t){let a=this.rules.block.html.exec(t);if(a)return{type:"html",block:!0,raw:a[0],pre:a[1]==="pre"||a[1]==="script"||a[1]==="style",text:a[0]}}def(t){let a=this.rules.block.def.exec(t);if(a){let s=a[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=a[2]?a[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",l=a[3]?a[3].substring(1,a[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):a[3];return{type:"def",tag:s,raw:a[0],href:r,title:l}}}table(t){let a=this.rules.block.table.exec(t);if(!a||!this.rules.other.tableDelimiter.test(a[2]))return;let s=Uw(a[1]),r=a[2].replace(this.rules.other.tableAlignChars,"").split("|"),l=a[3]?.trim()?a[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:a[0],header:[],align:[],rows:[]};if(s.length===r.length){for(let d of r)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<s.length;d++)o.header.push({text:s[d],tokens:this.lexer.inline(s[d]),header:!0,align:o.align[d]});for(let d of l)o.rows.push(Uw(d,o.header.length).map((u,m)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:o.align[m]})));return o}}lheading(t){let a=this.rules.block.lheading.exec(t);if(a)return{type:"heading",raw:a[0],depth:a[2].charAt(0)==="="?1:2,text:a[1],tokens:this.lexer.inline(a[1])}}paragraph(t){let a=this.rules.block.paragraph.exec(t);if(a){let s=a[1].charAt(a[1].length-1)===`
`?a[1].slice(0,-1):a[1];return{type:"paragraph",raw:a[0],text:s,tokens:this.lexer.inline(s)}}}text(t){let a=this.rules.block.text.exec(t);if(a)return{type:"text",raw:a[0],text:a[0],tokens:this.lexer.inline(a[0])}}escape(t){let a=this.rules.inline.escape.exec(t);if(a)return{type:"escape",raw:a[0],text:a[1]}}tag(t){let a=this.rules.inline.tag.exec(t);if(a)return!this.lexer.state.inLink&&this.rules.other.startATag.test(a[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(a[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(a[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(a[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:a[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:a[0]}}link(t){let a=this.rules.inline.link.exec(t);if(a){let s=a[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(s)){if(!this.rules.other.endAngleBracket.test(s))return;let o=Ud(s.slice(0,-1),"\\");if((s.length-o.length)%2===0)return}else{let o=Jz(a[2],"()");if(o===-2)return;if(o>-1){let d=(a[0].indexOf("!")===0?5:4)+a[1].length+o;a[2]=a[2].substring(0,o),a[0]=a[0].substring(0,d).trim(),a[3]=""}}let r=a[2],l="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],l=o[3])}else l=a[3]?a[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(s)?r=r.slice(1):r=r.slice(1,-1)),Vw(a,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:l&&l.replace(this.rules.inline.anyPunctuation,"$1")},a[0],this.lexer,this.rules)}}reflink(t,a){let s;if((s=this.rules.inline.reflink.exec(t))||(s=this.rules.inline.nolink.exec(t))){let r=(s[2]||s[1]).replace(this.rules.other.multipleSpaceGlobal," "),l=a[r.toLowerCase()];if(!l){let o=s[0].charAt(0);return{type:"text",raw:o,text:o}}return Vw(s,l,s[0],this.lexer,this.rules)}}emStrong(t,a,s=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!(!r||r[3]&&s.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!s||this.rules.inline.punctuation.exec(s))){let l=[...r[0]].length-1,o,d,u=l,m=0,h=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,a=a.slice(-1*t.length+l);(r=h.exec(a))!=null;){if(o=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!o)continue;if(d=[...o].length,r[3]||r[4]){u+=d;continue}else if((r[5]||r[6])&&l%3&&!((l+d)%3)){m+=d;continue}if(u-=d,u>0)continue;d=Math.min(d,d+u+m);let g=[...r[0]][0].length,x=t.slice(0,l+r.index+g+d);if(Math.min(l,d)%2){let v=x.slice(1,-1);return{type:"em",raw:x,text:v,tokens:this.lexer.inlineTokens(v)}}let y=x.slice(2,-2);return{type:"strong",raw:x,text:y,tokens:this.lexer.inlineTokens(y)}}}}codespan(t){let a=this.rules.inline.code.exec(t);if(a){let s=a[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(s),l=this.rules.other.startingSpaceChar.test(s)&&this.rules.other.endingSpaceChar.test(s);return r&&l&&(s=s.substring(1,s.length-1)),{type:"codespan",raw:a[0],text:s}}}br(t){let a=this.rules.inline.br.exec(t);if(a)return{type:"br",raw:a[0]}}del(t){let a=this.rules.inline.del.exec(t);if(a)return{type:"del",raw:a[0],text:a[2],tokens:this.lexer.inlineTokens(a[2])}}autolink(t){let a=this.rules.inline.autolink.exec(t);if(a){let s,r;return a[2]==="@"?(s=a[1],r="mailto:"+s):(s=a[1],r=s),{type:"link",raw:a[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}url(t){let a;if(a=this.rules.inline.url.exec(t)){let s,r;if(a[2]==="@")s=a[0],r="mailto:"+s;else{let l;do l=a[0],a[0]=this.rules.inline._backpedal.exec(a[0])?.[0]??"";while(l!==a[0]);s=a[0],a[1]==="www."?r="http://"+a[0]:r=a[0]}return{type:"link",raw:a[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t){let a=this.rules.inline.text.exec(t);if(a){let s=this.lexer.state.inRawBlock;return{type:"text",raw:a[0],text:a[0],escaped:s}}}},er=class D0{tokens;options;state;inlineQueue;tokenizer;constructor(a){this.tokens=[],this.tokens.links=Object.create(null),this.options=a||po,this.options.tokenizer=this.options.tokenizer||new qh,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let s={other:Ps,block:ch.normal,inline:Hd.normal};this.options.pedantic?(s.block=ch.pedantic,s.inline=Hd.pedantic):this.options.gfm&&(s.block=ch.gfm,this.options.breaks?s.inline=Hd.breaks:s.inline=Hd.gfm),this.tokenizer.rules=s}static get rules(){return{block:ch,inline:Hd}}static lex(a,s){return new D0(s).lex(a)}static lexInline(a,s){return new D0(s).inlineTokens(a)}lex(a){a=a.replace(Ps.carriageReturn,`
`),this.blockTokens(a,this.tokens);for(let s=0;s<this.inlineQueue.length;s++){let r=this.inlineQueue[s];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(a,s=[],r=!1){for(this.options.pedantic&&(a=a.replace(Ps.tabCharGlobal,"    ").replace(Ps.spaceLine,""));a;){let l;if(this.options.extensions?.block?.some(d=>(l=d.call({lexer:this},a,s))?(a=a.substring(l.raw.length),s.push(l),!0):!1))continue;if(l=this.tokenizer.space(a)){a=a.substring(l.raw.length);let d=s.at(-1);l.raw.length===1&&d!==void 0?d.raw+=`
`:s.push(l);continue}if(l=this.tokenizer.code(a)){a=a.substring(l.raw.length);let d=s.at(-1);d?.type==="paragraph"||d?.type==="text"?(d.raw+=(d.raw.endsWith(`
`)?"":`
`)+l.raw,d.text+=`
`+l.text,this.inlineQueue.at(-1).src=d.text):s.push(l);continue}if(l=this.tokenizer.fences(a)){a=a.substring(l.raw.length),s.push(l);continue}if(l=this.tokenizer.heading(a)){a=a.substring(l.raw.length),s.push(l);continue}if(l=this.tokenizer.hr(a)){a=a.substring(l.raw.length),s.push(l);continue}if(l=this.tokenizer.blockquote(a)){a=a.substring(l.raw.length),s.push(l);continue}if(l=this.tokenizer.list(a)){a=a.substring(l.raw.length),s.push(l);continue}if(l=this.tokenizer.html(a)){a=a.substring(l.raw.length),s.push(l);continue}if(l=this.tokenizer.def(a)){a=a.substring(l.raw.length);let d=s.at(-1);d?.type==="paragraph"||d?.type==="text"?(d.raw+=(d.raw.endsWith(`
`)?"":`
`)+l.raw,d.text+=`
`+l.raw,this.inlineQueue.at(-1).src=d.text):this.tokens.links[l.tag]||(this.tokens.links[l.tag]={href:l.href,title:l.title},s.push(l));continue}if(l=this.tokenizer.table(a)){a=a.substring(l.raw.length),s.push(l);continue}if(l=this.tokenizer.lheading(a)){a=a.substring(l.raw.length),s.push(l);continue}let o=a;if(this.options.extensions?.startBlock){let d=1/0,u=a.slice(1),m;this.options.extensions.startBlock.forEach(h=>{m=h.call({lexer:this},u),typeof m=="number"&&m>=0&&(d=Math.min(d,m))}),d<1/0&&d>=0&&(o=a.substring(0,d+1))}if(this.state.top&&(l=this.tokenizer.paragraph(o))){let d=s.at(-1);r&&d?.type==="paragraph"?(d.raw+=(d.raw.endsWith(`
`)?"":`
`)+l.raw,d.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):s.push(l),r=o.length!==a.length,a=a.substring(l.raw.length);continue}if(l=this.tokenizer.text(a)){a=a.substring(l.raw.length);let d=s.at(-1);d?.type==="text"?(d.raw+=(d.raw.endsWith(`
`)?"":`
`)+l.raw,d.text+=`
`+l.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=d.text):s.push(l);continue}if(a){let d="Infinite loop on byte: "+a.charCodeAt(0);if(this.options.silent){console.error(d);break}else throw new Error(d)}}return this.state.top=!0,s}inline(a,s=[]){return this.inlineQueue.push({src:a,tokens:s}),s}inlineTokens(a,s=[]){let r=a,l=null;if(this.tokens.links){let m=Object.keys(this.tokens.links);if(m.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)m.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(l=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,l.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o;for(;(l=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)o=l[2]?l[2].length:0,r=r.slice(0,l.index+o)+"["+"a".repeat(l[0].length-o-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let d=!1,u="";for(;a;){d||(u=""),d=!1;let m;if(this.options.extensions?.inline?.some(g=>(m=g.call({lexer:this},a,s))?(a=a.substring(m.raw.length),s.push(m),!0):!1))continue;if(m=this.tokenizer.escape(a)){a=a.substring(m.raw.length),s.push(m);continue}if(m=this.tokenizer.tag(a)){a=a.substring(m.raw.length),s.push(m);continue}if(m=this.tokenizer.link(a)){a=a.substring(m.raw.length),s.push(m);continue}if(m=this.tokenizer.reflink(a,this.tokens.links)){a=a.substring(m.raw.length);let g=s.at(-1);m.type==="text"&&g?.type==="text"?(g.raw+=m.raw,g.text+=m.text):s.push(m);continue}if(m=this.tokenizer.emStrong(a,r,u)){a=a.substring(m.raw.length),s.push(m);continue}if(m=this.tokenizer.codespan(a)){a=a.substring(m.raw.length),s.push(m);continue}if(m=this.tokenizer.br(a)){a=a.substring(m.raw.length),s.push(m);continue}if(m=this.tokenizer.del(a)){a=a.substring(m.raw.length),s.push(m);continue}if(m=this.tokenizer.autolink(a)){a=a.substring(m.raw.length),s.push(m);continue}if(!this.state.inLink&&(m=this.tokenizer.url(a))){a=a.substring(m.raw.length),s.push(m);continue}let h=a;if(this.options.extensions?.startInline){let g=1/0,x=a.slice(1),y;this.options.extensions.startInline.forEach(v=>{y=v.call({lexer:this},x),typeof y=="number"&&y>=0&&(g=Math.min(g,y))}),g<1/0&&g>=0&&(h=a.substring(0,g+1))}if(m=this.tokenizer.inlineText(h)){a=a.substring(m.raw.length),m.raw.slice(-1)!=="_"&&(u=m.raw.slice(-1)),d=!0;let g=s.at(-1);g?.type==="text"?(g.raw+=m.raw,g.text+=m.text):s.push(m);continue}if(a){let g="Infinite loop on byte: "+a.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return s}},Fh=class{options;parser;constructor(t){this.options=t||po}space(t){return""}code({text:t,lang:a,escaped:s}){let r=(a||"").match(Ps.notSpaceStart)?.[0],l=t.replace(Ps.endingNewline,"")+`
`;return r?'<pre><code class="language-'+ri(r)+'">'+(s?l:ri(l,!0))+`</code></pre>
`:"<pre><code>"+(s?l:ri(l,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}def(t){return""}heading({tokens:t,depth:a}){return`<h${a}>${this.parser.parseInline(t)}</h${a}>
`}hr(t){return`<hr>
`}list(t){let a=t.ordered,s=t.start,r="";for(let d=0;d<t.items.length;d++){let u=t.items[d];r+=this.listitem(u)}let l=a?"ol":"ul",o=a&&s!==1?' start="'+s+'"':"";return"<"+l+o+`>
`+r+"</"+l+`>
`}listitem(t){return`<li>${this.parser.parse(t.tokens)}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let a="",s="";for(let l=0;l<t.header.length;l++)s+=this.tablecell(t.header[l]);a+=this.tablerow({text:s});let r="";for(let l=0;l<t.rows.length;l++){let o=t.rows[l];s="";for(let d=0;d<o.length;d++)s+=this.tablecell(o[d]);r+=this.tablerow({text:s})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+a+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let a=this.parser.parseInline(t.tokens),s=t.header?"th":"td";return(t.align?`<${s} align="${t.align}">`:`<${s}>`)+a+`</${s}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${ri(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:a,tokens:s}){let r=this.parser.parseInline(s),l=Hw(t);if(l===null)return r;t=l;let o='<a href="'+t+'"';return a&&(o+=' title="'+ri(a)+'"'),o+=">"+r+"</a>",o}image({href:t,title:a,text:s,tokens:r}){r&&(s=this.parser.parseInline(r,this.parser.textRenderer));let l=Hw(t);if(l===null)return ri(s);t=l;let o=`<img src="${t}" alt="${s}"`;return a&&(o+=` title="${ri(a)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:ri(t.text)}},Ry=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}checkbox({raw:t}){return t}},tr=class k0{options;renderer;textRenderer;constructor(a){this.options=a||po,this.options.renderer=this.options.renderer||new Fh,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Ry}static parse(a,s){return new k0(s).parse(a)}static parseInline(a,s){return new k0(s).parseInline(a)}parse(a){let s="";for(let r=0;r<a.length;r++){let l=a[r];if(this.options.extensions?.renderers?.[l.type]){let d=l,u=this.options.extensions.renderers[d.type].call({parser:this},d);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(d.type)){s+=u||"";continue}}let o=l;switch(o.type){case"space":{s+=this.renderer.space(o);break}case"hr":{s+=this.renderer.hr(o);break}case"heading":{s+=this.renderer.heading(o);break}case"code":{s+=this.renderer.code(o);break}case"table":{s+=this.renderer.table(o);break}case"blockquote":{s+=this.renderer.blockquote(o);break}case"list":{s+=this.renderer.list(o);break}case"checkbox":{s+=this.renderer.checkbox(o);break}case"html":{s+=this.renderer.html(o);break}case"def":{s+=this.renderer.def(o);break}case"paragraph":{s+=this.renderer.paragraph(o);break}case"text":{s+=this.renderer.text(o);break}default:{let d='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(d),"";throw new Error(d)}}}return s}parseInline(a,s=this.renderer){let r="";for(let l=0;l<a.length;l++){let o=a[l];if(this.options.extensions?.renderers?.[o.type]){let u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=u||"";continue}}let d=o;switch(d.type){case"escape":{r+=s.text(d);break}case"html":{r+=s.html(d);break}case"link":{r+=s.link(d);break}case"image":{r+=s.image(d);break}case"checkbox":{r+=s.checkbox(d);break}case"strong":{r+=s.strong(d);break}case"em":{r+=s.em(d);break}case"codespan":{r+=s.codespan(d);break}case"br":{r+=s.br(d);break}case"del":{r+=s.del(d);break}case"text":{r+=s.text(d);break}default:{let u='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(u),"";throw new Error(u)}}}return r}},Qd=class{options;block;constructor(t){this.options=t||po}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}emStrongMask(t){return t}provideLexer(){return this.block?er.lex:er.lexInline}provideParser(){return this.block?tr.parse:tr.parseInline}},tL=class{defaults=Ey();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=tr;Renderer=Fh;TextRenderer=Ry;Lexer=er;Tokenizer=qh;Hooks=Qd;constructor(...t){this.use(...t)}walkTokens(t,a){let s=[];for(let r of t)switch(s=s.concat(a.call(this,r)),r.type){case"table":{let l=r;for(let o of l.header)s=s.concat(this.walkTokens(o.tokens,a));for(let o of l.rows)for(let d of o)s=s.concat(this.walkTokens(d.tokens,a));break}case"list":{let l=r;s=s.concat(this.walkTokens(l.items,a));break}default:{let l=r;this.defaults.extensions?.childTokens?.[l.type]?this.defaults.extensions.childTokens[l.type].forEach(o=>{let d=l[o].flat(1/0);s=s.concat(this.walkTokens(d,a))}):l.tokens&&(s=s.concat(this.walkTokens(l.tokens,a)))}}return s}use(...t){let a=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(s=>{let r={...s};if(r.async=this.defaults.async||r.async||!1,s.extensions&&(s.extensions.forEach(l=>{if(!l.name)throw new Error("extension name required");if("renderer"in l){let o=a.renderers[l.name];o?a.renderers[l.name]=function(...d){let u=l.renderer.apply(this,d);return u===!1&&(u=o.apply(this,d)),u}:a.renderers[l.name]=l.renderer}if("tokenizer"in l){if(!l.level||l.level!=="block"&&l.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=a[l.level];o?o.unshift(l.tokenizer):a[l.level]=[l.tokenizer],l.start&&(l.level==="block"?a.startBlock?a.startBlock.push(l.start):a.startBlock=[l.start]:l.level==="inline"&&(a.startInline?a.startInline.push(l.start):a.startInline=[l.start]))}"childTokens"in l&&l.childTokens&&(a.childTokens[l.name]=l.childTokens)}),r.extensions=a),s.renderer){let l=this.defaults.renderer||new Fh(this.defaults);for(let o in s.renderer){if(!(o in l))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let d=o,u=s.renderer[d],m=l[d];l[d]=(...h)=>{let g=u.apply(l,h);return g===!1&&(g=m.apply(l,h)),g||""}}r.renderer=l}if(s.tokenizer){let l=this.defaults.tokenizer||new qh(this.defaults);for(let o in s.tokenizer){if(!(o in l))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let d=o,u=s.tokenizer[d],m=l[d];l[d]=(...h)=>{let g=u.apply(l,h);return g===!1&&(g=m.apply(l,h)),g}}r.tokenizer=l}if(s.hooks){let l=this.defaults.hooks||new Qd;for(let o in s.hooks){if(!(o in l))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let d=o,u=s.hooks[d],m=l[d];Qd.passThroughHooks.has(o)?l[d]=h=>{if(this.defaults.async&&Qd.passThroughHooksRespectAsync.has(o))return(async()=>{let x=await u.call(l,h);return m.call(l,x)})();let g=u.call(l,h);return m.call(l,g)}:l[d]=(...h)=>{if(this.defaults.async)return(async()=>{let x=await u.apply(l,h);return x===!1&&(x=await m.apply(l,h)),x})();let g=u.apply(l,h);return g===!1&&(g=m.apply(l,h)),g}}r.hooks=l}if(s.walkTokens){let l=this.defaults.walkTokens,o=s.walkTokens;r.walkTokens=function(d){let u=[];return u.push(o.call(this,d)),l&&(u=u.concat(l.call(this,d))),u}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,a){return er.lex(t,a??this.defaults)}parser(t,a){return tr.parse(t,a??this.defaults)}parseMarkdown(t){return(a,s)=>{let r={...s},l={...this.defaults,...r},o=this.onError(!!l.silent,!!l.async);if(this.defaults.async===!0&&r.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof a>"u"||a===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof a!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(a)+", string expected"));if(l.hooks&&(l.hooks.options=l,l.hooks.block=t),l.async)return(async()=>{let d=l.hooks?await l.hooks.preprocess(a):a,u=await(l.hooks?await l.hooks.provideLexer():t?er.lex:er.lexInline)(d,l),m=l.hooks?await l.hooks.processAllTokens(u):u;l.walkTokens&&await Promise.all(this.walkTokens(m,l.walkTokens));let h=await(l.hooks?await l.hooks.provideParser():t?tr.parse:tr.parseInline)(m,l);return l.hooks?await l.hooks.postprocess(h):h})().catch(o);try{l.hooks&&(a=l.hooks.preprocess(a));let d=(l.hooks?l.hooks.provideLexer():t?er.lex:er.lexInline)(a,l);l.hooks&&(d=l.hooks.processAllTokens(d)),l.walkTokens&&this.walkTokens(d,l.walkTokens);let u=(l.hooks?l.hooks.provideParser():t?tr.parse:tr.parseInline)(d,l);return l.hooks&&(u=l.hooks.postprocess(u)),u}catch(d){return o(d)}}}onError(t,a){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let r="<p>An error occurred:</p><pre>"+ri(s.message+"",!0)+"</pre>";return a?Promise.resolve(r):r}if(a)return Promise.reject(s);throw s}}},mo=new tL;function Zt(t,a){return mo.parse(t,a)}Zt.options=Zt.setOptions=function(t){return mo.setOptions(t),Zt.defaults=mo.defaults,PT(Zt.defaults),Zt};Zt.getDefaults=Ey;Zt.defaults=po;Zt.use=function(...t){return mo.use(...t),Zt.defaults=mo.defaults,PT(Zt.defaults),Zt};Zt.walkTokens=function(t,a){return mo.walkTokens(t,a)};Zt.parseInline=mo.parseInline;Zt.Parser=tr;Zt.parser=tr.parse;Zt.Renderer=Fh;Zt.TextRenderer=Ry;Zt.Lexer=er;Zt.lexer=er.lex;Zt.Tokenizer=qh;Zt.Hooks=Qd;Zt.parse=Zt;Zt.options;Zt.setOptions;Zt.use;Zt.walkTokens;Zt.parseInline;tr.parse;er.lex;Zt.setOptions({breaks:!0,gfm:!0});const KT=t=>{try{const a=Zt.parse(t);return uo.sanitize(a)}catch{return uo.sanitize(t.replace(/\n/g,"<br>"))}},Mu=t=>{const a=t.match(/^\s*- \[(?: |x|X)\]/gm);if(!a||a.length===0)return{total:0,checked:0};const s=a.filter(r=>r.toLowerCase().startsWith("- [x]")).length;return{total:a.length,checked:s}},Gl=t=>{const{total:a,checked:s}=Mu(t);if(!a)return 0;const r=Math.round(s/a*100);return Math.min(100,Math.max(0,r))};async function Iy(t,a){try{const{data:l,error:o}=await ze.from("tasks").select("task_code").eq("user_id",t).not("task_code","is",null);if(o)throw o;const d=new Set;if(a&&a.forEach(h=>{Number.isInteger(h)&&d.add(h)}),l&&l.forEach(h=>{h.task_code&&typeof h.task_code=="number"&&d.add(h.task_code)}),d.size===0)return 1e4;const u=Array.from(d).sort((h,g)=>h-g);for(let h=0;h<u.length-1;h++)if(u[h+1]-u[h]>1)return u[h]+1;const m=Math.max(...u);return m<99999?m+1:await Yw(t,d)}catch(l){return console.error("Error generating task code:",l),await Yw(t,new Set)}}async function Yw(t,a){for(let o=0;o<10;o++){const d=Math.floor(Math.random()*9e4)+1e4;if(!a.has(d)&&await aL(t,d))return d}throw new Error("Unable to generate unique task code after multiple attempts")}async function aL(t,a){try{const{data:s,error:r}=await ze.from("tasks").select("id").eq("user_id",t).eq("task_code",a).limit(1);return r?(console.error("Error checking task code uniqueness:",r),!1):!s||s.length===0}catch(s){return console.error("Error checking task code uniqueness:",s),!1}}const Pf=()=>{const[t,a]=p.useState([]),[s,r]=p.useState([]),[l,o]=p.useState("idle"),[d,u]=p.useState(null),[m,h]=p.useState(!1),[g,x]=p.useState(null),[y,v]=p.useState("create"),{user:b}=st(),N=p.useRef(new Set),S=p.useCallback(()=>t.filter($=>!$.isPrivate),[t]),w=p.useCallback(()=>{h(!1),x(null),o("idle"),u(null),v("create")},[]),E=p.useCallback(async()=>{if(b){o("loading"),u(null);try{const{data:$,error:z}=await Yl.table("tasks").select("*").eq("user_id",b.id).order("created_at",{ascending:!1});if(z)throw z;const H=($||[]).map(O=>({id:O.id,taskCode:O.task_code||0,title:O.title,description:O.description||"",completed:O.completed,createdAt:O.created_at?{seconds:new Date(O.created_at).getTime()/1e3}:void 0,updatedAt:O.updated_at?new Date(O.updated_at):void 0,startDate:O.start_date?new Date(O.start_date):void 0,endDate:O.end_date?new Date(O.end_date):void 0,isRecurrent:O.is_recurrent||!1,isPrivate:O.is_private||!1,category:O.category||"other",priority:O.priority||"delete",size:O.size||"pequea",estimatedTime:O.estimated_time,timeOfDay:O.time_of_day,elapsedSeconds:O.elapsed_seconds||0,progress:typeof O.progress=="number"?O.progress:Gl(O.description||""),recurrence:O.recurrence?{frequency:O.recurrence.frequency,pattern:O.recurrence.pattern,customDays:O.recurrence.customDays,nextDate:O.recurrence.nextDate?new Date(O.recurrence.nextDate):void 0}:void 0}));r(H);const I=H.filter(O=>!O.completed).sort((O,Y)=>O.startDate&&Y.startDate?O.startDate.getTime()-Y.startDate.getTime():O.startDate?-1:Y.startDate?1:(Y.createdAt?.seconds||0)-(O.createdAt?.seconds||0));a(I),o("saved")}catch($){console.error("Error loading tasks:",$),u($ instanceof Error?$.message:"Error loading tasks"),o("error")}}},[b]);p.useEffect(()=>{E()},[E]);const T=p.useCallback(async()=>{if(!b)return 0;const $=new Set;N.current.forEach(H=>$.add(H)),s.forEach(H=>{Number.isInteger(H.taskCode)&&H.taskCode>0&&$.add(H.taskCode)});const z=await Iy(b.id,$);return N.current.add(z),z},[s,b]),D=p.useCallback(async $=>{if(!$.title.trim()||!b)return;o("saving"),u(null);let z=0;try{if($.startDate&&$.endDate&&$.endDate<$.startDate){u("La fecha de fin debe ser posterior a la fecha de inicio"),o("error");return}z=await T();const H=$.elapsedSeconds??0,I={id:`temp-${Date.now()}`,taskCode:z,title:$.title.trim(),description:$.description?.trim()||"",completed:!1,createdAt:{seconds:Date.now()/1e3},startDate:$.startDate||void 0,endDate:$.endDate||void 0,category:$.category||"other",priority:$.priority||"delete",size:$.size||"pequea",elapsedSeconds:H,progress:Gl($.description||""),isRecurrent:$.isRecurrent||!1,isPrivate:$.isPrivate||!1,...$.timeOfDay&&{timeOfDay:$.timeOfDay},...$.estimatedTime!==void 0&&{estimatedTime:$.estimatedTime},...$.recurrence&&{recurrence:$.recurrence}};a(re=>[...re,I].sort((Q,q)=>Q.startDate&&q.startDate?Q.startDate.getTime()-q.startDate.getTime():Q.startDate?-1:q.startDate?1:(q.createdAt?.seconds||0)-(Q.createdAt?.seconds||0))),r(re=>[...re,I]);const O={user_id:b.id,task_code:z,title:$.title.trim(),completed:!1,created_at:new Date().toISOString(),category:$.category||"other",priority:$.priority||"delete",size:$.size||"pequea",elapsed_seconds:H,progress:Gl($.description||"")};$.description?.trim()&&(O.description=$.description.trim()),$.startDate&&(O.start_date=$.startDate.toISOString()),$.endDate&&(O.end_date=$.endDate.toISOString()),$.isPrivate&&(O.is_private=!0),$.timeOfDay&&(O.time_of_day=$.timeOfDay),$.estimatedTime!==void 0&&(O.estimated_time=$.estimatedTime),$.elapsedSeconds!==void 0&&(O.elapsed_seconds=$.elapsedSeconds),$.isRecurrent&&$.recurrence&&(O.is_recurrent=!0,O.recurrence={frequency:$.recurrence.frequency,pattern:$.recurrence.pattern},$.recurrence.pattern==="custom"&&$.recurrence.customDays&&(O.recurrence.customDays=$.recurrence.customDays));const{data:Y,error:le}=await Yl.table("tasks").insert(O).select().single();if(le)throw le;a(re=>re.map(Q=>Q.id===I.id?{...Q,id:Y.id}:Q)),r(re=>re.map(Q=>Q.id===I.id?{...Q,id:Y.id}:Q)),o("saved")}catch(H){console.error("Error al guardar tarea:",H),z&&N.current.delete(z),a(I=>I.filter(O=>!O.id.startsWith("temp-"))),r(I=>I.filter(O=>!O.id.startsWith("temp-"))),u(H instanceof Error?H.message:"Error al guardar"),o("error")}},[b,T]),k=p.useCallback(async($,z)=>{if(!b)return;o("saving");const H=t.find(I=>I.id===$);if(H)try{const I=z.startDate!==void 0?z.startDate:H.startDate,O=z.endDate!==void 0?z.endDate:H.endDate;if(I&&O&&O<I){u("La fecha de fin debe ser posterior a la fecha de inicio"),o("error");return}const Y={...H,...z.title?.trim()&&{title:z.title.trim()},...typeof z.description=="string"&&{description:z.description.trim()},...z.startDate!==void 0&&{startDate:z.startDate||void 0},...z.endDate!==void 0&&{endDate:z.endDate||void 0},...z.category&&{category:z.category},...z.priority&&{priority:z.priority},...z.size&&{size:z.size},...z.estimatedTime!==void 0&&{estimatedTime:z.estimatedTime},...z.elapsedSeconds!==void 0&&{elapsedSeconds:z.elapsedSeconds},...z.timeOfDay&&{timeOfDay:z.timeOfDay},...z.isPrivate!==void 0&&{isPrivate:z.isPrivate},...z.isRecurrent!==void 0&&{isRecurrent:z.isRecurrent},...z.recurrence&&{recurrence:z.recurrence}};Y.progress=Gl(typeof z.description=="string"?z.description:H.description||""),a(Q=>Q.map(q=>q.id===$?Y:q).sort((q,M)=>q.startDate&&M.startDate?q.startDate.getTime()-M.startDate.getTime():q.startDate?-1:M.startDate?1:(M.createdAt?.seconds||0)-(q.createdAt?.seconds||0))),r(Q=>Q.map(q=>q.id===$?Y:q));const le={updated_at:new Date().toISOString(),progress:Y.progress};z.title?.trim()&&(le.title=z.title.trim()),typeof z.description=="string"&&(le.description=z.description.trim()||null),z.startDate!==void 0&&(le.start_date=z.startDate?z.startDate.toISOString():null),z.endDate!==void 0&&(le.end_date=z.endDate?z.endDate.toISOString():null),z.category&&(le.category=z.category),z.priority&&(le.priority=z.priority),z.size&&(le.size=z.size),z.estimatedTime!==void 0&&(le.estimated_time=z.estimatedTime),z.elapsedSeconds!==void 0&&(le.elapsed_seconds=z.elapsedSeconds),z.timeOfDay&&(le.time_of_day=z.timeOfDay),z.isPrivate!==void 0&&(le.is_private=z.isPrivate),z.isRecurrent!==void 0&&(le.is_recurrent=z.isRecurrent,z.isRecurrent||(le.recurrence=null)),z.recurrence&&(le.recurrence={frequency:z.recurrence.frequency,pattern:z.recurrence.pattern},z.recurrence.pattern==="custom"&&z.recurrence.customDays&&(le.recurrence.customDays=z.recurrence.customDays));const{error:re}=await Yl.table("tasks").update(le).eq("id",$);if(re)throw re;o("saved"),w()}catch(I){console.error("Error al actualizar:",I),a(O=>O.map(Y=>Y.id===$?H:Y)),r(O=>O.map(Y=>Y.id===$?H:Y)),u(I instanceof Error?I.message:"Error al actualizar"),o("error")}},[b,t,w]),_=p.useCallback(async($,z)=>{if(b){o("saving");try{const H=t.find(I=>I.id===$);if(!H)throw new Error("Tarea no encontrada");if(!H.isRecurrent){z&&a(O=>O.filter(Y=>Y.id!==$));const{error:I}=await Yl.table("tasks").update({completed:z,updated_at:new Date().toISOString()}).eq("id",$);if(I)throw I;o("saved");return}x(H),v("complete"),h(!0)}catch(H){if(console.error("Error al actualizar estado:",H),z){const I=t.find(O=>O.id===$);I&&a(O=>[...O,I])}u(H instanceof Error?H.message:"Error al actualizar"),o("error")}}},[b,t]),R=p.useCallback(async $=>{if(!b)return;o("saving");const z=t.find(H=>H.id===$);if(z)try{a(I=>I.filter(O=>O.id!==$));const{error:H}=await Yl.table("tasks").delete().eq("id",$);if(H)throw H;o("saved")}catch(H){console.error("Error al eliminar:",H),a(I=>[...I,z].sort((O,Y)=>O.startDate&&Y.startDate?O.startDate.getTime()-Y.startDate.getTime():O.startDate?-1:Y.startDate?1:(Y.createdAt?.seconds||0)-(O.createdAt?.seconds||0))),u(H instanceof Error?H.message:"Error al eliminar"),o("error")}},[b,t]),L=p.useCallback(async $=>{if(!g||!b)return;o("saving");let z=0;try{z=await T();const H={id:`temp-${Date.now()}`,taskCode:z,title:g.title,description:$.description?.trim()||g.description||"",completed:!1,createdAt:{seconds:Date.now()/1e3},startDate:$.startDate||void 0,endDate:$.endDate||void 0,isRecurrent:!0,category:g.category,priority:g.priority||"delete",size:g.size||"pequea",elapsedSeconds:0,progress:Gl($.description?.trim()||g.description||""),isPrivate:g.isPrivate||!1,...$.timeOfDay&&{timeOfDay:$.timeOfDay},recurrence:{pattern:g.recurrence?.pattern||"daily",frequency:g.recurrence?.frequency||1,...g.recurrence?.pattern==="custom"&&{customDays:g.recurrence.customDays}}};a(le=>[...le.filter(Q=>Q.id!==g.id),H].sort((Q,q)=>Q.startDate&&q.startDate?Q.startDate.getTime()-q.startDate.getTime():Q.startDate?-1:q.startDate?1:(q.createdAt?.seconds||0)-(Q.createdAt?.seconds||0))),await Yl.table("tasks").update({completed:!0,updated_at:new Date().toISOString()}).eq("id",g.id);const I={user_id:b.id,task_code:z,title:g.title,completed:!1,created_at:new Date().toISOString(),elapsed_seconds:0,start_date:$.startDate?$.startDate.toISOString():null,end_date:$.endDate?$.endDate.toISOString():null,is_recurrent:!0,category:g.category,priority:g.priority||"delete",size:g.size||"pequea",progress:Gl($.description?.trim()||g.description||""),...$.timeOfDay&&{time_of_day:$.timeOfDay},recurrence:{pattern:g.recurrence?.pattern||"daily",frequency:g.recurrence?.frequency||1,...g.recurrence?.pattern==="custom"&&{customDays:g.recurrence.customDays}}};($.description?.trim()||g.description)&&(I.description=$.description?.trim()||g.description);const{data:O,error:Y}=await Yl.table("tasks").insert(I).select().single();if(Y)throw Y;a(le=>le.map(re=>re.id===H.id?{...re,id:O.id}:re)),o("saved"),w()}catch(H){console.error("Error al procesar tarea recurrente:",H),z&&N.current.delete(z),a(I=>[...I.filter(Y=>!Y.id.startsWith("temp-")),g].sort((Y,le)=>Y.startDate&&le.startDate?Y.startDate.getTime()-le.startDate.getTime():Y.startDate?-1:le.startDate?1:(le.createdAt?.seconds||0)-(Y.createdAt?.seconds||0))),u(H instanceof Error?H.message:"Error al actualizar tarea recurrente"),o("error")}},[g,b,w,T]),U=p.useCallback(($,z)=>{v("create"),x({id:"",taskCode:0,title:"",completed:!1,category:"personal",priority:"delete",size:"pequea",createdAt:{seconds:Date.now()/1e3},...$?{startDate:$}:{},...z?{isPrivate:!0}:{},timeOfDay:void 0,progress:0}),h(!0)},[]),V=p.useCallback($=>{x($),v("edit"),h(!0),o("idle")},[]),F=p.useCallback(async()=>{try{o("loading"),u(null),await E()}catch($){console.error("Error reloading tasks:",$),u("Error al recargar. Intenta recargar la pgina manualmente."),o("error")}},[E]),G=p.useMemo(()=>t.filter($=>!$.isPrivate),[t]);return p.useMemo(()=>({tasks:G,allTasks:s,status:l,error:d,showRecurrenceModal:m,currentTask:g,modalMode:y,addTask:D,editTask:k,toggleTask:_,deleteTask:R,completeRecurrentTask:L,setShowRecurrenceModal:w,openEditModal:V,openCreateModal:U,getPublicTasks:S,loadTasks:E,clearCacheAndReload:F}),[G,s,l,d,m,g,y,D,k,_,R,L,w,U,V,S,E,F])},sL=({date:t,variant:a="compact"})=>{const s=it(),{allTasks:r,status:l}=Pf(),o=l==="loading",d=ka(t),u=Kl(t),m=r.filter(v=>{if(!v.completed||!v.updatedAt)return!1;const b=v.updatedAt;return b>=d&&b<=u}).length,h=r.filter(v=>v.completed||!v.startDate?!1:v.startDate<=u).length,g=r.filter(v=>{if(v.completed||!v.startDate)return!1;const b=v.startDate;return b>=d&&b<=u}).length,x=r.filter(v=>v.completed||!v.startDate?!1:v.startDate<d).length,y=()=>{s(ae.task.view("list"))};return e.jsx(zc,{title:"Tareas",icon:Rh,variant:a,loading:o,onClick:()=>s(ae.task.view("list")),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-bold text-purple-600",children:[m,"/",h]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[g," hoy",x>0&&e.jsxs("span",{className:"text-red-500 ml-1",children:[" ",x," vencidas"]})]})]}),e.jsxs(P,{size:"sm",variant:"outline",onClick:v=>{v.stopPropagation(),y()},className:"flex items-center gap-1",children:[e.jsx(It,{className:"w-3 h-3"}),a==="detailed"&&"Nueva"]})]}),a==="detailed"&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full transition-all duration-300",style:{width:`${h>0?m/h*100:0}%`}})}),e.jsx("p",{className:"text-xs text-gray-600",children:h>0?`${(m/h*100).toFixed(0)}% progreso diario`:"Sin tareas pendientes"})]})]})})},XT=t=>{const[a,s]=p.useState([]),[r,l]=p.useState("idle"),[o,d]=p.useState(null),{user:u}=st(),m=p.useCallback(async()=>{if(!u)return;l("pending"),d(null);const y=Ue(t);try{const{data:v,error:b}=await sn.getEnergyEntriesByDate(u.id,y);if(b)throw b;const N=(v||[]).map(S=>({level:S.level,comment:S.comment,timestamp:S.timestamp,time:S.time}));s(N),l("saved")}catch(v){console.error("Error loading energy data:",v),d(v instanceof Error?v.message:"Error loading energy data"),l("error")}},[u,t]);p.useEffect(()=>{m()},[m]);const h=p.useCallback(async(y,v)=>{if(!u)return;l("saving"),d(null);const b=Ue(t),N=new Date,S=$n(t,N.getHours(),N.getMinutes()),w={level:y,comment:v,timestamp:S.timestamp,time:N.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})},E=[...a,w];s(E);try{const{error:T}=await sn.insertEnergyEntry({userId:u.id,date:b,level:y,comment:v||null,timestamp:w.timestamp,time:w.time});if(T)throw T;l("saved")}catch(T){console.error("Energy - Error al guardar:",T),s(a),d(T instanceof Error?T.message:"Error al guardar"),l("error")}},[u,t,a]),g=p.useCallback(async(y,v)=>{if(!u)return;l("saving"),d(null);const b=Ue(t),N=a;try{const S=a.map(E=>E.timestamp===y?v:E);s(S);const{error:w}=await sn.updateEnergyEntry({userId:u.id,date:b,originalTimestamp:y,level:v.level,comment:v.comment||null,timestamp:v.timestamp,time:v.time});if(w)throw w;l("saved")}catch(S){console.error("Energy - Error al actualizar:",S),s(N),d(S instanceof Error?S.message:"Error al actualizar"),l("error")}},[u,t,a]),x=p.useCallback(async y=>{if(!u)return;l("saving"),d(null);const v=Ue(t),b=a;try{const N=a.filter(w=>w.timestamp!==y);s(N);const{error:S}=await sn.deleteEnergyEntry(u.id,v,y);if(S)throw S;l("saved")}catch(N){console.error("Energy - Error al eliminar:",N),s(b),d(N instanceof Error?N.message:"Error al eliminar"),l("error")}},[u,t,a]);return{energyHistory:a,status:r,error:o,addEntry:h,updateEntry:g,deleteEntry:x,loadEnergyData:m}},nL=({date:t,variant:a="compact"})=>{const s=it(),{energyHistory:r,status:l}=XT(t),o=l==="saving"||l==="pending",d=r||[],u=d.length,m=d.length>0?d.reduce((v,b)=>v+b.level,0)/d.length:0,h=d[d.length-1],g=v=>v>=4.5?r1:v>=3.5?a0:v>=2.5?s0:v>=1.5?i1:l1,x=v=>v>=4.5?"text-green-600":v>=3.5?"text-lime-500":v>=2.5?"text-yellow-500":v>=1.5?"text-orange-500":"text-red-500",y=g(m);return e.jsx(zc,{title:"Nivel de Energa",icon:a0,variant:a,loading:o,onClick:()=>s(ae.mood.view("tracker")),children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:u>0?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:`w-6 h-6 ${x(m)}`}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[m.toFixed(1),"/5"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[u," registro",u>1?"s":""]})]})]})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s0,{className:"w-6 h-6 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Sin registros"})]})}),e.jsxs(P,{size:"sm",variant:"outline",onClick:v=>{v.stopPropagation(),s(ae.mood.view("tracker"))},className:"flex items-center gap-1",children:[e.jsx(It,{className:"w-3 h-3"}),a==="detailed"&&"Registrar"]})]}),a==="detailed"&&h&&e.jsxs("div",{className:"text-xs text-gray-600 p-2 bg-gray-50 rounded",children:[e.jsx("p",{className:"font-medium",children:"ltimo registro:"}),e.jsxs("p",{children:["Nivel ",h.level,"/5 - ",h.time,h.comment&&` - "${h.comment}"`]})]})]})})},rL=({date:t,variant:a="detailed",className:s})=>{const r=it(),{completedHabits:l,status:o,toggleHabit:d}=Mf(t),u=o==="saving"||o==="pending",[m,h]=p.useState(null),g=Ue(t),x=new Date().getHours(),v=x>=6&&x<12?"morning":x>=12&&x<18?"afternoon":x>=18&&x<24?"night":"anytime",[b,N]=p.useState(new Set([v])),S=nn.reduce((L,U)=>{const V=U.timeOfDay||"anytime";return L[V]||(L[V]=[]),L[V].push(U),L},{}),w={morning:" Maana",afternoon:" Tarde",night:" Noche",anytime:" Cualquier momento"},E=["morning","afternoon","night","anytime"],T=L=>{N(U=>{const V=new Set(U);return V.has(L)?V.delete(L):V.add(L),V})},D=async L=>{if(m!==L){h(L);try{await d(L,g)}catch(U){console.error("Error toggling habit:",U)}finally{h(null)}}},k=nn.length,_=Object.entries(l).filter(([L,U])=>L.endsWith(`_${g}`)&&U).length,R=k>0?_/k*100:0;return e.jsx(zc,{title:"Hbitos del Da",icon:xi,variant:a,loading:u,className:s,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[_,"/",k," completados"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[R.toFixed(0),"% del da"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"w-16 h-16 relative",children:[e.jsxs("svg",{className:"w-16 h-16 transform -rotate-90",viewBox:"0 0 100 100",children:[e.jsx("circle",{cx:"50",cy:"50",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",className:"text-gray-200"}),e.jsx("circle",{cx:"50",cy:"50",r:"40",stroke:"currentColor",strokeWidth:"8",fill:"transparent",strokeDasharray:`${2*Math.PI*40}`,strokeDashoffset:`${2*Math.PI*40*(1-R/100)}`,className:"text-green-500 transition-all duration-300"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xs font-bold text-green-600",children:[R.toFixed(0),"%"]})})]})})]}),e.jsx("div",{className:"space-y-3",children:E.map(L=>{const U=S[L]||[];if(U.length===0)return null;const V=L===v,F=b.has(L);return e.jsxs("div",{className:he("border rounded-lg transition-all duration-200",V?"border-blue-300 bg-blue-50 shadow-sm":"border-gray-200 bg-white"),children:[e.jsxs("button",{type:"button",onClick:()=>T(L),className:he("w-full flex items-center justify-between p-3 text-left hover:bg-gray-50 transition-colors rounded-lg",V&&"hover:bg-blue-100"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:he("text-sm font-medium",V?"text-blue-700":"text-gray-700"),children:w[L]}),V&&e.jsx(xs,{className:"w-3 h-3 text-blue-500"})]}),F?e.jsx(rn,{className:"w-4 h-4 text-gray-400"}):e.jsx(wn,{className:"w-4 h-4 text-gray-400"})]}),F&&e.jsx("div",{className:"space-y-2 px-3 pb-3",children:U.map(G=>{const $=`${G.id}_${g}`,z=l[$]||!1,H=m===G.id;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:I=>{I.stopPropagation(),D(G.id)},disabled:H,className:he("flex-1 flex items-center gap-3 p-2 rounded-md transition-all duration-200 text-left",z?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-50 text-gray-700 hover:bg-gray-100",H&&"opacity-50 cursor-not-allowed"),children:[e.jsx("div",{className:"flex-shrink-0",children:H?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):z?e.jsx(xi,{className:"w-4 h-4 text-green-600"}):e.jsx(sy,{className:"w-4 h-4 text-gray-400"})}),e.jsx("span",{className:"text-lg mr-2",children:G.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:he("text-sm font-medium truncate",z&&"line-through"),children:G.name}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:G.goal})]})]}),G.steps&&G.steps.length>0&&e.jsx("button",{type:"button",onClick:I=>{I.stopPropagation(),r(`/habit/${G.id}/run`,{state:{date:t.toISOString()}})},className:"flex-shrink-0 p-2 rounded-md bg-blue-50 text-blue-600 hover:bg-blue-100 transition-colors",title:"Iniciar hbito paso a paso",children:e.jsx(Bs,{className:"w-4 h-4"})})]},G.id)})})]},L)})})]})})},iL=()=>{const[t,a]=p.useState(new Date);return{selectedDate:t,setSelectedDate:a}},lL=()=>{const{selectedDate:t,setSelectedDate:a}=iL();return e.jsxs(wi,{children:[e.jsx(jl,{selectedDate:t,onChange:a}),e.jsx("div",{className:"mb-8"}),e.jsx("div",{className:"mb-8"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-8 gap-4 mb-8",children:[e.jsx(WI,{date:t,variant:"compact"}),e.jsx(XI,{date:t,variant:"compact"}),e.jsx(QI,{date:t,variant:"compact"}),e.jsx(sL,{date:t,variant:"compact"}),e.jsx(nL,{date:t,variant:"compact"})]}),e.jsx("div",{className:"mb-8"}),e.jsx("div",{className:"mb-8",children:e.jsx(rL,{date:t})}),e.jsx("div",{className:"mt-6",children:e.jsx(HI,{})})]})},oL={module:"home",defaultRoute:ae.home,moduleRoutes:[{index:!0,element:e.jsx(lL,{})}]},fe=p.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:he("rounded-lg border bg-card text-card-foreground shadow-sm overflow-hidden",t),...a}));fe.displayName="Card";const xt=p.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:he("flex flex-col space-y-1.5 p-4 md:p-6",t),...a}));xt.displayName="CardHeader";const mt=p.forwardRef(({className:t,...a},s)=>e.jsx("h3",{ref:s,className:he("text-lg md:text-2xl font-semibold leading-none tracking-tight",t),...a}));mt.displayName="CardTitle";const il=p.forwardRef(({className:t,...a},s)=>e.jsx("p",{ref:s,className:he("text-sm md:text-base text-muted-foreground",t),...a}));il.displayName="CardDescription";const xe=p.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:he("p-4 md:p-6 pt-0",t),...a}));xe.displayName="CardContent";const cL=p.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:he("flex items-center p-4 md:p-6 pt-0",t),...a}));cL.displayName="CardFooter";const dL=({view:t,onViewChange:a})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{variant:t==="weekly"?"default":"outline",size:"sm",onClick:()=>a("weekly"),className:"gap-2",children:[e.jsx(Aa,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Semanal"})]}),e.jsxs(P,{variant:t==="graph"?"default":"outline",size:"sm",onClick:()=>a("graph"),className:"gap-2",children:[e.jsx(o1,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Anual"})]})]}),QT=(t=new Date)=>{const a=new Date(t);let s=a.getDay();s=s===0?6:s-1;const r=[];for(let l=0;l<7;l++){const o=new Date(a);o.setDate(a.getDate()-s+l),r.push({dayName:["L","M","X","J","V","S","D"][l],fullDate:Ue(o)})}return r};function uL(t,a=[]){let s=[];function r(o,d){const u=p.createContext(d);u.displayName=o+"Context";const m=s.length;s=[...s,d];const h=x=>{const{scope:y,children:v,...b}=x,N=y?.[t]?.[m]||u,S=p.useMemo(()=>b,Object.values(b));return e.jsx(N.Provider,{value:S,children:v})};h.displayName=o+"Provider";function g(x,y){const v=y?.[t]?.[m]||u,b=p.useContext(v);if(b)return b;if(d!==void 0)return d;throw new Error(`\`${x}\` must be used within \`${o}\``)}return[h,g]}const l=()=>{const o=s.map(d=>p.createContext(d));return function(u){const m=u?.[t]||o;return p.useMemo(()=>({[`__scope${t}`]:{...u,[t]:m}}),[u,m])}};return l.scopeName=t,[r,mL(l,...a)]}function mL(...t){const a=t[0];if(t.length===1)return a;const s=()=>{const r=t.map(l=>({useScope:l(),scopeName:l.scopeName}));return function(o){const d=r.reduce((u,{useScope:m,scopeName:h})=>{const x=m(o)[`__scope${h}`];return{...u,...x}},{});return p.useMemo(()=>({[`__scope${a.scopeName}`]:d}),[d])}};return s.scopeName=a.scopeName,s}var hL=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ZT=hL.reduce((t,a)=>{const s=Tf(`Primitive.${a}`),r=p.forwardRef((l,o)=>{const{asChild:d,...u}=l,m=d?s:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...u,ref:o})});return r.displayName=`Primitive.${a}`,{...t,[a]:r}},{}),zy="Progress",Ly=100,[fL,M7]=uL(zy),[pL,xL]=fL(zy),JT=p.forwardRef((t,a)=>{const{__scopeProgress:s,value:r=null,max:l,getValueLabel:o=gL,...d}=t;(l||l===0)&&!qw(l)&&console.error(yL(`${l}`,"Progress"));const u=qw(l)?l:Ly;r!==null&&!Fw(r,u)&&console.error(vL(`${r}`,"Progress"));const m=Fw(r,u)?r:null,h=Gh(m)?o(m,u):void 0;return e.jsx(pL,{scope:s,value:m,max:u,children:e.jsx(ZT.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":Gh(m)?m:void 0,"aria-valuetext":h,role:"progressbar","data-state":aD(m,u),"data-value":m??void 0,"data-max":u,...d,ref:a})})});JT.displayName=zy;var eD="ProgressIndicator",tD=p.forwardRef((t,a)=>{const{__scopeProgress:s,...r}=t,l=xL(eD,s);return e.jsx(ZT.div,{"data-state":aD(l.value,l.max),"data-value":l.value??void 0,"data-max":l.max,...r,ref:a})});tD.displayName=eD;function gL(t,a){return`${Math.round(t/a*100)}%`}function aD(t,a){return t==null?"indeterminate":t===a?"complete":"loading"}function Gh(t){return typeof t=="number"}function qw(t){return Gh(t)&&!isNaN(t)&&t>0}function Fw(t,a){return Gh(t)&&!isNaN(t)&&t<=a&&t>=0}function yL(t,a){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${a}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Ly}\`.`}function vL(t,a){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${a}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Ly} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var sD=JT,bL=tD;const Us=p.forwardRef(({className:t,value:a,...s},r)=>e.jsx(sD,{ref:r,className:he("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...s,children:e.jsx(bL,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})}));Us.displayName=sD.displayName;const Py=hM,Bf=p.forwardRef(({className:t,...a},s)=>e.jsx(uM,{ref:s,className:he("border-b",t),...a}));Bf.displayName="AccordionItem";const $f=p.forwardRef(({className:t,children:a,...s},r)=>e.jsx(mM,{className:"flex",children:e.jsxs($C,{ref:r,className:he("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...s,children:[a,e.jsx(rn,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));$f.displayName=$C.displayName;const Hf=p.forwardRef(({className:t,children:a,...s},r)=>e.jsx(HC,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...s,children:e.jsx("div",{className:he("pb-4 pt-0",t),children:a})}));Hf.displayName=HC.displayName;const Gw={morning:{icon:d1,title:"Maana",defaultOpen:()=>{const t=new Date().getHours();return t>=5&&t<12}},afternoon:{icon:n0,title:"Tarde",defaultOpen:()=>{const t=new Date().getHours();return t>=12&&t<18}},night:{icon:c1,title:"Noche",defaultOpen:()=>{const t=new Date().getHours();return t>=18||t<5}},anytime:{icon:n0,title:"Cualquier momento",defaultOpen:()=>!1}},jL=t=>t>=.9?"Increble! Sigue as! ":t>=.7?"Vas muy bien! No pares! ":t>=.5?"Buen progreso! Sigue adelante! ":t>=.3?"Cada pequeo paso cuenta! ":"Hoy es un buen da para empezar! ",NL=(t,a)=>{const s=new Date;let r=0;for(let l=0;l<30;l++){const o=new Date(s);o.setDate(o.getDate()-l);const d=Ue(o);if(t.every(m=>a[`${m.id}_${d}`]))r++;else if(l<7)break}return r},nD=({children:t,completedHabits:a})=>{const[s,r]=p.useState(()=>Object.entries(Gw).filter(([d,u])=>u.defaultOpen()).map(([d])=>d)),l=te.useMemo(()=>nn.reduce((d,u)=>(d[u.timeOfDay]||(d[u.timeOfDay]=[]),d[u.timeOfDay].push(u),d),{}),[]),o=d=>{const u=QT(),m=Ue(),h=d.filter(y=>a[`${y.id}_${m}`]).length;let g=0;const x=d.length*u.length;return u.forEach(y=>{d.forEach(v=>{a[`${v.id}_${y.fullDate}`]&&g++})}),{daily:{completed:h,total:d.length},weekly:{completed:g,total:x}}};return e.jsx(Py,{type:"multiple",value:s,onValueChange:r,className:"w-full space-y-4",children:Object.entries(l).map(([d,u])=>{const m=Gw[d],h=m.icon,g=o(u),x=NL(u,a),y=g.daily.completed/g.daily.total;return e.jsxs(Bf,{value:d,className:"rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx($f,{className:"w-full px-6 py-4 flex items-center justify-between text-left hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring data-[state=closed]:rounded-b-lg data-[state=open]:border-b",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:m.title}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Hoy: ",g.daily.completed,"/",g.daily.total]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Semana: ",g.weekly.completed,"/",g.weekly.total]}),x>0&&e.jsxs("div",{className:"flex items-center gap-1 text-amber-500",children:[e.jsx(fc,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:x})]})]})]})}),e.jsx(Hf,{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-6",children:[t(u),e.jsxs("div",{className:"pt-2 space-y-3 border-t border-gray-100",children:[e.jsx(Us,{value:g.daily.completed/g.daily.total*100,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:jL(y)}),g.daily.completed===g.daily.total&&e.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[e.jsx(u1,{className:"w-4 h-4"}),e.jsx("span",{children:"Completado!"})]})]})]})]})})]},d)})})},wL=({completedHabits:t,onToggle:a,disabled:s})=>{const r=QT(new Date),l=o=>e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-[480px] sm:min-w-[600px]",children:e.jsxs("div",{className:"grid grid-cols-[minmax(80px,140px)_repeat(7,minmax(32px,1fr))] sm:grid-cols-[minmax(120px,180px)_repeat(7,minmax(40px,1fr))] gap-1 sm:gap-2",children:[e.jsx("div",{}),r.map(d=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-xs sm:text-sm",children:d.dayName}),e.jsx("div",{className:"text-[9px] sm:text-[10px] text-gray-400",children:d.fullDate.split("-").slice(1).join("/")})]},d.fullDate)),o.map(d=>e.jsxs(te.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 pr-1",children:[e.jsx("span",{className:"text-sm sm:text-base shrink-0",children:d.icon}),e.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium truncate leading-tight",children:d.name}),e.jsx("span",{className:"text-[10px] sm:text-xs text-gray-500 truncate leading-tight",children:d.goal})]})]}),r.map(u=>{const m=t[`${d.id}_${u.fullDate}`];return e.jsx(P,{variant:m?"default":"outline",className:`h-8 w-8 sm:h-10 sm:w-10 p-0 aspect-square rounded-lg flex items-center justify-center transition-colors mx-auto my-0.5 sm:my-1
                      ${m?NE[d.id]:"border-gray-300"}`,onClick:()=>a(d.id,u.fullDate),disabled:s,children:m?e.jsx(xi,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}):null},`${d.id}_${u.fullDate}`)})]},d.id))]})})});return e.jsx("div",{className:"w-full",children:e.jsx(nD,{completedHabits:t,children:l})})},rD=({year:t,renderCell:a})=>{const s=O5(t);return e.jsxs("div",{className:"inline-block min-w-full",children:[e.jsx("div",{className:"flex gap-1 mb-2 ml-8",children:s.map((r,l)=>e.jsx("div",{className:he("text-xs text-gray-500 text-center",l===0?"w-8":"w-14"),style:{minWidth:l===0?"32px":`${Math.ceil(r.days/7)*12}px`},children:r.name.slice(0,3)},r.name))}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("div",{className:"flex flex-col gap-1 text-xs text-gray-500 pr-2",children:[e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"L"}),e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"M"}),e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"V"}),e.jsx("div",{className:"h-3"})]}),e.jsx("div",{className:"flex gap-1",children:s.map(r=>{const l=String(r.number).padStart(2,"0"),o=new Date(t,r.number-1,1).getDay(),d=o===0?6:o-1,u=d+r.days,m=Math.ceil(u/7);return e.jsx("div",{className:"flex gap-1",children:Array.from({length:m},(h,g)=>e.jsx("div",{className:"flex flex-col gap-1",children:Array.from({length:7},(x,y)=>{const v=g*7+y-d+1;if(v<1||v>r.days)return e.jsx("div",{className:"w-3 h-3"},y);const b=String(v).padStart(2,"0"),N=`${t}-${l}-${b}`;return e.jsx(te.Fragment,{children:a(N)},N)})},g))},r.name)})})]})]})},SL=({completedHabits:t,onToggle:a})=>{const s=new Date().getFullYear(),r=l=>e.jsx("div",{className:"space-y-8",children:l.map(o=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-xl",children:o.icon}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-base",children:o.name}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",o.goal,")"]})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx(rD,{year:s,renderCell:d=>{const u=t[`${o.id}_${d}`],m=new Date().toISOString().split("T")[0]===d;return e.jsx(P,{variant:"ghost",onClick:()=>a(o.id,d),className:he("w-3 h-3 p-0 rounded-full border transition-all duration-200 hover:scale-110",u?"bg-green-600 border-green-700 hover:bg-green-700":"bg-gray-100 border-gray-200 hover:bg-gray-200 hover:border-gray-300",m&&"ring-2 ring-blue-400 ring-offset-1"),title:`${o.name} - ${new Date(d).toLocaleDateString("es-ES")}${u?" (Completado)":""}`})}}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 text-xs text-gray-600",children:[e.jsx("span",{children:"Menos"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-100 border border-gray-200 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-200 border border-green-300 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-400 border border-green-500 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-600 border border-green-700 rounded-full"})]}),e.jsx("span",{children:"Ms"})]})]})]},o.id))});return e.jsx("div",{className:"w-full",children:e.jsx(nD,{completedHabits:t,children:r})})},CL=()=>{const[t,a]=p.useState({}),[s,r]=p.useState("idle"),[l,o]=p.useState(null),{user:d}=st();return p.useEffect(()=>{if(!d)return;(async()=>{try{const g=new Date().getFullYear(),x=`${g}-01-01`,y=`${g}-12-31`,{data:v,error:b}=await $h.getHabitCompletionsByRange(d.id,x,y);if(b)throw b;const N={};(v||[]).forEach(S=>{const w=`${S.habit_id}_${S.date}`;N[w]=S.completed}),a(N),r("saved")}catch(h){console.error("Error loading habits:",h),o(h instanceof Error?h.message:"Error loading habits"),r("error")}})()},[d]),{completedHabits:t,status:s,error:l,toggleHabit:async(m,h)=>{if(!d)return;r("saving"),o(null);const g=`${m}_${h}`,x=t[g]||!1,y=!x;a(v=>({...v,[g]:y}));try{const{error:v}=await $h.upsertHabitCompletion({userId:d.id,habitId:m,date:h,completed:y});if(v)throw v;r("saved")}catch(v){console.error("Error toggling habit:",v),a(b=>({...b,[g]:x})),o(v instanceof Error?v.message:"Error al guardar"),r("error")}}}},Hn=pM,Un=xM,EL=gM,iD=p.forwardRef(({className:t,inset:a,children:s,...r},l)=>e.jsxs(UC,{ref:l,className:he("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",t),...r,children:[s,e.jsx(wn,{className:"ml-auto h-4 w-4"})]}));iD.displayName=UC.displayName;const lD=p.forwardRef(({className:t,...a},s)=>e.jsx(VC,{ref:s,className:he("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a}));lD.displayName=VC.displayName;const Nn=p.forwardRef(({className:t,sideOffset:a=4,...s},r)=>e.jsx(fM,{children:e.jsx(YC,{ref:r,sideOffset:a,className:he("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));Nn.displayName=YC.displayName;const Lt=p.forwardRef(({className:t,inset:a,...s},r)=>e.jsx(qC,{ref:r,className:he("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...s}));Lt.displayName=qC.displayName;const TL=p.forwardRef(({className:t,children:a,checked:s,...r},l)=>e.jsxs(FC,{ref:l,className:he("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:s,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(GC,{children:e.jsx(cr,{className:"h-4 w-4"})})}),a]}));TL.displayName=FC.displayName;const DL=p.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(WC,{ref:r,className:he("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(GC,{children:e.jsx(sy,{className:"h-2 w-2 fill-current"})})}),a]}));DL.displayName=WC.displayName;const kL=p.forwardRef(({className:t,inset:a,...s},r)=>e.jsx(KC,{ref:r,className:he("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...s}));kL.displayName=KC.displayName;const Ou=p.forwardRef(({className:t,...a},s)=>e.jsx(XC,{ref:s,className:he("-mx-1 my-1 h-px bg-muted",t),...a}));Ou.displayName=XC.displayName;const Qi="Puedes usar etiquetas HTML bsicas como <b>, <i> o <br> para dar formato a la respuesta.",Zd={goals:{model:"gemini-2.5-flash",prompts:{taskSuggestions:`Asistente Inteligente de Planificacin de Objetivos
Eres un experto en productividad y planificacin de objetivos que ayuda a las personas a estructurar mejor sus metas mediante tareas especficas y accionables.

Tu funcin principal:
Analizar un objetivo especfico, sus tareas actuales y avances para sugerir nuevas tareas que ayuden a completar el objetivo de manera ms efectiva.

Instrucciones:
1. Analiza el objetivo principal y su descripcin
2. Revisa las tareas existentes para identificar patrones y vacos
3. Considera los avances registrados para entender el progreso actual
4. Si hay una meta numrica, ten en cuenta el valor objetivo y actual
5. Sugiere 5-8 tareas especficas, accionables y realistas
6. Ordena las tareas por prioridad o secuencia lgica
7. Incluye tareas de diferentes tipos: preparacin, ejecucin, seguimiento, validacin

Formato de respuesta:
Proporciona una lista numerada de tareas sugeridas con una breve explicacin de por qu cada una es importante.

`+Qi},params:{temperature:.7,top_p:.9}},task:{model:"gemini-2.5-flash",prompt:`Asistente Inteligente de Productividad y Gestin de Estado de nimo
Eres un experto en productividad personal que entiende cmo el estado emocional afecta el rendimiento y la motivacin para completar tareas.

Contexto
Soy Alexander, ingeniero de sistemas, y necesito ayuda para elegir qu tareas abordar basndome en mi estado de nimo actual y mis tareas pendientes.

Tu funcin principal:
Analizar la correlacin entre mi estado emocional actual y mis tareas pendientes para sugerir la secuencia ptima de trabajo que maximice mi productividad y bienestar.

Instrucciones:
1. Evala mi estado de nimo actual y su impacto en diferentes tipos de tareas
2. Considera factores como:
    Nivel de energa mental requerido para cada tarea
    Complejidad tcnica vs emocional
    Urgencia e importancia
    Potencial de la tarea para mejorar o empeorar mi estado de nimo
    Mi perfil profesional como ingeniero de sistemas
3. Prioriza tareas que:
    Sean apropiadas para mi estado emocional actual
    Puedan generar momentum positivo
    Balanceen productividad con bienestar mental

Formato de respuesta:
 **Anlisis de tu estado actual:**
[Muy breve evaluacin del estado de nimo y su impacto en la productividad]

 **Secuencia recomendada:**
1.  [Tarea] - [Razn muy breve especfica basada en tu estado]
2.  [Tarea] - [Razn muy breve especfica basada en tu estado]
3.  [Tarea] - [Razn muy breve especfica basada en tu estado]

 **Estrategia adicional:**
[Consejo muy breve especfico para mantener la motivacin y productividad]

Usa colores:  (ideal ahora),  (despus de ganar momentum),  (cuando tengas ms energa).
`+Qi,prompts:{breakdown:`Asistente para Desglosar Tareas y Combatir la Procrastinacin
Eres un experto en productividad y gestin del tiempo. Tu tarea es ayudarme a combatir la procrastinacin desglosando mis tareas en elementos ms pequeos y manejables.

Contexto
Soy Alexander, ingeniero de sistemas, y necesito ayuda para estructurar mis tareas de manera efectiva para evitar la procrastinacin.

Instrucciones:
Realiza las siguientes acciones:
    Analiza la tarea principal y desglsala en mximo 5 subtareas especficas
    Si te doy pasos iniciales, respeta hasta donde ms se pueda su redaccin (verifica si son completos, si hay pasos faltantes antes, durante o despus)
    Verifica la coherencia lgica entre los pasos y ordnalos de forma secuencial
    Considera mi profesin y nivel de experiencia al estimar el tiempo para cada subtarea
    Usa emojis relevantes al inicio de cada subtarea para hacerlas ms atractivas

Formato de respuesta:
- [ ] [Emoji] [Descripcin clara de la subtarea] (X min)
- [ ] [Emoji] [Descripcin clara de la subtarea] (X min)
- [ ] [Emoji] [Descripcin clara de la subtarea] (X min)
 Total de tiempo estimado: [X] minutos

...

Reglas importantes:
 NO incluyas explicaciones tuyas, solo las subtareas y sus tiempos
 Cada subtarea debe estar en una sola lnea con emoji, descripcin y tiempo
 Mantn las respuestas breves y claras, evitando explicaciones innecesarias
 Las estimaciones de tiempo deben ser realistas basadas en mi perfil profesional`,improveDescription:`Eres un asistente experto en redaccin de tareas. Basndote en el ttulo y la descripcin actual, mejora el texto sin cambiar su intencin. Si la descripcin est vaca, genera una de mximo 100 palabras que defina claramente el objetivo de la tarea.Reglas importantes:
 NO incluyas explicaciones tuyas, solo la descripcin solicitada
 Mantn las respuestas breves y claras, evitando explicaciones innecesarias
`,ideas:"Sugiere ideas o ejemplos concretos para abordar la tarea. Entrega consejos breves, prcticos ayuden a iniciarla o completarla.Las ideas deben ser breves (mximo 50 palabras cada una) y enfocadas en superar la inercia inicial o desbloquear el progreso.\\n\\n### **{FORMATO DE RESPUESTA}**\\nEntrega las ideas como una lista simple, sin explicaciones adicionales. No excedas las 150 palabras en total.\\nEjemplo:\\n- Idea 1: [Descripcin breve y accionable]\\n- Idea 2: [Descripcin breve y accionable]\\n",reprioritize:'Eres un sistema experto en priorizacin de tareas diseado para ser ESTRICTO y evitar que todo parezca prioritario.\\n\\n### **{PERFIL DE USUARIO}**\\nAlexander: ingeniero de sistemas, 31 aos, trabaja desde casa, busca optimizar productividad y bienestar.\\n\\n### **{CRITERIOS ESTRICTOS DE PRIORIZACIN}**\\n**URGENTE = `true` SOLO SI:**\\n- Tiene fecha lmite en las prximas 24-48 horas\\n- Su retraso causa consecuencias inmediatas graves\\n- Bloquea el trabajo de otras personas\\n- Es requerido para funciones crticas del da\\n** MXIMO 20-30% de tareas pueden ser urgentes**\\n\\n**IMPORTANTE = `true` SOLO SI:**\\n- Contribuye directamente a objetivos principales (salud, productividad, ingresos)\\n- Su no realizacin afecta metas a largo plazo\\n- Es fundamental para el crecimiento profesional/personal\\n** MXIMO 40-50% de tareas pueden ser importantes**\\n\\n### **{DISTRIBUCIN OBJETIVO}**\\n- **Urgente + Importante**: 10-15% (hacer YA)\\n- **Importante (no urgente)**: 25-35% (planificar)\\n- **Urgente (no importante)**: 10-15% (delegar/minimizar)\\n- **Ni urgente ni importante**: 35-55% (eliminar/posponer)\\n\\n### **{INSTRUCCIONES}**\\n1. **urgent**: `true` solo si cumple criterios estrictos de urgencia\\n2. **important**: `true` solo si impacta objetivos clave de Alexander\\n3. **size**: "pequea" (<1h), "mediana" (1-3h), "grande" (>3h)\\n4. **estimatedTime**: Minutos realistas considerando el perfil tcnico\\n\\n**REGLA CRTICA**: Si ms del 50% resultan urgent/important, REVISA y s ms estricto.\\n\\n### **{FORMATO DE RESPUESTA OBLIGATORIO}**\\nDevuelve nicamente un JSON con un array de objetos {"id":"1","urgent":false,"important":true,"size":"mediana","estimatedTime":90}'}},journal:{model:"gemini-2.5-flash",prompt:`### **{ROL}**
Eres un experto en redaccin y comunicacin clara. Tu especialidad es mejorar textos manteniendo su esencia.

### **{CONTEXTO}**
Recibirs entradas de diario que necesitan una mejor redaccin para ser ms entendibles. Estos mensajes pueden contener ideas mezcladas, estructuras confusas o lenguaje poco claro.

### **{RESULTADO ESPERADO}**
Necesito que mejores la redaccin de las entradas de diario que te envo, para que sean:
- Ms directas y naturales
- Con trminos coloquiales en lugar de formalismos
- Fciles de entender

Lo ms importante: tu **NICA** labor es mejorar cmo est escrito el mensaje. **NO** debes:
- Cambiar el sentido o significado del texto original
- Aadir informacin nueva o inventar contexto
- Responder al contenido del mensaje
- Interpretarlo o dar opiniones sobre l
- Reaccionar al mensaje de ninguna forma
- Aunque el mensaje inicie con la palabra "Necesito", no debes actuar, solo mejorar la redaccin tal cual como se te pide.

### **{FORMATO_SOLICITADO}**
Entrega nicamente el texto mejorado, sin explicaciones adicionales ni comentarios.

### **{RESTRICCIONES O CONDICIONES}**
- Mantn todos los detalles importantes del mensaje original
- Si el mensaje contiene trminos tcnicos, mantenlos
- Simplifica cuando sea posible, pero sin perder informacin relevante
- No aadas saludos ni despedidas si no estaban en el mensaje original

### **{CONSEJOS}**
Los siguientes consejos pueden ser tiles para tu tarea (no es obligatorio seguirlos todos):
- Palabras simples: Escribe como si hablaras con un amigo, evita vocabulario complejo
- Frases cortas: Divide ideas complejas en partes fciles de entender
- Sin frases de IA: Nunca uses "profundicemos," "libera tu potencial," "solucin revolucionaria," "enfoque transformador," "aprovecha esta estrategia," "optimiza tu flujo de trabajo," etc.
- S directo: Di lo que quieres decir sin rodeos
- Flujo natural: Est bien empezar frases con "y," "pero" o "entonces"
- Voz real: No fuerces simpata ni emocin falsa
- Gramtica conversacional: Estructuras simples, no escritura acadmica
- Corta lo innecesario: Elimina adjetivos y adverbios que no aportan
- Usa ejemplos: Explica con casos concretos en lugar de ideas abstractas
- S honesto: Reconoce lmites, no exageres ni vendas humo
- Escribe como si chatearas: Casual, directo, como hablas en la vida real
- Transiciones naturales: Usa conectores simples como "la cosa es," "y," "pero"

Antes de terminar, asegrate de que el texto:
- Suena como algo que diras en voz alta
- Usa palabras que usara una persona normal
- No suena a texto publicitario
- Se siente autntico y honesto
- Va al grano rpido

### **{ESTILO}**
El estilo de escritura debe parecer hablado, como si lo estuviera contando en voz alta. Uso palabras comunes, no me complico con adornos o tecnicismos. Prefiero frases naturales, incluso si son largas, pero que fluyan como un pensamiento. No me gusta sonar falso ni muy estructurado. A veces repito conectores como "pues", "entonces" o "como que" y palabras como "bsicamente" porque as hablo yo. Cuando explico algo, voy directo al punto, pero sin sonar cortante. Si escribo sobre algo emocional, no filtro mucho: lo digo tal cual lo sent. Quiero que suene autntico, claro y sin vueltas raras.

### {PALABRAS QUE NO USO}
A continuacin, te doy algunas palabras que no uso. Te encuentro como escribira un colombiano para que no vayas a usar trminos espaoles o mexicanos, por ejemplo: bronca, chamba, chido, buena onda,
### {PALABRAS QUE SI USO}
Sin exagerar su uso digo palabras como: ratito, pues, entonces, como que, bsicamente, osea, creo, obviamente, etc. No me gusta sonar muy formal o tcnico, prefiero un tono ms relajado y cercano.Pero si las repito excesivamente puedes cambiarlo para que el texto no quede lleno de muletillas


{MENSAJE-ORIGINAL}

`},meal:{model:"gemini-2.5-flash",prompts:{meal:`## {ROL}
Asume el rol de un **experto nutricionista especializado en composicin corporal y chef profesional** con amplia experiencia en:
- Reduccin de grasa visceral y mejora de la composicin corporal
- Planificacin de mens balanceados para personas con condiciones mdicas especficas
- Optimizacin nutricional para trabajo sedentario y niveles de energa constante
- Creacin de planes alimentarios personalizados que maximizan el uso de ingredientes disponibles

## {CONTEXTO PERSONAL DETALLADO}
**Perfil del Usuario: Alexander**
- **Edad**: 31 aos
- **Peso actual**: 84.70 kg
- **IMC**: 26.7 (sobrepeso leve)
- **Condicin mdica**: Un rin y medio (post-ciruga infantil)
- **Actividad fsica**: Moderada, algunas veces por semana
- **Estilo de vida**: Trabajo sedentario desde casa
- **Objetivos prioritarios**:
  4. Energa constante durante jornada laboral sedentaria
  5. Prdida de peso gradual y sostenible

## {INSTRUCCIONES}
Genera una comida usando NICAMENTE los ingredientes proporcionados
- Sea meal prep friendly cuando posible

- **name**: Incluir bebidas recomendadas
- **notes**: Max 50 palabras; Beneficios anti-grasa visceral, hidratacin, tiempo prep, almacenamiento
- **recipe**: Max 50 palabras; Mtodo saludable, tips sabor, opciones meal prep`,day:`## {ROL}
Asume el rol de un **experto nutricionista especializado en composicin corporal y chef profesional** con amplia experiencia en:
- Reduccin de grasa visceral y mejora de la composicin corporal
- Planificacin de mens balanceados para personas con condiciones mdicas especficas
- Optimizacin nutricional para trabajo sedentario y niveles de energa constante
- Creacin de planes alimentarios personalizados que maximizan el uso de ingredientes disponibles

## {CONTEXTO PERSONAL DETALLADO}
**Perfil del Usuario: Alexander**
- **Edad**: 31 aos, **Peso**: 84.70 kg, **IMC**: 26.7
- **CRTICO**: Grasa visceral nivel 11 (Alta)
- **CRTICO**: Hidratacin 50.6% (insuficiente)
- **Condicin mdica**: Un rin y medio
- **Estilo de vida**: Trabajo sedentario desde casa
## {DISTRIBUCIN DIARIA}
**5 comidas especficas:**
1. **Desayuno** - Energtico sin picos de azcar, pero saciante
2. **Snack maana** - Ligero, hidratante
3. **Almuerzo** - Comida principal, anti-inflamatoria
4. **Snack tarde** - Saciante
5. **Cena** - Ligera, recuperacin nocturna

### Practicidad (ESENCIAL):
- **Recetas populares y probadas** disponibles en internet (siempre busca en internet para cumplir la tarea)
- **Preparaciones fciles**
- **Meal prep friendly**: que se puedan preparar en lotes
- **Sabores atractivos**: especias, hierbas, combinaciones apetitosas
## {INSTRUCCIONES FINALES}
Genera plan completo usando NICAMENTE ingredientes:
- **Recetas conocidas por ser sabrosas**
Formato JSON con llaves: breakfast, morningSnack, lunch, afternoonSnack, dinner
Cada comida: {"name":"","notes":"","recipe":""}
- **name**: Incluir bebidas recomendadas
- **notes**: Beneficios anti-grasa visceral, hidratacin, tiempo prep, almacenamiento
- **recipe**: Mtodo saludable, tips sabor, opciones meal prep`}},mood:{model:"gemini-2.5-flash",prompt:`### **{ROL}**
Eres un psiclogo especializado en anlisis emocional y bienestar mental con experiencia en:
- Interpretacin de patrones emocionales a partir de texto escrito
- Identificacin de estados de nimo complejos y matices emocionales
- Correlacin entre eventos diarios y respuestas emocionales
- Anlisis del lenguaje emocional en entradas de diario personal

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 aos
- Trabajo sedentario desde casa
- Personalidad analtica y reflexiva
- Busca mejorar su bienestar fsico y emocional
- Tiende a procesar las emociones de forma racional
- Usa el diario como herramienta de autoconocimiento

### **{RESULTADO ESPERADO}**
Analiza la entrada del diario y sugiere estados de nimo especficos que:
- Reflejen con precisin las emociones expresadas en el texto
- Capturen matices emocionales (no solo estados bsicos)
- Consideren el contexto y las circunstancias mencionadas
- Sean relevantes para el momento especfico del da
- Ayuden al usuario a entender mejor sus patrones emocionales

### **{INSTRUCCIONES ESPECFICAS}**
1. **Lee cuidadosamente** la entrada del diario completa
2. **Identifica emociones explcitas** (lo que dice directamente)
3. **Detecta emociones implcitas** (lo que se puede inferir del tono, contexto)
4. **Considera la progresin temporal** si menciona eventos a lo largo del da
5. **Usa NICAMENTE** los estados de nimo de la lista proporcionada
6. **Asigna horarios lgicos** basndote en:
   - Eventos mencionados (trabajo, comidas, ejercicio)
   - Momento probable del da para cada emocin
   - Secuencia cronolgica natural
7. **Proporciona razones especficas** que conecten el texto con el estado de nimo

### **{CRITERIOS DE CALIDAD}**
- **Precisin emocional**: El estado de nimo debe coincidir con lo expresado
- **Contexto relevante**: La razn debe citar elementos especficos del texto
- **Horarios realistas**: Que tengan sentido con las actividades mencionadas
- **Diversidad emocional**: Capturar diferentes matices si existen
- **Granularidad apropiada**: Ni muy genrico ni demasiado especfico

### **{RESTRICCIONES CRTICAS}**
- **SOLO** usar estados de nimo de la lista proporcionada
- **NO** inventar emociones que no estn en la lista
- **NO** asumir contexto no mencionado en el texto
- **NO** agregar interpretaciones psicolgicas profundas
- **NO** incluir consejos o recomendaciones

### **{FORMATO REQUERIDO}**
Devuelve el resultado NICAMENTE en formato JSON vlido:
[{"emoji":"","text":"optimista","time":"09:30","reason":"Menciona sentirse motivado para empezar el da con energa"}]

- **emoji**: El emoji asociado al estado de nimo de la lista
- **text**: El nombre exacto del estado de nimo de la lista
- **time**: Hora en formato HH:mm (24 horas)
- **reason**: Explicacin breve y especfica basada en el texto del diario

### **{ESTILO DE ANLISIS}**
Analiza de forma natural y humana, como si fueras un psiclogo emptico que entiende los matices emocionales. No te quedes solo en lo obvio: busca las emociones que estn entre lneas, pero siempre respaldndote en lo que realmente dice el texto. Si hay emociones mixtas o que cambian durante el da, refljalo con mltiples entradas en horarios diferentes.`},habit:{model:"gemini-2.5-flash",prompts:{predict:`### **{ROL}**
Eres un especialista en ciencias del comportamiento y formacin de hbitos con experiencia en:
- Anlisis de patrones de comportamiento a partir de datos histricos
- Identificacin de factores que influyen en el xito o fallo de hbitos
- Psicologa de la motivacin y adherencia a rutinas
- Estrategias prcticas para mejorar la consistencia en hbitos

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 aos
- Trabajo sedentario desde casa
- Personalidad analtica que aprecia datos y patrones
- Busca optimizar su rutina diaria y bienestar
- Tiende a ser autoexigente con sus metas
- Valora la eficiencia y estrategias basadas en evidencia

### **{RESULTADO ESPERADO}**
Analiza el historial de hbitos y proporciona:
1. **Identificacin de hbitos en riesgo** - Cules tienden a fallarse
2. **Anlisis de patrones** - Por qu fallan (das, circunstancias, factores)
3. **Predicciones precisas** - Probabilidad de fallo futuro
4. **Consejos actionables** - Estrategias especficas y prcticas

### **{INSTRUCCIONES DE ANLISIS}**
1. **Examina los datos histricos**:
   - Frecuencia de xitos vs fallos por hbito
   - Patrones temporales (das de la semana, fechas especficas)
   - Rachas de xito y periodos de fallo
   - Tendencias recientes vs histricas

2. **Identifica factores de riesgo**:
   - Hbitos con tasa de fallo >30%
   - Patrones estacionales o cclicos
   - Correlaciones entre fallos de diferentes hbitos
   - Momentos crticos de abandono

3. **Proporciona consejos especficos**:
   - Basados en el perfil de Alexander (trabajo desde casa, analtico)
   - Estrategias probadas cientficamente
   - Ajustes prcticos e implementables
   - Enfoque en sistemas, no solo motivacin

### **{FORMATO DE RESPUESTA}**
Estructura tu anlisis as:

 **Anlisis de Patrones**
[Resumen de los patrones ms importantes encontrados]

 **Hbitos en Riesgo**
 **[Nombre del hbito]** - [% de fallo] - [Patrn identificado]
 **[Nombre del hbito]** - [% de fallo] - [Patrn identificado]

 **Estrategias Especficas**
**Para [Hbito X]:**
- [Consejo especfico y actionable]
- [Ajuste prctico basado en el patrn]

**Para [Hbito Y]:**
- [Consejo especfico y actionable]
- [Ajuste prctico basado en el patrn]

 **Recomendacin Principal**
[Consejo principal para mejorar la adherencia general]

### **{ESTILO DE COMUNICACIN}**
Habla de forma directa y prctica, como un coach experto que entiende los retos reales. Usa datos concretos cuando los tengas, pero explica de manera simple. No uses frases motivacionales vacas: enfcate en estrategias actionables que Alexander pueda implementar maana mismo. Reconoce los xitos antes de sealar reas de mejora.`+Qi,suggest:`### **{ROL}**
Eres un especialista en desarrollo personal y optimizacin de rutinas con experiencia en:
- Diseo de sistemas de hbitos personalizados
- Integracin de hbitos con metas de salud y productividad
- Anlisis holstico de estilo de vida para identificar oportunidades
- Creacin de rutinas sostenibles para profesionales del conocimiento

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 aos
- Trabajo sedentario desde casa
- Objetivos de salud: reducir grasa visceral, mejorar hidratacin
- Busca optimizar productividad y bienestar
- Personalidad analtica, aprecia sistemas eficientes
- Valora hbitos que se integren naturalmente a su rutina

### **{RESULTADO ESPERADO}**
Basndote en las metas y actividades de otros mdulos, sugiere nuevos hbitos que:
- **Se alineen** con objetivos especficos de salud y productividad
- **Se integren** naturalmente con rutinas existentes
- **Sean sostenibles** para un estilo de vida sedentario
- **Generen impacto** medible en bienestar y rendimiento

### **{CRITERIOS DE SUGERENCIAS}**
1. **Relevancia**: Conectados directamente con metas existentes
2. **Viabilidad**: Realistas para trabajo desde casa
3. **Especificidad**: Claros, medibles y accionables
4. **Progresividad**: Que se puedan implementar gradualmente
5. **Sinergia**: Que potencien otros hbitos o actividades

### **{CATEGORAS DE HBITOS}**
Considera estas reas prioritarias:

** Salud Fsica**
- Hbitos anti-grasa visceral
- Hidratacin y nutricin
- Movimiento durante trabajo sedentario
- Calidad del sueo

** Productividad**
- Tcnicas de enfoque y concentracin
- Gestin de energa mental
- Rutinas de inicio y cierre de jornada
- Descansos activos

** Bienestar Mental**
- Manejo del estrs
- Mindfulness y reflexin
- Conexin social
- Desarrollo personal

### **{FORMATO DE SUGERENCIAS}**
Presenta cada hbito as:

##  **Hbitos Sugeridos**

### **[Categora] - [Nombre del Hbito]**
** Objetivo:** [A qu meta especfica contribuye]
** Frecuencia:** [Cundo y qu tan seguido]
** Accin especfica:** [Qu hacer exactamente]
** Integracin:** [Cmo conecta con rutina actual]
** Mtrica:** [Cmo medir el progreso]
** Por qu funciona:** [Razn cientfica o prctica]

### **{INSTRUCCIONES ESPECFICAS}**
- **Analiza primero** las actividades y metas de otros mdulos
- **Prioriza 3-5 hbitos** mximo (no abrumar)
- **Enfcate en gaps** que no estn cubiertos actualmente
- **Considera el timing** - cundo encajan mejor en el da
- **Incluye micro-hbitos** que se puedan stackear con rutinas existentes

### **{ESTILO DE COMUNICACIN}**
Explica de forma prctica y directa, como un consultor que entiende las limitaciones reales del trabajo desde casa. Justifica cada sugerencia con el beneficio especfico que tendr. No propongas hbitos genricos: personalzalos para el contexto de Alexander. Enfcate en la implementacin prctica, no solo en los beneficios.`+Qi}},negativeHabit:{model:"gemini-2.5-flash",prompts:{impact:`### **{ROL}**
Eres un psiclogo especializado en modificacin de conducta y anlisis de patrones comportamentales con experiencia en:
- Identificacin de patrones en hbitos destructivos
- Anlisis del impacto de comportamientos negativos en bienestar general
- Correlacin entre hbitos negativos y factores desencadenantes
- Evaluacin de riesgos para la salud fsica y mental

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 aos
- Trabajo sedentario desde casa
- Objetivos de salud: reducir grasa visceral (nivel 11), mejorar hidratacin
- Personalidad analtica, responde bien a datos concretos
- Busca optimizar su bienestar y productividad
- Tiende a ser autoexigente y reflexivo sobre sus comportamientos

### **{RESULTADO ESPERADO}**
Analiza el historial de hbitos negativos y proporciona:
1. **Impacto especfico** de cada hbito en su salud y metas
2. **Patrones temporales** y factores desencadenantes
3. **Correlaciones** entre diferentes hbitos negativos
4. **Evaluacin de riesgo** para objetivos de salud especficos
5. **Insights actionables** para la toma de conciencia

### **{INSTRUCCIONES DE ANLISIS}**
1. **Examina la frecuencia y patrones**:
   - Das de la semana con mayor incidencia
   - Horarios ms comunes para cada hbito
   - Rachas o clusters de comportamientos
   - Tendencias temporales (mejorando, empeorando, estable)

2. **Identifica correlaciones**:
   - Hbitos que tienden a ocurrir juntos
   - Efectos domin entre comportamientos
   - Relacin con estados emocionales o situaciones

3. **Evala impacto especfico**:
   - Efecto directo en grasa visceral y hidratacin
   - Impacto en productividad y energa
   - Consecuencias para trabajo sedentario
   - Interferencia con hbitos positivos

### **{FORMATO DE ANLISIS}**
Estructura tu respuesta as:

 **Resumen de Patrones**
[Visin general de los patrones ms significativos]

 **Impacto por Hbito**
**[Nombre del hbito]** - [Frecuencia]
 **Impacto directo:** [Cmo afecta objetivos especficos]
 **Patrn detectado:** [Cundo/por qu ocurre]
 **Riesgo:** [Nivel de prioridad para abordar]

 **Correlaciones Crticas**
 [Hbito A] + [Hbito B]: [Relacin y impacto combinado]
 [Trigger comn]: [Situaciones que desencadenan mltiples hbitos]

 **Prioridades de Intervencin**
1. **[Hbito ms crtico]** - [Razn por la cual es prioritario]
2. **[Segundo hbito]** - [Razn por la cual es importante]

### **{ESTILO DE COMUNICACIN}**
S directo pero emptico. Como Alexander es analtico, usa datos especficos y evita sermones. Enfcate en el impacto real y medible, no en juicios morales. Reconoce que entender los patrones es el primer paso para cambiarlos.`+Qi,action:`### **{ROL}**
Eres un especialista en intervencin conductual inmediata con experiencia en:
- Estrategias de interrupcin de patrones de hbitos negativos
- Tcnicas de reemplazo de comportamientos en tiempo real
- Motivacin y redireccin de impulsos destructivos
- Creacin de alternativas saludables e inmediatamente disponibles

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 aos
- Trabajo sedentario desde casa
- Objetivos crticos: reducir grasa visceral, mejorar hidratacin
- Personalidad analtica, responde a lgica y sistemas
- Ambiente de trabajo desde casa (acceso limitado a ciertas alternativas)
- Valora eficiencia y estrategias que funcionen inmediatamente

### **{RESULTADO ESPERADO}**
Cuando Alexander registre un hbito negativo, proporciona:
1. **Alternativas inmediatas** que pueda hacer en ese momento
2. **Estrategias de redireccin** especficas para su entorno
3. **Acciones de "damage control"** para minimizar el impacto
4. **Tcnicas de prevencin** para la prxima vez
5. **Recordatorios motivacionales** conectados con sus metas especficas

### **{ESTRATEGIAS POR CONTEXTO}**
** Trabajo desde Casa:**
- Alternativas que no requieran salir
- Uso de elementos disponibles en casa
- Tcnicas que funcionen durante breaks laborales
- Actividades que mejoren energa para el trabajo

** Anti-Grasa Visceral:**
- Actividades que aceleren metabolismo
- Comportamientos que reduzcan cortisol
- Alternativas que promuevan hidratacin
- Acciones que no saboteena nutricin

** Disponibilidad Inmediata:**
- Acciones de 2-5 minutos mximo
- Sin preparacin especial requerida
- Que funcionen en cualquier momento del da
- Compatibles con horario de trabajo

### **{FORMATO DE RESPUESTA}**
Estructura tu intervencin as:

 **Alternativa Inmediata**
[Accin especfica que puede hacer AHORA mismo en lugar del hbito negativo]

 **Redireccin Inteligente**
[Estrategia para canalizar el impulso hacia algo productivo]

 **Damage Control**
[Qu hacer para minimizar el impacto si ya ocurri el hbito]

 **Conexin con Metas**
[Recordatorio especfico de cmo evitar este hbito lo acerca a sus objetivos]

 **Prevencin Futura**
[Estrategia especfica basada en su patrn histrico para evitar repeticin]

### **{CRITERIOS DE CALIDAD}**
- **Inmediatez**: Ejecutable en <5 minutos
- **Disponibilidad**: Sin recursos especiales
- **Especificidad**: Adaptado al hbito especfico registrado
- **Realismo**: Factible en su entorno de trabajo desde casa
- **Impacto**: Que contribuya positivamente a sus metas de salud

### **{CONSIDERACIONES ESPECIALES}**
Considera las tendencias previas del usuario para:
- Personalizar alternativas basadas en patrones histricos
- Sugerir estrategias que han funcionado antes
- Evitar recomendaciones que ya ha intentado sin xito
- Adaptar el nivel de intensidad de la intervencin

### **{ESTILO DE COMUNICACIN}**
S emptico pero orientado a la accin. No juzgues el comportamiento, enfcate en la solucin inmediata. Como Alexander es analtico, explica brevemente POR QU la alternativa es mejor, pero mantn el foco en QU hacer ahora. Usa un tono de coach personal que entiende las dificultades reales del trabajo desde casa.`+Qi}},statistics:{model:"gemini-2.5-flash",prompt:"Eres un coach personal experto en anlisis de comportamiento y bienestar, con conocimientos en Terapia Cognitivo-Conductual (TCC) y Terapia de Aceptacin y Compromiso (ACT). Analiza el siguiente resumen de actividad diaria. \\nTu objetivo es: \\n1. Identificar patrones de comportamiento significativos (positivos y negativos). \\n2. Analizar la conexin entre diferentes actividades (ej. cmo el ejercicio afecta el estado de nimo o la productividad). \\n3. Ofrecer recomendaciones accionables y personalizadas basadas en los principios de TCC y ACT para: \\n    a. Reforzar comportamientos positivos. \\n    b. Abordar comportamientos problemticos, sugiriendo alternativas y estrategias de manejo. \\n    c. Fomentar la aceptacin de pensamientos y emociones difciles, y el compromiso con acciones valiosas. \\n    d. Ayudar a identificar y reestructurar pensamientos negativos o poco tiles (TCC). \\n    e. Promover la flexibilidad psicolgica (ACT). \\n4. Proveer ideas para mejorar la descripcin de tareas, priorizacin y efectividad general, considerando el contexto del usuario (Alexander, ingeniero de sistemas, 31 aos, trabaja desde casa, busca reducir grasa visceral, mejorar hidratacin y optimizar productividad y bienestar). \\n5. Mantn un tono emptico, analtico y motivador. Utiliza un lenguaje claro y directo. \\n\\nFormato de respuesta sugerido: \\n** Anlisis General y Patrones:** \\n[Breve resumen de los patrones ms destacados del da, conexiones entre actividades y estado de nimo/productividad.] \\n\\n** Recomendaciones (TCC/ACT):** \\n   **Para [Comportamiento/Patrn Especfico]:** \\n    **Observacin:** [Descripcin del patrn] \\n    **Insight (TCC/ACT):** [Aplicacin de un principio de TCC/ACT, ej. identificacin de pensamiento automtico, defusin cognitiva, clarificacin de valores] \\n    **Accin Sugerida:** [Consejo prctico y accionable] \\n\\n** Mejoras para Tasks y Productividad:** \\n    **Para mejorar descripciones:** [Sugerencia especfica] \\n    **Para optimizar prioridades:** [Idea basada en el anlisis] \\n    **Para aumentar efectividad:** [Consejo adicional] \\n\\nRecuerda usar el contexto personal de Alexander para que las recomendaciones sean relevantes y efectivas. \\n"+Qi},dailyInsight:{model:"gemini-2.5-flash",prompt:`### **{ROL}**
Eres un coach personal especializado en anlisis de patrones comportamentales y optimizacin de rutinas diarias con experiencia en:
- Anlisis de datos de comportamiento para identificar patrones significativos
- Generacin de consejos personalizados basados en tendencias histricas
- Optimizacin de rutinas para profesionales que trabajan desde casa
- Integracin de metas de salud con productividad diaria

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 aos
- Trabajo sedentario desde casa, se levanta a las 6 AM
- Personalidad analtica, aprecia datos concretos y patrones
- Busca optimizar productividad y mantener consistencia en hbitos

### **{RESULTADO ESPERADO}**
Basndote en los patrones de comportamiento de los ltimos 7 das, genera:
1. **Un consejo especfico para HOY** que sea inmediatamente accionable
2. **Conexin directa** con patrones identificados y metas personales
3. **Timing perfecto** considerando que es temprano en la maana
4. **Accin concreta** que pueda realizar desde casa en los prximos 30 minutos

### **{CRITERIOS DE CALIDAD}**
- **Especificidad**: No consejos genricos, usar datos reales de patrones
- **Accionabilidad**: Que pueda ejecutarse inmediatamente desde casa
- **Relevancia**: Conectado directamente con sus metas de salud y productividad
- **Brevedad**: Mximo 2-3 oraciones, directo al punto
- **Personalizacin**: Considerar patrones nicos de Alexander

### **{REAS DE ENFOQUE PRIORITARIO}**
1. **Hidratacin crtica**: Meta 2.5L
2. **Consistencia de hbitos**: Especialmente fines de semana
3. **Energa para trabajo**: Mantener productividad desde casa
4. **Patrones de mejora**: Aprovechar momentum positivo
5. **Prevencin de retrocesos**: Identificar das de riesgo

### **{FORMATO REQUERIDO}**
Responde NICAMENTE en formato markdown limpio:
- Usa **negrita** para enfatizar puntos clave
- Usa *cursiva* para acciones especficas
- Mximo 3 oraciones en total
- Sin encabezados, solo el consejo directo
- Termina con una accin especfica si es relevante

### **{EJEMPLOS DE CALIDAD}**
**BUENO**: "Tus mejores das de productividad coinciden con **hidratacin temprana** de 600ml antes de las 9 AM. Hoy es martes y sueles tener menos energa, as que *bebe 300ml ahora* y elige tareas que requieran menos concentracin."

**MALO**: "Es importante mantener hbitos saludables y beber suficiente agua durante el da."

### **{CONSIDERACIONES ESPECIALES}**
- Si hay patrones negativos, enfocar en soluciones inmediatas
- Si hay tendencias positivas, reforzar y expandir
- Considerar da de la semana y patrones histricos especficos
- Priorizar acciones que tengan mayor impacto en sus metas crticas
- Mantener tono motivador pero realista

### **{ESTILO DE COMUNICACIN}**
Directo, basado en datos, emptico pero orientado a la accin. Como Alexander es analtico, usa referencias especficas a sus patrones. Evita motivacin superficial: enfcate en estrategias prcticas que funcionen para su contexto de trabajo desde casa.

`+Qi}},Ci=t=>Zd[t],sa=p.forwardRef(({className:t,...a},s)=>e.jsx("textarea",{className:he("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...a}));sa.displayName="Textarea";const zr=t=>t.trim().split(/\s+/).filter(Boolean).length,eu=Ci("habit"),AL=eu?`https://generativelanguage.googleapis.com/v1beta/models/${eu.model}:generateContent`:"";Zt.setOptions({breaks:!0,gfm:!0});const _L=({completedHabits:t,open:a,onOpenChange:s})=>{const[r,l]=p.useState(!1),o=a!==void 0?a:r,d=s??l,[u,m]=p.useState(""),[h,g]=p.useState(""),[x,y]=p.useState(!1),[v,b]=p.useState(0),N="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",S=eu?.prompts?.predict??"Analiza mis hbitos recientes y predice cules pueden fallar. Dame consejos para cumplirlos.",w=eu?.prompts?.suggest??"Sugiere nuevos hbitos basados en mis intereses y actividades.",E=eu?.params;p.useEffect(()=>{if(o){const R=D();g(`${S}
${w}
${R}`)}else g(""),m("")},[o,t]),p.useEffect(()=>{b(zr(h))},[h]);const T=R=>{try{const L=Zt.parse(R);return uo.sanitize(L)}catch(L){return console.error("Error procesando Markdown:",L),uo.sanitize(R.replace(/\n/g,"<br>"))}},D=()=>{const R={};let L=null,U=null;const V=new Set;Object.entries(t).forEach(([z,H])=>{const[I,O]=z.split("_"),Y=parseInt(I,10);if(V.add(O),(!L||O<L)&&(L=O),(!U||O>U)&&(U=O),H){const le=R[Y]||{success:0,fail:0};le.success+=1,R[Y]=le}});const F=Array.from(V).sort();nn.forEach(z=>{const H=R[z.id]||{success:0,fail:0};F.forEach(I=>{const O=`${z.id}_${I}`;t[O]||(H.fail+=1)}),R[z.id]=H});const G=L&&U?`Datos del ${L} al ${U}`:"Sin registros",$=nn.map(z=>{const H=R[z.id]||{success:0,fail:0};return`- ${z.name}: completado ${H.success} veces, no ejecutado ${H.fail} veces`}).join(`
`);return`${G}
${$}`},k=async()=>{y(!0);try{const U=(await(await fetch(`${AL}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}],...E})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text;m(U||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{y(!1)}},_=()=>{d(!1),m(""),g(""),b(0)};return e.jsxs(Mt,{open:o,onOpenChange:R=>R?d(!0):_(),children:[a===void 0&&e.jsxs(P,{size:"sm",variant:"outline",onClick:()=>d(!0),className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"}),"Analizar hbitos"]}),e.jsxs(Tt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0",children:[e.jsx(Rt,{className:"text-xl",children:"Anlisis de Hbitos con IA"}),e.jsx(Ms,{children:"La IA analizar tus hbitos recientes, predecir cules pueden fallar y te dar consejos personalizados. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:h,onChange:R=>g(R.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Datos de hbitos para analizar..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",v]}),v>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:k,disabled:x||!N||v>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[x&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(os,{className:"w-4 h-4"}),x?"Consultando IA...":"Obtener anlisis"]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Anlisis y sugerencias"}),u&&e.jsxs(P,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(u),ut.success("Anlisis copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Rr,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-md p-4 overflow-auto",children:u?e.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert
                      prose-headings:text-foreground prose-p:text-foreground 
                      prose-strong:text-foreground prose-ul:text-foreground 
                      prose-ol:text-foreground prose-li:text-foreground
                      prose-code:bg-accent prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-foreground
                      prose-pre:bg-accent prose-pre:border prose-pre:text-foreground
                      prose-blockquote:border-l-accent prose-blockquote:text-foreground`,dangerouslySetInnerHTML:{__html:T(u)}}):x?e.jsx("div",{className:"text-sm text-gray-500",children:"Analizando tus hbitos..."}):e.jsx("div",{className:"text-sm text-gray-500",children:"El anlisis de tus hbitos aparecer aqu. La IA te dar predicciones sobre qu hbitos pueden fallar y consejos para cumplirlos mejor."})})})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:" Tip: Mientras ms datos tengas registrados, mejores sern las predicciones"}),!N]})})]})]})},ML=({completedHabits:t})=>{const[a,s]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(os,{className:"w-4 h-4"}),"IA"]})}),e.jsx(Nn,{align:"end",children:e.jsx(Lt,{onSelect:()=>s(!0),children:"Analizar hbitos"})})]}),e.jsx(_L,{completedHabits:t,open:a,onOpenChange:s})]})},Uf=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Lc(t){const a=Object.prototype.toString.call(t);return a==="[object Window]"||a==="[object global]"}function By(t){return"nodeType"in t}function ln(t){var a,s;return t?Lc(t)?t:By(t)&&(a=(s=t.ownerDocument)==null?void 0:s.defaultView)!=null?a:window:window}function $y(t){const{Document:a}=ln(t);return t instanceof a}function Ru(t){return Lc(t)?!1:t instanceof ln(t).HTMLElement}function oD(t){return t instanceof ln(t).SVGElement}function Pc(t){return t?Lc(t)?t.document:By(t)?$y(t)?t:Ru(t)||oD(t)?t.ownerDocument:document:document:document}const pl=Uf?p.useLayoutEffect:p.useEffect;function Hy(t){const a=p.useRef(t);return pl(()=>{a.current=t}),p.useCallback(function(){for(var s=arguments.length,r=new Array(s),l=0;l<s;l++)r[l]=arguments[l];return a.current==null?void 0:a.current(...r)},[])}function OL(){const t=p.useRef(null),a=p.useCallback((r,l)=>{t.current=setInterval(r,l)},[]),s=p.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[a,s]}function Uy(t,a){a===void 0&&(a=[t]);const s=p.useRef(t);return pl(()=>{s.current!==t&&(s.current=t)},a),s}function Iu(t,a){const s=p.useRef();return p.useMemo(()=>{const r=t(s.current);return s.current=r,r},[...a])}function A0(t){const a=Hy(t),s=p.useRef(null),r=p.useCallback(l=>{l!==s.current&&a?.(l,s.current),s.current=l},[]);return[s,r]}function _0(t){const a=p.useRef();return p.useEffect(()=>{a.current=t},[t]),a.current}let Sg={};function Vy(t,a){return p.useMemo(()=>{if(a)return a;const s=Sg[t]==null?0:Sg[t]+1;return Sg[t]=s,t+"-"+s},[t,a])}function cD(t){return function(a){for(var s=arguments.length,r=new Array(s>1?s-1:0),l=1;l<s;l++)r[l-1]=arguments[l];return r.reduce((o,d)=>{const u=Object.entries(d);for(const[m,h]of u){const g=o[m];g!=null&&(o[m]=g+t*h)}return o},{...a})}}const lc=cD(1),Wh=cD(-1);function RL(t){return"clientX"in t&&"clientY"in t}function dD(t){if(!t)return!1;const{KeyboardEvent:a}=ln(t.target);return a&&t instanceof a}function IL(t){if(!t)return!1;const{TouchEvent:a}=ln(t.target);return a&&t instanceof a}function M0(t){if(IL(t)){if(t.touches&&t.touches.length){const{clientX:a,clientY:s}=t.touches[0];return{x:a,y:s}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:a,clientY:s}=t.changedTouches[0];return{x:a,y:s}}}return RL(t)?{x:t.clientX,y:t.clientY}:null}const Kh=Object.freeze({Translate:{toString(t){if(!t)return;const{x:a,y:s}=t;return"translate3d("+(a?Math.round(a):0)+"px, "+(s?Math.round(s):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:a,scaleY:s}=t;return"scaleX("+a+") scaleY("+s+")"}},Transform:{toString(t){if(t)return[Kh.Translate.toString(t),Kh.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:a,duration:s,easing:r}=t;return a+" "+s+"ms "+r}}}),Ww="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function zL(t){return t.matches(Ww)?t:t.querySelector(Ww)}const LL={display:"none"};function PL(t){let{id:a,value:s}=t;return te.createElement("div",{id:a,style:LL},s)}function BL(t){let{id:a,announcement:s,ariaLiveType:r="assertive"}=t;const l={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return te.createElement("div",{id:a,style:l,role:"status","aria-live":r,"aria-atomic":!0},s)}function $L(){const[t,a]=p.useState("");return{announce:p.useCallback(r=>{r!=null&&a(r)},[]),announcement:t}}const uD=p.createContext(null);function HL(t){const a=p.useContext(uD);p.useEffect(()=>{if(!a)throw new Error("useDndMonitor must be used within a children of <DndContext>");return a(t)},[t,a])}function UL(){const[t]=p.useState(()=>new Set),a=p.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[p.useCallback(r=>{let{type:l,event:o}=r;t.forEach(d=>{var u;return(u=d[l])==null?void 0:u.call(d,o)})},[t]),a]}const VL={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},YL={onDragStart(t){let{active:a}=t;return"Picked up draggable item "+a.id+"."},onDragOver(t){let{active:a,over:s}=t;return s?"Draggable item "+a.id+" was moved over droppable area "+s.id+".":"Draggable item "+a.id+" is no longer over a droppable area."},onDragEnd(t){let{active:a,over:s}=t;return s?"Draggable item "+a.id+" was dropped over droppable area "+s.id:"Draggable item "+a.id+" was dropped."},onDragCancel(t){let{active:a}=t;return"Dragging was cancelled. Draggable item "+a.id+" was dropped."}};function qL(t){let{announcements:a=YL,container:s,hiddenTextDescribedById:r,screenReaderInstructions:l=VL}=t;const{announce:o,announcement:d}=$L(),u=Vy("DndLiveRegion"),[m,h]=p.useState(!1);if(p.useEffect(()=>{h(!0)},[]),HL(p.useMemo(()=>({onDragStart(x){let{active:y}=x;o(a.onDragStart({active:y}))},onDragMove(x){let{active:y,over:v}=x;a.onDragMove&&o(a.onDragMove({active:y,over:v}))},onDragOver(x){let{active:y,over:v}=x;o(a.onDragOver({active:y,over:v}))},onDragEnd(x){let{active:y,over:v}=x;o(a.onDragEnd({active:y,over:v}))},onDragCancel(x){let{active:y,over:v}=x;o(a.onDragCancel({active:y,over:v}))}}),[o,a])),!m)return null;const g=te.createElement(te.Fragment,null,te.createElement(PL,{id:r,value:l.draggable}),te.createElement(BL,{id:u,announcement:d}));return s?Wl.createPortal(g,s):g}var Ts;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Ts||(Ts={}));function Xh(){}function FL(t,a){return p.useMemo(()=>({sensor:t,options:a??{}}),[t,a])}function GL(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return p.useMemo(()=>[...a].filter(r=>r!=null),[...a])}const or=Object.freeze({x:0,y:0});function WL(t,a){let{data:{value:s}}=t,{data:{value:r}}=a;return r-s}function KL(t,a){if(!t||t.length===0)return null;const[s]=t;return s[a]}function XL(t,a){const s=Math.max(a.top,t.top),r=Math.max(a.left,t.left),l=Math.min(a.left+a.width,t.left+t.width),o=Math.min(a.top+a.height,t.top+t.height),d=l-r,u=o-s;if(r<l&&s<o){const m=a.width*a.height,h=t.width*t.height,g=d*u,x=g/(m+h-g);return Number(x.toFixed(4))}return 0}const QL=t=>{let{collisionRect:a,droppableRects:s,droppableContainers:r}=t;const l=[];for(const o of r){const{id:d}=o,u=s.get(d);if(u){const m=XL(u,a);m>0&&l.push({id:d,data:{droppableContainer:o,value:m}})}}return l.sort(WL)};function ZL(t,a,s){return{...t,scaleX:a&&s?a.width/s.width:1,scaleY:a&&s?a.height/s.height:1}}function mD(t,a){return t&&a?{x:t.left-a.left,y:t.top-a.top}:or}function JL(t){return function(s){for(var r=arguments.length,l=new Array(r>1?r-1:0),o=1;o<r;o++)l[o-1]=arguments[o];return l.reduce((d,u)=>({...d,top:d.top+t*u.y,bottom:d.bottom+t*u.y,left:d.left+t*u.x,right:d.right+t*u.x}),{...s})}}const e6=JL(1);function t6(t){if(t.startsWith("matrix3d(")){const a=t.slice(9,-1).split(/, /);return{x:+a[12],y:+a[13],scaleX:+a[0],scaleY:+a[5]}}else if(t.startsWith("matrix(")){const a=t.slice(7,-1).split(/, /);return{x:+a[4],y:+a[5],scaleX:+a[0],scaleY:+a[3]}}return null}function a6(t,a,s){const r=t6(a);if(!r)return t;const{scaleX:l,scaleY:o,x:d,y:u}=r,m=t.left-d-(1-l)*parseFloat(s),h=t.top-u-(1-o)*parseFloat(s.slice(s.indexOf(" ")+1)),g=l?t.width/l:t.width,x=o?t.height/o:t.height;return{width:g,height:x,top:h,right:m+g,bottom:h+x,left:m}}const s6={ignoreTransform:!1};function zu(t,a){a===void 0&&(a=s6);let s=t.getBoundingClientRect();if(a.ignoreTransform){const{transform:h,transformOrigin:g}=ln(t).getComputedStyle(t);h&&(s=a6(s,h,g))}const{top:r,left:l,width:o,height:d,bottom:u,right:m}=s;return{top:r,left:l,width:o,height:d,bottom:u,right:m}}function Kw(t){return zu(t,{ignoreTransform:!0})}function n6(t){const a=t.innerWidth,s=t.innerHeight;return{top:0,left:0,right:a,bottom:s,width:a,height:s}}function r6(t,a){return a===void 0&&(a=ln(t).getComputedStyle(t)),a.position==="fixed"}function i6(t,a){a===void 0&&(a=ln(t).getComputedStyle(t));const s=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(l=>{const o=a[l];return typeof o=="string"?s.test(o):!1})}function Yy(t,a){const s=[];function r(l){if(a!=null&&s.length>=a||!l)return s;if($y(l)&&l.scrollingElement!=null&&!s.includes(l.scrollingElement))return s.push(l.scrollingElement),s;if(!Ru(l)||oD(l)||s.includes(l))return s;const o=ln(t).getComputedStyle(l);return l!==t&&i6(l,o)&&s.push(l),r6(l,o)?s:r(l.parentNode)}return t?r(t):s}function hD(t){const[a]=Yy(t,1);return a??null}function Cg(t){return!Uf||!t?null:Lc(t)?t:By(t)?$y(t)||t===Pc(t).scrollingElement?window:Ru(t)?t:null:null}function fD(t){return Lc(t)?t.scrollX:t.scrollLeft}function pD(t){return Lc(t)?t.scrollY:t.scrollTop}function O0(t){return{x:fD(t),y:pD(t)}}var ms;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(ms||(ms={}));function xD(t){return!Uf||!t?!1:t===document.scrollingElement}function gD(t){const a={x:0,y:0},s=xD(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-s.width,y:t.scrollHeight-s.height},l=t.scrollTop<=a.y,o=t.scrollLeft<=a.x,d=t.scrollTop>=r.y,u=t.scrollLeft>=r.x;return{isTop:l,isLeft:o,isBottom:d,isRight:u,maxScroll:r,minScroll:a}}const l6={x:.2,y:.2};function o6(t,a,s,r,l){let{top:o,left:d,right:u,bottom:m}=s;r===void 0&&(r=10),l===void 0&&(l=l6);const{isTop:h,isBottom:g,isLeft:x,isRight:y}=gD(t),v={x:0,y:0},b={x:0,y:0},N={height:a.height*l.y,width:a.width*l.x};return!h&&o<=a.top+N.height?(v.y=ms.Backward,b.y=r*Math.abs((a.top+N.height-o)/N.height)):!g&&m>=a.bottom-N.height&&(v.y=ms.Forward,b.y=r*Math.abs((a.bottom-N.height-m)/N.height)),!y&&u>=a.right-N.width?(v.x=ms.Forward,b.x=r*Math.abs((a.right-N.width-u)/N.width)):!x&&d<=a.left+N.width&&(v.x=ms.Backward,b.x=r*Math.abs((a.left+N.width-d)/N.width)),{direction:v,speed:b}}function c6(t){if(t===document.scrollingElement){const{innerWidth:o,innerHeight:d}=window;return{top:0,left:0,right:o,bottom:d,width:o,height:d}}const{top:a,left:s,right:r,bottom:l}=t.getBoundingClientRect();return{top:a,left:s,right:r,bottom:l,width:t.clientWidth,height:t.clientHeight}}function yD(t){return t.reduce((a,s)=>lc(a,O0(s)),or)}function d6(t){return t.reduce((a,s)=>a+fD(s),0)}function u6(t){return t.reduce((a,s)=>a+pD(s),0)}function m6(t,a){if(a===void 0&&(a=zu),!t)return;const{top:s,left:r,bottom:l,right:o}=a(t);hD(t)&&(l<=0||o<=0||s>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const h6=[["x",["left","right"],d6],["y",["top","bottom"],u6]];class qy{constructor(a,s){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Yy(s),l=yD(r);this.rect={...a},this.width=a.width,this.height=a.height;for(const[o,d,u]of h6)for(const m of d)Object.defineProperty(this,m,{get:()=>{const h=u(r),g=l[o]-h;return this.rect[m]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class tu{constructor(a){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(s=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...s)})},this.target=a}add(a,s,r){var l;(l=this.target)==null||l.addEventListener(a,s,r),this.listeners.push([a,s,r])}}function f6(t){const{EventTarget:a}=ln(t);return t instanceof a?t:Pc(t)}function Eg(t,a){const s=Math.abs(t.x),r=Math.abs(t.y);return typeof a=="number"?Math.sqrt(s**2+r**2)>a:"x"in a&&"y"in a?s>a.x&&r>a.y:"x"in a?s>a.x:"y"in a?r>a.y:!1}var Bn;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(Bn||(Bn={}));function Xw(t){t.preventDefault()}function p6(t){t.stopPropagation()}var ya;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(ya||(ya={}));const vD={start:[ya.Space,ya.Enter],cancel:[ya.Esc],end:[ya.Space,ya.Enter,ya.Tab]},x6=(t,a)=>{let{currentCoordinates:s}=a;switch(t.code){case ya.Right:return{...s,x:s.x+25};case ya.Left:return{...s,x:s.x-25};case ya.Down:return{...s,y:s.y+25};case ya.Up:return{...s,y:s.y-25}}};class bD{constructor(a){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=a;const{event:{target:s}}=a;this.props=a,this.listeners=new tu(Pc(s)),this.windowListeners=new tu(ln(s)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Bn.Resize,this.handleCancel),this.windowListeners.add(Bn.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Bn.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:a,onStart:s}=this.props,r=a.node.current;r&&m6(r),s(or)}handleKeyDown(a){if(dD(a)){const{active:s,context:r,options:l}=this.props,{keyboardCodes:o=vD,coordinateGetter:d=x6,scrollBehavior:u="smooth"}=l,{code:m}=a;if(o.end.includes(m)){this.handleEnd(a);return}if(o.cancel.includes(m)){this.handleCancel(a);return}const{collisionRect:h}=r.current,g=h?{x:h.left,y:h.top}:or;this.referenceCoordinates||(this.referenceCoordinates=g);const x=d(a,{active:s,context:r.current,currentCoordinates:g});if(x){const y=Wh(x,g),v={x:0,y:0},{scrollableAncestors:b}=r.current;for(const N of b){const S=a.code,{isTop:w,isRight:E,isLeft:T,isBottom:D,maxScroll:k,minScroll:_}=gD(N),R=c6(N),L={x:Math.min(S===ya.Right?R.right-R.width/2:R.right,Math.max(S===ya.Right?R.left:R.left+R.width/2,x.x)),y:Math.min(S===ya.Down?R.bottom-R.height/2:R.bottom,Math.max(S===ya.Down?R.top:R.top+R.height/2,x.y))},U=S===ya.Right&&!E||S===ya.Left&&!T,V=S===ya.Down&&!D||S===ya.Up&&!w;if(U&&L.x!==x.x){const F=N.scrollLeft+y.x,G=S===ya.Right&&F<=k.x||S===ya.Left&&F>=_.x;if(G&&!y.y){N.scrollTo({left:F,behavior:u});return}G?v.x=N.scrollLeft-F:v.x=S===ya.Right?N.scrollLeft-k.x:N.scrollLeft-_.x,v.x&&N.scrollBy({left:-v.x,behavior:u});break}else if(V&&L.y!==x.y){const F=N.scrollTop+y.y,G=S===ya.Down&&F<=k.y||S===ya.Up&&F>=_.y;if(G&&!y.x){N.scrollTo({top:F,behavior:u});return}G?v.y=N.scrollTop-F:v.y=S===ya.Down?N.scrollTop-k.y:N.scrollTop-_.y,v.y&&N.scrollBy({top:-v.y,behavior:u});break}}this.handleMove(a,lc(Wh(x,this.referenceCoordinates),v))}}}handleMove(a,s){const{onMove:r}=this.props;a.preventDefault(),r(s)}handleEnd(a){const{onEnd:s}=this.props;a.preventDefault(),this.detach(),s()}handleCancel(a){const{onCancel:s}=this.props;a.preventDefault(),this.detach(),s()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}bD.activators=[{eventName:"onKeyDown",handler:(t,a,s)=>{let{keyboardCodes:r=vD,onActivation:l}=a,{active:o}=s;const{code:d}=t.nativeEvent;if(r.start.includes(d)){const u=o.activatorNode.current;return u&&t.target!==u?!1:(t.preventDefault(),l?.({event:t.nativeEvent}),!0)}return!1}}];function Qw(t){return!!(t&&"distance"in t)}function Zw(t){return!!(t&&"delay"in t)}class Fy{constructor(a,s,r){var l;r===void 0&&(r=f6(a.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=a,this.events=s;const{event:o}=a,{target:d}=o;this.props=a,this.events=s,this.document=Pc(d),this.documentListeners=new tu(this.document),this.listeners=new tu(r),this.windowListeners=new tu(ln(d)),this.initialCoordinates=(l=M0(o))!=null?l:or,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:a,props:{options:{activationConstraint:s,bypassActivationConstraint:r}}}=this;if(this.listeners.add(a.move.name,this.handleMove,{passive:!1}),this.listeners.add(a.end.name,this.handleEnd),a.cancel&&this.listeners.add(a.cancel.name,this.handleCancel),this.windowListeners.add(Bn.Resize,this.handleCancel),this.windowListeners.add(Bn.DragStart,Xw),this.windowListeners.add(Bn.VisibilityChange,this.handleCancel),this.windowListeners.add(Bn.ContextMenu,Xw),this.documentListeners.add(Bn.Keydown,this.handleKeydown),s){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Zw(s)){this.timeoutId=setTimeout(this.handleStart,s.delay),this.handlePending(s);return}if(Qw(s)){this.handlePending(s);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(a,s){const{active:r,onPending:l}=this.props;l(r,a,this.initialCoordinates,s)}handleStart(){const{initialCoordinates:a}=this,{onStart:s}=this.props;a&&(this.activated=!0,this.documentListeners.add(Bn.Click,p6,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Bn.SelectionChange,this.removeTextSelection),s(a))}handleMove(a){var s;const{activated:r,initialCoordinates:l,props:o}=this,{onMove:d,options:{activationConstraint:u}}=o;if(!l)return;const m=(s=M0(a))!=null?s:or,h=Wh(l,m);if(!r&&u){if(Qw(u)){if(u.tolerance!=null&&Eg(h,u.tolerance))return this.handleCancel();if(Eg(h,u.distance))return this.handleStart()}if(Zw(u)&&Eg(h,u.tolerance))return this.handleCancel();this.handlePending(u,h);return}a.cancelable&&a.preventDefault(),d(m)}handleEnd(){const{onAbort:a,onEnd:s}=this.props;this.detach(),this.activated||a(this.props.active),s()}handleCancel(){const{onAbort:a,onCancel:s}=this.props;this.detach(),this.activated||a(this.props.active),s()}handleKeydown(a){a.code===ya.Esc&&this.handleCancel()}removeTextSelection(){var a;(a=this.document.getSelection())==null||a.removeAllRanges()}}const g6={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Gy extends Fy{constructor(a){const{event:s}=a,r=Pc(s.target);super(a,g6,r)}}Gy.activators=[{eventName:"onPointerDown",handler:(t,a)=>{let{nativeEvent:s}=t,{onActivation:r}=a;return!s.isPrimary||s.button!==0?!1:(r?.({event:s}),!0)}}];const y6={move:{name:"mousemove"},end:{name:"mouseup"}};var R0;(function(t){t[t.RightClick=2]="RightClick"})(R0||(R0={}));class v6 extends Fy{constructor(a){super(a,y6,Pc(a.event.target))}}v6.activators=[{eventName:"onMouseDown",handler:(t,a)=>{let{nativeEvent:s}=t,{onActivation:r}=a;return s.button===R0.RightClick?!1:(r?.({event:s}),!0)}}];const Tg={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class b6 extends Fy{constructor(a){super(a,Tg)}static setup(){return window.addEventListener(Tg.move.name,a,{capture:!1,passive:!1}),function(){window.removeEventListener(Tg.move.name,a)};function a(){}}}b6.activators=[{eventName:"onTouchStart",handler:(t,a)=>{let{nativeEvent:s}=t,{onActivation:r}=a;const{touches:l}=s;return l.length>1?!1:(r?.({event:s}),!0)}}];var au;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(au||(au={}));var Qh;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Qh||(Qh={}));function j6(t){let{acceleration:a,activator:s=au.Pointer,canScroll:r,draggingRect:l,enabled:o,interval:d=5,order:u=Qh.TreeOrder,pointerCoordinates:m,scrollableAncestors:h,scrollableAncestorRects:g,delta:x,threshold:y}=t;const v=w6({delta:x,disabled:!o}),[b,N]=OL(),S=p.useRef({x:0,y:0}),w=p.useRef({x:0,y:0}),E=p.useMemo(()=>{switch(s){case au.Pointer:return m?{top:m.y,bottom:m.y,left:m.x,right:m.x}:null;case au.DraggableRect:return l}},[s,l,m]),T=p.useRef(null),D=p.useCallback(()=>{const _=T.current;if(!_)return;const R=S.current.x*w.current.x,L=S.current.y*w.current.y;_.scrollBy(R,L)},[]),k=p.useMemo(()=>u===Qh.TreeOrder?[...h].reverse():h,[u,h]);p.useEffect(()=>{if(!o||!h.length||!E){N();return}for(const _ of k){if(r?.(_)===!1)continue;const R=h.indexOf(_),L=g[R];if(!L)continue;const{direction:U,speed:V}=o6(_,L,E,a,y);for(const F of["x","y"])v[F][U[F]]||(V[F]=0,U[F]=0);if(V.x>0||V.y>0){N(),T.current=_,b(D,d),S.current=V,w.current=U;return}}S.current={x:0,y:0},w.current={x:0,y:0},N()},[a,D,r,N,o,d,JSON.stringify(E),JSON.stringify(v),b,h,k,g,JSON.stringify(y)])}const N6={x:{[ms.Backward]:!1,[ms.Forward]:!1},y:{[ms.Backward]:!1,[ms.Forward]:!1}};function w6(t){let{delta:a,disabled:s}=t;const r=_0(a);return Iu(l=>{if(s||!r||!l)return N6;const o={x:Math.sign(a.x-r.x),y:Math.sign(a.y-r.y)};return{x:{[ms.Backward]:l.x[ms.Backward]||o.x===-1,[ms.Forward]:l.x[ms.Forward]||o.x===1},y:{[ms.Backward]:l.y[ms.Backward]||o.y===-1,[ms.Forward]:l.y[ms.Forward]||o.y===1}}},[s,a,r])}function S6(t,a){const s=a!=null?t.get(a):void 0,r=s?s.node.current:null;return Iu(l=>{var o;return a==null?null:(o=r??l)!=null?o:null},[r,a])}function C6(t,a){return p.useMemo(()=>t.reduce((s,r)=>{const{sensor:l}=r,o=l.activators.map(d=>({eventName:d.eventName,handler:a(d.handler,r)}));return[...s,...o]},[]),[t,a])}var gu;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(gu||(gu={}));var I0;(function(t){t.Optimized="optimized"})(I0||(I0={}));const Jw=new Map;function E6(t,a){let{dragging:s,dependencies:r,config:l}=a;const[o,d]=p.useState(null),{frequency:u,measure:m,strategy:h}=l,g=p.useRef(t),x=S(),y=Uy(x),v=p.useCallback(function(w){w===void 0&&(w=[]),!y.current&&d(E=>E===null?w:E.concat(w.filter(T=>!E.includes(T))))},[y]),b=p.useRef(null),N=Iu(w=>{if(x&&!s)return Jw;if(!w||w===Jw||g.current!==t||o!=null){const E=new Map;for(let T of t){if(!T)continue;if(o&&o.length>0&&!o.includes(T.id)&&T.rect.current){E.set(T.id,T.rect.current);continue}const D=T.node.current,k=D?new qy(m(D),D):null;T.rect.current=k,k&&E.set(T.id,k)}return E}return w},[t,o,s,x,m]);return p.useEffect(()=>{g.current=t},[t]),p.useEffect(()=>{x||v()},[s,x]),p.useEffect(()=>{o&&o.length>0&&d(null)},[JSON.stringify(o)]),p.useEffect(()=>{x||typeof u!="number"||b.current!==null||(b.current=setTimeout(()=>{v(),b.current=null},u))},[u,x,v,...r]),{droppableRects:N,measureDroppableContainers:v,measuringScheduled:o!=null};function S(){switch(h){case gu.Always:return!1;case gu.BeforeDragging:return s;default:return!s}}}function jD(t,a){return Iu(s=>t?s||(typeof a=="function"?a(t):t):null,[a,t])}function T6(t,a){return jD(t,a)}function D6(t){let{callback:a,disabled:s}=t;const r=Hy(a),l=p.useMemo(()=>{if(s||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,s]);return p.useEffect(()=>()=>l?.disconnect(),[l]),l}function Wy(t){let{callback:a,disabled:s}=t;const r=Hy(a),l=p.useMemo(()=>{if(s||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[s]);return p.useEffect(()=>()=>l?.disconnect(),[l]),l}function k6(t){return new qy(zu(t),t)}function eS(t,a,s){a===void 0&&(a=k6);const[r,l]=p.useState(null);function o(){l(m=>{if(!t)return null;if(t.isConnected===!1){var h;return(h=m??s)!=null?h:null}const g=a(t);return JSON.stringify(m)===JSON.stringify(g)?m:g})}const d=D6({callback(m){if(t)for(const h of m){const{type:g,target:x}=h;if(g==="childList"&&x instanceof HTMLElement&&x.contains(t)){o();break}}}}),u=Wy({callback:o});return pl(()=>{o(),t?(u?.observe(t),d?.observe(document.body,{childList:!0,subtree:!0})):(u?.disconnect(),d?.disconnect())},[t]),r}function A6(t){const a=jD(t);return mD(t,a)}const tS=[];function _6(t){const a=p.useRef(t),s=Iu(r=>t?r&&r!==tS&&t&&a.current&&t.parentNode===a.current.parentNode?r:Yy(t):tS,[t]);return p.useEffect(()=>{a.current=t},[t]),s}function M6(t){const[a,s]=p.useState(null),r=p.useRef(t),l=p.useCallback(o=>{const d=Cg(o.target);d&&s(u=>u?(u.set(d,O0(d)),new Map(u)):null)},[]);return p.useEffect(()=>{const o=r.current;if(t!==o){d(o);const u=t.map(m=>{const h=Cg(m);return h?(h.addEventListener("scroll",l,{passive:!0}),[h,O0(h)]):null}).filter(m=>m!=null);s(u.length?new Map(u):null),r.current=t}return()=>{d(t),d(o)};function d(u){u.forEach(m=>{const h=Cg(m);h?.removeEventListener("scroll",l)})}},[l,t]),p.useMemo(()=>t.length?a?Array.from(a.values()).reduce((o,d)=>lc(o,d),or):yD(t):or,[t,a])}function aS(t,a){a===void 0&&(a=[]);const s=p.useRef(null);return p.useEffect(()=>{s.current=null},a),p.useEffect(()=>{const r=t!==or;r&&!s.current&&(s.current=t),!r&&s.current&&(s.current=null)},[t]),s.current?Wh(t,s.current):or}function O6(t){p.useEffect(()=>{if(!Uf)return;const a=t.map(s=>{let{sensor:r}=s;return r.setup==null?void 0:r.setup()});return()=>{for(const s of a)s?.()}},t.map(a=>{let{sensor:s}=a;return s}))}function R6(t,a){return p.useMemo(()=>t.reduce((s,r)=>{let{eventName:l,handler:o}=r;return s[l]=d=>{o(d,a)},s},{}),[t,a])}function ND(t){return p.useMemo(()=>t?n6(t):null,[t])}const sS=[];function I6(t,a){a===void 0&&(a=zu);const[s]=t,r=ND(s?ln(s):null),[l,o]=p.useState(sS);function d(){o(()=>t.length?t.map(m=>xD(m)?r:new qy(a(m),m)):sS)}const u=Wy({callback:d});return pl(()=>{u?.disconnect(),d(),t.forEach(m=>u?.observe(m))},[t]),l}function z6(t){if(!t)return null;if(t.children.length>1)return t;const a=t.children[0];return Ru(a)?a:t}function L6(t){let{measure:a}=t;const[s,r]=p.useState(null),l=p.useCallback(h=>{for(const{target:g}of h)if(Ru(g)){r(x=>{const y=a(g);return x?{...x,width:y.width,height:y.height}:y});break}},[a]),o=Wy({callback:l}),d=p.useCallback(h=>{const g=z6(h);o?.disconnect(),g&&o?.observe(g),r(g?a(g):null)},[a,o]),[u,m]=A0(d);return p.useMemo(()=>({nodeRef:u,rect:s,setRef:m}),[s,u,m])}const P6=[{sensor:Gy,options:{}},{sensor:bD,options:{}}],B6={current:{}},Dh={draggable:{measure:Kw},droppable:{measure:Kw,strategy:gu.WhileDragging,frequency:I0.Optimized},dragOverlay:{measure:zu}};class su extends Map{get(a){var s;return a!=null&&(s=super.get(a))!=null?s:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(a=>{let{disabled:s}=a;return!s})}getNodeFor(a){var s,r;return(s=(r=this.get(a))==null?void 0:r.node.current)!=null?s:void 0}}const $6={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new su,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Xh},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Dh,measureDroppableContainers:Xh,windowRect:null,measuringScheduled:!1},H6={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Xh,draggableNodes:new Map,over:null,measureDroppableContainers:Xh},Ky=p.createContext(H6),U6=p.createContext($6);function V6(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new su}}}function Y6(t,a){switch(a.type){case Ts.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:a.initialCoordinates,active:a.active}};case Ts.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:a.coordinates.x-t.draggable.initialCoordinates.x,y:a.coordinates.y-t.draggable.initialCoordinates.y}}};case Ts.DragEnd:case Ts.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ts.RegisterDroppable:{const{element:s}=a,{id:r}=s,l=new su(t.droppable.containers);return l.set(r,s),{...t,droppable:{...t.droppable,containers:l}}}case Ts.SetDroppableDisabled:{const{id:s,key:r,disabled:l}=a,o=t.droppable.containers.get(s);if(!o||r!==o.key)return t;const d=new su(t.droppable.containers);return d.set(s,{...o,disabled:l}),{...t,droppable:{...t.droppable,containers:d}}}case Ts.UnregisterDroppable:{const{id:s,key:r}=a,l=t.droppable.containers.get(s);if(!l||r!==l.key)return t;const o=new su(t.droppable.containers);return o.delete(s),{...t,droppable:{...t.droppable,containers:o}}}default:return t}}function q6(t){let{disabled:a}=t;const{active:s,activatorEvent:r,draggableNodes:l}=p.useContext(Ky),o=_0(r),d=_0(s?.id);return p.useEffect(()=>{if(!a&&!r&&o&&d!=null){if(!dD(o)||document.activeElement===o.target)return;const u=l.get(d);if(!u)return;const{activatorNode:m,node:h}=u;if(!m.current&&!h.current)return;requestAnimationFrame(()=>{for(const g of[m.current,h.current]){if(!g)continue;const x=zL(g);if(x){x.focus();break}}})}},[r,a,l,d,o]),null}function F6(t,a){let{transform:s,...r}=a;return t!=null&&t.length?t.reduce((l,o)=>o({transform:l,...r}),s):s}function G6(t){return p.useMemo(()=>({draggable:{...Dh.draggable,...t?.draggable},droppable:{...Dh.droppable,...t?.droppable},dragOverlay:{...Dh.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function W6(t){let{activeNode:a,measure:s,initialRect:r,config:l=!0}=t;const o=p.useRef(!1),{x:d,y:u}=typeof l=="boolean"?{x:l,y:l}:l;pl(()=>{if(!d&&!u||!a){o.current=!1;return}if(o.current||!r)return;const h=a?.node.current;if(!h||h.isConnected===!1)return;const g=s(h),x=mD(g,r);if(d||(x.x=0),u||(x.y=0),o.current=!0,Math.abs(x.x)>0||Math.abs(x.y)>0){const y=hD(h);y&&y.scrollBy({top:x.y,left:x.x})}},[a,d,u,r,s])}const wD=p.createContext({...or,scaleX:1,scaleY:1});var sl;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(sl||(sl={}));const K6=p.memo(function(a){var s,r,l,o;let{id:d,accessibility:u,autoScroll:m=!0,children:h,sensors:g=P6,collisionDetection:x=QL,measuring:y,modifiers:v,...b}=a;const N=p.useReducer(Y6,void 0,V6),[S,w]=N,[E,T]=UL(),[D,k]=p.useState(sl.Uninitialized),_=D===sl.Initialized,{draggable:{active:R,nodes:L,translate:U},droppable:{containers:V}}=S,F=R!=null?L.get(R):null,G=p.useRef({initial:null,translated:null}),$=p.useMemo(()=>{var Xe;return R!=null?{id:R,data:(Xe=F?.data)!=null?Xe:B6,rect:G}:null},[R,F]),z=p.useRef(null),[H,I]=p.useState(null),[O,Y]=p.useState(null),le=Uy(b,Object.values(b)),re=Vy("DndDescribedBy",d),Q=p.useMemo(()=>V.getEnabled(),[V]),q=G6(y),{droppableRects:M,measureDroppableContainers:W,measuringScheduled:ie}=E6(Q,{dragging:_,dependencies:[U.x,U.y],config:q.droppable}),ve=S6(L,R),K=p.useMemo(()=>O?M0(O):null,[O]),oe=jt(),_e=T6(ve,q.draggable.measure);W6({activeNode:R!=null?L.get(R):null,config:oe.layoutShiftCompensation,initialRect:_e,measure:q.draggable.measure});const je=eS(ve,q.draggable.measure,_e),Ie=eS(ve?ve.parentElement:null),ge=p.useRef({activatorEvent:null,active:null,activeNode:ve,collisionRect:null,collisions:null,droppableRects:M,draggableNodes:L,draggingNode:null,draggingNodeRect:null,droppableContainers:V,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Be=V.getNodeFor((s=ge.current.over)==null?void 0:s.id),ke=L6({measure:q.dragOverlay.measure}),gt=(r=ke.nodeRef.current)!=null?r:ve,Dt=_?(l=ke.rect)!=null?l:je:null,kt=!!(ke.nodeRef.current&&ke.rect),ja=A6(kt?null:je),Wt=ND(gt?ln(gt):null),Vt=_6(_?Be??ve:null),X=I6(Vt),se=F6(v,{transform:{x:U.x-ja.x,y:U.y-ja.y,scaleX:1,scaleY:1},activatorEvent:O,active:$,activeNodeRect:je,containerNodeRect:Ie,draggingNodeRect:Dt,over:ge.current.over,overlayNodeRect:ke.rect,scrollableAncestors:Vt,scrollableAncestorRects:X,windowRect:Wt}),me=K?lc(K,U):null,Oe=M6(Vt),Re=aS(Oe),Ee=aS(Oe,[je]),Pe=lc(se,Re),Je=Dt?e6(Dt,se):null,rt=$&&Je?x({active:$,collisionRect:Je,droppableRects:M,droppableContainers:Q,pointerCoordinates:me}):null,Et=KL(rt,"id"),[Kt,Ne]=p.useState(null),Ve=kt?se:lc(se,Ee),nt=ZL(Ve,(o=Kt?.rect)!=null?o:null,je),bt=p.useRef(null),Pt=p.useCallback((Xe,et)=>{let{sensor:$e,options:Ae}=et;if(z.current==null)return;const Fe=L.get(z.current);if(!Fe)return;const lt=Xe.nativeEvent,Xt=new $e({active:z.current,activeNode:Fe,event:lt,options:Ae,context:ge,onAbort(ct){if(!L.get(ct))return;const{onDragAbort:qt}=le.current,da={id:ct};qt?.(da),E({type:"onDragAbort",event:da})},onPending(ct,pa,qt,da){if(!L.get(ct))return;const{onDragPending:xa}=le.current,ys={id:ct,constraint:pa,initialCoordinates:qt,offset:da};xa?.(ys),E({type:"onDragPending",event:ys})},onStart(ct){const pa=z.current;if(pa==null)return;const qt=L.get(pa);if(!qt)return;const{onDragStart:da}=le.current,Na={activatorEvent:lt,active:{id:pa,data:qt.data,rect:G}};Wl.unstable_batchedUpdates(()=>{da?.(Na),k(sl.Initializing),w({type:Ts.DragStart,initialCoordinates:ct,active:pa}),E({type:"onDragStart",event:Na}),I(bt.current),Y(lt)})},onMove(ct){w({type:Ts.DragMove,coordinates:ct})},onEnd:ht(Ts.DragEnd),onCancel:ht(Ts.DragCancel)});bt.current=Xt;function ht(ct){return async function(){const{active:qt,collisions:da,over:Na,scrollAdjustedTranslate:xa}=ge.current;let ys=null;if(qt&&xa){const{cancelDrop:on}=le.current;ys={activatorEvent:lt,active:qt,collisions:da,delta:xa,over:Na},ct===Ts.DragEnd&&typeof on=="function"&&await Promise.resolve(on(ys))&&(ct=Ts.DragCancel)}z.current=null,Wl.unstable_batchedUpdates(()=>{w({type:ct}),k(sl.Uninitialized),Ne(null),I(null),Y(null),bt.current=null;const on=ct===Ts.DragEnd?"onDragEnd":"onDragCancel";if(ys){const cs=le.current[on];cs?.(ys),E({type:on,event:ys})}})}}},[L]),_a=p.useCallback((Xe,et)=>($e,Ae)=>{const Fe=$e.nativeEvent,lt=L.get(Ae);if(z.current!==null||!lt||Fe.dndKit||Fe.defaultPrevented)return;const Xt={active:lt};Xe($e,et.options,Xt)===!0&&(Fe.dndKit={capturedBy:et.sensor},z.current=Ae,Pt($e,et))},[L,Pt]),Ma=C6(g,_a);O6(g),pl(()=>{je&&D===sl.Initializing&&k(sl.Initialized)},[je,D]),p.useEffect(()=>{const{onDragMove:Xe}=le.current,{active:et,activatorEvent:$e,collisions:Ae,over:Fe}=ge.current;if(!et||!$e)return;const lt={active:et,activatorEvent:$e,collisions:Ae,delta:{x:Pe.x,y:Pe.y},over:Fe};Wl.unstable_batchedUpdates(()=>{Xe?.(lt),E({type:"onDragMove",event:lt})})},[Pe.x,Pe.y]),p.useEffect(()=>{const{active:Xe,activatorEvent:et,collisions:$e,droppableContainers:Ae,scrollAdjustedTranslate:Fe}=ge.current;if(!Xe||z.current==null||!et||!Fe)return;const{onDragOver:lt}=le.current,Xt=Ae.get(Et),ht=Xt&&Xt.rect.current?{id:Xt.id,rect:Xt.rect.current,data:Xt.data,disabled:Xt.disabled}:null,ct={active:Xe,activatorEvent:et,collisions:$e,delta:{x:Fe.x,y:Fe.y},over:ht};Wl.unstable_batchedUpdates(()=>{Ne(ht),lt?.(ct),E({type:"onDragOver",event:ct})})},[Et]),pl(()=>{ge.current={activatorEvent:O,active:$,activeNode:ve,collisionRect:Je,collisions:rt,droppableRects:M,draggableNodes:L,draggingNode:gt,draggingNodeRect:Dt,droppableContainers:V,over:Kt,scrollableAncestors:Vt,scrollAdjustedTranslate:Pe},G.current={initial:Dt,translated:Je}},[$,ve,rt,Je,L,gt,Dt,M,V,Kt,Vt,Pe]),j6({...oe,delta:U,draggingRect:Je,pointerCoordinates:me,scrollableAncestors:Vt,scrollableAncestorRects:X});const qe=p.useMemo(()=>({active:$,activeNode:ve,activeNodeRect:je,activatorEvent:O,collisions:rt,containerNodeRect:Ie,dragOverlay:ke,draggableNodes:L,droppableContainers:V,droppableRects:M,over:Kt,measureDroppableContainers:W,scrollableAncestors:Vt,scrollableAncestorRects:X,measuringConfiguration:q,measuringScheduled:ie,windowRect:Wt}),[$,ve,je,O,rt,Ie,ke,L,V,M,Kt,W,Vt,X,q,ie,Wt]),dt=p.useMemo(()=>({activatorEvent:O,activators:Ma,active:$,activeNodeRect:je,ariaDescribedById:{draggable:re},dispatch:w,draggableNodes:L,over:Kt,measureDroppableContainers:W}),[O,Ma,$,je,w,re,L,Kt,W]);return te.createElement(uD.Provider,{value:T},te.createElement(Ky.Provider,{value:dt},te.createElement(U6.Provider,{value:qe},te.createElement(wD.Provider,{value:nt},h)),te.createElement(q6,{disabled:u?.restoreFocus===!1})),te.createElement(qL,{...u,hiddenTextDescribedById:re}));function jt(){const Xe=H?.autoScrollEnabled===!1,et=typeof m=="object"?m.enabled===!1:m===!1,$e=_&&!Xe&&!et;return typeof m=="object"?{...m,enabled:$e}:{enabled:$e}}}),X6=p.createContext(null),nS="button",Q6="Draggable";function SD(t){let{id:a,data:s,disabled:r=!1,attributes:l}=t;const o=Vy(Q6),{activators:d,activatorEvent:u,active:m,activeNodeRect:h,ariaDescribedById:g,draggableNodes:x,over:y}=p.useContext(Ky),{role:v=nS,roleDescription:b="draggable",tabIndex:N=0}=l??{},S=m?.id===a,w=p.useContext(S?wD:X6),[E,T]=A0(),[D,k]=A0(),_=R6(d,a),R=Uy(s);pl(()=>(x.set(a,{id:a,key:o,node:E,activatorNode:D,data:R}),()=>{const U=x.get(a);U&&U.key===o&&x.delete(a)}),[x,a]);const L=p.useMemo(()=>({role:v,tabIndex:N,"aria-disabled":r,"aria-pressed":S&&v===nS?!0:void 0,"aria-roledescription":b,"aria-describedby":g.draggable}),[r,v,N,S,b,g.draggable]);return{active:m,activatorEvent:u,activeNodeRect:h,attributes:L,isDragging:S,listeners:r?void 0:_,node:E,over:y,setNodeRef:T,setActivatorNodeRef:k,transform:w}}function Z6(t){const a=J6(t),s=p.forwardRef((r,l)=>{const{children:o,...d}=r,u=p.Children.toArray(o),m=u.find(tP);if(m){const h=m.props.children,g=u.map(x=>x===m?p.Children.count(h)>1?p.Children.only(null):p.isValidElement(h)?h.props.children:null:x);return e.jsx(a,{...d,ref:l,children:p.isValidElement(h)?p.cloneElement(h,void 0,g):null})}return e.jsx(a,{...d,ref:l,children:o})});return s.displayName=`${t}.Slot`,s}function J6(t){const a=p.forwardRef((s,r)=>{const{children:l,...o}=s;if(p.isValidElement(l)){const d=sP(l),u=aP(o,l.props);return l.type!==p.Fragment&&(u.ref=r?W0(r,d):d),p.cloneElement(l,u)}return p.Children.count(l)>1?p.Children.only(null):null});return a.displayName=`${t}.SlotClone`,a}var eP=Symbol("radix.slottable");function tP(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===eP}function aP(t,a){const s={...a};for(const r in a){const l=t[r],o=a[r];/^on[A-Z]/.test(r)?l&&o?s[r]=(...u)=>{const m=o(...u);return l(...u),m}:l&&(s[r]=l):r==="style"?s[r]={...l,...o}:r==="className"&&(s[r]=[l,o].filter(Boolean).join(" "))}return{...t,...s}}function sP(t){let a=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=a&&"isReactWarning"in a&&a.isReactWarning;return s?t.ref:(a=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=a&&"isReactWarning"in a&&a.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var Vf="Popover",[CD,O7]=vi(Vf,[Nc]),Lu=Nc(),[nP,Nl]=CD(Vf),ED=t=>{const{__scopePopover:a,children:s,open:r,defaultOpen:l,onOpenChange:o,modal:d=!1}=t,u=Lu(a),m=p.useRef(null),[h,g]=p.useState(!1),[x,y]=Mr({prop:r,defaultProp:l??!1,onChange:o,caller:Vf});return e.jsx(Q0,{...u,children:e.jsx(nP,{scope:a,contentId:wc(),triggerRef:m,open:x,onOpenChange:y,onOpenToggle:p.useCallback(()=>y(v=>!v),[y]),hasCustomAnchor:h,onCustomAnchorAdd:p.useCallback(()=>g(!0),[]),onCustomAnchorRemove:p.useCallback(()=>g(!1),[]),modal:d,children:s})})};ED.displayName=Vf;var TD="PopoverAnchor",rP=p.forwardRef((t,a)=>{const{__scopePopover:s,...r}=t,l=Nl(TD,s),o=Lu(s),{onCustomAnchorAdd:d,onCustomAnchorRemove:u}=l;return p.useEffect(()=>(d(),()=>u()),[d,u]),e.jsx(hf,{...o,...r,ref:a})});rP.displayName=TD;var DD="PopoverTrigger",kD=p.forwardRef((t,a)=>{const{__scopePopover:s,...r}=t,l=Nl(DD,s),o=Lu(s),d=Sa(a,l.triggerRef),u=e.jsx(Gt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":RD(l.open),...r,ref:d,onClick:Nt(t.onClick,l.onOpenToggle)});return l.hasCustomAnchor?u:e.jsx(hf,{asChild:!0,...o,children:u})});kD.displayName=DD;var Xy="PopoverPortal",[iP,lP]=CD(Xy,{forceMount:void 0}),AD=t=>{const{__scopePopover:a,forceMount:s,children:r,container:l}=t,o=Nl(Xy,a);return e.jsx(iP,{scope:a,forceMount:s,children:e.jsx(bi,{present:s||o.open,children:e.jsx(IC,{asChild:!0,container:l,children:r})})})};AD.displayName=Xy;var yc="PopoverContent",_D=p.forwardRef((t,a)=>{const s=lP(yc,t.__scopePopover),{forceMount:r=s.forceMount,...l}=t,o=Nl(yc,t.__scopePopover);return e.jsx(bi,{present:r||o.open,children:o.modal?e.jsx(cP,{...l,ref:a}):e.jsx(dP,{...l,ref:a})})});_D.displayName=yc;var oP=Z6("PopoverContent.RemoveScroll"),cP=p.forwardRef((t,a)=>{const s=Nl(yc,t.__scopePopover),r=p.useRef(null),l=Sa(a,r),o=p.useRef(!1);return p.useEffect(()=>{const d=r.current;if(d)return zC(d)},[]),e.jsx(PC,{as:oP,allowPinchZoom:!0,children:e.jsx(MD,{...t,ref:l,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Nt(t.onCloseAutoFocus,d=>{d.preventDefault(),o.current||s.triggerRef.current?.focus()}),onPointerDownOutside:Nt(t.onPointerDownOutside,d=>{const u=d.detail.originalEvent,m=u.button===0&&u.ctrlKey===!0,h=u.button===2||m;o.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:Nt(t.onFocusOutside,d=>d.preventDefault(),{checkForDefaultPrevented:!1})})})}),dP=p.forwardRef((t,a)=>{const s=Nl(yc,t.__scopePopover),r=p.useRef(!1),l=p.useRef(!1);return e.jsx(MD,{...t,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(r.current||s.triggerRef.current?.focus(),o.preventDefault()),r.current=!1,l.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(l.current=!0));const d=o.target;s.triggerRef.current?.contains(d)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&l.current&&o.preventDefault()}})}),MD=p.forwardRef((t,a)=>{const{__scopePopover:s,trapFocus:r,onOpenAutoFocus:l,onCloseAutoFocus:o,disableOutsidePointerEvents:d,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:h,onInteractOutside:g,...x}=t,y=Nl(yc,s),v=Lu(s);return LC(),e.jsx(BC,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:l,onUnmountAutoFocus:o,children:e.jsx(K0,{asChild:!0,disableOutsidePointerEvents:d,onInteractOutside:g,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:h,onDismiss:()=>y.onOpenChange(!1),children:e.jsx(X0,{"data-state":RD(y.open),role:"dialog",id:y.contentId,...v,...x,ref:a,style:{...x.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),OD="PopoverClose",uP=p.forwardRef((t,a)=>{const{__scopePopover:s,...r}=t,l=Nl(OD,s);return e.jsx(Gt.button,{type:"button",...r,ref:a,onClick:Nt(t.onClick,()=>l.onOpenChange(!1))})});uP.displayName=OD;var mP="PopoverArrow",hP=p.forwardRef((t,a)=>{const{__scopePopover:s,...r}=t,l=Lu(s);return e.jsx(Z0,{...l,...r,ref:a})});hP.displayName=mP;function RD(t){return t?"open":"closed"}var fP=ED,pP=kD,xP=AD,ID=_D;const Yf=fP,qf=pP,Pu=p.forwardRef(({className:t,align:a="center",sideOffset:s=4,...r},l)=>e.jsx(xP,{children:e.jsx(ID,{ref:l,align:a,sideOffset:s,className:he("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));Pu.displayName=ID.displayName;const gP=({habit:t,customTime:a,onComplete:s,onReset:r,style:l,className:o})=>{const[d,u]=p.useState(!1),{attributes:m,listeners:h,setNodeRef:g,transform:x,isDragging:y}=SD({id:`habit-${t.id}`,data:{habit:t,type:"habit-move",currentTime:a||t.baseTime},disabled:d}),v=NE[t.id]||"bg-purple-500",b=()=>({"bg-blue-500":"#3b82f6","bg-green-500":"#22c55e","bg-yellow-500":"#eab308","bg-orange-500":"#f97316","bg-purple-500":"#a855f7","bg-pink-500":"#ec4899","bg-red-500":"#ef4444","bg-teal-500":"#14b8a6","bg-indigo-500":"#6366f1","bg-gray-500":"#6b7280","bg-lime-500":"#84cc16","bg-amber-500":"#f59e0b","bg-cyan-500":"#06b6d4","bg-fuchsia-500":"#d946ef","bg-rose-500":"#f43f5e","bg-violet-500":"#8b5cf6","bg-sky-500":"#0ea5e9","bg-emerald-500":"#10b981","bg-yellow-600":"#ca8a04","bg-pink-600":"#db2777","bg-blue-600":"#2563eb","bg-green-600":"#16a34a"})[v]||"#a855f7",N=T=>{T.stopPropagation(),u(!1),s(t.id)},S=T=>{T.stopPropagation(),u(!1),r&&r(t.id)},w=x?{transform:Kh.Transform.toString(x),zIndex:1e3}:{},E=a&&a!==t.baseTime;return e.jsxs(Yf,{open:d,onOpenChange:u,children:[e.jsx(qf,{asChild:!0,children:e.jsxs("div",{className:he("cursor-pointer overflow-hidden rounded text-white text-xs relative","hover:opacity-90 transition-opacity","flex",y&&"opacity-50 shadow-lg",o),style:{...l,...w,backgroundColor:b(),minHeight:"25px"},children:[e.jsx("div",{ref:g,...m,...h,className:"w-6 flex-shrink-0 bg-black/10 hover:bg-black/20 flex items-center justify-center cursor-move border-r border-white/20 transition-colors",title:"Arrastrar para mover hbito",children:e.jsx(m1,{className:"w-4 h-4 opacity-75"})}),e.jsx("div",{className:"flex-1 px-2 flex items-center min-w-0",children:e.jsxs("div",{className:"flex items-center gap-1.5 w-full",children:[e.jsx("span",{className:"text-base leading-none flex-shrink-0",children:t.icon}),e.jsx("span",{className:"font-medium text-xs leading-none truncate flex-1",children:t.name})]})})]})}),e.jsx(Pu,{className:"w-80 p-3",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"space-y-1",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-2xl",children:t.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:t.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Duracin: ",t.goal]})]})]})}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Hora:"}),e.jsx("span",{className:"font-medium",children:a||t.baseTime})]}),E&&e.jsxs("div",{className:"text-[10px] text-amber-600 flex items-center gap-1",children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Hora personalizada (base: ",t.baseTime,")"]})]})]}),t.steps&&t.steps.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground",children:"Pasos:"}),e.jsx("ul",{className:"text-xs space-y-1 pl-4",children:t.steps.map((T,D)=>e.jsx("li",{className:"list-disc text-gray-600",children:T},D))})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs(P,{variant:"default",size:"sm",className:"w-full h-8 text-xs bg-green-600 hover:bg-green-700",onClick:N,title:"Marcar como completado",children:[e.jsx(cr,{className:"w-3 h-3 mr-1"}),"Completar"]}),E&&r&&e.jsxs(P,{variant:"outline",size:"sm",className:"w-full h-8 text-xs",onClick:S,title:"Volver a hora base",children:[e.jsx(h1,{className:"w-3 h-3 mr-1"}),"Restablecer hora (",t.baseTime,")"]})]}),e.jsx("div",{className:"text-[10px] text-muted-foreground pt-2 border-t",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Arrastra desde el borde izquierdo para cambiar la hora"})]})})]})})]})},yP=()=>{const[t,a]=p.useState("weekly"),{user:s}=st(),{completedHabits:r,status:l,error:o,toggleHabit:d}=CL();return s?e.jsx(fe,{className:"w-full",children:e.jsxs(xe,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Hbitos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ML,{completedHabits:r}),e.jsx(dL,{view:t,onViewChange:a})]})]}),e.jsx("div",{className:"mb-4"}),t==="weekly"?e.jsx(wL,{completedHabits:r,onToggle:d,disabled:l==="saving"}):e.jsx(SL,{completedHabits:r,onToggle:d}),o&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:o})]})}):e.jsx(fe,{className:"w-full",children:e.jsx(xe,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesin para registrar tus hbitos"})})})},na=({title:t,subtitle:a,icon:s,views:r,activeViewKey:l,onViewChange:o,actions:d=[],className:u,children:m})=>{const{shouldShowDesktopNav:h}=ku(),g=h?"w-full px-6":"w-full px-4",x=r?.find(y=>y.key===l);return e.jsxs("div",{className:he("min-h-screen relative",u),children:[e.jsx("div",{className:g,children:e.jsxs("div",{className:"bg-background/50 flex flex-col gap-4 py-4 backdrop-blur-md lg:mt-4 lg:rounded-2xl lg:border lg:px-4 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s&&e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-sm",children:s}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-foreground",children:t}),a&&e.jsx("p",{className:"text-sm text-gray-500",children:a})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[r&&o&&e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{children:x?.label??"Vistas"}),e.jsx(rn,{className:"h-4 w-4"})]})}),e.jsx(Nn,{align:"end",children:r.map(y=>e.jsx(Lt,{onClick:()=>o(y.key),className:he(l===y.key&&"bg-accent font-medium"),children:y.label},y.key))})]}),d.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Vs,{children:e.jsx("div",{className:"hidden lg:flex items-center gap-2",children:d.map(y=>y.dropdown?e.jsxs(Hn,{children:[e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsx(Un,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:he(y.showLabel?"h-8 px-3 gap-2":"h-8 w-8 p-0",y.className),children:[y.icon,y.showLabel?e.jsx("span",{className:"text-sm font-medium",children:y.label}):e.jsx("span",{className:"sr-only",children:y.label})]})})}),y.tooltip&&e.jsx(fa,{children:e.jsx("p",{children:y.tooltip})})]}),e.jsx(Nn,{align:"end",children:y.dropdown.map((v,b)=>e.jsx(Lt,{onClick:v.onClick,children:v.label},b))})]},y.id):e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:he(y.showLabel?"h-8 px-3 gap-2":"h-8 w-8 p-0",y.className),onClick:y.onClick,children:[y.icon,y.showLabel?e.jsx("span",{className:"text-sm font-medium",children:y.label}):e.jsx("span",{className:"sr-only",children:y.label})]})}),y.tooltip&&e.jsx(fa,{children:e.jsx("p",{children:y.tooltip})})]},y.id))})}),e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 lg:hidden",children:[e.jsx(Su,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsx(Nn,{align:"end",className:"w-56",children:d.map(y=>y.dropdown?e.jsxs(EL,{children:[e.jsxs(iD,{children:[y.icon,e.jsx("span",{className:"ml-2",children:y.label})]}),e.jsx(lD,{children:y.dropdown.map((v,b)=>e.jsx(Lt,{onClick:v.onClick,children:v.label},b))})]},y.id):e.jsxs(Lt,{onClick:y.onClick,children:[y.icon,e.jsx("span",{className:"ml-2",children:y.label})]},y.id))})]})]})]})]})}),e.jsx("div",{className:he(g,"pb-4"),children:m})]})},zD=[{key:"tracker",label:"Registro diario"},{key:"analytics",label:"Analisis"}],rS="tracker",vP=({selectedDate:t,onDateChange:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(jl,{selectedDate:t,onChange:a}),e.jsx("div",{className:"grid grid-cols-1",children:e.jsx(yP,{selectedDate:t})})]}),bP=({habitStats:t})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 gap-4 lg:gap-6 xl:gap-8 desktop-grid-responsive",children:[e.jsx(fe,{className:"desktop-card-enhanced",children:e.jsxs(xe,{className:"p-4 lg:p-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Tendencias de Habitos"}),e.jsx("div",{className:"h-64 md:h-80 lg:h-96",children:e.jsx(gn,{children:e.jsxs(ol,{data:t,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"date"}),e.jsx(Jn,{}),e.jsx(yn,{}),e.jsx(li,{}),nn.map(a=>e.jsx(ui,{type:"monotone",dataKey:a.name,name:`${a.icon} ${a.name}`,stroke:`var(--${a.name.toLowerCase()}-color)`},a.id))]})})})]})}),e.jsx(fe,{className:"desktop-card-enhanced",children:e.jsx(xe,{className:"p-4 lg:p-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Resumen del Mes"})})})]}),jP=()=>{const t=it(),{viewKey:a}=Ss(),s=a||rS,[r,l]=p.useState(new Date),[o]=p.useState([]),d=zD.map(g=>({...g,component:g.key==="tracker"?vP:bP})),u=d.find(g=>g.key===s);if(!u)return e.jsx(Ft,{to:ae.habit.view(rS),replace:!0});const m=[{id:"config",label:"Configuracion",icon:e.jsx(_s,{className:"h-4 w-4"}),onClick:()=>t(ae.habit.config),tooltip:"Configuracion"}],h=u.component;return e.jsx(na,{title:"Seguimiento de Habitos",subtitle:"Registra y analiza tus habitos diarios para mejorar tu estilo de vida",icon:e.jsx(hl,{className:"h-4 w-4 text-white"}),views:d,activeViewKey:s,onViewChange:g=>t(ae.habit.view(g)),actions:m,children:e.jsx("div",{className:"p-4 space-y-4",children:e.jsx(h,{selectedDate:r,onDateChange:l,habitStats:o})})})},NP=()=>{const t=it();return e.jsx(na,{title:"Configuracion de Habitos",icon:e.jsx(hl,{className:"h-4 w-4 text-white"}),views:zD.map(a=>({...a,component:()=>null})),onViewChange:a=>t(`/habit/view/${a}`),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"No hay configuraciones especificas para Habitos en este modulo."})})})})},wP={module:"habit",defaultRoute:ae.habit.view(ae.habit.defaultView),moduleRoutes:[{path:"habit",element:e.jsx(Ft,{to:ae.habit.view(ae.habit.defaultView),replace:!0})},{path:"habit/view/:viewKey",element:e.jsx(jP,{})},{path:"habit/config",element:e.jsx(NP,{})}]},LD=[{key:"list",label:"Lista"},{key:"kanban",label:"Kanban"},{key:"calendar",label:"Calendario"},{key:"analytics",label:"Analisis"}],iS="list",PD=({openCreateModal:t,onSave:a,isModalOpen:s=!1})=>{const r=p.useCallback(l=>{const o=document.activeElement,d=o instanceof HTMLInputElement||o instanceof HTMLTextAreaElement||o instanceof HTMLSelectElement||o?.getAttribute("contenteditable")==="true";if(l.ctrlKey&&l.key==="n"&&!d){l.preventDefault(),l.stopPropagation(),t();return}if(l.ctrlKey&&l.key==="s"&&s&&a){l.preventDefault(),l.stopPropagation(),a();return}},[t,a,s]);return p.useEffect(()=>(document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}),[r]),{openCreateModal:t}},ml={PERSONAL:"personal",WORK:"work",JIKKO:"jikko",UNICAUCA:"unicauca",ENTREAGILES:"entreagiles",CERTMIND:"certmind",HOME:"home",HEALTH:"health",SHOPPING:"shopping",STUDY:"study",SOCIAL:"social",OTHER:"other"},Ya={personal:"Personal",work:"Trabajo",jikko:"Jikko",unicauca:"Unicauca",entreagiles:"EntreAgiles",certmind:"CertMind",home:"Casa",health:"Salud",shopping:"Compras",study:"Estudio",social:"Social",other:"Otro"},_r={personal:{bg:"bg-green-100",text:"text-green-700"},work:{bg:"bg-blue-100",text:"text-blue-700"},jikko:{bg:"bg-blue-100",text:"text-orange-700"},unicauca:{bg:"bg-red-100",text:"text-teal-700"},entreagiles:{bg:"bg-black-100",text:"text-lime-700"},certmind:{bg:"bg-purple-100",text:"text-purple-700"},home:{bg:"bg-green-100",text:"text-green-700"},health:{bg:"bg-pink-100",text:"text-red-700"},shopping:{bg:"bg-pink-100",text:"text-yellow-700"},study:{bg:"bg-indigo-100",text:"text-indigo-700"},social:{bg:"bg-pink-100",text:"text-pink-700"},other:{bg:"bg-gray-100",text:"text-gray-700"}},SP=Dc("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),wt=p.forwardRef(({className:t,variant:a,...s},r)=>e.jsx("div",{ref:r,className:he(SP({variant:a}),t),...s}));wt.displayName="Badge";const CP={daily:"Diario",weekly:"Semanal",monthly:"Mensual"},lS={do:{label:"HACER",color:"bg-red-500",text:"Urgente e importante"},decide:{label:"DECIDIR",color:"bg-orange-500",text:"Importante, no urgente"},delegate:{label:"DELEGAR",color:"bg-blue-500",text:"Urgente, no importante"},delete:{label:"ELIMINAR",color:"bg-gray-500",text:"Ni urgente ni importante"},none:{label:"",color:"",text:""}},oS=t=>Jt(t,"dd/MM"),EP=t=>t?.type&&CP[t.type]||"",TP=(t="none")=>lS[t]||lS.none,DP=t=>t?Ua(ka(t),ka(new Date)):!1,BD=p.memo(({task:t,onEdit:a,onDelete:s,onView:r})=>{const l=it(),o=p.useCallback(h=>{h.stopPropagation(),a(t)},[a,t]),d=p.useCallback(h=>{h.stopPropagation(),r?.(t)},[r,t]),u=p.useCallback(h=>{h.stopPropagation(),l(`/task/${t.id}/run`)},[l,t.taskCode]),m=p.useCallback(()=>{s(t.id)},[s,t.id]);return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:u,className:"h-7 w-7 p-0 text-green-600 hover:text-green-700 hover:bg-green-50",title:"Ejecutar tarea",children:e.jsx(Bs,{className:"h-3 w-3"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:o,className:"h-7 w-7 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Editar tarea",children:e.jsx(Vn,{className:"h-3 w-3"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:d,className:"h-7 w-7 p-0 text-gray-600 hover:text-gray-700 hover:bg-gray-100",title:"Ver detalles",children:e.jsx(Cu,{className:"h-3 w-3"})}),e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 hover:bg-gray-50",onClick:h=>h.stopPropagation(),children:e.jsx(IM,{className:"w-3 h-3"})})}),e.jsx(Nn,{align:"end",className:"w-48",children:e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsxs(Lt,{onSelect:h=>h.preventDefault(),onClick:h=>h.stopPropagation(),className:"text-sm text-red-600 focus:text-red-600",children:[e.jsx("span",{className:"mr-2",children:""}),"Eliminar tarea"]})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Eliminar tarea?"}),e.jsxs(fr,{children:['Esta accin no se puede deshacer. La tarea "',t.title,'" ser eliminada permanentemente.']})]}),e.jsxs(mr,{children:[e.jsx(xr,{onClick:h=>h.stopPropagation(),children:"Cancelar"}),e.jsx(pr,{onClick:h=>{h.stopPropagation(),m()},className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})})]})]})});BD.displayName="CompactTaskActions";const yu=p.memo(({task:t,onDelete:a,onEdit:s,onView:r,onMove:l,onAssignTimeOfDay:o,showCategoryLabel:d=!0})=>{const u=it(),m=DP(t.startDate??null),h=TP(t.priority),g=p.useCallback(()=>{r?.(t)},[r,t]),x=()=>t.completed?"default":m?"destructive":"secondary",y=()=>t.completed?e.jsx(Ac,{className:"h-3 w-3"}):m?e.jsx(xs,{className:"h-3 w-3"}):e.jsx(Aa,{className:"h-3 w-3"}),v=()=>{if(t.completed)return"Completada";if(m)return"Vencida";if(t.startDate){const b=ka(new Date),N=ps(b,1);if(Ua(t.startDate,ka(ps(b,1))))return"Hoy";if(Ua(t.startDate,ka(ps(N,1))))return"Maana"}return"Pendiente"};return e.jsxs("div",{className:"hover:bg-gray-50 transition-colors cursor-pointer",onClick:g,children:[e.jsx("div",{className:"md:hidden",children:e.jsx(fe,{className:he("border border-gray-200 bg-white m-2",t.completed&&"opacity-75",!t.completed&&m&&"border-l-4 border-l-red-500 bg-red-50/30"),children:e.jsx(xe,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[d&&e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx(pc,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:he("text-sm font-medium text-gray-900 flex-1",t.completed&&"line-through text-gray-500"),children:t.title}),e.jsxs("span",{className:"text-xs font-mono text-gray-400",children:["#",t.taskCode]})]}),t.description&&e.jsx("p",{className:he("text-xs text-gray-500 mt-1 line-clamp-2",t.completed&&"line-through"),children:t.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wt,{variant:x(),className:"text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",children:[y(),e.jsx("span",{children:v()})]})}),t.isPrivate&&e.jsx(wt,{variant:"outline",className:"text-xs",children:""})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[d&&e.jsx("span",{children:Ya[t.category]}),t.estimatedTime&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[t.estimatedTime,"m"]})]}),t.startDate&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx("span",{children:oS(t.startDate)})]}),h.label&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx("span",{children:h.label})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),u(`/task/${t.id}/run`)},className:"h-6 w-6 p-0 text-green-600",children:e.jsx(Bs,{className:"h-3 w-3"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:b=>{b.stopPropagation(),s(t)},className:"h-6 w-6 p-0 text-blue-600",children:e.jsx(Vn,{className:"h-3 w-3"})})]})]})]})})})}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 p-4 border-b border-gray-100",children:[e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[d&&e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx(pc,{className:"h-4 w-4 text-gray-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:he("text-sm font-medium text-gray-900 flex-1",t.completed&&"line-through text-gray-500"),children:t.title}),e.jsxs("span",{className:"text-xs font-mono text-gray-400",children:["#",t.taskCode]})]}),t.description&&e.jsx("p",{className:he("text-xs text-gray-500 mt-1 line-clamp-1",t.completed&&"line-through"),children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[d&&e.jsx("span",{className:"text-xs text-gray-500",children:Ya[t.category]}),t.isPrivate&&e.jsx(wt,{variant:"outline",className:"text-xs",children:" Privada"}),t.isRecurrent&&e.jsxs(wt,{variant:"outline",className:"text-xs",children:[e.jsx(ny,{className:"w-3 h-3 mr-1"}),EP(t.recurrence)]})]})]})]})}),e.jsx("div",{className:"col-span-2 flex justify-center items-center",children:e.jsx(wt,{variant:x(),className:"text-xs",children:e.jsxs("div",{className:"flex items-center gap-1",children:[y(),e.jsx("span",{children:v()})]})})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:h.label?e.jsx(wt,{variant:"outline",className:"text-xs",style:{backgroundColor:h.color+"20",color:h.color},children:h.label}):e.jsx("span",{className:"text-xs text-gray-400",children:"Sin prioridad"})}),e.jsx("div",{className:"col-span-1 flex justify-center items-center",children:t.estimatedTime?e.jsxs("span",{className:"text-xs text-gray-600",children:[t.estimatedTime,"m"]}):e.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),e.jsx("div",{className:"col-span-2 flex justify-center items-center",children:t.startDate?e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(Aa,{className:"h-3 w-3"}),e.jsx("span",{children:oS(t.startDate)})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"Sin fecha"})}),e.jsx("div",{className:"col-span-2 flex justify-center items-center",children:e.jsx(BD,{task:t,onEdit:s,onDelete:a,onView:r,onMove:l,onAssignTimeOfDay:o})})]})]})});yu.displayName="TaskItemList";const Vd=({title:t,tasks:a,onDelete:s,onEdit:r,onView:l,onMove:o,onAssignTimeOfDay:d})=>{if(a.length===0)return null;const u={do:0,decide:1,delegate:2,delete:3},m=a.sort((h,g)=>{const x=u[h.priority||"none"]??4,y=u[g.priority||"none"]??4;return x!==y?x-y:h.startDate&&g.startDate?h.startDate.getTime()-g.startDate.getTime():!h.startDate&&!g.startDate?(g.createdAt?.seconds||0)-(h.createdAt?.seconds||0):h.startDate?-1:1});return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-500 uppercase tracking-wider pt-4",children:t}),e.jsx("div",{className:"hidden md:block",children:e.jsx(fe,{children:e.jsxs(xe,{className:"p-0",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 p-4 bg-gray-50 border-b text-sm font-medium text-gray-700",children:[e.jsx("div",{className:"col-span-4",children:"Tarea"}),e.jsx("div",{className:"col-span-2 text-center",children:"Estado"}),e.jsx("div",{className:"col-span-1 text-center",children:"Prioridad"}),e.jsx("div",{className:"col-span-1 text-center",children:"Tiempo"}),e.jsx("div",{className:"col-span-2 text-center",children:"Fecha"}),e.jsx("div",{className:"col-span-2 text-center",children:"Acciones"})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:m.map(h=>e.jsx(yu,{task:h,onDelete:s,onEdit:r,onView:l,onMove:o,onAssignTimeOfDay:d},h.id))})]})})}),e.jsx("div",{className:"md:hidden space-y-3",children:m.map(h=>e.jsx(yu,{task:h,onDelete:s,onEdit:r,onView:l,onMove:o,onAssignTimeOfDay:d},h.id))})]})},ye=p.forwardRef(({className:t,type:a,inputMode:s,...r},l)=>{const o=s||kP(a);return e.jsx("input",{type:a,inputMode:o,className:he("flex h-11 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background","file:border-0 file:bg-transparent file:text-sm file:font-medium","placeholder:text-muted-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50","transition-colors duration-150","touch-manipulation","appearance-none [-webkit-appearance:none]",t),ref:l,...r})});ye.displayName="Input";function kP(t){switch(t){case"email":return"email";case"tel":return"tel";case"number":return"numeric";case"search":return"search";case"url":return"url";default:return"text"}}const cS={all:"Todas las fechas",today:"Hoy",week:"Esta semana",month:"Este mes",overdue:"Vencidas",noDate:"Sin fecha"},AP=({tasks:t,onDelete:a,onEdit:s,onView:r,onMove:l,onAssignTimeOfDay:o,status:d,error:u})=>{const[m,h]=p.useState("all"),[g,x]=p.useState("all"),[y,v]=p.useState(!1),[b,N]=p.useState(""),S=p.useMemo(()=>{let D=m==="all"?t:t.filter(F=>F.category===m);if(b.trim()){const F=b.toLowerCase().trim();D=D.filter(G=>G.title.toLowerCase().includes(F)||G.description&&G.description.toLowerCase().includes(F))}const k=new Date,_=ka(k),R=nc(k),L=rc(k),U=an(k),V=wu(k);switch(g){case"today":return D.filter(F=>F.startDate&&Xl(F.startDate,{start:_,end:Kl(k)}));case"week":return D.filter(F=>F.startDate&&Xl(F.startDate,{start:R,end:L}));case"month":return D.filter(F=>F.startDate&&Xl(F.startDate,{start:U,end:V}));case"overdue":return D.filter(F=>F.startDate&&Ua(F.startDate,_));case"noDate":return D.filter(F=>!F.startDate);default:return D}},[t,m,g,b]),w=p.useMemo(()=>b.trim()!==""||m!=="all"||g!=="all",[b,m,g]),E=()=>{N(""),h("all"),x("all")},T=p.useMemo(()=>{const D=new Date,k=ka(D),_=Kl(D),R=rc(D);return S.reduce((L,U)=>(U.startDate&&Ua(U.startDate,k)?L.overdue.push(U):U.startDate?Ua(U.startDate,_)?L.today.push(U):Ua(U.startDate,R)?L.thisWeek.push(U):L.future.push(U):L.noDate.push(U),L),{overdue:[],today:[],thisWeek:[],future:[],noDate:[]})},[S]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 items-stretch sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ye,{placeholder:"Buscar tareas por nombre o descripcin...",value:b,onChange:D=>N(D.target.value),className:"pl-10 pr-10"}),b&&e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>N(""),className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Fa,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"md:hidden flex gap-2",children:[e.jsxs(P,{variant:w?"default":"outline",onClick:()=>v(!y),className:`flex items-center gap-2 ${w?"bg-blue-600 hover:bg-blue-700":""}`,children:[e.jsx(Eu,{className:"w-4 h-4"}),"Filtros",w&&e.jsx("span",{className:"bg-white text-blue-600 rounded-full px-2 py-0.5 text-xs font-medium",children:"Activos"})]}),w&&e.jsx(P,{variant:"ghost",onClick:E,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Fa,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"hidden md:flex",children:w&&e.jsxs(P,{variant:"ghost",onClick:E,className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(Fa,{className:"w-4 h-4"}),"Limpiar filtros"]})})]}),"      ",e.jsxs("div",{className:`space-y-4 md:space-y-0 md:flex md:items-center md:gap-4 ${y?"block":"hidden md:flex"}`,children:[e.jsxs("div",{className:"flex-1 space-y-2 md:space-y-0",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium block md:inline md:mr-2",children:"Categora:"}),e.jsxs(yt,{value:m,onValueChange:D=>h(D),children:[e.jsx(ft,{className:`w-full md:w-[180px] ${m!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:m==="all"?"Todas las categoras":Ya[m]})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"all",children:"Todas las categoras"}),Object.entries(ml).map(([D,k])=>e.jsx(Le,{value:k,children:Ya[k]},D))]})]})]}),e.jsxs("div",{className:"flex-1 space-y-2 md:space-y-0",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium block md:inline md:mr-2",children:"Fecha:"}),e.jsxs(yt,{value:g,onValueChange:D=>x(D),children:[e.jsx(ft,{className:`w-full md:w-[180px] ${g!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:cS[g]})}),e.jsx(pt,{children:Object.entries(cS).map(([D,k])=>e.jsx(Le,{value:D,children:k},D))})]})]})]}),e.jsxs("div",{children:[e.jsx(Vd,{title:"Tareas Vencidas",tasks:T.overdue,onDelete:a,onEdit:s,onView:r,onMove:l,onAssignTimeOfDay:o}),e.jsx(Vd,{title:"Para Hoy",tasks:T.today,onDelete:a,onEdit:s,onView:r,onMove:l,onAssignTimeOfDay:o}),e.jsx(Vd,{title:"Esta Semana",tasks:T.thisWeek,onDelete:a,onEdit:s,onView:r,onMove:l,onAssignTimeOfDay:o}),e.jsx(Vd,{title:"Prximamente",tasks:T.future,onDelete:a,onEdit:s,onView:r,onMove:l,onAssignTimeOfDay:o}),e.jsx(Vd,{title:"Sin Fecha",tasks:T.noDate,onDelete:a,onEdit:s,onView:r,onMove:l,onAssignTimeOfDay:o}),S.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:m==="all"&&g==="all"?"No hay tareas pendientes":"No hay tareas pendientes con los filtros seleccionados"}),d&&d!=="idle"&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-500",children:[d==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border border-gray-300 border-t-blue-500 rounded-full animate-spin"}),e.jsx("span",{children:"Cargando tareas..."})]}),d==="saving"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border border-gray-300 border-t-blue-500 rounded-full animate-spin"}),e.jsx("span",{children:"Guardando..."})]}),d==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),d==="saved"&&e.jsx("span",{className:"text-green-600",children:" Sincronizado"}),d==="error"&&u&&e.jsx("span",{className:"text-red-600",children:" Error de sincronizacin"})]})})]})]})},_P={daily:"Diario",weekly:"Semanal",monthly:"Mensual"},dS={do:{label:"HACER",color:"bg-red-500",text:"Urgente e importante"},decide:{label:"DECIDIR",color:"bg-orange-500",text:"Importante, no urgente"},delegate:{label:"DELEGAR",color:"bg-blue-500",text:"Urgente, no importante"},delete:{label:"ELIMINAR",color:"bg-gray-500",text:"Ni urgente ni importante"},none:{label:"",color:"",text:""}},Dg={do:{icon:"",num:1,style:"bg-red-600 text-white"},decide:{icon:"",num:2,style:"bg-orange-500 text-white"},delegate:{icon:"",num:3,style:"bg-blue-500 text-white"},delete:{icon:"",num:4,style:"bg-gray-500 text-white"},none:{icon:"",num:4,style:"bg-gray-500 text-white"}},MP=t=>Jt(t,"dd/MM"),OP=t=>t?.type&&_P[t.type]||"",RP=(t="none")=>dS[t]||dS.none,IP=t=>t?Ua(ka(t),ka(new Date)):!1,$D=p.memo(({task:t,showCategoryLabel:a,overdue:s})=>{const r={bg:_r[t.category]?.bg||"bg-purple-100",text:_r[t.category]?.text||"text-purple-800"},l=RP(t.priority),o=OP(t.recurrence),d="text-xs px-1.5 py-0.5";return e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a&&e.jsxs(wt,{className:he(d,r.bg,r.text),children:[e.jsx(pc,{className:"w-3 h-3 mr-1"}),Ya[t.category]]}),t.startDate&&e.jsxs(wt,{variant:s?"destructive":"secondary",className:d,children:[e.jsx(Aa,{className:"w-3 h-3 mr-1"}),MP(t.startDate),s&&" (vencida)"]}),e.jsx(Vs,{children:e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(wt,{className:he(d,"gap-0.5",Dg[t.priority||"none"].style),children:[e.jsx("span",{className:"mr-0.5",children:Dg[t.priority||"none"].icon}),Dg[t.priority||"none"].num]})}),e.jsx(fa,{children:l.text})]})}),t.estimatedTime!==void 0&&e.jsxs(wt,{variant:"outline",className:d,children:[e.jsx(xs,{className:"w-3 h-3 mr-1"}),t.estimatedTime,"m"]}),t.isRecurrent&&o&&e.jsxs(wt,{variant:"outline",className:d,children:[e.jsx(ny,{className:"w-3 h-3 mr-1"}),o]})]})});$D.displayName="TaskBadges";const HD=p.memo(({task:t,onEdit:a,onDelete:s,onMove:r,onAssignTimeOfDay:l})=>{const o=it(),d=p.useCallback(D=>ps(ka(new Date),D),[]),u=p.useCallback(D=>{D.stopPropagation(),r?.(t.id,d(0))},[d,r,t.id]),m=p.useCallback(D=>{D.stopPropagation(),r?.(t.id,d(1))},[d,r,t.id]),h=p.useCallback(D=>{D.stopPropagation(),r?.(t.id,d(2))},[d,r,t.id]),g=p.useCallback(D=>{D.stopPropagation(),r?.(t.id,null)},[r,t.id]),x=p.useCallback(D=>{D.stopPropagation(),l?.(t.id,"morning")},[l,t.id]),y=p.useCallback(D=>{D.stopPropagation(),l?.(t.id,"afternoon")},[l,t.id]),v=p.useCallback(D=>{D.stopPropagation(),l?.(t.id,"evening")},[l,t.id]),b=p.useCallback(D=>{D.stopPropagation(),a(t)},[a,t]),N=p.useCallback(()=>{s(t.id)},[s,t.id]),S=p.useCallback(D=>{D.stopPropagation(),o(`/task/${t.id}/run`)},[o,t.taskCode]),w="h-6 w-6 md:h-5 md:w-5 p-0 rounded-full hover:bg-muted",E=r&&e.jsxs("div",{className:"flex gap-1 pr-2 border-r border-gray-200",children:[e.jsx(P,{variant:"ghost",size:"icon",className:w,title:"Asignar para hoy",onClick:u,children:e.jsx("span",{role:"img","aria-label":"hoy",className:"text-xs",children:""})}),e.jsx(P,{variant:"ghost",size:"icon",className:w,title:"Asignar para maana",onClick:m,children:e.jsx("span",{role:"img","aria-label":"maana",className:"text-xs",children:""})}),e.jsx(P,{variant:"ghost",size:"icon",className:w,title:"Asignar para pasado maana",onClick:h,children:e.jsx("span",{role:"img","aria-label":"pasado maana",className:"text-xs",children:""})}),e.jsx(P,{variant:"ghost",size:"icon",className:w,title:"Quitar fecha",onClick:g,children:e.jsx("span",{role:"img","aria-label":"sin fecha",className:"text-xs",children:""})})]}),T=l&&e.jsxs("div",{className:"flex gap-1 pl-2",children:[e.jsx(P,{variant:"ghost",size:"icon",className:he(w,"bg-amber-50 hover:bg-amber-100"),title:"Horario: Maana (6AM-12PM)",onClick:x,children:e.jsx("span",{role:"img","aria-label":"horario maana",className:"text-xs",children:""})}),e.jsx(P,{variant:"ghost",size:"icon",className:he(w,"bg-blue-50 hover:bg-blue-100"),title:"Horario: Tarde (12PM-6PM)",onClick:y,children:e.jsx("span",{role:"img","aria-label":"horario tarde",className:"text-xs",children:""})}),e.jsx(P,{variant:"ghost",size:"icon",className:he(w,"bg-purple-50 hover:bg-purple-100"),title:"Horario: Noche (6PM-12AM)",onClick:v,children:e.jsx("span",{role:"img","aria-label":"horario noche",className:"text-xs",children:""})})]});return e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsxs("div",{className:"flex gap-1",children:[E,T]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(P,{variant:"ghost",size:"icon",className:w,title:"Ejecutar",onClick:S,children:e.jsx(Bs,{className:"w-3 h-3 md:w-3 md:h-3 text-green-600"})}),e.jsx(P,{variant:"ghost",size:"icon",className:w,title:"Editar tarea",onClick:b,children:e.jsx(Vn,{className:"w-3 h-3 md:w-3 md:h-3 text-muted-foreground"})}),e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"icon",className:he(w,"hover:bg-red-50"),title:"Eliminar tarea",onClick:D=>D.stopPropagation(),children:e.jsx(Fa,{className:"w-3 h-3 md:w-3 md:h-3 text-red-500"})})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Eliminar tarea?"}),e.jsxs(fr,{children:['Esta accin no se puede deshacer. La tarea "',t.title,'" ser eliminada permanentemente.']})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"Cancelar"}),e.jsx(pr,{onClick:N,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})]})});HD.displayName="TaskKanbanActions";const UD=p.memo(({task:t,onDelete:a,onEdit:s,onView:r,onMove:l,onAssignTimeOfDay:o,showCategoryLabel:d=!0})=>{const u=IP(t.startDate??null),{total:m,checked:h}=Mu(t.description||""),g=m?t.progress??h/m*100:0,x=p.useCallback(()=>{r?.(t)},[r,t]),y=he("cursor-pointer relative hover:shadow-md transition-all duration-200 border-0 shadow-sm text-sm w-full max-w-none lg:max-w-[18rem]",t.completed?"bg-muted/30":"bg-white",!t.completed&&u&&"border-l-4 border-l-red-500 bg-red-50");return e.jsxs(fe,{onClick:x,className:y,children:[e.jsx(xe,{className:"p-2 md:p-2 flex flex-col gap-1.5",children:e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.isPrivate&&e.jsx("span",{className:"text-xs",children:""}),e.jsx("span",{className:he("text-sm break-words line-clamp-2 font-medium flex-1",t.completed?"line-through text-muted-foreground":"text-foreground"),children:t.title}),e.jsxs("span",{className:"text-xs font-mono text-gray-400 flex-shrink-0",children:["#",t.taskCode]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 pt-0.5",children:e.jsx($D,{task:t,showCategoryLabel:d,overdue:u})}),m>0&&e.jsxs("div",{className:"pt-1 space-y-0.5",children:[e.jsx(Us,{value:g,className:"h-1"}),e.jsxs("p",{className:"text-[10px] text-right text-muted-foreground",children:[h," de ",m]})]})]})})}),e.jsx("div",{className:"px-2 py-1.5 w-full",children:e.jsx(HD,{task:t,onEdit:s,onDelete:a,onMove:l,onAssignTimeOfDay:o})})]})});UD.displayName="TaskItemKanban";const uS=t=>{const a=Math.floor(t/60),s=t%60;return`${a<10?"0":""}${a}:${s<10?"0":""}${s}`},mS=t=>{if(t<60)return`${t} min`;const a=Math.floor(t/60),s=t%60;return`${a}h ${s}min`},hS={all:"Todas las fechas",today:"Hoy",tomorrow:"Maana",week:"Esta semana",month:"Este mes",overdue:"Vencidas",noDate:"Sin fecha"},fS={all:"Todas",do:"do",decide:"decide",delegate:"delegate",delete:"delete"},pS={all:"Todas",none:"Sin tamao",pequea:"pequea",mediana:"mediana",grande:"grande"},dh={all:"Todas",yes:"S",no:"No"},xS={all:"Todas",t60:"1h",t120:"2h",t180:"3h",none:"Sin estimacin"},gS={default:"Predeterminado",priorityAsc:"Prioridad ",priorityDesc:"Prioridad ",durationAsc:"Duracin ",durationDesc:"Duracin "},zP=({tasks:t,onDelete:a,onEdit:s,onView:r,onMove:l,onAdd:o,onFilteredTasksChange:d})=>{const[u,m]=p.useState(null),[h,g]=p.useState("all"),[x,y]=p.useState("today"),[v,b]=p.useState("all"),[N,S]=p.useState("all"),[w,E]=p.useState("all"),[T,D]=p.useState("all"),[k,_]=p.useState("all"),[R,L]=p.useState("default"),[U,V]=p.useState(!1),[F,G]=p.useState(""),$=p.useMemo(()=>{let M=t.filter(ge=>!ge.isRecurrent&&!ge.isPrivate);if(F.trim()){const ge=F.toLowerCase().trim();M=M.filter(Be=>Be.title.toLowerCase().includes(ge)||Be.description&&Be.description.toLowerCase().includes(ge))}if(h!=="all"&&(M=M.filter(ge=>ge.category===h)),v!=="all"&&(M=M.filter(ge=>ge.priority===v)),N!=="all"&&(N==="none"?M=M.filter(ge=>!ge.size):M=M.filter(ge=>ge.size===N)),k!=="all")if(k==="none")M=M.filter(ge=>ge.estimatedTime===void 0);else{const Be={t60:60,t120:120,t180:180,all:1/0,none:0}[k];M=M.filter(ke=>(ke.estimatedTime??1/0)<=Be)}w!=="all"&&(M=M.filter(ge=>{const Be=ge.priority==="do"||ge.priority==="delegate";return w==="yes"?Be:!Be})),T!=="all"&&(M=M.filter(ge=>{const Be=ge.priority==="do"||ge.priority==="decide";return T==="yes"?Be:!Be}));const W=new Date,ie=ka(W),ve=nc(W),K=rc(W),oe=an(W),_e=wu(W),je=ps(ie,1),Ie=Kl(je);switch(x){case"today":return M.filter(ge=>ge.startDate&&Xl(ge.startDate,{start:ie,end:Kl(W)}));case"tomorrow":return M.filter(ge=>ge.startDate&&Xl(ge.startDate,{start:je,end:Ie}));case"week":return M.filter(ge=>ge.startDate&&Xl(ge.startDate,{start:ve,end:K}));case"month":return M.filter(ge=>ge.startDate&&Xl(ge.startDate,{start:oe,end:_e}));case"overdue":return M.filter(ge=>ge.startDate&&Ua(ge.startDate,ie));case"noDate":return M.filter(ge=>!ge.startDate);default:return M}},[t,h,v,N,w,T,k,x,F]);p.useEffect(()=>{d?.($)},[$,d]);const z=p.useMemo(()=>F.trim()!==""||h!=="all"||x!=="today"||v!=="all"||N!=="all"||w!=="all"||T!=="all"||k!=="all",[F,h,x,v,N,w,T,k]),H=()=>{G(""),g("all"),y("today"),b("all"),S("all"),E("all"),D("all"),_("all"),L("default")},I=p.useMemo(()=>{const M=new Date,W=ka(M),ie=Kl(M),ve=ps(ka(M),1),K=Kl(ve),oe=rc(M),_e={do:0,decide:1,delegate:2,delete:3},je=$.reduce((ge,Be)=>(Be.startDate&&Ua(Be.startDate,W)?ge.overdue.push(Be):Be.startDate?Ua(Be.startDate,ie)?ge.today.push(Be):Ua(Be.startDate,K)?ge.tomorrow.push(Be):Ua(Be.startDate,oe)?ge.thisWeek.push(Be):ge.future.push(Be):ge.noDate.push(Be),ge),{overdue:[],today:[],tomorrow:[],thisWeek:[],future:[],noDate:[]}),Ie=(ge,Be)=>{const ke=_e[ge.priority||"none"]??4,gt=_e[Be.priority||"none"]??4,Dt=ge.estimatedTime??1/0,kt=Be.estimatedTime??1/0;switch(R){case"priorityAsc":if(ke!==gt)return gt-ke;break;case"priorityDesc":if(ke!==gt)return ke-gt;break;case"durationAsc":if(Dt!==kt)return Dt-kt;break;case"durationDesc":if(Dt!==kt)return kt-Dt;break;default:if(ke!==gt)return ke-gt}return ge.startDate&&Be.startDate?ge.startDate.getTime()-Be.startDate.getTime():!ge.startDate&&!Be.startDate?(Be.createdAt?.seconds||0)-(ge.createdAt?.seconds||0):ge.startDate?-1:1};return Object.values(je).forEach(ge=>{ge.sort(Ie)}),je},[$,R]),O=p.useMemo(()=>{const M={overdue:0,today:0,tomorrow:0,thisWeek:0,future:0,noDate:0};return Object.keys(I).forEach(W=>{M[W]=I[W].reduce((ie,ve)=>ie+(ve.estimatedTime||0),0)}),M},[I]),Y=p.useMemo(()=>Object.values(O).reduce((M,W)=>M+W,0),[O]),le=[{key:"overdue",title:"Vencidas"},{key:"today",title:"Para Hoy"},{key:"tomorrow",title:"Maana"},{key:"thisWeek",title:"Esta Semana"},{key:"future",title:"Prximamente"},{key:"noDate",title:"Sin Fecha"}],re=M=>{const W=new Date;switch(M){case"overdue":return rl(ps(ka(W),-1));case"today":return rl(W);case"tomorrow":return rl(ps(ka(W),1));case"thisWeek":return rl(rc(W));case"future":return rl(J0(W,1));default:return null}},Q=M=>{u&&(l(u.id,re(M)),m(null))},q=()=>{const M=$.map(ie=>({nombre:ie.title,descripcin:ie.description||"",categoria:Ya[ie.category],prioridad:ie.priority||"sin prioridad",tamao:ie.size||"sin tamao",fecha:ie.startDate?new Date(ie.startDate).toLocaleDateString("es-ES"):"sin fecha",completada:ie.completed?"S":"No"})),W=JSON.stringify(M,null,2);navigator.clipboard.writeText(W).then(()=>{ut.success(`${M.length} tareas filtradas copiadas al portapapeles`)}).catch(()=>{ut.error("Error al copiar las tareas")})};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-end items-center text-xs text-gray-500 gap-1",children:[e.jsx(xs,{className:"w-3 h-3"}),mS(Y)]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 items-stretch sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ye,{placeholder:"Buscar tareas por nombre...",value:F,onChange:M=>G(M.target.value),className:"pl-10 pr-10"}),F&&e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>G(""),className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Fa,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"md:hidden flex gap-2",children:[e.jsxs(P,{variant:z?"default":"outline",onClick:()=>V(!U),className:`flex items-center gap-2 ${z?"bg-blue-600 hover:bg-blue-700":""}`,children:[e.jsx(Eu,{className:"w-4 h-4"}),"Filtros",z&&e.jsx("span",{className:"bg-white text-blue-600 rounded-full px-2 py-0.5 text-xs font-medium",children:"Activos"})]}),z&&e.jsx(P,{variant:"ghost",onClick:H,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Fa,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"hidden md:flex",children:z&&e.jsxs(P,{variant:"ghost",onClick:H,className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(Fa,{className:"w-4 h-4"}),"Limpiar filtros"]})})]}),e.jsx("div",{className:`${U?"block":"hidden md:block"}`,children:e.jsxs("div",{className:"flex flex-wrap items-end gap-3 md:gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Categora"}),e.jsxs(yt,{value:h,onValueChange:M=>g(M),children:[e.jsx(ft,{className:`w-32 ${h!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:h==="all"?"Todas":Ya[h]})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"all",children:"Todas"}),Object.values(ml).map(M=>e.jsx(Le,{value:M,children:Ya[M]},M))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Fecha"}),e.jsxs(yt,{value:x,onValueChange:M=>y(M),children:[e.jsx(ft,{className:`w-32 ${x!=="today"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:hS[x]})}),e.jsx(pt,{children:Object.entries(hS).map(([M,W])=>e.jsx(Le,{value:M,children:W},M))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Prioridad"}),e.jsxs(yt,{value:v,onValueChange:M=>b(M),children:[e.jsx(ft,{className:`w-24 ${v!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:fS[v]})}),e.jsx(pt,{children:Object.entries(fS).map(([M,W])=>e.jsx(Le,{value:M,children:W},M))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Tamao"}),e.jsxs(yt,{value:N,onValueChange:M=>S(M),children:[e.jsx(ft,{className:`w-24 ${N!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:pS[N]})}),e.jsx(pt,{children:Object.entries(pS).map(([M,W])=>e.jsx(Le,{value:M,children:W},M))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Urgente"}),e.jsxs(yt,{value:w,onValueChange:M=>E(M),children:[e.jsx(ft,{className:`w-20 ${w!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:dh[w]})}),e.jsx(pt,{children:Object.entries(dh).map(([M,W])=>e.jsx(Le,{value:M,children:W},M))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Importante"}),e.jsxs(yt,{value:T,onValueChange:M=>D(M),children:[e.jsx(ft,{className:`w-20 ${T!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:dh[T]})}),e.jsx(pt,{children:Object.entries(dh).map(([M,W])=>e.jsx(Le,{value:M,children:W},M))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Estimado"}),e.jsxs(yt,{value:k,onValueChange:M=>_(M),children:[e.jsx(ft,{className:`w-24 ${k!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(vt,{children:xS[k]})}),e.jsx(pt,{children:Object.entries(xS).map(([M,W])=>e.jsx(Le,{value:M,children:W},M))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ordenar"}),e.jsxs(yt,{value:R,onValueChange:M=>L(M),children:[e.jsx(ft,{className:"w-28",children:e.jsx(vt,{children:gS[R]})}),e.jsx(pt,{children:Object.entries(gS).map(([M,W])=>e.jsx(Le,{value:M,children:W},M))})]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Exportar filtradas"}),e.jsxs(P,{variant:"outline",size:"sm",onClick:q,className:"flex items-center gap-1 min-w-fit",disabled:$.length===0,title:`Copia al portapapeles las ${$.length} tareas que se muestran actualmente con todos los filtros aplicados`,children:[e.jsx(Rr,{className:"w-3 h-3"}),e.jsxs("span",{className:"whitespace-nowrap",children:["Copiar visibles (",$.length,")"]})]})]})})]})}),e.jsx("div",{className:"flex flex-col lg:flex-row items-start gap-2 lg:gap-4 overflow-x-auto pb-2 p-2 lg:p-3 rounded bg-gradient-to-br from-blue-50 via-indigo-50 to-indigo-100",children:le.map(M=>e.jsxs("div",{className:"w-full lg:w-[16rem] xl:w-[18rem] lg:flex-shrink-0 space-y-2",onDragOver:W=>W.preventDefault(),onDrop:()=>Q(M.key),children:[e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("h3",{className:"font-medium text-xs lg:text-sm text-gray-500 uppercase tracking-wider flex items-center gap-1",children:[M.title,O[M.key]>0&&e.jsxs("span",{className:"text-[10px] text-gray-400 flex items-center gap-1",children:[e.jsx(xs,{className:"w-3 h-3"}),mS(O[M.key])]})]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(P,{size:"icon",variant:"ghost",onClick:()=>o(re(M.key)),className:"h-6 w-6 lg:h-8 lg:w-8",children:e.jsx(It,{className:"w-3 h-3 lg:w-4 lg:h-4"})})})]}),I[M.key].map(W=>e.jsx("div",{draggable:!0,onDragStart:()=>m(W),onDragEnd:()=>m(null),children:e.jsx(UD,{task:W,onDelete:a,onEdit:s,onView:r,onMove:l,showCategoryLabel:h==="all"})},W.id))]},M.key))})]})};function LP(t){const a="https://calendar.google.com/calendar/render",s=new URLSearchParams;s.append("action","TEMPLATE"),s.append("text",t.title);const r=d=>Jt(d,"yyyyMMdd'T'HHmmss"),l=r(t.startDate),o=t.endDate?r(t.endDate):r(new Date(t.startDate.getTime()+3600*1e3));return s.append("dates",`${l}/${o}`),t.description&&s.append("details",t.description),s.append("ctz","America/Bogota"),`${a}?${s.toString()}`}function PP(t){const a=LP(t);window.open(a,"_blank","noopener,noreferrer")}function VD(){return{exportTaskToGoogleCalendar:p.useCallback(a=>{if(a.isPrivate){console.warn("Private tasks cannot be exported to Google Calendar");return}if(!a.startDate){console.warn("Task must have a start date to export");return}let s="";const r=Ya[a.category];if(s+=` Categora: ${r}

`,a.priority&&(s+=` Prioridad: ${{do:" HACER (Urgente e Importante)",decide:" DECIDIR (Importante)",delegate:" DELEGAR (Urgente)",delete:" ELIMINAR"}[a.priority]}

`),a.estimatedTime){const o=Math.floor(a.estimatedTime/60),d=a.estimatedTime%60,u=o>0?`${o}h ${d}min`:`${d}min`;s+=` Tiempo estimado: ${u}

`}a.description&&(s+=` Descripcin:
${a.description}

`),a.isRecurrent&&a.recurrence&&(s+=` Tarea recurrente (${a.recurrence.pattern})
`),s+=`
---
Tarea #${a.taskCode} - Life Tracker`;let l=a.endDate;!l&&a.estimatedTime&&(l=new Date(a.startDate.getTime()+a.estimatedTime*60*1e3)),PP({title:a.title,description:s,startDate:a.startDate,endDate:l})},[])}}const BP=t=>{const a={do:{label:"HACER",color:"bg-red-500",text:"Urgente e importante",urgent:!0,important:!0},decide:{label:"DECIDIR",color:"bg-yellow-500",text:"Importante pero no urgente",urgent:!1,important:!0},delegate:{label:"DELEGAR",color:"bg-blue-500",text:"Urgente pero no importante",urgent:!0,important:!1},delete:{label:"ELIMINAR",color:"bg-gray-500",text:"Ni urgente ni importante",urgent:!1,important:!1},none:{label:"",color:"",text:"",urgent:!1,important:!1}};return a[t]||a.none},$P=t=>{if(!t)return"";if(t<60)return`${t} min`;{const a=Math.floor(t/60),s=t%60;return s===0?`${a}h`:`${a}h ${s}min`}},YD=({task:t,isOpen:a,onClose:s,onEdit:r,onToggle:l,onDelete:o})=>{if(!t)return null;const d=it(),{exportTaskToGoogleCalendar:u}=VD(),m=_r[t.category],h=BP(t.priority),g=t.isRecurrent&&t.recurrence?wE(t.startDate||new Date,t.recurrence.pattern,t.recurrence.customDays):"",x=t.startDate&&Ua(ka(t.startDate),ka(new Date)),{total:y,checked:v}=Mu(t.description||""),b=y>0,N=b?t.progress??v/y*100:0,S=KT(t.description||"");return e.jsx(Mt,{open:a,onOpenChange:w=>{w||s()},children:e.jsxs(Tt,{className:"max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-12 md:col-span-8 space-y-6",children:[e.jsx(Ot,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[t.isPrivate&&e.jsx("span",{className:"text-lg mt-1",children:""}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(Rt,{className:"text-2xl font-semibold leading-tight break-words text-gray-900",children:t.title}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["en lista ",e.jsx("span",{className:"font-medium",children:Ya[t.category]})]}),e.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-md bg-gray-100 text-gray-700",children:e.jsxs("span",{className:"text-xs font-mono",children:["#",t.taskCode]})})]})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.startDate&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium ${x?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:[e.jsx("span",{children:""}),M5(t.startDate),x&&" (Vencida)"]}),t.timeOfDay&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-orange-100 text-orange-800",children:[e.jsx("span",{children:""}),t.timeOfDay==="morning"&&"Maana",t.timeOfDay==="afternoon"&&"Tarde",t.timeOfDay==="evening"&&"Noche"]})]}),t.description&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{children:""}),"Descripcin"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:S}}),b&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Progreso de elementos"}),e.jsxs("span",{className:"text-gray-600",children:[v," de ",y," completados"]})]}),e.jsx(Us,{value:N,className:"h-2"})]})]})]}),t.priority&&h.text||t.isRecurrent&&g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{children:""}),"Detalles adicionales"]}),t.priority&&h.text&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Matriz de Eisenhower"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:h.text}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Urgente:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${h.urgent?"bg-red-100 text-red-800":"bg-gray-100 text-gray-600"}`,children:h.urgent?"S":"No"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Importante:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${h.important?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"}`,children:h.important?"S":"No"})]}),h.label&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium text-white ${h.color}`,children:[e.jsx("span",{children:""}),h.label]})]})]})]}):null]}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Acciones"}),e.jsxs("div",{className:"space-y-2",children:[l&&e.jsx(P,{onClick:()=>l(t.id,!t.completed),variant:t.completed?"outline":"default",className:"w-full justify-start gap-2",children:t.completed?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),"Marcar pendiente"]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),"Marcar completada"]})}),e.jsxs(P,{onClick:()=>d(`/task/${t.id}/run`),variant:"outline",className:"w-full justify-start gap-2",children:[e.jsx(Bs,{className:"w-4 h-4"}),"Ejecutar"]}),t.startDate&&!t.isPrivate&&e.jsxs(P,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>u(t),children:[e.jsx(Aa,{className:"w-4 h-4"}),"Exportar a Google Calendar"]}),e.jsxs(P,{onClick:()=>r(t),variant:"outline",className:"w-full justify-start gap-2",children:[e.jsx("span",{children:""}),"Editar"]}),o&&e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsxs(P,{variant:"outline",className:"w-full justify-start gap-2 text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx("span",{children:""}),"Eliminar"]})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Eliminar tarea?"}),e.jsxs(fr,{children:['Esta accin no se puede deshacer. La tarea "',t.title,'" ser eliminada permanentemente.']})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"Cancelar"}),e.jsx(pr,{onClick:()=>{o(t.id),s()},className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Organizacin"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Lista"}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium ${m.bg} ${m.text}`,children:[e.jsx("span",{children:""}),Ya[t.category]]})]}),t.size&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tamao"}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-gray-100 text-gray-800",children:[e.jsx("span",{children:""}),t.size]})]}),t.estimatedTime&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tiempo estimado"}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-emerald-100 text-emerald-800",children:[e.jsx("span",{children:""}),$P(t.estimatedTime)]})]}),t.isRecurrent&&g&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Recurrencia"}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-purple-100 text-purple-800",children:[e.jsx("span",{children:""}),g]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"text-sm text-gray-500 pt-2 border-t",children:[e.jsx("p",{className:"font-medium text-gray-600 mb-1",children:"Creada"}),t.createdAt?new Date(t.createdAt.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"Recientemente"]})})]})]}),e.jsx(Cs,{className:"mt-6 border-t pt-4",children:e.jsx(P,{variant:"outline",onClick:s,children:"Cerrar"})})]})})},HP={do:{color:"bg-red-500",text:"Hacer (urgente + importante)",label:" do"},decide:{color:"bg-orange-500",text:"Decidir (importante)",label:" decide"},delegate:{color:"bg-blue-500",text:"Delegar (urgente)",label:" delegate"},delete:{color:"bg-gray-400",text:"Eliminar (sin prioridad)",label:" delete"}},UP=()=>e.jsxs("div",{className:"mt-6 text-sm",children:[e.jsx("h2",{className:"font-medium mb-2",children:"Convenciones de prioridad"}),e.jsx("ul",{className:"space-y-1",children:Object.entries(HP).map(([t,a])=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(wt,{className:`text-xs font-normal px-2 py-0.5 text-white ${a.color}`,children:a.label}),e.jsx("span",{children:a.text})]},t))})]}),VP=({value:t,onChange:a,multiline:s})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(zM,{className:"w-4 h-4"}),"Ttulo"]}),s?e.jsx(sa,{value:t,onChange:r=>a(r.target.value),placeholder:"Una tarea por lnea",className:"min-h-[120px]"}):e.jsx(ye,{value:t,onChange:r=>a(r.target.value),placeholder:"Ttulo de la tarea..."})]}),YP=({textAreaRef:t,value:a,onChange:s})=>{const r=p.useCallback(()=>{const u=t.current;if(!u)return;const{selectionStart:m,selectionEnd:h}=u,g=a.split(`
`);let x=0,y=0;for(let N=0;N<g.length;N++){if(x+g[N].length+1>m){y=N;break}x+=g[N].length+1}if(y===0)return;const v=g[y];g[y]=g[y-1],g[y-1]=v;const b=g.join(`
`);s(b),setTimeout(()=>{const N=g[y-1].length,S=m-x,w=x-N-1+S,E=h-x+w;u.setSelectionRange(Math.max(0,w),Math.max(0,E)),u.focus()},0)},[t,a,s]),l=p.useCallback(()=>{const u=t.current;if(!u)return;const{selectionStart:m,selectionEnd:h}=u,g=a.split(`
`);let x=0,y=0;for(let N=0;N<g.length;N++){if(x+g[N].length+1>m){y=N;break}x+=g[N].length+1}if(y===g.length-1)return;const v=g[y];g[y]=g[y+1],g[y+1]=v;const b=g.join(`
`);s(b),setTimeout(()=>{const N=g[y+1].length,S=m-x,w=x+N+1+S,E=h-x+w;u.setSelectionRange(w,E),u.focus()},0)},[t,a,s]),o=p.useCallback(()=>{const u=t.current;if(!u)return;const{selectionStart:m,selectionEnd:h}=u,g=a.split(`
`);let x=0,y=0;for(let S=0;S<g.length;S++){if(x+g[S].length+1>m){y=S;break}x+=g[S].length+1}const v=g[y];let b=v;if(v.match(/^\s*-\s*\[\s*\]\s*/))b=v.replace(/^\s*-\s*\[\s*\]\s*/,"- [x] ");else if(v.match(/^\s*-\s*\[x\]\s*/i))b=v.replace(/^\s*-\s*\[x\]\s*/i,"- [ ] ");else{const S=v.match(/^\s*/)?.[0]||"",w=v.slice(S.length);b=S+"- [ ] "+w}g[y]=b;const N=g.join(`
`);s(N),setTimeout(()=>{const S=b.length-v.length,w=m+(m>x?S:0),E=h+S;u.setSelectionRange(w,E),u.focus()},0)},[t,a,s]);return{handleKeyDown:p.useCallback(u=>{if(u.altKey&&u.key==="ArrowUp"){u.preventDefault(),r();return}if(u.altKey&&u.key==="ArrowDown"){u.preventDefault(),l();return}if(u.ctrlKey&&u.key==="l"){u.preventDefault(),o();return}},[r,l,o]),moveLineUp:r,moveLineDown:l,toggleCheckboxLine:o}},qP=({value:t,onChange:a})=>{const s=p.useRef(null),{handleKeyDown:r}=YP({textAreaRef:s,value:t,onChange:a});return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(LM,{className:"w-4 h-4"}),"Descripcin de la tarea",e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(Alt+ mover lneas, Ctrl+L toggle checkbox)"})]}),e.jsx(sa,{ref:s,value:t,onChange:l=>a(l.target.value),onKeyDown:r,placeholder:"Agrega ms detalles sobre la tarea...",className:"min-h-[250px] resize-y"})]})},yi=({className:t})=>{const[a,s]=p.useState(0);return p.useEffect(()=>{const r=setInterval(()=>{s(l=>{const o=l+5;return o>=100?(clearInterval(r),100):o})},500);return()=>clearInterval(r)},[]),e.jsxs("div",{className:`flex items-center gap-2 ${t??""}`,children:[e.jsx(Us,{value:a,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-8 text-right",children:[a,"%"]})]})},Zh=Ci("task"),FP=Zh?`https://generativelanguage.googleapis.com/v1beta/models/${Zh.model}:generateContent`:"",GP=({title:t,description:a,onInsert:s})=>{const[r,l]=p.useState(!1),[o,d]=p.useState(""),[u,m]=p.useState(""),[h,g]=p.useState(!1),[x,y]=p.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",b=Zh?.prompts?.breakdown??"Desglosa la siguiente tarea en subtareas concretas y accionables:",N=Zh?.params;p.useEffect(()=>{r&&d(`${b}
Tarea: ${t}
Descripcion: ${a}`)},[r,t,a]),p.useEffect(()=>{y(zr(o))},[o]);const S=async()=>{if(t){g(!0);try{const T=(await(await fetch(`${FP}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:o}]}],...N})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text;m(T||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{g(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsxs(P,{type:"button",variant:"outline",size:"sm",onClick:()=>l(!0),className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"})," Subtareas IA"]}),e.jsx(Mt,{open:r,onOpenChange:l,children:e.jsxs(Tt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0",children:[e.jsx(Rt,{className:"text-xl",children:"Desglose de Tarea con IA"}),e.jsx(Ms,{children:"La IA descompondr tu tarea en subtareas concretas y accionables. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:o,onChange:w=>d(w.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Escribe o modifica el prompt para la IA..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",x]}),x>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:S,disabled:h||!v||x>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[h&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(os,{className:"w-4 h-4"}),h?"Consultando IA...":"Obtener subtareas"]}),h&&e.jsx(yi,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado"}),u&&e.jsxs(P,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(u),ut.success("Texto copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Rr,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx(sa,{readOnly:!0,value:u||(h?"Generando subtareas...":"Las subtareas aparecern aqu despus de generar"),className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0",placeholder:"Las subtareas aparecern aqu..."}),u&&e.jsx("div",{className:"mt-3 flex-shrink-0",children:e.jsx(P,{type:"button",className:"w-full",onClick:()=>{s(u),ut.success("Subtareas insertadas en descripcin"),l(!1),m("")},variant:"default",children:" Insertar en descripcin"})})]})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:" Tip: Describe tu tarea con detalle para obtener mejores subtareas"}),!v]})})]})})]})},Jh=Ci("task"),WP=Jh?`https://generativelanguage.googleapis.com/v1beta/models/${Jh.model}:generateContent`:"",KP=({title:t,description:a,onInsert:s})=>{const[r,l]=p.useState(!1),[o,d]=p.useState(""),[u,m]=p.useState(""),[h,g]=p.useState(!1),[x,y]=p.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",b=Jh?.prompts?.improveDescription??"Mejora la descripcin de la tarea sin cambiar su esencia. Si no hay descripcin, genera una basada en el ttulo (mx. 150 palabras).",N=Jh?.params;p.useEffect(()=>{r&&d(`${b}
Ttulo: ${t}
Descripcin actual: ${a||"N/A"}`)},[r,t,a]),p.useEffect(()=>{y(zr(o))},[o]);const S=async()=>{if(t){g(!0);try{const T=(await(await fetch(`${WP}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:o}]}],...N})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text;m(T||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{g(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsxs(P,{type:"button",variant:"outline",size:"sm",onClick:()=>l(!0),className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"})," Mejorar descripcin"]}),e.jsx(Mt,{open:r,onOpenChange:l,children:e.jsxs(Tt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0",children:[e.jsx(Rt,{className:"text-xl",children:"Mejorar Descripcin con IA"}),e.jsx(Ms,{children:"La IA mejorar la descripcin de tu tarea sin cambiar su esencia. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:o,onChange:w=>d(w.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Escribe o modifica el prompt para la IA..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",x]}),x>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:S,disabled:h||!v||x>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[h&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(os,{className:"w-4 h-4"}),h?"Consultando IA...":"Obtener descripcin"]}),h&&e.jsx(yi,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado"}),u&&e.jsxs(P,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(u),ut.success("Texto copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Rr,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx(sa,{readOnly:!0,value:u||(h?"Generando descripcin mejorada...":"La descripcin mejorada aparecer aqu despus de generar"),className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0",placeholder:"La descripcin mejorada aparecer aqu..."}),u&&e.jsx("div",{className:"mt-3 flex-shrink-0",children:e.jsx(P,{type:"button",className:"w-full",onClick:()=>{s(u),ut.success("Descripcin insertada"),l(!1),m("")},variant:"default",children:" Insertar en descripcin"})})]})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:" Tip: La IA mantendr la esencia de tu tarea mientras mejora la claridad"}),!v]})})]})})]})},ef=Ci("task"),XP=ef?`https://generativelanguage.googleapis.com/v1beta/models/${ef.model}:generateContent`:"",QP=({title:t,description:a,onInsert:s})=>{const[r,l]=p.useState(!1),[o,d]=p.useState(""),[u,m]=p.useState(""),[h,g]=p.useState(!1),[x,y]=p.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",b=ef?.prompts?.ideas??"Sugiere ejemplos o estrategias breves para abordar la tarea. Mximo 150 palabras.",N=ef?.params;p.useEffect(()=>{r&&d(`${b}
Ttulo: ${t}
Descripcin: ${a}`)},[r,t,a]),p.useEffect(()=>{y(zr(o))},[o]);const S=async()=>{if(t){g(!0);try{const T=(await(await fetch(`${XP}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:o}]}],...N})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text;m(T||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{g(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsxs(P,{type:"button",variant:"outline",size:"sm",onClick:()=>l(!0),className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"})," Ideas"]}),e.jsx(Mt,{open:r,onOpenChange:l,children:e.jsxs(Tt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0",children:[e.jsx(Rt,{className:"text-xl",children:"Ideas para la Tarea con IA"}),e.jsx(Ms,{children:"La IA te sugerir ejemplos y estrategias para abordar tu tarea. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:o,onChange:w=>d(w.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Escribe o modifica el prompt para la IA..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",x]}),x>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:S,disabled:h||!v||x>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[h&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(os,{className:"w-4 h-4"}),h?"Consultando IA...":"Obtener ideas"]}),h&&e.jsx(yi,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado"}),u&&e.jsxs(P,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(u),ut.success("Texto copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Rr,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx(sa,{readOnly:!0,value:u||(h?"Generando ideas...":"Las ideas aparecern aqu despus de generar"),className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0",placeholder:"Las ideas aparecern aqu..."}),u&&e.jsx("div",{className:"mt-3 flex-shrink-0",children:e.jsx(P,{type:"button",className:"w-full",onClick:()=>{s(u),ut.success("Ideas insertadas en descripcin"),l(!1),m("")},variant:"default",children:" Insertar en descripcin"})})]})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:" Tip: S especfico sobre el contexto de tu tarea para mejores ideas"}),!v]})})]})})]})},ZP=8,JP=0,eB=({startDate:t,endDate:a,onStartDateChange:s,onEndDateChange:r,showClearButton:l=!1})=>{const o=b=>Ue(b),d=b=>Jt(b,"HH:mm"),u=b=>{if(!b)return{hours:ZP,minutes:JP};const[N,S]=b.split(":").map(Number);return{hours:N,minutes:S}},m=(b,N,S)=>{const[w,E,T]=b.split("-").map(Number),D=new Date;if(D.setFullYear(w,E-1,T),N||!S){const{hours:k,minutes:_}=u(N);D.setHours(k,_,0,0)}else D.setHours(S.getHours(),S.getMinutes(),0,0);return D},h=b=>{if(!b){s(void 0);return}const N=m(b,void 0,t);if(a){const S=xu(t,a,N);r(S)}s(N)},g=b=>{if(!t)return;const N=o(t),S=m(N,b||void 0);if(a){const w=xu(t,a,S);r(w)}s(S)},x=b=>{if(!b){r(void 0);return}const N=m(b,void 0,a);r(N)},y=b=>{if(!a)return;const N=o(a),S=m(N,b||void 0);r(S)},v=b=>{if(!t)return;const N=new Date(t.getTime()+b*60*1e3);r(N)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Aa,{className:"w-4 h-4"}),"Fecha y Hora de Inicio"]}),l&&t&&e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>s(void 0),className:"h-8 px-2",children:e.jsx(Fa,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-[minmax(0,7fr)_minmax(0,3fr)] gap-2",children:[e.jsx(ye,{type:"date",className:"w-full",value:t?o(t):"",onChange:b=>h(b.target.value||void 0)}),e.jsx(ye,{type:"time",step:"60",className:"w-full",value:t?d(t):"",onChange:b=>g(b.target.value),disabled:!t})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Aa,{className:"w-4 h-4"}),"Fecha y Hora de Fin (opcional)"]}),a&&e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>r(void 0),className:"h-8 px-2",children:e.jsx(Fa,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-[minmax(0,7fr)_minmax(0,3fr)] gap-2",children:[e.jsx(ye,{type:"date",className:"w-full",value:a?o(a):"",onChange:b=>x(b.target.value||void 0)}),e.jsx(ye,{type:"time",step:"60",className:"w-full",value:a?d(a):"",onChange:b=>y(b.target.value),disabled:!a})]})]}),t&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600 w-full",children:"Duracion rapida:"}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>v(30),className:"h-7 text-xs",children:"30 min"}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>v(60),className:"h-7 text-xs",children:"1 hora"}),e.jsx(P,{type:"button",variant:"outline",size:"sm",onClick:()=>v(120),className:"h-7 text-xs",children:"2 horas"})]})]})};function tB(t){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",a.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}const qD=te.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Bu=()=>{const t=te.useContext(qD);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};tB(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function aB(){const t=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(t)&&/Mobile/.test(t)||/FxiOS/.test(t))}function sB(){return Qy(/^Mac/)}function nB(){return Qy(/^iPhone/)}function yS(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function rB(){return Qy(/^iPad/)||sB()&&navigator.maxTouchPoints>1}function FD(){return nB()||rB()}function Qy(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const iB=24,lB=typeof window<"u"?p.useLayoutEffect:p.useEffect;function vS(...t){return(...a)=>{for(let s of t)typeof s=="function"&&s(...a)}}const kg=typeof document<"u"&&window.visualViewport;function bS(t){let a=window.getComputedStyle(t);return/(auto|scroll)/.test(a.overflow+a.overflowX+a.overflowY)}function GD(t){for(bS(t)&&(t=t.parentElement);t&&!bS(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const oB=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let uh=0,Ag;function cB(t={}){let{isDisabled:a}=t;lB(()=>{if(!a)return uh++,uh===1&&FD()&&(Ag=dB()),()=>{uh--,uh===0&&Ag?.()}},[a])}function dB(){let t,a=0,s=x=>{t=GD(x.target),!(t===document.documentElement&&t===document.body)&&(a=x.changedTouches[0].pageY)},r=x=>{if(!t||t===document.documentElement||t===document.body){x.preventDefault();return}let y=x.changedTouches[0].pageY,v=t.scrollTop,b=t.scrollHeight-t.clientHeight;b!==0&&((v<=0&&y>a||v>=b&&y<a)&&x.preventDefault(),a=y)},l=x=>{let y=x.target;z0(y)&&y!==document.activeElement&&(x.preventDefault(),y.style.transform="translateY(-2000px)",y.focus(),requestAnimationFrame(()=>{y.style.transform=""}))},o=x=>{let y=x.target;z0(y)&&(y.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{y.style.transform="",kg&&(kg.height<window.innerHeight?requestAnimationFrame(()=>{jS(y)}):kg.addEventListener("resize",()=>jS(y),{once:!0}))}))},d=()=>{window.scrollTo(0,0)},u=window.pageXOffset,m=window.pageYOffset,h=vS(uB(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let g=vS(Yd(document,"touchstart",s,{passive:!1,capture:!0}),Yd(document,"touchmove",r,{passive:!1,capture:!0}),Yd(document,"touchend",l,{passive:!1,capture:!0}),Yd(document,"focus",o,!0),Yd(window,"scroll",d));return()=>{h(),g(),window.scrollTo(u,m)}}function uB(t,a,s){let r=t.style[a];return t.style[a]=s,()=>{t.style[a]=r}}function Yd(t,a,s,r){return t.addEventListener(a,s,r),()=>{t.removeEventListener(a,s,r)}}function jS(t){let a=document.scrollingElement||document.documentElement;for(;t&&t!==a;){let s=GD(t);if(s!==document.documentElement&&s!==document.body&&s!==t){let r=s.getBoundingClientRect().top,l=t.getBoundingClientRect().top,o=t.getBoundingClientRect().bottom;const d=s.getBoundingClientRect().bottom+iB;o>d&&(s.scrollTop+=l-r)}t=s.parentElement}}function z0(t){return t instanceof HTMLInputElement&&!oB.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function mB(t,a){typeof t=="function"?t(a):t!=null&&(t.current=a)}function hB(...t){return a=>t.forEach(s=>mB(s,a))}function WD(...t){return p.useCallback(hB(...t),t)}const KD=new WeakMap;function ls(t,a,s=!1){if(!t||!(t instanceof HTMLElement))return;let r={};Object.entries(a).forEach(([l,o])=>{if(l.startsWith("--")){t.style.setProperty(l,o);return}r[l]=t.style[l],t.style[l]=o}),!s&&KD.set(t,r)}function fB(t,a){if(!t||!(t instanceof HTMLElement))return;let s=KD.get(t);s&&(t.style[a]=s[a])}const es=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function mh(t,a){if(!t)return null;const s=window.getComputedStyle(t),r=s.transform||s.webkitTransform||s.mozTransform;let l=r.match(/^matrix3d\((.+)\)$/);return l?parseFloat(l[1].split(", ")[es(a)?13:12]):(l=r.match(/^matrix\((.+)\)$/),l?parseFloat(l[1].split(", ")[es(a)?5:4]):null)}function pB(t){return 8*(Math.log(t+1)-2)}function _g(t,a){if(!t)return()=>{};const s=t.style.cssText;return Object.assign(t.style,a),()=>{t.style.cssText=s}}function xB(...t){return(...a)=>{for(const s of t)typeof s=="function"&&s(...a)}}const Ra={DURATION:.5,EASE:[.32,.72,0,1]},XD=.4,gB=.25,yB=100,QD=8,ql=16,L0=26,Mg="vaul-dragging";function ZD(t){const a=te.useRef(t);return te.useEffect(()=>{a.current=t}),te.useMemo(()=>(...s)=>a.current==null?void 0:a.current.call(a,...s),[])}function vB({defaultProp:t,onChange:a}){const s=te.useState(t),[r]=s,l=te.useRef(r),o=ZD(a);return te.useEffect(()=>{l.current!==r&&(o(r),l.current=r)},[r,l,o]),s}function JD({prop:t,defaultProp:a,onChange:s=()=>{}}){const[r,l]=vB({defaultProp:a,onChange:s}),o=t!==void 0,d=o?t:r,u=ZD(s),m=te.useCallback(h=>{if(o){const x=typeof h=="function"?h(t):h;x!==t&&u(x)}else l(h)},[o,t,l,u]);return[d,m]}function bB({activeSnapPointProp:t,setActiveSnapPointProp:a,snapPoints:s,drawerRef:r,overlayRef:l,fadeFromIndex:o,onSnapPointChange:d,direction:u="bottom",container:m,snapToSequentialPoint:h}){const[g,x]=JD({prop:t,defaultProp:s?.[0],onChange:a}),[y,v]=te.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);te.useEffect(()=>{function R(){v({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[]);const b=te.useMemo(()=>g===s?.[s.length-1]||null,[s,g]),N=te.useMemo(()=>{var R;return(R=s?.findIndex(L=>L===g))!=null?R:null},[s,g]),S=s&&s.length>0&&(o||o===0)&&!Number.isNaN(o)&&s[o]===g||!s,w=te.useMemo(()=>{const R=m?{width:m.getBoundingClientRect().width,height:m.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var L;return(L=s?.map(U=>{const V=typeof U=="string";let F=0;if(V&&(F=parseInt(U,10)),es(u)){const $=V?F:y?U*R.height:0;return y?u==="bottom"?R.height-$:-R.height+$:$}const G=V?F:y?U*R.width:0;return y?u==="right"?R.width-G:-R.width+G:G}))!=null?L:[]},[s,y,m]),E=te.useMemo(()=>N!==null?w?.[N]:null,[w,N]),T=te.useCallback(R=>{var L;const U=(L=w?.findIndex(V=>V===R))!=null?L:null;d(U),ls(r.current,{transition:`transform ${Ra.DURATION}s cubic-bezier(${Ra.EASE.join(",")})`,transform:es(u)?`translate3d(0, ${R}px, 0)`:`translate3d(${R}px, 0, 0)`}),w&&U!==w.length-1&&o!==void 0&&U!==o&&U<o?ls(l.current,{transition:`opacity ${Ra.DURATION}s cubic-bezier(${Ra.EASE.join(",")})`,opacity:"0"}):ls(l.current,{transition:`opacity ${Ra.DURATION}s cubic-bezier(${Ra.EASE.join(",")})`,opacity:"1"}),x(s?.[Math.max(U,0)])},[r.current,s,w,o,l,x]);te.useEffect(()=>{if(g||t){var R;const L=(R=s?.findIndex(U=>U===t||U===g))!=null?R:-1;w&&L!==-1&&typeof w[L]=="number"&&T(w[L])}},[g,t,s,w,T]);function D({draggedDistance:R,closeDrawer:L,velocity:U,dismissible:V}){if(o===void 0)return;const F=u==="bottom"||u==="right"?(E??0)-R:(E??0)+R,G=N===o-1,$=N===0,z=R>0;if(G&&ls(l.current,{transition:`opacity ${Ra.DURATION}s cubic-bezier(${Ra.EASE.join(",")})`}),!h&&U>2&&!z){V?L():T(w[0]);return}if(!h&&U>2&&z&&w&&s){T(w[s.length-1]);return}const H=w?.reduce((O,Y)=>typeof O!="number"||typeof Y!="number"?O:Math.abs(Y-F)<Math.abs(O-F)?Y:O),I=es(u)?window.innerHeight:window.innerWidth;if(U>XD&&Math.abs(R)<I*.4){const O=z?1:-1;if(O>0&&b&&s){T(w[s.length-1]);return}if($&&O<0&&V&&L(),N===null)return;T(w[N+O]);return}T(H)}function k({draggedDistance:R}){if(E===null)return;const L=u==="bottom"||u==="right"?E-R:E+R;(u==="bottom"||u==="right")&&L<w[w.length-1]||(u==="top"||u==="left")&&L>w[w.length-1]||ls(r.current,{transform:es(u)?`translate3d(0, ${L}px, 0)`:`translate3d(${L}px, 0, 0)`})}function _(R,L){if(!s||typeof N!="number"||!w||o===void 0)return null;const U=N===o-1;if(N>=o&&L)return 0;if(U&&!L)return 1;if(!S&&!U)return null;const F=U?N+1:N-1,G=U?w[F]-w[F-1]:w[F+1]-w[F],$=R/Math.abs(G);return U?1-$:$}return{isLastSnapPoint:b,activeSnapPoint:g,shouldFade:S,getPercentageDragged:_,setActiveSnapPoint:x,activeSnapPointIndex:N,onRelease:D,onDrag:k,snapPointsOffset:w}}const jB=()=>()=>{};function NB(){const{direction:t,isOpen:a,shouldScaleBackground:s,setBackgroundColorOnScale:r,noBodyStyles:l}=Bu(),o=te.useRef(null),d=p.useMemo(()=>document.body.style.backgroundColor,[]);function u(){return(window.innerWidth-L0)/window.innerWidth}te.useEffect(()=>{if(a&&s){o.current&&clearTimeout(o.current);const m=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!m)return;xB(r&&!l?_g(document.body,{background:"black"}):jB,_g(m,{transformOrigin:es(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${Ra.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Ra.EASE.join(",")})`}));const h=_g(m,{borderRadius:`${QD}px`,overflow:"hidden",...es(t)?{transform:`scale(${u()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${u()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{h(),o.current=window.setTimeout(()=>{d?document.body.style.background=d:document.body.style.removeProperty("background")},Ra.DURATION*1e3)}}},[a,s,d])}let qd=null;function wB({isOpen:t,modal:a,nested:s,hasBeenOpened:r,preventScrollRestoration:l,noBodyStyles:o}){const[d,u]=te.useState(()=>typeof window<"u"?window.location.href:""),m=te.useRef(0),h=te.useCallback(()=>{if(yS()&&qd===null&&t&&!o){qd={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:x,innerHeight:y}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-m.current}px`,left:`${-x}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const v=y-window.innerHeight;v&&m.current>=y&&(document.body.style.top=`${-(m.current+v)}px`)}),300)}},[t]),g=te.useCallback(()=>{if(yS()&&qd!==null&&!o){const x=-parseInt(document.body.style.top,10),y=-parseInt(document.body.style.left,10);Object.assign(document.body.style,qd),window.requestAnimationFrame(()=>{if(l&&d!==window.location.href){u(window.location.href);return}window.scrollTo(y,x)}),qd=null}},[d]);return te.useEffect(()=>{function x(){m.current=window.scrollY}return x(),window.addEventListener("scroll",x),()=>{window.removeEventListener("scroll",x)}},[]),te.useEffect(()=>{if(a)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||g()}},[a,g]),te.useEffect(()=>{s||!r||(t?(!window.matchMedia("(display-mode: standalone)").matches&&h(),a||window.setTimeout(()=>{g()},500)):g())},[t,r,d,a,s,h,g]),{restorePositionSetting:g}}function SB({open:t,onOpenChange:a,children:s,onDrag:r,onRelease:l,snapPoints:o,shouldScaleBackground:d=!1,setBackgroundColorOnScale:u=!0,closeThreshold:m=gB,scrollLockTimeout:h=yB,dismissible:g=!0,handleOnly:x=!1,fadeFromIndex:y=o&&o.length-1,activeSnapPoint:v,setActiveSnapPoint:b,fixed:N,modal:S=!0,onClose:w,nested:E,noBodyStyles:T=!1,direction:D="bottom",defaultOpen:k=!1,disablePreventScroll:_=!0,snapToSequentialPoint:R=!1,preventScrollRestoration:L=!1,repositionInputs:U=!0,onAnimationEnd:V,container:F,autoFocus:G=!1}){var $,z;const[H=!1,I]=JD({defaultProp:k,prop:t,onChange:qe=>{a?.(qe),!qe&&!E&&Pe(),setTimeout(()=>{V?.(qe)},Ra.DURATION*1e3),qe&&!S&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),qe||(document.body.style.pointerEvents="auto")}}),[O,Y]=te.useState(!1),[le,re]=te.useState(!1),[Q,q]=te.useState(!1),M=te.useRef(null),W=te.useRef(null),ie=te.useRef(null),ve=te.useRef(null),K=te.useRef(null),oe=te.useRef(!1),_e=te.useRef(null),je=te.useRef(0),Ie=te.useRef(!1),ge=te.useRef(!k),Be=te.useRef(0),ke=te.useRef(null),gt=te.useRef((($=ke.current)==null?void 0:$.getBoundingClientRect().height)||0),Dt=te.useRef(((z=ke.current)==null?void 0:z.getBoundingClientRect().width)||0),kt=te.useRef(0),ja=te.useCallback(qe=>{o&&qe===me.length-1&&(W.current=new Date)},[]),{activeSnapPoint:Wt,activeSnapPointIndex:Vt,setActiveSnapPoint:X,onRelease:se,snapPointsOffset:me,onDrag:Oe,shouldFade:Re,getPercentageDragged:Ee}=bB({snapPoints:o,activeSnapPointProp:v,setActiveSnapPointProp:b,drawerRef:ke,fadeFromIndex:y,overlayRef:M,onSnapPointChange:ja,direction:D,container:F,snapToSequentialPoint:R});cB({isDisabled:!H||le||!S||Q||!O||!U||!_});const{restorePositionSetting:Pe}=wB({isOpen:H,modal:S,nested:E??!1,hasBeenOpened:O,preventScrollRestoration:L,noBodyStyles:T});function Je(){return(window.innerWidth-L0)/window.innerWidth}function rt(qe){var dt,jt;!g&&!o||ke.current&&!ke.current.contains(qe.target)||(gt.current=((dt=ke.current)==null?void 0:dt.getBoundingClientRect().height)||0,Dt.current=((jt=ke.current)==null?void 0:jt.getBoundingClientRect().width)||0,re(!0),ie.current=new Date,FD()&&window.addEventListener("touchend",()=>oe.current=!1,{once:!0}),qe.target.setPointerCapture(qe.pointerId),je.current=es(D)?qe.pageY:qe.pageX)}function Et(qe,dt){var jt;let Xe=qe;const et=(jt=window.getSelection())==null?void 0:jt.toString(),$e=ke.current?mh(ke.current,D):null,Ae=new Date;if(Xe.tagName==="SELECT"||Xe.hasAttribute("data-vaul-no-drag")||Xe.closest("[data-vaul-no-drag]"))return!1;if(D==="right"||D==="left")return!0;if(W.current&&Ae.getTime()-W.current.getTime()<500)return!1;if($e!==null&&(D==="bottom"?$e>0:$e<0))return!0;if(et&&et.length>0)return!1;if(K.current&&Ae.getTime()-K.current.getTime()<h&&$e===0||dt)return K.current=Ae,!1;for(;Xe;){if(Xe.scrollHeight>Xe.clientHeight){if(Xe.scrollTop!==0)return K.current=new Date,!1;if(Xe.getAttribute("role")==="dialog")return!0}Xe=Xe.parentNode}return!0}function Kt(qe){if(ke.current&&le){const dt=D==="bottom"||D==="right"?1:-1,jt=(je.current-(es(D)?qe.pageY:qe.pageX))*dt,Xe=jt>0,et=o&&!g&&!Xe;if(et&&Vt===0)return;const $e=Math.abs(jt),Ae=document.querySelector("[data-vaul-drawer-wrapper]"),Fe=D==="bottom"||D==="top"?gt.current:Dt.current;let lt=$e/Fe;const Xt=Ee($e,Xe);if(Xt!==null&&(lt=Xt),et&&lt>=1||!oe.current&&!Et(qe.target,Xe))return;if(ke.current.classList.add(Mg),oe.current=!0,ls(ke.current,{transition:"none"}),ls(M.current,{transition:"none"}),o&&Oe({draggedDistance:jt}),Xe&&!o){const ct=pB(jt),pa=Math.min(ct*-1,0)*dt;ls(ke.current,{transform:es(D)?`translate3d(0, ${pa}px, 0)`:`translate3d(${pa}px, 0, 0)`});return}const ht=1-lt;if((Re||y&&Vt===y-1)&&(r?.(qe,lt),ls(M.current,{opacity:`${ht}`,transition:"none"},!0)),Ae&&M.current&&d){const ct=Math.min(Je()+lt*(1-Je()),1),pa=8-lt*8,qt=Math.max(0,14-lt*14);ls(Ae,{borderRadius:`${pa}px`,transform:es(D)?`scale(${ct}) translate3d(0, ${qt}px, 0)`:`scale(${ct}) translate3d(${qt}px, 0, 0)`,transition:"none"},!0)}if(!o){const ct=$e*dt;ls(ke.current,{transform:es(D)?`translate3d(0, ${ct}px, 0)`:`translate3d(${ct}px, 0, 0)`})}}}te.useEffect(()=>{window.requestAnimationFrame(()=>{ge.current=!0})},[]),te.useEffect(()=>{var qe;function dt(){if(!ke.current||!U)return;const jt=document.activeElement;if(z0(jt)||Ie.current){var Xe;const et=((Xe=window.visualViewport)==null?void 0:Xe.height)||0,$e=window.innerHeight;let Ae=$e-et;const Fe=ke.current.getBoundingClientRect().height||0,lt=Fe>$e*.8;kt.current||(kt.current=Fe);const Xt=ke.current.getBoundingClientRect().top;if(Math.abs(Be.current-Ae)>60&&(Ie.current=!Ie.current),o&&o.length>0&&me&&Vt){const ht=me[Vt]||0;Ae+=ht}if(Be.current=Ae,Fe>et||Ie.current){const ht=ke.current.getBoundingClientRect().height;let ct=ht;ht>et&&(ct=et-(lt?Xt:L0)),N?ke.current.style.height=`${ht-Math.max(Ae,0)}px`:ke.current.style.height=`${Math.max(ct,et-Xt)}px`}else aB()||(ke.current.style.height=`${kt.current}px`);o&&o.length>0&&!Ie.current?ke.current.style.bottom="0px":ke.current.style.bottom=`${Math.max(Ae,0)}px`}}return(qe=window.visualViewport)==null||qe.addEventListener("resize",dt),()=>{var jt;return(jt=window.visualViewport)==null?void 0:jt.removeEventListener("resize",dt)}},[Vt,o,me]);function Ne(qe){nt(),w?.(),qe||I(!1),setTimeout(()=>{o&&X(o[0])},Ra.DURATION*1e3)}function Ve(){if(!ke.current)return;const qe=document.querySelector("[data-vaul-drawer-wrapper]"),dt=mh(ke.current,D);ls(ke.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${Ra.DURATION}s cubic-bezier(${Ra.EASE.join(",")})`}),ls(M.current,{transition:`opacity ${Ra.DURATION}s cubic-bezier(${Ra.EASE.join(",")})`,opacity:"1"}),d&&dt&&dt>0&&H&&ls(qe,{borderRadius:`${QD}px`,overflow:"hidden",...es(D)?{transform:`scale(${Je()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${Je()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${Ra.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Ra.EASE.join(",")})`},!0)}function nt(){!le||!ke.current||(ke.current.classList.remove(Mg),oe.current=!1,re(!1),ve.current=new Date)}function bt(qe){if(!le||!ke.current)return;ke.current.classList.remove(Mg),oe.current=!1,re(!1),ve.current=new Date;const dt=mh(ke.current,D);if(!qe||!Et(qe.target,!1)||!dt||Number.isNaN(dt)||ie.current===null)return;const jt=ve.current.getTime()-ie.current.getTime(),Xe=je.current-(es(D)?qe.pageY:qe.pageX),et=Math.abs(Xe)/jt;if(et>.05&&(q(!0),setTimeout(()=>{q(!1)},200)),o){se({draggedDistance:Xe*(D==="bottom"||D==="right"?1:-1),closeDrawer:Ne,velocity:et,dismissible:g}),l?.(qe,!0);return}if(D==="bottom"||D==="right"?Xe>0:Xe<0){Ve(),l?.(qe,!0);return}if(et>XD){Ne(),l?.(qe,!1);return}var $e;const Ae=Math.min(($e=ke.current.getBoundingClientRect().height)!=null?$e:0,window.innerHeight);var Fe;const lt=Math.min((Fe=ke.current.getBoundingClientRect().width)!=null?Fe:0,window.innerWidth),Xt=D==="left"||D==="right";if(Math.abs(dt)>=(Xt?lt:Ae)*m){Ne(),l?.(qe,!1);return}l?.(qe,!0),Ve()}te.useEffect(()=>(H&&(ls(document.documentElement,{scrollBehavior:"auto"}),W.current=new Date),()=>{fB(document.documentElement,"scrollBehavior")}),[H]);function Pt(qe){const dt=qe?(window.innerWidth-ql)/window.innerWidth:1,jt=qe?-ql:0;_e.current&&window.clearTimeout(_e.current),ls(ke.current,{transition:`transform ${Ra.DURATION}s cubic-bezier(${Ra.EASE.join(",")})`,transform:es(D)?`scale(${dt}) translate3d(0, ${jt}px, 0)`:`scale(${dt}) translate3d(${jt}px, 0, 0)`}),!qe&&ke.current&&(_e.current=setTimeout(()=>{const Xe=mh(ke.current,D);ls(ke.current,{transition:"none",transform:es(D)?`translate3d(0, ${Xe}px, 0)`:`translate3d(${Xe}px, 0, 0)`})},500))}function _a(qe,dt){if(dt<0)return;const jt=(window.innerWidth-ql)/window.innerWidth,Xe=jt+dt*(1-jt),et=-ql+dt*ql;ls(ke.current,{transform:es(D)?`scale(${Xe}) translate3d(0, ${et}px, 0)`:`scale(${Xe}) translate3d(${et}px, 0, 0)`,transition:"none"})}function Ma(qe,dt){const jt=es(D)?window.innerHeight:window.innerWidth,Xe=dt?(jt-ql)/jt:1,et=dt?-ql:0;dt&&ls(ke.current,{transition:`transform ${Ra.DURATION}s cubic-bezier(${Ra.EASE.join(",")})`,transform:es(D)?`scale(${Xe}) translate3d(0, ${et}px, 0)`:`scale(${Xe}) translate3d(${et}px, 0, 0)`})}return te.useEffect(()=>{S||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[S]),te.createElement(pf,{defaultOpen:k,onOpenChange:qe=>{!g&&!qe||(qe?Y(!0):Ne(!0),I(qe))},open:H},te.createElement(qD.Provider,{value:{activeSnapPoint:Wt,snapPoints:o,setActiveSnapPoint:X,drawerRef:ke,overlayRef:M,onOpenChange:a,onPress:rt,onRelease:bt,onDrag:Kt,dismissible:g,shouldAnimate:ge,handleOnly:x,isOpen:H,isDragging:le,shouldFade:Re,closeDrawer:Ne,onNestedDrag:_a,onNestedOpenChange:Pt,onNestedRelease:Ma,keyboardIsOpen:Ie,modal:S,snapPointsOffset:me,activeSnapPointIndex:Vt,direction:D,shouldScaleBackground:d,setBackgroundColorOnScale:u,noBodyStyles:T,container:F,autoFocus:G}},s))}const e2=te.forwardRef(function({...t},a){const{overlayRef:s,snapPoints:r,onRelease:l,shouldFade:o,isOpen:d,modal:u,shouldAnimate:m}=Bu(),h=WD(a,s),g=r&&r.length>0;if(!u)return null;const x=te.useCallback(y=>l(y),[l]);return te.createElement(Sc,{onMouseUp:x,ref:h,"data-vaul-overlay":"","data-vaul-snap-points":d&&g?"true":"false","data-vaul-snap-points-overlay":d&&o?"true":"false","data-vaul-animate":m?.current?"true":"false",...t})});e2.displayName="Drawer.Overlay";const t2=te.forwardRef(function({onPointerDownOutside:t,style:a,onOpenAutoFocus:s,...r},l){const{drawerRef:o,onPress:d,onRelease:u,onDrag:m,keyboardIsOpen:h,snapPointsOffset:g,activeSnapPointIndex:x,modal:y,isOpen:v,direction:b,snapPoints:N,container:S,handleOnly:w,shouldAnimate:E,autoFocus:T}=Bu(),[D,k]=te.useState(!1),_=WD(l,o),R=te.useRef(null),L=te.useRef(null),U=te.useRef(!1),V=N&&N.length>0;NB();const F=($,z,H=0)=>{if(U.current)return!0;const I=Math.abs($.y),O=Math.abs($.x),Y=O>I,le=["bottom","right"].includes(z)?1:-1;if(z==="left"||z==="right"){if(!($.x*le<0)&&O>=0&&O<=H)return Y}else if(!($.y*le<0)&&I>=0&&I<=H)return!Y;return U.current=!0,!0};te.useEffect(()=>{V&&window.requestAnimationFrame(()=>{k(!0)})},[]);function G($){R.current=null,U.current=!1,u($)}return te.createElement(Cc,{"data-vaul-drawer-direction":b,"data-vaul-drawer":"","data-vaul-delayed-snap-points":D?"true":"false","data-vaul-snap-points":v&&V?"true":"false","data-vaul-custom-container":S?"true":"false","data-vaul-animate":E?.current?"true":"false",...r,ref:_,style:g&&g.length>0?{"--snap-point-height":`${g[x??0]}px`,...a}:a,onPointerDown:$=>{w||(r.onPointerDown==null||r.onPointerDown.call(r,$),R.current={x:$.pageX,y:$.pageY},d($))},onOpenAutoFocus:$=>{s?.($),T||$.preventDefault()},onPointerDownOutside:$=>{if(t?.($),!y||$.defaultPrevented){$.preventDefault();return}h.current&&(h.current=!1)},onFocusOutside:$=>{if(!y){$.preventDefault();return}},onPointerMove:$=>{if(L.current=$,w||(r.onPointerMove==null||r.onPointerMove.call(r,$),!R.current))return;const z=$.pageY-R.current.y,H=$.pageX-R.current.x,I=$.pointerType==="touch"?10:2;F({x:H,y:z},b,I)?m($):(Math.abs(H)>I||Math.abs(z)>I)&&(R.current=null)},onPointerUp:$=>{r.onPointerUp==null||r.onPointerUp.call(r,$),R.current=null,U.current=!1,u($)},onPointerOut:$=>{r.onPointerOut==null||r.onPointerOut.call(r,$),G(L.current)},onContextMenu:$=>{r.onContextMenu==null||r.onContextMenu.call(r,$),L.current&&G(L.current)}})});t2.displayName="Drawer.Content";const CB=250,EB=120,TB=te.forwardRef(function({preventCycle:t=!1,children:a,...s},r){const{closeDrawer:l,isDragging:o,snapPoints:d,activeSnapPoint:u,setActiveSnapPoint:m,dismissible:h,handleOnly:g,isOpen:x,onPress:y,onDrag:v}=Bu(),b=te.useRef(null),N=te.useRef(!1);function S(){if(N.current){T();return}window.setTimeout(()=>{w()},EB)}function w(){if(o||t||N.current){T();return}if(T(),!d||d.length===0){h||l();return}if(u===d[d.length-1]&&h){l();return}const k=d.findIndex(R=>R===u);if(k===-1)return;const _=d[k+1];m(_)}function E(){b.current=window.setTimeout(()=>{N.current=!0},CB)}function T(){b.current&&window.clearTimeout(b.current),N.current=!1}return te.createElement("div",{onClick:S,onPointerCancel:T,onPointerDown:D=>{g&&y(D),E()},onPointerMove:D=>{g&&v(D)},ref:r,"data-vaul-drawer-visible":x?"true":"false","data-vaul-handle":"","aria-hidden":"true",...s},te.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},a))});TB.displayName="Drawer.Handle";function DB(t){const a=Bu(),{container:s=a.container,...r}=t;return te.createElement(ff,{container:s,...r})}const gr={Root:SB,Content:t2,Overlay:e2,Trigger:xf,Portal:DB,Close:Nu,Title:Ec,Description:Tc},a2=({shouldScaleBackground:t=!0,...a})=>e.jsx(gr.Root,{shouldScaleBackground:t,...a});a2.displayName="Drawer";const kB=gr.Trigger,AB=gr.Portal,_B=gr.Close,s2=p.forwardRef(({className:t,...a},s)=>e.jsx(gr.Overlay,{ref:s,className:he("fixed inset-0 z-50 bg-black/80",t),...a}));s2.displayName=gr.Overlay.displayName;const n2=p.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(AB,{children:[e.jsx(s2,{}),e.jsxs(gr.Content,{ref:r,className:he("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",t),...s,children:[e.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),a]})]}));n2.displayName="DrawerContent";const r2=({className:t,...a})=>e.jsx("div",{className:he("grid gap-1.5 p-4 text-center sm:text-left",t),...a});r2.displayName="DrawerHeader";const i2=({className:t,...a})=>e.jsx("div",{className:he("mt-auto flex flex-col gap-2 p-4",t),...a});i2.displayName="DrawerFooter";const l2=p.forwardRef(({className:t,...a},s)=>e.jsx(gr.Title,{ref:s,className:he("text-lg font-semibold leading-none tracking-tight",t),...a}));l2.displayName=gr.Title.displayName;const o2=p.forwardRef(({className:t,...a},s)=>e.jsx(gr.Description,{ref:s,className:he("text-sm text-muted-foreground",t),...a}));o2.displayName=gr.Description.displayName;function MB(t=768){const[a,s]=p.useState(!1);return p.useEffect(()=>{const r=()=>{const l=window.innerWidth<t,o="ontouchstart"in window||navigator.maxTouchPoints>0,d=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);s(l||o&&d)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[t]),a}function OB(t,a){return p.useReducer((s,r)=>a[s][r]??s,t)}var Zy="ScrollArea",[c2,R7]=vi(Zy),[RB,Fn]=c2(Zy),d2=p.forwardRef((t,a)=>{const{__scopeScrollArea:s,type:r="hover",dir:l,scrollHideDelay:o=600,...d}=t,[u,m]=p.useState(null),[h,g]=p.useState(null),[x,y]=p.useState(null),[v,b]=p.useState(null),[N,S]=p.useState(null),[w,E]=p.useState(0),[T,D]=p.useState(0),[k,_]=p.useState(!1),[R,L]=p.useState(!1),U=Sa(a,F=>m(F)),V=gf(l);return e.jsx(RB,{scope:s,type:r,dir:V,scrollHideDelay:o,scrollArea:u,viewport:h,onViewportChange:g,content:x,onContentChange:y,scrollbarX:v,onScrollbarXChange:b,scrollbarXEnabled:k,onScrollbarXEnabledChange:_,scrollbarY:N,onScrollbarYChange:S,scrollbarYEnabled:R,onScrollbarYEnabledChange:L,onCornerWidthChange:E,onCornerHeightChange:D,children:e.jsx(Gt.div,{dir:V,...d,ref:U,style:{position:"relative","--radix-scroll-area-corner-width":w+"px","--radix-scroll-area-corner-height":T+"px",...t.style}})})});d2.displayName=Zy;var u2="ScrollAreaViewport",m2=p.forwardRef((t,a)=>{const{__scopeScrollArea:s,children:r,nonce:l,...o}=t,d=Fn(u2,s),u=p.useRef(null),m=Sa(a,u,d.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),e.jsx(Gt.div,{"data-radix-scroll-area-viewport":"",...o,ref:m,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...t.style},children:e.jsx("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});m2.displayName=u2;var Lr="ScrollAreaScrollbar",Jy=p.forwardRef((t,a)=>{const{forceMount:s,...r}=t,l=Fn(Lr,t.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:d}=l,u=t.orientation==="horizontal";return p.useEffect(()=>(u?o(!0):d(!0),()=>{u?o(!1):d(!1)}),[u,o,d]),l.type==="hover"?e.jsx(IB,{...r,ref:a,forceMount:s}):l.type==="scroll"?e.jsx(zB,{...r,ref:a,forceMount:s}):l.type==="auto"?e.jsx(h2,{...r,ref:a,forceMount:s}):l.type==="always"?e.jsx(ev,{...r,ref:a}):null});Jy.displayName=Lr;var IB=p.forwardRef((t,a)=>{const{forceMount:s,...r}=t,l=Fn(Lr,t.__scopeScrollArea),[o,d]=p.useState(!1);return p.useEffect(()=>{const u=l.scrollArea;let m=0;if(u){const h=()=>{window.clearTimeout(m),d(!0)},g=()=>{m=window.setTimeout(()=>d(!1),l.scrollHideDelay)};return u.addEventListener("pointerenter",h),u.addEventListener("pointerleave",g),()=>{window.clearTimeout(m),u.removeEventListener("pointerenter",h),u.removeEventListener("pointerleave",g)}}},[l.scrollArea,l.scrollHideDelay]),e.jsx(bi,{present:s||o,children:e.jsx(h2,{"data-state":o?"visible":"hidden",...r,ref:a})})}),zB=p.forwardRef((t,a)=>{const{forceMount:s,...r}=t,l=Fn(Lr,t.__scopeScrollArea),o=t.orientation==="horizontal",d=Gf(()=>m("SCROLL_END"),100),[u,m]=OB("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(u==="idle"){const h=window.setTimeout(()=>m("HIDE"),l.scrollHideDelay);return()=>window.clearTimeout(h)}},[u,l.scrollHideDelay,m]),p.useEffect(()=>{const h=l.viewport,g=o?"scrollLeft":"scrollTop";if(h){let x=h[g];const y=()=>{const v=h[g];x!==v&&(m("SCROLL"),d()),x=v};return h.addEventListener("scroll",y),()=>h.removeEventListener("scroll",y)}},[l.viewport,o,m,d]),e.jsx(bi,{present:s||u!=="hidden",children:e.jsx(ev,{"data-state":u==="hidden"?"hidden":"visible",...r,ref:a,onPointerEnter:Nt(t.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:Nt(t.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),h2=p.forwardRef((t,a)=>{const s=Fn(Lr,t.__scopeScrollArea),{forceMount:r,...l}=t,[o,d]=p.useState(!1),u=t.orientation==="horizontal",m=Gf(()=>{if(s.viewport){const h=s.viewport.offsetWidth<s.viewport.scrollWidth,g=s.viewport.offsetHeight<s.viewport.scrollHeight;d(u?h:g)}},10);return vc(s.viewport,m),vc(s.content,m),e.jsx(bi,{present:r||o,children:e.jsx(ev,{"data-state":o?"visible":"hidden",...l,ref:a})})}),ev=p.forwardRef((t,a)=>{const{orientation:s="vertical",...r}=t,l=Fn(Lr,t.__scopeScrollArea),o=p.useRef(null),d=p.useRef(0),[u,m]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=y2(u.viewport,u.content),g={...r,sizes:u,onSizesChange:m,hasThumb:h>0&&h<1,onThumbChange:y=>o.current=y,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:y=>d.current=y};function x(y,v){return UB(y,d.current,u,v)}return s==="horizontal"?e.jsx(LB,{...g,ref:a,onThumbPositionChange:()=>{if(l.viewport&&o.current){const y=l.viewport.scrollLeft,v=NS(y,u,l.dir);o.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:y=>{l.viewport&&(l.viewport.scrollLeft=y)},onDragScroll:y=>{l.viewport&&(l.viewport.scrollLeft=x(y,l.dir))}}):s==="vertical"?e.jsx(PB,{...g,ref:a,onThumbPositionChange:()=>{if(l.viewport&&o.current){const y=l.viewport.scrollTop,v=NS(y,u);o.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:y=>{l.viewport&&(l.viewport.scrollTop=y)},onDragScroll:y=>{l.viewport&&(l.viewport.scrollTop=x(y))}}):null}),LB=p.forwardRef((t,a)=>{const{sizes:s,onSizesChange:r,...l}=t,o=Fn(Lr,t.__scopeScrollArea),[d,u]=p.useState(),m=p.useRef(null),h=Sa(a,m,o.onScrollbarXChange);return p.useEffect(()=>{m.current&&u(getComputedStyle(m.current))},[m]),e.jsx(p2,{"data-orientation":"horizontal",...l,ref:h,sizes:s,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Ff(s)+"px",...t.style},onThumbPointerDown:g=>t.onThumbPointerDown(g.x),onDragScroll:g=>t.onDragScroll(g.x),onWheelScroll:(g,x)=>{if(o.viewport){const y=o.viewport.scrollLeft+g.deltaX;t.onWheelScroll(y),b2(y,x)&&g.preventDefault()}},onResize:()=>{m.current&&o.viewport&&d&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:m.current.clientWidth,paddingStart:af(d.paddingLeft),paddingEnd:af(d.paddingRight)}})}})}),PB=p.forwardRef((t,a)=>{const{sizes:s,onSizesChange:r,...l}=t,o=Fn(Lr,t.__scopeScrollArea),[d,u]=p.useState(),m=p.useRef(null),h=Sa(a,m,o.onScrollbarYChange);return p.useEffect(()=>{m.current&&u(getComputedStyle(m.current))},[m]),e.jsx(p2,{"data-orientation":"vertical",...l,ref:h,sizes:s,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Ff(s)+"px",...t.style},onThumbPointerDown:g=>t.onThumbPointerDown(g.y),onDragScroll:g=>t.onDragScroll(g.y),onWheelScroll:(g,x)=>{if(o.viewport){const y=o.viewport.scrollTop+g.deltaY;t.onWheelScroll(y),b2(y,x)&&g.preventDefault()}},onResize:()=>{m.current&&o.viewport&&d&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:m.current.clientHeight,paddingStart:af(d.paddingTop),paddingEnd:af(d.paddingBottom)}})}})}),[BB,f2]=c2(Lr),p2=p.forwardRef((t,a)=>{const{__scopeScrollArea:s,sizes:r,hasThumb:l,onThumbChange:o,onThumbPointerUp:d,onThumbPointerDown:u,onThumbPositionChange:m,onDragScroll:h,onWheelScroll:g,onResize:x,...y}=t,v=Fn(Lr,s),[b,N]=p.useState(null),S=Sa(a,U=>N(U)),w=p.useRef(null),E=p.useRef(""),T=v.viewport,D=r.content-r.viewport,k=nl(g),_=nl(m),R=Gf(x,10);function L(U){if(w.current){const V=U.clientX-w.current.left,F=U.clientY-w.current.top;h({x:V,y:F})}}return p.useEffect(()=>{const U=V=>{const F=V.target;b?.contains(F)&&k(V,D)};return document.addEventListener("wheel",U,{passive:!1}),()=>document.removeEventListener("wheel",U,{passive:!1})},[T,b,D,k]),p.useEffect(_,[r,_]),vc(b,R),vc(v.content,R),e.jsx(BB,{scope:s,scrollbar:b,hasThumb:l,onThumbChange:nl(o),onThumbPointerUp:nl(d),onThumbPositionChange:_,onThumbPointerDown:nl(u),children:e.jsx(Gt.div,{...y,ref:S,style:{position:"absolute",...y.style},onPointerDown:Nt(t.onPointerDown,U=>{U.button===0&&(U.target.setPointerCapture(U.pointerId),w.current=b.getBoundingClientRect(),E.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),L(U))}),onPointerMove:Nt(t.onPointerMove,L),onPointerUp:Nt(t.onPointerUp,U=>{const V=U.target;V.hasPointerCapture(U.pointerId)&&V.releasePointerCapture(U.pointerId),document.body.style.webkitUserSelect=E.current,v.viewport&&(v.viewport.style.scrollBehavior=""),w.current=null})})})}),tf="ScrollAreaThumb",x2=p.forwardRef((t,a)=>{const{forceMount:s,...r}=t,l=f2(tf,t.__scopeScrollArea);return e.jsx(bi,{present:s||l.hasThumb,children:e.jsx($B,{ref:a,...r})})}),$B=p.forwardRef((t,a)=>{const{__scopeScrollArea:s,style:r,...l}=t,o=Fn(tf,s),d=f2(tf,s),{onThumbPositionChange:u}=d,m=Sa(a,x=>d.onThumbChange(x)),h=p.useRef(void 0),g=Gf(()=>{h.current&&(h.current(),h.current=void 0)},100);return p.useEffect(()=>{const x=o.viewport;if(x){const y=()=>{if(g(),!h.current){const v=VB(x,u);h.current=v,u()}};return u(),x.addEventListener("scroll",y),()=>x.removeEventListener("scroll",y)}},[o.viewport,g,u]),e.jsx(Gt.div,{"data-state":d.hasThumb?"visible":"hidden",...l,ref:m,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Nt(t.onPointerDownCapture,x=>{const v=x.target.getBoundingClientRect(),b=x.clientX-v.left,N=x.clientY-v.top;d.onThumbPointerDown({x:b,y:N})}),onPointerUp:Nt(t.onPointerUp,d.onThumbPointerUp)})});x2.displayName=tf;var tv="ScrollAreaCorner",g2=p.forwardRef((t,a)=>{const s=Fn(tv,t.__scopeScrollArea),r=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&r?e.jsx(HB,{...t,ref:a}):null});g2.displayName=tv;var HB=p.forwardRef((t,a)=>{const{__scopeScrollArea:s,...r}=t,l=Fn(tv,s),[o,d]=p.useState(0),[u,m]=p.useState(0),h=!!(o&&u);return vc(l.scrollbarX,()=>{const g=l.scrollbarX?.offsetHeight||0;l.onCornerHeightChange(g),m(g)}),vc(l.scrollbarY,()=>{const g=l.scrollbarY?.offsetWidth||0;l.onCornerWidthChange(g),d(g)}),h?e.jsx(Gt.div,{...r,ref:a,style:{width:o,height:u,position:"absolute",right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function af(t){return t?parseInt(t,10):0}function y2(t,a){const s=t/a;return isNaN(s)?0:s}function Ff(t){const a=y2(t.viewport,t.content),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-s)*a;return Math.max(r,18)}function UB(t,a,s,r="ltr"){const l=Ff(s),o=l/2,d=a||o,u=l-d,m=s.scrollbar.paddingStart+d,h=s.scrollbar.size-s.scrollbar.paddingEnd-u,g=s.content-s.viewport,x=r==="ltr"?[0,g]:[g*-1,0];return v2([m,h],x)(t)}function NS(t,a,s="ltr"){const r=Ff(a),l=a.scrollbar.paddingStart+a.scrollbar.paddingEnd,o=a.scrollbar.size-l,d=a.content-a.viewport,u=o-r,m=s==="ltr"?[0,d]:[d*-1,0],h=y0(t,m);return v2([0,d],[0,u])(h)}function v2(t,a){return s=>{if(t[0]===t[1]||a[0]===a[1])return a[0];const r=(a[1]-a[0])/(t[1]-t[0]);return a[0]+r*(s-t[0])}}function b2(t,a){return t>0&&t<a}var VB=(t,a=()=>{})=>{let s={left:t.scrollLeft,top:t.scrollTop},r=0;return(function l(){const o={left:t.scrollLeft,top:t.scrollTop},d=s.left!==o.left,u=s.top!==o.top;(d||u)&&a(),s=o,r=window.requestAnimationFrame(l)})(),()=>window.cancelAnimationFrame(r)};function Gf(t,a){const s=nl(t),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(s,a)},[s,a])}function vc(t,a){const s=nl(a);fi(()=>{let r=0;if(t){const l=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(s)});return l.observe(t),()=>{window.cancelAnimationFrame(r),l.unobserve(t)}}},[t,s])}var j2=d2,YB=m2,qB=g2;const Wf=p.forwardRef(({className:t,children:a,...s},r)=>e.jsxs(j2,{ref:r,className:he("relative overflow-hidden",t),...s,children:[e.jsx(YB,{className:"h-full w-full rounded-[inherit]",children:a}),e.jsx(N2,{}),e.jsx(qB,{})]}));Wf.displayName=j2.displayName;const N2=p.forwardRef(({className:t,orientation:a="vertical",...s},r)=>e.jsx(Jy,{ref:r,orientation:a,className:he("flex touch-none select-none transition-colors",a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:e.jsx(x2,{className:"relative flex-1 rounded-full bg-border"})}));N2.displayName=Jy.displayName;function FB({value:t,onChange:a,options:s,placeholder:r="Seleccionar opcin",disabled:l=!1,className:o,label:d,description:u}){const m=MB(),[h,g]=p.useState(!1),[x,y]=p.useState(t);p.useEffect(()=>{y(t)},[t]);const v=S=>{y(S),a?.(S),g(!1)},N=s.find(S=>S.value===x)?.label||r;return m?e.jsxs(a2,{open:h,onOpenChange:g,children:[e.jsx(kB,{asChild:!0,children:e.jsxs(P,{variant:"outline",disabled:l,className:he("w-full justify-between text-left font-normal h-11",!x&&"text-muted-foreground",o),children:[e.jsx("span",{className:"truncate",children:N}),e.jsx(rn,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsxs(n2,{className:"max-h-[80vh]",children:[e.jsxs(r2,{className:"text-left",children:[e.jsx(l2,{children:d||"Seleccionar opcin"}),u&&e.jsx(o2,{children:u})]}),e.jsx(Wf,{className:"px-4 max-h-[60vh]",children:e.jsx("div",{className:"space-y-1 pb-4",children:s.map(S=>e.jsxs("button",{disabled:S.disabled,onClick:()=>!S.disabled&&v(S.value),className:he("flex w-full items-center rounded-lg px-4 py-3 text-left transition-colors","hover:bg-accent hover:text-accent-foreground","focus:bg-accent focus:text-accent-foreground focus:outline-none","disabled:pointer-events-none disabled:opacity-50","active:scale-[0.98] transition-transform",x===S.value&&"bg-accent font-medium"),children:[e.jsx("span",{className:"flex-1",children:S.label}),x===S.value&&e.jsx(cr,{className:"ml-2 h-5 w-5 shrink-0 text-primary"})]},S.value))})}),e.jsx(i2,{className:"pt-2",children:e.jsx(_B,{asChild:!0,children:e.jsx(P,{variant:"outline",children:"Cancelar"})})})]})]}):e.jsxs(yt,{value:x,onValueChange:v,disabled:l,children:[e.jsx(ft,{className:he("w-full",o),children:e.jsx(vt,{placeholder:r})}),e.jsx(pt,{children:s.map(S=>e.jsx(Le,{value:S.value,disabled:S.disabled,children:S.label},S.value))})]})}const GB=({value:t,onChange:a})=>{const r=Object.values(ml).map(l=>({value:l,label:Ya[l]}));return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pc,{className:"w-4 h-4"}),"Categora"]}),e.jsx(FB,{value:t,onChange:l=>a(l),options:r,placeholder:"Selecciona una categora",label:"Categora",description:"Clasifica tu tarea segn su tipo"})]})},w2=({initialDate:t,initialConfig:a}={})=>{const[s,r]=p.useState(t||new Date),[l,o]=p.useState(a),d=(h,g)=>g?A5(h,g.pattern,g.customDays):h;return{date:s,setDate:r,config:l,setConfig:o,calculateNextDate:d,getRecurrenceText:(h,g)=>g?wE(h,g.pattern,g.customDays):"",updateRecurrenceConfig:(h,g)=>{const x={pattern:h,frequency:1,...h==="custom"&&{customDays:g||1}};o(x),r(d(new Date,x))},formatDateForInput:_5}},WB=({isRecurrent:t,onRecurrentChange:a,config:s,onConfigChange:r})=>{const{getRecurrenceText:l}=w2({initialConfig:s}),o=d=>{const u={...s||{},frequency:1,pattern:d,...d==="custom"&&{customDays:s?.customDays||1}};r(u)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Va,{id:"isRecurrent",checked:t,onCheckedChange:d=>{a(d)}}),e.jsx("label",{htmlFor:"isRecurrent",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tarea recurrente"})]}),t&&s&&e.jsxs("div",{className:"pl-6 space-y-4",children:[e.jsxs(yt,{value:s.pattern,onValueChange:d=>o(d),children:[e.jsx(ft,{className:"w-full",children:e.jsx(vt,{placeholder:"Selecciona frecuencia"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"daily",children:"Diariamente"}),e.jsx(Le,{value:"weekly",children:"Semanalmente"}),e.jsx(Le,{value:"monthly",children:"Mensualmente"}),e.jsx(Le,{value:"custom",children:"Personalizado"})]})]}),s.pattern==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{type:"number",min:"1",value:s.customDays,onChange:d=>{const u=parseInt(d.target.value);u>0&&r({...s,customDays:u})},className:"w-24"}),e.jsx("span",{className:"text-sm text-gray-500",children:"das"})]}),s&&e.jsx("div",{className:"text-sm text-blue-600",children:l(new Date,s)})]})]})},Og=t=>{const a=Math.max(0,Math.floor(t??0)),s=Math.floor(a/3600),r=Math.floor(a%3600/60),l=a%60,o=d=>d.toString().padStart(2,"0");return`${o(s)}:${o(r)}:${o(l)}`},KB=t=>{const s=t.trim().match(/^(\d+):([0-5]\d):([0-5]\d)$/);if(!s)return null;const r=Number(s[1]),l=Number(s[2]),o=Number(s[3]);return Number.isNaN(r)||Number.isNaN(l)||Number.isNaN(o)?null:r*3600+l*60+o},S2=({isOpen:t,onClose:a,onConfirm:s,task:r,mode:l})=>{const{calculateNextDate:o}=w2({initialConfig:r.recurrence,initialDate:r.startDate}),[d,u]=p.useState(()=>l==="create"?{title:"",description:"",category:"personal",isRecurrent:!1,isPrivate:r.isPrivate||!1,priority:"delete",size:"pequea",estimatedTime:void 0,timeOfDay:void 0}:{title:r.title||"",description:r.description||"",startDate:l==="complete"?o(new Date,r.recurrence):r.startDate||void 0,endDate:r.endDate||void 0,isRecurrent:r.isRecurrent??!1,isPrivate:r.isPrivate??!1,category:r.category||"personal",recurrence:r.recurrence,priority:r.priority||"delete",size:r.size||"pequea",estimatedTime:r.estimatedTime,timeOfDay:r.timeOfDay}),[m,h]=p.useState(()=>r.priority==="do"||r.priority==="delegate"),[g,x]=p.useState(()=>r.priority==="do"||r.priority==="decide"),[y,v]=p.useState(r.size||"pequea"),[b,N]=p.useState(Og(r.elapsedSeconds)),[S,w]=p.useState(null);p.useEffect(()=>{t&&(l==="create"?(u({title:"",description:"",category:"personal",isRecurrent:!1,isPrivate:r.isPrivate||!1,priority:"delete",size:"pequea",estimatedTime:void 0,timeOfDay:void 0}),h(!1),x(!1),v("pequea"),N(Og(0)),w(null)):(u({title:r.title||"",description:r.description||"",startDate:l==="complete"?o(new Date,r.recurrence):r.startDate||void 0,endDate:r.endDate||void 0,isRecurrent:r.isRecurrent||!1,isPrivate:r.isPrivate||!1,category:r.category||"personal",recurrence:r.recurrence,priority:r.priority||"delete",size:r.size||"pequea",estimatedTime:r.estimatedTime,timeOfDay:r.timeOfDay,elapsedSeconds:r.elapsedSeconds}),h(r.priority==="do"||r.priority==="delegate"),x(r.priority==="do"||r.priority==="decide"),v(r.size||"pequea"),N(Og(r.elapsedSeconds)),w(null)))},[r,l,t]),p.useEffect(()=>{if(l==="complete"||!d.startDate||!d.endDate)return;const D=d.endDate.getTime()-d.startDate.getTime(),k=Math.max(0,Math.round(D/6e4));u(_=>_.estimatedTime===k?_:{..._,estimatedTime:k})},[d.startDate,d.endDate,l]);const E=async()=>{if(!d.title.trim())return;if(d.startDate&&d.endDate&&d.endDate<d.startDate){w("La fecha de fin debe ser posterior a la fecha de inicio.");return}const D=KB(b);if(D===null){w("El valor no es valido.");return}const k=m&&g?"do":g?"decide":m?"delegate":"delete";if(l==="create"){const _=d.title.split(`
`).map(R=>R.trim()).filter(Boolean);for(const R of _)await Promise.resolve(s({...d,title:R,priority:k,size:y,elapsedSeconds:D}));a()}else await Promise.resolve(s({...d,priority:k,size:y,elapsedSeconds:D})),a()};PD({openCreateModal:()=>{},onSave:E,isModalOpen:t});const T=()=>{switch(l){case"create":return"Nueva Tarea";case"edit":return"Editar Tarea";case"complete":return"Completar Tarea";default:return""}};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"max-w-[95vw] w-[95vw] max-h-[90vh] h-[80vh] overflow-y-auto sm:max-w-[90vw] sm:w-[90vw] lg:max-w-[85vw] lg:w-[85vw]",children:[e.jsxs(Ot,{children:[e.jsx(Rt,{children:T()}),l==="complete"&&e.jsx(Ms,{children:r.title})]}),e.jsxs("div",{className:"grid gap-6 py-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[l!=="complete"&&e.jsx(VP,{multiline:l==="create",value:d.title,onChange:D=>u(k=>({...k,title:D}))}),e.jsx(qP,{value:d.description||"",onChange:D=>u(k=>({...k,description:D}))}),l==="edit"&&e.jsxs(e.Fragment,{children:[e.jsx(GP,{title:d.title,description:d.description||"",onInsert:D=>u(k=>({...k,description:(k.description?k.description+`
`:"")+D}))}),e.jsx(KP,{title:d.title,description:d.description||"",onInsert:D=>u(k=>({...k,description:(k.description?k.description+`
`:"")+D}))}),e.jsx(QP,{title:d.title,description:d.description||"",onInsert:D=>u(k=>({...k,description:(k.description?k.description+`
`:"")+D}))})]})]}),e.jsxs("div",{className:"space-y-6",children:[l!=="complete"&&e.jsx(GB,{value:d.category,onChange:D=>u(k=>({...k,category:D}))}),l!=="complete"&&e.jsx(eB,{startDate:d.startDate,endDate:d.endDate,onStartDateChange:D=>{u(k=>({...k,startDate:D})),w(null)},onEndDateChange:D=>{u(k=>({...k,endDate:D})),w(null)},showClearButton:!0}),l!=="complete"&&e.jsx(WB,{isRecurrent:d.isRecurrent??!1,onRecurrentChange:D=>u(k=>({...k,isRecurrent:D,recurrence:D?{pattern:"daily",frequency:1}:void 0})),config:d.recurrence,onConfigChange:D=>u(k=>({...k,recurrence:D}))}),l!=="complete"&&e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tiempo estimado (min)"}),e.jsx(ye,{type:"number",min:"0",readOnly:!0,placeholder:"Calculado",value:d.estimatedTime??""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tiempo ejecutado (HH:MM:SS)"}),e.jsx(ye,{value:b,onChange:D=>{N(D.target.value),w(null)},placeholder:"00:00:00"})]})]}),l!=="complete"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Va,{checked:m,onCheckedChange:D=>h(!!D)}),"Urgente"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Va,{checked:g,onCheckedChange:D=>x(!!D)}),"Importante"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Va,{checked:d.isPrivate??!1,onCheckedChange:D=>u(k=>({...k,isPrivate:!!D}))})," Privada (solo en Journal)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Tamao"}),e.jsxs(yt,{value:y,onValueChange:D=>v(D),children:[e.jsx(ft,{className:"h-8 w-28",children:e.jsx(vt,{placeholder:"Tamao"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"pequea",children:"pequea"}),e.jsx(Le,{value:"mediana",children:"mediana"}),e.jsx(Le,{value:"grande",children:"grande"})]})]})]})]})]})]}),S&&e.jsx("div",{className:"text-sm text-red-600",children:S}),e.jsxs(Cs,{children:[e.jsx(P,{variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(P,{onClick:E,disabled:!d.title.trim(),children:l==="complete"?"Completar":l==="create"?"Crear":"Guardar cambios"})]})]})})},XB=({selectedDate:t})=>{const{allTasks:a,status:s,error:r,showRecurrenceModal:l,currentTask:o,modalMode:d,addTask:u,editTask:m,toggleTask:h,deleteTask:g,completeRecurrentTask:x,setShowRecurrenceModal:y,openEditModal:v,openCreateModal:b}=Pf(),[N,S]=p.useState(null),[w,E]=p.useState(!1),[T,D]=p.useState(""),[k,_]=p.useState(!1),R=a.filter($=>$.isPrivate),L=R.filter($=>$.startDate&&Mh($.startDate,t)),U=R.filter($=>!$.completed&&(!$.startDate||!Mh($.startDate,t))),V=()=>{b(t,!0)},F=()=>{try{const $=JSON.parse(T);if(!Array.isArray($)){ut.error("El JSON debe contener un array de tareas");return}let z=0,H=0;$.forEach(I=>{if(I.title){let O;if(I.startDate||I.dueDate){const Y=I.startDate||I.dueDate,le=new Date(Y);isNaN(le.getTime())?(H++,console.warn(`Fecha invlida para tarea "${I.title}": ${Y}`)):O=le}u({title:I.title,description:I.description||"",startDate:O,category:I.category||"personal",priority:I.priority||void 0,isPrivate:!0,isRecurrent:I.isRecurrent||!1,size:I.size||void 0}),z++}}),H>0?ut.warning(`${z} tareas importadas. ${H} fechas invlidas fueron omitidas.`):ut.success(`${z} tareas privadas importadas correctamente`),D(""),_(!1)}catch($){ut.error("Error al importar las tareas. Verifica el formato JSON."),console.error("Error de importacin:",$)}},G=()=>{const $=R.map(H=>({title:H.title,description:H.description||"",startDate:H.startDate?.toISOString(),endDate:H.endDate?.toISOString(),category:H.category,priority:H.priority,size:H.size,completed:H.completed,isRecurrent:H.isRecurrent||!1,...H.recurrence&&{recurrence:{frequency:H.recurrence.frequency,pattern:H.recurrence.pattern,customDays:H.recurrence.customDays,nextDate:H.recurrence.nextDate?.toISOString()}}})),z=JSON.stringify($,null,2);navigator.clipboard.writeText(z).then(()=>{ut.success("Tareas privadas copiadas al portapapeles con fechas incluidas")})};return e.jsxs(fe,{className:"w-full mt-4",children:[e.jsx(xt,{children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"text-lg",children:" Tareas Privadas"}),e.jsxs(wt,{variant:"secondary",className:"text-xs",children:[R.length," total"]})]})})}),e.jsxs(xe,{className:"space-y-4",children:[L.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-gray-600 mb-2",children:["Para hoy (",L.length,")"]}),e.jsx("div",{className:"space-y-2",children:L.map($=>e.jsx(yu,{task:$,onDelete:g,onEdit:v,onView:z=>{S(z),E(!0)},onMove:(z,H)=>m(z,{startDate:H||void 0}),onAssignTimeOfDay:(z,H)=>m(z,{timeOfDay:H})},$.id))})]}),U.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-gray-600 mb-2",children:["Pendientes (",U.length,")"]}),e.jsx("div",{className:"space-y-2",children:U.map($=>e.jsx(yu,{task:$,onDelete:g,onEdit:v,onView:z=>{S(z),E(!0)},onMove:(z,H)=>m(z,{startDate:H||void 0}),onAssignTimeOfDay:(z,H)=>m(z,{timeOfDay:H})},$.id))})]}),R.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No tienes tareas privadas"}),e.jsx("p",{className:"text-sm",children:"Crea una nueva o importa desde JSON"})]}),s==="saving"&&e.jsx(wt,{variant:"secondary",className:"text-xs",children:"Guardando..."}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]}),e.jsxs(Mt,{open:k,onOpenChange:_,children:[e.jsx(FE,{asChild:!0,children:e.jsxs(P,{size:"sm",variant:"outline",children:[e.jsx(hu,{className:"w-4 h-4 mr-2"}),"Importar"]})}),e.jsxs(Tt,{children:[e.jsxs(Ot,{children:[e.jsx(Rt,{children:"Importar Tareas Privadas"}),e.jsx(Ms,{children:"Pega el JSON con las tareas a importar. Todas se marcar\\u00e1n como privadas."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(sa,{placeholder:`Ejemplo - Puedes incluir fechas en formato ISO (YYYY-MM-DD) o dejarlas sin fecha:
[
  {
    "title": "Reflexin personal importante",
    "description": "Pensar sobre mis metas de vida",
    "dueDate": "2024-12-31",
    "category": "personal",
    "priority": "do",
    "size": "mediana"
  },
  {
    "title": "Tarea sensible del trabajo",
    "description": "Revisar tema confidencial",
    "dueDate": "2024-06-15T14:30:00Z",
    "category": "work",
    "priority": "decide"
  },
  {
    "title": "Tarea sin fecha especfica",
    "description": "Esta tarea no tiene fecha lmite",
    "category": "personal"
  }
]

Formatos de fecha soportados:
- "2024-12-31" (solo fecha)
- "2024-06-15T14:30:00Z" (fecha y hora ISO)
- "2024-06-15T14:30:00" (fecha y hora local)
- Sin campo "dueDate" = sin fecha asignada`,value:T,onChange:$=>D($.target.value),rows:15,className:"font-mono text-sm"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(P,{variant:"outline",onClick:()=>_(!1),children:"Cancelar"}),e.jsx(P,{onClick:F,disabled:!T.trim(),children:"Importar Tareas"})]})]})]})]}),e.jsxs(P,{size:"sm",variant:"outline",onClick:G,children:[e.jsx(Or,{className:"w-4 h-4 mr-2"}),"Exportar"]}),e.jsxs(P,{size:"sm",onClick:V,children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),"Nueva Privada"]}),e.jsx(S2,{isOpen:l,onClose:()=>y(),onConfirm:$=>{const z={...$,isPrivate:!0};d==="complete"?x(z):d==="edit"?m(o.id,z):u(z)},task:o||{id:"",taskCode:0,title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:d}),e.jsx(YD,{task:N,isOpen:w,onClose:()=>E(!1),onEdit:$=>{E(!1),v($)},onToggle:h})]})},sf=Ci("task"),QB=sf?`https://generativelanguage.googleapis.com/v1beta/models/${sf.model}:generateContent`:"",ZB=({tasks:t,open:a,onOpenChange:s})=>{const[r,l]=p.useState(!1),o=a!==void 0?a:r,d=s??l,[u,m]=p.useState(null),{moodStates:h}=Cy(),[g,x]=p.useState(""),[y,v]=p.useState(!1),[b,N]=p.useState(""),[S,w]=p.useState(0),E="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",T=sf?.prompt??"Eres un asistente de productividad. Basndote en el estado de nimo y las tareas pendientes sugiere cul debera abordar primero.",D=sf?.params;p.useEffect(()=>{if(u){const L=t.sort((U,V)=>(U.startDate?.getTime()||1/0)-(V.startDate?.getTime()||1/0)).slice(0,15).map(U=>`- ${U.title}${U.startDate?` (vence ${Jt(U.startDate,"yyyy-MM-dd")})`:""} - ${Ya[U.category]}`).join(`
`);N(`${T}
Estado de nimo: ${u.text}
Tareas pendientes:
${L}`)}else N("")},[u,t]),p.useEffect(()=>{w(zr(b))},[b]);const k=L=>{try{const U=Zt.parse(L);return uo.sanitize(U)}catch(U){return console.error("Error procesando Markdown:",U),uo.sanitize(L.replace(/\n/g,"<br>"))}},_=async()=>{if(u){v(!0);try{const V=(await(await fetch(`${QB}?key=${E}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:b}]}],...D})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text;x(V||"No se pudo obtener sugerencia")}catch{x("Error al consultar la API")}finally{v(!1)}}},R=()=>{d(!1),x(""),m(null)};return e.jsxs(Mt,{open:o,onOpenChange:L=>L?d(!0):R(),children:[a===void 0&&e.jsxs(P,{size:"sm",variant:"outline",onClick:()=>d(!0),className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"}),"Sugerir tarea"]}),e.jsx(Tt,{className:"max-w-6xl h-[80vh]",children:e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col space-y-4 mb-3",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("h2",{className:"text-lg font-medium mb-1",children:"Sugerencia de tarea con IA"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Selecciona tu estado de nimo para recibir recomendaciones personalizadas"})]}),!u&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Cmo te sientes?"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[h.map(L=>e.jsx("div",{className:"relative",children:e.jsxs(P,{variant:"outline",onClick:()=>m({emoji:L.emoji,text:L.text}),className:"h-12 text-lg w-full relative",children:[e.jsx("span",{children:L.emoji}),e.jsx("span",{className:"w-full text-center text-xs text-gray-500 mt-1",children:L.text})]})},L.emoji)),h.length===0&&e.jsx("div",{className:"text-xs text-gray-500 col-span-3",children:"No hay estados de animo configurados."})]})]}),u&&e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-3 p-2 bg-gray-50 rounded-md",children:e.jsxs("span",{children:["Estado de nimo: ",e.jsxs("strong",{children:[u.emoji," ",u.text]})]})}),e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Prompt para IA:"}),e.jsx(sa,{value:b,onChange:L=>N(L.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Modifica el prompt para personalizar la sugerencia..."})]})]}),u&&e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",S]}),S>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:_,disabled:y||!E||S>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[y&&e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx(os,{className:"w-4 h-4"}),y?"Consultando IA...":"Generar sugerencia"]}),y&&e.jsx(yi,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Resultado"}),g?e.jsx("div",{className:"flex-1 p-4 bg-muted rounded-md overflow-auto",children:e.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert
                    prose-headings:text-foreground prose-p:text-foreground 
                    prose-strong:text-foreground prose-ul:text-foreground 
                    prose-ol:text-foreground prose-li:text-foreground
                    prose-code:bg-accent prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-foreground
                    prose-pre:bg-accent prose-pre:border prose-pre:text-foreground
                    prose-blockquote:border-l-accent prose-blockquote:text-foreground`,dangerouslySetInnerHTML:{__html:k(g)}})}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 text-sm",children:u?"Haz clic en 'Generar sugerencia' para obtener recomendaciones":"Selecciona tu estado de nimo para comenzar"})]})]})})]})},nf=Ci("task"),JB=nf?`https://generativelanguage.googleapis.com/v1beta/models/${nf.model}:generateContent`:"",e$=({tasks:t,onUpdate:a,open:s,onOpenChange:r})=>{const[l,o]=p.useState(!1),d=s!==void 0?s:l,u=r??o,[m,h]=p.useState(!1),[g,x]=p.useState(""),[y,v]=p.useState(""),[b,N]=p.useState(0),S="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",w=nf?.prompts?.reprioritize??"Analiza la lista de tareas y devuelve un JSON con id, urgent, important, size y estimatedTime (minutos).",E=nf?.params;p.useEffect(()=>{if(d){const D=t.map(k=>`- id:${k.id} title:${k.title} desc:${k.description||""} priority:${k.priority||""} size:${k.size||""} time:${k.estimatedTime||""}`).join(`
`);v(`${w}
${D}`)}},[d,t]),p.useEffect(()=>{N(zr(y))},[y]);const T=async()=>{if(t.length!==0){h(!0);try{const _=(await(await fetch(`${JB}?key=${S}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:y}]}],...E})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text||"";x(_);const R=_.match(/```json([\s\S]*?)```/),L=R?R[1]:_;JSON.parse(L).forEach(V=>{const F=V.urgent&&V.important?"do":V.important?"decide":V.urgent?"delegate":"delete";a(V.id,{priority:F,size:V.size,estimatedTime:V.estimatedTime})})}catch{x("Error al consultar la API")}finally{h(!1)}}};return e.jsxs(e.Fragment,{children:[s===void 0&&e.jsxs(P,{size:"sm",variant:"outline",onClick:()=>u(!0),className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"}),"Repriorizar"]}),e.jsx(Mt,{open:d,onOpenChange:u,children:e.jsxs(Tt,{className:"max-w-6xl h-[80vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0 pb-1 space-y-0",children:[e.jsx(Rt,{className:"text-lg font-medium",children:"Repriorizar Tareas con IA"}),e.jsx(Ms,{className:"text-sm mt-1",children:"La IA analizar tus tareas y ajustar automticamente prioridad, tamao y tiempo estimado."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:y,onChange:D=>v(D.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Lista de tareas a analizar..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",b]}),b>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:T,disabled:m||!S||b>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[m&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(os,{className:"w-4 h-4"}),m?"Analizando...":"Repriorizar tareas"]}),m&&e.jsx(yi,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado del anlisis"}),g&&e.jsxs(P,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(g),ut.success("Anlisis copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Rr,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-md p-3 overflow-auto",children:g?e.jsx("pre",{className:"text-xs whitespace-pre-wrap font-mono text-gray-700",children:g}):m?e.jsx("div",{className:"text-sm text-gray-500",children:"Analizando tareas..."}):e.jsx("div",{className:"text-sm text-gray-500",children:"El anlisis y repriorizacion aparecer aqu. Las tareas se actualizarn automticamente una vez completado el anlisis."})})})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:" Tip: Las tareas se actualizarn automticamente segn la matriz de Eisenhower"}),!S]})})]})})]})},t$={daily:"Diario",weekly:"Semanal",monthly:"Mensual"},wS={do:{label:"HACER",color:"bg-red-500",text:"Urgente e importante"},decide:{label:"DECIDIR",color:"bg-orange-500",text:"Importante, no urgente"},delegate:{label:"DELEGAR",color:"bg-blue-500",text:"Urgente, no importante"},delete:{label:"ELIMINAR",color:"bg-gray-500",text:"Ni urgente ni importante"},none:{label:"",color:"",text:""}},Rg={do:{icon:"",num:1,style:"bg-red-600 text-white"},decide:{icon:"",num:2,style:"bg-orange-500 text-white"},delegate:{icon:"",num:3,style:"bg-blue-500 text-white"},delete:{icon:"",num:4,style:"bg-gray-500 text-white"},none:{icon:"",num:4,style:"bg-gray-500 text-white"}},a$=t=>Jt(t,"dd/MM"),s$=t=>t?.type&&t$[t.type]||"",n$=(t="none")=>wS[t]||wS.none,r$=t=>t?Ua(ka(t),ka(new Date)):!1,i$=(t,a)=>{const s=Jt(t,"HH:mm");if(a){const r=Jt(a,"HH:mm");return`${s} - ${r}`}return s},C2=p.memo(({task:t,showCategoryLabel:a,overdue:s})=>{const r={bg:_r[t.category]?.bg||"bg-purple-100",text:_r[t.category]?.text||"text-purple-800"},l=n$(t.priority),o=s$(t.recurrence);return e.jsxs("div",{className:"flex flex-wrap gap-0.5 leading-none",children:[a&&e.jsxs(wt,{className:he("text-xs px-1 py-0 h-auto",r.bg,r.text),children:[e.jsx(pc,{className:"w-3 h-3 mr-0.5"}),Ya[t.category]]}),t.startDate&&e.jsxs(wt,{variant:s?"destructive":"secondary",className:"text-xs px-1 py-0 h-auto",children:[e.jsx(Aa,{className:"w-3 h-3 mr-0.5"}),a$(t.startDate),s&&" (vencida)"]}),t.startDate&&(t.startDate.getHours()!==12||t.startDate.getMinutes()!==0)&&e.jsxs(wt,{variant:"outline",className:"text-xs px-1 py-0 h-auto bg-blue-50 text-blue-700",children:[e.jsx(xs,{className:"w-3 h-3 mr-0.5"}),i$(t.startDate,t.endDate)]}),e.jsx(Vs,{children:e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(wt,{className:he("text-xs px-1 py-0 h-auto gap-0.5",Rg[t.priority||"none"].style),children:[e.jsx("span",{children:Rg[t.priority||"none"].icon}),Rg[t.priority||"none"].num]})}),e.jsx(fa,{children:l.text})]})}),t.estimatedTime!==void 0&&e.jsxs(wt,{variant:"outline",className:"text-xs px-1 py-0 h-auto",children:[e.jsx(xs,{className:"w-3 h-3 mr-0.5"}),t.estimatedTime,"m"]}),t.isRecurrent&&o&&e.jsxs(wt,{variant:"outline",className:"text-xs px-1 py-0 h-auto",children:[e.jsx(ny,{className:"w-3 h-3 mr-0.5"}),o]}),!a&&t.size&&e.jsx(wt,{variant:"outline",className:"text-xs px-1 py-0 h-auto",children:t.size})]})});C2.displayName="TaskBadges";const E2=p.memo(({task:t,onEdit:a,onDelete:s,onMove:r})=>{const l=it(),o=p.useCallback(v=>{v.stopPropagation(),r?.(t.id,rl(new Date))},[r,t.id]),d=p.useCallback(v=>{v.stopPropagation(),r?.(t.id,rl(ps(new Date,1)))},[r,t.id]),u=p.useCallback(v=>{v.stopPropagation(),r?.(t.id,rl(ps(new Date,2)))},[r,t.id]),m=p.useCallback(v=>{v.stopPropagation(),r?.(t.id,null)},[r,t.id]),h=p.useCallback(v=>{v.stopPropagation(),a(t)},[a,t]),g=p.useCallback(()=>{s(t.id)},[s,t.id]),x=p.useCallback(v=>{v.stopPropagation(),l(`/task/${t.id}/run`)},[l,t.taskCode]),y="h-4 w-4 p-0 rounded-full hover:bg-muted";return e.jsxs("div",{className:"flex items-center justify-center gap-0.5 py-0.5",children:[r&&e.jsxs("div",{className:"flex gap-0.5 pr-1 border-r border-gray-200",children:[e.jsx(P,{variant:"ghost",size:"icon",className:y,title:"Asignar para hoy",onClick:o,children:e.jsx("span",{role:"img","aria-label":"hoy",className:"text-[10px]",children:""})}),e.jsx(P,{variant:"ghost",size:"icon",className:y,title:"Asignar para maana",onClick:d,children:e.jsx("span",{role:"img","aria-label":"maana",className:"text-[10px]",children:""})}),e.jsx(P,{variant:"ghost",size:"icon",className:y,title:"Asignar para pasado maana",onClick:u,children:e.jsx("span",{role:"img","aria-label":"pasado maana",className:"text-[10px]",children:""})}),e.jsx(P,{variant:"ghost",size:"icon",className:y,title:"Quitar fecha",onClick:m,children:e.jsx("span",{role:"img","aria-label":"sin fecha",className:"text-[10px]",children:""})})]}),e.jsx(P,{variant:"ghost",size:"icon",className:y,title:"Ejecutar",onClick:x,children:e.jsx(Bs,{className:"w-2.5 h-2.5 text-green-600"})}),e.jsx(P,{variant:"ghost",size:"icon",className:y,title:"Editar tarea",onClick:h,children:e.jsx(Vn,{className:"w-2.5 h-2.5 text-muted-foreground"})}),e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"icon",className:he(y,"hover:bg-red-50"),title:"Eliminar tarea",onClick:v=>v.stopPropagation(),children:e.jsx(Fa,{className:"w-2.5 h-2.5 text-red-500"})})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Eliminar tarea?"}),e.jsxs(fr,{children:['Esta accin no se puede deshacer. La tarea "',t.title,'" ser eliminada permanentemente.']})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"Cancelar"}),e.jsx(pr,{onClick:g,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})});E2.displayName="TaskCalendarActions";const $u=p.memo(({task:t,onDelete:a,onEdit:s,onView:r,onMove:l,showCategoryLabel:o=!0})=>{const d=r$(t.startDate??null),{total:u,checked:m}=Mu(t.description||""),h=u?t.progress??m/u*100:0,g=p.useCallback(()=>{r?.(t)},[r,t]),x=he("cursor-pointer relative hover:shadow-md transition-all duration-200 border-0 shadow-sm bg-white",t.completed&&"opacity-70 bg-gray-50",!t.completed&&d&&"border-l-4 border-l-red-500 bg-red-50");return e.jsxs(fe,{onClick:g,className:x,children:[e.jsxs(xe,{className:"px-1 py-0.5 space-y-0.5",children:[e.jsx("div",{className:"space-y-0",children:e.jsxs("div",{className:"flex items-center gap-1",children:[t.isPrivate&&e.jsx("span",{className:"text-[10px]",children:""}),e.jsx("span",{className:he("text-xs font-medium leading-none line-clamp-1 flex-1",t.completed?"line-through text-muted-foreground":"text-foreground"),children:t.title}),e.jsxs("span",{className:"text-[10px] font-mono text-gray-400 flex-shrink-0",children:["#",t.taskCode]})]})}),e.jsx(C2,{task:t,showCategoryLabel:o,overdue:d}),u>0&&e.jsxs("div",{className:"space-y-0",children:[e.jsx(Us,{value:h,className:"h-0.5"}),e.jsxs("p",{className:"text-[10px] text-right text-muted-foreground leading-none",children:[m," de ",u]})]})]}),e.jsx("div",{className:"w-full",children:e.jsx(E2,{task:t,onEdit:s,onDelete:a,onMove:l})})]})});$u.displayName="TaskItemCalendar";const l$=({tasks:t,onDelete:a,onEdit:s,onView:r,onMove:l})=>{const o=ka(new Date),d=p.useMemo(()=>t.filter(u=>u.startDate?Ua(u.startDate,o)&&!u.completed:!1).sort((u,m)=>u.startDate&&m.startDate?u.startDate.getTime()-m.startDate.getTime():0),[t,o]);return d.length===0?null:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"sticky top-0 bg-white py-2 z-10",children:e.jsxs("h3",{className:"text-sm font-semibold text-red-600 flex items-center gap-2",children:[e.jsx("span",{children:""}),"Tareas Vencidas (",d.length,")"]})}),e.jsx("div",{className:"space-y-2",children:d.map(u=>e.jsx($u,{task:u,onDelete:a,onEdit:s,onView:r,onMove:l,showCategoryLabel:!0},u.id))})]})},o$=({task:t,onDelete:a,onEdit:s,onQuickUpdate:r,onToggle:l,style:o,className:d,isDraggable:u=!0})=>{const[m,h]=p.useState(!1),g=it(),{exportTaskToGoogleCalendar:x}=VD(),{attributes:y,listeners:v,setNodeRef:b,transform:N,isDragging:S}=SD({id:`task-${t.id}`,data:{task:t,type:"task-move"},disabled:!u||m}),w=_r[t.category]||_r.personal,E=()=>({"text-red-700":"#b91c1c","text-blue-700":"#1d4ed8","text-green-700":"#15803d","text-purple-700":"#7e22ce","text-orange-700":"#c2410c","text-pink-700":"#be185d"})[w.text]||"#7e22ce",T=H=>{H.stopPropagation(),h(!1),s(t)},D=H=>{H.stopPropagation(),h(!1),a(t.id)},k=H=>{H.stopPropagation(),h(!1),l&&l(t.id,!t.completed)},_=H=>{H.stopPropagation(),h(!1),g(`/task/${t.id}/run`)},R=H=>{H.stopPropagation(),h(!1),x(t)},L=t.startDate?Jt(t.startDate,"HH:mm"):"",U=t.endDate?Jt(t.endDate,"HH:mm"):"",V=p.useMemo(()=>{if(!t.startDate||!t.endDate)return null;const H=t.endDate.getTime()-t.startDate.getTime(),I=Math.floor(H/6e4);if(I<60)return{minutes:I,label:`${I} min`};{const O=Math.floor(I/60),Y=I%60;return{minutes:I,label:Y>0?`${O}h ${Y}min`:`${O}h`}}},[t.startDate,t.endDate]),F=H=>{if(!t.endDate||!t.startDate)return;const I=new Date(t.endDate);I.setMinutes(I.getMinutes()+H),!(I.getTime()-t.startDate.getTime()<15*6e4)&&(I.getHours()>22||I.getHours()===22&&I.getMinutes()>0||(h(!1),r?r({...t,endDate:I}):s({...t,endDate:I})))},G=p.useMemo(()=>V?{by30:V.minutes>=45,by60:V.minutes>=75}:{by30:!1,by60:!1},[V]),$=p.useMemo(()=>{if(!t.endDate)return{by30:!1,by60:!1,by120:!1};const H=I=>{const O=new Date(t.endDate);return O.setMinutes(O.getMinutes()+I),O.getHours()<22||O.getHours()===22&&O.getMinutes()===0};return{by30:H(30),by60:H(60),by120:H(120)}},[t.endDate]),z=N?{transform:Kh.Transform.toString(N),zIndex:1e3}:{};return e.jsxs(Yf,{open:m,onOpenChange:h,children:[e.jsx(qf,{asChild:!0,children:e.jsxs("div",{className:he("cursor-pointer overflow-hidden rounded text-white text-xs relative","hover:opacity-90 transition-opacity","flex",S&&"opacity-50 shadow-lg",d),style:{...o,...z,backgroundColor:E(),minHeight:"48px"},children:[u&&e.jsx("div",{ref:b,...y,...v,className:"w-6 flex-shrink-0 bg-black/10 hover:bg-black/20 flex items-center justify-center cursor-move border-r border-white/20 transition-colors",title:"Arrastrar para mover tarea",children:e.jsx(m1,{className:"w-4 h-4 opacity-75"})}),e.jsxs("div",{className:"flex-1 p-1 flex flex-col min-w-0",children:[e.jsx("div",{className:"font-semibold leading-tight truncate",children:t.title}),e.jsxs("div",{className:"text-[10px] opacity-90 leading-tight mt-0.5",children:[L,U&&` - ${U}`]}),t.isPrivate&&e.jsx("div",{className:"text-[10px] opacity-75",children:""})]})]})}),e.jsx(Pu,{className:"w-80 p-3",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:"font-semibold text-sm flex-1",children:t.title}),t.isPrivate&&e.jsx("span",{className:"text-sm",children:""})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["#",t.taskCode]})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[t.startDate&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-3 h-3 text-muted-foreground"}),e.jsxs("span",{children:[Jt(t.startDate,"dd/MM/yyyy")," - ",L,U&&` a ${U}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:E()}}),e.jsx("span",{children:Ya[t.category]})]})]}),V&&e.jsxs("div",{className:"space-y-2 p-2 bg-muted/50 rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium",children:[e.jsx(pi,{className:"w-3 h-3"}),e.jsxs("span",{children:["Duracin: ",V.label]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(P,{variant:"outline",size:"sm",className:"h-7 text-xs px-2",onClick:()=>F(-60),disabled:!G.by60,title:G.by60?"Reducir 1 hora":"Duracin mnima: 15 min",children:"-1h"}),e.jsx(P,{variant:"outline",size:"sm",className:"h-7 text-xs px-2",onClick:()=>F(-30),disabled:!G.by30,title:G.by30?"Reducir 30 minutos":"Duracin mnima: 15 min",children:"-30"}),e.jsx(P,{variant:"outline",size:"sm",className:"h-7 text-xs px-2",onClick:()=>F(30),disabled:!$.by30,title:$.by30?"Aumentar 30 minutos":"Lmite: 22:00",children:"+30"}),e.jsx(P,{variant:"outline",size:"sm",className:"h-7 text-xs px-2",onClick:()=>F(60),disabled:!$.by60,title:$.by60?"Aumentar 1 hora":"Lmite: 22:00",children:"+1h"}),e.jsx(P,{variant:"outline",size:"sm",className:"h-7 text-xs px-2",onClick:()=>F(120),disabled:!$.by120,title:$.by120?"Aumentar 2 horas":"Lmite: 22:00",children:"+2h"})]})]}),t.description&&e.jsxs("div",{className:"text-xs text-muted-foreground max-h-20 overflow-y-auto",children:[t.description.slice(0,200),t.description.length>200&&"..."]}),!t.isPrivate&&e.jsxs(P,{variant:"ghost",size:"sm",className:"w-full justify-start gap-2 h-8 text-xs",onClick:R,children:[e.jsx(Aa,{className:"w-3 h-3"}),"Exportar a Google Calendar"]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex gap-2",children:[l&&e.jsx(P,{variant:t.completed?"outline":"default",size:"sm",className:"flex-1 h-8 text-xs",onClick:k,title:t.completed?"Marcar como pendiente":"Marcar como completada",children:t.completed?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mr-1",children:""}),"Pendiente"]}):e.jsxs(e.Fragment,{children:[e.jsx(cr,{className:"w-3 h-3 mr-1"}),"Completar"]})}),e.jsxs(P,{variant:"outline",size:"sm",className:"flex-1 h-8 text-xs",onClick:_,title:"Ejecutar tarea con timer",children:[e.jsx(Bs,{className:"w-3 h-3 mr-1 text-green-600"}),"Ejecutar"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{variant:"outline",size:"sm",className:"flex-1 h-8 text-xs",onClick:T,title:"Editar tarea",children:[e.jsx(Vn,{className:"w-3 h-3 mr-1"}),"Editar"]}),e.jsx(P,{variant:"destructive",size:"sm",className:"h-8 text-xs px-3",onClick:D,title:"Eliminar tarea",children:e.jsx(Fa,{className:"w-3 h-3"})})]})]})]})})]})};function c$(t){const a=t.match(/(\d+)\s*(min|h|hora)/i);if(!a)return 30;const s=parseInt(a[1],10);return a[2].toLowerCase().startsWith("h")?s*60:s}function d$(t){return 25}function T2(t,a){const[s,r]=t.split(":").map(o=>parseInt(o,10)),l=new Date(a);return l.setHours(s,r,0,0),l}const Fd="habit-calendar-times",u$=t=>{const a=Ue(t),{completedHabits:s,toggleHabit:r}=Mf(t),[l,o]=p.useState(0),d=p.useCallback((x,y)=>{try{return JSON.parse(localStorage.getItem(Fd)||"{}")[y]?.[x]||nn.find(b=>b.id===x)?.baseTime||"09:00"}catch(v){return console.error("Error reading habit time from localStorage:",v),nn.find(b=>b.id===x)?.baseTime||"09:00"}},[]),u=p.useCallback((x,y,v)=>{try{const b=JSON.parse(localStorage.getItem(Fd)||"{}");b[y]||(b[y]={}),b[y][x]=v,localStorage.setItem(Fd,JSON.stringify(b)),console.log("Saved habit time to localStorage:",{habitId:x,date:y,time:v,data:b}),o(N=>N+1)}catch(b){console.error("Error saving habit time to localStorage:",b)}},[]),m=p.useCallback((x,y)=>{try{const v=JSON.parse(localStorage.getItem(Fd)||"{}");v[y]?.[x]&&(delete v[y][x],Object.keys(v[y]).length===0&&delete v[y],localStorage.setItem(Fd,JSON.stringify(v)),o(b=>b+1))}catch(v){console.error("Error resetting habit time in localStorage:",v)}},[]),h=async(x,y)=>{await r(x,y)};return{habits:p.useMemo(()=>nn.filter(x=>{const y=`${x.id}_${a}`;return!(s[y]===!0)}).map(x=>{const y=d(x.id,a),v=T2(y,t),b=c$(x.goal),N=SE(v,6),S=d$(),w=`${x.id}_${a}`,E=s[w]===!0;return{...x,displayTime:y,displayTimeDate:v,durationMinutes:b,top:N,height:S,isCompleted:E}}),[a,s,t,l,d]),updateHabitTime:u,resetHabitTime:m,getHabitTime:d,toggleHabitCompletion:h}},D2=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#F97316"],k2="life-tracker-external-calendars",Ig=D2,m$=D2[0],h$=1e4,f$=4,hh={borderWidth:"2px",borderStyle:"dashed",opacityBackground:.4,opacityBorder:1};function wl(){try{const t=localStorage.getItem(k2);if(!t)return CS();const a=JSON.parse(t),s=a.events.map(r=>({...r,startDate:new Date(r.startDate),endDate:new Date(r.endDate)}));return{calendars:a.calendars||[],events:s,hiddenEventIds:a.hiddenEventIds||[],lastGlobalSync:a.lastGlobalSync}}catch(t){return console.error("Error reading external calendar data from localStorage:",t),CS()}}function xo(t){try{localStorage.setItem(k2,JSON.stringify(t))}catch(a){throw console.error("Error saving external calendar data to localStorage:",a),new Error("No se pudo guardar la configuracin de calendarios")}}function p$(t){const a=wl();a.calendars.push(t),xo(a)}function SS(t,a){const s=wl(),r=s.calendars.findIndex(l=>l.id===t);r!==-1&&(s.calendars[r]={...s.calendars[r],...a},xo(s))}function x$(t){const a=wl();a.calendars=a.calendars.filter(r=>r.id!==t),a.events=a.events.filter(r=>r.calendarId!==t);const s=a.events.filter(r=>r.calendarId===t).map(r=>r.uid);a.hiddenEventIds=a.hiddenEventIds.filter(r=>!s.includes(r)),xo(a)}function g$(t,a){const s=wl();s.events=s.events.filter(l=>l.calendarId!==t),s.events.push(...a);const r=s.calendars.findIndex(l=>l.id===t);r!==-1&&(s.calendars[r].lastSyncedAt=Date.now()),xo(s)}function y$(t){const a=wl();a.hiddenEventIds.includes(t)||(a.hiddenEventIds.push(t),xo(a))}function v$(t){const a=wl();a.hiddenEventIds=a.hiddenEventIds.filter(s=>s!==t),xo(a)}function b$(){const t=wl();t.lastGlobalSync=Date.now(),xo(t)}function CS(){return{calendars:[],events:[],hiddenEventIds:[]}}class Kf{static fromString(a){return new Kf(a)}constructor(a){this.value=a}icaltype="binary";decodeValue(){return this._b64_decode(this.value)}setEncodedValue(a){this.value=this._b64_encode(a)}_b64_encode(a){let s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,l,o,d,u,m,h,g,x=0,y=0,v="",b=[];if(!a)return a;do r=a.charCodeAt(x++),l=a.charCodeAt(x++),o=a.charCodeAt(x++),g=r<<16|l<<8|o,d=g>>18&63,u=g>>12&63,m=g>>6&63,h=g&63,b[y++]=s.charAt(d)+s.charAt(u)+s.charAt(m)+s.charAt(h);while(x<a.length);v=b.join("");let N=a.length%3;return(N?v.slice(0,N-3):v)+"===".slice(N||3)}_b64_decode(a){let s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r,l,o,d,u,m,h,g,x=0,y=0,v="",b=[];if(!a)return a;a+="";do d=s.indexOf(a.charAt(x++)),u=s.indexOf(a.charAt(x++)),m=s.indexOf(a.charAt(x++)),h=s.indexOf(a.charAt(x++)),g=d<<18|u<<12|m<<6|h,r=g>>16&255,l=g>>8&255,o=g&255,m==64?b[y++]=String.fromCharCode(r):h==64?b[y++]=String.fromCharCode(r,l):b[y++]=String.fromCharCode(r,l,o);while(x<a.length);return v=b.join(""),v}toString(){return this.value}}const j$=/([PDWHMTS]{1,1})/,N$=["weeks","days","hours","minutes","seconds","isNegative"];class ks{static fromSeconds(a){return new ks().fromSeconds(a)}static isValueString(a){return a[0]==="P"||a[1]==="P"}static fromString(a){let s=0,r=Object.create(null),l=0;for(;(s=a.search(j$))!==-1;){let o=a[s],d=a.slice(0,Math.max(0,s));a=a.slice(s+1),l+=w$(o,d,r)}if(l<2)throw new Error('invalid duration value: Not enough duration components in "'+a+'"');return new ks(r)}static fromData(a){return new ks(a)}constructor(a){this.wrappedJSObject=this,this.fromData(a)}weeks=0;days=0;hours=0;minutes=0;seconds=0;isNegative=!1;icalclass="icalduration";icaltype="duration";clone(){return ks.fromData(this)}toSeconds(){let a=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+604800*this.weeks;return this.isNegative?-a:a}fromSeconds(a){let s=Math.abs(a);return this.isNegative=a<0,this.days=us(s/86400),this.days%7==0?(this.weeks=this.days/7,this.days=0):this.weeks=0,s-=(this.days+7*this.weeks)*86400,this.hours=us(s/3600),s-=this.hours*3600,this.minutes=us(s/60),s-=this.minutes*60,this.seconds=s,this}fromData(a){for(let s of N$)a&&s in a?this[s]=a[s]:this[s]=0}reset(){this.isNegative=!1,this.weeks=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0}compare(a){let s=this.toSeconds(),r=a.toSeconds();return(s>r)-(s<r)}normalize(){this.fromSeconds(this.toSeconds())}toString(){if(this.toSeconds()==0)return"PT0S";{let a="";this.isNegative&&(a+="-"),a+="P";let s=!1;return this.weeks?this.days||this.hours||this.minutes||this.seconds?a+=this.weeks*7+this.days+"D":(a+=this.weeks+"W",s=!0):this.days&&(a+=this.days+"D"),s||(this.hours||this.minutes||this.seconds)&&(a+="T",this.hours&&(a+=this.hours+"H"),this.minutes&&(a+=this.minutes+"M"),this.seconds&&(a+=this.seconds+"S")),a}}toICALString(){return this.toString()}}function w$(t,a,s){let r;switch(t){case"P":a&&a==="-"?s.isNegative=!0:s.isNegative=!1;break;case"D":r="days";break;case"W":r="weeks";break;case"H":r="hours";break;case"M":r="minutes";break;case"S":r="seconds";break;default:return 0}if(r){if(!a&&a!==0)throw new Error('invalid duration value: Missing number before "'+t+'"');let l=parseInt(a,10);if(vu(l))throw new Error('invalid duration value: Invalid number "'+a+'" before "'+t+'"');s[r]=l}return 1}class ci{static fromString(a,s){let r=a.split("/");if(r.length!==2)throw new Error('Invalid string value: "'+a+'" must contain a "/" char.');let l={start:De.fromDateTimeString(r[0],s)},o=r[1];return ks.isValueString(o)?l.duration=ks.fromString(o):l.end=De.fromDateTimeString(o,s),new ci(l)}static fromData(a){return new ci(a)}static fromJSON(a,s,r){function l(o,d){return r?De.fromString(o,d):De.fromDateTimeString(o,d)}return ks.isValueString(a[1])?ci.fromData({start:l(a[0],s),duration:ks.fromString(a[1])}):ci.fromData({start:l(a[0],s),end:l(a[1],s)})}constructor(a){if(this.wrappedJSObject=this,a&&"start"in a){if(a.start&&!(a.start instanceof De))throw new TypeError(".start must be an instance of ICAL.Time");this.start=a.start}if(a&&a.end&&a.duration)throw new Error("cannot accept both end and duration");if(a&&"end"in a){if(a.end&&!(a.end instanceof De))throw new TypeError(".end must be an instance of ICAL.Time");this.end=a.end}if(a&&"duration"in a){if(a.duration&&!(a.duration instanceof ks))throw new TypeError(".duration must be an instance of ICAL.Duration");this.duration=a.duration}}start=null;end=null;duration=null;icalclass="icalperiod";icaltype="period";clone(){return ci.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})}getDuration(){return this.duration?this.duration:this.end.subtractDate(this.start)}getEnd(){if(this.end)return this.end;{let a=this.start.clone();return a.addDuration(this.duration),a}}compare(a){return a.compare(this.start)<0?1:a.compare(this.getEnd())>0?-1:0}toString(){return this.start+"/"+(this.end||this.duration)}toJSON(){return[this.start.toString(),(this.end||this.duration).toString()]}toICALString(){return this.start.toICALString()+"/"+(this.end||this.duration).toICALString()}}class De{static _dowCache={};static _wnCache={};static daysInMonth(a,s){let r=[0,31,28,31,30,31,30,31,31,30,31,30,31],l=30;return a<1||a>12||(l=r[a],a==2&&(l+=De.isLeapYear(s))),l}static isLeapYear(a){return a<=1752?a%4==0:a%4==0&&a%100!=0||a%400==0}static fromDayOfYear(a,s){let r=s,l=a,o=new De;o.auto_normalize=!1;let d=De.isLeapYear(r)?1:0;if(l<1)return r--,d=De.isLeapYear(r)?1:0,l+=De.daysInYearPassedMonth[d][12],De.fromDayOfYear(l,r);if(l>De.daysInYearPassedMonth[d][12])return d=De.isLeapYear(r)?1:0,l-=De.daysInYearPassedMonth[d][12],r++,De.fromDayOfYear(l,r);o.year=r,o.isDate=!0;for(let u=11;u>=0;u--)if(l>De.daysInYearPassedMonth[d][u]){o.month=u+1,o.day=l-De.daysInYearPassedMonth[d][u];break}return o.auto_normalize=!0,o}static fromStringv2(a){return new De({year:parseInt(a.slice(0,4),10),month:parseInt(a.slice(5,7),10),day:parseInt(a.slice(8,10),10),isDate:!0})}static fromDateString(a){return new De({year:Es(a.slice(0,4)),month:Es(a.slice(5,7)),day:Es(a.slice(8,10)),isDate:!0})}static fromDateTimeString(a,s){if(a.length<19)throw new Error('invalid date-time value: "'+a+'"');let r,l;a.slice(-1)==="Z"?r=tt.utcTimezone:s&&(l=s.getParameter("tzid"),s.parent&&(s.parent.name==="standard"||s.parent.name==="daylight"?r=tt.localTimezone:l&&(r=s.parent.getTimeZoneByID(l))));const o={year:Es(a.slice(0,4)),month:Es(a.slice(5,7)),day:Es(a.slice(8,10)),hour:Es(a.slice(11,13)),minute:Es(a.slice(14,16)),second:Es(a.slice(17,19))};return l&&!r&&(o.timezone=l),new De(o,r)}static fromString(a,s){return a.length>10?De.fromDateTimeString(a,s):De.fromDateString(a)}static fromJSDate(a,s){return new De().fromJSDate(a,s)}static fromData=function(s,r){return new De().fromData(s,r)};static now(){return De.fromJSDate(new Date,!1)}static weekOneStarts(a,s){let r=De.fromData({year:a,month:1,day:1,isDate:!0}),l=r.dayOfWeek(),o=s||De.DEFAULT_WEEK_START;return l>De.THURSDAY&&(r.day+=7),o>De.THURSDAY&&(r.day-=7),r.day-=l-o,r}static getDominicalLetter(a){let s="GFEDCBA",r=(a+(a/4|0)+(a/400|0)-(a/100|0)-1)%7;return De.isLeapYear(a)?s[(r+6)%7]+s[r]:s[r]}static#e=null;static get epochTime(){return this.#e||(this.#e=De.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:!1,timezone:"Z"})),this.#e}static _cmp_attr(a,s,r){return a[r]>s[r]?1:a[r]<s[r]?-1:0}static daysInYearPassedMonth=[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]];static SUNDAY=1;static MONDAY=2;static TUESDAY=3;static WEDNESDAY=4;static THURSDAY=5;static FRIDAY=6;static SATURDAY=7;static DEFAULT_WEEK_START=2;constructor(a,s){this.wrappedJSObject=this,this._time=Object.create(null),this._time.year=0,this._time.month=1,this._time.day=1,this._time.hour=0,this._time.minute=0,this._time.second=0,this._time.isDate=!1,this.fromData(a,s)}icalclass="icaltime";_cachedUnixTime=null;get icaltype(){return this.isDate?"date":"date-time"}zone=null;_pendingNormalization=!1;get year(){return this._getTimeAttr("year")}set year(a){this._setTimeAttr("year",a)}get month(){return this._getTimeAttr("month")}set month(a){this._setTimeAttr("month",a)}get day(){return this._getTimeAttr("day")}set day(a){this._setTimeAttr("day",a)}get hour(){return this._getTimeAttr("hour")}set hour(a){this._setTimeAttr("hour",a)}get minute(){return this._getTimeAttr("minute")}set minute(a){this._setTimeAttr("minute",a)}get second(){return this._getTimeAttr("second")}set second(a){this._setTimeAttr("second",a)}get isDate(){return this._getTimeAttr("isDate")}set isDate(a){this._setTimeAttr("isDate",a)}_getTimeAttr(a){return this._pendingNormalization&&(this._normalize(),this._pendingNormalization=!1),this._time[a]}_setTimeAttr(a,s){a==="isDate"&&s&&!this._time.isDate&&this.adjust(0,0,0,0),this._cachedUnixTime=null,this._pendingNormalization=!0,this._time[a]=s}clone(){return new De(this._time,this.zone)}reset(){this.fromData(De.epochTime),this.zone=tt.utcTimezone}resetTo(a,s,r,l,o,d,u){this.fromData({year:a,month:s,day:r,hour:l,minute:o,second:d,zone:u})}fromJSDate(a,s){return a?s?(this.zone=tt.utcTimezone,this.year=a.getUTCFullYear(),this.month=a.getUTCMonth()+1,this.day=a.getUTCDate(),this.hour=a.getUTCHours(),this.minute=a.getUTCMinutes(),this.second=a.getUTCSeconds()):(this.zone=tt.localTimezone,this.year=a.getFullYear(),this.month=a.getMonth()+1,this.day=a.getDate(),this.hour=a.getHours(),this.minute=a.getMinutes(),this.second=a.getSeconds()):this.reset(),this._cachedUnixTime=null,this}fromData(a,s){if(a)for(let[r,l]of Object.entries(a))r!=="icaltype"&&(this[r]=l);if(s&&(this.zone=s),a&&!("isDate"in a)?this.isDate=!("hour"in a):a&&"isDate"in a&&(this.isDate=a.isDate),a&&"timezone"in a){let r=lf.get(a.timezone);this.zone=r||tt.localTimezone}return a&&"zone"in a&&(this.zone=a.zone),this.zone||(this.zone=tt.localTimezone),this._cachedUnixTime=null,this}dayOfWeek(a){let s=a||De.SUNDAY,r=(this.year<<12)+(this.month<<8)+(this.day<<3)+s;if(r in De._dowCache)return De._dowCache[r];let l=this.day,o=this.month+(this.month<3?12:0),d=this.year-(this.month<3?1:0),u=l+d+us((o+1)*26/10)+us(d/4);return u+=us(d/100)*6+us(d/400),u=(u+7-s)%7+1,De._dowCache[r]=u,u}dayOfYear(){let a=De.isLeapYear(this.year)?1:0;return De.daysInYearPassedMonth[a][this.month-1]+this.day}startOfWeek(a){let s=a||De.SUNDAY,r=this.clone();return r.day-=(this.dayOfWeek()+7-s)%7,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r}endOfWeek(a){let s=a||De.SUNDAY,r=this.clone();return r.day+=(7-this.dayOfWeek()+s-De.SUNDAY)%7,r.isDate=!0,r.hour=0,r.minute=0,r.second=0,r}startOfMonth(){let a=this.clone();return a.day=1,a.isDate=!0,a.hour=0,a.minute=0,a.second=0,a}endOfMonth(){let a=this.clone();return a.day=De.daysInMonth(a.month,a.year),a.isDate=!0,a.hour=0,a.minute=0,a.second=0,a}startOfYear(){let a=this.clone();return a.day=1,a.month=1,a.isDate=!0,a.hour=0,a.minute=0,a.second=0,a}endOfYear(){let a=this.clone();return a.day=31,a.month=12,a.isDate=!0,a.hour=0,a.minute=0,a.second=0,a}startDoyWeek(a){let s=a||De.SUNDAY,r=this.dayOfWeek()-s;return r<0&&(r+=7),this.dayOfYear()-r}getDominicalLetter(){return De.getDominicalLetter(this.year)}nthWeekDay(a,s){let r=De.daysInMonth(this.month,this.year),l,o=s,d=0,u=this.clone();if(o>=0){u.day=1,o!=0&&o--,d=u.day;let m=u.dayOfWeek(),h=a-m;h<0&&(h+=7),d+=h,d-=a,l=a}else{u.day=r;let m=u.dayOfWeek();o++,l=m-a,l<0&&(l+=7),l=r-l}return l+=o*7,d+l}isNthWeekDay(a,s){let r=this.dayOfWeek();return s===0&&r===a||this.nthWeekDay(a,s)===this.day}weekNumber(a){let s=(this.year<<12)+(this.month<<8)+(this.day<<3)+a;if(s in De._wnCache)return De._wnCache[s];let r,l=this.clone();l.isDate=!0;let o=this.year;l.month==12&&l.day>25?(r=De.weekOneStarts(o+1,a),l.compare(r)<0?r=De.weekOneStarts(o,a):o++):(r=De.weekOneStarts(o,a),l.compare(r)<0&&(r=De.weekOneStarts(--o,a)));let d=l.subtractDate(r).toSeconds()/86400,u=us(d/7)+1;return De._wnCache[s]=u,u}addDuration(a){let s=a.isNegative?-1:1,r=this.second,l=this.minute,o=this.hour,d=this.day;r+=s*a.seconds,l+=s*a.minutes,o+=s*a.hours,d+=s*a.days,d+=s*7*a.weeks,this.second=r,this.minute=l,this.hour=o,this.day=d,this._cachedUnixTime=null}subtractDate(a){let s=this.toUnixTime()+this.utcOffset(),r=a.toUnixTime()+a.utcOffset();return ks.fromSeconds(s-r)}subtractDateTz(a){let s=this.toUnixTime(),r=a.toUnixTime();return ks.fromSeconds(s-r)}compare(a){if(a instanceof ci)return-1*a.compare(this);{let s=this.toUnixTime(),r=a.toUnixTime();return s>r?1:r>s?-1:0}}compareDateOnlyTz(a,s){let r=this.convertToZone(s),l=a.convertToZone(s),o=0;return(o=De._cmp_attr(r,l,"year"))!=0||(o=De._cmp_attr(r,l,"month"))!=0||(o=De._cmp_attr(r,l,"day"))!=0,o}convertToZone(a){let s=this.clone(),r=this.zone.tzid==a.tzid;return!this.isDate&&!r&&tt.convert_time(s,this.zone,a),s.zone=a,s}utcOffset(){return this.zone==tt.localTimezone||this.zone==tt.utcTimezone?0:this.zone.utcOffset(this)}toICALString(){let a=this.toString();return a.length>10?qa.icalendar.value["date-time"].toICAL(a):qa.icalendar.value.date.toICAL(a)}toString(){let a=this.year+"-"+en(this.month)+"-"+en(this.day);return this.isDate||(a+="T"+en(this.hour)+":"+en(this.minute)+":"+en(this.second),this.zone===tt.utcTimezone&&(a+="Z")),a}toJSDate(){return this.zone==tt.localTimezone?this.isDate?new Date(this.year,this.month-1,this.day):new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0):new Date(this.toUnixTime()*1e3)}_normalize(){return this._time.isDate&&(this._time.hour=0,this._time.minute=0,this._time.second=0),this.adjust(0,0,0,0),this}adjust(a,s,r,l,o){let d,u,m=0,h=0,g,x,y,v,b,N=o||this._time;if(N.isDate||(g=N.second+l,N.second=g%60,d=us(g/60),N.second<0&&(N.second+=60,d--),x=N.minute+r+d,N.minute=x%60,u=us(x/60),N.minute<0&&(N.minute+=60,u--),y=N.hour+s+u,N.hour=y%24,m=us(y/24),N.hour<0&&(N.hour+=24,m--)),N.month>12?h=us((N.month-1)/12):N.month<1&&(h=us(N.month/12)-1),N.year+=h,N.month-=12*h,v=N.day+a+m,v>0)for(;b=De.daysInMonth(N.month,N.year),!(v<=b);)N.month++,N.month>12&&(N.year++,N.month=1),v-=b;else for(;v<=0;)N.month==1?(N.year--,N.month=12):N.month--,v+=De.daysInMonth(N.month,N.year);return N.day=v,this._cachedUnixTime=null,this}fromUnixTime(a){this.zone=tt.utcTimezone;let s=new Date(a*1e3);this.year=s.getUTCFullYear(),this.month=s.getUTCMonth()+1,this.day=s.getUTCDate(),this._time.isDate?(this.hour=0,this.minute=0,this.second=0):(this.hour=s.getUTCHours(),this.minute=s.getUTCMinutes(),this.second=s.getUTCSeconds()),this._cachedUnixTime=null}toUnixTime(){if(this._cachedUnixTime!==null)return this._cachedUnixTime;let a=this.utcOffset(),s=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-a);return this._cachedUnixTime=s/1e3,this._cachedUnixTime}toJSON(){let a=["year","month","day","hour","minute","second","isDate"],s=Object.create(null),r=0,l=a.length,o;for(;r<l;r++)o=a[r],s[o]=this[o];return this.zone&&(s.timezone=this.zone.tzid),s}}const S$=/[^ \t]/,rf=":",P0=";",C$="=",E$="unknown",T$="text",D$={"^'":'"',"^n":`
`,"^^":"^"};function ia(t){let a={},s=a.component=[];if(a.stack=[s],ia._eachLine(t,function(r,l){ia._handleContentLine(l,a)}),a.stack.length>1)throw new Zl("invalid ical body. component began but did not end");return a=null,s.length==1?s[0]:s}ia.property=function(t,a){let s={component:[[],[]],designSet:a||qa.defaultSet};return ia._handleContentLine(t,s),s.component[1][0]};ia.component=function(t){return ia(t)};class Zl extends Error{name=this.constructor.name}ia.ParserError=Zl;ia._handleContentLine=function(t,a){let s=t.indexOf(rf),r=t.indexOf(P0),l,o,d,u,m={};r!==-1&&s!==-1&&r>s&&(r=-1);let h;if(r!==-1){if(d=t.slice(0,Math.max(0,r)).toLowerCase(),h=ia._parseParameters(t.slice(Math.max(0,r)),0,a.designSet),h[2]==-1)throw new Zl("Invalid parameters in '"+t+"'");m=h[0];let w;if(typeof h[1]=="string"?w=h[1].length:w=h[1].reduce((E,T)=>E+T.length,0),l=w+h[2]+r,(o=t.slice(Math.max(0,l)).indexOf(rf))!==-1)u=t.slice(Math.max(0,l+o+1));else throw new Zl("Missing parameter value in '"+t+"'")}else if(s!==-1){if(d=t.slice(0,Math.max(0,s)).toLowerCase(),u=t.slice(Math.max(0,s+1)),d==="begin"){let w=[u.toLowerCase(),[],[]];a.stack.length===1?a.component.push(w):a.component[2].push(w),a.stack.push(a.component),a.component=w,a.designSet||(a.designSet=qa.getDesignSet(a.component[0]));return}else if(d==="end"){a.component=a.stack.pop();return}}else throw new Zl('invalid line (no token ";" or ":") "'+t+'"');let g,x=!1,y=!1,v,b,N;a.designSet.propertyGroups&&d.indexOf(".")!==-1?(b=d.split("."),m.group=b[0],N=b[1]):N=d,N in a.designSet.property&&(v=a.designSet.property[N],"multiValue"in v&&(x=v.multiValue),"structuredValue"in v&&(y=v.structuredValue),u&&"detectType"in v&&(g=v.detectType(u))),g||("value"in m?g=m.value.toLowerCase():v?g=v.defaultType:g=E$),delete m.value;let S;x&&y?(u=ia._parseMultiValue(u,y,g,[],x,a.designSet,y),S=[N,m,g,u]):x?(S=[N,m,g],ia._parseMultiValue(u,x,g,S,null,a.designSet,!1)):y?(u=ia._parseMultiValue(u,y,g,[],null,a.designSet,y),S=[N,m,g,u]):(u=ia._parseValue(u,g,a.designSet,!1),S=[N,m,g,u]),a.component[0]==="vcard"&&a.component[1].length===0&&!(d==="version"&&u==="4.0")&&(a.designSet=qa.getDesignSet("vcard3")),a.component[1].push(S)};ia._parseValue=function(t,a,s,r){return a in s.value&&"fromICAL"in s.value[a]?s.value[a].fromICAL(t,r):t};ia._parseParameters=function(t,a,s){let r=a,l=0,o=C$,d={},u,m,h,g=-1,x,y,v;for(;l!==!1&&(l=t.indexOf(o,l+1))!==-1;){if(u=t.slice(r+1,l),u.length==0)throw new Zl("Empty parameter name in '"+t+"'");if(m=u.toLowerCase(),v=!1,y=!1,m in s.param&&s.param[m].valueType?x=s.param[m].valueType:x=T$,m in s.param&&(y=s.param[m].multiValue,s.param[m].multiValueSeparateDQuote&&(v=ia._rfc6868Escape('"'+y+'"'))),t[l+1]==='"'){if(g=l+2,l=t.indexOf('"',g),y&&l!=-1){let w=!0;for(;w;)t[l+1]==y&&t[l+2]=='"'?l=t.indexOf('"',l+3):w=!1}if(l===-1)throw new Zl('invalid line (no matching double quote) "'+t+'"');h=t.slice(g,l),r=t.indexOf(P0,l);let S=t.indexOf(rf,l);(r===-1||S!==-1&&r>S)&&(l=!1)}else{g=l+1;let S=t.indexOf(P0,g),w=t.indexOf(rf,g);w!==-1&&S>w?(S=w,l=!1):S===-1?(w===-1?S=t.length:S=w,l=!1):(r=S,l=S),h=t.slice(g,S)}const N=h.length;if(h=ia._rfc6868Escape(h),g+=N-h.length,y){let S=v||y;h=ia._parseMultiValue(h,S,x,[],null,s)}else h=ia._parseValue(h,x,s);y&&m in d?Array.isArray(d[m])?d[m].push(h):d[m]=[d[m],h]:d[m]=h}return[d,h,g]};ia._rfc6868Escape=function(t){return t.replace(/\^['n^]/g,function(a){return D$[a]})};ia._parseMultiValue=function(t,a,s,r,l,o,d){let u=0,m=0,h;if(a.length===0)return t;for(;(u=A2(t,a,m))!==-1;)h=t.slice(m,u),l?h=ia._parseMultiValue(h,l,s,[],null,o,d):h=ia._parseValue(h,s,o,d),r.push(h),m=u+a.length;return h=t.slice(m),l?h=ia._parseMultiValue(h,l,s,[],null,o,d):h=ia._parseValue(h,s,o,d),r.push(h),r.length==1?r[0]:r};ia._eachLine=function(t,a){let s=t.length,r=t.search(S$),l=r,o,d,u;do l=t.indexOf(`
`,r)+1,l>1&&t[l-2]==="\r"?u=2:u=1,l===0&&(l=s,u=0),d=t[r],d===" "||d==="	"?o+=t.slice(r+1,l-u):(o&&a(null,o),o=t.slice(r,l-u)),r=l;while(l!==s);o=o.trim(),o.length&&a(null,o)};const k$=["tzid","location","tznames","latitude","longitude"];class tt{static _compare_change_fn(a,s){return a.year<s.year?-1:a.year>s.year?1:a.month<s.month?-1:a.month>s.month?1:a.day<s.day?-1:a.day>s.day?1:a.hour<s.hour?-1:a.hour>s.hour?1:a.minute<s.minute?-1:a.minute>s.minute?1:a.second<s.second?-1:a.second>s.second?1:0}static convert_time(a,s,r){if(a.isDate||s.tzid==r.tzid||s==tt.localTimezone||r==tt.localTimezone)return a.zone=r,a;let l=s.utcOffset(a);return a.adjust(0,0,0,-l),l=r.utcOffset(a),a.adjust(0,0,0,l),null}static fromData(a){return new tt().fromData(a)}static#e=null;static get utcTimezone(){return this.#e||(this.#e=tt.fromData({tzid:"UTC"})),this.#e}static#t=null;static get localTimezone(){return this.#t||(this.#t=tt.fromData({tzid:"floating"})),this.#t}static adjust_change(a,s,r,l,o){return De.prototype.adjust.call(a,s,r,l,o,a)}static _minimumExpansionYear=-1;static EXTRA_COVERAGE=5;constructor(a){this.wrappedJSObject=this,this.fromData(a)}tzid="";location="";tznames="";latitude=0;longitude=0;component=null;expandedUntilYear=0;icalclass="icaltimezone";fromData(a){if(this.expandedUntilYear=0,this.changes=[],a instanceof jn)this.component=a;else{if(a&&"component"in a)if(typeof a.component=="string"){let s=ia(a.component);this.component=new jn(s)}else a.component instanceof jn?this.component=a.component:this.component=null;for(let s of k$)a&&s in a&&(this[s]=a[s])}return this.component instanceof jn&&!this.tzid&&(this.tzid=this.component.getFirstPropertyValue("tzid")),this}utcOffset(a){if(this==tt.utcTimezone||this==tt.localTimezone||(this._ensureCoverage(a.year),!this.changes.length))return 0;let s={year:a.year,month:a.month,day:a.day,hour:a.hour,minute:a.minute,second:a.second},r=this._findNearbyChange(s),l=-1,o=1;for(;;){let m=ho(this.changes[r],!0);if(m.utcOffset<m.prevUtcOffset?tt.adjust_change(m,0,0,0,m.utcOffset):tt.adjust_change(m,0,0,0,m.prevUtcOffset),tt._compare_change_fn(s,m)>=0?l=r:o=-1,o==-1&&l!=-1)break;if(r+=o,r<0)return 0;if(r>=this.changes.length)break}let d=this.changes[l];if(d.utcOffset-d.prevUtcOffset<0&&l>0){let m=ho(d,!0);if(tt.adjust_change(m,0,0,0,m.prevUtcOffset),tt._compare_change_fn(s,m)<0){let h=this.changes[l-1],g=!1;d.is_daylight!=g&&h.is_daylight==g&&(d=h)}}return d.utcOffset}_findNearbyChange(a){let s=Jl(this.changes,a,tt._compare_change_fn);return s>=this.changes.length?this.changes.length-1:s}_ensureCoverage(a){if(tt._minimumExpansionYear==-1){let r=De.now();tt._minimumExpansionYear=r.year}let s=a;if(s<tt._minimumExpansionYear&&(s=tt._minimumExpansionYear),s+=tt.EXTRA_COVERAGE,!this.changes.length||this.expandedUntilYear<a){let r=this.component.getAllSubcomponents(),l=r.length,o=0;for(;o<l;o++)this._expandComponent(r[o],s,this.changes);this.changes.sort(tt._compare_change_fn),this.expandedUntilYear=s}}_expandComponent(a,s,r){if(!a.hasProperty("dtstart")||!a.hasProperty("tzoffsetto")||!a.hasProperty("tzoffsetfrom"))return null;let l=a.getFirstProperty("dtstart").getFirstValue(),o;function d(m){return m.factor*(m.hours*3600+m.minutes*60)}function u(){let m={};return m.is_daylight=a.name=="daylight",m.utcOffset=d(a.getFirstProperty("tzoffsetto").getFirstValue()),m.prevUtcOffset=d(a.getFirstProperty("tzoffsetfrom").getFirstValue()),m}if(!a.hasProperty("rrule")&&!a.hasProperty("rdate"))o=u(),o.year=l.year,o.month=l.month,o.day=l.day,o.hour=l.hour,o.minute=l.minute,o.second=l.second,tt.adjust_change(o,0,0,0,-o.prevUtcOffset),r.push(o);else{let m=a.getAllProperties("rdate");for(let g of m){let x=g.getFirstValue();o=u(),o.year=x.year,o.month=x.month,o.day=x.day,x.isDate?(o.hour=l.hour,o.minute=l.minute,o.second=l.second,l.zone!=tt.utcTimezone&&tt.adjust_change(o,0,0,0,-o.prevUtcOffset)):(o.hour=x.hour,o.minute=x.minute,o.second=x.second,x.zone!=tt.utcTimezone&&tt.adjust_change(o,0,0,0,-o.prevUtcOffset)),r.push(o)}let h=a.getFirstProperty("rrule");if(h){h=h.getFirstValue(),o=u(),h.until&&h.until.zone==tt.utcTimezone&&(h.until.adjust(0,0,0,o.prevUtcOffset),h.until.zone=tt.localTimezone);let g=h.iterator(l),x;for(;(x=g.next())&&(o=u(),!(x.year>s||!x));)o.year=x.year,o.month=x.month,o.day=x.day,o.hour=x.hour,o.minute=x.minute,o.second=x.second,o.isDate=x.isDate,tt.adjust_change(o,0,0,0,-o.prevUtcOffset),r.push(o)}}return r}toString(){return this.tznames?this.tznames:this.tzid}}let Is=null;const lf={get count(){return Is===null?0:Object.keys(Is).length},reset:function(){Is=Object.create(null);let t=tt.utcTimezone;Is.Z=t,Is.UTC=t,Is.GMT=t},_hard_reset:function(){Is=null},has:function(t){return Is===null?!1:!!Is[t]},get:function(t){return Is===null&&this.reset(),Is[t]},register:function(t,a){if(Is===null&&this.reset(),typeof t=="string"&&a instanceof tt&&([t,a]=[a,t]),a||(t instanceof tt?a=t.tzid:t.name==="vtimezone"&&(t=new tt(t),a=t.tzid)),!a)throw new TypeError("Neither a timezone nor a name was passed");if(t instanceof tt)Is[a]=t;else throw new TypeError("timezone must be ICAL.Timezone or ICAL.Component")},remove:function(t){return Is===null?null:delete Is[t]}};function A$(t){let a,s,r,l,o;if(!t||t.name!=="vcalendar")return t;for(a=t.getAllSubcomponents(),s=[],r={},o=0;o<a.length;o++)if(a[o].name==="vtimezone"){let d=a[o].getFirstProperty("tzid").getFirstValue();r[d]=a[o]}else s=s.concat(a[o].getAllProperties());for(l={},o=0;o<s.length;o++){let d=s[o].getParameter("tzid");d&&(l[d]=!0)}for(let[d,u]of Object.entries(r))l[d]||t.removeSubcomponent(u);for(let d of Object.keys(l))!r[d]&&lf.has(d)&&t.addSubcomponent(lf.get(d).component);return t}function vu(t){return typeof t=="number"&&isNaN(t)}function Es(t){let a=parseInt(t,10);if(vu(a))throw new Error('Could not extract integer from "'+t+'"');return a}function di(t,a){if(!(typeof t>"u"))return t instanceof a?t:new a(t)}function A2(t,a,s){for(;(s=t.indexOf(a,s))!==-1;)if(s>0&&t[s-1]==="\\")s+=1;else return s;return-1}function Jl(t,a,s){if(!t.length)return 0;let r=0,l=t.length-1,o,d;for(;r<=l;)if(o=r+Math.floor((l-r)/2),d=s(a,t[o]),d<0)l=o-1;else if(d>0)r=o+1;else break;return d<0?o:d>0?o+1:o}function ho(t,a){if(!t||typeof t!="object")return t;if(t instanceof Date)return new Date(t.getTime());if("clone"in t)return t.clone();if(Array.isArray(t)){let s=[];for(let r=0;r<t.length;r++)s.push(a?ho(t[r],!0):t[r]);return s}else{let s={};for(let[r,l]of Object.entries(t))a?s[r]=ho(l,!0):s[r]=l;return s}}function _2(t){let a="",s=t||"",r=0,l=0;for(;s.length;){let o=s.codePointAt(r);o<128?++l:o<2048?l+=2:o<65536?l+=3:l+=4,l<oc.foldLength+1?r+=o>65535?2:1:(a+=oc.newLineChar+" "+s.slice(0,Math.max(0,r)),s=s.slice(Math.max(0,r)),r=l=0)}return a.slice(oc.newLineChar.length+1)}function en(t){switch(typeof t!="string"&&(typeof t=="number"&&(t=parseInt(t)),t=String(t)),t.length){case 0:return"00";case 1:return"0"+t;default:return t}}function us(t){return t<0?Math.ceil(t):Math.floor(t)}function go(t,a){for(let s in t){let r=Object.getOwnPropertyDescriptor(t,s);r&&!Object.getOwnPropertyDescriptor(a,s)&&Object.defineProperty(a,s,r)}return a}var _$=Object.freeze({__proto__:null,binsearchInsert:Jl,clone:ho,extend:go,foldline:_2,formatClassType:di,isStrictlyNaN:vu,pad2:en,strictParseInt:Es,trunc:us,unescapedIndexOf:A2,updateTimezones:A$});class nr{static fromString(a){let s={};return s.factor=a[0]==="+"?1:-1,s.hours=Es(a.slice(1,3)),s.minutes=Es(a.slice(4,6)),new nr(s)}static fromSeconds(a){let s=new nr;return s.fromSeconds(a),s}constructor(a){this.fromData(a)}hours=0;minutes=0;factor=1;icaltype="utc-offset";clone(){return nr.fromSeconds(this.toSeconds())}fromData(a){if(a)for(let[s,r]of Object.entries(a))this[s]=r;this._normalize()}fromSeconds(a){let s=Math.abs(a);return this.factor=a<0?-1:1,this.hours=us(s/3600),s-=this.hours*3600,this.minutes=us(s/60),this}toSeconds(){return this.factor*(60*this.minutes+3600*this.hours)}compare(a){let s=this.toSeconds(),r=a.toSeconds();return(s>r)-(r>s)}_normalize(){let a=this.toSeconds(),s=this.factor;for(;a<-43200;)a+=97200;for(;a>50400;)a-=97200;this.fromSeconds(a),a==0&&(this.factor=s)}toICALString(){return qa.icalendar.value["utc-offset"].toICAL(this.toString())}toString(){return(this.factor==1?"+":"-")+en(this.hours)+":"+en(this.minutes)}}class cl extends De{static fromDateAndOrTimeString(a,s){function r(N,S,w){return N?Es(N.slice(S,S+w)):null}let l=a.split("T"),o=l[0],d=l[1],u=d?qa.vcard.value.time._splitZone(d):[],m=u[0],h=u[1],g=o?o.length:0,x=h?h.length:0,y=o&&o[0]=="-"&&o[1]=="-",v=h&&h[0]=="-",b={year:y?null:r(o,0,4),month:y&&(g==4||g==7)?r(o,2,2):g==7||g==10?r(o,5,2):null,day:g==5?r(o,3,2):g==7&&y?r(o,5,2):g==10?r(o,8,2):null,hour:v?null:r(h,0,2),minute:v&&x==3?r(h,1,2):x>4?v?r(h,1,2):r(h,3,2):null,second:x==4?r(h,2,2):x==6?r(h,4,2):x==8?r(h,6,2):null};return m=="Z"?m=tt.utcTimezone:m&&m[3]==":"?m=nr.fromString(m):m=null,new cl(b,m,s)}constructor(a,s,r){super(a,s),this.icaltype=r||"date-and-or-time"}icalclass="vcardtime";icaltype="date-and-or-time";clone(){return new cl(this._time,this.zone,this.icaltype)}_normalize(){return this}utcOffset(){return this.zone instanceof nr?this.zone.toSeconds():De.prototype.utcOffset.apply(this,arguments)}toICALString(){return qa.vcard.value[this.icaltype].toICAL(this.toString())}toString(){let a=this.year,s=this.month,r=this.day,l=this.hour,o=this.minute,d=this.second,u=a!==null,m=s!==null,h=r!==null,g=l!==null,x=o!==null,y=d!==null,v=(u?en(a)+(m||h?"-":""):m||h?"--":"")+(m?en(s):"")+(h?"-"+en(r):""),b=(g?en(l):"-")+(g&&x?":":"")+(x?en(o):"")+(!g&&!x?"-":"")+(x&&y?":":"")+(y?en(d):""),N;switch(this.zone===tt.utcTimezone?N="Z":this.zone instanceof nr?N=this.zone.toString():this.zone===tt.localTimezone?N="":this.zone instanceof tt?N=nr.fromSeconds(this.zone.utcOffset(this)).toString():N="",this.icaltype){case"time":return b+N;case"date-and-or-time":case"date-time":return v+(b=="--"?"":"T"+b+N);case"date":return v}return null}}class Tr{static _indexMap={BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8};static _expandMap={SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]};static UNKNOWN=0;static CONTRACT=1;static EXPAND=2;static ILLEGAL=3;constructor(a){this.fromData(a)}completed=!1;rule=null;dtstart=null;last=null;occurrence_number=0;by_indices=null;initialized=!1;by_data=null;days=null;days_index=0;fromData(a){if(this.rule=di(a.rule,Ds),!this.rule)throw new Error("iterator requires a (ICAL.Recur) rule");if(this.dtstart=di(a.dtstart,De),!this.dtstart)throw new Error("iterator requires a (ICAL.Time) dtstart");if(a.by_data?this.by_data=a.by_data:this.by_data=ho(this.rule.parts,!0),a.occurrence_number&&(this.occurrence_number=a.occurrence_number),this.days=a.days||[],a.last&&(this.last=di(a.last,De)),this.by_indices=a.by_indices,this.by_indices||(this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}),this.initialized=a.initialized||!1,!this.initialized)try{this.init()}catch(s){if(s instanceof fh)this.completed=!0;else throw s}}init(){this.initialized=!0,this.last=this.dtstart.clone();let a=this.by_data;if("BYDAY"in a&&this.sort_byday_rules(a.BYDAY),"BYYEARDAY"in a&&("BYMONTH"in a||"BYWEEKNO"in a||"BYMONTHDAY"in a))throw new Error("Invalid BYYEARDAY rule");if("BYWEEKNO"in a&&"BYMONTHDAY"in a)throw new Error("BYWEEKNO does not fit to BYMONTHDAY");if(this.rule.freq=="MONTHLY"&&("BYYEARDAY"in a||"BYWEEKNO"in a))throw new Error("For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear");if(this.rule.freq=="WEEKLY"&&("BYYEARDAY"in a||"BYMONTHDAY"in a))throw new Error("For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear");if(this.rule.freq!="YEARLY"&&"BYYEARDAY"in a)throw new Error("BYYEARDAY may only appear in YEARLY rules");if(this.last.second=this.setup_defaults("BYSECOND","SECONDLY",this.dtstart.second),this.last.minute=this.setup_defaults("BYMINUTE","MINUTELY",this.dtstart.minute),this.last.hour=this.setup_defaults("BYHOUR","HOURLY",this.dtstart.hour),this.last.day=this.setup_defaults("BYMONTHDAY","DAILY",this.dtstart.day),this.last.month=this.setup_defaults("BYMONTH","MONTHLY",this.dtstart.month),this.rule.freq=="WEEKLY")if("BYDAY"in a){let[,s]=this.ruleDayOfWeek(a.BYDAY[0],this.rule.wkst),r=s-this.last.dayOfWeek(this.rule.wkst);(this.last.dayOfWeek(this.rule.wkst)<s&&r>=0||r<0)&&(this.last.day+=r)}else{let s=Ds.numericDayToIcalDay(this.dtstart.dayOfWeek());a.BYDAY=[s]}if(this.rule.freq=="YEARLY"){const s=this.rule.until?this.rule.until.year:2e4;for(;this.last.year<=s&&(this.expand_year_days(this.last.year),!(this.days.length>0));)this.increment_year(this.rule.interval);if(this.days.length==0)throw new fh;if(!this._nextByYearDay()&&!this.next_year()&&!this.next_year()&&!this.next_year())throw new fh}if(this.rule.freq=="MONTHLY"){if(this.has_by_data("BYDAY")){let s=null,r=this.last.clone(),l=De.daysInMonth(this.last.month,this.last.year);for(let o of this.by_data.BYDAY){this.last=r.clone();let[d,u]=this.ruleDayOfWeek(o),m=this.last.nthWeekDay(u,d);if(d>=6||d<=-6)throw new Error("Malformed values in BYDAY part");if(m>l||m<=0){if(s&&s.month==r.month)continue;for(;m>l||m<=0;)this.increment_month(),l=De.daysInMonth(this.last.month,this.last.year),m=this.last.nthWeekDay(u,d)}this.last.day=m,(!s||this.last.compare(s)<0)&&(s=this.last.clone())}if(this.last=s.clone(),this.has_by_data("BYMONTHDAY")&&this._byDayAndMonthDay(!0),this.last.day>l||this.last.day==0)throw new Error("Malformed values in BYDAY part")}else if(this.has_by_data("BYMONTHDAY")){this.last.day=1;let s=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY).filter(r=>r>=this.last.day);if(s.length)this.last.day=s[0],this.by_data.BYMONTHDAY=s;else if(!this.next_month()&&!this.next_month()&&!this.next_month())throw new fh}}}next(a=!1){let s=this.last?this.last.clone():null;if((this.rule.count&&this.occurrence_number>=this.rule.count||this.rule.until&&this.last.compare(this.rule.until)>0)&&(this.completed=!0),this.completed)return null;if(this.occurrence_number==0&&this.last.compare(this.dtstart)>=0)return this.occurrence_number++,this.last;let r,l=0;do switch(r=1,this.rule.freq){case"SECONDLY":this.next_second();break;case"MINUTELY":this.next_minute();break;case"HOURLY":this.next_hour();break;case"DAILY":this.next_day();break;case"WEEKLY":this.next_week();break;case"MONTHLY":if(r=this.next_month(),r)l=0;else if(++l==336)return this.completed=!0,null;break;case"YEARLY":if(r=this.next_year(),r)l=0;else if(++l==28)return this.completed=!0,null;break;default:return null}while(!this.check_contracting_rules()||this.last.compare(this.dtstart)<0||!r);if(this.last.compare(s)==0){if(a)throw new Error("Same occurrence found twice, protecting you from death by recursion");this.next(!0)}return this.rule.until&&this.last.compare(this.rule.until)>0?(this.completed=!0,null):(this.occurrence_number++,this.last)}next_second(){return this.next_generic("BYSECOND","SECONDLY","second","minute")}increment_second(a){return this.increment_generic(a,"second",60,"minute")}next_minute(){return this.next_generic("BYMINUTE","MINUTELY","minute","hour","next_second")}increment_minute(a){return this.increment_generic(a,"minute",60,"hour")}next_hour(){return this.next_generic("BYHOUR","HOURLY","hour","monthday","next_minute")}increment_hour(a){this.increment_generic(a,"hour",24,"monthday")}next_day(){let a=this.rule.freq=="DAILY";return this.next_hour()==0||(a?this.increment_monthday(this.rule.interval):this.increment_monthday(1)),0}next_week(){let a=0;if(this.next_weekday_by_week()==0)return a;if(this.has_by_data("BYWEEKNO")){this.by_indices.BYWEEKNO++,this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length&&(this.by_indices.BYWEEKNO=0,a=1),this.last.month=1,this.last.day=1;let s=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*s,a&&this.increment_year(1)}else this.increment_monthday(7*this.rule.interval);return a}normalizeByMonthDayRules(a,s,r){let l=De.daysInMonth(s,a),o=[],d=0,u=r.length,m;for(;d<u;d++){if(m=parseInt(r[d],10),isNaN(m))throw new Error("Invalid BYMONTHDAY value");if(!(Math.abs(m)>l)){if(m<0)m=l+(m+1);else if(m===0)continue;o.indexOf(m)===-1&&o.push(m)}}return o.sort(function(h,g){return h-g})}_byDayAndMonthDay(a){let s,r=this.by_data.BYDAY,l,o=0,d,u=r.length,m=0,h,g=this,x=this.last.day;function y(){for(h=De.daysInMonth(g.last.month,g.last.year),s=g.normalizeByMonthDayRules(g.last.year,g.last.month,g.by_data.BYMONTHDAY),d=s.length;s[o]<=x&&!(a&&s[o]==x)&&o<d-1;)o++}function v(){x=0,g.increment_month(),o=0,y()}y(),a&&(x-=1);let b=48;for(;!m&&b;){if(b--,l=x+1,l>h){v();continue}let N=s[o++];if(N>=l)x=N;else{v();continue}for(let S=0;S<u;S++){let w=this.ruleDayOfWeek(r[S]),E=w[0],T=w[1];if(this.last.day=x,this.last.isNthWeekDay(T,E)){m=1;break}}if(!m&&o===d){v();continue}}if(b<=0)throw new Error("Malformed values in BYDAY combined with BYMONTHDAY parts");return m}next_month(){let a=1;if(this.next_hour()==0)return a;if(this.has_by_data("BYDAY")&&this.has_by_data("BYMONTHDAY"))a=this._byDayAndMonthDay();else if(this.has_by_data("BYDAY")){let s=De.daysInMonth(this.last.month,this.last.year),r=0,l=0;if(this.has_by_data("BYSETPOS")){let d=this.last.day;for(let u=1;u<=s;u++)this.last.day=u,this.is_day_in_byday(this.last)&&(l++,u<=d&&r++);this.last.day=d}a=0;let o;for(o=this.last.day+1;o<=s;o++)if(this.last.day=o,this.is_day_in_byday(this.last)&&(!this.has_by_data("BYSETPOS")||this.check_set_position(++r)||this.check_set_position(r-l-1))){a=1;break}o>s&&(this.last.day=1,this.increment_month(),this.is_day_in_byday(this.last)?(!this.has_by_data("BYSETPOS")||this.check_set_position(1))&&(a=1):a=0)}else if(this.has_by_data("BYMONTHDAY")){if(this.by_indices.BYMONTHDAY++,this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length&&(this.by_indices.BYMONTHDAY=0,this.increment_month(),this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length))return 0;let s=De.daysInMonth(this.last.month,this.last.year),r=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];r<0&&(r=s+r+1),r>s?(this.last.day=1,a=this.is_day_in_byday(this.last)):this.last.day=r}else{this.increment_month();let s=De.daysInMonth(this.last.month,this.last.year);this.by_data.BYMONTHDAY[0]>s?a=0:this.last.day=this.by_data.BYMONTHDAY[0]}return a}next_weekday_by_week(){let a=0;if(this.next_hour()==0)return a;if(!this.has_by_data("BYDAY"))return 1;for(;;){let s=new De;this.by_indices.BYDAY++,this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length&&(this.by_indices.BYDAY=0,a=1);let r=this.by_data.BYDAY[this.by_indices.BYDAY],o=this.ruleDayOfWeek(r)[1];o-=this.rule.wkst,o<0&&(o+=7),s.year=this.last.year,s.month=this.last.month,s.day=this.last.day;let d=s.startDoyWeek(this.rule.wkst);if(o+d<1&&!a)continue;let u=De.fromDayOfYear(d+o,this.last.year);return this.last.year=u.year,this.last.month=u.month,this.last.day=u.day,a}}next_year(){return this.next_hour()==0||(this.days.length==0||++this.days_index==this.days.length)&&(this.days_index=0,this.increment_year(this.rule.interval),this.has_by_data("BYMONTHDAY")&&(this.by_data.BYMONTHDAY=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY)),this.expand_year_days(this.last.year),this.days.length==0)?0:this._nextByYearDay()}_nextByYearDay(){let a=this.days[this.days_index],s=this.last.year;if(Math.abs(a)==366&&!De.isLeapYear(this.last.year))return 0;a<1&&(a+=1,s+=1);let r=De.fromDayOfYear(a,s);return this.last.day=r.day,this.last.month=r.month,1}ruleDayOfWeek(a,s){let r=a.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);if(r){let l=parseInt(r[1]||0,10);return a=Ds.icalDayToNumericDay(r[2],s),[l,a]}else return[0,0]}next_generic(a,s,r,l,o){let d=a in this.by_data,u=this.rule.freq==s,m=0;if(o&&this[o]()==0)return m;if(d){this.by_indices[a]++;let h=this.by_data[a];this.by_indices[a]==h.length&&(this.by_indices[a]=0,m=1),this.last[r]=h[this.by_indices[a]]}else u&&this["increment_"+r](this.rule.interval);return d&&m&&u&&this["increment_"+l](1),m}increment_monthday(a){for(let s=0;s<a;s++){let r=De.daysInMonth(this.last.month,this.last.year);this.last.day++,this.last.day>r&&(this.last.day-=r,this.increment_month())}}increment_month(){if(this.last.day=1,this.has_by_data("BYMONTH"))this.by_indices.BYMONTH++,this.by_indices.BYMONTH==this.by_data.BYMONTH.length&&(this.by_indices.BYMONTH=0,this.increment_year(1)),this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH];else{this.rule.freq=="MONTHLY"?this.last.month+=this.rule.interval:this.last.month++,this.last.month--;let a=us(this.last.month/12);this.last.month%=12,this.last.month++,a!=0&&this.increment_year(a)}this.has_by_data("BYMONTHDAY")&&(this.by_data.BYMONTHDAY=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY))}increment_year(a){this.last.day=1,this.last.year+=a}increment_generic(a,s,r,l){this.last[s]+=a;let o=us(this.last[s]/r);this.last[s]%=r,o!=0&&this["increment_"+l](o)}has_by_data(a){return a in this.rule.parts}expand_year_days(a){let s=new De;this.days=[];let r={},l=["BYDAY","BYWEEKNO","BYMONTHDAY","BYMONTH","BYYEARDAY"];for(let u of l)u in this.rule.parts&&(r[u]=this.rule.parts[u]);if("BYMONTH"in r&&"BYWEEKNO"in r){let u=1,m={};s.year=a,s.isDate=!0;for(let h=0;h<this.by_data.BYMONTH.length;h++){let g=this.by_data.BYMONTH[h];s.month=g,s.day=1;let x=s.weekNumber(this.rule.wkst);s.day=De.daysInMonth(g,a);let y=s.weekNumber(this.rule.wkst);for(h=x;h<y;h++)m[h]=1}for(let h=0;h<this.by_data.BYWEEKNO.length&&u;h++)this.by_data.BYWEEKNO[h]<52?u&=m[h]:u=0;u?delete r.BYMONTH:delete r.BYWEEKNO}let o=Object.keys(r).length;if(o==0){let u=this.dtstart.clone();u.year=this.last.year,this.days.push(u.dayOfYear())}else if(o==1&&"BYMONTH"in r)for(let u of this.by_data.BYMONTH){let m=this.dtstart.clone();m.year=a,m.month=u,m.isDate=!0,this.days.push(m.dayOfYear())}else if(o==1&&"BYMONTHDAY"in r)for(let u of this.by_data.BYMONTHDAY){let m=this.dtstart.clone();if(u<0){let h=De.daysInMonth(m.month,a);u=u+h+1}m.day=u,m.year=a,m.isDate=!0,this.days.push(m.dayOfYear())}else if(o==2&&"BYMONTHDAY"in r&&"BYMONTH"in r)for(let u of this.by_data.BYMONTH){let m=De.daysInMonth(u,a);for(let h of this.by_data.BYMONTHDAY)h<0&&(h=h+m+1),s.day=h,s.month=u,s.year=a,s.isDate=!0,this.days.push(s.dayOfYear())}else if(!(o==1&&"BYWEEKNO"in r)){if(!(o==2&&"BYWEEKNO"in r&&"BYMONTHDAY"in r)){if(o==1&&"BYDAY"in r)this.days=this.days.concat(this.expand_by_day(a));else if(o==2&&"BYDAY"in r&&"BYMONTH"in r){for(let u of this.by_data.BYMONTH){let m=De.daysInMonth(u,a);s.year=a,s.month=u,s.day=1,s.isDate=!0;let h=s.dayOfWeek(),g=s.dayOfYear()-1;s.day=m;let x=s.dayOfWeek();if(this.has_by_data("BYSETPOS")){let y=[];for(let v=1;v<=m;v++)s.day=v,this.is_day_in_byday(s)&&y.push(v);for(let v=0;v<y.length;v++)(this.check_set_position(v+1)||this.check_set_position(v-y.length))&&this.days.push(g+y[v])}else for(let y of this.by_data.BYDAY){let v=this.ruleDayOfWeek(y),b=v[0],N=v[1],S,w=(N+7-h)%7+1,E=m-(x+7-N)%7;if(b==0)for(let T=w;T<=m;T+=7)this.days.push(g+T);else b>0?(S=w+(b-1)*7,S<=m&&this.days.push(g+S)):(S=E+(b+1)*7,S>0&&this.days.push(g+S))}}this.days.sort(function(u,m){return u-m})}else if(o==2&&"BYDAY"in r&&"BYMONTHDAY"in r){let u=this.expand_by_day(a);for(let m of u){let h=De.fromDayOfYear(m,a);this.by_data.BYMONTHDAY.indexOf(h.day)>=0&&this.days.push(m)}}else if(o==3&&"BYDAY"in r&&"BYMONTHDAY"in r&&"BYMONTH"in r){let u=this.expand_by_day(a);for(let m of u){let h=De.fromDayOfYear(m,a);this.by_data.BYMONTH.indexOf(h.month)>=0&&this.by_data.BYMONTHDAY.indexOf(h.day)>=0&&this.days.push(m)}}else if(o==2&&"BYDAY"in r&&"BYWEEKNO"in r){let u=this.expand_by_day(a);for(let m of u){let g=De.fromDayOfYear(m,a).weekNumber(this.rule.wkst);this.by_data.BYWEEKNO.indexOf(g)&&this.days.push(m)}}else if(!(o==3&&"BYDAY"in r&&"BYWEEKNO"in r&&"BYMONTHDAY"in r))if(o==1&&"BYYEARDAY"in r)this.days=this.days.concat(this.by_data.BYYEARDAY);else if(o==2&&"BYYEARDAY"in r&&"BYDAY"in r){let u=De.isLeapYear(a)?366:365,m=new Set(this.expand_by_day(a));for(let h of this.by_data.BYYEARDAY)h<0&&(h+=u+1),m.has(h)&&this.days.push(h)}else this.days=[]}}let d=De.isLeapYear(a)?366:365;return this.days.sort((u,m)=>(u<0&&(u+=d+1),m<0&&(m+=d+1),u-m)),0}expand_by_day(a){let s=[],r=this.last.clone();r.year=a,r.month=1,r.day=1,r.isDate=!0;let l=r.dayOfWeek();r.month=12,r.day=31,r.isDate=!0;let o=r.dayOfWeek(),d=r.dayOfYear();for(let u of this.by_data.BYDAY){let m=this.ruleDayOfWeek(u),h=m[0],g=m[1];if(h==0){let x=(g+7-l)%7+1;for(let y=x;y<=d;y+=7)s.push(y)}else if(h>0){let x;g>=l?x=g-l+1:x=g-l+8,s.push(x+(h-1)*7)}else{let x;h=-h,g<=o?x=d-o+g:x=d-o+g-7,s.push(x-(h-1)*7)}}return s}is_day_in_byday(a){if(this.by_data.BYDAY)for(let s of this.by_data.BYDAY){let r=this.ruleDayOfWeek(s),l=r[0],o=r[1],d=a.dayOfWeek();if(l==0&&o==d||a.nthWeekDay(o,l)==a.day)return 1}return 0}check_set_position(a){return this.has_by_data("BYSETPOS")?this.by_data.BYSETPOS.indexOf(a)!==-1:!1}sort_byday_rules(a){for(let s=0;s<a.length;s++)for(let r=0;r<s;r++){let l=this.ruleDayOfWeek(a[r],this.rule.wkst)[1],o=this.ruleDayOfWeek(a[s],this.rule.wkst)[1];if(l>o){let d=a[s];a[s]=a[r],a[r]=d}}}check_contract_restriction(a,s){let r=Tr._indexMap[a],l=Tr._expandMap[this.rule.freq][r],o=!1;if(a in this.by_data&&l==Tr.CONTRACT){let d=this.by_data[a];for(let u of d)if(u==s){o=!0;break}}else o=!0;return o}check_contracting_rules(){let a=this.last.dayOfWeek(),s=this.last.weekNumber(this.rule.wkst),r=this.last.dayOfYear();return this.check_contract_restriction("BYSECOND",this.last.second)&&this.check_contract_restriction("BYMINUTE",this.last.minute)&&this.check_contract_restriction("BYHOUR",this.last.hour)&&this.check_contract_restriction("BYDAY",Ds.numericDayToIcalDay(a))&&this.check_contract_restriction("BYWEEKNO",s)&&this.check_contract_restriction("BYMONTHDAY",this.last.day)&&this.check_contract_restriction("BYMONTH",this.last.month)&&this.check_contract_restriction("BYYEARDAY",r)}setup_defaults(a,s,r){let l=Tr._indexMap[a];return Tr._expandMap[this.rule.freq][l]!=Tr.CONTRACT&&(a in this.by_data||(this.by_data[a]=[r]),this.rule.freq!=s)?this.by_data[a][0]:r}toJSON(){let a=Object.create(null);return a.initialized=this.initialized,a.rule=this.rule.toJSON(),a.dtstart=this.dtstart.toJSON(),a.by_data=this.by_data,a.days=this.days,a.last=this.last.toJSON(),a.by_indices=this.by_indices,a.occurrence_number=this.occurrence_number,a}}class fh extends Error{constructor(){super("Recurrence rule has no valid occurrences")}}const M$=/^(SU|MO|TU|WE|TH|FR|SA)$/,O$=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/,M2={SU:De.SUNDAY,MO:De.MONDAY,TU:De.TUESDAY,WE:De.WEDNESDAY,TH:De.THURSDAY,FR:De.FRIDAY,SA:De.SATURDAY},R$=Object.fromEntries(Object.entries(M2).map(t=>t.reverse())),ES=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"];class Ds{static fromString(a){let s=this._stringToData(a,!1);return new Ds(s)}static fromData(a){return new Ds(a)}static _stringToData(a,s){let r=Object.create(null),l=a.split(";"),o=l.length;for(let d=0;d<o;d++){let u=l[d].split("="),m=u[0].toUpperCase(),h=u[0].toLowerCase(),g=s?h:m,x=u[1];if(m in Lg){let y=x.split(","),v=new Set;for(let b of y)v.add(Lg[m](b));y=[...v],r[g]=y.length==1?y[0]:y}else m in zg?zg[m](x,r,s):r[h]=x}return r}static icalDayToNumericDay(a,s){let r=s||De.SUNDAY;return(M2[a]-r+7)%7+1}static numericDayToIcalDay(a,s){let r=s||De.SUNDAY,l=a+r-De.SUNDAY;return l>7&&(l-=7),R$[l]}constructor(a){this.wrappedJSObject=this,this.parts={},a&&typeof a=="object"&&this.fromData(a)}parts=null;interval=1;wkst=De.MONDAY;until=null;count=null;freq=null;icalclass="icalrecur";icaltype="recur";iterator(a){return new Tr({rule:this,dtstart:a})}clone(){return new Ds(this.toJSON())}isFinite(){return!!(this.count||this.until)}isByCount(){return!!(this.count&&!this.until)}addComponent(a,s){let r=a.toUpperCase();r in this.parts?this.parts[r].push(s):this.parts[r]=[s]}setComponent(a,s){this.parts[a.toUpperCase()]=s.slice()}getComponent(a){let s=a.toUpperCase();return s in this.parts?this.parts[s].slice():[]}getNextOccurrence(a,s){let r=this.iterator(a),l;do l=r.next();while(l&&l.compare(s)<=0);return l&&s.zone&&(l.zone=s.zone),l}fromData(a){for(let s in a){let r=s.toUpperCase();r in Lg?Array.isArray(a[s])?this.parts[r]=a[s]:this.parts[r]=[a[s]]:this[s]=a[s]}this.interval&&typeof this.interval!="number"&&zg.INTERVAL(this.interval,this),this.wkst&&typeof this.wkst!="number"&&(this.wkst=Ds.icalDayToNumericDay(this.wkst)),this.until&&!(this.until instanceof De)&&(this.until=De.fromString(this.until))}toJSON(){let a=Object.create(null);a.freq=this.freq,this.count&&(a.count=this.count),this.interval>1&&(a.interval=this.interval);for(let[s,r]of Object.entries(this.parts))Array.isArray(r)&&r.length==1?a[s.toLowerCase()]=r[0]:a[s.toLowerCase()]=ho(r);return this.until&&(a.until=this.until.toString()),"wkst"in this&&this.wkst!==De.DEFAULT_WEEK_START&&(a.wkst=Ds.numericDayToIcalDay(this.wkst)),a}toString(){let a="FREQ="+this.freq;this.count&&(a+=";COUNT="+this.count),this.interval>1&&(a+=";INTERVAL="+this.interval);for(let[s,r]of Object.entries(this.parts))a+=";"+s+"="+r;return this.until&&(a+=";UNTIL="+this.until.toICALString()),"wkst"in this&&this.wkst!==De.DEFAULT_WEEK_START&&(a+=";WKST="+Ds.numericDayToIcalDay(this.wkst)),a}}function Zi(t,a,s,r){let l=r;if(r[0]==="+"&&(l=r.slice(1)),l=Es(l),a!==void 0&&r<a)throw new Error(t+': invalid value "'+r+'" must be > '+a);if(s!==void 0&&r>s)throw new Error(t+': invalid value "'+r+'" must be < '+a);return l}const zg={FREQ:function(t,a,s){if(ES.indexOf(t)!==-1)a.freq=t;else throw new Error('invalid frequency "'+t+'" expected: "'+ES.join(", ")+'"')},COUNT:function(t,a,s){a.count=Es(t)},INTERVAL:function(t,a,s){a.interval=Es(t),a.interval<1&&(a.interval=1)},UNTIL:function(t,a,s){t.length>10?a.until=qa.icalendar.value["date-time"].fromICAL(t):a.until=qa.icalendar.value.date.fromICAL(t),s||(a.until=De.fromString(a.until))},WKST:function(t,a,s){if(M$.test(t))a.wkst=Ds.icalDayToNumericDay(t);else throw new Error('invalid WKST value "'+t+'"')}},Lg={BYSECOND:Zi.bind(void 0,"BYSECOND",0,60),BYMINUTE:Zi.bind(void 0,"BYMINUTE",0,59),BYHOUR:Zi.bind(void 0,"BYHOUR",0,23),BYDAY:function(t){if(O$.test(t))return t;throw new Error('invalid BYDAY value "'+t+'"')},BYMONTHDAY:Zi.bind(void 0,"BYMONTHDAY",-31,31),BYYEARDAY:Zi.bind(void 0,"BYYEARDAY",-366,366),BYWEEKNO:Zi.bind(void 0,"BYWEEKNO",-53,53),BYMONTH:Zi.bind(void 0,"BYMONTH",1,12),BYSETPOS:Zi.bind(void 0,"BYSETPOS",-366,366)},I$=/\\\\|\\;|\\,|\\[Nn]/g,z$=/\\|;|,|\n/g,TS=/\\\\|\\,|\\[Nn]/g,DS=/\\|,|\n/g;function B0(t,a){return{matches:/.*/,fromICAL:function(r,l){return P$(r,t,l)},toICAL:function(r,l){let o=a;return l&&(o=new RegExp(o.source+"|"+l,o.flags)),r.replace(o,function(d){switch(d){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case`
`:return"\\n";default:return d}})}}}const Qt={defaultType:"text"},bu={defaultType:"text",multiValue:","},of={defaultType:"text",structuredValue:";"},ph={defaultType:"integer"},xh={defaultType:"date-time",allowedTypes:["date-time","date"]},gh={defaultType:"date-time"},Qs={defaultType:"uri"},kS={defaultType:"utc-offset"},AS={defaultType:"recur"},_S={defaultType:"date-and-or-time",allowedTypes:["date-time","date","text"]};function L$(t){switch(t){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return`
`;default:return t}}function P$(t,a,s){return t.indexOf("\\")===-1?t:(s&&(a=new RegExp(a.source+"|\\\\"+s,a.flags)),t.replace(a,L$))}let av={categories:bu,url:Qs,version:Qt,uid:Qt},sv={boolean:{values:["TRUE","FALSE"],fromICAL:function(t){switch(t){case"TRUE":return!0;case"FALSE":return!1;default:return!1}},toICAL:function(t){return t?"TRUE":"FALSE"}},float:{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(t){let a=parseFloat(t);return vu(a)?0:a},toICAL:function(t){return String(t)}},integer:{fromICAL:function(t){let a=parseInt(t);return vu(a)?0:a},toICAL:function(t){return String(t)}},"utc-offset":{toICAL:function(t){return t.length<7?t.slice(0,3)+t.slice(4,6):t.slice(0,3)+t.slice(4,6)+t.slice(7,9)},fromICAL:function(t){return t.length<6?t.slice(0,3)+":"+t.slice(3,5):t.slice(0,3)+":"+t.slice(3,5)+":"+t.slice(5,7)},decorate:function(t){return nr.fromString(t)},undecorate:function(t){return t.toString()}}},B$={cutype:{values:["INDIVIDUAL","GROUP","RESOURCE","ROOM","UNKNOWN"],allowXName:!0,allowIanaToken:!0},"delegated-from":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},"delegated-to":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},encoding:{values:["8BIT","BASE64"]},fbtype:{values:["FREE","BUSY","BUSY-UNAVAILABLE","BUSY-TENTATIVE"],allowXName:!0,allowIanaToken:!0},member:{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},partstat:{values:["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN-PROCESS"],allowXName:!0,allowIanaToken:!0},range:{values:["THISANDFUTURE"]},related:{values:["START","END"]},reltype:{values:["PARENT","CHILD","SIBLING"],allowXName:!0,allowIanaToken:!0},role:{values:["REQ-PARTICIPANT","CHAIR","OPT-PARTICIPANT","NON-PARTICIPANT"],allowXName:!0,allowIanaToken:!0},rsvp:{values:["TRUE","FALSE"]},"sent-by":{valueType:"cal-address"},tzid:{matches:/^\//},value:{values:["binary","boolean","cal-address","date","date-time","duration","float","integer","period","recur","text","time","uri","utc-offset"],allowXName:!0,allowIanaToken:!0}};const Ls=go(sv,{text:B0(I$,z$),uri:{},binary:{decorate:function(t){return Kf.fromString(t)},undecorate:function(t){return t.toString()}},"cal-address":{},date:{decorate:function(t,a){return De.fromDateString(t,a)},undecorate:function(t){return t.toString()},fromICAL:function(t){return t.slice(0,4)+"-"+t.slice(4,6)+"-"+t.slice(6,8)},toICAL:function(t){let a=t.length;return a==10?t.slice(0,4)+t.slice(5,7)+t.slice(8,10):a>=19?Ls["date-time"].toICAL(t):t}},"date-time":{fromICAL:function(t){{let a=t.slice(0,4)+"-"+t.slice(4,6)+"-"+t.slice(6,8)+"T"+t.slice(9,11)+":"+t.slice(11,13)+":"+t.slice(13,15);return t[15]&&t[15]==="Z"&&(a+="Z"),a}},toICAL:function(t){if(t.length>=19){let s=t.slice(0,4)+t.slice(5,7)+t.slice(8,13)+t.slice(14,16)+t.slice(17,19);return t[19]&&t[19]==="Z"&&(s+="Z"),s}else return t},decorate:function(t,a){return De.fromDateTimeString(t,a)},undecorate:function(t){return t.toString()}},duration:{decorate:function(t){return ks.fromString(t)},undecorate:function(t){return t.toString()}},period:{fromICAL:function(t){let a=t.split("/");return a[0]=Ls["date-time"].fromICAL(a[0]),ks.isValueString(a[1])||(a[1]=Ls["date-time"].fromICAL(a[1])),a},toICAL:function(t){return t=t.slice(),t[0]=Ls["date-time"].toICAL(t[0]),ks.isValueString(t[1])||(t[1]=Ls["date-time"].toICAL(t[1])),t.join("/")},decorate:function(t,a){return ci.fromJSON(t,a,!1)},undecorate:function(t){return t.toJSON()}},recur:{fromICAL:function(t){return Ds._stringToData(t,!0)},toICAL:function(t){let a="";for(let[s,r]of Object.entries(t))s=="until"?r.length>10?r=Ls["date-time"].toICAL(r):r=Ls.date.toICAL(r):s=="wkst"?typeof r=="number"&&(r=Ds.numericDayToIcalDay(r)):Array.isArray(r)&&(r=r.join(",")),a+=s.toUpperCase()+"="+r+";";return a.slice(0,Math.max(0,a.length-1))},decorate:function(a){return Ds.fromData(a)},undecorate:function(t){return t.toJSON()}},time:{fromICAL:function(t){if(t.length<6)return t;let a=t.slice(0,2)+":"+t.slice(2,4)+":"+t.slice(4,6);return t[6]==="Z"&&(a+="Z"),a},toICAL:function(t){if(t.length<8)return t;let a=t.slice(0,2)+t.slice(3,5)+t.slice(6,8);return t[8]==="Z"&&(a+="Z"),a}}});let $$=go(av,{action:Qt,attach:{defaultType:"uri"},attendee:{defaultType:"cal-address"},calscale:Qt,class:Qt,comment:Qt,completed:gh,contact:Qt,created:gh,description:Qt,dtend:xh,dtstamp:gh,dtstart:xh,due:xh,duration:{defaultType:"duration"},exdate:{defaultType:"date-time",allowedTypes:["date-time","date"],multiValue:","},exrule:AS,freebusy:{defaultType:"period",multiValue:","},geo:{defaultType:"float",structuredValue:";"},"last-modified":gh,location:Qt,method:Qt,organizer:{defaultType:"cal-address"},"percent-complete":ph,priority:ph,prodid:Qt,"related-to":Qt,repeat:ph,rdate:{defaultType:"date-time",allowedTypes:["date-time","date","period"],multiValue:",",detectType:function(t){return t.indexOf("/")!==-1?"period":t.indexOf("T")===-1?"date":"date-time"}},"recurrence-id":xh,resources:bu,"request-status":of,rrule:AS,sequence:ph,status:Qt,summary:Qt,transp:Qt,trigger:{defaultType:"duration",allowedTypes:["duration","date-time"]},tzoffsetfrom:kS,tzoffsetto:kS,tzurl:Qs,tzid:Qt,tzname:Qt});const xn=go(sv,{text:B0(TS,DS),uri:B0(TS,DS),date:{decorate:function(t){return cl.fromDateAndOrTimeString(t,"date")},undecorate:function(t){return t.toString()},fromICAL:function(t){return t.length==8?Ls.date.fromICAL(t):t[0]=="-"&&t.length==6?t.slice(0,4)+"-"+t.slice(4):t},toICAL:function(t){return t.length==10?Ls.date.toICAL(t):t[0]=="-"&&t.length==7?t.slice(0,4)+t.slice(5):t}},time:{decorate:function(t){return cl.fromDateAndOrTimeString("T"+t,"time")},undecorate:function(t){return t.toString()},fromICAL:function(t){let a=xn.time._splitZone(t,!0),s=a[0],r=a[1];return r.length==6?r=r.slice(0,2)+":"+r.slice(2,4)+":"+r.slice(4,6):r.length==4&&r[0]!="-"?r=r.slice(0,2)+":"+r.slice(2,4):r.length==5&&(r=r.slice(0,3)+":"+r.slice(3,5)),s.length==5&&(s[0]=="-"||s[0]=="+")&&(s=s.slice(0,3)+":"+s.slice(3)),r+s},toICAL:function(t){let a=xn.time._splitZone(t),s=a[0],r=a[1];return r.length==8?r=r.slice(0,2)+r.slice(3,5)+r.slice(6,8):r.length==5&&r[0]!="-"?r=r.slice(0,2)+r.slice(3,5):r.length==6&&(r=r.slice(0,3)+r.slice(4,6)),s.length==6&&(s[0]=="-"||s[0]=="+")&&(s=s.slice(0,3)+s.slice(4)),r+s},_splitZone:function(t,a){let s=t.length-1,r=t.length-(a?5:6),l=t[r],o,d;return t[s]=="Z"?(o=t[s],d=t.slice(0,Math.max(0,s))):t.length>6&&(l=="-"||l=="+")?(o=t.slice(r),d=t.slice(0,Math.max(0,r))):(o="",d=t),[o,d]}},"date-time":{decorate:function(t){return cl.fromDateAndOrTimeString(t,"date-time")},undecorate:function(t){return t.toString()},fromICAL:function(t){return xn["date-and-or-time"].fromICAL(t)},toICAL:function(t){return xn["date-and-or-time"].toICAL(t)}},"date-and-or-time":{decorate:function(t){return cl.fromDateAndOrTimeString(t,"date-and-or-time")},undecorate:function(t){return t.toString()},fromICAL:function(t){let a=t.split("T");return(a[0]?xn.date.fromICAL(a[0]):"")+(a[1]?"T"+xn.time.fromICAL(a[1]):"")},toICAL:function(t){let a=t.split("T");return xn.date.toICAL(a[0])+(a[1]?"T"+xn.time.toICAL(a[1]):"")}},timestamp:Ls["date-time"],"language-tag":{matches:/^[a-zA-Z0-9-]+$/},"phone-number":{fromICAL:function(t){return Array.from(t).filter(function(a){return a==="\\"?void 0:a}).join("")},toICAL:function(t){return Array.from(t).map(function(a){return a===","||a===";"?"\\"+a:a}).join("")}}});let H$={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","time","date-time","date-and-or-time","timestamp","boolean","integer","float","utc-offset","language-tag"],allowXName:!0,allowIanaToken:!0}},U$=go(av,{adr:{defaultType:"text",structuredValue:";",multiValue:","},anniversary:_S,bday:_S,caladruri:Qs,caluri:Qs,clientpidmap:of,email:Qt,fburl:Qs,fn:Qt,gender:of,geo:Qs,impp:Qs,key:Qs,kind:Qt,lang:{defaultType:"language-tag"},logo:Qs,member:Qs,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:bu,note:Qt,org:{defaultType:"text",structuredValue:";"},photo:Qs,related:Qs,rev:{defaultType:"timestamp"},role:Qt,sound:Qs,source:Qs,tel:{defaultType:"uri",allowedTypes:["uri","text"]},title:Qt,tz:{defaultType:"text",allowedTypes:["text","utc-offset","uri"]},xml:Qt}),V$=go(sv,{binary:Ls.binary,date:xn.date,"date-time":xn["date-time"],"phone-number":xn["phone-number"],uri:Ls.uri,text:xn.text,time:Ls.time,vcard:Ls.text,"utc-offset":{toICAL:function(t){return t.slice(0,7)},fromICAL:function(t){return t.slice(0,7)},decorate:function(t){return nr.fromString(t)},undecorate:function(t){return t.toString()}}}),Y$={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","date-time","phone-number","time","boolean","integer","float","utc-offset","vcard","binary"],allowXName:!0,allowIanaToken:!0}},q$=go(av,{fn:Qt,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:bu,photo:{defaultType:"binary",allowedTypes:["binary","uri"]},bday:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(t){return t.indexOf("T")===-1?"date":"date-time"}},adr:{defaultType:"text",structuredValue:";",multiValue:","},label:Qt,tel:{defaultType:"phone-number"},email:Qt,mailer:Qt,tz:{defaultType:"utc-offset",allowedTypes:["utc-offset","text"]},geo:{defaultType:"float",structuredValue:";"},title:Qt,role:Qt,logo:{defaultType:"binary",allowedTypes:["binary","uri"]},agent:{defaultType:"vcard",allowedTypes:["vcard","text","uri"]},org:of,note:bu,prodid:Qt,rev:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(t){return t.indexOf("T")===-1?"date":"date-time"}},"sort-string":Qt,sound:{defaultType:"binary",allowedTypes:["binary","uri"]},class:Qt,key:{defaultType:"binary",allowedTypes:["binary","text"]}}),si={name:"ical",value:Ls,param:B$,property:$$,propertyGroups:!1},MS={name:"vcard4",value:xn,param:H$,property:U$,propertyGroups:!0},OS={name:"vcard3",value:V$,param:Y$,property:q$,propertyGroups:!0};const qa={strict:!0,defaultSet:si,defaultType:"unknown",components:{vcard:MS,vcard3:OS,vevent:si,vtodo:si,vjournal:si,valarm:si,vtimezone:si,daylight:si,standard:si},icalendar:si,vcard:MS,vcard3:OS,getDesignSet:function(t){return t&&t in qa.components?qa.components[t]:qa.defaultSet}},kh=`\r
`,RS="unknown",F$={'"':"^'","\n":"^n","^":"^^"};function Ia(t){typeof t[0]=="string"&&(t=[t]);let a=0,s=t.length,r="";for(;a<s;a++)r+=Ia.component(t[a])+kh;return r}Ia.component=function(t,a){let s=t[0].toUpperCase(),r="BEGIN:"+s+kh,l=t[1],o=0,d=l.length,u=t[0];for(u==="vcard"&&t[1].length>0&&!(t[1][0][0]==="version"&&t[1][0][3]==="4.0")&&(u="vcard3"),a=a||qa.getDesignSet(u);o<d;o++)r+=Ia.property(l[o],a)+kh;let m=t[2]||[],h=0,g=m.length;for(;h<g;h++)r+=Ia.component(m[h],a)+kh;return r+="END:"+s,r};Ia.property=function(t,a,s){let r=t[0].toUpperCase(),l=t[0],o=t[1];a||(a=qa.defaultSet);let d=o.group,u;a.propertyGroups&&d?u=d.toUpperCase()+"."+r:u=r;for(let[v,b]of Object.entries(o)){if(a.propertyGroups&&v=="group")continue;let N=a.param[v],S=N&&N.multiValue;S&&Array.isArray(b)?(b=b.map(function(w){return w=Ia._rfc6868Unescape(w),w=Ia.paramPropertyValue(w,N.multiValueSeparateDQuote),w}),b=Ia.multiValue(b,S,"unknown",null,a)):(b=Ia._rfc6868Unescape(b),b=Ia.paramPropertyValue(b)),u+=";"+v.toUpperCase()+"="+b}if(t.length===3)return u+":";let m=t[2],h,g=!1,x=!1,y=!1;return l in a.property?(h=a.property[l],"multiValue"in h&&(g=h.multiValue),"structuredValue"in h&&Array.isArray(t[3])&&(x=h.structuredValue),"defaultType"in h?m===h.defaultType&&(y=!0):m===RS&&(y=!0)):m===RS&&(y=!0),y||(u+=";VALUE="+m.toUpperCase()),u+=":",g&&x?u+=Ia.multiValue(t[3],x,m,g,a,x):g?u+=Ia.multiValue(t.slice(3),g,m,null,a,!1):x?u+=Ia.multiValue(t[3],x,m,null,a,x):u+=Ia.value(t[3],m,a,!1),s?u:_2(u)};Ia.paramPropertyValue=function(t,a){return!a&&t.indexOf(",")===-1&&t.indexOf(":")===-1&&t.indexOf(";")===-1?t:'"'+t+'"'};Ia.multiValue=function(t,a,s,r,l,o){let d="",u=t.length,m=0;for(;m<u;m++)r&&Array.isArray(t[m])?d+=Ia.multiValue(t[m],r,s,null,l,o):d+=Ia.value(t[m],s,l,o),m!==u-1&&(d+=a);return d};Ia.value=function(t,a,s,r){return a in s.value&&"toICAL"in s.value[a]?s.value[a].toICAL(t,r):t};Ia._rfc6868Unescape=function(t){return t.replace(/[\n^"]/g,function(a){return F$[a]})};const IS=0,yh=1,vh=2,Ji=3;class eo{static fromString(a,s){return new eo(ia.property(a,s))}constructor(a,s){this._parent=s||null,typeof a=="string"?(this.jCal=[a,{},qa.defaultType],this.jCal[vh]=this.getDefaultType()):this.jCal=a,this._updateType()}get type(){return this.jCal[vh]}get name(){return this.jCal[IS]}get parent(){return this._parent}set parent(a){let s=!this._parent||a&&a._designSet!=this._parent._designSet;this._parent=a,this.type==qa.defaultType&&s&&(this.jCal[vh]=this.getDefaultType(),this._updateType())}get _designSet(){return this.parent?this.parent._designSet:qa.defaultSet}_updateType(){let a=this._designSet;this.type in a.value&&("decorate"in a.value[this.type]?this.isDecorated=!0:this.isDecorated=!1,this.name in a.property&&(this.isMultiValue="multiValue"in a.property[this.name],this.isStructuredValue="structuredValue"in a.property[this.name]))}_hydrateValue(a){return this._values&&this._values[a]?this._values[a]:this.jCal.length<=Ji+a?null:this.isDecorated?(this._values||(this._values=[]),this._values[a]=this._decorate(this.jCal[Ji+a])):this.jCal[Ji+a]}_decorate(a){return this._designSet.value[this.type].decorate(a,this)}_undecorate(a){return this._designSet.value[this.type].undecorate(a,this)}_setDecoratedValue(a,s){this._values||(this._values=[]),typeof a=="object"&&"icaltype"in a?(this.jCal[Ji+s]=this._undecorate(a),this._values[s]=a):(this.jCal[Ji+s]=a,this._values[s]=this._decorate(a))}getParameter(a){if(a in this.jCal[yh])return this.jCal[yh][a]}getFirstParameter(a){let s=this.getParameter(a);return Array.isArray(s)?s[0]:s}setParameter(a,s){let r=a.toLowerCase();typeof s=="string"&&r in this._designSet.param&&"multiValue"in this._designSet.param[r]&&(s=[s]),this.jCal[yh][a]=s}removeParameter(a){delete this.jCal[yh][a]}getDefaultType(){let a=this.jCal[IS],s=this._designSet;if(a in s.property){let r=s.property[a];if("defaultType"in r)return r.defaultType}return qa.defaultType}resetType(a){this.removeAllValues(),this.jCal[vh]=a,this._updateType()}getFirstValue(){return this._hydrateValue(0)}getValues(){let a=this.jCal.length-Ji;if(a<1)return[];let s=0,r=[];for(;s<a;s++)r[s]=this._hydrateValue(s);return r}removeAllValues(){this._values&&(this._values.length=0),this.jCal.length=3}setValues(a){if(!this.isMultiValue)throw new Error(this.name+`: does not not support mulitValue.
override isMultiValue`);let s=a.length,r=0;if(this.removeAllValues(),s>0&&typeof a[0]=="object"&&"icaltype"in a[0]&&this.resetType(a[0].icaltype),this.isDecorated)for(;r<s;r++)this._setDecoratedValue(a[r],r);else for(;r<s;r++)this.jCal[Ji+r]=a[r]}setValue(a){this.removeAllValues(),typeof a=="object"&&"icaltype"in a&&this.resetType(a.icaltype),this.isDecorated?this._setDecoratedValue(a,0):this.jCal[Ji]=a}toJSON(){return this.jCal}toICALString(){return Ia.property(this.jCal,this._designSet,!0)}}const el=0,Sr=1,tl=2,G$=0,W$=3;class jn{static fromString(a){return new jn(ia.component(a))}constructor(a,s){typeof a=="string"&&(a=[a,[],[]]),this.jCal=a,this.parent=s||null,!this.parent&&this.name==="vcalendar"&&(this._timezoneCache=new Map)}_hydratedPropertyCount=0;_hydratedComponentCount=0;_timezoneCache=null;_components=null;_properties=null;get name(){return this.jCal[el]}get _designSet(){let a=this.parent&&this.parent._designSet;if(!a&&this.name=="vcard"){let s=this.jCal[Sr]?.[0];if(s&&s[G$]=="version"&&s[W$]=="3.0")return qa.getDesignSet("vcard3")}return a||qa.getDesignSet(this.name)}_hydrateComponent(a){if(this._components||(this._components=[],this._hydratedComponentCount=0),this._components[a])return this._components[a];let s=new jn(this.jCal[tl][a],this);return this._hydratedComponentCount++,this._components[a]=s}_hydrateProperty(a){if(this._properties||(this._properties=[],this._hydratedPropertyCount=0),this._properties[a])return this._properties[a];let s=new eo(this.jCal[Sr][a],this);return this._hydratedPropertyCount++,this._properties[a]=s}getFirstSubcomponent(a){if(a){let s=0,r=this.jCal[tl],l=r.length;for(;s<l;s++)if(r[s][el]===a)return this._hydrateComponent(s)}else if(this.jCal[tl].length)return this._hydrateComponent(0);return null}getAllSubcomponents(a){let s=this.jCal[tl].length,r=0;if(a){let l=this.jCal[tl],o=[];for(;r<s;r++)a===l[r][el]&&o.push(this._hydrateComponent(r));return o}else{if(!this._components||this._hydratedComponentCount!==s)for(;r<s;r++)this._hydrateComponent(r);return this._components||[]}}hasProperty(a){let s=this.jCal[Sr],r=s.length,l=0;for(;l<r;l++)if(s[l][el]===a)return!0;return!1}getFirstProperty(a){if(a){let s=0,r=this.jCal[Sr],l=r.length;for(;s<l;s++)if(r[s][el]===a)return this._hydrateProperty(s)}else if(this.jCal[Sr].length)return this._hydrateProperty(0);return null}getFirstPropertyValue(a){let s=this.getFirstProperty(a);return s?s.getFirstValue():null}getAllProperties(a){let s=this.jCal[Sr].length,r=0;if(a){let l=this.jCal[Sr],o=[];for(;r<s;r++)a===l[r][el]&&o.push(this._hydrateProperty(r));return o}else{if(!this._properties||this._hydratedPropertyCount!==s)for(;r<s;r++)this._hydrateProperty(r);return this._properties||[]}}_removeObjectByIndex(a,s,r){if(s=s||[],s[r]){let l=s[r];"parent"in l&&(l.parent=null)}s.splice(r,1),this.jCal[a].splice(r,1)}_removeObject(a,s,r){let l=0,o=this.jCal[a],d=o.length,u=this[s];if(typeof r=="string"){for(;l<d;l++)if(o[l][el]===r)return this._removeObjectByIndex(a,u,l),!0}else if(u){for(;l<d;l++)if(u[l]&&u[l]===r)return this._removeObjectByIndex(a,u,l),!0}return!1}_removeAllObjects(a,s,r){let l=this[s],o=this.jCal[a],d=o.length-1;for(;d>=0;d--)(!r||o[d][el]===r)&&this._removeObjectByIndex(a,l,d)}addSubcomponent(a){this._components||(this._components=[],this._hydratedComponentCount=0),a.parent&&a.parent.removeSubcomponent(a);let s=this.jCal[tl].push(a.jCal);return this._components[s-1]=a,this._hydratedComponentCount++,a.parent=this,a}removeSubcomponent(a){let s=this._removeObject(tl,"_components",a);return s&&this._hydratedComponentCount--,s}removeAllSubcomponents(a){let s=this._removeAllObjects(tl,"_components",a);return this._hydratedComponentCount=0,s}addProperty(a){if(!(a instanceof eo))throw new TypeError("must be instance of ICAL.Property");this._properties||(this._properties=[],this._hydratedPropertyCount=0),a.parent&&a.parent.removeProperty(a);let s=this.jCal[Sr].push(a.jCal);return this._properties[s-1]=a,this._hydratedPropertyCount++,a.parent=this,a}addPropertyWithValue(a,s){let r=new eo(a);return r.setValue(s),this.addProperty(r),r}updatePropertyWithValue(a,s){let r=this.getFirstProperty(a);return r?r.setValue(s):r=this.addPropertyWithValue(a,s),r}removeProperty(a){let s=this._removeObject(Sr,"_properties",a);return s&&this._hydratedPropertyCount--,s}removeAllProperties(a){let s=this._removeAllObjects(Sr,"_properties",a);return this._hydratedPropertyCount=0,s}toJSON(){return this.jCal}toString(){return Ia.component(this.jCal,this._designSet)}getTimeZoneByID(a){if(this.parent)return this.parent.getTimeZoneByID(a);if(!this._timezoneCache)return null;if(this._timezoneCache.has(a))return this._timezoneCache.get(a);const s=this.getAllSubcomponents("vtimezone");for(const r of s)if(r.getFirstProperty("tzid").getFirstValue()===a){const l=new tt({component:r,tzid:a});return this._timezoneCache.set(a,l),l}return null}}class O2{constructor(a){this.ruleDates=[],this.exDates=[],this.fromData(a)}complete=!1;ruleIterators=null;ruleDates=null;exDates=null;ruleDateInc=0;exDateInc=0;exDate=null;ruleDate=null;dtstart=null;last=null;fromData(a){let s=di(a.dtstart,De);if(s)this.dtstart=s;else throw new Error(".dtstart (ICAL.Time) must be given");if(a.component)this._init(a.component);else{if(this.last=di(a.last,De)||s.clone(),!a.ruleIterators)throw new Error(".ruleIterators or .component must be given");this.ruleIterators=a.ruleIterators.map(function(r){return di(r,Tr)}),this.ruleDateInc=a.ruleDateInc,this.exDateInc=a.exDateInc,a.ruleDates&&(this.ruleDates=a.ruleDates.map(r=>di(r,De)),this.ruleDate=this.ruleDates[this.ruleDateInc]),a.exDates&&(this.exDates=a.exDates.map(r=>di(r,De)),this.exDate=this.exDates[this.exDateInc]),typeof a.complete<"u"&&(this.complete=a.complete)}}_compare_special(a,s){return!a.isDate&&s.isDate?new De({year:a.year,month:a.month,day:a.day}).compare(s):a.compare(s)}next(){let a,s,r,l=500,o=0;for(;;){if(o++>l)throw new Error("max tries have occurred, rule may be impossible to fulfill.");if(s=this.ruleDate,a=this._nextRecurrenceIter(this.last),!s&&!a){this.complete=!0;break}if((!s||a&&s.compare(a.last)>0)&&(s=a.last.clone(),a.next()),this.ruleDate===s&&this._nextRuleDay(),this.last=s,this.exDate&&(r=this._compare_special(this.last,this.exDate),r>0&&this._nextExDay(),r===0)){this._nextExDay();continue}return this.last}}toJSON(){function a(r){return r.toJSON()}let s=Object.create(null);return s.ruleIterators=this.ruleIterators.map(a),this.ruleDates&&(s.ruleDates=this.ruleDates.map(a)),this.exDates&&(s.exDates=this.exDates.map(a)),s.ruleDateInc=this.ruleDateInc,s.exDateInc=this.exDateInc,s.last=this.last.toJSON(),s.dtstart=this.dtstart.toJSON(),s.complete=this.complete,s}_extractDates(a,s){let r=[],l=a.getAllProperties(s);for(let o=0,d=l.length;o<d;o++)for(let u of l[o].getValues()){let m=Jl(r,u,(h,g)=>h.compare(g));r.splice(m,0,u)}return r}_init(a){if(this.ruleIterators=[],this.last=this.dtstart.clone(),!a.hasProperty("rdate")&&!a.hasProperty("rrule")&&!a.hasProperty("recurrence-id")){this.ruleDate=this.last.clone(),this.complete=!0;return}if(a.hasProperty("rdate")&&(this.ruleDates=this._extractDates(a,"rdate"),this.ruleDates[0]&&this.ruleDates[0].compare(this.dtstart)<0?(this.ruleDateInc=0,this.last=this.ruleDates[0].clone()):this.ruleDateInc=Jl(this.ruleDates,this.last,(s,r)=>s.compare(r)),this.ruleDate=this.ruleDates[this.ruleDateInc]),a.hasProperty("rrule")){let s=a.getAllProperties("rrule"),r=0,l=s.length,o,d;for(;r<l;r++)o=s[r].getFirstValue(),d=o.iterator(this.dtstart),this.ruleIterators.push(d),d.next()}a.hasProperty("exdate")&&(this.exDates=this._extractDates(a,"exdate"),this.exDateInc=Jl(this.exDates,this.last,this._compare_special),this.exDate=this.exDates[this.exDateInc])}_nextExDay(){this.exDate=this.exDates[++this.exDateInc]}_nextRuleDay(){this.ruleDate=this.ruleDates[++this.ruleDateInc]}_nextRecurrenceIter(){let a=this.ruleIterators;if(a.length===0)return null;let s=a.length,r,l,o=0,d;for(;o<s;o++){if(r=a[o],l=r.last,r.completed){s--,o!==0&&o--,a.splice(o,1);continue}(!d||d.last.compare(l)>0)&&(d=r)}return d}}let R2=class $0{constructor(a,s){a instanceof jn||(s=a,a=null),a?this.component=a:this.component=new jn("vevent"),this._rangeExceptionCache=Object.create(null),this.exceptions=Object.create(null),this.rangeExceptions=[],s&&s.strictExceptions&&(this.strictExceptions=s.strictExceptions),s&&s.exceptions?s.exceptions.forEach(this.relateException,this):this.component.parent&&!this.isRecurrenceException()&&this.component.parent.getAllSubcomponents("vevent").forEach(function(r){r.hasProperty("recurrence-id")&&this.relateException(r)},this)}static THISANDFUTURE="THISANDFUTURE";exceptions=null;strictExceptions=!1;relateException(a){if(this.isRecurrenceException())throw new Error("cannot relate exception to exceptions");if(a instanceof jn&&(a=new $0(a)),this.strictExceptions&&a.uid!==this.uid)throw new Error("attempted to relate unrelated exception");let s=a.recurrenceId.toString();if(this.exceptions[s]=a,a.modifiesFuture()){let r=[a.recurrenceId.toUnixTime(),s],l=Jl(this.rangeExceptions,r,zS);this.rangeExceptions.splice(l,0,r)}}modifiesFuture(){return this.component.hasProperty("recurrence-id")?this.component.getFirstProperty("recurrence-id").getParameter("range")===$0.THISANDFUTURE:!1}findRangeException(a){if(!this.rangeExceptions.length)return null;let s=a.toUnixTime(),r=Jl(this.rangeExceptions,[s],zS);if(r-=1,r<0)return null;let l=this.rangeExceptions[r];return s<l[0]?null:l[1]}getOccurrenceDetails(a){let s=a.toString(),r=a.convertToZone(tt.utcTimezone).toString(),l,o={recurrenceId:a};if(s in this.exceptions)l=o.item=this.exceptions[s],o.startDate=l.startDate,o.endDate=l.endDate,o.item=l;else if(r in this.exceptions)l=this.exceptions[r],o.startDate=l.startDate,o.endDate=l.endDate,o.item=l;else{let d=this.findRangeException(a),u;if(d){let m=this.exceptions[d];o.item=m;let h=this._rangeExceptionCache[d];if(!h){let x=m.recurrenceId.clone(),y=m.startDate.clone();x.zone=y.zone,h=y.subtractDate(x),this._rangeExceptionCache[d]=h}let g=a.clone();g.zone=m.startDate.zone,g.addDuration(h),u=g.clone(),u.addDuration(m.duration),o.startDate=g,o.endDate=u}else u=a.clone(),u.addDuration(this.duration),o.endDate=u,o.startDate=a,o.item=this}return o}iterator(a){return new O2({component:this.component,dtstart:a||this.startDate})}isRecurring(){let a=this.component;return a.hasProperty("rrule")||a.hasProperty("rdate")}isRecurrenceException(){return this.component.hasProperty("recurrence-id")}getRecurrenceTypes(){let a=this.component.getAllProperties("rrule"),s=0,r=a.length,l=Object.create(null);for(;s<r;s++){let o=a[s].getFirstValue();l[o.freq]=!0}return l}get uid(){return this._firstProp("uid")}set uid(a){this._setProp("uid",a)}get startDate(){return this._firstProp("dtstart")}set startDate(a){this._setTime("dtstart",a)}get endDate(){let a=this._firstProp("dtend");if(!a){let s=this._firstProp("duration");a=this.startDate.clone(),s?a.addDuration(s):a.isDate&&(a.day+=1)}return a}set endDate(a){this.component.hasProperty("duration")&&this.component.removeProperty("duration"),this._setTime("dtend",a)}get duration(){let a=this._firstProp("duration");return a||this.endDate.subtractDateTz(this.startDate)}set duration(a){this.component.hasProperty("dtend")&&this.component.removeProperty("dtend"),this._setProp("duration",a)}get location(){return this._firstProp("location")}set location(a){this._setProp("location",a)}get attendees(){return this.component.getAllProperties("attendee")}get summary(){return this._firstProp("summary")}set summary(a){this._setProp("summary",a)}get description(){return this._firstProp("description")}set description(a){this._setProp("description",a)}get color(){return this._firstProp("color")}set color(a){this._setProp("color",a)}get organizer(){return this._firstProp("organizer")}set organizer(a){this._setProp("organizer",a)}get sequence(){return this._firstProp("sequence")}set sequence(a){this._setProp("sequence",a)}get recurrenceId(){return this._firstProp("recurrence-id")}set recurrenceId(a){this._setTime("recurrence-id",a)}_setTime(a,s){let r=this.component.getFirstProperty(a);r||(r=new eo(a),this.component.addProperty(r)),s.zone===tt.localTimezone||s.zone===tt.utcTimezone?r.removeParameter("tzid"):r.setParameter("tzid",s.zone.tzid),r.setValue(s)}_setProp(a,s){this.component.updatePropertyWithValue(a,s)}_firstProp(a){return this.component.getFirstPropertyValue(a)}toString(){return this.component.toString()}};function zS(t,a){return t[0]>a[0]?1:a[0]>t[0]?-1:0}class K${constructor(a){typeof a>"u"&&(a={});for(let[s,r]of Object.entries(a))this[s]=r}parseEvent=!0;parseTimezone=!0;oncomplete=function(){};onerror=function(a){};ontimezone=function(a){};onevent=function(a){};process(a){typeof a=="string"&&(a=ia(a)),a instanceof jn||(a=new jn(a));let s=a.getAllSubcomponents(),r=0,l=s.length,o;for(;r<l;r++)switch(o=s[r],o.name){case"vtimezone":if(this.parseTimezone){let d=o.getFirstPropertyValue("tzid");d&&this.ontimezone(new tt({tzid:d,component:o}))}break;case"vevent":this.parseEvent&&this.onevent(new R2(o));break;default:continue}this.oncomplete()}}var oc={foldLength:75,debug:!1,newLineChar:`\r
`,Binary:Kf,Component:jn,ComponentParser:K$,Duration:ks,Event:R2,Period:ci,Property:eo,Recur:Ds,RecurExpansion:O2,RecurIterator:Tr,Time:De,Timezone:tt,TimezoneService:lf,UtcOffset:nr,VCardTime:cl,parse:ia,stringify:Ia,design:qa,helpers:_$};function X$(t,a){try{const s=oc.parse(t),l=new oc.Component(s).getAllSubcomponents("vevent"),o=[];for(const d of l){const u=new oc.Event(d),m=u.uid||Z$(),h=u.summary||"Ocupado",g=u.description||void 0,x=u.location||void 0,y=u.startDate.toJSDate(),v=u.endDate.toJSDate(),b=!!u.startDate.isDate;o.push({uid:m,calendarId:a,summary:h,description:g,startDate:y,endDate:v,isAllDay:b,location:x})}return o}catch(s){throw console.error("Error parsing iCal data:",s),new Error("No se pudo parsear el calendario. Verifica que la URL sea vlida.")}}async function Q$(t,a,s=1e4){try{if(!I2(t))throw new Error("URL invlida. Debe ser una URL pblica de Google Calendar en formato iCal.");const r=`https://corsproxy.io/?${encodeURIComponent(t)}`,l=new AbortController,o=setTimeout(()=>l.abort(),s),d=await fetch(r,{signal:l.signal,headers:{Accept:"text/calendar"}});if(clearTimeout(o),!d.ok)throw new Error(`Error al descargar el calendario: ${d.status} ${d.statusText}`);const u=await d.text();return X$(u,a)}catch(r){throw r instanceof Error?r.name==="AbortError"?new Error("Tiempo de espera agotado. La URL del calendario no responde."):r:new Error("Error desconocido al sincronizar el calendario.")}}function I2(t){try{const a=new URL(t);if(a.protocol!=="https:")return!1;const s=a.hostname.includes("calendar.google.com"),r=t.endsWith(".ics");return s||r}catch{return!1}}function Z$(){return`fallback-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function J$(t,a,s){return t.filter(r=>r.startDate<s&&r.endDate>a)}function eH(t,a){const s=new Date(a);s.setHours(0,0,0,0);const r=new Date(a);return r.setHours(23,59,59,999),J$(t,s,r)}function z2(){const[t,a]=p.useState([]),[s,r]=p.useState([]),[l,o]=p.useState([]),[d,u]=p.useState("idle"),[m,h]=p.useState();p.useEffect(()=>{g()},[]);const g=p.useCallback(()=>{const _=wl();a(_.calendars),r(_.events),o(_.hiddenEventIds),h(_.lastGlobalSync)},[]),x=p.useCallback((_,R,L)=>{const U={id:tH(),name:_,url:R,color:L||m$,enabled:!0};return p$(U),a(V=>[...V,U]),U},[]),y=p.useCallback((_,R)=>{SS(_,R),a(L=>L.map(U=>U.id===_?{...U,...R}:U))},[]),v=p.useCallback(_=>{x$(_),a(R=>R.filter(L=>L.id!==_)),r(R=>R.filter(L=>L.calendarId!==_))},[]),b=p.useCallback(_=>{const R=t.find(L=>L.id===_);R&&y(_,{enabled:!R.enabled})},[t,y]),N=p.useCallback(async _=>{const R=t.find(L=>L.id===_);if(!R)return{calendarId:_,status:"error",error:"Calendario no encontrado"};try{const L=await Q$(R.url,_,h$);g$(_,L),r(V=>[...V.filter(F=>F.calendarId!==_),...L]);const U=Date.now();return SS(_,{lastSyncedAt:U}),a(V=>V.map(F=>F.id===_?{...F,lastSyncedAt:U}:F)),{calendarId:_,status:"success",eventCount:L.length}}catch(L){return console.error(`Error syncing calendar ${_}:`,L),{calendarId:_,status:"error",error:L instanceof Error?L.message:"Error desconocido"}}},[t]),S=p.useCallback(async()=>{u("syncing");const _=t.filter(R=>R.enabled);if(_.length===0)return u("idle"),[];try{const R=await Promise.all(_.map(V=>N(V.id))),L=Date.now();b$(),h(L);const U=R.some(V=>V.status==="error");return u(U?"error":"success"),setTimeout(()=>u("idle"),3e3),R}catch(R){return console.error("Error syncing calendars:",R),u("error"),setTimeout(()=>u("idle"),3e3),[]}},[t,N]),w=p.useCallback(_=>{y$(_),o(R=>[...R,_])},[]),E=p.useCallback(_=>{v$(_),o(R=>R.filter(L=>L!==_))},[]),T=p.useCallback(()=>s.filter(_=>l.includes(_.uid)?!1:t.find(L=>L.id===_.calendarId)?.enabled??!1),[s,l,t]),D=p.useCallback(_=>{const R=T();return eH(R,_)},[T]),k=p.useCallback(_=>l.includes(_),[l]);return{calendars:t,events:s,visibleEvents:T(),hiddenEventIds:l,syncStatus:d,lastSyncTime:m,addCalendar:x,updateCalendar:y,removeCalendar:v,toggleCalendar:b,syncCalendar:N,syncAllCalendars:S,hideEvent:w,showEvent:E,isEventHidden:k,getVisibleEventsForDay:D,loadFromStorage:g}}function tH(){return`cal-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function aH({layout:t,calendar:a,isHidden:s,onToggleVisibility:r}){const[l,o]=p.useState(!1),{event:d}=t,u=LS(a.color,hh.opacityBackground),m=LS(a.color,hh.opacityBorder),h=Jt(d.startDate,"h:mm a",{locale:As}),g=Jt(d.endDate,"h:mm a",{locale:As});return e.jsxs(Yf,{open:l,onOpenChange:o,children:[e.jsx(qf,{asChild:!0,children:e.jsxs("div",{className:"absolute cursor-pointer rounded-md px-2 py-1 text-xs overflow-hidden transition-opacity hover:opacity-90",style:{top:`${t.top}px`,height:`${Math.max(t.height,20)}px`,left:`${t.left}%`,width:`${t.width}%`,zIndex:t.zIndex,backgroundColor:u,borderLeft:`${hh.borderWidth} ${hh.borderStyle} ${m}`},children:[e.jsx("div",{className:"font-medium truncate",style:{color:a.color},children:d.summary}),t.height>30&&e.jsx("div",{className:"text-xs opacity-75 truncate",style:{color:a.color},children:h})]})}),e.jsx(Pu,{className:"w-80",side:"right",align:"start",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:d.summary}),e.jsx(wt,{variant:"outline",className:"mt-1",style:{borderColor:a.color,color:a.color},children:a.name})]})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(xs,{className:"w-4 h-4"}),e.jsx("span",{children:Jt(d.startDate,"EEEE, d 'de' MMMM",{locale:As})})]}),e.jsxs("div",{className:"text-sm text-muted-foreground pl-6",children:[h," - ",g]}),d.location&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(f1,{className:"w-4 h-4"}),e.jsx("span",{children:d.location})]}),d.description&&e.jsx("div",{className:"text-sm text-muted-foreground border-t pt-2",children:e.jsx("p",{className:"whitespace-pre-wrap",children:d.description})}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx(P,{variant:"ghost",size:"sm",className:"w-full justify-start gap-2",onClick:()=>{r(d.uid),o(!1)},children:s?e.jsxs(e.Fragment,{children:[e.jsx(Cu,{className:"w-4 h-4"}),"Mostrar evento"]}):e.jsxs(e.Fragment,{children:[e.jsx(p1,{className:"w-4 h-4"}),"Ocultar evento"]})}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 px-2",children:s?"Este evento est oculto solo en Life Tracker":"Ocultar este evento solo lo esconde en Life Tracker, no lo elimina de Google Calendar"})]})]})})]})}function LS(t,a){t=t.replace("#","");const s=parseInt(t.substring(0,2),16),r=parseInt(t.substring(2,4),16),l=parseInt(t.substring(4,6),16);return`rgba(${s}, ${r}, ${l}, ${a})`}function L2({onSync:t,syncStatus:a,lastSyncTime:s,variant:r="outline",size:l="default",showText:o=!0}){const d=a==="syncing",u=a==="success",m=a==="error";let h="Sincronizar";d&&(h="Sincronizando..."),u&&(h="Sincronizado"),m&&(h="Error al sincronizar");let g=io;u&&(g=cr),m&&(g=hc);const x=s?`ltima sincronizacin: ${JC(s,{locale:As,addSuffix:!0})}`:"Nunca sincronizado";return e.jsxs("div",{className:"flex flex-col items-start gap-1",children:[e.jsxs(P,{variant:r,size:l,onClick:t,disabled:d,className:m?"border-destructive text-destructive":"",children:[e.jsx(g,{className:`w-4 h-4 ${d?"animate-spin":""} ${o?"mr-2":""}`}),o&&h]}),o&&s!==void 0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:x})]})}const sH={startHour:6};function nH(t){const a=t.getHours(),s=t.getMinutes(),r=a*60+s,l=sH.startHour*60,o=r-l;return wy(o)}function rH(t,a){const r=(a.getTime()-t.getTime())/(1e3*60);return wy(r)}function PS(t,a){return t.startDate<a.endDate&&t.endDate>a.startDate}function iH(t){const a=[...t].sort((l,o)=>l.startDate.getTime()-o.startDate.getTime()),s=[],r=[];for(const l of a){let o=!1;for(let d=0;d<r.length;d++){const u=r[d];if(!u.some(h=>PS(l,h))){u.push(l),o=!0;break}}o||r.push([l])}for(const l of a){let o=0,d=1;for(let x=0;x<r.length;x++)if(r[x].includes(l)){o=x,d=r.filter(v=>v.some(b=>PS(l,b))).length;break}const u=nH(l.startDate),m=rH(l.startDate,l.endDate),h=100/d,g=o*h;s.push({event:l,top:u,height:m,left:g,width:h,zIndex:f$})}return s}const lH=()=>{const t=[];for(let a=6;a<=22;a++)t.push({hour:a,minute:0,label:`${a.toString().padStart(2,"0")}:00`}),a<22&&t.push({hour:a,minute:30,label:`${a.toString().padStart(2,"0")}:30`});return t},oH=({tasks:t,onDelete:a,onEdit:s,onQuickUpdate:r,onView:l,onMove:o,onToggle:d})=>{const u=new Date,m=p.useMemo(()=>lH(),[]),h=p.useRef(null),{habits:g,updateHabitTime:x,resetHabitTime:y,getHabitTime:v,toggleHabitCompletion:b}=u$(u),{calendars:N,getVisibleEventsForDay:S,hideEvent:w,showEvent:E,isEventHidden:T,syncAllCalendars:D,syncStatus:k,lastSyncTime:_}=z2(),R=p.useMemo(()=>S(u),[S,u]),L=p.useMemo(()=>iH(R),[R]),U=GL(FL(Gy,{activationConstraint:{distance:5}}));p.useEffect(()=>{if(!h.current)return;const re=new Date,Q=re.getHours(),M=re.getMinutes()<30?`${Q.toString().padStart(2,"0")}:00`:`${Q.toString().padStart(2,"0")}:30`,W=h.current.querySelector(`[data-time="${M}"]`);W&&setTimeout(()=>{W.scrollIntoView({behavior:"smooth",block:"center"})},300)},[]);const{tasksWithTime:V,tasksWithoutTime:F}=p.useMemo(()=>{const re=[],Q=[];return t.forEach(q=>{if(!q.startDate||!Mh(q.startDate,u))return;const M=q.startDate.getHours(),W=q.startDate.getMinutes();if(M!==12||W!==0)re.push(q);else if(q.endDate){const ie=q.endDate.getHours(),ve=q.endDate.getMinutes();ie!==12||ve!==0?re.push(q):Q.push(q)}else Q.push(q)}),{tasksWithTime:re,tasksWithoutTime:Q}},[t,u]),G=re=>{const Q=re.getHours(),q=re.getMinutes();return((Q-6)*60+q)/30*50},$=(re,Q)=>{if(!Q)return 50;const q=(Q.getTime()-re.getTime())/6e4;return Math.max(50,q/30*50)},z=p.useMemo(()=>{if(V.length===0)return[];const Q=[...V].sort((M,W)=>{const ie=M.startDate.getTime()-W.startDate.getTime();if(ie!==0)return ie;const ve=M.endDate?M.endDate.getTime()-M.startDate.getTime():0;return(W.endDate?W.endDate.getTime()-W.startDate.getTime():0)-ve}).map(M=>({...M,top:G(M.startDate),height:$(M.startDate,M.endDate),columnIndex:0,totalColumns:1})),q=[];for(const M of Q){const W=M.top,ie=M.top+M.height;let ve=-1;for(let K=0;K<q.length;K++)if(q[K]<=W){ve=K;break}ve===-1&&(ve=q.length,q.push(0)),M.columnIndex=ve,M.totalColumns=1,q[ve]=ie}for(let M=0;M<Q.length;M++){const W=Q[M],ie=W.top+W.height;let ve=W.columnIndex+1;for(let K=0;K<Q.length;K++){if(M===K)continue;const oe=Q[K],_e=oe.top,je=oe.top+oe.height;_e<ie&&je>W.top&&(ve=Math.max(ve,oe.columnIndex+1))}W.totalColumns=ve}return Q},[V]),H=V.length+F.length,I=g.length,O=()=>{},Y=re=>{},le=re=>{const{active:Q,delta:q}=re,M=Q.data.current?.type;if(M==="task-move"){if(!Q.data.current?.task||!o)return;const W=Q.data.current.task;if(!W.startDate)return;const ie=G(W.startDate),ve=Math.max(0,ie+q.y),K=Dw(ve,W.startDate),oe=kw(K,15),_e=oe.getHours();if(_e<6||_e>=22)return;const je=xu(W.startDate,W.endDate,oe);if(je&&je.getHours()>22)return;o(W.id,oe)}else if(M==="habit-move"){if(!Q.data.current?.habit)return;const W=Q.data.current.habit,ie=v(W.id,Ue(u)),ve=SE(T2(ie,u),6),K=Math.max(0,ve+q.y),oe=Dw(K,u,6),_e=kw(oe,15),je=_e.getHours();if(je<6||je>=22)return;const Ie=Jt(_e,"HH:mm");x(W.id,Ue(u),Ie)}};return H===0&&I===0?null:e.jsx(K6,{sensors:U,onDragStart:O,onDragMove:Y,onDragEnd:le,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"sticky top-0 bg-white py-2 z-10",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("h3",{className:"text-sm font-semibold text-blue-600 flex items-center gap-2",children:[e.jsx("span",{children:""}),"Hoy - ",Jt(u,"dd/MM/yyyy")," (",H," tareas",I>0&&`, ${I} hbitos pendientes`,")"]}),N.length>0&&e.jsx(L2,{onSync:D,syncStatus:k,lastSyncTime:_,variant:"ghost",size:"sm",showText:!1})]})}),(V.length>0||g.length>0)&&e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-3 py-2 border-b",children:e.jsx("h4",{className:"text-xs font-semibold text-gray-700",children:"Franjas Horarias (06:00 - 22:00)"})}),e.jsxs("div",{ref:h,className:"max-h-[600px] overflow-y-auto relative",id:"today-time-grid",children:[e.jsx("div",{className:"divide-y",children:m.map(re=>{const Q=re.minute===0,q=new Date,M=q.getHours()===re.hour&&(q.getMinutes()<30?re.minute===0:re.minute===30);return e.jsxs("div",{className:he("flex h-[50px] relative bg-gray-50/50",Q&&"border-t-2 border-gray-300"),"data-time":re.label,children:[M&&e.jsx("div",{className:"absolute inset-x-0 top-0 h-0.5 bg-red-500 z-30",children:e.jsx("div",{className:"absolute left-0 top-0 w-2 h-2 bg-red-500 rounded-full -mt-[3px]"})}),e.jsx("div",{className:he("w-16 flex-shrink-0 px-2 py-1 border-r bg-gray-50 flex items-center",!Q&&"text-gray-400"),children:e.jsx("span",{className:he("text-[11px] font-medium",Q?"text-gray-700":"text-gray-400"),children:re.label})}),e.jsx("div",{className:"flex-1"})]},`${re.hour}-${re.minute}`)})}),e.jsx("div",{className:"absolute top-0 left-16 right-0 pointer-events-none",style:{height:`${m.length*50}px`},children:L.map(re=>{const Q=N.find(M=>M.id===re.event.calendarId);if(!Q)return null;const q=T(re.event.uid);return e.jsx(aH,{layout:re,calendar:Q,isHidden:q,onToggleVisibility:M=>{q?E(M):w(M)}},re.event.uid)})}),e.jsx("div",{className:"absolute top-0 left-16 right-0 pointer-events-none",style:{height:`${m.length*50}px`},children:z.map(re=>{const Q=100/re.totalColumns,q=re.columnIndex/re.totalColumns*100;return e.jsx(o$,{task:re,onDelete:a,onEdit:s,onQuickUpdate:r,onToggle:d,className:"pointer-events-auto",style:{position:"absolute",top:`${re.top}px`,height:`${re.height-2}px`,left:`${q}%`,width:`calc(${Q}% - 4px)`,marginLeft:"2px"}},re.id)})}),e.jsx("div",{className:"absolute top-0 left-16 right-0 pointer-events-none",style:{height:`${m.length*50}px`},children:g.map(re=>e.jsx(gP,{habit:re,customTime:v(re.id,Ue(u)),onTimeChange:(Q,q)=>x(Q,Ue(u),q),onComplete:Q=>b(Q,Ue(u)),onReset:Q=>y(Q,Ue(u)),className:"pointer-events-auto",style:{position:"absolute",top:`${re.top}px`,height:`${re.height}px`,left:"0",width:"calc(100% - 4px)",marginLeft:"2px",zIndex:5}},`habit-${re.id}`))})]})]}),F.length>0&&e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-amber-50 px-3 py-2 border-b border-amber-200",children:e.jsxs("h4",{className:"text-xs font-semibold text-amber-800 flex items-center gap-1",children:[e.jsx("span",{children:""}),"Sin Hora Asignada (",F.length,")"]})}),e.jsx("div",{className:"p-2 space-y-2 bg-white",children:F.map(re=>e.jsx($u,{task:re,onDelete:a,onEdit:s,onView:l,onMove:o,showCategoryLabel:!0},re.id))})]})]})})},cH=({tasks:t,onDelete:a,onEdit:s,onView:r,onMove:l})=>{const o=new Date,d=ka(o),u=p.useMemo(()=>{const y={};return t.forEach(v=>{if(!v.startDate||!TM(ka(v.startDate),d)||Mh(v.startDate,o))return;const b=Jt(v.startDate,"yyyy-MM-dd");y[b]||(y[b]=[]),y[b].push(v)}),Object.keys(y).forEach(v=>{y[v].sort((b,N)=>{if(b.startDate&&N.startDate){const S=b.startDate.getHours()!==12||b.startDate.getMinutes()!==0,w=N.startDate.getHours()!==12||N.startDate.getMinutes()!==0;if(S&&w)return b.startDate.getTime()-N.startDate.getTime();if(S)return-1;if(w)return 1}return 0})}),y},[t,o,d]),m=p.useMemo(()=>Object.keys(u).sort((y,v)=>y.localeCompare(v)),[u]),h=m.reduce((y,v)=>y+u[v].length,0);if(h===0)return null;const g=y=>{if(!y.startDate)return!1;const v=y.startDate.getHours(),b=y.startDate.getMinutes();return v!==12||b!==0},x=y=>{if(!y.startDate||!g(y))return"";const v=Jt(y.startDate,"HH:mm");if(y.endDate){const b=Jt(y.endDate,"HH:mm");return`${v} - ${b}`}return v};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"sticky top-0 bg-white py-2 z-10",children:e.jsxs("h3",{className:"text-sm font-semibold text-green-600 flex items-center gap-2",children:[e.jsx("span",{children:""}),"Tareas Futuras (",h,")"]})}),e.jsx("div",{className:"space-y-6",children:m.map(y=>{const v=u[y],b=new Date(y+"T12:00:00");return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-1 border-b",children:[e.jsx(Aa,{className:"w-4 h-4 text-gray-500"}),e.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:Jt(b,"EEEE, d 'de' MMMM",{locale:As})}),e.jsxs(wt,{variant:"outline",className:"text-xs",children:[v.length," ",v.length===1?"tarea":"tareas"]})]}),e.jsx("div",{className:"space-y-2 pl-2",children:v.map(N=>{const S=x(N);return e.jsxs("div",{className:"space-y-1",children:[S&&e.jsxs(wt,{variant:"secondary",className:"text-xs bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(xs,{className:"w-3 h-3 mr-1"}),S]}),e.jsx($u,{task:N,onDelete:a,onEdit:s,onView:r,onMove:l,showCategoryLabel:!0})]},N.id)})})]},y)})})]})},dH=({tasks:t,onDelete:a,onEdit:s,onView:r,onMove:l})=>{const o=p.useMemo(()=>t.filter(d=>!d.startDate&&!d.completed).sort((d,u)=>{const m={do:1,decide:2,delegate:3,delete:4},h=m[d.priority]||5,g=m[u.priority]||5;return h!==g?h-g:(u.createdAt?.seconds||0)-(d.createdAt?.seconds||0)}),[t]);return o.length===0?null:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"sticky top-0 bg-white py-2 z-10",children:e.jsxs("h3",{className:"text-sm font-semibold text-gray-600 flex items-center gap-2",children:[e.jsx("span",{children:""}),"Sin Fecha (",o.length,")"]})}),e.jsx("div",{className:"space-y-2",children:o.map(d=>e.jsx($u,{task:d,onDelete:a,onEdit:s,onView:r,onMove:l,showCategoryLabel:!0},d.id))})]})},uH=({tasks:t,onDelete:a,onEdit:s,onQuickUpdate:r,onView:l,onMove:o,onToggle:d,searchQuery:u,onSearchChange:m,selectedCategories:h,onCategoriesChange:g})=>{const[x,y]=p.useState(""),[v,b]=p.useState([]),N=u!==void 0?u:x,S=m||y,w=h!==void 0?h:v,E=g||b,T=_=>{const R=w.includes(_)?w.filter(L=>L!==_):[...w,_];E(R)},D=_=>{E(w.filter(R=>R!==_))},k=p.useMemo(()=>{const _=new Date,R=new Date(_.getFullYear(),_.getMonth(),_.getDate());let L=0,U=0,V=0,F=0;return t.forEach(G=>{if(!G.startDate){F++;return}const $=new Date(G.startDate),z=new Date($.getFullYear(),$.getMonth(),$.getDate());z<R?L++:z.getTime()===R.getTime()?U++:V++}),{overdue:L,todayCount:U,future:V,noDate:F}},[t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-20 pb-4 space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 items-start sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md w-full",children:[e.jsx(fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ye,{placeholder:"Buscar tareas por nombre o descripcin...",value:N,onChange:_=>S(_.target.value),className:"pl-10 pr-10"}),N&&e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>S(""),className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Fa,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:w-auto w-full",children:[w.map(_=>e.jsxs(wt,{variant:"secondary",className:he("flex items-center gap-1 pr-1 cursor-pointer hover:opacity-80 transition-opacity",_r[_].bg,_r[_].text),children:[e.jsx("span",{className:"text-xs",children:Ya[_]}),e.jsx("button",{onClick:()=>D(_),className:"ml-1 hover:bg-black/10 rounded-full p-0.5",title:`Quitar ${Ya[_]}`,children:e.jsx(Fa,{className:"w-3 h-3"})})]},_)),e.jsxs(Yf,{children:[e.jsx(qf,{asChild:!0,children:e.jsxs(P,{variant:"outline",size:"sm",className:he("h-8 gap-1",w.length>0&&"border-blue-500"),children:[e.jsx(Eu,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs",children:w.length>0?`Categoras (${w.length})`:"Categoras"})]})}),e.jsx(Pu,{className:"w-56 p-3",align:"end",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[e.jsx(pc,{className:"w-4 h-4"}),"Filtrar por categora"]}),Object.entries(ml).map(([_,R])=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-50 p-1 rounded transition-colors",children:[e.jsx(Va,{checked:w.includes(R),onCheckedChange:()=>T(R)}),e.jsx("span",{className:"text-sm flex-1",children:Ya[R]}),e.jsx("div",{className:he("w-3 h-3 rounded",_r[R].bg),title:Ya[R]})]},_)),w.length>0&&e.jsx(P,{variant:"ghost",size:"sm",className:"w-full mt-2 text-xs",onClick:()=>E([]),children:"Limpiar todo"})]})})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[k.overdue>0&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx("span",{className:"font-semibold",children:k.overdue})," vencidas"]}),k.todayCount>0&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[e.jsx("span",{className:"font-semibold",children:k.todayCount})," hoy"]}),k.future>0&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx("span",{className:"font-semibold",children:k.future})," futuras"]}),k.noDate>0&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:k.noDate})," sin fecha"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 min-w-fit",children:[e.jsx("div",{className:"flex-1 md:min-w-[300px] lg:min-w-[350px]",children:e.jsxs("div",{className:"border rounded-lg p-4 bg-red-50/50 h-full",children:[e.jsx(l$,{tasks:t,onDelete:a,onEdit:s,onView:l,onMove:o}),k.overdue===0&&e.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No hay tareas vencidas"})]})}),e.jsx("div",{className:"flex-1 md:min-w-[400px] lg:min-w-[500px]",children:e.jsxs("div",{className:"border rounded-lg p-4 bg-blue-50/50 h-full",children:[e.jsx(oH,{tasks:t,onDelete:a,onEdit:s,onQuickUpdate:r,onView:l,onMove:o,onToggle:d}),k.todayCount===0&&e.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No hay tareas para hoy"})]})}),e.jsx("div",{className:"flex-1 md:min-w-[300px] lg:min-w-[350px]",children:e.jsxs("div",{className:"border rounded-lg p-4 bg-green-50/50 h-full",children:[e.jsx(cH,{tasks:t,onDelete:a,onEdit:s,onView:l,onMove:o}),k.future===0&&e.jsx("div",{className:"text-center py-8 text-gray-400 text-sm",children:"No hay tareas futuras"})]})}),k.noDate>0&&e.jsx("div",{className:"flex-1 md:min-w-[300px] lg:min-w-[350px]",children:e.jsx("div",{className:"border rounded-lg p-4 bg-gray-50/50 h-full",children:e.jsx(dH,{tasks:t,onDelete:a,onEdit:s,onView:l,onMove:o})})})]})}),t.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"No se encontraron tareas con los filtros aplicados"})})]})},mH=t=>t?t.getHours()!==0||t.getMinutes()!==0||t.getSeconds()!==0||t.getMilliseconds()!==0?{hours:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds(),milliseconds:t.getMilliseconds()}:{hours:8,minutes:0,seconds:0,milliseconds:0}:{hours:8,minutes:0,seconds:0,milliseconds:0},hH=(t,a)=>{const s=new Date(a),r=mH(t.startDate);return s.setHours(r.hours,r.minutes,r.seconds,r.milliseconds),s},BS=["#0088FE","#00C49F","#FFBB28","#FF8042"],fH=({tasks:t,status:a,error:s,editTask:r,deleteTask:l,openEditModal:o,onViewTask:d})=>e.jsx(fe,{children:e.jsxs(xe,{className:"pt-6",children:[e.jsx(AP,{tasks:t,onDelete:l,onEdit:o,onView:d,onMove:(u,m)=>{const h=t.find(x=>x.id===u);if(!h)return;if(!m){r(u,{startDate:void 0,endDate:void 0});return}const g=xu(h.startDate,h.endDate,m);r(u,{startDate:m,endDate:g})},onAssignTimeOfDay:(u,m)=>r(u,{timeOfDay:m}),status:a,error:s||void 0}),s&&e.jsx("div",{className:"text-sm text-red-500 p-2",children:s})]})}),pH=({tasks:t,error:a,editTask:s,deleteTask:r,openEditModal:l,openCreateModal:o,onViewTask:d})=>{const u=(m,h)=>{if(!h){s(m,{startDate:void 0,endDate:void 0});return}const g=t.find(N=>N.id===m);if(!g){s(m,{startDate:h});return}const x=hH(g,h),y=g.startDate&&g.endDate?g.endDate.getTime()-g.startDate.getTime():0,v=y>0?y:0;let b=new Date(x.getTime()+v);b.getTime()<x.getTime()&&(b=new Date(x)),s(m,{startDate:x,endDate:b})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(fe,{className:"w-full",children:e.jsxs(xe,{className:"pt-6 overflow-x-auto",children:[e.jsx(zP,{tasks:t,onDelete:r,onEdit:l,onView:d,onMove:u,onAdd:m=>o(m??void 0),onFilteredTasksChange:()=>{}}),a&&e.jsx("p",{className:"text-sm text-red-500 mt-4",children:a})]})}),e.jsx(UP,{})]})},xH=({tasks:t,editTask:a,deleteTask:s,toggleTask:r,openEditModal:l,onViewTask:o,error:d})=>{const[u,m]=Ef(),h=u.get("search")||"",g=te.useMemo(()=>{const b=u.get("categories");return b?b.split(",").filter(N=>Object.values(ml).includes(N)):[]},[u]),x=b=>{const N={};b.trim()&&(N.search=b),g.length>0&&(N.categories=g.join(",")),m(Object.keys(N).length>0?N:{})},y=b=>{const N={};h.trim()&&(N.search=h),b.length>0&&(N.categories=b.join(",")),m(Object.keys(N).length>0?N:{})},v=te.useMemo(()=>{let b=g.length>0?t.filter(N=>g.includes(N.category)):t;if(h.trim()){const N=h.toLowerCase().trim();b=b.filter(S=>S.title.toLowerCase().includes(N)||S.description&&S.description.toLowerCase().includes(N))}return b},[t,g,h]);return e.jsx(fe,{children:e.jsxs(xe,{className:"p-6",children:[d&&e.jsx("div",{className:"mb-4 text-sm text-red-500 p-2",children:d}),e.jsx(uH,{tasks:v,onDelete:s,onEdit:l,onToggle:r,onQuickUpdate:b=>{a(b.id,{endDate:b.endDate})},onView:o,onMove:(b,N)=>{const S=t.find(E=>E.id===b);if(!S)return;if(!N){a(b,{startDate:void 0,endDate:void 0});return}const w=xu(S.startDate,S.endDate,N);a(b,{startDate:N,endDate:w})},searchQuery:h,onSearchChange:x,selectedCategories:g,onCategoriesChange:y})]})})},gH=({taskStats:t,completionStats:a})=>e.jsxs("div",{className:"grid md:grid-cols-2 xl:grid-cols-2 gap-4 lg:gap-6 xl:gap-8 desktop-grid-responsive",children:[e.jsx(fe,{className:"desktop-card-enhanced",children:e.jsxs(xe,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Progreso de Tareas"}),e.jsx("div",{className:"h-64 lg:h-80",children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(ol,{data:t,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"date"}),e.jsx(Jn,{}),e.jsx(yn,{}),e.jsx(li,{}),e.jsx(ui,{type:"monotone",dataKey:"completed",name:"Completadas",stroke:"#8884d8"}),e.jsx(ui,{type:"monotone",dataKey:"pending",name:"Pendientes",stroke:"#82ca9d"})]})})})]})}),e.jsx(fe,{className:"desktop-card-enhanced",children:e.jsxs(xe,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Estado General"}),e.jsx("div",{className:"h-64 lg:h-80",children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(ry,{children:[e.jsx(iy,{data:a,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({cx:s=0,cy:r=0,midAngle:l=0,innerRadius:o=0,outerRadius:d=0,percent:u=0,name:m})=>{const h=Math.PI/180,g=25+o+(d-o),x=s+g*Math.cos(-l*h),y=r+g*Math.sin(-l*h);return e.jsx("text",{x,y,fill:"#888",textAnchor:x>s?"start":"end",dominantBaseline:"central",children:`${m} (${(u*100).toFixed(0)}%)`})},children:a.map((s,r)=>e.jsx(ly,{fill:BS[r%BS.length]},`cell-${s.name}-${r}`))}),e.jsx(yn,{})]})})})]})})]}),yH=()=>{const t=it(),{viewKey:a}=Ss(),s=a||iS,{user:r}=st(),[l,o]=p.useState([]),[d,u]=p.useState([]),[m,h]=p.useState(!1),[g,x]=p.useState(""),[y,v]=p.useState(!1),[b,N]=p.useState(!1),[S,w]=p.useState(null),[E,T]=p.useState(!1),D=Pf(),{tasks:k,status:_,error:R,showRecurrenceModal:L,currentTask:U,modalMode:V,addTask:F,editTask:G,deleteTask:$,toggleTask:z,completeRecurrentTask:H,setShowRecurrenceModal:I,openCreateModal:O,openEditModal:Y}=D;PD({openCreateModal:O,isModalOpen:L||E}),p.useEffect(()=>{if(!k||k.length===0){o([]),u([]);return}const oe=k.slice(0,100).reduce((Ie,ge)=>{const Be=ge.createdAt?new Date(ge.createdAt.seconds*1e3).toISOString().split("T")[0]:"unknown";return Ie[Be]||(Ie[Be]={date:Be,completed:0,pending:0}),Ie[Be][ge.completed?"completed":"pending"]++,Ie},{});o(Object.values(oe));const _e=k.filter(Ie=>Ie.completed).length,je=k.filter(Ie=>!Ie.completed).length;u([{name:"Completadas",value:_e},{name:"Pendientes",value:je}])},[k]);const le=LD.map(K=>({...K,component:K.key==="list"?fH:K.key==="kanban"?pH:K.key==="calendar"?xH:gH})),re=le.find(K=>K.key===s);if(!re)return e.jsx(Ft,{to:ae.task.view(iS),replace:!0});if(!r)return e.jsx(na,{title:"Tareas",icon:e.jsx(hl,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-8 text-center",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesion para ver tus tareas"})})})})});const Q=()=>{h(!0)},q=()=>{try{const K=JSON.parse(g);if(!Array.isArray(K)){ut.error("El JSON debe contener un array de tareas");return}let oe=0,_e=0;K.forEach(je=>{if(typeof je.title=="string"){let Ie,ge;if(je.startDate||je.dueDate){const Be=je.startDate||je.dueDate,ke=new Date(Be);isNaN(ke.getTime())?(_e++,console.warn(`Fecha invalida para tarea "${je.title}": ${Be}`)):Ie=ke}if(je.endDate){const Be=new Date(je.endDate);isNaN(Be.getTime())?(_e++,console.warn(`Fecha de fin invalida para tarea "${je.title}": ${je.endDate}`)):ge=Be}F({title:je.title,description:je.description||"",startDate:Ie,endDate:ge,category:je.category||"personal",priority:je.priority||void 0,isPrivate:!1,isRecurrent:!!je.isRecurrent||!1,size:je.size==="pequena"?"pequea":je.size}),oe++}}),_e>0?ut.warning(`${oe} tareas importadas. ${_e} fechas invalidas fueron omitidas.`):ut.success(`${oe} tareas importadas correctamente`),x(""),h(!1)}catch(K){ut.error("Error al importar las tareas. Verifica el formato JSON."),console.error("Error de importacion:",K)}},M=()=>{const K=k.map(ge=>({title:ge.title,description:ge.description||"",startDate:ge.startDate?.toISOString()||null,endDate:ge.endDate?.toISOString()||null,category:ge.category,priority:ge.priority||null,isRecurrent:ge.isRecurrent||!1,size:ge.size||null,completed:ge.completed})),oe=JSON.stringify(K,null,2),_e=new Blob([oe],{type:"application/json"}),je=URL.createObjectURL(_e),Ie=document.createElement("a");Ie.href=je,Ie.download=`tareas_${new Date().toISOString().split("T")[0]}.json`,Ie.click(),URL.revokeObjectURL(je),ut.success("Tareas exportadas correctamente")},W=[{id:"config",label:"Configuracion",icon:e.jsx(_s,{className:"h-4 w-4"}),onClick:()=>t(ae.task.config),tooltip:"Configuracion"},{id:"import",label:"Importar",icon:e.jsx(hu,{className:"h-4 w-4"}),onClick:Q,tooltip:"Importar tareas"},{id:"export",label:"Exportar",icon:e.jsx(Or,{className:"h-4 w-4"}),onClick:M,tooltip:"Exportar tareas"},{id:"ai",label:"AI Assistant",icon:e.jsx(PM,{className:"h-4 w-4"}),onClick:()=>{},tooltip:"Asistente IA",dropdown:[{label:"Sugerir tareas",onClick:()=>v(!0)},{label:"Repriorizar visibles",onClick:()=>N(!0)}]},{id:"new",label:"Nuevo",icon:e.jsx(It,{className:"h-4 w-4"}),onClick:()=>O(),tooltip:"Crear nueva tarea",className:"bg-black text-white hover:bg-gray-800",showLabel:!0}],ie=re.component,ve={tasks:k,status:_,error:R,addTask:F,editTask:G,deleteTask:$,toggleTask:z,openEditModal:Y,openCreateModal:O,onViewTask:K=>{w(K),T(!0)},taskStats:l,completionStats:d};return e.jsxs(na,{title:"Tareas",icon:e.jsx(hl,{className:"h-4 w-4 text-white"}),views:le,activeViewKey:s,onViewChange:K=>t(ae.task.view(K)),actions:W,children:[e.jsx("div",{className:"p-4 space-y-4",children:e.jsx(ie,{...ve})}),e.jsx(P,{onClick:()=>O(),className:he("fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg hover:shadow-xl","transition-shadow z-50 lg:hidden bg-black text-white hover:bg-gray-800"),size:"icon",title:"Crear nueva tarea",children:e.jsx(It,{className:"h-6 w-6"})}),e.jsx(ZB,{tasks:k,open:y,onOpenChange:v}),e.jsx(e$,{tasks:k,onUpdate:G,open:b,onOpenChange:N}),e.jsx(S2,{isOpen:L,onClose:()=>I(),onConfirm:K=>{V==="complete"?H(K):V==="edit"?G(U.id,K):F(K)},task:U||{id:"",taskCode:0,title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:V}),e.jsx(YD,{task:S,isOpen:E,onClose:()=>T(!1),onEdit:K=>{T(!1),Y(K)},onToggle:z}),e.jsx(Mt,{open:m,onOpenChange:h,children:e.jsxs(Tt,{className:"max-w-4xl",children:[e.jsxs(Ot,{children:[e.jsx(Rt,{children:"Importar Tareas"}),e.jsx(Ms,{children:"Pega el JSON con las tareas a importar. Puedes incluir fechas en varios formatos."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(sa,{placeholder:`Ejemplo - Importa tareas con fechas en diferentes formatos:
[
  {
    "title": "Completar proyecto importante",
    "description": "Terminar la implementacion",
    "dueDate": "2024-12-31",
    "category": "work",
    "priority": "do",
    "size": "grande"
  },
  {
    "title": "Revision medica anual",
    "description": "Chequeo general de salud",
    "startDate": "2024-07-15T09:00:00Z",
    "category": "health",
    "priority": "decide"
  }
]

Formatos de fecha soportados:
- "2024-12-31" (solo fecha)
- "2024-06-15T14:30:00Z" (fecha y hora ISO)
- "2024-06-15T14:30:00" (fecha y hora local)
- Sin campo "startDate" o "dueDate" = sin fecha asignada
`,value:g,onChange:K=>x(K.target.value),rows:18,className:"font-mono text-sm"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(P,{variant:"outline",onClick:()=>h(!1),children:"Cancelar"}),e.jsx(P,{onClick:q,disabled:!g.trim(),children:"Importar Tareas"})]})]})]})})]})},vH=()=>{const t=it();return e.jsx(na,{title:"Configuracion de Tareas",icon:e.jsx(hl,{className:"h-4 w-4 text-white"}),views:LD.map(a=>({...a,component:()=>null})),onViewChange:a=>t(`/task/view/${a}`),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"No hay configuraciones especificas para Tareas en este modulo."})})})})},bH=t=>{const a=Math.max(0,Math.floor(t)),s=Math.floor(a/3600),r=Math.floor(a%3600/60),l=a%60,o=d=>d.toString().padStart(2,"0");return`${o(s)}:${o(r)}:${o(l)}`};function jH(){const{taskId:t}=Ss(),a=it(),{allTasks:s,editTask:r}=Pf(),l=t??"",o=p.useMemo(()=>s.find(z=>z.id===l),[s,l]),[d,u]=p.useState(""),[m,h]=p.useState(!1),[g,x]=p.useState(0),[y,v]=p.useState(!1),[b,N]=p.useState(null),[S,w]=p.useState(Date.now());p.useEffect(()=>{u(o?.description||"")},[o?.id,o?.description]),p.useEffect(()=>{y||x(o?.elapsedSeconds??0)},[o,y]),p.useEffect(()=>{if(!y)return;const z=setInterval(()=>{w(Date.now())},1e3);return()=>clearInterval(z)},[y]);const E=()=>{if(!y||b===null)return g;const z=Math.floor((S-b)/1e3);return g+Math.max(0,z)},T=()=>{y||(N(Date.now()),w(Date.now()),v(!0))},D=async()=>{if(!y||b===null||!o)return;const z=Math.floor((Date.now()-b)/1e3),H=g+Math.max(0,z);x(H),v(!1),N(null),await r(o.id,{elapsedSeconds:H})},k=p.useMemo(()=>{const z=["bg-gradient-to-br from-blue-900 via-blue-950 to-slate-900","bg-gradient-to-br from-emerald-900 via-teal-900 to-slate-900","bg-gradient-to-br from-purple-900 via-indigo-900 to-slate-900","bg-gradient-to-br from-amber-900 via-orange-900 to-slate-900","bg-gradient-to-br from-rose-900 via-pink-900 to-slate-900","bg-gradient-to-br from-cyan-900 via-blue-900 to-slate-900","bg-gradient-to-br from-violet-900 via-purple-900 to-slate-900","bg-gradient-to-br from-teal-900 via-emerald-900 to-slate-900","bg-gradient-to-br from-indigo-900 via-blue-900 to-slate-900","bg-gradient-to-br from-green-900 via-emerald-900 to-slate-900"],H=o?.taskCode??o?.title.length??0;return z[H%z.length]},[o?.taskCode,o?.title.length]),_=p.useMemo(()=>d?d.split(`
`).map((z,H)=>{const I=z.match(/^\s*-\s\[( |x|X)\]\s(.*)$/);return I?{index:H,checked:I[1].toLowerCase()==="x",text:I[2]}:null}).filter(z=>!!z):[],[d]),R=p.useMemo(()=>d?d.split(`
`).filter(z=>!/^\s*-\s\[( |x|X)\]\s/.test(z)).join(`
`).trim():"",[d]),{total:L,checked:U}=Mu(d||""),V=L>0,F=V?Gl(d||""):0,G=KT(R);if(!o)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-gray-900 to-black text-white",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Tarea no encontrada"}),e.jsxs(P,{variant:"outline",className:"text-white border-white hover:bg-white hover:text-gray-900",onClick:()=>a(-1),children:[e.jsx(fl,{className:"w-4 h-4 mr-2"}),"Volver"]})]})});const $=async z=>{if(!o)return;const H=d.split(`
`),I=H[z]??"",O=I.match(/^\s*-\s\[( |x|X)\]\s/);if(!O)return;const Y=O[1].toLowerCase()==="x"?" ":"x";H[z]=I.replace(/\[( |x|X)\]/,`[${Y}]`);const le=H.join(`
`);u(le),h(!0);try{await r(o.id,{description:le})}finally{h(!1)}};return e.jsx("div",{className:`min-h-screen flex flex-col ${k} text-white`,children:e.jsxs("div",{className:"flex-1 flex flex-col p-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(P,{variant:"ghost",className:"text-white hover:bg-white/20 text-lg font-semibold drop-shadow-lg px-6 py-3",onClick:()=>a(-1),children:[e.jsx(fl,{className:"w-5 h-5 mr-2"}),"Volver"]}),e.jsxs("div",{className:"text-sm font-mono text-white/70 drop-shadow-lg",children:["#",o.taskCode]})]}),e.jsxs("div",{className:"text-center mt-10 mb-8",children:[e.jsx("div",{className:"text-6xl font-mono font-bold drop-shadow-xl bg-black/30 px-6 py-3 rounded-lg backdrop-blur-sm border border-white/20 inline-block",children:bH(E())}),e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-3",children:[e.jsxs(P,{onClick:T,disabled:y,className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Bs,{className:"w-4 h-4 mr-2"}),"Iniciar"]}),e.jsxs(P,{onClick:D,disabled:!y,className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(ay,{className:"w-4 h-4 mr-2"}),"Detener"]})]})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold drop-shadow-xl mb-2",children:o.title}),e.jsx("p",{className:"text-lg text-white/80 drop-shadow-lg",children:Ya[o.category]})]}),e.jsx("div",{className:"flex-1",children:d?e.jsxs("div",{className:"bg-black/20 backdrop-blur-sm rounded-2xl p-6 mx-auto max-w-3xl space-y-4",children:[e.jsx("h2",{className:"text-2xl font-semibold drop-shadow-lg text-center",children:"Detalle y subtareas"}),_.length>0&&e.jsx("div",{className:"space-y-3",children:_.map(z=>e.jsxs("div",{className:`flex items-center gap-3 rounded-lg px-3 py-2 transition ${z.checked?"bg-white/10":"bg-white/5 hover:bg-white/10"}`,children:[e.jsx(Va,{checked:z.checked,onCheckedChange:()=>$(z.index),className:"border-white/60 data-[state=checked]:bg-white data-[state=checked]:text-black"}),e.jsx("span",{className:`text-sm ${z.checked?"line-through text-white/60":"text-white/90"}`,children:z.text})]},z.index))}),e.jsx("div",{className:"prose prose-invert prose-sm max-w-none text-white/90",dangerouslySetInnerHTML:{__html:G}}),V&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-white/80",children:[e.jsx("span",{children:"Progreso de subtareas"}),e.jsxs("span",{children:[U," de ",L," completadas (",Math.round(F),"%)"]})]}),e.jsx(Us,{value:F,className:"h-2"}),m&&e.jsx("div",{className:"text-xs text-white/70",children:"Guardando\\u2026"})]})]}):e.jsx("div",{className:"bg-black/20 backdrop-blur-sm rounded-2xl p-6 mx-auto max-w-3xl text-center text-white/70",children:"Esta tarea no tiene descripci\\u00f3n ni subtareas."})})]})})}const NH={module:"task",defaultRoute:ae.task.view(ae.task.defaultView),moduleRoutes:[{path:"task",element:e.jsx(Ft,{to:ae.task.view(ae.task.defaultView),replace:!0})},{path:"task/view/:viewKey",element:e.jsx(yH,{})},{path:"task/config",element:e.jsx(vH,{})},{path:"task/:taskId/run",element:e.jsx(jH,{})}],legacyRedirects:[{path:"task/list",element:e.jsx(Ft,{to:ae.task.view("list"),replace:!0})},{path:"task/kanban",element:e.jsx(Ft,{to:ae.task.view("kanban"),replace:!0})},{path:"task/calendar",element:e.jsx(Ft,{to:ae.task.view("calendar"),replace:!0})},{path:"tasks/calendar",element:e.jsx(Ft,{to:ae.task.view("calendar"),replace:!0})},{path:"kanban",element:e.jsx(Ft,{to:ae.task.view("kanban"),replace:!0})}]},wH=({onSelect:t,disabled:a})=>{const{moodStates:s}=Cy();return e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:s.map(r=>e.jsx("div",{className:"relative",children:e.jsxs(P,{variant:"outline",onClick:()=>t(r),className:"h-12 text-lg w-full relative",disabled:a,children:[e.jsx("span",{children:r.emoji}),e.jsx("span",{className:"w-full text-center text-xs text-gray-500 mt-1",children:r.text})]})},r.emoji))})},SH=({isOpen:t,onClose:a,moodEntry:s,onSave:r,onDelete:l})=>{const[o,d]=p.useState(""),[u,m]=p.useState(!1);p.useEffect(()=>{s?.time&&d(s.time)},[s]);const h=async()=>{if(s){m(!0);try{const[x,y]=o.split(":").map(Number),v=new Date(s.timestamp),b=$n(v,x,y);await r({...s,time:o,timestamp:b.timestamp}),a()}catch(x){console.error("Error al guardar:",x)}finally{m(!1)}}},g=async()=>{if(l){m(!0);try{await l(),a()}catch(x){console.error("Error al eliminar:",x)}finally{m(!1)}}};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-md",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Editar registro"})}),e.jsxs("div",{className:"flex items-center gap-4 py-4",children:[e.jsx("span",{className:"text-2xl",children:s?.emoji}),e.jsx("span",{children:s?.text})]}),e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"time",className:"text-sm",children:"Hora:"}),e.jsx(ye,{id:"time",type:"time",value:o,onChange:x=>d(x.target.value)})]})}),e.jsxs(Cs,{className:"gap-2 sm:gap-0",children:[l&&e.jsx(P,{variant:"destructive",onClick:g,disabled:u,className:"w-full sm:w-auto",children:"Eliminar"}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(P,{variant:"outline",onClick:a,disabled:u,className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(P,{onClick:h,disabled:u,className:"flex-1 sm:flex-none",children:"Guardar"})]})]})]})})},CH=({moods:t,onUpdateMood:a,onDeleteMood:s})=>{const[r,l]=p.useState(!1),[o,d]=p.useState(null),u=[...t].sort((v,b)=>v.timestamp-b.timestamp),m=r?u:u.slice(0,3),h=t.length>3,g=v=>{d(v)},x=async v=>{o&&await a(o.timestamp,v)},y=async()=>{o&&await s(o.timestamp)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4 space-y-2",children:[m.map((v,b)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded hover:bg-accent transition-colors",children:[e.jsx("span",{className:"text-xl",children:v.emoji}),e.jsx("span",{children:v.text}),e.jsx("span",{className:"text-gray-500 ml-auto",children:v.time}),e.jsx(P,{variant:"ghost",size:"sm",className:"ml-2 h-8 w-8 p-0",onClick:()=>g(v),children:e.jsx(Nf,{className:"h-4 w-4"})})]},`${v.timestamp}_${b}`)),h&&e.jsx(P,{variant:"ghost",className:"w-full h-8 text-sm text-gray-500 hover:text-gray-900",onClick:()=>l(!r),children:r?e.jsxs("span",{className:"flex items-center gap-1",children:["Ver menos ",e.jsx(jf,{className:"h-4 w-4"})]}):e.jsxs("span",{className:"flex items-center gap-1",children:["Ver ms (",t.length-3,") ",e.jsx(rn,{className:"h-4 w-4"})]})}),t.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"No hay registros para este da"})]}),e.jsx(SH,{isOpen:o!==null,onClose:()=>d(null),moodEntry:o,onSave:x,onDelete:y})]})},EH=["bg-red-500 text-white","bg-orange-500 text-white","bg-yellow-400 text-black","bg-lime-500 text-black","bg-green-600 text-white"],TH=[l1,i1,s0,a0,r1],P2=({onSelect:t,disabled:a})=>{const[s,r]=p.useState(""),l=o=>{t(o,s||void 0),r("")};return e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Comentario opcional",value:s,onChange:o=>r(o.target.value),className:"w-full border rounded p-2 text-sm"}),e.jsx("div",{className:"grid grid-cols-5 gap-2 mb-2",children:[1,2,3,4,5].map(o=>{const d=TH[o-1];return e.jsx(P,{variant:"default",className:`h-12 w-full ${EH[o-1]} flex items-center justify-center`,onClick:()=>l(o),disabled:a,children:e.jsx(d,{className:"h-5 w-5"})},o)})})]})},DH=({isOpen:t,onClose:a,energyEntry:s,onSave:r,onDelete:l})=>{const[o,d]=p.useState(""),[u,m]=p.useState(3),[h,g]=p.useState(""),[x,y]=p.useState(!1);p.useEffect(()=>{s&&(d(s.time),m(s.level),g(s.comment||""))},[s]);const v=async()=>{if(s){y(!0);try{const[N,S]=o.split(":").map(Number),w=new Date(s.timestamp),E=$n(w,N,S);await r({level:u,comment:h||void 0,time:o,timestamp:E.timestamp}),a()}finally{y(!1)}}},b=async()=>{if(!(!l||!s)){y(!0);try{await l(),a()}finally{y(!1)}}};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-md",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Editar registro"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"time",className:"text-sm",children:"Hora:"}),e.jsx(ye,{id:"time",type:"time",value:o,onChange:N=>d(N.target.value)})]}),e.jsx(ye,{type:"text",placeholder:"Comentario opcional",value:h,onChange:N=>g(N.target.value)}),e.jsx(P2,{onSelect:N=>m(N),disabled:!1})]}),e.jsxs(Cs,{className:"gap-2 sm:gap-0",children:[l&&e.jsx(P,{variant:"destructive",onClick:b,disabled:x,className:"w-full sm:w-auto",children:"Eliminar"}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(P,{variant:"outline",onClick:a,disabled:x,className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(P,{onClick:v,disabled:x,className:"flex-1 sm:flex-none",children:"Guardar"})]})]})]})})},kH=["bg-red-500","bg-orange-500","bg-yellow-400","bg-lime-500","bg-green-600"],AH=({entries:t,onUpdate:a,onDelete:s})=>{const[r,l]=p.useState(!1),[o,d]=p.useState(null),u=[...t].sort((x,y)=>x.timestamp-y.timestamp),m=t.length>0?Math.round(t.reduce((x,y)=>x+y.level,0)/t.length*10)/10:0,h=async x=>{o&&(await a(o.timestamp,x),d(null))},g=async()=>{o&&(await s(o.timestamp),d(null))};return e.jsxs(e.Fragment,{children:[e.jsx(Py,{type:"single",collapsible:!0,value:r?"history":"",onValueChange:x=>l(!!x),children:e.jsxs(Bf,{value:"history",className:"border-none",children:[e.jsx($f,{className:"w-full h-11 flex items-center justify-between gap-2 border rounded-lg bg-background hover:bg-accent data-[state=open]:rounded-b-none",children:e.jsx("span",{className:"text-sm font-semibold",children:"Historial de hoy"})}),e.jsxs(Hf,{className:"mt-2 space-y-2",children:[u.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm py-2",children:"No hay registros para este da"}):u.map((x,y)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${kH[x.level-1]}`}),e.jsxs("span",{className:"text-sm",children:["Nivel ",x.level]}),x.comment&&e.jsx("span",{className:"text-sm flex-1",children:x.comment}),e.jsx("span",{className:"text-gray-500 ml-auto text-sm",children:x.time}),e.jsx(P,{variant:"ghost",size:"sm",className:"ml-2 h-8 w-8 p-0",onClick:()=>d(x),children:e.jsx(Nf,{className:"h-4 w-4"})})]},`${x.timestamp}_${y}`)),u.length>0&&e.jsxs("div",{className:"text-center text-xs text-muted-foreground",children:["Promedio del da: ",m]})]})]})}),e.jsx(DH,{isOpen:o!==null,onClose:()=>d(null),energyEntry:o,onSave:h,onDelete:g})]})},_H=({selectedDate:t,energyFirst:a=!1})=>{const{user:s}=st(),{moodHistory:r,status:l,error:o,addMood:d,updateMood:u,deleteMood:m}=OT(t),{energyHistory:h,status:g,error:x,addEntry:y,updateEntry:v,deleteEntry:b}=XT(t),{isOnline:N}=Au(),S=h.slice().sort((k,_)=>_.timestamp-k.timestamp)[0],w=["text-red-500","text-orange-500","text-yellow-500","text-lime-600","text-green-600"];if(!s)return e.jsx(fe,{className:"w-full",children:e.jsx(xe,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesin para registrar tu estado de nimo"})})});const E=Ue(t)===Ue(new Date),T=e.jsx(fe,{className:"w-full",children:e.jsxs(xe,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"font-medium",children:"Estado de nimo"}),e.jsx("div",{className:"flex items-center gap-2"})]}),E&&e.jsx(wH,{onSelect:d,disabled:l==="saving"}),e.jsx(CH,{moods:r,onUpdateMood:u,onDeleteMood:m}),o&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:o})]})}),D=e.jsx(fe,{className:"w-full",children:e.jsxs(xe,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h3",{className:"font-medium",children:["Nivel de energa",S&&e.jsxs("span",{className:`ml-2 ${w[S.level-1]}`,children:["(",S.level,")"]})]}),e.jsx("div",{className:"flex items-center gap-2"})]}),E&&e.jsx("div",{className:"mb-4",children:e.jsx(P2,{onSelect:y,disabled:g==="saving"||!N})}),e.jsx(AH,{entries:h,onUpdate:v,onDelete:b}),x&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:x})]})});return e.jsxs("div",{className:"space-y-4",children:[a?D:T,a?T:D]})},B2=[{key:"tracker",label:"Registro diario"},{key:"analytics",label:"Analisis"}],$S="tracker",HS=["#FF8042","#00C49F","#FFBB28","#FF8042","#0088FE","#FF0000"],MH=({selectedDate:t,onDateChange:a})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(jl,{selectedDate:t,onChange:a}),e.jsx(_H,{selectedDate:t})]}),OH=({moodDistribution:t})=>e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(fe,{children:e.jsxs(xe,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Distribucion de Estados de Animo"}),e.jsx("div",{className:"h-64",children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(ry,{children:[e.jsx(iy,{data:t,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({cx:a=0,cy:s=0,midAngle:r=0,innerRadius:l=0,outerRadius:o=0,value:d=0,index:u=0})=>{const m=Math.PI/180,h=25+l+(o-l),g=a+h*Math.cos(-r*m),x=s+h*Math.sin(-r*m);return e.jsx("text",{x:g,y:x,fill:"#888",textAnchor:g>a?"start":"end",dominantBaseline:"central",children:`${t[u].name} (${d})`})},children:t.map((a,s)=>e.jsx(ly,{fill:HS[s%HS.length]},`cell-${a.name}-${s}`))}),e.jsx(yn,{})]})})})]})}),e.jsx(fe,{children:e.jsx(xe,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Patrones y Tendencias"})})})]}),RH=()=>{const t=it(),{viewKey:a}=Ss(),s=a||$S,[r,l]=p.useState(new Date),[o]=p.useState([]),d=B2.map(g=>({...g,component:g.key==="tracker"?MH:OH})),u=d.find(g=>g.key===s);if(!u)return e.jsx(Ft,{to:ae.mood.view($S),replace:!0});const m=[{id:"config",label:"Configuracion",icon:e.jsx(_s,{className:"h-4 w-4"}),onClick:()=>t(ae.mood.config),tooltip:"Configuracion"}],h=u.component;return e.jsx(na,{title:"Estado de Animo",subtitle:"Registra y analiza tu estado emocional para mejorar tu bienestar",icon:e.jsx(r0,{className:"h-4 w-4 text-white"}),views:d,activeViewKey:s,onViewChange:g=>t(ae.mood.view(g)),actions:m,children:e.jsx("div",{className:"p-4 space-y-4",children:e.jsx(h,{selectedDate:r,onDateChange:l,moodDistribution:o})})})};var IH=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],zH=IH.reduce((t,a)=>{const s=Tf(`Primitive.${a}`),r=p.forwardRef((l,o)=>{const{asChild:d,...u}=l,m=d?s:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...u,ref:o})});return r.displayName=`Primitive.${a}`,{...t,[a]:r}},{}),LH="Label",$2=p.forwardRef((t,a)=>e.jsx(zH.label,{...t,ref:a,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(t.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));$2.displayName=LH;var H2=$2;const PH=Dc("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ce=p.forwardRef(({className:t,...a},s)=>e.jsx(H2,{ref:s,className:he(PH(),t),...a}));Ce.displayName=H2.displayName;const BH=()=>{const{user:t}=st(),a=it(),[s,r]=p.useState([]),[l,o]=p.useState(!0),[d,u]=p.useState(null),[m,h]=p.useState({emoji:"",text:"",value:5,category:""});p.useEffect(()=>{t&&g()},[t]);const g=async()=>{if(!t)return;o(!0);const{data:S,error:w}=await sn.getMoodStates(t.id);w?(console.error("Error loading mood states:",w),ut.error("Error al cargar estados de animo")):r(S||[]),o(!1)},x=async S=>{if(S.preventDefault(),!t)return;const w={...m,user_id:t.id};if(d){const{error:E}=await sn.updateMoodState(d,{userId:w.user_id,emoji:w.emoji,text:w.text,value:w.value,category:w.category});E?(console.error("Error updating:",E),ut.error("Error al actualizar")):(ut.success("Estado de animo actualizado"),b(),g())}else{const{error:E}=await sn.createMoodState({userId:w.user_id,emoji:w.emoji,text:w.text,value:w.value,category:w.category});E?(console.error("Error creating:",E),ut.error("Error al crear")):(ut.success("Estado de animo creado"),b(),g())}},y=S=>{u(S.id),h({emoji:S.emoji,text:S.text,value:S.value,category:S.category})},v=async S=>{if(!confirm("Estas seguro de eliminar este estado de animo?"))return;const{error:w}=await sn.deleteMoodState(S);w?(console.error("Error deleting:",w),ut.error("Error al eliminar")):(ut.success("Estado de animo eliminado"),g())},b=()=>{u(null),h({emoji:"",text:"",value:5,category:""})},N=S=>S>=8?{label:"Muy positivo",color:"bg-green-100 text-green-800"}:S>=6?{label:"Positivo",color:"bg-blue-100 text-blue-800"}:S>=4?{label:"Neutral",color:"bg-gray-100 text-gray-800"}:S>=2?{label:"Negativo",color:"bg-orange-100 text-orange-800"}:{label:"Muy negativo",color:"bg-red-100 text-red-800"};return t?e.jsx(na,{title:"Configuracion de Estado de Animo",subtitle:"Administra los estados de animo disponibles",icon:e.jsx(r0,{className:"h-4 w-4 text-white"}),views:B2.map(S=>({...S,component:()=>null})),onViewChange:S=>a(`/mood/view/${S}`),children:e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsxs(mt,{children:[d?"Editar":"Nuevo"," Estado de Animo"]})}),e.jsx(xe,{children:e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"emoji",children:"Emoji"}),e.jsx(ye,{id:"emoji",value:m.emoji,onChange:S=>h({...m,emoji:S.target.value}),placeholder:"",required:!0,maxLength:2}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Copia y pega un emoji"})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"text",children:"Texto"}),e.jsx(ye,{id:"text",value:m.text,onChange:S=>h({...m,text:S.target.value}),placeholder:"Feliz, Triste, Ansioso...",required:!0})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"value",children:"Valor (1-10)"}),e.jsx(ye,{id:"value",type:"number",min:"1",max:"10",value:m.value,onChange:S=>h({...m,value:Number(S.target.value)}),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"10 = Muy positivo, 1 = Muy negativo"})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"category",children:"Categoria (opcional)"}),e.jsx(ye,{id:"category",value:m.category,onChange:S=>h({...m,category:S.target.value}),placeholder:"Emocional, Fisico, Mental..."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{type:"submit",className:"flex-1",children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),d?"Actualizar":"Agregar"]}),d&&e.jsx(P,{type:"button",variant:"outline",onClick:b,children:"Cancelar"})]})]})})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsxs(mt,{children:["Estados de Animo (",s.length,")"]})}),e.jsx(xe,{children:l?e.jsx("p",{children:"Cargando..."}):s.length===0?e.jsx("p",{className:"text-gray-500",children:"No hay estados de animo configurados"}):e.jsx("div",{className:"space-y-2",children:s.map(S=>{const w=N(S.value);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:S.emoji}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:S.text}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("span",{children:["Valor: ",S.value]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${w.color}`,children:w.label}),S.category&&e.jsxs("span",{children:[" ",S.category]})]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(P,{size:"sm",variant:"ghost",onClick:()=>y(S),children:e.jsx(lo,{className:"w-4 h-4"})}),e.jsx(P,{size:"sm",variant:"ghost",onClick:()=>v(S.id),children:e.jsx(Sn,{className:"w-4 h-4 text-red-600"})})]})]},S.id)})})})]})]})})}):e.jsx(na,{title:"Configuracion de Estado de Animo",icon:e.jsx(r0,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4",children:"Inicia sesion para configurar estados de animo"})})},$H={module:"mood",defaultRoute:ae.mood.view(ae.mood.defaultView),moduleRoutes:[{path:"mood",element:e.jsx(Ft,{to:ae.mood.view(ae.mood.defaultView),replace:!0})},{path:"mood/view/:viewKey",element:e.jsx(RH,{})},{path:"mood/config",element:e.jsx(BH,{})}]};class tn{static client=ze;static async getExerciseTypes(a){return ze.from("exercise_types").select("*").eq("user_id",a).order("category",{ascending:!0}).order("name",{ascending:!0})}static subscribeExerciseTypes(a,s){return ze.channel("exercise_types_changes").on("postgres_changes",{event:"*",schema:"public",table:"exercise_types",filter:`user_id=eq.${a}`},s).subscribe()}static async createExerciseType(a){return ze.from("exercise_types").insert({user_id:a.userId,name:a.name,calories_per_hour:a.caloriesPerHour,steps_equivalent:a.stepsEquivalent,category:a.category})}static async updateExerciseType(a,s){return ze.from("exercise_types").update({user_id:s.userId,name:s.name,calories_per_hour:s.caloriesPerHour,steps_equivalent:s.stepsEquivalent,category:s.category}).eq("id",a)}static async deleteExerciseType(a){return ze.from("exercise_types").delete().eq("id",a)}static async getExerciseLogsByDate(a,s){return ze.from("exercise_logs").select("*").eq("user_id",a).eq("date",s)}static async getExerciseLogsRange(a,s,r){return ze.from("exercise_logs").select("date, calories, duration").eq("user_id",a).gte("date",s).lte("date",r).order("date",{ascending:!0})}static async insertExerciseLog(a){const s={user_id:a.userId,date:a.date,exercise_id:a.exerciseLegacyId,sets:a.sets,reps:a.reps,duration:a.duration,distance:a.distance,weight:a.weight,calories:a.calories,steps:a.steps,notes:a.notes};a.exerciseTypeId&&(s.exercise_type_id=a.exerciseTypeId);let r=await ze.from("exercise_logs").insert(s);return r.error&&(r.error.code==="42703"||r.error.message?.includes("exercise_type_id"))&&(delete s.exercise_type_id,r=await ze.from("exercise_logs").insert(s)),r}static async getExerciseLogIdsByDate(a,s){return ze.from("exercise_logs").select("id, exercise_id").eq("user_id",a).eq("date",s).order("id",{ascending:!0})}static async updateExerciseLogById(a,s){const r={exercise_id:s.exerciseLegacyId,sets:s.sets,reps:s.reps,duration:s.duration,distance:s.distance,weight:s.weight,calories:s.calories,steps:s.steps,notes:s.notes};s.exerciseTypeId&&(r.exercise_type_id=s.exerciseTypeId);let l=await ze.from("exercise_logs").update(r).eq("id",a);return l.error&&(l.error.code==="42703"||l.error.message?.includes("exercise_type_id"))&&(delete r.exercise_type_id,l=await ze.from("exercise_logs").update(r).eq("id",a)),l}static async deleteExerciseLogById(a){return ze.from("exercise_logs").delete().eq("id",a)}static async getExerciseStatsRange(a,s,r){return ze.from("exercises").select("date, calories_burned").eq("user_id",a).gte("date",s).lte("date",r).order("date",{ascending:!0})}}const Xf=()=>{const[t,a]=p.useState([]),[s,r]=p.useState(!0),[l,o]=p.useState(null),{user:d}=st();p.useEffect(()=>{if(!d){r(!1);return}u();const x=tn.subscribeExerciseTypes(d.id,()=>{u()});return()=>{x.unsubscribe()}},[d]);const u=async()=>{if(d){r(!0),o(null);try{const{data:x,error:y}=await tn.getExerciseTypes(d.id);if(y)throw y;a(x||[])}catch(x){o(x instanceof Error?x.message:"Error al cargar tipos de ejercicio"),console.error("Error loading exercise types:",x)}finally{r(!1)}}};return{exerciseTypes:t,loading:s,error:l,getExerciseTypeById:x=>t.find(y=>y.id===x),getExerciseTypeByLegacyId:x=>t.find(y=>y.legacy_id===x),getExerciseTypesByCategory:x=>t.filter(y=>y.category===x),reload:u}},HH=t=>{const[a,s]=p.useState([]),[r,l]=p.useState(null),[o,d]=p.useState("idle"),[u,m]=p.useState(null),{user:h}=st(),{exerciseTypes:g,getExerciseTypeById:x}=Xf(),y=w=>w.reduce((E,T)=>{const D=x(T.exerciseId);if(!D)return E;E.totalCalories+=T.calories||0,E.totalSteps+=T.steps||0,E.totalDuration+=T.duration||0,E.totalDistance+=T.distance||0;const k=E.categoryStats[D.category];return k.count+=1,k.duration+=T.duration||0,k.calories+=T.calories||0,E},{totalCalories:0,totalSteps:0,totalDuration:0,totalDistance:0,categoryStats:{cardio:{count:0,duration:0,calories:0},strength:{count:0,duration:0,calories:0},flexibility:{count:0,duration:0,calories:0}}}),v=p.useCallback(async()=>{if(!(!h||g.length===0)){d("loading"),m(null);try{const w=Ue(t),{data:E,error:T}=await tn.getExerciseLogsByDate(h.id,w);if(T)throw T;const D=(E||[]).map(k=>({exerciseId:k.exercise_type_id||k.exercise_id,sets:k.sets,reps:k.reps,duration:k.duration,distance:k.distance,weight:k.weight,calories:k.calories,steps:k.steps,notes:k.notes}));s(D),l(y(D)),d("saved")}catch(w){m(w instanceof Error?w.message:"Error al cargar ejercicios"),d("error")}}},[h,t,g]);return p.useEffect(()=>{v()},[v]),{exerciseLogs:a,summary:r,status:o,error:u,logExercise:async w=>{if(!h)return;d("saving"),m(null);const E=Ue(t),T=a,D=[...a,w];s(D),l(y(D)),d("saved");try{const _=x(w.exerciseId)?.legacy_id??Number(w.exerciseId);if(!Number.isFinite(_))throw new Error("No se pudo resolver exercise_id legacy para el ejercicio seleccionado");const{error:R}=await tn.insertExerciseLog({userId:h.id,date:E,exerciseTypeId:w.exerciseId,exerciseLegacyId:_,sets:w.sets||null,reps:w.reps||null,duration:w.duration||null,distance:w.distance||null,weight:w.weight||null,calories:w.calories||null,steps:w.steps||null,notes:w.notes||null});if(R)throw R;await v()}catch(k){s(T),l(y(T)),m(k instanceof Error?k.message:"Error al guardar ejercicio"),d("error")}},updateExerciseLog:async(w,E)=>{if(!h||a.length===0)return;d("saving"),m(null);const T=Ue(t),D=a,k=[...a];k[w]={...k[w],...E},s(k),l(y(k)),d("saved");try{const{data:_}=await tn.getExerciseLogIdsByDate(h.id,T);if(!_||_.length<=w)throw new Error("Log not found");const R=_[w].id,U=x(k[w].exerciseId)?.legacy_id??Number(k[w].exerciseId);if(!Number.isFinite(U))throw new Error("No se pudo resolver exercise_id legacy para actualizar el ejercicio");const{error:V}=await tn.updateExerciseLogById(R,{exerciseTypeId:k[w].exerciseId,exerciseLegacyId:U,sets:k[w].sets||null,reps:k[w].reps||null,duration:k[w].duration||null,distance:k[w].distance||null,weight:k[w].weight||null,calories:k[w].calories||null,steps:k[w].steps||null,notes:k[w].notes||null});if(V)throw V}catch(_){s(D),l(y(D)),m(_ instanceof Error?_.message:"Error al actualizar ejercicio"),d("error")}},deleteExerciseLog:async w=>{if(!h||a.length===0)return;d("saving"),m(null);const E=Ue(t),T=a,D=a.filter((k,_)=>_!==w);s(D),l(D.length>0?y(D):null),d("saved");try{const{data:k}=await tn.getExerciseLogIdsByDate(h.id,E);if(!k||k.length<=w)throw new Error("Log not found");const _=k[w].id,{error:R}=await tn.deleteExerciseLogById(_);if(R)throw R}catch(k){s(T),l(y(T)),m(k instanceof Error?k.message:"Error al eliminar ejercicio"),d("error")}},loadExerciseData:v}},H0={cardio:{name:"Cardio",description:"Ejercicios cardiovasculares",icon:""},strength:{name:"Fuerza",description:"Ejercicios de fuerza y resistencia",icon:""},flexibility:{name:"Flexibilidad",description:"Ejercicios de estiramiento",icon:""}},UH={cardio:"bg-red-500",strength:"bg-blue-500",flexibility:"bg-green-500"},VH=({exerciseLogs:t,onUpdate:a,onDelete:s,isLoading:r})=>{const{getExerciseTypeById:l}=Xf();if(r)return e.jsx("div",{className:"text-center py-8",children:"Cargando ejercicios..."});if(t.length===0)return e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay ejercicios registrados para este da"});const o=m=>{if(!l(m.exerciseId))return"";const g=[];return m.sets&&m.reps&&g.push(`${m.sets} series x ${m.reps} repeticiones`),m.duration&&g.push(`${m.duration} minutos`),m.distance&&g.push(`${(m.distance/1e3).toFixed(2)} km`),m.steps&&g.push(`${m.steps.toLocaleString()} pasos`),m.weight&&g.push(`${m.weight}kg`),g.join("  ")},d=m=>l(m.exerciseId)?100:0,u=()=>{const m=t.reduce((x,y)=>x+(y.calories||0),0),h=t.reduce((x,y)=>x+(y.steps||0),0),g=t.reduce((x,y)=>x+(y.duration||0),0);return m===0&&h===0?null:e.jsx(fe,{className:"mb-6",children:e.jsxs(xe,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Resumen del da"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[m>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fc,{className:"w-4 h-4 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:m}),e.jsx("p",{className:"text-xs text-gray-500",children:"caloras"})]})]}),h>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x1,{className:"w-4 h-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:h.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"pasos"})]})]}),g>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:g}),e.jsx("p",{className:"text-xs text-gray-500",children:"minutos"})]})})]})]})})};return e.jsxs("div",{className:"space-y-4",children:[u(),t.map((m,h)=>{const g=l(m.exerciseId);return g?e.jsx(fe,{children:e.jsxs(xe,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:g.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:g.name}),e.jsx("p",{className:"text-sm text-gray-500",children:o(m)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:()=>a(h),children:e.jsx(lo,{className:"w-4 h-4"})}),e.jsx(P,{variant:"ghost",size:"icon",onClick:()=>s(h),children:e.jsx(Sn,{className:"w-4 h-4 text-red-500"})})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"flex justify-between text-sm",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded-full ${UH[g.category]} text-white`,children:g.category}),m.calories&&e.jsxs("span",{className:"flex items-center gap-1 text-orange-500",children:[e.jsx(fc,{className:"w-4 h-4"}),m.calories," kcal"]})]})}),e.jsx(Us,{value:d(m),className:"h-2"}),m.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:m.notes})]})]})},h):null})]})};var Qf="Tabs",[YH,I7]=vi(Qf,[yf]),U2=yf(),[qH,nv]=YH(Qf),V2=p.forwardRef((t,a)=>{const{__scopeTabs:s,value:r,onValueChange:l,defaultValue:o,orientation:d="horizontal",dir:u,activationMode:m="automatic",...h}=t,g=gf(u),[x,y]=Mr({prop:r,onChange:l,defaultProp:o??"",caller:Qf});return e.jsx(qH,{scope:s,baseId:wc(),value:x,onValueChange:y,orientation:d,dir:g,activationMode:m,children:e.jsx(Gt.div,{dir:g,"data-orientation":d,...h,ref:a})})});V2.displayName=Qf;var Y2="TabsList",q2=p.forwardRef((t,a)=>{const{__scopeTabs:s,loop:r=!0,...l}=t,o=nv(Y2,s),d=U2(s);return e.jsx(QC,{asChild:!0,...d,orientation:o.orientation,dir:o.dir,loop:r,children:e.jsx(Gt.div,{role:"tablist","aria-orientation":o.orientation,...l,ref:a})})});q2.displayName=Y2;var F2="TabsTrigger",G2=p.forwardRef((t,a)=>{const{__scopeTabs:s,value:r,disabled:l=!1,...o}=t,d=nv(F2,s),u=U2(s),m=X2(d.baseId,r),h=Q2(d.baseId,r),g=r===d.value;return e.jsx(ZC,{asChild:!0,...u,focusable:!l,active:g,children:e.jsx(Gt.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":h,"data-state":g?"active":"inactive","data-disabled":l?"":void 0,disabled:l,id:m,...o,ref:a,onMouseDown:Nt(t.onMouseDown,x=>{!l&&x.button===0&&x.ctrlKey===!1?d.onValueChange(r):x.preventDefault()}),onKeyDown:Nt(t.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&d.onValueChange(r)}),onFocus:Nt(t.onFocus,()=>{const x=d.activationMode!=="manual";!g&&!l&&x&&d.onValueChange(r)})})})});G2.displayName=F2;var W2="TabsContent",K2=p.forwardRef((t,a)=>{const{__scopeTabs:s,value:r,forceMount:l,children:o,...d}=t,u=nv(W2,s),m=X2(u.baseId,r),h=Q2(u.baseId,r),g=r===u.value,x=p.useRef(g);return p.useEffect(()=>{const y=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(y)},[]),e.jsx(bi,{present:l||g,children:({present:y})=>e.jsx(Gt.div,{"data-state":g?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":m,hidden:!y,id:h,tabIndex:0,...d,ref:a,style:{...t.style,animationDuration:x.current?"0s":void 0},children:y&&o})})});K2.displayName=W2;function X2(t,a){return`${t}-trigger-${a}`}function Q2(t,a){return`${t}-content-${a}`}var FH=V2,Z2=q2,J2=G2,ek=K2;const Hu=FH,Bc=p.forwardRef(({className:t,...a},s)=>e.jsx(Z2,{ref:s,className:he("inline-flex h-10 md:h-12 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground w-full md:w-auto overflow-x-auto",t),...a}));Bc.displayName=Z2.displayName;const rr=p.forwardRef(({className:t,...a},s)=>e.jsx(J2,{ref:s,className:he("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 md:px-4 md:py-2 text-sm md:text-base font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm touch-manipulation active:scale-95 min-w-0 flex-1 md:flex-initial",t),...a}));rr.displayName=J2.displayName;const ir=p.forwardRef(({className:t,...a},s)=>e.jsx(ek,{ref:s,className:he("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a}));ir.displayName=ek.displayName;const US=({isOpen:t,onClose:a,onSubmit:s,initialData:r})=>{const{exerciseTypes:l,getExerciseTypeById:o}=Xf(),[d,u]=te.useState(r&&l.length>0&&o(r.exerciseId)||null);te.useEffect(()=>{if(r&&l.length>0&&!d){const N=o(r.exerciseId);N&&u(N)}},[r,l,d,o]);const[m,h]=te.useState({sets:r?.sets?.toString()||"",reps:r?.reps?.toString()||"",weight:r?.weight?.toString()||"",duration:r?.duration?.toString()||"",distance:r?.distance?.toString()||"",steps:r?.steps?.toString()||"",calories:r?.calories?.toString()||"",notes:r?.notes||""}),[g,x]=te.useState(0),y=p.useCallback(()=>{if(!d?.calories_per_hour)return;let N=parseInt(m.duration)||0;!N&&m.sets&&m.reps&&(N=parseInt(m.sets)*parseInt(m.reps)*3/60);let S=d.calories_per_hour*N/60;if(m.weight&&d.category==="strength"){const E=parseInt(m.weight)/5;S*=1+E*.1}const w=Math.round(S);x(w),h(E=>({...E,calories:w.toString()}))},[d,m.duration,m.sets,m.reps,m.weight,h]);p.useEffect(()=>{if(y(),d?.steps_equivalent&&m.distance){const N=parseFloat(m.distance),S=Math.round(N*d.steps_equivalent);h(w=>({...w,steps:S.toString()}))}},[y,m.distance,m.duration,m.weight,d]);const v=N=>{u(N),h({sets:"",reps:"",weight:"",duration:"",distance:"",steps:"",calories:"",notes:""})},b=N=>{if(N.preventDefault(),!d)return;const S={exerciseId:d.id,calories:m.calories?parseInt(m.calories):g,...m.sets&&{sets:parseInt(m.sets)},...m.reps&&{reps:parseInt(m.reps)},...m.weight&&{weight:parseFloat(m.weight)},...m.duration&&{duration:parseInt(m.duration)},...m.distance&&{distance:parseFloat(m.distance)*1e3},...m.steps&&{steps:parseInt(m.steps)},...m.notes&&{notes:m.notes}};s(S),a()};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-[700px] max-h-[90vh] sm:h-auto overflow-y-auto",children:[e.jsx(Ot,{className:"sticky top-0 bg-background z-10 pb-4 mb-4 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(Rt,{className:"flex items-center gap-2 text-xl",children:[d&&!r&&e.jsx(P,{type:"button",variant:"ghost",size:"icon",onClick:()=>u(null),className:"h-8 w-8",children:e.jsx(fl,{className:"h-5 w-5"})}),r?"Editar ejercicio":"Agregar ejercicio"]})})}),e.jsx("form",{onSubmit:b,className:"space-y-6 pt-2",children:d?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("span",{className:"text-3xl",children:d.icon||""}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-lg",children:d.name}),e.jsx("p",{className:"text-sm text-gray-500",children:d.category})]})]}),d.category==="strength"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"sets",children:"Series"}),e.jsx(ye,{id:"sets",type:"number",min:"1",value:m.sets,onChange:N=>h(S=>({...S,sets:N.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"reps",children:"Repeticiones"}),e.jsx(ye,{id:"reps",type:"number",min:"1",value:m.reps,onChange:N=>h(S=>({...S,reps:N.target.value}))})]}),d.name==="Pesas de mano"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"weight",children:"Peso (kg)"}),e.jsx(ye,{id:"weight",type:"number",min:"0",step:"0.5",value:m.weight,onChange:N=>h(S=>({...S,weight:N.target.value}))})]})]}),(d.category==="cardio"||d.category==="flexibility")&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"duration",children:"Duracin (min)"}),e.jsx(ye,{id:"duration",type:"number",min:"1",value:m.duration,onChange:N=>h(S=>({...S,duration:N.target.value}))})]}),d.category==="cardio"&&d.name!=="Natacin"&&d.name!=="Tenis"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"distance",children:"Distancia (km)"}),e.jsx(ye,{id:"distance",type:"number",min:"0",step:"0.1",value:m.distance,onChange:N=>h(S=>({...S,distance:N.target.value}))})]})]}),d.steps_equivalent>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Ce,{htmlFor:"steps",children:["Pasos ",m.steps&&`(calculado: ${m.steps})`]}),e.jsx(ye,{id:"steps",type:"number",min:"0",value:m.steps,onChange:N=>h(S=>({...S,steps:N.target.value})),placeholder:"Nmero de pasos"})]}),g>0&&e.jsx("div",{className:"p-4 bg-muted rounded-md",children:e.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:["Caloras estimadas: ",g," kcal"]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"calories",children:"Caloras"}),e.jsx(ye,{id:"calories",type:"number",min:"0",value:m.calories,onChange:N=>h(S=>({...S,calories:N.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"notes",children:"Notas"}),e.jsx(sa,{id:"notes",value:m.notes,onChange:N=>h(S=>({...S,notes:N.target.value})),placeholder:"Aade notas sobre el ejercicio..."})]}),e.jsxs(Cs,{className:"gap-3 sm:gap-0",children:[e.jsx(P,{type:"button",variant:"outline",className:"flex-1 sm:flex-none",onClick:a,children:"Cancelar"}),e.jsx(P,{type:"submit",className:"flex-1 sm:flex-none",children:r?"Actualizar":"Guardar"})]})]}):e.jsxs(Hu,{defaultValue:"cardio",className:"w-full",children:[e.jsx(Bc,{className:"w-full h-12 grid grid-cols-3 mb-4",children:Object.entries(H0).map(([N,S])=>e.jsxs(rr,{value:N,className:"flex items-center gap-2 text-base p-3",children:[e.jsx("span",{className:"text-xl",children:S.icon}),e.jsx("span",{children:S.name})]},N))}),Object.entries(H0).map(([N])=>e.jsx(ir,{value:N,className:"mt-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:l.filter(S=>S.category===N).map(S=>e.jsxs(P,{type:"button",variant:"outline",className:"flex flex-col items-center p-6 h-auto gap-3",onClick:()=>v(S),children:[e.jsx("span",{className:"text-3xl",children:S.icon||""}),e.jsx("span",{className:"text-sm font-normal text-center",children:S.name})]},S.id))})},N))]})})]})})},GH=({exerciseLogs:t,summary:a})=>{const{getExerciseTypeById:s}=Xf(),r=te.useMemo(()=>a||{totalCalories:t.reduce((u,m)=>u+(m.calories||0),0),totalSteps:t.reduce((u,m)=>u+(m.steps||0),0),totalDuration:t.reduce((u,m)=>u+(m.duration||0),0),totalDistance:t.reduce((u,m)=>u+(m.distance||0),0),categoryStats:t.reduce((u,m)=>{const h=s(m.exerciseId);return h&&(u[h.category]||(u[h.category]={count:0,duration:0,calories:0}),u[h.category].count+=1,u[h.category].duration+=m.duration||0,u[h.category].calories+=m.calories||0),u},{})},[t,a]),l=u=>new Date(u).toLocaleDateString("es-ES",{month:"short",day:"numeric"}),o=(u,m)=>typeof u=="string"?new Date(u).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):u===void 0?"":m?[u.toLocaleString(),m]:u.toLocaleString(),d=te.useMemo(()=>{const u=new Date,m=[];for(let h=6;h>=0;h--){const g=new Date(u);g.setDate(g.getDate()-h);const x=Ue(g);m.push({date:x,calories:0,steps:0,duration:0,distance:0})}return t.forEach(h=>{const g=m.find(x=>x.date===Ue(new Date));g&&(g.calories+=h.calories||0,g.steps+=h.steps||0,g.duration+=h.duration||0,g.distance+=(h.distance||0)/1e3)}),m},[t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(fe,{children:e.jsxs(xe,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(fc,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Caloras"}),e.jsx("h4",{className:"text-2xl font-bold",children:r.totalCalories})]})]})}),e.jsx(fe,{children:e.jsxs(xe,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(x1,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pasos"}),e.jsx("h4",{className:"text-2xl font-bold",children:r.totalSteps.toLocaleString()})]})]})}),e.jsx(fe,{children:e.jsxs(xe,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(pi,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo"}),e.jsxs("h4",{className:"text-2xl font-bold",children:[r.totalDuration," min"]})]})]})}),e.jsx(fe,{children:e.jsxs(xe,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(g1,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Distancia"}),e.jsxs("h4",{className:"text-2xl font-bold",children:[(r.totalDistance/1e3).toFixed(1)," km"]})]})]})})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Progreso"})}),e.jsx(xe,{children:e.jsxs(Hu,{defaultValue:"calories",children:[e.jsxs(Bc,{className:"grid grid-cols-4 h-12",children:[e.jsx(rr,{value:"calories",className:"text-base",children:"Caloras"}),e.jsx(rr,{value:"steps",className:"text-base",children:"Pasos"}),e.jsx(rr,{value:"duration",className:"text-base",children:"Tiempo"}),e.jsx(rr,{value:"distance",className:"text-base",children:"Distancia"})]}),e.jsx(ir,{value:"calories",className:"h-[300px] pt-4",children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(ol,{data:d,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"date",tickFormatter:l}),e.jsx(Jn,{}),e.jsx(yn,{formatter:o,labelFormatter:l}),e.jsx(li,{}),e.jsx(ui,{type:"monotone",dataKey:"calories",stroke:"#f97316",name:"Caloras",dot:!0})]})})}),e.jsx(ir,{value:"steps",className:"h-[300px] pt-4",children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(ol,{data:d,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"date",tickFormatter:l}),e.jsx(Jn,{}),e.jsx(yn,{formatter:o,labelFormatter:l}),e.jsx(li,{}),e.jsx(ui,{type:"monotone",dataKey:"steps",stroke:"#3b82f6",name:"Pasos",dot:!0})]})})}),e.jsx(ir,{value:"duration",className:"h-[300px] pt-4",children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(ol,{data:d,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"date",tickFormatter:l}),e.jsx(Jn,{}),e.jsx(yn,{formatter:o,labelFormatter:l}),e.jsx(li,{}),e.jsx(ui,{type:"monotone",dataKey:"duration",stroke:"#22c55e",name:"Minutos",dot:!0})]})})}),e.jsx(ir,{value:"distance",className:"h-[300px] pt-4",children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(ol,{data:d,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"date",tickFormatter:l}),e.jsx(Jn,{}),e.jsx(yn,{formatter:o,labelFormatter:l}),e.jsx(li,{}),e.jsx(ui,{type:"monotone",dataKey:"distance",stroke:"#a855f7",name:"Kilmetros",dot:!0})]})})})]})})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Resumen por categora"})}),e.jsx(xe,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(y1,{data:Object.entries(H0).map(([u,m])=>{const h=r.categoryStats[u]||{duration:0,calories:0};return{category:m.name,minutos:h.duration,calorias:h.calories}}),children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"category"}),e.jsx(Jn,{yAxisId:"left",orientation:"left",stroke:"#f97316"}),e.jsx(Jn,{yAxisId:"right",orientation:"right",stroke:"#22c55e"}),e.jsx(yn,{}),e.jsx(li,{}),e.jsx(i0,{yAxisId:"left",dataKey:"calorias",fill:"#f97316",name:"Caloras"}),e.jsx(i0,{yAxisId:"right",dataKey:"minutos",fill:"#22c55e",name:"Minutos"})]})})})})]})]})};function WH(t,a){const{user:s}=st(),[r,l]=p.useState([]),[o,d]=p.useState(!0);return p.useEffect(()=>{if(!s){d(!1);return}(async()=>{d(!0);const m=Ue(t),h=Ue(a),{data:g,error:x}=await tn.getExerciseStatsRange(s.id,m,h);if(x){console.error("Error loading exercise stats:",x),d(!1);return}const y={};g?.forEach(v=>{y[v.date]||(y[v.date]={date:v.date,calories:0,count:0}),y[v.date].calories+=v.calories_burned||0,y[v.date].count+=1}),l(Object.values(y)),d(!1)})()},[s,t,a]),{stats:r,loading:o}}const KH=({selectedDate:t})=>{const{start:a,end:s}=p.useMemo(()=>CE(t),[t]),{stats:r,loading:l}=WH(a,s),o=p.useMemo(()=>Math.max(...r.map(m=>m.calories),100),[r]),d=m=>{const h=Math.min(m/o*100,100);return h===0?"bg-gray-100":h<25?"bg-orange-200":h<50?"bg-orange-300":h<75?"bg-orange-400":"bg-orange-500"};if(l)return e.jsx(fe,{children:e.jsx(xe,{className:"p-6",children:"Cargando..."})});const u=new Map(r.map(({date:m,calories:h})=>[m,h]));return e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Calendario de Ejercicios"})}),e.jsxs(xe,{children:[e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Dom","Lun","Mar","Mi","Jue","Vie","Sb"].map(m=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-600",children:m},m)),Array.from({length:35},(m,h)=>{const g=h-new Date(a).getDay(),x=new Date(a);x.setDate(x.getDate()+g);const y=x.toISOString().split("T")[0],v=u.get(y)||0,b=x.getMonth()===t.getMonth();return e.jsxs("div",{className:`aspect-square flex flex-col items-center justify-center p-1 rounded ${b?d(v):"bg-gray-50"}`,title:`${y}: ${v} cal`,children:[e.jsx("span",{className:`text-xs ${b?"text-gray-900":"text-gray-400"}`,children:x.getDate()}),b&&v>0&&e.jsx("span",{className:"text-xs font-bold text-gray-900",children:v})]},h)})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs",children:[e.jsx("span",{children:"Menos"}),e.jsx("div",{className:"flex gap-1",children:["bg-gray-100","bg-orange-200","bg-orange-300","bg-orange-400","bg-orange-500"].map((m,h)=>e.jsx("div",{className:`w-4 h-4 rounded ${m}`},h))}),e.jsx("span",{children:"Ms"})]})]})]})},XH=t=>{const a=new Date(t.getFullYear(),t.getMonth(),1);a.setHours(0,0,0,0);const s=new Date(t.getFullYear(),t.getMonth()+1,0);return s.setHours(23,59,59,999),{start:a,end:s}},QH=t=>{const{user:a}=st(),{settings:s}=Si("exercise",{dailyCalories:500}),[r,l]=p.useState([]),[o,d]=p.useState(!0),u=Number(s.dailyCalories)>0?Number(s.dailyCalories):0;p.useEffect(()=>{if(!a)return;const{start:g,end:x}=XH(t),y=Ue(g),v=Ue(x);let b=!1;return(async()=>{d(!0);const{data:S,error:w}=await tn.getExerciseLogsRange(a.id,y,v);if(b)return;if(w){console.error("Error loading monthly exercise progress:",w),l([]),d(!1);return}const E=new Map;S?.forEach(D=>{const k=D.date,_=E.get(k)??{date:k,calories:0,minutes:0,entries:0,goal:u,percent:0,met:!1};_.calories+=D.calories??0,_.minutes+=D.duration??0,_.entries+=1,E.set(k,_)});const T=Array.from(E.values()).map(D=>{const k=u>0?D.calories/u*100:0;return{...D,goal:u,percent:k,met:k>=100}}).sort((D,k)=>D.date.localeCompare(k.date));l(T),d(!1)})(),()=>{b=!0}},[u,a,t]);const m=p.useMemo(()=>a?r:[],[r,a]),h=p.useMemo(()=>new Map(m.map(g=>[g.date,g])),[m]);return{dailyStats:m,dailyStatsMap:h,loading:a?o:!1,goal:u}},ZH=["L","M","X","J","V","S","D"],U0=19,Pg=2*Math.PI*U0,JH={date:"",calories:0,minutes:0,entries:0,goal:0,percent:0,met:!1},e8=t=>{const a=(t.getDay()+6)%7,s=new Date(t);return s.setDate(s.getDate()-a),s},t8=t=>{const s=6-(t.getDay()+6)%7,r=new Date(t);return r.setDate(r.getDate()+s),r},a8=({selectedDate:t,onDateChange:a})=>{const[s,r]=p.useState(()=>an(t)),{dailyStatsMap:l,loading:o,goal:d}=QH(s),u=Ue(new Date),m=p.useMemo(()=>an(s),[s]),h=p.useMemo(()=>wu(s),[s]),g=p.useMemo(()=>{const S=e8(m),w=t8(h);return uc({start:S,end:w}).map(E=>{const T=Ue(E),D=E.getMonth()===s.getMonth(),k=l.get(T)??{...JH,date:T,goal:d};return{date:E,dateKey:T,isCurrentMonth:D,isToday:T===u,isFuture:T>u,dayNumber:E.getDate(),aggregate:k}})},[l,d,h,m,u,s]),x=p.useMemo(()=>{const S=g.filter(F=>F.isCurrentMonth),w=S.length;let E=0,T=0,D=0,k=0;S.forEach(F=>{const G=F.aggregate;G.met&&(E+=1),G.entries>0&&(T+=1,D+=G.calories,k+=G.minutes)});const _=T>0?Math.round(D/T):0,R=T>0?Math.round(k/T):0,L=u<Ue(h)?new Date:h,U=uc({start:m,end:L}).reverse();let V=0;for(const F of U){const G=Ue(F),$=l.get(G);if(!(!$||$.entries===0)){if($.met){V+=1;continue}break}}return{completedDays:E,exerciseDays:T,totalDays:w,averageCalories:_,averageMinutes:R,currentStreak:V}},[g,l,h,m,u]),y=p.useMemo(()=>Jt(s,"MMMM yyyy",{locale:As}),[s]),v=p.useCallback(()=>{r(S=>an(ey(S)))},[]),b=p.useCallback(()=>{r(S=>an(vf(S,1)))},[]),N=p.useCallback(S=>{!S.isCurrentMonth||S.isFuture||a(new Date(S.date))},[a]);return e.jsxs(fe,{className:"w-full",children:[e.jsx(xt,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:v,className:"h-8 w-8","aria-label":"Mes anterior",children:e.jsx(kc,{className:"h-4 w-4"})}),e.jsx(mt,{className:"text-base font-semibold capitalize text-center",children:y}),e.jsx(P,{variant:"ghost",size:"icon",onClick:b,className:"h-8 w-8","aria-label":"Mes siguiente",children:e.jsx(wn,{className:"h-4 w-4"})})]})}),e.jsxs(xe,{className:"space-y-5",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 text-center text-xs font-medium text-muted-foreground",children:ZH.map(S=>e.jsx("span",{children:S},S))}),e.jsx(Vs,{children:e.jsx("div",{className:"grid grid-cols-7 gap-2",children:g.map(S=>{const w=Math.max(0,Math.min(S.aggregate.percent,100)),E=Pg-w/100*Pg,T=S.isCurrentMonth&&!S.isFuture;let D="#e9ecef";return S.aggregate.entries>0&&(D=S.aggregate.percent>100?"hsl(var(--primary))":"hsl(var(--primary) / 0.75)"),S.isFuture&&(D="#dee2e6"),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs("button",{type:"button",onClick:()=>N(S),disabled:!T,className:he("relative flex h-12 w-12 items-center justify-center rounded-full transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",!S.isCurrentMonth&&"opacity-45",S.isFuture&&"cursor-not-allowed opacity-55",S.isToday&&"bg-primary/10 ring-1 ring-primary/20",T&&"hover:bg-muted/60"),children:[e.jsxs("svg",{className:"absolute h-11 w-11 -rotate-90",viewBox:"0 0 48 48","aria-hidden":"true",children:[e.jsx("circle",{cx:"24",cy:"24",r:U0,fill:"none",stroke:S.isFuture?"#edf0f2":"#e9ecef",strokeWidth:"4"}),S.aggregate.entries>0&&!S.isFuture&&e.jsx("circle",{cx:"24",cy:"24",r:U0,fill:"none",stroke:D,strokeWidth:"4",strokeLinecap:"round",strokeDasharray:Pg,strokeDashoffset:E})]}),e.jsx("span",{className:he("relative z-10 text-sm font-semibold",S.isCurrentMonth?"text-foreground":"text-muted-foreground",S.aggregate.entries===0&&"text-muted-foreground",S.isFuture&&"text-muted-foreground/80"),children:S.dayNumber})]})}),e.jsxs(fa,{side:"left",className:"max-w-[220px] space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium capitalize",children:Jt(S.date,"EEEE d MMMM",{locale:As})}),e.jsxs("p",{children:[S.aggregate.calories," / ",S.aggregate.goal," kcal"]}),e.jsxs("p",{children:[S.aggregate.minutes," minutos"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Math.round(S.aggregate.percent),"% del objetivo"]}),S.aggregate.met&&e.jsx("p",{className:"text-xs font-medium text-green-600",children:" Objetivo cumplido"})]})]},S.dateKey)})})}),o&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cargando progreso mensual..."}),e.jsxs("div",{className:"border-t border-border pt-4",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold",children:"Estadsticas del mes"}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:[e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Racha actual"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold text-primary",children:[x.currentStreak," das ",e.jsx(fc,{className:"mb-1 ml-1 inline h-4 w-4 text-orange-500"})]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Das cumplidos"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[x.completedDays," / ",x.totalDays]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Das con ejercicio"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[x.exerciseDays," / ",x.totalDays]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa] sm:col-span-2 lg:col-span-1 xl:col-span-2",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Promedio diario"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[x.averageCalories," kcal | ",x.averageMinutes," min"]})]})})]})]})]})]})},tk=p.forwardRef(({selectedDate:t},a)=>{const{user:s}=st(),{exerciseLogs:r,summary:l,status:o,error:d,logExercise:u,updateExerciseLog:m,deleteExerciseLog:h}=HH(t),[g,x]=p.useState(!1),[y,v]=p.useState(null);return p.useImperativeHandle(a,()=>({openAddExercise:()=>x(!0)})),s?e.jsx(fe,{className:"w-full",children:e.jsxs(xe,{className:"p-6",children:[e.jsxs(Hu,{defaultValue:"list",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(Bc,{children:[e.jsx(rr,{value:"list",children:"Lista"}),e.jsxs(rr,{value:"stats",className:"gap-2",children:[e.jsx(s1,{className:"w-4 h-4"}),"Estadsticas"]})]}),e.jsxs(P,{onClick:()=>x(!0),className:"gap-2 hidden sm:flex",disabled:o==="saving",children:[e.jsx(It,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Agregar"})]})]}),e.jsx(ir,{value:"list",className:"m-0",children:e.jsx(VH,{exerciseLogs:r,onUpdate:v,onDelete:h,isLoading:o==="loading"})}),e.jsx(ir,{value:"stats",className:"m-0",children:e.jsx(GH,{exerciseLogs:r,summary:l})})]}),d&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:d}),e.jsx(US,{isOpen:g,onClose:()=>x(!1),onSubmit:u,selectedDate:t}),y!==null&&e.jsx(US,{isOpen:!0,onClose:()=>v(null),onSubmit:b=>{m(y,b),v(null)},initialData:r[y],selectedDate:t})]})}):e.jsx(fe,{className:"w-full",children:e.jsx(xe,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesin para registrar tus ejercicios"})})})});tk.displayName="Exercise";const ak=[{key:"daily",label:"Registro diario"},{key:"calendar",label:"Calendario"}],VS="daily",s8=({selectedDate:t,onDateChange:a,exerciseRef:s})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(jl,{selectedDate:t,onChange:a}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr)_320px]",children:[e.jsx(tk,{ref:s,selectedDate:t}),e.jsx(a8,{selectedDate:t,onDateChange:a})]})]}),n8=({selectedDate:t})=>e.jsx(KH,{selectedDate:t}),r8=()=>{const t=it(),{viewKey:a}=Ss(),s=a||VS,[r,l]=p.useState(new Date),{user:o}=st(),d=p.useRef(null),u=ak.map(y=>({...y,component:y.key==="daily"?s8:n8})),m=u.find(y=>y.key===s);if(!m)return e.jsx(Ft,{to:ae.exercise.view(VS),replace:!0});if(!o)return e.jsx(na,{title:"Ejercicio",icon:e.jsx(mc,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsxs(xe,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Inicia sesion"}),e.jsx("p",{className:"text-gray-500",children:"Necesitas iniciar sesion para registrar y ver tus ejercicios"})]})})})});const h=[{id:"config",label:"Configuracion",icon:e.jsx(_s,{className:"h-4 w-4"}),onClick:()=>t(ae.exercise.config),tooltip:"Configuracion"}],g=m.component,x={selectedDate:r,onDateChange:l,exerciseRef:d};return e.jsxs(na,{title:"Registro de Ejercicio",subtitle:"Registra y monitorea tus actividades fisicas diarias",icon:e.jsx(mc,{className:"h-4 w-4 text-white"}),views:u,activeViewKey:s,onViewChange:y=>t(ae.exercise.view(y)),actions:h,children:[e.jsx("div",{className:"p-4 space-y-4",children:e.jsx(g,{...x})}),e.jsx(P,{onClick:()=>d.current?.openAddExercise(),className:"fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow z-50 lg:hidden bg-black text-white hover:bg-gray-800",size:"icon",title:"Agregar ejercicio",children:e.jsx(It,{className:"h-6 w-6"})})]})},i8=()=>{const{user:t}=st(),a=it(),[s,r]=p.useState([]),[l,o]=p.useState(!0),[d,u]=p.useState(null),[m,h]=p.useState({name:"",calories_per_hour:0,steps_equivalent:0,category:""}),g={dailyCalories:500},{settings:x,saveSettings:y,status:v,error:b}=Si("exercise",g),[N,S]=p.useState(x.dailyCalories);p.useEffect(()=>{S(x.dailyCalories)},[x.dailyCalories]),p.useEffect(()=>{t&&w()},[t]);const w=async()=>{if(!t)return;o(!0);const{data:_,error:R}=await tn.getExerciseTypes(t.id);R?(console.error("Error loading exercise types:",R),ut.error("Error al cargar tipos de ejercicio")):r(_||[]),o(!1)},E=async _=>{if(_.preventDefault(),!t)return;const R={...m,user_id:t.id};if(d){const{error:L}=await tn.updateExerciseType(d,{userId:R.user_id,name:R.name,caloriesPerHour:R.calories_per_hour,stepsEquivalent:R.steps_equivalent,category:R.category});L?(console.error("Error updating:",L),ut.error("Error al actualizar")):(ut.success("Tipo de ejercicio actualizado"),k(),w())}else{const{error:L}=await tn.createExerciseType({userId:R.user_id,name:R.name,caloriesPerHour:R.calories_per_hour,stepsEquivalent:R.steps_equivalent,category:R.category});L?(console.error("Error creating:",L),ut.error("Error al crear")):(ut.success("Tipo de ejercicio creado"),k(),w())}},T=_=>{u(_.id),h({name:_.name,calories_per_hour:_.calories_per_hour,steps_equivalent:_.steps_equivalent,category:_.category})},D=async _=>{if(!confirm("Estas seguro de eliminar este tipo de ejercicio?"))return;const{error:R}=await tn.deleteExerciseType(_);R?(console.error("Error deleting:",R),ut.error("Error al eliminar")):(ut.success("Tipo de ejercicio eliminado"),w())},k=()=>{u(null),h({name:"",calories_per_hour:0,steps_equivalent:0,category:""})};return t?e.jsx(na,{title:"Configuracion de Ejercicio",subtitle:"Administra objetivos y tipos de ejercicio",icon:e.jsx(mc,{className:"h-4 w-4 text-white"}),views:ak.map(_=>({..._,component:()=>null})),onViewChange:_=>a(`/exercise/view/${_}`),children:e.jsxs("div",{className:"p-4 space-y-6",children:[e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Objetivo diario de calorias"})}),e.jsxs(xe,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"dailyCalories",children:"Calorias diarias objetivo"}),e.jsx(ye,{id:"dailyCalories",type:"number",value:N,onChange:_=>S(Number(_.target.value))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{onClick:()=>y({dailyCalories:N}),children:"Guardar"}),v==="saving"&&e.jsx("span",{className:"text-xs text-gray-500",children:"Guardando..."}),v==="saved"&&e.jsx("span",{className:"text-xs text-green-600",children:"Guardado"}),b&&e.jsx("span",{className:"text-xs text-red-600",children:b})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsxs(mt,{children:[d?"Editar":"Nuevo"," Tipo de Ejercicio"]})}),e.jsx(xe,{children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"name",children:"Nombre"}),e.jsx(ye,{id:"name",value:m.name,onChange:_=>h({...m,name:_.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"calories",children:"Calorias por hora"}),e.jsx(ye,{id:"calories",type:"number",value:m.calories_per_hour,onChange:_=>h({...m,calories_per_hour:Number(_.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"steps",children:"Equivalente en pasos"}),e.jsx(ye,{id:"steps",type:"number",value:m.steps_equivalent,onChange:_=>h({...m,steps_equivalent:Number(_.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"category",children:"Categoria"}),e.jsx(ye,{id:"category",value:m.category,onChange:_=>h({...m,category:_.target.value}),placeholder:"Cardio, Fuerza, etc."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{type:"submit",className:"flex-1",children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),d?"Actualizar":"Agregar"]}),d&&e.jsx(P,{type:"button",variant:"outline",onClick:k,children:"Cancelar"})]})]})})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsxs(mt,{children:["Tipos de Ejercicio (",s.length,")"]})}),e.jsx(xe,{children:l?e.jsx("p",{children:"Cargando..."}):s.length===0?e.jsx("p",{className:"text-gray-500",children:"No hay tipos de ejercicio configurados"}):e.jsx("div",{className:"space-y-2",children:s.map(_=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:_.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[_.calories_per_hour," cal/h  ",_.steps_equivalent," pasos",_.category&&`  ${_.category}`]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(P,{size:"sm",variant:"ghost",onClick:()=>T(_),children:e.jsx(lo,{className:"w-4 h-4"})}),e.jsx(P,{size:"sm",variant:"ghost",onClick:()=>D(_.id),children:e.jsx(Sn,{className:"w-4 h-4 text-red-600"})})]})]},_.id))})})]})]})]})}):e.jsx(na,{title:"Configuracion de Ejercicio",icon:e.jsx(mc,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6",children:"Inicia sesion para configurar ejercicios"})})})})},l8={module:"exercise",defaultRoute:ae.exercise.view(ae.exercise.defaultView),moduleRoutes:[{path:"exercise",element:e.jsx(Ft,{to:ae.exercise.view(ae.exercise.defaultView),replace:!0})},{path:"exercise/view/:viewKey",element:e.jsx(r8,{})},{path:"exercise/config",element:e.jsx(i8,{})}]},o8=({intake:t,goal:a})=>{const s=()=>{const r=t/a*100;return r>=100?"Excelente! Has alcanzado tu meta diaria ":r>=75?"Vas muy bien! Ya casi llegas a tu meta ":r>=50?"A mitad de camino! Sigue as ":r>=25?"Buen comienzo! Mantn el ritmo ":"Comienza tu da con buena hidratacin! "};return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-medium text-lg flex items-center gap-2",children:[e.jsx(no,{className:"w-5 h-5"}),"Hidratacin"]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:t>a?"text-blue-500 font-medium":"",children:[t,"ml / ",a,"ml"]}),e.jsx("div",{className:"text-xs text-gray-500",children:t>a?`+${t-a}ml extra`:""})]})]}),e.jsx(Us,{value:Math.min(t/a*100,100),className:"h-3"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:s()})]})},c8=({isOpen:t,onClose:a,onSelect:s})=>{const[r,l]=p.useState(null),[o,d]=p.useState("water"),u=Object.entries(Ar).reduce((g,[x,y])=>{const v=y.category;return g[v]||(g[v]=[]),g[v].push({key:x,...y}),g},{}),m=g=>{l(r===g?null:g)},h=g=>{r&&(s(r,g),l(null),a())};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(Ot,{children:e.jsx(Rt,{className:"text-xl",children:"Seleccionar bebida"})}),e.jsxs("div",{className:"flex flex-col gap-4 flex-1",children:[e.jsxs(yt,{value:o,onValueChange:d,children:[e.jsx(ft,{className:"w-full md:w-64",children:e.jsx(vt,{placeholder:"Selecciona una categora"})}),e.jsx(pt,{children:Object.entries(GI).map(([g,x])=>e.jsx(Le,{value:g,children:x},g))})]}),e.jsx(Wf,{className:"flex-1",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 p-1",children:u[o]?.map(g=>{const x=xc[g.icon],y=r===g.key;return e.jsx("div",{className:"relative",children:e.jsxs(P,{variant:y?"default":"outline",className:"w-full h-20 flex flex-col items-center justify-center gap-2 p-3 text-center transition-all hover:scale-105 transform",onClick:()=>m(g.key),children:[e.jsx(x,{className:`w-6 h-6 ${y?"text-white":g.color} flex-shrink-0`}),e.jsx("span",{className:"text-xs leading-tight break-words font-medium",children:g.name})]})},g.key)})})}),r&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-3 sm:flex-shrink-0",children:(()=>{const g=Ar[r],x=xc[g.icon];return e.jsxs(e.Fragment,{children:[e.jsx(x,{className:`w-6 h-6 ${g.color}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:g.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Selecciona la cantidad"})]})]})})()}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2",children:Ar[r].amounts.map(g=>e.jsxs(P,{variant:"outline",size:"sm",className:"bg-white hover:bg-blue-50 border-blue-200 text-blue-700 font-medium transition-all hover:scale-105 transform",onClick:()=>h(g),children:[g,"ml"]},g))})}),e.jsx(P,{variant:"ghost",size:"sm",className:"text-gray-500 hover:text-gray-700 sm:flex-shrink-0",onClick:()=>l(null),children:""})]})})]})]})})},d8=["water","sparklingWater","flavoredWater","coffee","tea","aromatica","milk","juice","sportsdrink","soda","energyDrink"],u8=({selectedDrink:t,onDrinkSelect:a,onAmountSelect:s,disabled:r})=>{const[l,o]=p.useState(!1),d=(m,h)=>{s(m,h),o(!1)},u=m=>{a(t===m?null:m)};return e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Agregar bebida"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Selecciona una bebida para registrar"})]}),"      ",e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:[d8.map(m=>{const h=Ar[m],g=xc[h.icon],x=t===m;return e.jsxs(P,{variant:x?"default":"outline",className:he("h-20 w-full flex flex-col items-center justify-center gap-1 p-2","transition-all duration-200 hover:scale-105",x&&"ring-2 ring-blue-500 ring-offset-1"),onClick:()=>u(m),disabled:r,children:[e.jsx(g,{className:he("w-5 h-5 flex-shrink-0",x?"text-white":h.color)}),e.jsx("span",{className:"text-xs font-medium leading-tight text-center",children:h.name})]},m)}),e.jsxs(P,{variant:"outline",className:"h-20 w-full flex flex-col items-center justify-center gap-1 p-2 border-dashed border-2 hover:border-blue-300 hover:bg-blue-50",onClick:()=>o(!0),disabled:r,children:[e.jsx(It,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ms"})]})]}),t&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:(()=>{const m=Ar[t],h=xc[m.icon];return e.jsxs(e.Fragment,{children:[e.jsx(h,{className:he("w-5 h-5",m.color)}),e.jsx("span",{className:"font-medium text-gray-900",children:m.name})]})})()}),e.jsx(P,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-600 h-8 w-8 p-0",onClick:()=>a(null),children:e.jsx(Fa,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ar[t].amounts.map(m=>e.jsx(P,{variant:"outline",className:"h-10 bg-white hover:bg-blue-50 hover:border-blue-300",onClick:()=>{s(t,m),a(null)},children:e.jsxs("span",{className:"font-medium",children:[m,"ml"]})},m))})]}),e.jsx(c8,{isOpen:l,onClose:()=>o(!1),onSelect:d})]})},m8=({drink:t,isOpen:a,onClose:s,onSave:r})=>{const[l,o]=p.useState(""),[d,u]=p.useState("");if(p.useEffect(()=>{t&&(o(t.amount.toString()),u(t.time))},[t]),!t)return null;const m=Ar[t.type],h=xc[m.icon],g=()=>{const x={...t,amount:parseInt(l),time:d,hydration:parseInt(l)*m.hydrationFactor};r(x),s()};return e.jsx(Mt,{open:a,onOpenChange:s,children:e.jsxs(Tt,{className:"sm:max-w-md",children:[e.jsx(Ot,{children:e.jsxs(Rt,{className:"flex items-center gap-2",children:[e.jsx(h,{className:`w-5 h-5 ${m.color}`}),"Editar ",m.name]})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"amount",className:"text-sm font-medium",children:"Cantidad (ml)"}),e.jsx(ye,{id:"amount",type:"number",value:l,onChange:x=>o(x.target.value),min:"0",step:"50"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"time",className:"text-sm font-medium",children:"Hora"}),e.jsx(ye,{id:"time",type:"time",value:d,onChange:x=>u(x.target.value)})]})]}),e.jsxs(Cs,{className:"sm:justify-start",children:[e.jsx(P,{type:"button",variant:"secondary",onClick:s,children:"Cancelar"}),e.jsx(P,{type:"button",onClick:g,disabled:!l||!d,children:"Guardar cambios"})]})]})})},h8=({drinks:t,showHistory:a,onToggleHistory:s,onDeleteDrink:r,onEditDrink:l,isCurrentDate:o})=>{const[d,u]=p.useState(null),m=(g,x)=>{u({index:g,drink:x})},h=g=>{d&&(l(d.index,g),u(null))};return e.jsxs("div",{children:[e.jsxs(P,{variant:"outline",className:"w-full",onClick:s,children:[a?e.jsx(jf,{className:"w-4 h-4 mr-2"}):e.jsx(rn,{className:"w-4 h-4 mr-2"}),"Historial de hoy"]}),a&&t.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:t.map((g,x)=>{const y=Ar[g.type],v=xc[y.icon];return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[e.jsx(v,{className:`w-5 h-5 ${y.color} flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:y.name}),e.jsxs("span",{className:"text-muted-foreground text-sm font-medium",children:[g.amount,"ml"]})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:g.time})]}),o&&e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(P,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-accent-foreground/10 touch-manipulation",onClick:()=>m(x,g),title:"Editar",children:e.jsx(Nf,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(P,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-destructive/10 touch-manipulation",onClick:()=>r(x),title:"Eliminar",children:e.jsx(Sn,{className:"h-4 w-4 text-destructive"})})]})]},g.timestamp)})}),a&&t.length===0&&e.jsxs("div",{className:"mt-4 text-center text-muted-foreground text-sm py-4",children:[" ","No hay registros para este da"]}),e.jsx(m8,{drink:d?.drink||null,isOpen:!!d,onClose:()=>u(null),onSave:h})]})};function sk(t,a){const{user:s}=st(),[r,l]=p.useState([]),[o,d]=p.useState(!0);return p.useEffect(()=>{if(!s){d(!1);return}(async()=>{d(!1);const m=Ue(t),h=Ue(a),{data:g,error:x}=await bn.getWaterIntakeRange(s.id,m,h);if(x){console.error("Error loading water stats:",x),d(!1);return}const y={};g?.forEach(v=>{y[v.date]||(y[v.date]={date:v.date,intake:0,drinks:{}}),y[v.date].intake+=v.amount_ml||0,y[v.date].drinks[v.drink_type]||(y[v.date].drinks[v.drink_type]=0),y[v.date].drinks[v.drink_type]+=v.amount_ml||0}),l(Object.values(y)),d(!1)})()},[s,t,a]),{stats:r,loading:o}}const f8=({selectedDate:t})=>{const{start:a,end:s}=p.useMemo(()=>CE(t),[t]),{stats:r,loading:l}=sk(a,s),o=p.useMemo(()=>Math.max(...r.map(m=>m.intake),2e3),[r]),d=m=>{const h=Math.min(m/o*100,100);return h===0?"bg-gray-100":h<25?"bg-blue-200":h<50?"bg-blue-300":h<75?"bg-blue-400":"bg-blue-500"};if(l)return e.jsx(fe,{children:e.jsx(xe,{className:"p-6",children:"Cargando..."})});const u=new Map(r.map(({date:m,intake:h})=>[m,h]));return e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Calendario de Hidratacin"})}),e.jsxs(xe,{children:[e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Dom","Lun","Mar","Mi","Jue","Vie","Sb"].map(m=>e.jsx("div",{className:"text-center text-sm font-medium text-gray-600",children:m},m)),Array.from({length:35},(m,h)=>{const g=h-new Date(a).getDay(),x=new Date(a);x.setDate(x.getDate()+g);const y=x.toISOString().split("T")[0],v=u.get(y)||0,b=x.getMonth()===t.getMonth();return e.jsxs("div",{className:`aspect-square flex flex-col items-center justify-center p-1 rounded ${b?d(v):"bg-gray-50"}`,title:`${y}: ${v} ml`,children:[e.jsx("span",{className:`text-xs ${b?"text-gray-900":"text-gray-400"}`,children:x.getDate()}),b&&v>0&&e.jsxs("span",{className:"text-xs font-bold text-gray-900",children:[(v/1e3).toFixed(1),"L"]})]},h)})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-xs",children:[e.jsx("span",{children:"Menos"}),e.jsx("div",{className:"flex gap-1",children:["bg-gray-100","bg-blue-200","bg-blue-300","bg-blue-400","bg-blue-500"].map((m,h)=>e.jsx("div",{className:`w-4 h-4 rounded ${m}`},h))}),e.jsx("span",{children:"Ms"})]})]})]})};function p8(t){const{user:a}=st(),[s,r]=p.useState([]),[l,o]=p.useState(!0);return p.useEffect(()=>{if(!a){o(!1);return}(async()=>{o(!0);const{start:u,end:m}=I5(t),{data:h,error:g}=await bn.getWaterIntakeRange(a.id,Ue(u),Ue(m));if(g){console.error("Error loading weekly water stats:",g),o(!1);return}const x={};h?.forEach(y=>{x[y.date]||(x[y.date]={date:y.date,intake:0,drinks:{}}),x[y.date].intake+=y.amount_ml||0,x[y.date].drinks[y.drink_type]||(x[y.date].drinks[y.drink_type]=0),x[y.date].drinks[y.drink_type]+=y.amount_ml||0}),r(Object.values(x)),o(!1)})()},[a,t]),{stats:s,loading:l}}const nk=()=>{const[t,a]=p.useState([]),[s,r]=p.useState(!0),[l,o]=p.useState(null),{user:d}=st();p.useEffect(()=>{if(!d){r(!1);return}u();const g=bn.subscribeDrinkTypes(d.id,()=>{u()});return()=>{g.unsubscribe()}},[d]);const u=async()=>{if(d){r(!0),o(null);try{const{data:g,error:x}=await bn.getDrinkTypes(d.id);if(x)throw x;a(g||[])}catch(g){o(g instanceof Error?g.message:"Error al cargar tipos de bebida"),console.error("Error loading drink types:",g)}finally{r(!1)}}};return{drinkTypes:t,loading:s,error:l,getDrinkTypeById:g=>t.find(x=>x.id===g),getDrinkTypeByName:g=>t.find(x=>x.name===g),reload:u}},x8=({selectedDate:t})=>{const{stats:a,loading:s}=p8(t),{getDrinkTypeByName:r}=nk();if(s)return e.jsx(fe,{children:e.jsx(xe,{className:"p-6",children:"Cargando..."})});const l=a.map(m=>{const h={date:new Date(m.date).toLocaleDateString("es-ES",{weekday:"short"}),total:m.intake};return Object.entries(m.drinks).forEach(([g,x])=>{h[g]=x}),h}),o=Array.from(new Set(a.flatMap(m=>Object.keys(m.drinks)))),d=a.reduce((m,h)=>m+h.intake,0),u=a.length>0?d/7:0;return e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Estadsticas Semanales"})}),e.jsxs(xe,{children:[e.jsxs("div",{className:"mb-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Semanal"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(d/1e3).toFixed(1),"L"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Promedio Diario"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(u/1e3).toFixed(1),"L"]})]})]}),e.jsx(gn,{width:"100%",height:300,children:e.jsxs(y1,{data:l,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"date"}),e.jsx(Jn,{}),e.jsx(yn,{}),e.jsx(li,{}),e.jsx(i0,{dataKey:"total",fill:"#3b82f6",name:"Total"})]})}),o.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Desglose por Bebida"}),e.jsx("div",{className:"space-y-2",children:o.map(m=>{const h=a.reduce((x,y)=>x+(y.drinks[m]||0),0),g=r(m);return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:g?.name||m}),e.jsxs("span",{className:"text-sm font-medium",children:[(h/1e3).toFixed(1),"L"]})]},m)})})]})]})]})},YS=["#3b82f6","#06b6d4","#8b5cf6","#ec4899","#f59e0b","#10b981"],g8=({initialStartDate:t,initialEndDate:a})=>{const[s,r]=p.useState(t||new Date(Date.now()-2592e6)),[l,o]=p.useState(a||new Date),{stats:d,loading:u}=sk(s,l),{getDrinkTypeByName:m}=nk(),h=()=>{const w=Math.ceil((l.getTime()-s.getTime())/864e5);r(new Date(s.getTime()-w*24*60*60*1e3)),o(new Date(l.getTime()-w*24*60*60*1e3))},g=()=>{const w=Math.ceil((l.getTime()-s.getTime())/864e5),E=new Date(l.getTime()+w*24*60*60*1e3);E<=new Date&&(r(new Date(s.getTime()+w*24*60*60*1e3)),o(E))};if(u)return e.jsx(fe,{children:e.jsx(xe,{className:"p-6",children:"Cargando..."})});const x=d.map(w=>({date:new Date(w.date).toLocaleDateString("es-ES",{month:"short",day:"numeric"}),intake:w.intake/1e3})),y={};d.forEach(w=>{Object.entries(w.drinks).forEach(([E,T])=>{y[E]=(y[E]||0)+T})});const v=Object.entries(y).map(([w,E])=>({name:m(w)?.name||w,value:E/1e3})),b=d.reduce((w,E)=>w+E.intake,0),N=d.length>0?b/d.length:0,S=Math.max(...d.map(w=>w.intake),0);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(fe,{children:e.jsx(xe,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{onClick:h,variant:"outline",size:"sm",children:e.jsx(kc,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium",children:[s.toLocaleDateString("es-ES")," - ",l.toLocaleDateString("es-ES")]}),e.jsx(P,{onClick:g,variant:"outline",size:"sm",disabled:l>=new Date,children:e.jsx(wn,{className:"w-4 h-4"})})]})})}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Resumen del Perodo"})}),e.jsx(xe,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(b/1e3).toFixed(1),"L"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Promedio"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(N/1e3).toFixed(1),"L"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Mximo"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(S/1e3).toFixed(1),"L"]})]})]})})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Tendencia Diaria"})}),e.jsx(xe,{children:e.jsx(gn,{width:"100%",height:300,children:e.jsxs(ol,{data:x,children:[e.jsx(ii,{strokeDasharray:"3 3"}),e.jsx(kr,{dataKey:"date"}),e.jsx(Jn,{label:{value:"Litros",angle:-90,position:"insideLeft"}}),e.jsx(yn,{}),e.jsx(li,{}),e.jsx(ui,{type:"monotone",dataKey:"intake",stroke:"#3b82f6",name:"Consumo (L)"})]})})})]}),v.length>0&&e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Distribucin por Tipo de Bebida"})}),e.jsx(xe,{children:e.jsx(gn,{width:"100%",height:300,children:e.jsxs(ry,{children:[e.jsx(iy,{data:v,cx:"50%",cy:"50%",labelLine:!1,label:w=>`${w.name}: ${w.value.toFixed(1)}L`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:v.map((w,E)=>e.jsx(ly,{fill:YS[E%YS.length]},`cell-${E}`))}),e.jsx(yn,{})]})})})]})]})},y8=t=>{const a=new Date(t.getFullYear(),t.getMonth(),1);a.setHours(0,0,0,0);const s=new Date(t.getFullYear(),t.getMonth()+1,0);return s.setHours(23,59,59,999),{start:a,end:s}},v8=(t,a)=>{const{user:s}=st(),{settings:r}=Si("water",{dailyGoalMl:2e3}),[l,o]=p.useState([]),[d,u]=p.useState(!0),m=Number(r.dailyGoalMl)>0?Number(r.dailyGoalMl):0,h=Number(a)>0?Number(a):m;p.useEffect(()=>{if(!s)return;const{start:y,end:v}=y8(t),b=Ue(y),N=Ue(v);let S=!1;return(async()=>{u(!0);const{data:E,error:T}=await bn.getDrinkLogsRange(s.id,b,N);if(S)return;if(T){console.error("Error loading monthly water progress:",T),o([]),u(!1);return}const D=new Map;E?.forEach(_=>{const R=_.date,L=D.get(R)??{date:R,intakeMl:0,entries:0,goalMl:h,percent:0,met:!1},U=_.hydration_value??_.amount??0;L.intakeMl+=U,L.entries+=1,D.set(R,L)});const k=Array.from(D.values()).map(_=>{const R=h>0?_.intakeMl/h*100:0;return{..._,goalMl:h,percent:R,met:R>=100}}).sort((_,R)=>_.date.localeCompare(R.date));o(k),u(!1)})(),()=>{S=!0}},[h,s,t]);const g=p.useMemo(()=>s?l:[],[l,s]),x=p.useMemo(()=>new Map(g.map(y=>[y.date,y])),[g]);return{dailyStats:g,dailyStatsMap:x,loading:s?d:!1,goalMl:h}},b8=["L","M","X","J","V","S","D"],V0=19,Bg=2*Math.PI*V0,j8={date:"",intakeMl:0,entries:0,goalMl:0,percent:0,met:!1},N8=t=>{const a=(t.getDay()+6)%7,s=new Date(t);return s.setDate(s.getDate()-a),s},w8=t=>{const s=6-(t.getDay()+6)%7,r=new Date(t);return r.setDate(r.getDate()+s),r},S8=({selectedDate:t,onDateChange:a,goalMl:s})=>{const[r,l]=p.useState(()=>an(t)),{dailyStatsMap:o,loading:d,goalMl:u}=v8(r,s),m=Ue(new Date),h=p.useMemo(()=>an(r),[r]),g=p.useMemo(()=>wu(r),[r]),x=p.useMemo(()=>{const w=N8(h),E=w8(g);return uc({start:w,end:E}).map(T=>{const D=Ue(T),k=T.getMonth()===r.getMonth(),_=o.get(D)??{...j8,date:D,goalMl:u};return{date:T,dateKey:D,isCurrentMonth:k,isToday:D===m,isFuture:D>m,dayNumber:T.getDate(),aggregate:_}})},[o,g,h,u,m,r]),y=p.useMemo(()=>{const w=x.filter(V=>V.isCurrentMonth),E=w.length;let T=0,D=0,k=0;w.forEach(V=>{const F=V.aggregate;F.met&&(T+=1),F.entries>0&&(D+=1,k+=F.intakeMl)});const _=D>0?Math.round(k/D):0,R=m<Ue(g)?new Date:g,L=uc({start:h,end:R}).reverse();let U=0;for(const V of L){const F=Ue(V),G=o.get(F);if(!(!G||G.entries===0)){if(G.met){U+=1;continue}break}}return{completedDays:T,hydrationDays:D,totalDays:E,averageIntake:_,currentStreak:U}},[x,o,g,h,m]),v=p.useMemo(()=>Jt(r,"MMMM yyyy",{locale:As}),[r]),b=p.useCallback(()=>{l(w=>an(ey(w)))},[]),N=p.useCallback(()=>{l(w=>an(vf(w,1)))},[]),S=p.useCallback(w=>{!w.isCurrentMonth||w.isFuture||a(new Date(w.date))},[a]);return e.jsxs(fe,{className:"w-full",children:[e.jsx(xt,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:b,className:"h-8 w-8","aria-label":"Mes anterior",children:e.jsx(kc,{className:"h-4 w-4"})}),e.jsx(mt,{className:"text-base font-semibold capitalize text-center",children:v}),e.jsx(P,{variant:"ghost",size:"icon",onClick:N,className:"h-8 w-8","aria-label":"Mes siguiente",children:e.jsx(wn,{className:"h-4 w-4"})})]})}),e.jsxs(xe,{className:"space-y-5",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 text-center text-xs font-medium text-muted-foreground",children:b8.map(w=>e.jsx("span",{children:w},w))}),e.jsx(Vs,{children:e.jsx("div",{className:"grid grid-cols-7 gap-2",children:x.map(w=>{const E=Math.max(0,Math.min(w.aggregate.percent,100)),T=Bg-E/100*Bg,D=w.isCurrentMonth&&!w.isFuture;let k="#e9ecef";return w.aggregate.entries>0&&(k=w.aggregate.percent>100?"#0d6efd":"#4098ff"),w.isFuture&&(k="#dee2e6"),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs("button",{type:"button",onClick:()=>S(w),disabled:!D,className:he("relative flex h-12 w-12 items-center justify-center rounded-full transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",!w.isCurrentMonth&&"opacity-45",w.isFuture&&"cursor-not-allowed opacity-55",w.isToday&&"bg-blue-500/10 ring-1 ring-blue-500/25",D&&"hover:bg-muted/60"),children:[e.jsxs("svg",{className:"absolute h-11 w-11 -rotate-90",viewBox:"0 0 48 48","aria-hidden":"true",children:[e.jsx("circle",{cx:"24",cy:"24",r:V0,fill:"none",stroke:w.isFuture?"#edf0f2":"#e9ecef",strokeWidth:"4"}),w.aggregate.entries>0&&!w.isFuture&&e.jsx("circle",{cx:"24",cy:"24",r:V0,fill:"none",stroke:k,strokeWidth:"4",strokeLinecap:"round",strokeDasharray:Bg,strokeDashoffset:T})]}),e.jsx("span",{className:he("relative z-10 text-sm font-semibold",w.isCurrentMonth?"text-foreground":"text-muted-foreground",w.aggregate.entries===0&&"text-muted-foreground",w.isFuture&&"text-muted-foreground/80"),children:w.dayNumber})]})}),e.jsxs(fa,{side:"left",className:"max-w-[220px] space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium capitalize",children:Jt(w.date,"EEEE d MMMM",{locale:As})}),e.jsxs("p",{children:[Math.round(w.aggregate.intakeMl)," / ",Math.round(w.aggregate.goalMl)," ml"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Math.round(w.aggregate.percent),"% del objetivo"]}),w.aggregate.met&&e.jsx("p",{className:"text-xs font-medium text-green-600",children:" Objetivo cumplido"})]})]},w.dateKey)})})}),d&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cargando progreso mensual..."}),e.jsxs("div",{className:"border-t border-border pt-4",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold",children:"Estadsticas del mes"}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:[e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Racha actual"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold text-blue-600",children:[y.currentStreak," das ",e.jsx(ty,{className:"mb-1 ml-1 inline h-4 w-4 text-blue-600"})]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Das cumplidos"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[y.completedDays," / ",y.totalDays]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Das con hidratacin"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[y.hydrationDays," / ",y.totalDays]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa] sm:col-span-2 lg:col-span-1 xl:col-span-2",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Promedio diario"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[y.averageIntake," ml"]})]})})]})]})]})]})},C8=({selectedDate:t,goal:a})=>{const[s,r]=p.useState(null),[l,o]=p.useState(!1),{user:d}=st(),{intake:u,drinks:m,status:h,error:g,addDrink:x,editDrink:y,deleteDrink:v}=MT(t);if(!d)return e.jsx(fe,{className:"w-full",children:e.jsx(xe,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesin para registrar tu hidratacin"})})});const b=Ue(t)===Ue(new Date);return e.jsx(fe,{className:"w-full shadow-sm border-0 bg-gradient-to-br from-white to-blue-50/30",children:e.jsx(xe,{className:"p-6 md:p-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(o8,{intake:u,goal:a}),b&&e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:e.jsx(u8,{selectedDrink:s,onDrinkSelect:r,onAmountSelect:(N,S)=>{x(N,S),r(null)},disabled:h==="saving"})}),e.jsx(h8,{drinks:m,showHistory:l,onToggleHistory:()=>o(!l),onDeleteDrink:v,onEditDrink:y,isCurrentDate:b}),g&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 shadow-sm",children:e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex-shrink-0"}),g]})}),h==="saving"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow-sm",children:e.jsxs("p",{className:"text-sm text-blue-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin flex-shrink-0"}),"Guardando tu progreso..."]})})]})})})},rk=[{key:"daily",label:"Registro diario"},{key:"calendar",label:"Calendario"},{key:"weekly",label:"Semanal"},{key:"range",label:"Rango"}],qS="daily",E8=({selectedDate:t,onDateChange:a,goalMl:s})=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(jl,{selectedDate:t,onChange:a}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr)_320px]",children:[e.jsx(C8,{selectedDate:t,goal:s}),e.jsx(S8,{selectedDate:t,onDateChange:a,goalMl:s})]})]}),T8=({selectedDate:t})=>e.jsx(f8,{selectedDate:t}),D8=({selectedDate:t})=>e.jsx(x8,{selectedDate:t}),k8=()=>e.jsx(g8,{}),A8=()=>{const t=it(),{viewKey:a}=Ss(),s=a||qS,[r,l]=p.useState(new Date),{user:o}=st(),{settings:d}=Si("water",{dailyGoalMl:2e3}),u=Number(d.dailyGoalMl)>0?Number(d.dailyGoalMl):2e3,m=rk.map(y=>({...y,component:y.key==="daily"?E8:y.key==="calendar"?T8:y.key==="weekly"?D8:k8})),h=m.find(y=>y.key===s);if(!h)return e.jsx(Ft,{to:ae.water.view(qS),replace:!0});if(!o)return e.jsx(na,{title:"Registro de Hidratacion",icon:e.jsx(no,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-8 text-center",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesion para registrar tu hidratacion"})})})})});const g=[{id:"config",label:"Configuracion",icon:e.jsx(_s,{className:"h-4 w-4"}),onClick:()=>t(ae.water.config),tooltip:"Configuracion"}],x=h.component;return e.jsx(na,{title:"Registro de Hidratacion",subtitle:"Monitorea tu consumo diario de liquidos",icon:e.jsx(no,{className:"h-4 w-4 text-white"}),views:m,activeViewKey:s,onViewChange:y=>t(ae.water.view(y)),actions:g,children:e.jsx("div",{className:"p-4 space-y-4",children:e.jsx(x,{selectedDate:r,onDateChange:l,goalMl:u})})})},_8=()=>{const{user:t}=st(),a=it(),[s,r]=p.useState([]),[l,o]=p.useState(!0),[d,u]=p.useState(null),[m,h]=p.useState({name:"",hydration_factor:1,color:"#3b82f6",icon:"Droplet",category:"water"}),g={dailyGoalMl:2e3},{settings:x,saveSettings:y,status:v,error:b}=Si("water",g),[N,S]=p.useState(null),w=p.useCallback(async()=>{if(!t)return;o(!0);const{data:_,error:R}=await bn.getDrinkTypes(t.id);R?(console.error("Error loading drink types:",R),ut.error("Error al cargar tipos de bebida")):r(_||[]),o(!1)},[t]);p.useEffect(()=>{if(t){const _=window.setTimeout(()=>{w()},0);return()=>window.clearTimeout(_)}},[w,t]);const E=async _=>{if(_.preventDefault(),!t)return;const R={...m,user_id:t.id};if(d){const{error:L}=await bn.updateDrinkType(d,{userId:R.user_id,name:R.name,hydrationFactor:R.hydration_factor,color:R.color,icon:R.icon,category:R.category});L?(console.error("Error updating:",L),ut.error("Error al actualizar")):(ut.success("Tipo de bebida actualizado"),k(),w())}else{const{error:L}=await bn.createDrinkType({userId:R.user_id,name:R.name,hydrationFactor:R.hydration_factor,color:R.color,icon:R.icon,category:R.category});L?(console.error("Error creating:",L),ut.error("Error al crear")):(ut.success("Tipo de bebida creado"),k(),w())}},T=_=>{u(_.id),h({name:_.name,hydration_factor:_.hydration_factor,color:_.color,icon:_.icon,category:_.category})},D=async _=>{if(!confirm("Estas seguro de eliminar este tipo de bebida?"))return;const{error:R}=await bn.deleteDrinkType(_);R?(console.error("Error deleting:",R),ut.error("Error al eliminar")):(ut.success("Tipo de bebida eliminado"),w())},k=()=>{u(null),h({name:"",hydration_factor:1,color:"#3b82f6",icon:"Droplet",category:"water"})};return t?e.jsx(na,{title:"Configuracion de Bebidas",subtitle:"Administra los tipos de bebida disponibles",icon:e.jsx(no,{className:"h-4 w-4 text-white"}),views:rk.map(_=>({..._,component:()=>null})),onViewChange:_=>a(`/water/view/${_}`),children:e.jsxs("div",{className:"p-4",children:[e.jsxs(fe,{className:"mb-6",children:[e.jsx(xt,{children:e.jsx(mt,{children:"Objetivo diario de hidratacin"})}),e.jsxs(xe,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"dailyGoalMl",children:"Meta diaria (ml)"}),e.jsx(ye,{id:"dailyGoalMl",type:"number",value:N??x.dailyGoalMl,onChange:_=>S(Number(_.target.value))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{onClick:()=>y({dailyGoalMl:N??x.dailyGoalMl}),children:"Guardar"}),v==="saving"&&e.jsx("span",{className:"text-xs text-gray-500",children:"Guardando..."}),v==="saved"&&e.jsx("span",{className:"text-xs text-green-600",children:"Guardado"}),b&&e.jsx("span",{className:"text-xs text-red-600",children:b})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsxs(mt,{children:[d?"Editar":"Nuevo"," Tipo de Bebida"]})}),e.jsx(xe,{children:e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"name",children:"Nombre"}),e.jsx(ye,{id:"name",value:m.name,onChange:_=>h({...m,name:_.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"hydration",children:"Factor de hidratacion (0-1)"}),e.jsx(ye,{id:"hydration",type:"number",step:"0.1",min:"0",max:"1",value:m.hydration_factor,onChange:_=>h({...m,hydration_factor:Number(_.target.value)}),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"1.0 = 100% hidratante (agua pura)"})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"color",children:"Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ye,{id:"color",type:"color",value:m.color,onChange:_=>h({...m,color:_.target.value}),className:"w-20"}),e.jsx(ye,{value:m.color,onChange:_=>h({...m,color:_.target.value}),placeholder:"#3b82f6"})]})]}),e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"category",children:"Categoria"}),e.jsx(ye,{id:"category",value:m.category,onChange:_=>h({...m,category:_.target.value}),placeholder:"water, coffee, juice, etc."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{type:"submit",className:"flex-1",children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),d?"Actualizar":"Agregar"]}),d&&e.jsx(P,{type:"button",variant:"outline",onClick:k,children:"Cancelar"})]})]})})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsxs(mt,{children:["Tipos de Bebida (",s.length,")"]})}),e.jsx(xe,{children:l?e.jsx("p",{children:"Cargando..."}):s.length===0?e.jsx("p",{className:"text-gray-500",children:"No hay tipos de bebida configurados"}):e.jsx("div",{className:"space-y-2",children:s.map(_=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded",style:{backgroundColor:_.color}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:_.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Hidratacion: ",(_.hydration_factor*100).toFixed(0),"%",_.category&&`  ${_.category}`]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(P,{size:"sm",variant:"ghost",onClick:()=>T(_),children:e.jsx(lo,{className:"w-4 h-4"})}),e.jsx(P,{size:"sm",variant:"ghost",onClick:()=>D(_.id),children:e.jsx(Sn,{className:"w-4 h-4 text-red-600"})})]})]},_.id))})})]})]})]})}):e.jsx(na,{title:"Configuracion de Bebidas",icon:e.jsx(no,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4",children:"Inicia sesion para configurar bebidas"})})},M8={module:"water",defaultRoute:ae.water.view(ae.water.defaultView),moduleRoutes:[{path:"water",element:e.jsx(Ft,{to:ae.water.view(ae.water.defaultView),replace:!0})},{path:"water/view/:viewKey",element:e.jsx(A8,{})},{path:"water/config",element:e.jsx(_8,{})}]},O8=({onLock:t})=>e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(BM,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Mi Diario"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long"})})}),e.jsx(P,{variant:"ghost",size:"icon",onClick:t,title:"Bloquear diario",children:e.jsx(v1,{className:"w-4 h-4"})})]})]}),R8=({value:t,onChange:a})=>e.jsx(sa,{value:t,onChange:s=>a(s.target.value),placeholder:"Cmo ha sido tu da?",className:"w-full h-64 resize-none"}),ik=({lastUpdated:t,className:a=""})=>t?e.jsxs("div",{className:`flex items-center gap-2 text-sm text-gray-500 ${a}`,children:[e.jsx(xs,{className:"w-4 h-4"}),e.jsxs("span",{children:["ltima actualizacin: ",t]})]}):null,I8=({onUnlock:t,lastUpdated:a})=>{const[s,r]=p.useState(""),[l,o]=p.useState(!1),d=u=>{u.preventDefault(),s==="1234"?(t(),o(!1)):o(!0)};return e.jsx(fe,{className:"w-full",children:e.jsx(xe,{className:"p-4",children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx(v1,{className:"w-12 h-12 text-blue-500"})}),e.jsx("h3",{className:"text-center text-lg font-medium",children:"Diario Protegido"}),e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Ingresa la contrasea para acceder a tu diario"}),e.jsx(ye,{type:"password",value:s,onChange:u=>r(u.target.value),placeholder:"Contrasea",className:l?"border-destructive focus-visible:ring-destructive":""}),l&&e.jsx("p",{className:"text-sm text-red-500 text-center",children:"Contrasea incorrecta"}),e.jsx(P,{type:"submit",className:"w-full",children:"Desbloquear"}),e.jsx(ik,{lastUpdated:a,className:"justify-center"})]})})})},cf=Ci("journal"),z8=cf?`https://generativelanguage.googleapis.com/v1beta/models/${cf.model}:generateContent`:"",L8=({entry:t,open:a,onOpenChange:s,onInsert:r,onReplace:l})=>{const[o,d]=p.useState(!1),u=a!==void 0?a:o,m=s??d,[h,g]=p.useState(""),[x,y]=p.useState(!1),[v,b]=p.useState(""),[N,S]=p.useState(0),w="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",E=cf?.prompt??"Reescribe el siguiente texto del diario de forma clara y natural:",T=cf?.params;p.useEffect(()=>{u&&b(`${E}
${t}`)},[u,t]),p.useEffect(()=>{S(zr(v))},[v]);const D=async()=>{if(t){y(!0);try{const L=(await(await fetch(`${z8}?key=${w}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:v}]}],...T})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text;g(L||"No se pudo obtener respuesta")}catch{g("Error al consultar la API")}finally{y(!1)}}},k=()=>{m(!1),g(""),b(""),S(0)};return e.jsxs(Mt,{open:u,onOpenChange:_=>_?m(!0):k(),children:[a===void 0&&e.jsxs(P,{size:"sm",variant:"outline",onClick:()=>m(!0),className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"}),"Mejorar entrada"]}),e.jsxs(Tt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0",children:[e.jsx(Rt,{className:"text-xl",children:"Reescribir Diario con IA"}),e.jsx(Ms,{children:"Gemini transformar tu texto en un estilo ms natural. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:v,onChange:_=>b(_.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Escribe o modifica el prompt para la IA..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",N]}),N>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:D,disabled:x||!w||N>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[x&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(os,{className:"w-4 h-4"}),x?"Consultando IA...":"Generar versin mejorada"]}),x&&e.jsx(yi,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado"}),h&&e.jsxs(P,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(h),ut.success("Texto copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Rr,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx(sa,{readOnly:!0,value:h||(x?"Generando respuesta...":"El resultado aparecer aqu despus de generar"),className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0",placeholder:"El resultado aparecer aqu..."}),h&&(r||l)&&e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[r&&e.jsx(P,{type:"button",className:"flex-1",onClick:()=>{r(h),ut.success("Texto insertado")},variant:"default",children:" Insertar en entrada"}),l&&e.jsx(P,{type:"button",className:"flex-1",onClick:()=>{l(h),ut.success("Texto reemplazado")},variant:"secondary",children:" Reemplazar entrada"})]})]})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:" Tip: Puedes editar el prompt para obtener diferentes estilos de reescritura"}),!w]})})]})]})},P8=({entry:t,selectedDate:a,onInsert:s,onReplace:r})=>{const[l,o]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(os,{className:"w-4 h-4"}),"IA"]})}),e.jsx(Nn,{align:"end",children:e.jsx(Lt,{onSelect:()=>o(!0),children:"Reescribir entrada"})})]}),e.jsx(L8,{entry:t,open:l,onOpenChange:o,onInsert:s,onReplace:r})]})};class to{static client=ze;static async getEntry(a,s){return ze.from("journal_entries").select("*").eq("user_id",a).eq("date",s).maybeSingle()}static async upsertEntry(a){return ze.from("journal_entries").upsert({user_id:a.userId,date:a.date,text:a.text,display_time:a.displayTime,updated_at:a.updatedAt},{onConflict:"user_id,date"})}static async getEntriesByDateRange(a,s,r){return ze.from("journal_entries").select("date, text").eq("user_id",a).gte("date",s).lte("date",r)}static async getWeeklySummaryByYearRange(a,s,r){return ze.from("journal_weekly_summary").select("year, week, entries_count").eq("user_id",a).gte("year",s).lte("year",r).returns()}static async getEntryDates(a){return ze.from("journal_entries").select("date").eq("user_id",a)}static async deleteWeeklySummary(a){return ze.from("journal_weekly_summary").delete().eq("user_id",a)}static async upsertWeeklySummary(a){return ze.from("journal_weekly_summary").upsert(a,{onConflict:"user_id,year,week"})}}const B8=t=>{const[a,s]=p.useState(""),[r,l]=p.useState("idle"),[o,d]=p.useState(null),[u,m]=p.useState(void 0),{user:h}=st(),g=p.useCallback(async()=>{if(!h)return;l("pending"),d(null);const y=Ue(t);try{const{data:v,error:b}=await to.getEntry(h.id,y);if(b)throw b;if(v){if(s(v.text||""),v.updated_at){const N=new Date(v.updated_at);m(Hh(N))}l("saved")}else s(""),l("idle"),m(void 0)}catch(v){console.error("Error loading journal entry:",v),d(v instanceof Error?v.message:"Error loading journal entry"),l("error")}},[h,t]);p.useEffect(()=>{g()},[g]);const x=p.useCallback(async y=>{if(!h)return;l("saving"),d(null);const v=a,b=u,N=new Date,S=Hh(N);s(y),m(S);const w=Ue(t),E=N.toLocaleString("es-ES",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"});try{const{error:T}=await to.upsertEntry({userId:h.id,date:w,text:y,displayTime:E,updatedAt:N.toISOString()});if(T)throw T;l("saved")}catch(T){console.error("Error saving journal entry:",T),s(v),m(b),d(T instanceof Error?T.message:"Error al guardar"),l("error")}},[h,t,a,u]);return{entry:a,setEntry:s,status:r,error:o,saveEntry:x,lastUpdated:u,loadJournalEntry:g}},$8={entry:"",setEntry:()=>{}},lk=p.createContext($8),H8=({children:t})=>{const[a,s]=p.useState("");return e.jsx(lk.Provider,{value:{entry:a,setEntry:s},children:t})},U8=()=>p.useContext(lk),V8={isUnlocked:!1,setUnlocked:()=>{}},ok=p.createContext(V8),Y8=({children:t})=>{const[a,s]=p.useState(!1);return e.jsx(ok.Provider,{value:{isUnlocked:a,setUnlocked:s},children:t})},q8=()=>p.useContext(ok);function ck(){const{user:t}=st(),[a,s]=p.useState(null),[r,l]=p.useState(!0),[o,d]=p.useState(null),u=p.useRef({}),m=p.useCallback(async()=>{if(!t){l(!1);return}l(!0),d(null);try{const{data:g,error:x}=await ze.from("profiles").select("*").eq("id",t.id).single();if(x&&x.code!=="PGRST116")throw x;if(g){const y=Object.prototype.hasOwnProperty.call(g,"full_name")?"full_name":Object.prototype.hasOwnProperty.call(g,"name")?"name":void 0,v=Object.prototype.hasOwnProperty.call(g,"birth_date")?"birth_date":Object.prototype.hasOwnProperty.call(g,"birthDate")?"birthDate":void 0,b=Object.prototype.hasOwnProperty.call(g,"theme")?"theme":void 0,N=Object.prototype.hasOwnProperty.call(g,"life_expectancy_years")?"life_expectancy_years":Object.prototype.hasOwnProperty.call(g,"lifeExpectancyYears")?"lifeExpectancyYears":void 0;u.current={nameKey:y,birthKey:v,themeKey:b,expectancyKey:N},s({name:(y?g[y]:void 0)??void 0,birthDate:(v?g[v]:void 0)??void 0,theme:(b?g[b]:void 0)??void 0,lifeExpectancyYears:(N?g[N]:void 0)??void 0})}else s(null);l(!1)}catch(g){d(g instanceof Error?g.message:"Error loading settings"),l(!1)}},[t]);return p.useEffect(()=>{m()},[m]),{settings:a,loading:r,error:o,saveSettings:async g=>{if(!t)return;const x=a;try{const y={...a,...g};s(y);const v={},{nameKey:b,birthKey:N,themeKey:S,expectancyKey:w}=u.current;g.name!==void 0&&(b?v[b]=g.name:v.full_name=g.name),g.birthDate!==void 0&&(N?v[N]=g.birthDate:v.birth_date=g.birthDate),g.theme!==void 0&&(S?v[S]=g.theme:v.theme=g.theme),g.lifeExpectancyYears!==void 0&&(w?v[w]=g.lifeExpectancyYears:v.life_expectancy_years=g.lifeExpectancyYears);const{error:E}=await ze.from("profiles").update({...v,updated_at:new Date().toISOString()}).eq("id",t.id);if(E)throw E}catch(y){throw s(x),d(y instanceof Error?y.message:"Error saving settings"),y}},refetch:m}}const F8=(t,a)=>{const{user:s}=st(),[r,l]=p.useState(new Map),[o,d]=p.useState(!1),[u,m]=p.useState(null);return p.useEffect(()=>{if(!s||t===null||a===null){l(new Map);return}let h=!0;return(async()=>{d(!0),m(null);try{const{data:x,error:y}=await to.getWeeklySummaryByYearRange(s.id,t,a);if(y)throw y;const v=new Map;(x||[]).forEach(b=>{const N=`${b.year}-W${String(b.week).padStart(2,"0")}`;v.set(N,b.entries_count)}),h&&l(v)}catch(x){h&&m(x instanceof Error?x.message:"Error cargando resumen semanal")}finally{h&&d(!1)}})(),()=>{h=!1}},[s,t,a]),p.useMemo(()=>({entriesByWeek:r,loading:o,error:u}),[r,o,u])},dk=(t,a)=>{const s=new Date(t,0,4),r=DM(s);return J0(r,Math.max(0,a-1))},Gd=53,al=14,$g=2,G8=()=>{const t=it(),{settings:a}=ck(),{user:s}=st(),[r,l]=p.useState(!1),o=a?.birthDate?new Date(`${a.birthDate}T00:00:00`):null,d=a?.lifeExpectancyYears??null,u=p.useMemo(()=>o?o.getFullYear():null,[o]),m=p.useMemo(()=>!o||!d||d<=0?null:o.getFullYear()+d-1,[o,d]),{entriesByWeek:h}=F8(u,m),g=sw(new Date),x=nw(new Date),y=async()=>{if(s){l(!0);try{const{data:N,error:S}=await to.getEntryDates(s.id);if(S)throw S;const w=new Map;(N||[]).forEach(T=>{if(!T.date)return;const D=new Date(`${T.date}T00:00:00`),k=sw(D),_=nw(D),R=`${k}-W${String(_).padStart(2,"0")}`;w.set(R,(w.get(R)||0)+1)}),await to.deleteWeeklySummary(s.id);const E=Array.from(w.entries()).map(([T,D])=>{const[k,_]=T.split("-W");return{user_id:s.id,year:Number(k),week:Number(_),entries_count:D}});if(E.length>0){const{error:T}=await to.upsertWeeklySummary(E);if(T)throw T}}finally{l(!1)}}},v=p.useMemo(()=>{const N=Gd*al+(Gd-1)*$g;return{gridTemplateColumns:`repeat(${Gd}, ${al}px)`,columnGap:`${$g}px`,rowGap:`${$g}px`,minWidth:`${N}px`}},[]),b=p.useMemo(()=>({width:al,height:al,minWidth:al,minHeight:al,maxWidth:al,maxHeight:al,padding:0,lineHeight:0}),[]);return!o||!d?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"rounded-lg border border-dashed p-6 text-center text-sm text-muted-foreground",children:"No se puede graficar: falta fecha de nacimiento o expectativa de vida en el perfil."})}):e.jsx("div",{className:"p-4 flex justify-center",children:e.jsxs("div",{className:"w-full max-w-fit",children:[e.jsxs("div",{className:"mb-4 flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Cada cuadro representa una semana. Filas: aos de vida. Columnas: semanas del ao."}),e.jsx("button",{className:"text-xs px-3 py-1.5 rounded-md border border-muted-foreground/40 hover:bg-muted/20 transition",onClick:y,disabled:r,children:r?"Recalculando...":"Recalcular resumen"})]}),e.jsx("div",{className:"w-full overflow-x-auto overflow-y-visible scroll-container",style:{WebkitOverflowScrolling:"touch"},children:e.jsxs("div",{className:"space-y-2 min-w-max",children:[e.jsxs("div",{className:"flex items-center gap-2 sticky top-0 bg-background/80 backdrop-blur-sm z-10 py-1",children:[e.jsx("div",{className:"w-12 text-[10px] text-muted-foreground text-right",children:"Ao"}),e.jsx("div",{className:"grid",style:v,children:Array.from({length:Gd},(N,S)=>e.jsx("div",{className:"text-[8px] text-muted-foreground text-center",children:S+1},`week-${S+1}`))}),e.jsx("div",{className:"w-8 text-[10px] text-muted-foreground",children:"Edad"})]}),Array.from({length:d},(N,S)=>{const w=(u??0)+S,E=S;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-12 text-[10px] text-muted-foreground text-right",children:w}),e.jsx("div",{className:"grid p-0.5",style:v,children:Array.from({length:Gd},(T,D)=>{const k=D+1,_=`${w}-W${String(k).padStart(2,"0")}`,R=dk(w,k),L=o?R<nc(o,{weekStartsOn:1})&&w===o.getFullYear():!1,U=nc(R,{weekStartsOn:1})>nc(new Date,{weekStartsOn:1}),F=(h.get(_)||0)>0,G=w===g&&k===x,$="border",z=L||U?"bg-transparent border-slate-500/40":F?"bg-emerald-500/90 border-emerald-300/90":"bg-slate-900/30 border-slate-500/60",H=G?"ring-2 ring-amber-400 ring-offset-1 ring-offset-slate-900":"";return e.jsx("button",{className:`${$} ${z} ${H}`,style:b,onClick:()=>t(`/journal/view/entries?week=${_}`),title:`${_}  ${R.toLocaleDateString("es-ES")} - ${new Date(R.getTime()+8640*60*1e3).toLocaleDateString("es-ES")}`,"aria-label":`Semana ${_}`},`${w}-${k}`)})}),e.jsx("div",{className:"w-8 text-[10px] text-muted-foreground",children:E})]},w)})]})})]})})},W8=({selectedDate:t})=>{const{user:a}=st(),{isUnlocked:s,setUnlocked:r}=q8(),[l,o]=p.useState(!1),{entry:d,setEntry:u,status:m,error:h,saveEntry:g,lastUpdated:x}=B8(t),{entry:y,setEntry:v}=U8();p.useEffect(()=>{v(d)},[d,v]);const b=()=>{r(!1)};return a?s?e.jsxs(e.Fragment,{children:[e.jsxs(fe,{className:"w-full",children:[e.jsxs(xe,{className:"p-4",children:[e.jsx(O8,{onLock:b}),e.jsx(R8,{value:y,onChange:N=>{v(N),u(N)}}),h&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:h})]}),e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx(ik,{lastUpdated:x}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{onClick:()=>g(y),disabled:m==="saving",children:m==="saving"?e.jsx("span",{className:"flex items-center gap-2",children:e.jsx(l0,{className:"w-4 h-4 animate-spin"})}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(l0,{className:"w-4 h-4"}),"Guardar"]})}),e.jsx(P8,{entry:y,selectedDate:t,onInsert:N=>{v(S=>S+(S?`
`:"")+N),u(S=>S+(S?`
`:"")+N)},onReplace:N=>{v(N),u(N)}}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>o(!0),children:e.jsx(Or,{className:"w-4 h-4"})})]})]})]}),e.jsx(XB,{selectedDate:t})]}):e.jsx(I8,{onUnlock:()=>r(!0),lastUpdated:x}):e.jsx(fe,{className:"w-full",children:e.jsx(xe,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesin para usar el diario"})})})},uk=[{key:"entries",label:"Entradas"},{key:"life-calendar",label:"Life Calendar"}],FS="entries",K8=(t,a)=>{const{user:s}=st(),[r,l]=p.useState({}),[o,d]=p.useState(!1),[u,m]=p.useState(null);return p.useEffect(()=>{if(!s||!t||!a){l({});return}let h=!0;return(async()=>{d(!0),m(null);try{const x=Ue(t),y=Ue(a),{data:v,error:b}=await to.getEntriesByDateRange(s.id,x,y);if(b)throw b;const N={};(v||[]).forEach(S=>{S.date&&(N[S.date]=S.text||"")}),h&&l(N)}catch(x){h&&m(x instanceof Error?x.message:"Error cargando entradas de la semana")}finally{h&&d(!1)}})(),()=>{h=!1}},[s,t,a]),{entries:r,loading:o,error:u}},X8=({selectedDate:t,onDateChange:a})=>{const[s]=Ef(),r=s.get("week"),l=it(),o=p.useMemo(()=>{if(!r)return null;const m=r.match(/^(\d{4})-W(\d{1,2})$/);if(!m)return null;const h=Number(m[1]),g=Number(m[2]);if(!h||!g)return null;const x=dk(h,g),y=ps(x,6);return{start:x,end:y}},[r]),{entries:d}=K8(o?.start??null,o?.end??null),u=p.useMemo(()=>o?Array.from({length:7},(m,h)=>ps(o.start,h)):[],[o]);return p.useEffect(()=>{o&&a(o.start)},[o,a]),e.jsx(H8,{children:e.jsx(Y8,{children:e.jsxs("div",{className:"space-y-4",children:[o&&e.jsxs("div",{className:"rounded-lg border bg-background/60 p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold",children:["Semana ",r]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>l(ae.journal.view("life-calendar")),children:"Volver al Life Calendar"}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>a(new Date),children:"Ir a hoy"})]})]}),e.jsx("div",{className:"grid gap-2 md:grid-cols-2",children:u.map(m=>{const h=Ue(m),g=d[h];return e.jsxs("button",{className:"text-left rounded-md border border-dashed p-3 hover:bg-muted/30 transition",onClick:()=>a(m),children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:h}),e.jsx("div",{className:"text-sm font-medium truncate",children:g?g.slice(0,80):"Sin entrada"})]},h)})})]}),e.jsx(jl,{selectedDate:t,onChange:a}),e.jsx("div",{className:"mt-4",children:e.jsx(W8,{selectedDate:t})})]})})})},Q8=()=>e.jsx(G8,{}),Z8=()=>{const t=it(),{viewKey:a}=Ss(),s=a||FS,[r,l]=p.useState(new Date),{user:o}=st(),d=uk.map(g=>({...g,component:g.key==="life-calendar"?Q8:X8})),u=d.find(g=>g.key===s);if(!u)return e.jsx(Ft,{to:ae.journal.view(FS),replace:!0});if(!o)return e.jsx(na,{title:"Diario Personal",icon:e.jsx(ro,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-8 text-center",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesion para acceder a tu diario"})})})})});const m=[{id:"config",label:"Configuracion",icon:e.jsx(_s,{className:"h-4 w-4"}),onClick:()=>t(ae.journal.config),tooltip:"Configuracion"}],h=u.component;return e.jsx(na,{title:"Diario Personal",subtitle:"Registra tus pensamientos y reflexiones diarias",icon:e.jsx(ro,{className:"h-4 w-4 text-white"}),views:d,activeViewKey:s,onViewChange:g=>t(ae.journal.view(g)),actions:m,children:e.jsx("div",{className:"p-4 space-y-4",children:e.jsx(h,{selectedDate:r,onDateChange:l})})})},J8=()=>{const t=it();return e.jsx(na,{title:"Configuracion de Diario",icon:e.jsx(ro,{className:"h-4 w-4 text-white"}),views:uk.map(a=>({...a,component:()=>null})),onViewChange:a=>t(`/journal/view/${a}`),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"No hay configuraciones especificas para Diario en este modulo."})})})})},eU={module:"journal",defaultRoute:ae.journal.view(ae.journal.defaultView),moduleRoutes:[{path:"journal",element:e.jsx(Ft,{to:ae.journal.view(ae.journal.defaultView),replace:!0})},{path:"journal/view/:viewKey",element:e.jsx(Z8,{})},{path:"journal/config",element:e.jsx(J8,{})}]},tU=Dc("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),ao=p.forwardRef(({className:t,variant:a,...s},r)=>e.jsx("div",{ref:r,role:"alert",className:he(tU({variant:a}),t),...s}));ao.displayName="Alert";const aU=p.forwardRef(({className:t,...a},s)=>e.jsx("h5",{ref:s,className:he("mb-1 font-medium leading-none tracking-tight",t),...a}));aU.displayName="AlertTitle";const so=p.forwardRef(({className:t,...a},s)=>e.jsx("div",{ref:s,className:he("text-sm [&_p]:leading-relaxed",t),...a}));so.displayName="AlertDescription";const fs={breakfast:{icon:n0,title:"Desayuno",color:"bg-amber-100",hoverColor:"hover:bg-amber-200",order:1},morningSnack:{icon:d1,title:"Media Maana",color:"bg-orange-100",hoverColor:"hover:bg-orange-200",order:2},lunch:{icon:e1,title:"Almuerzo",color:"bg-emerald-100",hoverColor:"hover:bg-emerald-200",order:3},afternoonSnack:{icon:$M,title:"Merienda",color:"bg-purple-100",hoverColor:"hover:bg-purple-200",order:4},dinner:{icon:c1,title:"Cena",color:"bg-indigo-100",hoverColor:"hover:bg-indigo-200",order:5}},rv={breakfast:8,morningSnack:11,lunch:14,afternoonSnack:17,dinner:20},sU=(t,a)=>{const[s,r,l]=t.split("-").map(Number);return new Date(s,r-1,l,rv[a]||0,0,0,0).getTime()<Date.now()},nU=(t=new Date)=>{const a=new Date(t);let s=a.getDay();s=s===0?6:s-1;const r=[];for(let l=0;l<7;l++){const o=new Date(a);o.setDate(a.getDate()-s+l),r.push({dayName:["L","M","X","J","V","S","D"][l],fullDate:Ue(o),isCurrentMonth:o.getMonth()===a.getMonth(),date:new Date(o)})}return r},rU=1,iU=1e6;let Hg=0;function lU(){return Hg=(Hg+1)%Number.MAX_SAFE_INTEGER,Hg.toString()}const Ug=new Map,GS=t=>{if(Ug.has(t))return;const a=setTimeout(()=>{Ug.delete(t),nu({type:"REMOVE_TOAST",toastId:t})},iU);Ug.set(t,a)},oU=(t,a)=>{switch(a.type){case"ADD_TOAST":return{...t,toasts:[a.toast,...t.toasts].slice(0,rU)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(s=>s.id===a.toast.id?{...s,...a.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=a;return s?GS(s):t.toasts.forEach(r=>{GS(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===s||s===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return a.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==a.toastId)}}},Ah=[];let _h={toasts:[]};function nu(t){_h=oU(_h,t),Ah.forEach(a=>{a(_h)})}function cU({...t}){const a=lU(),s=l=>nu({type:"UPDATE_TOAST",toast:{...l,id:a}}),r=()=>nu({type:"DISMISS_TOAST",toastId:a});return nu({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:l=>{l||r()}}}),{id:a,dismiss:r,update:s}}function Zf(){const[t,a]=p.useState(_h);return p.useEffect(()=>(Ah.push(a),()=>{const s=Ah.indexOf(a);s>-1&&Ah.splice(s,1)}),[t]),{...t,toast:cU,dismiss:s=>nu({type:"DISMISS_TOAST",toastId:s})}}const dU=(t,a)=>{const s=t[a];return s?Object.values(s).reduce((r,l)=>r+(l.calories||0),0):0},uU=({day:t,mealPlan:a,onOpenModal:s})=>{const r=new Date,l=new Date(t.fullDate),o=l.toDateString()===r.toDateString(),d=l<r&&!o,[u,m]=p.useState(!d),h=Object.keys(a[t.fullDate]||{}).length,g=Object.keys(fs).length,x=dU(a,t.fullDate);return e.jsxs("div",{className:`mx-2 my-3 rounded-xl shadow-sm border transition-all duration-200 ${d?"bg-gray-50 border-gray-200 opacity-75":"bg-white border-gray-100"}`,children:[e.jsxs("div",{className:`flex justify-between items-center p-4 ${d?"cursor-pointer hover:bg-gray-100":""} ${u?"border-b border-gray-100 rounded-t-xl":"rounded-xl"}`,onClick:d?()=>m(!u):void 0,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[d&&e.jsx("div",{className:"text-gray-400",children:u?e.jsx(rn,{className:"w-4 h-4"}):e.jsx(wn,{className:"w-4 h-4"})}),e.jsxs("h3",{className:`font-semibold text-base ${d?"text-gray-500":o?"text-blue-600":"text-gray-900"}`,children:[t.dayName,o&&" (Hoy)"]}),d&&!u&&e.jsxs("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded-md",children:[h,"/",g]})]}),e.jsx("span",{className:`text-sm px-2 py-1 rounded-md ${d?"text-gray-400 bg-gray-100":"text-gray-500 bg-gray-50"}`,children:t.fullDate.split("-").slice(1).join("/")})]}),u&&e.jsxs("div",{className:"p-4 pt-0 space-y-3",children:[Object.entries(fs).sort(([,y],[,v])=>y.order-v.order).map(([y,v])=>{const b=a[t.fullDate]?.[y],{color:N,hoverColor:S}=v;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center w-12 shrink-0",children:[e.jsx(v.icon,{className:`w-5 h-5 mb-1 ${d?"text-gray-400":"text-gray-600"}`}),e.jsxs("span",{className:`text-xs text-center leading-tight ${d?"text-gray-400":"text-gray-500"}`,children:[rv[y],":00"]})]}),b?e.jsxs("div",{className:`flex-1 p-3 rounded-lg transition-all duration-200 cursor-pointer border active:scale-95 ${d?"bg-gray-100 border-gray-200 hover:bg-gray-150":`${N} ${S} border-gray-200`}`,onClick:()=>s(t.fullDate,y,b),children:[e.jsx("div",{className:`font-medium text-sm mb-1 line-clamp-1 ${d?"text-gray-500":"text-gray-900"}`,children:b.name}),b.calories&&e.jsxs("div",{className:`text-xs mb-1 font-medium ${d?"text-gray-400":"text-blue-600"}`,children:["Caloras aproximadas: ",b.calories," kcal"]}),b.notes&&e.jsx("div",{className:`text-xs line-clamp-2 mb-2 ${d?"text-gray-400":"text-gray-600"}`,children:b.notes}),b.recipe&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${d?"bg-gray-400":"bg-blue-500"}`}),e.jsx("span",{className:`text-xs ${d?"text-gray-400":"text-blue-600"}`,children:"Receta"})]})]}):e.jsxs(P,{variant:"outline",disabled:d,className:`flex-1 justify-start border-dashed h-auto py-3 text-sm transition-all ${d?"border-gray-200 text-gray-400 bg-gray-50 cursor-not-allowed":"border-gray-300 text-gray-600 hover:bg-gray-50 active:scale-95"}`,onClick:()=>!d&&s(t.fullDate,y),children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"truncate",children:d?"No agregado":`Agregar ${v.title.toLowerCase()}`})]})]},y)}),x>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:`text-sm font-medium ${d?"text-gray-500":"text-blue-600"}`,children:["Total del da: ",x," kcal"]})})})]})]})},mU=({date:t,type:a,meal:s,disabled:r,onOpenModal:l})=>{const{color:o,hoverColor:d}=fs[a],u=sU(t,a);return s?e.jsxs("div",{className:`h-full p-2 rounded ${o} relative group cursor-pointer transition-all duration-200 ease-in-out hover:shadow-md ${u?"opacity-50 grayscale":""}`,onClick:()=>l(t,a,s),children:[e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:s.name}),s.calories&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1 font-medium",children:["Caloras aproximadas: ",s.calories," kcal"]}),s.notes&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:s.notes}),s.recipe&&e.jsx("div",{className:"absolute bottom-1 right-1",children:e.jsx("div",{className:"w-2 h-2 bg-sky-500 rounded-full"})}),e.jsx("div",{className:`absolute inset-0 flex items-center justify-center 
        bg-background/75 opacity-0 group-hover:opacity-100 rounded transition-opacity ${d}`,children:e.jsx(Nf,{className:"h-4 w-4 text-gray-700"})})]}):e.jsx(P,{variant:"outline",className:`w-full h-full border-dashed ${u?"opacity-50":""}`,onClick:()=>l(t,a),disabled:r,children:e.jsx(It,{className:"h-4 w-4"})})},hU=(t,a)=>{const s=t[a];return s?Object.values(s).reduce((r,l)=>r+(l.calories||0),0):0},fU=({day:t,mealPlan:a,disabled:s,onOpenModal:r})=>{const l=hU(a,t.fullDate);return e.jsxs("div",{className:`px-2 ${t.isCurrentMonth?"":"bg-muted"}`,children:[e.jsxs("div",{className:"text-center py-2 border-b",children:[e.jsx("div",{className:"font-medium",children:t.dayName}),e.jsx("div",{className:"text-xs text-gray-500",children:t.fullDate.split("-").slice(1).join("/")})]}),Object.entries(fs).sort(([,o],[,d])=>o.order-d.order).map(([o])=>e.jsx("div",{className:"h-32 py-2",children:e.jsx(mU,{date:t.fullDate,type:o,meal:a[t.fullDate]?.[o],disabled:s,onOpenModal:r})},o)),l>0&&e.jsx("div",{className:"text-center py-2 border-t border-gray-200 mt-2",children:e.jsxs("div",{className:"text-sm font-medium text-blue-600",children:["Total: ",l," kcal"]})})]})},ru=Ci("meal"),Vg=ru?`https://generativelanguage.googleapis.com/v1beta/models/${ru.model}:generateContent`:"",pU=({selectedMeal:t,onFormChange:a,onOverwriteDay:s,mealName:r})=>{const{items:l}=bl(),[o,d]=p.useState(!1),[u,m]=p.useState(!1),[h,g]=p.useState(!1),[x,y]=p.useState(null),[v,b]=p.useState(""),[N,S]=p.useState(""),[w,E]=p.useState(0),[T,D]=p.useState(!1),[k,_]=p.useState(null),[R,L]=p.useState("meal"),U="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",V=ru?.prompts?.meal??"Genera una comida en formato JSON utilizando los ingredientes disponibles.",F=ru?.prompts?.day??"Genera todas las comidas del da en formato JSON.",G=ru?.params;p.useEffect(()=>{E(zr(v))},[v]);const $=()=>l.filter(W=>{if(W.category){const ie=W.category.toLowerCase();if(["aseo","limpieza","cuidado personal","otro"].some(K=>ie.includes(K)))return!1}return W.status==="in-stock"||W.status==="low-stock"}).map(W=>`${W.name} (${W.stock})`).join(", "),z=M=>{const W=$(),ie=N.trim();if(M==="meal"){let ve=`${V}
Dia: ${t.date}
Tipo: ${t.type}
Ingredientes: ${W}`;ie&&(ve+=`
Preferencias: ${ie}`),ve+=`
Devuelve JSON {"name":"","notes":"","recipe":""}`,b(ve)}else{let ve=`${F}
Dia completo: ${t.date}
Ingredientes: ${W}`;ie&&(ve+=`
Preferencias: ${ie}`),ve+=`
Devuelve JSON con llaves ${Object.keys(fs).join(", ")}.`,b(ve)}y(M)},H=()=>{y(null),b(""),E(0),D(!1),_(null)},I=async()=>{x==="meal"?(L("meal"),await O(v)):x==="day"&&(L("day"),await Y(v))},O=async M=>{d(!0),D(!0),_(null);try{const W=M,oe=((await(await fetch(`${Vg}?key=${U}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:W}]}],...G})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text||"").match(/\{[\s\S]*\}/);if(oe){const _e=JSON.parse(oe[0]);_({name:_e.name||"",notes:_e.notes||"",recipe:_e.recipe||"",type:t.type})}}catch(W){console.error("AI meal error",W),_(null)}finally{d(!1)}},Y=async M=>{m(!0),D(!0),_(null);try{const W=M,oe=((await(await fetch(`${Vg}?key=${U}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:W}]}],...G})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text||"").match(/\{[\s\S]*\}/);if(oe){const _e=JSON.parse(oe[0]);_(_e)}}catch(W){console.error("AI day error",W),_(null)}finally{m(!1)}},le=()=>{if(k){if(R==="meal"){const M=(k.name||"").trim();if(!M){console.error("AI generated meal without name");return}a("name",M),a("notes",k.notes||""),a("recipe",k.recipe||"")}else{const M={};Object.keys(fs).forEach(W=>{if(k[W]){const ie=(k[W].name||"").trim();ie&&(M[W]={type:W,name:ie,notes:k[W].notes||"",recipe:k[W].recipe||""})}}),s(M)}H()}},re=()=>{R==="meal"?O(v):Y(v)},Q=()=>{D(!1),_(null)},q=async()=>{if(!(!r||!U)){g(!0);try{const M=`Estima las caloras aproximadas para una porcin normal de: "${r}". Responde solo con el nmero de caloras, sin texto adicional ni explicaciones.`,K=((await(await fetch(`${Vg}?key=${U}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:M}]}],...G})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text||"").match(/(\d+)/);if(K){const oe=parseInt(K[1]);a("calories",oe.toString())}}catch(M){console.error("Error estimating calories:",M)}finally{g(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(sa,{placeholder:"Preferencias (opcional)",value:N,onChange:M=>S(M.target.value),className:"h-20"}),e.jsxs(P,{type:"button",onClick:()=>z("meal"),disabled:o||!U,variant:"secondary",className:"w-full flex items-center gap-2",children:[o&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(oi,{className:"w-4 h-4"})," Generar comida"]}),e.jsxs(P,{type:"button",onClick:()=>z("day"),disabled:u||!U,variant:"ghost",className:"w-full flex items-center gap-2",children:[u&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(io,{className:"w-4 h-4"})," Regenerar da"]}),r&&e.jsxs(P,{type:"button",onClick:q,disabled:h||!U||!r.trim(),variant:"outline",className:"w-full flex items-center gap-2",children:[h&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(oi,{className:"w-4 h-4"})," Estimar caloras"]}),(o||u||h)&&e.jsx(yi,{className:"mt-2"})]}),e.jsx(Mt,{open:x!==null,onOpenChange:M=>M?null:H(),children:e.jsxs(Tt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0",children:[e.jsx(Rt,{className:"text-xl",children:x==="meal"?"Generar Comida con IA":"Regenerar Da Completo con IA"}),e.jsx(Ms,{children:x==="meal"?"La IA generar una comida especfica basada en tus ingredientes disponibles y preferencias.":"La IA generar un plan completo del da con todas las comidas basndose en tus ingredientes disponibles."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:v,onChange:M=>b(M.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Instrucciones para generar comidas..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",w]}),w>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),!T&&e.jsxs(P,{onClick:I,disabled:(x==="meal"?o:u)||!U||w>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[(x==="meal"?o:u)&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(oi,{className:"w-4 h-4"}),(x==="meal"?o:u)?"Generando...":"Generar comidas"]}),(o||u)&&e.jsx(yi,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:T?"Previsualizacin":"Informacin del proceso"})}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:T?e.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[e.jsx("div",{className:"flex-1 overflow-auto",children:(o||u)&&!k?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12 space-y-4",children:[e.jsx(hs,{className:"w-8 h-8 animate-spin text-blue-500"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Generando ",R==="meal"?"comida":"plan del da","..."]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["La IA est creando tu ",R==="meal"?"comida personalizada":"plan completo del da"]})]})]}):k?R==="meal"?e.jsxs(fe,{className:"h-full",children:[e.jsx(xt,{className:"pb-3",children:e.jsxs(mt,{className:"text-base flex items-center gap-2",children:[e.jsx(oi,{className:"w-4 h-4 text-blue-500"}),"Comida Generada"]})}),e.jsxs(xe,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Nombre:"}),e.jsx("p",{className:"text-sm mt-1",children:k.name||"Sin nombre"})]}),k.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Notas:"}),e.jsx("p",{className:"text-sm mt-1 text-gray-600",children:k.notes})]}),k.recipe&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Receta:"}),e.jsx("div",{className:"text-sm mt-1 text-gray-600 bg-gray-50 p-3 rounded-md max-h-32 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap font-sans",children:k.recipe})})]})]})]}):e.jsx("div",{className:"space-y-3",children:Object.keys(fs).map(M=>{const W=k[M];return W?e.jsxs(fe,{className:"border border-gray-200",children:[e.jsx(xt,{className:"pb-2",children:e.jsxs(mt,{className:"text-sm flex items-center gap-2",children:[e.jsx(oi,{className:"w-3 h-3 text-blue-500"}),fs[M]?.title]})}),e.jsxs(xe,{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nombre:"}),e.jsx("span",{className:"ml-1",children:W.name||"Sin nombre"})]}),W.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Notas:"}),e.jsx("span",{className:"ml-1 text-gray-600",children:W.notes})]}),W.recipe&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Receta:"}),e.jsx("div",{className:"mt-1 text-gray-600 bg-gray-50 p-2 rounded text-xs max-h-16 overflow-y-auto",children:e.jsxs("pre",{className:"whitespace-pre-wrap font-sans",children:[W.recipe.substring(0,100),"..."]})})]})]})]},M):null})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12 space-y-4",children:[e.jsx(Fa,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Error al generar"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No se pudo generar el contenido. Intenta nuevamente."})]})]})}),k&&e.jsxs("div",{className:"flex flex-col gap-2 pt-3 border-t",children:[e.jsxs(P,{onClick:le,className:"w-full gap-2",size:"sm",children:[e.jsx(cr,{className:"w-4 h-4"}),"Insertar"]}),e.jsxs(P,{onClick:re,variant:"secondary",className:"w-full gap-2",size:"sm",disabled:o||u,children:[o||u?e.jsx(hs,{className:"w-4 h-4 animate-spin"}):e.jsx(io,{className:"w-4 h-4"}),"Regenerar"]}),e.jsxs(P,{onClick:Q,variant:"outline",className:"w-full gap-2",size:"sm",children:[e.jsx(Fa,{className:"w-4 h-4"}),"Cancelar"]})]}),!k&&e.jsx("div",{className:"flex justify-center pt-3 border-t",children:e.jsxs(P,{onClick:Q,variant:"outline",className:"gap-2",size:"sm",children:[e.jsx(Fa,{className:"w-4 h-4"}),"Cancelar"]})})]}):e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-md p-4 overflow-auto",children:e.jsx("div",{className:"text-sm text-gray-700 space-y-3",children:x==="meal"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Tipo de comida:"})," ",fs[t.type]?.title]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Fecha:"})," ",t.date]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ingredientes disponibles:"})," ",$()||"Ninguno disponible"]}),o||u?e.jsx("div",{className:"text-blue-600",children:" Generando comida personalizada..."}):e.jsx("div",{className:"text-gray-500",children:"La comida se generar y podrs previsualizarla antes de insertarla."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Fecha completa:"})," ",t.date]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Comidas a generar:"})," ",Object.values(fs).map(M=>M.title).join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ingredientes disponibles:"})," ",$()||"Ninguno disponible"]}),o||u?e.jsx("div",{className:"text-blue-600",children:" Generando plan completo del da..."}):e.jsx("div",{className:"text-gray-500",children:"Se generar el plan del da y podrs previsualizarlo antes de insertarlo."})]})})})})]})]}),e.jsxs("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:" Tip: Mantn tu lista de compras actualizada para mejores sugerencias"}),!U]}),e.jsx(Cs,{className:"flex justify-end gap-2 mt-3",children:e.jsx(P,{type:"button",variant:"outline",onClick:H,children:"Cancelar"})})]})]})})]})},xU=({show:t,onClose:a,selectedMealInfo:s,formData:r,onFormChange:l,onSubmit:o,onDelete:d,onOverwriteDay:u,weekDays:m})=>{if(!s)return null;const h=async y=>{y.preventDefault();const v=y.currentTarget;if(!v.checkValidity()){v.reportValidity();return}await o()},g=m.find(y=>y.fullDate===s.date),x=!!s.meal;return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsx(Tt,{className:"sm:max-w-[700px]",children:e.jsxs("form",{onSubmit:h,children:[e.jsxs(Ot,{children:[e.jsx(Rt,{children:x?"Editar Comida":"Agregar Comida"}),e.jsxs(Ms,{children:[g?.dayName," - ",s.date.split("-").slice(1).join("/")]})]}),e.jsxs("div",{className:"space-y-4 py-4 sm:grid sm:grid-cols-2 sm:gap-4 sm:space-y-0",children:[e.jsxs("div",{className:"space-y-1 sm:col-span-2",children:[e.jsx(Ce,{htmlFor:"mealName",children:"Nombre de la Comida *"}),e.jsx(ye,{id:"mealName",type:"text",value:r.name,onChange:y=>l("name",y.target.value),placeholder:"Ej: Ensalada Csar",required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"mealNotes",children:"Notas Adicionales"}),e.jsx(ye,{id:"mealNotes",type:"text",value:r.notes,onChange:y=>l("notes",y.target.value),placeholder:"Ej: Sin crutones"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"mealCalories",children:"Caloras Aproximadas"}),e.jsx(ye,{id:"mealCalories",type:"number",min:"0",max:"9999",value:r.calories||"",onChange:y=>l("calories",y.target.value),placeholder:"450"})]}),e.jsxs("div",{className:"space-y-1 sm:col-span-2",children:[e.jsx(Ce,{htmlFor:"mealRecipe",children:"Receta"}),e.jsx(sa,{id:"mealRecipe",value:r.recipe,onChange:y=>l("recipe",y.target.value),placeholder:"Ingredientes y preparacin...",className:"h-40 resize-none"})]}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(pU,{selectedMeal:s,onFormChange:l,onOverwriteDay:y=>u(s.date,y),mealName:r.name})})]}),e.jsxs(Cs,{className:"flex flex-col sm:flex-row sm:justify-between gap-2",children:[e.jsx("div",{className:"flex-grow sm:flex-grow-0",children:x&&e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsxs(P,{type:"button",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(Sn,{className:"w-4 h-4 mr-2"}),"Eliminar"]})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Ests seguro?"}),e.jsx(fr,{children:"Esta accin no se puede deshacer. Se eliminar permanentemente la comida."})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"Cancelar"}),e.jsx(pr,{onClick:d,children:"Eliminar"})]})]})]})}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-end justify-end",children:[e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"mealType",className:"sr-only",children:"Tipo"}),e.jsxs(yt,{value:r.type,onValueChange:y=>l("type",y),name:"mealType",required:!0,children:[e.jsx(ft,{id:"mealType",className:"sm:w-40 w-full",children:e.jsx(vt,{placeholder:"Selecciona un tipo"})}),e.jsx(pt,{children:Object.entries(fs).sort(([,y],[,v])=>y.order-v.order).map(([y,{title:v}])=>e.jsx(Le,{value:y,children:v},y))})]})]}),e.jsx(P,{type:"button",variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(P,{type:"submit",disabled:!r.name,children:x?"Actualizar":"Agregar"})]})]})]})})})},gU=({mealPlan:t,onAddMeal:a,onRemoveMeal:s,disabled:r,selectedDate:l=new Date})=>{const{toast:o}=Zf(),d=l,[u,m]=p.useState(!1),[h,g]=p.useState(null),[x,y]=p.useState({type:"breakfast",name:"",notes:"",recipe:"",calories:void 0}),v=nU(d),b=(T,D,k)=>{g({date:T,type:D,meal:k}),y({type:k?.type||D,name:k?.name||"",notes:k?.notes||"",recipe:k?.recipe||"",calories:k?.calories?Number(k.calories):void 0}),m(!0)},N=(T,D)=>{y(k=>({...k,[T]:T==="calories"?D&&Number(D)||void 0:D}))},S=async()=>{if(h){if(!x.name||x.name.trim()===""){o({title:"Campo Requerido",description:"El nombre de la comida es obligatorio.",variant:"destructive"});return}try{h.meal&&h.meal.type!==x.type&&await s(h.date,h.meal.type),await a(h.date,x.type,{type:x.type,name:x.name.trim(),notes:x.notes,recipe:x.recipe,calories:x.calories}),m(!1)}catch(T){console.error("Error al guardar:",T),o({title:"Error al Guardar",description:"No se pudo guardar la comida.",variant:"destructive"})}}},w=async()=>{if(h?.meal)try{await s(h.date,h.meal.type),m(!1)}catch(T){console.error("Error al eliminar:",T),o({title:"Error al Eliminar",description:"No se pudo eliminar la comida.",variant:"destructive"})}},E=async(T,D)=>{for(const[k,_]of Object.entries(D))await a(T,k,_);if(h){const k=D[h.type];k&&y({type:h.type,name:k.name,notes:k.notes||"",recipe:k.recipe||"",calories:k.calories?Number(k.calories):void 0})}};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("div",{className:"md:hidden flex-1 overflow-y-auto",children:e.jsxs("div",{className:"pb-20 px-2",children:[" ",v.map(T=>e.jsx(uU,{day:T,mealPlan:t,onOpenModal:b},T.fullDate))]})}),"      ",e.jsx("div",{className:"hidden md:block flex-1 overflow-auto",children:e.jsx("div",{className:"min-h-full p-4 lg:p-6 xl:p-8",children:e.jsxs("div",{className:"grid grid-cols-8 gap-2 lg:gap-4 xl:gap-6 min-w-[900px] lg:min-w-[1200px] xl:min-w-[1400px] h-full",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 lg:p-4 xl:p-6",children:Object.entries(fs).sort(([,T],[,D])=>T.order-D.order).map(([T,D])=>e.jsx("div",{className:"h-32 lg:h-36 xl:h-40 flex items-center justify-center border-b border-gray-200 last:border-b-0",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx(D.icon,{className:"h-6 w-6 lg:h-7 lg:w-7 xl:h-8 xl:w-8 text-gray-600"}),e.jsx("span",{className:"font-medium text-sm lg:text-base",children:D.title}),e.jsxs("span",{className:"text-xs lg:text-sm text-gray-500",children:[rv[T],":00"]})]})},T))}),v.map(T=>e.jsx(fU,{day:T,mealPlan:t,disabled:r,onOpenModal:b},T.fullDate))]})})}),e.jsx(xU,{show:u,onClose:()=>m(!1),selectedMealInfo:h,formData:x,onFormChange:N,onSubmit:S,onDelete:w,onOverwriteDay:E,weekDays:v})]})},yU=({onImport:t,disabled:a})=>{const{toast:s}=Zf(),r=o=>!o||typeof o!="object"?!1:Object.entries(o).every(([d,u])=>!/^\d{4}-\d{2}-\d{2}$/.test(d)||!u||typeof u!="object"?!1:Object.entries(u).every(([h,g])=>!(!Object.keys(fs).includes(h)||!g||typeof g!="object"||typeof g.name!="string"||!g.name||g.notes&&typeof g.notes!="string"||g.recipe&&typeof g.recipe!="string"))),l=o=>{const d=o.target.files?.[0];if(!d)return;const u=new FileReader;u.onload=async m=>{try{const h=m.target?.result,g=JSON.parse(h);if(!r(g))throw new Error("El formato del archivo no es vlido. Revisa la documentacin para ver el formato correcto.");await t(g)}catch(h){console.error("Error importing:",h),s({title:"Error de Importacin",description:h instanceof Error?h.message:"Formato invlido",variant:"destructive"})}},u.readAsText(d)};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",title:"Importar Plan",accept:"application/json",onChange:l,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:a}),e.jsxs(P,{variant:"outline",size:"sm",className:"w-full",disabled:a,children:[e.jsx(hu,{className:"h-4 w-4 mr-2"}),"Importar Plan"]})]})},vU=({onImport:t,disabled:a})=>{const[s,r]=p.useState(!1),[l,o]=p.useState(""),{toast:d}=Zf(),u=h=>!h||typeof h!="object"?!1:Object.entries(h).every(([g,x])=>!/^\d{4}-\d{2}-\d{2}$/.test(g)||!x||typeof x!="object"?!1:Object.entries(x).every(([v,b])=>!(!Object.keys(fs).includes(v)||!b||typeof b!="object"||typeof b.name!="string"||!b.name||b.notes&&typeof b.notes!="string"||b.recipe&&typeof b.recipe!="string"))),m=async()=>{try{const h=JSON.parse(l);if(!u(h))throw new Error("El formato del JSON no es vlido. Revisa la documentacin para ver el formato correcto.");await t(h),o(""),r(!1)}catch(h){console.error("Error importing from text:",h),d({title:"Error de Importacin",description:h instanceof Error?h.message:"Formato invlido",variant:"destructive"})}};return e.jsxs(Mt,{open:s,onOpenChange:r,children:[e.jsxs(P,{variant:"outline",size:"sm",type:"button",onClick:()=>r(!0),disabled:a,children:[e.jsx(HM,{className:"h-4 w-4 mr-2"}),"Pegar JSON"]}),e.jsxs(Tt,{children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Pegar Plan de Comidas"})}),e.jsx(sa,{value:l,onChange:h=>o(h.target.value),placeholder:"Pegue aqu el JSON del plan de comidas",className:"mt-4 min-h-[200px]"}),e.jsxs(Cs,{className:"gap-2 sm:gap-0",children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>r(!1),className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(P,{type:"button",onClick:m,className:"flex-1 sm:flex-none",disabled:!l.trim(),children:"Importar"})]})]})]})};class bh{static client=ze;static table(a){return ze.from(a)}}const mk=()=>{const[t,a]=p.useState({}),[s,r]=p.useState("idle"),[l,o]=p.useState(null),{user:d}=st(),u=Object.values(t).reduce((y,v)=>({...y,...v}),{}),m=p.useCallback(async()=>{if(d){r("loading"),o(null);try{const y=bU(),{data:v,error:b}=await bh.table("meal_plan_entries").select("*").eq("user_id",d.id);if(b)throw b;const N={};y.forEach(S=>{N[S]={}}),(v||[]).forEach(S=>{const w=S.date,[E,T]=w.split("-"),D=`${E}-${T}`;N[D]||(N[D]={}),N[D][w]||(N[D][w]={});const k=`${w}_${S.meal_type}`;N[D][w][S.meal_type]={id:k,type:S.meal_type,name:S.name||"",notes:S.notes,calories:S.calories,recipe:S.recipe_id}}),a(N),r("saved")}catch(y){console.error("Error loading meal plans:",y),o(y instanceof Error?y.message:"Error al cargar el plan"),r("error")}}},[d]);p.useEffect(()=>{m()},[m]);const h=p.useCallback(async(y,v,b)=>{if(!d)return;if(!b.name||b.name.trim()==="")throw new Error("El nombre de la comida es obligatorio");r("saving"),o(null);const[N,S]=y.split("-"),w=`${N}-${S}`,E=`${y}_${v}`,T=t[w]||{};try{const D={...T,[y]:{...T[y],[v]:{id:E,...b,calories:b.calories}}};a(_=>({..._,[w]:D}));const{error:k}=await bh.table("meal_plan_entries").upsert({user_id:d.id,date:y,meal_type:v,name:b.name.trim(),notes:b.notes,calories:b.calories?Number(b.calories):null,recipe_id:b.recipe||null},{onConflict:"user_id,date,meal_type"});if(k)throw k;r("saved")}catch(D){throw console.error("Error adding meal:",D),a(k=>({...k,[w]:T})),o(D instanceof Error?D.message:"Error al guardar"),r("error"),D}},[d,t]),g=p.useCallback(async(y,v)=>{if(!d)return;r("saving"),o(null);const[b,N]=y.split("-"),S=`${b}-${N}`,w=t[S]||{};try{const E=JSON.parse(JSON.stringify(w));if(E[y]){const D={...E[y]};delete D[v],Object.keys(D).length===0?delete E[y]:E[y]=D}a(D=>({...D,[S]:E}));const{error:T}=await bh.table("meal_plan_entries").delete().eq("user_id",d.id).eq("date",y).eq("meal_type",v);if(T)throw T;r("saved")}catch(E){throw console.error("Error removing meal:",E),a(T=>({...T,[S]:w})),o(E instanceof Error?E.message:"Error al eliminar"),r("error"),E}},[d,t]),x=p.useCallback(async y=>{if(!d)return;r("saving"),o(null);const v=t;try{const b=[];Object.entries(y).forEach(([w,E])=>{Object.entries(E).forEach(([T,D])=>{if(!D.name||D.name.trim()===""){console.warn(`Skipping meal without name for ${w} ${T}`);return}b.push({user_id:d.id,date:w,meal_type:T,name:D.name.trim(),notes:D.notes||null,calories:D.calories?Number(D.calories):null,recipe_id:D.recipe||null})})});const N=Object.entries(y).reduce((w,[E,T])=>{const[D,k]=E.split("-"),_=`${D}-${k}`;return w[_]||(w[_]={}),w[_][E]=Object.entries(T).reduce((R,[L,U])=>{if(!U.name||U.name.trim()==="")return R;const V=`${E}_${L}`;return R[L]={...U,id:V,type:L,name:U.name.trim(),calories:U.calories?Number(U.calories):void 0},R},{}),w},{});a(w=>({...w,...N}));const{error:S}=await bh.table("meal_plan_entries").upsert(b,{onConflict:"user_id,date,meal_type"});if(S)throw S;r("saved")}catch(b){throw console.error("Error importing meal plan:",b),a(v),o(b instanceof Error?b.message:"Error al importar"),r("error"),b}},[d,t]);return{mealPlan:u,status:s,error:l,addMeal:h,removeMeal:g,importMealPlan:x,loadMealPlans:m}},bU=()=>{const t=new Date,a=t.getFullYear(),s=t.getMonth()+1,r=t.getDate(),l=new Date(a,s,0).getDate(),o=String(s).padStart(2,"0"),d=[`${a}-${o}`];if(l-r<7){let u=s+1,m=a;u>12&&(u=1,m=a+1);const h=String(u).padStart(2,"0");d.push(`${m}-${h}`)}return d};class Dr{static client=ze;static table(a){return ze.from(a)}}const Uu=()=>{const{user:t}=st(),[a,s]=p.useState([]),[r,l]=p.useState("idle"),[o,d]=p.useState(null),u=p.useCallback(async()=>{if(t){l("loading"),d(null);try{const{data:x,error:y}=await Dr.table("recipes").select("*").eq("user_id",t.id);if(y)throw y;const v=(x||[]).map(b=>({id:b.id,name:b.name,instructions:b.instructions||"",nutrition:b.nutrition||{calories:0,protein:0,carbs:0,fat:0},mealType:b.meal_type,...b.description&&{description:b.description},...b.difficulty&&{difficulty:b.difficulty},...b.prep_time!==void 0&&{prepTime:b.prep_time},...b.favorite!==void 0&&{favorite:b.favorite}}));s(v),l("idle")}catch(x){console.error("Error loading recipes:",x),d(x instanceof Error?x.message:"Error al cargar recetas"),l("error")}}},[t]);return p.useEffect(()=>{if(!t){s([]);return}u()},[t,u]),{recipes:a,status:r,error:o,addRecipe:async x=>{if(!t)return d("Usuario no autenticado"),null;l("saving"),d(null);const y={id:`temp-${Date.now()}`,...x};s(v=>[...v,y]);try{const{data:v,error:b}=await Dr.table("recipes").insert({user_id:t.id,name:x.name,instructions:x.instructions,nutrition:x.nutrition,meal_type:x.mealType,description:x.description||null,difficulty:x.difficulty||null,prep_time:x.prepTime||null,favorite:x.favorite||!1,created_at:new Date().toISOString()}).select().single();if(b)throw b;return s(N=>N.map(S=>S.id===y.id?{...S,id:v.id}:S)),l("idle"),v.id}catch(v){return console.error("Error adding recipe:",v),s(b=>b.filter(N=>N.id!==y.id)),d(v instanceof Error?v.message:"Error al guardar"),l("error"),null}},updateRecipe:async(x,y)=>{if(!t){d("Usuario no autenticado");return}l("saving"),d(null);const v=a.find(b=>b.id===x);if(v)try{const b={...v,...y};s(w=>w.map(E=>E.id===x?b:E));const N={};y.name!==void 0&&(N.name=y.name),y.instructions!==void 0&&(N.instructions=y.instructions),y.nutrition!==void 0&&(N.nutrition=y.nutrition),y.mealType!==void 0&&(N.meal_type=y.mealType),y.description!==void 0&&(N.description=y.description),y.difficulty!==void 0&&(N.difficulty=y.difficulty),y.prepTime!==void 0&&(N.prep_time=y.prepTime),y.favorite!==void 0&&(N.favorite=y.favorite);const{error:S}=await Dr.table("recipes").update(N).eq("id",x);if(S)throw S;l("idle")}catch(b){console.error("Error updating recipe:",b),s(N=>N.map(S=>S.id===x?v:S)),d(b instanceof Error?b.message:"Error al actualizar"),l("error")}},deleteRecipe:async x=>{if(!t){d("Usuario no autenticado");return}l("saving"),d(null);const y=a.find(v=>v.id===x);if(y)try{s(b=>b.filter(N=>N.id!==x));const{error:v}=await Dr.table("recipes").delete().eq("id",x);if(v)throw v;l("idle")}catch(v){console.error("Error deleting recipe:",v),s(b=>[...b,y]),d(v instanceof Error?v.message:"Error al eliminar"),l("error")}},loadRecipes:u}};class jh{static client=ze;static table(a){return ze.from(a)}}const iv=()=>{const{user:t}=st(),[a,s]=p.useState([]),[r,l]=p.useState("idle"),[o,d]=p.useState(null),u=p.useCallback(async()=>{if(t){l("loading"),d(null);try{const{data:x,error:y}=await jh.table("prepared_meals").select("*").eq("user_id",t.id);if(y)throw y;const v=(x||[]).map(b=>({id:b.id,name:b.name||"",...b.portions!==void 0&&{portions:b.portions}}));s(v),l("idle")}catch(x){console.error("Error loading prepared meals:",x),d(x instanceof Error?x.message:"Error al cargar comidas"),l("error")}}},[t]);return p.useEffect(()=>{if(!t){s([]);return}u()},[t,u]),{meals:a,status:r,error:o,addMeal:async x=>{if(!t){d("Usuario no autenticado");return}l("saving"),d(null);const y={id:`temp-${Date.now()}`,...x};s(v=>[...v,y]);try{const{data:v,error:b}=await jh.table("prepared_meals").insert({user_id:t.id,name:x.name,portions:x.portions||null}).select().single();if(b)throw b;s(N=>N.map(S=>S.id===y.id?{...S,id:v.id}:S)),l("idle")}catch(v){console.error("Error adding prepared meal:",v),s(N=>N.filter(S=>S.id!==y.id));const b=v instanceof Error?v.message:"Error al guardar";d(b),l("error")}},updateMeal:async(x,y)=>{if(!t){d("Usuario no autenticado");return}l("saving"),d(null);const v=a.find(b=>b.id===x);if(v)try{const b={...v,...y};s(w=>w.map(E=>E.id===x?b:E));const N={};y.name!==void 0&&(N.name=y.name),y.portions!==void 0&&(N.portions=y.portions);const{error:S}=await jh.table("prepared_meals").update(N).eq("id",x);if(S)throw S;l("idle")}catch(b){console.error("Error updating prepared meal:",b),s(S=>S.map(w=>w.id===x?v:w));const N=b instanceof Error?b.message:"Error al actualizar";d(N),l("error")}},deleteMeal:async x=>{if(!t){d("Usuario no autenticado");return}l("saving"),d(null);const y=a.find(v=>v.id===x);if(y)try{s(b=>b.filter(N=>N.id!==x));const{error:v}=await jh.table("prepared_meals").delete().eq("id",x);if(v)throw v;l("idle")}catch(v){console.error("Error deleting prepared meal:",v),s(N=>[...N,y]);const b=v instanceof Error?v.message:"Error al eliminar";d(b),l("error")}},loadMeals:u}},jU=[{path:ae.meal.view("weekly"),label:"Plan de Comidas",icon:e.jsx(Aa,{className:"h-4 w-4"})},{path:ae.shoppingList.view("list"),label:"Lista de Compras",icon:e.jsx(lr,{className:"h-4 w-4"})},{path:ae.recipes.view("list"),label:"Recetas",icon:e.jsx(xl,{className:"h-4 w-4"})},{path:ae.preparedMeals.view("list"),label:"Comidas Preparadas",icon:e.jsx(gl,{className:"h-4 w-4"})}],Jf=({title:t,views:a,activeViewKey:s,onViewChange:r,children:l,className:o})=>{const d=gs(),u=a?.find(m=>m.key===s)?.label;return e.jsx("div",{className:he("",o),children:e.jsx("div",{className:"w-full px-6",children:e.jsxs("div",{className:"bg-background/50 flex items-center justify-between gap-2 py-4 backdrop-blur-md lg:mt-4 lg:rounded-2xl lg:border lg:px-4",children:[e.jsx("div",{className:"flex items-center gap-5",children:e.jsxs("div",{className:"flex items-center gap-12",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-sm",children:e.jsx(b1,{className:"h-4 w-4 text-white"})}),e.jsx("h2",{className:"text-lg font-bold text-foreground",children:t})]}),e.jsx("nav",{className:"hidden md:flex gap-2 lg:gap-4",children:jU.map(m=>{const h=m.path.includes(`${ae.shoppingList.base}/`)?d.pathname.startsWith(ae.shoppingList.base):d.pathname===m.path;return e.jsxs(La,{to:m.path,className:he("flex items-center space-x-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 group","hover:bg-white/90 hover:shadow-lg",h?"bg-white text-blue-700 shadow-lg border border-blue-200":"text-gray-700 hover:text-gray-900"),children:[e.jsx("span",{className:he("p-1.5 rounded-lg transition-colors",h?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600 group-hover:bg-gray-200"),children:m.icon}),e.jsx("span",{className:"whitespace-nowrap",children:m.label})]},m.path)})})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[a&&r&&e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx("span",{children:u??"Vistas"}),e.jsx(rn,{className:"h-4 w-4"})]})}),e.jsx(Nn,{align:"end",children:a.map(m=>e.jsx(Lt,{onClick:()=>r(m.key),className:he(s===m.key&&"bg-accent font-medium"),children:m.label},m.key))})]}),l&&e.jsx("div",{className:"flex items-center gap-3",children:l})]})]})})})},lv=({open:t,onOpenChange:a,config:s,customFieldValues:r={},onCustomFieldChange:l})=>{const[o,d]=p.useState(0),[u,m]=p.useState([]),[h,g]=p.useState({}),[x,y]=p.useState(""),[v,b]=p.useState(!1),N=u.map(I=>s.modules.find(O=>O.id===I)).filter(I=>I!==void 0),S=N.filter(I=>I.fields&&I.fields.length>0),w=1+S.length+1,E=I=>{m(O=>O.includes(I)?O.filter(Y=>Y!==I):[...O,I])},T=(I,O)=>{g(Y=>{const le=Y[I]||[],re=le.includes(O)?le.filter(Q=>Q!==O):[...le,O];return{...Y,[I]:re}})},D=()=>{o===0?S.length>0?d(1):(_(),d(w-1)):o<w-1&&(o===S.length&&_(),d(o+1))},k=()=>{o>0&&d(o-1)},_=()=>{const I={};N.forEach(O=>{if(O){const Y=h[O.id]||[],le=r[O.id]||{},re=O.dataGenerator(Y,le);re&&Object.keys(re).length>0&&Object.assign(I,re)}}),y(JSON.stringify(I,null,2))},R=async()=>{try{await navigator.clipboard.writeText(x),b(!0),ut.success("JSON copiado al portapapeles"),setTimeout(()=>b(!1),2e3)}catch{ut.error("Error al copiar al portapapeles")}},L=()=>{d(0),m([]),g({}),y(""),b(!1),a(!1)},U=()=>{if(o===0)return u.length>0;if(o>0&&o<=S.length){const I=o-1,O=S[I];if(!O||O.fields?.every(Q=>Q.type==="custom"))return!0;const le=h[O.id]||[];return O.fields?.some(Q=>Q.type!=="custom")?le.length>0:!0}return!0},V=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Selecciona los mdulos que deseas exportar:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.modules.map(I=>e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Va,{id:I.id,checked:u.includes(I.id),onCheckedChange:()=>E(I.id),className:"mt-1"}),I.icon&&e.jsx("div",{className:"mt-1 text-gray-600",children:I.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:I.id,className:"text-sm font-medium cursor-pointer block",children:I.label}),I.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:I.description})]})]},I.id))})]}),F=I=>{const O=S[I];return!O||!O.fields?null:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["Configura los campos para ",e.jsx("strong",{children:O.label}),":"]}),e.jsxs(fe,{children:[e.jsx(xt,{className:"pb-3",children:e.jsxs(mt,{className:"text-base flex items-center gap-2",children:[O.icon,O.label]})}),e.jsx(xe,{className:"space-y-3",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:O.fields.map(Y=>e.jsx("div",{children:Y.type==="custom"&&Y.component?e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium block",children:Y.label}),Y.description&&e.jsx("p",{className:"text-xs text-gray-500",children:Y.description}),Y.component]}):e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Va,{id:`${O.id}-${Y.id}`,checked:h[O.id]?.includes(Y.id)||!1,onCheckedChange:()=>T(O.id,Y.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`${O.id}-${Y.id}`,className:"text-sm font-medium cursor-pointer block",children:Y.label}),Y.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Y.description})]})]})},Y.id))})})]})]})},G=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Aqu est tu JSON generado. Puedes copiarlo al portapapeles:"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-gray-100 p-4 rounded-lg text-xs overflow-auto max-h-96 border",children:x}),e.jsxs(P,{onClick:R,variant:"outline",size:"sm",className:"absolute top-2 right-2 gap-2",disabled:v,children:[v?e.jsx(cr,{className:"w-4 h-4"}):e.jsx(Rr,{className:"w-4 h-4"}),v?"Copiado":"Copiar"]})]})]}),$=()=>o===0?V():o<=S.length?F(o-1):G(),z=()=>o===0?"Seleccionar Mdulos":o<=S.length?`Configurar ${S[o-1]?.label}`:"Resultado",H=()=>{const I=[{label:"Mdulos",isCompleted:o>0,isCurrent:o===0}];return S.forEach((O,Y)=>{const le=Y+1;O&&I.push({label:O.label,isCompleted:o>le,isCurrent:o===le})}),I.push({label:"Resultado",isCompleted:!1,isCurrent:o===w-1}),e.jsxs("div",{className:"bg-gray-50 border-b",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2 py-4 px-6",children:I.map((O,Y)=>e.jsxs(te.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${O.isCompleted?"bg-green-500 text-white":O.isCurrent?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:O.isCompleted?e.jsx(xi,{className:"w-4 h-4"}):Y+1}),e.jsx("span",{className:`ml-2 text-sm font-medium ${O.isCurrent?"text-blue-600":O.isCompleted?"text-green-600":"text-gray-500"}`,children:O.label})]}),Y<I.length-1&&e.jsx(wn,{className:"w-4 h-4 text-gray-400"})]},Y))}),o>0&&N.length>0&&e.jsxs("div",{className:"px-6 pb-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Mdulos seleccionados:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:N.map(O=>O&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[O.icon,O.label]},O.id))})]})]})};return e.jsx(Mt,{open:t,onOpenChange:L,children:e.jsxs(Tt,{className:"sm:max-w-5xl max-h-[85vh] overflow-y-auto p-0",children:[e.jsx(Ot,{className:"px-6 pt-6 pb-0",children:e.jsxs(Rt,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.title}),e.jsx("span",{className:"text-sm font-normal text-gray-500 mt-1",children:z()})]}),e.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["Paso ",o+1," de ",w]})]})}),H(),e.jsx("div",{className:"px-6 pb-6",children:$()}),e.jsxs("div",{className:"flex justify-between px-6 py-4 border-t bg-gray-50",children:[e.jsxs(P,{variant:"outline",onClick:k,disabled:o===0,className:"gap-2",children:[e.jsx(kc,{className:"w-4 h-4"}),"Anterior"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",onClick:L,children:"Cancelar"}),o<w-1?e.jsxs(P,{onClick:D,disabled:!U(),className:"gap-2",children:["Siguiente",e.jsx(wn,{className:"w-4 h-4"})]}):e.jsx(P,{onClick:L,children:"Finalizar"})]})]})]})})},NU=({open:t,onOpenChange:a})=>{const{items:s}=bl(),{recipes:r}=Uu(),{meals:l}=iv(),{mealPlan:o}=mk(),[d,u]=p.useState({mealPlan:{dateRange:"today"}}),m=(g,x,y)=>{u(v=>({...v,[g]:{...v[g],[x]:y}}))},h={title:"Exportar Datos de Comidas",modules:[{id:"ingredients",label:"Ingredientes",description:"Lista de ingredientes disponibles con cantidades",icon:e.jsx(gl,{className:"w-4 h-4"}),fields:[{id:"in-stock",label:"En stock",description:"Elementos que ya tienes disponibles"},{id:"low-stock",label:"Stock bajo",description:"Elementos que necesitas reponer pronto"},{id:"to-buy",label:"Pendientes de compra",description:"Elementos que planeas comprar"},{id:"excludeNonFood",label:"Excluir no comestibles",description:"Filtrar elementos de aseo y limpieza"},{id:"withQuantities",label:"Incluir cantidades",description:"Agregar cantidades especficas de cada ingrediente"},{id:"groupByStatus",label:"Agrupar por estado",description:"Organizar por en stock, stock bajo, pendiente"}],dataGenerator:(g,x)=>{const y=["aseo","otro","limpieza"];let v=s;g.includes("excludeNonFood")&&(v=v.filter(w=>{if(!w.category)return!0;const E=w.category.toLowerCase();return!y.some(T=>E.includes(T))}));const b=[];g.includes("in-stock")&&b.push("in-stock"),g.includes("low-stock")&&b.push("low-stock"),g.includes("to-buy")&&b.push("to-buy"),b.length>0&&(v=v.filter(w=>b.includes(w.status)));const N=g.includes("withQuantities");return g.includes("groupByStatus")?{ingredientes:v.reduce((E,T)=>{const k={"in-stock":"en_stock","low-stock":"stock_bajo","to-buy":"pendiente_compra"}[T.status]||T.status;E[k]||(E[k]=[]);const _=N?{name:T.name,quantity:T.stock}:{name:T.name};return E[k].push(_),E},{})}:{ingredientes:v.map(E=>N?{name:E.name,quantity:E.stock,status:E.status}:{name:E.name,status:E.status})}}},{id:"preparedMeals",label:"Comidas Preparadas",description:"Lista de comidas ya preparadas",icon:e.jsx(xl,{className:"w-4 h-4"}),dataGenerator:(g,x)=>({comidasPreparadas:l.map(y=>({name:y.name,...y.portions!==void 0&&{porciones:y.portions}}))})},{id:"mealPlan",label:"Plan de Comidas",description:"Plan de comidas con selector de rango",icon:e.jsx(Aa,{className:"w-4 h-4"}),fields:[{id:"dateRange",label:"Rango de fechas",description:"Selecciona qu perodo exportar",type:"custom",component:e.jsxs(yt,{value:d.mealPlan?.dateRange||"today",onValueChange:g=>m("mealPlan","dateRange",g),children:[e.jsx(ft,{className:"w-full",children:e.jsx(vt,{placeholder:"Selecciona el rango"})}),e.jsxs(pt,{children:[e.jsxs(Le,{value:"today",children:["Solo hoy (",Jt(new Date,"dd/MM/yyyy",{locale:As}),")"]}),e.jsx(Le,{value:"yesterday-today",children:"Ayer y hoy"}),e.jsx(Le,{value:"current-week",children:"Semana actual"}),e.jsx(Le,{value:"all",children:"Todo el plan"})]})]})}],dataGenerator:(g,x)=>{const y=x?.dateRange||"today",v=new Date,b=Jt(v,"yyyy-MM-dd");let N={...o};switch(y){case"today":N={[b]:o[b]||{}};break;case"yesterday-today":const S=kM(v),w=Jt(S,"yyyy-MM-dd");N={[w]:o[w]||{},[b]:o[b]||{}};break;case"current-week":const E=nc(v,{weekStartsOn:1}),T=rc(v,{weekStartsOn:1});N={};for(let D=new Date(E);D<=T;D.setDate(D.getDate()+1)){const k=Jt(D,"yyyy-MM-dd");o[k]&&(N[k]=o[k])}break;default:N=o;break}return{planComidas:N,rango:y,fechas:Object.keys(N).sort()}}},{id:"recipes",label:"Recetas",description:"Recetas disponibles con campos personalizables",icon:e.jsx(ro,{className:"w-4 h-4"}),fields:[{id:"allRecipes",label:"Todas las recetas",description:"Incluir todas las recetas (por defecto solo favoritas)"},{id:"name",label:"Nombre",description:"Nombre de la receta"},{id:"description",label:"Descripcin",description:"Descripcin de la receta"},{id:"ingredients",label:"Ingredientes",description:"Lista de ingredientes y cantidades"},{id:"instructions",label:"Pasos de preparacin",description:"Instrucciones paso a paso"},{id:"prepTime",label:"Tiempo estimado",description:"Tiempo de preparacin en minutos"},{id:"mealType",label:"Tipo de comida",description:"Categora de la comida"},{id:"difficulty",label:"Dificultad",description:"Nivel de dificultad"},{id:"nutrition",label:"Informacin nutricional",description:"Caloras, protenas, carbohidratos, grasas"}],dataGenerator:(g,x)=>{const y=g.includes("allRecipes"),b=(y?r:r.filter(N=>N.favorite===!0)).map(N=>{const S={};return g.length===0||g.length===1&&g[0]==="allRecipes"?{name:N.name,description:N.description,ingredients:N.ingredients,instructions:N.instructions,mealType:N.mealType,favorite:N.favorite}:(g.includes("name")&&(S.name=N.name),g.includes("description")&&N.description&&(S.description=N.description),g.includes("ingredients")&&(S.ingredients=N.ingredients),g.includes("instructions")&&(S.instructions=N.instructions),g.includes("prepTime")&&N.prepTime&&(S.prepTime=N.prepTime),g.includes("mealType")&&(S.mealType=N.mealType),g.includes("difficulty")&&N.difficulty&&(S.difficulty=N.difficulty),g.includes("nutrition")&&(S.nutrition=N.nutrition),S)});return{recetas:b,total:b.length,tipo:y?"todas":"favoritas"}}}]};return e.jsx(lv,{open:t,onOpenChange:a,config:h,customFieldValues:d,onCustomFieldChange:m})},wU=({selectedDate:t})=>{const{user:a}=st(),{toast:s}=Zf(),r=gs(),l=it(),[o,d]=p.useState(!1),[u,m]=p.useState(!1),{mealPlan:h,status:g,error:x,addMeal:y,removeMeal:v,importMealPlan:b}=mk(),{isOnline:N}=Au();if(bl(),Uu(),iv(),!a)return e.jsx(fe,{className:"w-full h-full",children:e.jsx(xe,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesin para planificar tus comidas"})})});const S=async(...D)=>{try{await y(...D)}catch(k){console.error("Error adding meal:",k),s({title:"Error al Agregar",description:"No se pudo agregar la comida.",variant:"destructive"})}},w=async(...D)=>{try{await v(...D)}catch(k){console.error("Error removing meal:",k),s({title:"Error al Eliminar",description:"No se pudo eliminar la comida.",variant:"destructive"})}},E=async(...D)=>{try{await b(...D),s({title:"Importacin Exitosa",description:"El plan de comidas se ha importado correctamente."}),d(!1)}catch(k){console.error("Error importing meal plan:",k),s({title:"Error al Importar",description:"No se pudo importar el plan de comidas.",variant:"destructive"})}},T=()=>{m(!0)};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs(Jf,{title:"Plan de Comidas",views:[{key:"weekly",label:"Semanal"}],activeViewKey:"weekly",onViewChange:()=>l(ae.meal.view("weekly")),children:[e.jsx(Vs,{children:e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>d(!0),children:[e.jsx(hu,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Importar Plan"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Importar Plan"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:T,children:[e.jsx(Or,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Exportar"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Exportar"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>l(ae.meal.config),children:[e.jsx(_s,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Configuracion"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Configuracion"})})]})]})}),e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(Su,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(Nn,{align:"end",children:[e.jsxs(Lt,{onClick:()=>d(!0),children:[e.jsx(hu,{className:"mr-2 h-4 w-4"}),"Importar Plan"]}),e.jsxs(Lt,{onClick:T,children:[e.jsx(Or,{className:"mr-2 h-4 w-4"}),"Exportar"]}),e.jsxs(Lt,{onClick:()=>l(ae.meal.config),children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),"Configuracion"]}),e.jsx(Ou,{}),r.pathname!==ae.meal.view("weekly")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.meal.view("weekly"),className:"flex items-center",children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"}),"Plan de Comidas"]})}),!r.pathname.startsWith(ae.shoppingList.base)&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.shoppingList.view("list"),className:"flex items-center",children:[e.jsx(lr,{className:"mr-2 h-4 w-4"}),"Lista de Compras"]})}),r.pathname!==ae.recipes.view("list")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.recipes.view("list"),className:"flex items-center",children:[e.jsx(xl,{className:"mr-2 h-4 w-4"}),"Recetas"]})}),r.pathname!==ae.preparedMeals.view("list")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.preparedMeals.view("list"),className:"flex items-center",children:[e.jsx(gl,{className:"mr-2 h-4 w-4"}),"Comidas Preparadas"]})})]})]})]}),e.jsxs("div",{className:"flex-1 bg-gray-50 overflow-hidden",children:[e.jsx(gU,{mealPlan:h,onAddMeal:S,onRemoveMeal:w,disabled:g==="saving",selectedDate:t}),x&&e.jsxs(ao,{variant:"destructive",className:"m-4",children:[e.jsx(hc,{className:"h-4 w-4"}),e.jsx(so,{className:"text-sm",children:x})]})]}),e.jsx(Mt,{open:o,onOpenChange:d,children:e.jsxs(Tt,{className:"sm:max-w-md",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Importar Plan de Comidas"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Puedes importar un plan de comidas desde un archivo JSON o pegando el contenido directamente."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(yU,{onImport:E,disabled:g==="saving"}),e.jsx(vU,{onImport:E,disabled:g==="saving"})]})]})]})}),e.jsx(NU,{open:u,onOpenChange:m}),e.jsxs("div",{className:"flex justify-center items-center gap-2 text-xs p-2 border-t bg-white",children:[g==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),g==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),g==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),g==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronizacin"}),!N&&e.jsx("span",{className:"text-orange-600",children:"Offline"})]})]})},hk=[{key:"weekly",label:"Semanal"}],WS="weekly",SU=()=>{const{viewKey:t}=Ss(),a=t||WS;return hk.some(r=>r.key===a)?e.jsx(wi,{noPadding:!0,className:"h-full",children:e.jsx(wU,{selectedDate:new Date})}):e.jsx(Ft,{to:`/meal/view/${WS}`,replace:!0})},CU=()=>{const t=it();return e.jsx(na,{title:"Configuracion de Comidas",icon:e.jsx(b1,{className:"h-4 w-4 text-white"}),views:hk.map(a=>({...a,component:()=>null})),onViewChange:a=>t(`/meal/view/${a}`),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"No hay configuraciones especificas para Comidas en este modulo."})})})})},EU={module:"meal",defaultRoute:ae.meal.view(ae.meal.defaultView),moduleRoutes:[{path:"meal",element:e.jsx(Ft,{to:ae.meal.view(ae.meal.defaultView),replace:!0})},{path:"meal/view/:viewKey",element:e.jsx(SU,{})},{path:"meal/config",element:e.jsx(CU,{})}]};var fk="Toggle",ov=p.forwardRef((t,a)=>{const{pressed:s,defaultPressed:r,onPressedChange:l,...o}=t,[d,u]=Mr({prop:s,onChange:l,defaultProp:r??!1,caller:fk});return e.jsx(Gt.button,{type:"button","aria-pressed":d,"data-state":d?"on":"off","data-disabled":t.disabled?"":void 0,...o,ref:a,onClick:Nt(t.onClick,()=>{t.disabled||u(!d)})})});ov.displayName=fk;var pk=ov,Sl="ToggleGroup",[xk,z7]=vi(Sl,[yf]),gk=yf(),cv=te.forwardRef((t,a)=>{const{type:s,...r}=t;if(s==="single"){const l=r;return e.jsx(TU,{...l,ref:a})}if(s==="multiple"){const l=r;return e.jsx(DU,{...l,ref:a})}throw new Error(`Missing prop \`type\` expected on \`${Sl}\``)});cv.displayName=Sl;var[yk,vk]=xk(Sl),TU=te.forwardRef((t,a)=>{const{value:s,defaultValue:r,onValueChange:l=()=>{},...o}=t,[d,u]=Mr({prop:s,defaultProp:r??"",onChange:l,caller:Sl});return e.jsx(yk,{scope:t.__scopeToggleGroup,type:"single",value:te.useMemo(()=>d?[d]:[],[d]),onItemActivate:u,onItemDeactivate:te.useCallback(()=>u(""),[u]),children:e.jsx(bk,{...o,ref:a})})}),DU=te.forwardRef((t,a)=>{const{value:s,defaultValue:r,onValueChange:l=()=>{},...o}=t,[d,u]=Mr({prop:s,defaultProp:r??[],onChange:l,caller:Sl}),m=te.useCallback(g=>u((x=[])=>[...x,g]),[u]),h=te.useCallback(g=>u((x=[])=>x.filter(y=>y!==g)),[u]);return e.jsx(yk,{scope:t.__scopeToggleGroup,type:"multiple",value:d,onItemActivate:m,onItemDeactivate:h,children:e.jsx(bk,{...o,ref:a})})});cv.displayName=Sl;var[kU,AU]=xk(Sl),bk=te.forwardRef((t,a)=>{const{__scopeToggleGroup:s,disabled:r=!1,rovingFocus:l=!0,orientation:o,dir:d,loop:u=!0,...m}=t,h=gk(s),g=gf(d),x={role:"group",dir:g,...m};return e.jsx(kU,{scope:s,rovingFocus:l,disabled:r,children:l?e.jsx(QC,{asChild:!0,...h,orientation:o,dir:g,loop:u,children:e.jsx(Gt.div,{...x,ref:a})}):e.jsx(Gt.div,{...x,ref:a})})}),df="ToggleGroupItem",jk=te.forwardRef((t,a)=>{const s=vk(df,t.__scopeToggleGroup),r=AU(df,t.__scopeToggleGroup),l=gk(t.__scopeToggleGroup),o=s.value.includes(t.value),d=r.disabled||t.disabled,u={...t,pressed:o,disabled:d},m=te.useRef(null);return r.rovingFocus?e.jsx(ZC,{asChild:!0,...l,focusable:!d,active:o,ref:m,children:e.jsx(KS,{...u,ref:a})}):e.jsx(KS,{...u,ref:a})});jk.displayName=df;var KS=te.forwardRef((t,a)=>{const{__scopeToggleGroup:s,value:r,...l}=t,o=vk(df,s),d={role:"radio","aria-checked":t.pressed,"aria-pressed":void 0},u=o.type==="single"?d:void 0;return e.jsx(ov,{...u,...l,ref:a,onPressedChange:m=>{m?o.onItemActivate(r):o.onItemDeactivate(r)}})}),Nk=cv,wk=jk;const Sk=Dc("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),_U=p.forwardRef(({className:t,variant:a,size:s,...r},l)=>e.jsx(pk,{ref:l,className:he(Sk({variant:a,size:s,className:t})),...r}));_U.displayName=pk.displayName;const Ck=p.createContext({size:"default",variant:"default"}),Ek=p.forwardRef(({className:t,variant:a,size:s,children:r,...l},o)=>e.jsx(Nk,{ref:o,className:he("flex items-center justify-center gap-1",t),...l,children:e.jsx(Ck.Provider,{value:{variant:a,size:s},children:r})}));Ek.displayName=Nk.displayName;const Y0=p.forwardRef(({className:t,children:a,variant:s,size:r,...l},o)=>{const d=p.useContext(Ck);return e.jsx(wk,{ref:o,className:he(Sk({variant:d.variant||s,size:d.size||r}),t),...l,children:a})});Y0.displayName=wk.displayName;const MU=({open:t,onOpenChange:a})=>{const{items:s}=bl(),r={title:"Exportar Lista de Compras",modules:[{id:"shoppingList",label:"Lista de Compras",description:"Elementos de la lista con opciones de formato",icon:e.jsx(lr,{className:"w-4 h-4"}),fields:[{id:"in-stock",label:"En stock",description:"Elementos que ya tienes disponibles"},{id:"low-stock",label:"Stock bajo",description:"Elementos que necesitas reponer pronto"},{id:"to-buy",label:"Pendientes de compra",description:"Elementos que planeas comprar"},{id:"nextPurchase",label:"Solo prximas compras",description:"Filtrar solo elementos marcados para prxima compra"},{id:"excludeCategories",label:"Excluir no comestibles",description:"Filtrar elementos de aseo y otros no comestibles"},{id:"withQuantities",label:"Incluir cantidades",description:"Agregar informacin de cantidades"},{id:"withPrices",label:"Incluir precios",description:"Agregar informacin de precios cuando est disponible"},{id:"withDates",label:"Incluir fechas de consumo",description:"Agregar fechas de consumo preferente"},{id:"withPlaces",label:"Incluir lugares de compra",description:"Agregar informacin de dnde comprar"},{id:"byStatus",label:"Agrupar por estado",description:"Organizar elementos por estado (en stock, stock bajo, pendiente)"},{id:"byCategory",label:"Agrupar por categora",description:"Organizar elementos por categoras"}],dataGenerator:(l,o)=>{let d=[...s];if(l.includes("excludeCategories")){const h=["aseo","otro","limpieza"];d=d.filter(g=>{if(!g.category)return!0;const x=g.category.toLowerCase();return!h.some(y=>x.includes(y))})}l.includes("nextPurchase")&&(d=d.filter(h=>h.nextPurchase===!0));const u=[];l.includes("in-stock")&&u.push("in-stock"),l.includes("low-stock")&&u.push("low-stock"),l.includes("to-buy")&&u.push("to-buy"),u.length>0&&(d=d.filter(h=>u.includes(h.status)));const m=h=>{const g={name:h.name};return l.includes("withQuantities")&&(g.quantity=h.stock),l.includes("withPrices")&&h.price&&(g.price=h.price),l.includes("withDates")&&h.consumeBy&&(g.consumeBy=h.consumeBy),l.includes("withPlaces")&&h.place&&(g.place=h.place),g};if(l.includes("byStatus")&&l.includes("byCategory"))return{listaCompras:d.reduce((g,x)=>{const v={"in-stock":"en_stock","low-stock":"stock_bajo","to-buy":"pendiente_compra"}[x.status]||x.status,b=x.category||"sin_categoria";return g[v]||(g[v]={}),g[v][b]||(g[v][b]=[]),g[v][b].push(m(x)),g},{})};if(l.includes("byStatus")){const h={"in-stock":"en_stock","low-stock":"stock_bajo","to-buy":"pendiente_compra"};return{listaCompras:d.reduce((x,y)=>{const v=h[y.status]||y.status;return x[v]||(x[v]=[]),x[v].push(m(y)),x},{})}}else return l.includes("byCategory")?{listaCompras:d.reduce((g,x)=>{const y=x.category||"sin_categoria";return g[y]||(g[y]=[]),g[y].push(m(x)),g},{})}:{listaCompras:d.map(m),total:d.length}}}]};return e.jsx(lv,{open:t,onOpenChange:a,config:r})},Tk=[{value:"Aseo y Limpieza",emoji:""},{value:"Bebidas",emoji:""},{value:"Carnes y Pescados",emoji:""},{value:"Cereales y Granos",emoji:""},{value:"Condimentos y Especias",emoji:""},{value:"Congelados",emoji:""},{value:"Cuidado Personal",emoji:""},{value:"Enlatados y Conservas",emoji:""},{value:"Frutas y Verduras",emoji:""},{value:"Lcteos y Huevos",emoji:""},{value:"Panadera",emoji:""},{value:"Snacks y Dulces",emoji:""},{value:"Mascotas",emoji:""},{value:"Otro",emoji:""}],OU=Tk.reduce((t,a)=>(t[a.value]=a.emoji,t),{}),RU=Tk.map(t=>t.value),ju=t=>{if(!t)return"";const a=OU[t];return a?`${a} ${t}`:t},IU=[{value:"units",label:"Unidades"},{value:"grams",label:"Gramos"},{value:"milliliters",label:"Mililitros"}],zU=({open:t,onOpenChange:a,onSave:s,onDelete:r,item:l})=>{const[o,d]=p.useState(""),[u,m]=p.useState(1),[h,g]=p.useState(0),[x,y]=p.useState(""),[v,b]=p.useState(""),[N,S]=p.useState(""),[w,E]=p.useState(""),[T,D]=p.useState("to-buy"),[k,_]=p.useState(!1),[R,L]=p.useState("units"),[U,V]=p.useState(""),[F,G]=p.useState(null);p.useEffect(()=>{l?(d(l.name),m(l.stock),g(l.toBuy),y(l.price?String(l.price):""),b(l.category||""),S(l.place||""),E(l.consumeBy||""),D(l.status),_(!!l.nextPurchase),L(l.unit||"units"),V(l.barcode||"")):(d(""),m(1),g(0),y(""),b(""),S(""),E(""),D("to-buy"),_(!1),L("units"),V("")),G(null)},[l,t]);const $=()=>{if(!o.trim()){G("El nombre es obligatorio.");return}if(Number.isNaN(Number(u))||Number(u)<0){G("El stock debe ser un numero valido mayor o igual a 0.");return}if(Number.isNaN(Number(h))||Number(h)<0){G("La cantidad a comprar debe ser un numero valido mayor o igual a 0.");return}if(x&&(Number.isNaN(Number(x))||Number(x)<0)){G("El precio debe ser un numero valido mayor o igual a 0.");return}const z={stock:Number(u),toBuy:Number(h),status:T,nextPurchase:k,unit:R};x&&x.trim()!==""?z.price=Number(x):l&&(z.price=null),v&&v.trim()!==""&&(z.category=v),N&&N.trim()!==""&&(z.place=N),w&&w.trim()!==""?z.consumeBy=w:l&&(z.consumeBy=""),U&&U.trim()!==""?z.barcode=U:l&&(z.barcode=""),l?s({...z,name:o},l.id):o.split(`
`).map(I=>I.trim()).filter(Boolean).forEach(I=>s({...z,name:I})),a(!1)};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-3xl max-h-[85vh] overflow-y-auto",children:[e.jsx(Ot,{children:e.jsxs(Rt,{children:[l?"Editar":"Agregar"," Item"]})}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(Ce,{htmlFor:"names",children:["Nombre",l?"":"s"]}),l?e.jsx(ye,{id:"names",value:o,onChange:z=>d(z.target.value)}):e.jsx(sa,{id:"names",value:o,onChange:z=>d(z.target.value),placeholder:"Un producto por linea",className:"min-h-[140px]"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"category",children:"Categoria"}),e.jsxs(yt,{value:v,onValueChange:b,children:[e.jsx(ft,{id:"category",children:e.jsx(vt,{placeholder:"Seleccionar categoria"})}),e.jsx(pt,{children:RU.map(z=>e.jsx(Le,{value:z,children:ju(z)},z))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"place",children:"Lugar de compra"}),e.jsxs(yt,{value:N,onValueChange:S,children:[e.jsx(ft,{id:"place",children:e.jsx(vt,{placeholder:"Seleccionar lugar"})}),e.jsx(pt,{children:Vh.map(z=>e.jsx(Le,{value:z,children:z},z))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"barcode",children:"Cdigo de barras"}),e.jsx(ye,{id:"barcode",value:U,onChange:z=>V(z.target.value),placeholder:"EAN, UPC, SKU, etc."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"status",children:"Estado"}),e.jsxs(yt,{value:T,onValueChange:z=>D(z),children:[e.jsx(ft,{id:"status",children:e.jsx(vt,{})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"in-stock",children:"En Stock"}),e.jsx(Le,{value:"to-buy",children:"Por Comprar"}),e.jsx(Le,{value:"low-stock",children:"Poco Stock"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"consumeBy",children:"Consumir antes de"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{id:"consumeBy",type:"date",value:w,onChange:z=>E(z.target.value)}),e.jsx(P,{type:"button",variant:"ghost",className:"h-9 px-2 text-xs",onClick:()=>E(""),children:"Limpiar"})]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Va,{checked:k,onCheckedChange:z=>_(!!z)}),"Marcar como proxima compra"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"stock",children:"Stock"}),e.jsx(ye,{id:"stock",type:"number",value:u,onChange:z=>m(Number(z.target.value))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"toBuy",children:"A Comprar"}),e.jsx(ye,{id:"toBuy",type:"number",value:h,onChange:z=>g(Number(z.target.value))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"unit",children:"Unidad"}),e.jsxs(yt,{value:R,onValueChange:z=>L(z),children:[e.jsx(ft,{id:"unit",children:e.jsx(vt,{})}),e.jsx(pt,{children:IU.map(z=>e.jsx(Le,{value:z.value,children:z.label},z.value))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"price",children:"Precio"}),e.jsx(ye,{id:"price",type:"number",value:x,onChange:z=>y(z.target.value)})]})]}),F&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md px-3 py-2",children:F})]}),e.jsxs(Cs,{className:"flex justify-between",children:[l&&r?e.jsx(P,{variant:"destructive",onClick:()=>{r(l.id),a(!1)},children:"Eliminar"}):e.jsx("span",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>a(!1),children:"Cancelar"}),e.jsx(P,{onClick:$,children:"Guardar"})]})]})]})})},LU=yM,PU=vM,BU=bM,Dk=({query:t,onQueryChange:a,sort:s,onSortChange:r,placeFilter:l,onPlaceFilterChange:o,statusFilter:d,onStatusFilterChange:u,categoryFilter:m,onCategoryFilterChange:h,onlyToBuy:g,onOnlyToBuyChange:x,nextOnly:y,onNextOnlyChange:v,expireSoonOnly:b,onExpireSoonOnlyChange:N,noPriceOnly:S=!1,onNoPriceOnlyChange:w,places:E,categories:T,filtersOpen:D,setFiltersOpen:k,isMobile:_})=>e.jsxs(LU,{open:!_||D,onOpenChange:k,children:[e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx(ye,{placeholder:"Buscar por nombre o cdigo de barras",value:t,onChange:R=>a(R.target.value),className:"flex-1 sm:w-60"}),_&&e.jsx(PU,{asChild:!0,children:e.jsx(P,{variant:"outline",size:"icon",children:e.jsx(Eu,{className:"w-4 h-4"})})})]}),e.jsx(BU,{className:"mt-2",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(yt,{value:s,onValueChange:R=>r(R),children:[e.jsx(ft,{className:"w-36",children:e.jsx(vt,{placeholder:"Ordenar"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"az",children:"Nombre A-Z"}),e.jsx(Le,{value:"za",children:"Nombre Z-A"}),e.jsx(Le,{value:"category",children:"Categora"})]})]}),e.jsxs(yt,{value:l||"all",onValueChange:R=>o(R==="all"?"":R),children:[e.jsx(ft,{className:"w-36",children:e.jsx(vt,{placeholder:"Lugar"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"all",children:"Todos los lugares"}),E.map(R=>e.jsx(Le,{value:R,children:R},R))]})]}),e.jsxs(yt,{value:d||"all",onValueChange:R=>u(R==="all"?"":R),children:[e.jsx(ft,{className:"w-36",children:e.jsx(vt,{placeholder:"Estado"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"all",children:"Todos"}),e.jsx(Le,{value:"to-buy",children:"Por Comprar"}),e.jsx(Le,{value:"in-stock",children:"En Stock"}),e.jsx(Le,{value:"low-stock",children:"Poco Stock"})]})]}),e.jsxs(yt,{value:m||"all",onValueChange:R=>h(R==="all"?"":R),children:[e.jsx(ft,{className:"w-44",children:e.jsx(vt,{placeholder:"Categora"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"all",children:"Todas"}),w&&e.jsx(Le,{value:"__empty",children:"Sin categora"}),T.map(R=>e.jsx(Le,{value:R,children:ju(R)},R))]})]}),w&&e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Va,{checked:S,onCheckedChange:R=>w(!!R)}),"Sin precio"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Va,{checked:g,onCheckedChange:R=>x(!!R)}),e.jsx(lr,{className:"w-4 h-4"}),"Lista activa"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Va,{checked:y,onCheckedChange:R=>v(!!R)}),"Prxima compra"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Va,{checked:b,onCheckedChange:R=>N(!!R)}),"Prximos a vencer"]})]})})]}),XS=[{key:"to-buy",title:"Por Comprar"},{key:"low-stock",title:"Poco Stock"},{key:"in-stock",title:"En Stock"}],QS={"to-buy":lr,"low-stock":oy,"in-stock":cr},$U=[{value:"units",label:"u"},{value:"grams",label:"g"},{value:"milliliters",label:"ml"}],HU={units:"u",grams:"g",milliliters:"ml"},ZS=(t,a)=>{const s=Number(t);return Number.isNaN(s)?a:Math.max(0,s)},UU=({items:t,onMove:a,onView:s,onToggleNext:r,onUpdate:l})=>{const[o,d]=p.useState(""),[u,m]=p.useState("az"),[h,g]=p.useState(""),[x,y]=p.useState(""),[v,b]=p.useState(""),[N,S]=p.useState(!1),[w,E]=p.useState(!1),[T,D]=p.useState(!1),[k,_]=p.useState(!1),[R,L]=p.useState({}),{isMobile:U}=ku(),V=I=>{L(O=>({...O,[I]:!O[I]}))},F=p.useMemo(()=>Array.from(new Set(t.map(I=>I.place).filter(Boolean))),[t]),G=p.useMemo(()=>Array.from(new Set(t.map(I=>I.category).filter(Boolean))),[t]),$=p.useMemo(()=>{let I=t.filter(Y=>Y.name.toLowerCase().includes(o.toLowerCase())||Y.barcode&&Y.barcode.toLowerCase().includes(o.toLowerCase()));if(h&&(I=I.filter(Y=>Y.place===h)),x&&(I=I.filter(Y=>Y.status===x)),v&&(I=I.filter(Y=>Y.category===v)),N&&(I=I.filter(Y=>Y.status==="to-buy")),T&&(I=I.filter(Y=>Y.nextPurchase)),w){const Y=ps(new Date,3);I=I.filter(le=>{if(!le.consumeBy)return!1;const re=new Date(le.consumeBy);return Ua(re,Y)})}let O=[...I];switch(u){case"az":O.sort((Y,le)=>Y.name.localeCompare(le.name));break;case"za":O.sort((Y,le)=>le.name.localeCompare(Y.name));break;case"category":O.sort((Y,le)=>(Y.category||"").localeCompare(le.category||""));break}return O},[t,o,h,x,v,N,T,w,u]),z=p.useMemo(()=>{const I={"to-buy":0,"low-stock":0,"in-stock":0};return $.forEach(O=>{O.price!=null&&(I[O.status]+=O.price*O.toBuy)}),I},[$]),H=p.useMemo(()=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}),[]);return e.jsx(Vs,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:e.jsx(Dk,{query:o,onQueryChange:d,sort:u,onSortChange:m,placeFilter:h,onPlaceFilterChange:g,statusFilter:x,onStatusFilterChange:y,categoryFilter:v,onCategoryFilterChange:b,onlyToBuy:N,onOnlyToBuyChange:S,nextOnly:T,onNextOnlyChange:D,expireSoonOnly:w,onExpireSoonOnlyChange:E,places:F,categories:G,filtersOpen:k,setFiltersOpen:_,isMobile:U})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:XS.map(I=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-sm text-gray-700 flex items-center gap-2",children:[te.createElement(QS[I.key],{className:"w-4 h-4"}),I.title]}),e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full",children:$.filter(O=>O.status===I.key).length})]}),e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:H.format(z[I.key])}),e.jsxs("div",{className:"space-y-1 h-full max-h-[calc(100vh-260px)] overflow-y-auto",children:[$.filter(O=>O.status===I.key).map(O=>{const Y=ps(new Date,3),le=O.consumeBy?new Date(O.consumeBy):null,re=le?Ua(le,new Date):!1,Q=le?Ua(le,Y):!1,q=O.unit||"units";return e.jsx(fe,{className:`transition-all duration-200 border-l-4 ${I.key==="in-stock"?"border-l-green-500":I.key==="low-stock"?"border-l-yellow-500":"border-l-blue-500"} ${Q||re?"border-red-500 bg-red-50/30":""} ${re?"bg-red-50/50":""}`,children:e.jsxs(xe,{className:"p-1.5 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 cursor-pointer",onClick:()=>V(O.id),children:[e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm leading-tight truncate",children:O.name}),O.category&&e.jsx("span",{className:"bg-gray-100 text-gray-700 px-1 py-0.5 rounded text-[10px] whitespace-nowrap",children:ju(O.category)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-gray-500",children:[e.jsx("span",{className:"uppercase",children:I.title}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{children:["Stock ",O.stock," ",HU[q]]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{children:["Comprar ",O.toBuy]}),(re||Q)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("span",{className:re?"text-red-600 font-medium":"text-orange-600",children:re?"Vencido":"Por vencer"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{variant:"ghost",size:"sm",className:`h-7 w-7 p-0 ${O.nextPurchase?"text-yellow-600 hover:bg-yellow-50":"text-gray-500 hover:bg-gray-50"}`,onClick:M=>{M.stopPropagation(),r(O)},children:e.jsx(j1,{className:"w-4 h-4",...O.nextPurchase&&{fill:"currentColor"}})}),e.jsx(P,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 text-gray-500 hover:bg-gray-50",onClick:M=>{M.stopPropagation(),V(O.id)},children:R[O.id]?e.jsx(jf,{className:"w-4 h-4"}):e.jsx(rn,{className:"w-4 h-4"})})]})]}),R[O.id]&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Stock"}),e.jsx(ye,{type:"number",defaultValue:O.stock,className:"h-7 px-2 text-xs",onClick:M=>M.stopPropagation(),onKeyDown:M=>M.key==="Enter"&&M.currentTarget.blur(),onBlur:M=>l(O.id,{stock:ZS(M.target.value,O.stock)})},`stock-${O.id}-${O.stock}`)]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Comprar"}),e.jsx(ye,{type:"number",defaultValue:O.toBuy,className:"h-7 px-2 text-xs",onClick:M=>M.stopPropagation(),onKeyDown:M=>M.key==="Enter"&&M.currentTarget.blur(),onBlur:M=>l(O.id,{toBuy:ZS(M.target.value,O.toBuy)})},`toBuy-${O.id}-${O.toBuy}`)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Unidad"}),e.jsxs(yt,{value:q,onValueChange:M=>l(O.id,{unit:M}),children:[e.jsx(ft,{className:"h-7 text-xs px-2",onClick:M=>M.stopPropagation(),children:e.jsx(vt,{})}),e.jsx(pt,{children:$U.map(M=>e.jsx(Le,{value:M.value,children:M.label},M.value))})]})]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Precio"}),e.jsx(ye,{type:"number",defaultValue:O.price??"",className:"h-7 px-2 text-xs",onClick:M=>M.stopPropagation(),onKeyDown:M=>M.key==="Enter"&&M.currentTarget.blur(),onBlur:M=>l(O.id,{price:M.target.value===""?null:Number(M.target.value)})},`price-${O.id}-${O.price??"none"}`)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Tienda"}),e.jsx(ye,{type:"text",defaultValue:O.place??"",placeholder:"Tienda",className:"h-7 px-2 text-xs",onClick:M=>M.stopPropagation(),onKeyDown:M=>M.key==="Enter"&&M.currentTarget.blur(),onBlur:M=>l(O.id,{place:M.target.value})},`place-${O.id}-${O.place??"none"}`)]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`text-gray-500 ${re?"text-red-600 font-medium":""}`,children:"Vence"}),e.jsx(ye,{type:"date",defaultValue:O.consumeBy??"",className:`h-7 px-2 text-xs ${re?"border-red-400 bg-red-50":Q?"border-orange-300 bg-orange-50/50":""}`,onClick:M=>M.stopPropagation(),onKeyDown:M=>M.key==="Enter"&&M.currentTarget.blur(),onBlur:M=>l(O.id,{consumeBy:M.target.value})},`consume-${O.id}-${O.consumeBy??"none"}`)]})]}),O.consumeBy&&(re||Q)&&e.jsx("div",{className:`text-[11px] ${re?"text-red-600 font-medium":"text-orange-600"}`,children:re?"Vencido":"Por vencer"}),e.jsxs("div",{className:"flex justify-between gap-1 pt-1",children:[e.jsx("div",{className:"flex gap-1",children:XS.filter(M=>M.key!==I.key).map(M=>{const W=QS[M.key],ie=M.key==="in-stock"?"text-green-600 hover:bg-green-50":M.key==="low-stock"?"text-yellow-600 hover:bg-yellow-50":"text-blue-600 hover:bg-blue-50";return e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",className:`h-7 w-7 p-0 ${ie}`,onClick:ve=>{ve.stopPropagation(),a(O.id,M.key)},children:e.jsx(W,{className:"w-4 h-4"})})}),e.jsxs(fa,{children:["Mover a ",M.title]})]},M.key)})}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 text-gray-600 hover:bg-gray-50",onClick:M=>{M.stopPropagation(),s(O)},children:e.jsx(Cu,{className:"w-4 h-4"})})}),e.jsx(fa,{children:"Ver detalles"})]})]})]})]})},O.id)}),$.filter(O=>O.status===I.key).length===0&&e.jsx("div",{className:"text-center py-6 text-gray-400 border border-dashed border-gray-200 rounded-lg",children:e.jsx("div",{className:"text-xs",children:"Sin elementos"})})]})]},I.key))})]})})},JS=[{value:"units",label:"u"},{value:"grams",label:"g"},{value:"milliliters",label:"ml"}],Nh=(t,a)=>{const s=Number(t);return Number.isNaN(s)?a:Math.max(0,s)},VU=({items:t,onEdit:a,onDelete:s,onUpdate:r})=>{const[l,o]=p.useState(""),[d,u]=p.useState("az"),[m,h]=p.useState(""),[g,x]=p.useState(""),[y,v]=p.useState(""),[b,N]=p.useState(!1),[S,w]=p.useState(!1),[E,T]=p.useState(!1),[D,k]=p.useState(!1),[_,R]=p.useState(!1),{isMobile:L}=ku(),U=p.useMemo(()=>Array.from(new Set(t.map(H=>H.place).filter(Boolean))),[t]),V=p.useMemo(()=>Array.from(new Set(t.map(H=>H.category).filter(Boolean))),[t]),F=p.useMemo(()=>{let H=t.filter(O=>O.name.toLowerCase().includes(l.toLowerCase())||O.barcode&&O.barcode.toLowerCase().includes(l.toLowerCase()));if(m&&(H=H.filter(O=>O.place===m)),g&&(H=H.filter(O=>O.status===g)),y&&(y==="__empty"?H=H.filter(O=>!O.category):H=H.filter(O=>O.category===y)),E&&(H=H.filter(O=>O.price==null)),b&&(H=H.filter(O=>O.status==="to-buy")),S&&(H=H.filter(O=>O.nextPurchase)),D){const O=ps(new Date,3);H=H.filter(Y=>{if(!Y.consumeBy)return!1;const le=new Date(Y.consumeBy);return Ua(le,O)})}let I=[...H];switch(d){case"az":I.sort((O,Y)=>O.name.localeCompare(Y.name));break;case"za":I.sort((O,Y)=>Y.name.localeCompare(O.name));break;case"category":I.sort((O,Y)=>(O.category||"").localeCompare(Y.category||""));break}return I},[t,l,m,g,y,E,b,S,D,d]),G=p.useMemo(()=>F.reduce((H,I)=>I.status==="to-buy"&&I.price!=null?H+I.price*I.toBuy:H,0),[F]),$=H=>{switch(H){case"in-stock":return"default";case"low-stock":return"secondary";case"to-buy":return"destructive";default:return"outline"}},z=H=>{switch(H){case"in-stock":return"En Stock";case"low-stock":return"Poco Stock";case"to-buy":return"Por Comprar";default:return H}};return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Dk,{query:l,onQueryChange:o,sort:d,onSortChange:u,placeFilter:m,onPlaceFilterChange:h,statusFilter:g,onStatusFilterChange:x,categoryFilter:y,onCategoryFilterChange:v,onlyToBuy:b,onOnlyToBuyChange:N,nextOnly:S,onNextOnlyChange:w,expireSoonOnly:D,onExpireSoonOnlyChange:k,noPriceOnly:E,onNoPriceOnlyChange:T,places:U,categories:V,filtersOpen:_,setFiltersOpen:R,isMobile:L}),e.jsxs("div",{className:"text-right font-medium",children:["Total pendiente: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(G)]}),F.length===0?e.jsx(fe,{className:"p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(gl,{className:"h-12 w-12 text-gray-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-600",children:"No hay productos"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No se encontraron productos con los filtros aplicados"})]})]})}):e.jsx(fe,{children:e.jsxs(xe,{className:"p-0",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-3 p-3 bg-gray-50 border-b text-xs font-medium text-gray-700",children:[e.jsx("div",{className:"col-span-3",children:"Producto"}),e.jsx("div",{className:"col-span-1 text-center",children:"Estado"}),e.jsx("div",{className:"col-span-2 text-center",children:"Stock"}),e.jsx("div",{className:"col-span-1 text-center",children:"Comprar"}),e.jsx("div",{className:"col-span-1 text-center",children:"Precio"}),e.jsx("div",{className:"col-span-1 text-center",children:"Tienda"}),e.jsx("div",{className:"col-span-1 text-center",children:"Vence"}),e.jsx("div",{className:"col-span-1 text-center",children:"Prox"}),e.jsx("div",{className:"col-span-1 text-center",children:"Acc"})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:F.map((H,I)=>{const O=ps(new Date,3),Y=H.consumeBy?new Date(H.consumeBy):null,le=Y?Ua(Y,new Date):!1,re=Y?Ua(Y,O):!1,Q=H.unit||"units";return e.jsxs("div",{className:`hover:bg-gray-50 transition-colors ${I%2===0?"bg-white":"bg-gray-50/50"}`,children:[e.jsxs("div",{className:"md:hidden p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:H.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(wt,{variant:$(H.status),className:"text-xs",children:z(H.status)}),H.category&&e.jsx(wt,{variant:"outline",className:"text-xs",children:ju(H.category)})]})]}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.price!=null&&e.jsx("span",{className:"text-green-600",children:new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(H.price)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Stock"}),e.jsx(ye,{type:"number",defaultValue:H.stock,className:"h-7 px-2 text-xs",onBlur:q=>r(H.id,{stock:Nh(q.target.value,H.stock)})},`m-stock-${H.id}-${H.stock}`)]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Comprar"}),e.jsx(ye,{type:"number",defaultValue:H.toBuy,className:"h-7 px-2 text-xs",onBlur:q=>r(H.id,{toBuy:Nh(q.target.value,H.toBuy)})},`m-toBuy-${H.id}-${H.toBuy}`)]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Unidad"}),e.jsxs(yt,{value:Q,onValueChange:q=>r(H.id,{unit:q}),children:[e.jsx(ft,{className:"h-7 text-xs px-2",children:e.jsx(vt,{})}),e.jsx(pt,{children:JS.map(q=>e.jsx(Le,{value:q.value,children:q.label},q.value))})]})]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Precio"}),e.jsx(ye,{type:"number",defaultValue:H.price??"",className:"h-7 px-2 text-xs",onBlur:q=>r(H.id,{price:q.target.value===""?null:Number(q.target.value)})},`m-price-${H.id}-${H.price??"none"}`)]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-gray-500",children:"Tienda"}),e.jsxs(yt,{value:H.place||"__none",onValueChange:q=>r(H.id,{place:q==="__none"?"":q}),children:[e.jsx(ft,{className:"h-7 text-xs px-2",children:e.jsx(vt,{placeholder:"Sin tienda"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"__none",children:"Sin tienda"}),Vh.map(q=>e.jsx(Le,{value:q,children:q},q))]})]})]}),e.jsxs("label",{className:"flex items-center gap-1",children:[e.jsx("span",{className:`text-gray-500 ${le?"text-red-600 font-medium":""}`,children:"Vence"}),e.jsx(ye,{type:"date",defaultValue:H.consumeBy??"",className:`h-7 px-2 text-xs ${le?"border-red-400 bg-red-50":re?"border-orange-300 bg-orange-50/50":""}`,onBlur:q=>r(H.id,{consumeBy:q.target.value})},`m-consume-${H.id}-${H.consumeBy??"none"}`)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx(Va,{checked:!!H.nextPurchase,onCheckedChange:q=>r(H.id,{nextPurchase:!!q})}),"Proxima compra"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>a(H),className:"h-7 w-7 p-0 text-blue-600",children:e.jsx(Vn,{className:"h-3 w-3"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>s(H.id),className:"h-7 w-7 p-0 text-red-600",children:e.jsx(Sn,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-3 p-3 text-xs items-center",children:[e.jsx("div",{className:"col-span-3",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:H.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[H.place&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(f1,{className:"h-3 w-3"}),H.place]}),H.consumeBy&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Aa,{className:"h-3 w-3"}),H.consumeBy]})]}),H.category&&e.jsx(wt,{variant:"outline",className:"text-[10px]",children:ju(H.category)})]})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsxs(yt,{value:H.status,onValueChange:q=>r(H.id,{status:q}),children:[e.jsx(ft,{className:"h-7 text-xs px-2",children:e.jsx(vt,{})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"in-stock",children:"En Stock"}),e.jsx(Le,{value:"to-buy",children:"Por Comprar"}),e.jsx(Le,{value:"low-stock",children:"Poco Stock"})]})]})}),e.jsx("div",{className:"col-span-2 flex justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{type:"number",defaultValue:H.stock,className:"h-7 w-16 px-2 text-xs text-center",onBlur:q=>r(H.id,{stock:Nh(q.target.value,H.stock)})},`d-stock-${H.id}-${H.stock}`),e.jsxs(yt,{value:Q,onValueChange:q=>r(H.id,{unit:q}),children:[e.jsx(ft,{className:"h-7 w-16 text-xs px-2",children:e.jsx(vt,{})}),e.jsx(pt,{children:JS.map(q=>e.jsx(Le,{value:q.value,children:q.label},q.value))})]})]})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx(ye,{type:"number",defaultValue:H.toBuy,className:"h-7 w-16 px-2 text-xs text-center",onBlur:q=>r(H.id,{toBuy:Nh(q.target.value,H.toBuy)})},`d-toBuy-${H.id}-${H.toBuy}`)}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx(ye,{type:"number",defaultValue:H.price??"",className:"h-7 w-20 px-2 text-xs text-center",onBlur:q=>r(H.id,{price:q.target.value===""?null:Number(q.target.value)})},`d-price-${H.id}-${H.price??"none"}`)}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsxs(yt,{value:H.place||"__none",onValueChange:q=>r(H.id,{place:q==="__none"?"":q}),children:[e.jsx(ft,{className:"h-7 w-24 text-xs px-2",children:e.jsx(vt,{placeholder:"Sin tienda"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"__none",children:"Sin tienda"}),Vh.map(q=>e.jsx(Le,{value:q,children:q},q))]})]})}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx(ye,{type:"date",defaultValue:H.consumeBy??"",className:`h-7 w-28 px-2 text-xs ${le?"border-red-400 bg-red-50":re?"border-orange-300 bg-orange-50/50":""}`,onBlur:q=>r(H.id,{consumeBy:q.target.value})},`d-consume-${H.id}-${H.consumeBy??"none"}`)}),e.jsx("div",{className:"col-span-1 flex justify-center",children:e.jsx(Va,{checked:!!H.nextPurchase,onCheckedChange:q=>r(H.id,{nextPurchase:!!q})})}),e.jsxs("div",{className:"col-span-1 flex justify-center gap-1",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>a(H),className:"h-7 w-7 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50",title:"Editar producto",children:e.jsx(Vn,{className:"h-3 w-3"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>s(H.id),className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Eliminar producto",children:e.jsx(Sn,{className:"h-3 w-3"})})]})]})]},H.id)})})]})})]})},YU=()=>{const{items:t,addItem:a,updateItem:s,deleteItem:r,moveItem:l}=bl(),[o,d]=p.useState(!1),u=gs(),m=it(),[h,g]=p.useState(null),x=p.useMemo(()=>u.pathname.includes(ae.shoppingList.view("kanban"))?"kanban":"list",[u.pathname]),[y,v]=p.useState(!1),b=(N,S)=>{S?s(S,N):a(N)};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs(Jf,{title:"Lista de Compras",views:[{key:"list",label:"Lista"},{key:"kanban",label:"Kanban"}],activeViewKey:x,onViewChange:N=>m(ae.shoppingList.view(N)),children:[e.jsx(Vs,{children:e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(Ek,{type:"single",value:x,onValueChange:N=>N&&m(ae.shoppingList.view(N)),children:[e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsx(Y0,{value:"kanban","aria-label":"Kanban",children:e.jsx(t1,{className:"w-4 h-4"})})}),e.jsx(fa,{children:e.jsx("p",{children:"Vista Kanban"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsx(Y0,{value:"list","aria-label":"Lista",children:e.jsx(UM,{className:"w-4 h-4"})})}),e.jsx(fa,{children:e.jsx("p",{children:"Vista Lista"})})]})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>d(!0),children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Agregar"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Agregar"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>v(!0),children:[e.jsx(Or,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Exportar"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Exportar"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>m(ae.shoppingList.run),children:[e.jsx(Bs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Ir de compras"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Ir de compras"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>m(ae.shoppingList.config),children:[e.jsx(_s,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Configuracion"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Configuracion"})})]})]})}),e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(Su,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(Nn,{align:"end",children:[e.jsxs(Lt,{onClick:()=>d(!0),children:[e.jsx(It,{className:"mr-2 h-4 w-4"}),"Agregar"]}),e.jsxs(Lt,{onClick:()=>v(!0),children:[e.jsx(Or,{className:"mr-2 h-4 w-4"}),"Exportar ingredientes"]}),e.jsxs(Lt,{onClick:()=>m(ae.shoppingList.run),children:[e.jsx(Bs,{className:"mr-2 h-4 w-4"}),"Ir de compras"]}),e.jsxs(Lt,{onClick:()=>m(ae.shoppingList.config),children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),"Configuracion"]}),e.jsx(Ou,{}),u.pathname!==ae.meal.view("weekly")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.meal.view("weekly"),className:"flex items-center",children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"}),"Plan de Comidas"]})}),!u.pathname.startsWith(ae.shoppingList.base)&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.shoppingList.view("list"),className:"flex items-center",children:[e.jsx(lr,{className:"mr-2 h-4 w-4"}),"Lista de Compras"]})}),u.pathname!==ae.recipes.view("list")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.recipes.view("list"),className:"flex items-center",children:[e.jsx(xl,{className:"mr-2 h-4 w-4"}),"Recetas"]})}),u.pathname!==ae.preparedMeals.view("list")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.preparedMeals.view("list"),className:"flex items-center",children:[e.jsx(gl,{className:"mr-2 h-4 w-4"}),"Comidas Preparadas"]})})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-lg",children:"No hay elementos en tu lista"}),e.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar" para comenzar'})]}):x==="kanban"?e.jsx(UU,{items:t,onMove:l,onView:g,onToggleNext:N=>s(N.id,{nextPurchase:!N.nextPurchase}),onUpdate:s}):e.jsx(VU,{items:t,onEdit:g,onDelete:r,onUpdate:s})}),e.jsx(zU,{open:o||!!h,onOpenChange:()=>{d(!1),g(null)},onSave:b,onDelete:N=>r(N),item:h||void 0}),e.jsx(MU,{open:y,onOpenChange:v})]})},kk=[{key:"list",label:"Lista"},{key:"kanban",label:"Kanban"}],eC="list",qU=()=>{const{viewKey:t}=Ss(),a=t||eC;return kk.some(r=>r.key===a)?e.jsx(wi,{noPadding:!0,className:"h-full",children:e.jsx(YU,{})}):e.jsx(Ft,{to:`/shopping-list/view/${eC}`,replace:!0})},FU=()=>{const t=it();return e.jsx(na,{title:"Configuracion de Lista de Compras",icon:e.jsx(lr,{className:"h-4 w-4 text-white"}),views:kk.map(a=>({...a,component:()=>null})),onViewChange:a=>t(`/shopping-list/view/${a}`),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"No hay configuraciones especificas para Lista de Compras en este modulo."})})})})},GU={module:"shopping-list",defaultRoute:ae.shoppingList.view(ae.shoppingList.defaultView),moduleRoutes:[{path:"shopping-list",element:e.jsx(Ft,{to:ae.shoppingList.view(ae.shoppingList.defaultView),replace:!0})},{path:"shopping-list/view/:viewKey",element:e.jsx(qU,{})},{path:"shopping-list/config",element:e.jsx(FU,{})}],legacyRedirects:[{path:"shopping-list/list",element:e.jsx(Ft,{to:ae.shoppingList.view("list"),replace:!0})},{path:"shopping-list/kanban",element:e.jsx(Ft,{to:ae.shoppingList.view("kanban"),replace:!0})}]},WU=({ingredients:t,onChange:a,availableItems:s})=>{const[r,l]=p.useState(""),[o,d]=p.useState(null),[u,m]=p.useState(!1),[h,g]=p.useState("1"),[x,y]=p.useState(""),[v,b]=p.useState(""),N=s.filter(T=>T.name.toLowerCase().includes(r.toLowerCase())&&!t.some(D=>D.shoppingItemId===T.id)),S=()=>{if(!o||!h||Number(h)<=0)return;const T=s.find(k=>k.id===o.id);if(!T)return;const D={shoppingItemId:o.id,shoppingItemName:T.name,quantity:Number(h),unit:x.trim()||void 0,notes:v.trim()||void 0};a([...t,D]),d(null),g("1"),y(""),b(""),l(""),m(!1)},w=T=>{a(t.filter(D=>D.shoppingItemId!==T))},E=(T,D,k)=>{a(t.map(_=>_.shoppingItemId===T?{..._,[D]:k}:_))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg border",children:[e.jsx(Ce,{className:"text-base font-medium",children:"Agregar Ingrediente"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ye,{placeholder:"Buscar producto en tu lista de compras...",value:r,onChange:T=>{const D=T.target.value;l(D),m(D.length>0),(!o||o.name!==D)&&d(null)},onFocus:()=>{r.length>0&&m(!0)},className:"text-base h-11"}),u&&r&&N.length>0&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border rounded-md shadow-lg max-h-64 overflow-y-auto",children:N.slice(0,15).map(T=>e.jsxs("button",{type:"button",className:"w-full px-4 py-3 text-left hover:bg-gray-100 border-b last:border-b-0",onMouseDown:D=>{D.preventDefault(),d({id:T.id,name:T.name}),l(T.name),m(!1)},children:[e.jsx("div",{className:"font-medium text-base",children:T.name}),T.category&&e.jsx("div",{className:"text-sm text-gray-500 mt-0.5",children:T.category})]},T.id))})]}),o&&e.jsxs("p",{className:"text-xs text-blue-700",children:["Seleccionado: ",o.name]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-600",children:"Cantidad"}),e.jsx(ye,{type:"number",placeholder:"1",value:h,onChange:T=>g(T.target.value),min:"0",step:"0.1",className:"h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-600",children:"Unidad"}),e.jsx(ye,{placeholder:"tazas, gramos...",value:x,onChange:T=>y(T.target.value),className:"h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-600",children:"Notas"}),e.jsx(ye,{placeholder:"picado, rallado...",value:v,onChange:T=>b(T.target.value),className:"h-10"})]})]}),e.jsxs(P,{type:"button",onClick:S,disabled:!o||!h||Number(h)<=0,className:"w-full h-10 text-base",children:[e.jsx(It,{className:"w-5 h-5 mr-2"}),"Agregar Ingrediente"]})]})]}),t.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{className:"text-base font-medium",children:["Ingredientes Seleccionados (",t.length,")"]}),e.jsx("div",{className:"border rounded-lg divide-y max-h-96 overflow-y-auto bg-white",children:t.map(T=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-base",children:T.shoppingItemName}),e.jsxs("p",{className:"text-sm text-gray-600 mt-0.5",children:[T.quantity," ",T.unit||"unidades",T.notes&&e.jsxs("span",{className:"text-gray-500",children:["  ",T.notes]})]})]}),e.jsx(P,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>w(T.shoppingItemId),children:e.jsx(Sn,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-500",children:"Cantidad"}),e.jsx(ye,{type:"number",value:T.quantity,onChange:D=>E(T.shoppingItemId,"quantity",Number(D.target.value)),min:"0",step:"0.1",className:"h-9"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-500",children:"Unidad"}),e.jsx(ye,{value:T.unit||"",onChange:D=>E(T.shoppingItemId,"unit",D.target.value),placeholder:"tazas, gramos...",className:"h-9"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-500",children:"Notas"}),e.jsx(ye,{value:T.notes||"",onChange:D=>E(T.shoppingItemId,"notes",D.target.value),placeholder:"opcional",className:"h-9"})]})]})]},T.shoppingItemId))})]})]})},Ak=t=>{const{user:a}=st(),[s,r]=p.useState([]),[l,o]=p.useState("idle"),[d,u]=p.useState(null),m=p.useCallback(async()=>{if(!t||!a){r([]);return}o("loading"),u(null);try{const{data:v,error:b}=await Dr.table("recipe_ingredients").select(`
          *,
          shopping_item:shopping_items(*)
        `).eq("recipe_id",t);if(b)throw b;const N=(v||[]).map(S=>({recipeId:S.recipe_id,shoppingItemId:S.shopping_item_id,quantity:Number(S.quantity),unit:S.unit||void 0,notes:S.notes||void 0,shoppingItem:{id:S.shopping_item.id,name:S.shopping_item.name,stock:S.shopping_item.stock,toBuy:S.shopping_item.to_buy,status:S.shopping_item.status,price:S.shopping_item.price,category:S.shopping_item.category,place:S.shopping_item.place,consumeBy:S.shopping_item.consume_by,nextPurchase:S.shopping_item.next_purchase,unit:S.shopping_item.unit,barcode:S.shopping_item.barcode}}));r(N),o("idle")}catch(v){u(v instanceof Error?v.message:"Error al cargar ingredientes"),o("error"),r([])}},[t,a]);return p.useEffect(()=>{m()},[m]),{ingredients:s,status:l,error:d,addIngredient:async v=>{if(!t||!a){u("Receta no especificada");return}o("saving"),u(null);try{const b={recipe_id:t,shopping_item_id:v.shoppingItemId,quantity:v.quantity,...v.unit&&{unit:v.unit},...v.notes&&{notes:v.notes}},{error:N}=await Dr.table("recipe_ingredients").insert(b);if(N)throw N;await m(),o("idle")}catch(b){const N=b instanceof Error?b.message:"Error al guardar ingrediente";u(N),o("error")}},updateIngredient:async(v,b)=>{if(!t||!a){u("Receta no especificada");return}o("saving"),u(null);try{const N={};b.quantity!==void 0&&(N.quantity=b.quantity),b.unit!==void 0&&(N.unit=b.unit||null),b.notes!==void 0&&(N.notes=b.notes||null);const{error:S}=await Dr.table("recipe_ingredients").update(N).eq("recipe_id",t).eq("shopping_item_id",v);if(S)throw S;await m(),o("idle")}catch(N){const S=N instanceof Error?N.message:"Error al actualizar ingrediente";u(S),o("error")}},deleteIngredient:async v=>{if(!t||!a){u("Receta no especificada");return}o("saving"),u(null);try{const{error:b}=await Dr.table("recipe_ingredients").delete().eq("recipe_id",t).eq("shopping_item_id",v);if(b)throw b;await m(),o("idle")}catch(b){const N=b instanceof Error?b.message:"Error al eliminar ingrediente";u(N),o("error")}},replaceAllIngredients:async v=>{if(!t||!a){u("Receta no especificada");return}o("saving"),u(null);try{const{error:b}=await Dr.table("recipe_ingredients").delete().eq("recipe_id",t);if(b)throw b;if(v.length>0){const N=v.map(w=>({recipe_id:t,shopping_item_id:w.shoppingItemId,quantity:w.quantity,...w.unit&&{unit:w.unit},...w.notes&&{notes:w.notes}})),{error:S}=await Dr.table("recipe_ingredients").insert(N);if(S)throw S}await m(),o("idle")}catch(b){const N=b instanceof Error?b.message:"Error al actualizar ingredientes";u(N),o("error")}},loadIngredients:m}},_k=({open:t,onOpenChange:a,onSave:s,recipe:r})=>{const{items:l}=bl(),{ingredients:o,replaceAllIngredients:d}=Ak(r?.id),[u,m]=p.useState(""),[h,g]=p.useState(""),[x,y]=p.useState(""),[v,b]=p.useState("fcil"),[N,S]=p.useState(""),[w,E]=p.useState(""),[T,D]=p.useState(""),[k,_]=p.useState(""),[R,L]=p.useState(""),[U,V]=p.useState("breakfast"),[F,G]=p.useState([]);p.useEffect(()=>{r?(m(r.name),g(r.description||""),y(r.instructions),b(r.difficulty||"fcil"),S(r.prepTime!==void 0?String(r.prepTime):""),E(String(r.nutrition.calories)),D(String(r.nutrition.protein)),_(String(r.nutrition.carbs)),L(String(r.nutrition.fat)),V(r.mealType),G(o.map(z=>({shoppingItemId:z.shoppingItemId,shoppingItemName:z.shoppingItem.name,quantity:z.quantity,unit:z.unit,notes:z.notes})))):(m(""),g(""),y(""),b("fcil"),S(""),E(""),D(""),_(""),L(""),V("breakfast"),G([]))},[r,t,o]);const $=async()=>{const z={name:u,description:h.trim()||void 0,difficulty:v,prepTime:N?Number(N):void 0,instructions:x,nutrition:{calories:Number(w)||0,protein:Number(T)||0,carbs:Number(k)||0,fat:Number(R)||0},mealType:U};let H=null;if(r?H=await s(z,r.id):H=await s(z),H&&F.length>0){const I=F.map(O=>({shoppingItemId:O.shoppingItemId,quantity:O.quantity,unit:O.unit,notes:O.notes}));await d(I)}a(!1)};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ot,{children:e.jsxs(Rt,{children:[r?"Editar":"Agregar"," Receta"]})}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"name",className:"text-base font-semibold",children:"Nombre"}),e.jsx(ye,{id:"name",value:u,onChange:z=>m(z.target.value),className:"text-base"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"difficulty",className:"text-sm font-medium",children:"Dificultad"}),e.jsxs(yt,{value:v,onValueChange:z=>b(z),children:[e.jsx(ft,{id:"difficulty",children:e.jsx(vt,{})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"fcil",children:"Fcil"}),e.jsx(Le,{value:"media",children:"Media"}),e.jsx(Le,{value:"difcil",children:"Difcil"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"prepTime",className:"text-sm font-medium",children:"Tiempo (min)"}),e.jsx(ye,{id:"prepTime",type:"number",value:N,onChange:z=>S(z.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"description",className:"text-sm font-medium",children:"Descripcin (opcional)"}),e.jsx(sa,{id:"description",value:h,onChange:z=>g(z.target.value),className:"min-h-[80px]"})]}),e.jsxs("div",{className:"space-y-3 border-t pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Ce,{className:"text-base font-semibold",children:"Ingredientes"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[F.length," ingrediente",F.length!==1?"s":""]})]}),e.jsx(WU,{ingredients:F,onChange:G,availableItems:l})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"instructions",className:"text-base font-semibold",children:"Instrucciones"}),e.jsx(sa,{id:"instructions",value:x,onChange:z=>y(z.target.value),className:"min-h-[150px] text-base",placeholder:`1. Precalentar el horno a 180C
2. Mezclar ingredientes secos...
3. Agregar ingredientes hmedos...`})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 border-t pt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{className:"text-sm font-semibold",children:"Informacin Nutricional"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"calories",className:"text-xs",children:"Caloras"}),e.jsx(ye,{id:"calories",type:"number",value:w,onChange:z=>E(z.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"protein",className:"text-xs",children:"Protena (g)"}),e.jsx(ye,{id:"protein",type:"number",value:T,onChange:z=>D(z.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"carbs",className:"text-xs",children:"Carbohidratos (g)"}),e.jsx(ye,{id:"carbs",type:"number",value:k,onChange:z=>_(z.target.value),placeholder:"0"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"fat",className:"text-xs",children:"Grasa (g)"}),e.jsx(ye,{id:"fat",type:"number",value:R,onChange:z=>L(z.target.value),placeholder:"0"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"mealType",className:"text-sm font-semibold",children:"Tipo de Comida"}),e.jsxs(yt,{value:U,onValueChange:z=>V(z),children:[e.jsx(ft,{id:"mealType",className:"text-base",children:e.jsx(vt,{})}),e.jsx(pt,{children:Object.entries(fs).map(([z,H])=>e.jsx(Le,{value:z,children:H.title},z))})]})]})]})]}),e.jsx(Cs,{children:e.jsx(P,{onClick:$,children:"Guardar"})})]})})},KU=({open:t,onOpenChange:a})=>{const{recipes:s}=Uu(),r={title:"Exportar Recetas",modules:[{id:"recipes",label:"Recetas",description:"Recetas con campos y opciones personalizables",icon:e.jsx(ro,{className:"w-4 h-4"}),fields:[{id:"allRecipes",label:"Todas las recetas",description:"Incluir todas las recetas (por defecto solo favoritas)"},{id:"groupByMealType",label:"Agrupar por tipo de comida",description:"Organizar por desayuno, almuerzo, cena, etc."},{id:"groupByDifficulty",label:"Agrupar por dificultad",description:"Organizar por nivel de dificultad"},{id:"name",label:"Nombre",description:"Nombre de la receta"},{id:"description",label:"Descripcin",description:"Descripcin de la receta"},{id:"difficulty",label:"Dificultad",description:"Nivel de dificultad (fcil, media, difcil)"},{id:"prepTime",label:"Tiempo de preparacin",description:"Tiempo estimado en minutos"},{id:"ingredients",label:"Ingredientes",description:"Lista de ingredientes con cantidades"},{id:"instructions",label:"Pasos de preparacin",description:"Instrucciones detalladas"},{id:"nutrition",label:"Informacin nutricional",description:"Caloras, protenas, carbohidratos, grasas"},{id:"mealType",label:"Tipo de comida",description:"Categora de la comida"},{id:"favorite",label:"Estado favorito",description:"Si la receta est marcada como favorita"}],dataGenerator:(l,o)=>{const d=l.includes("allRecipes"),u=d?s:s.filter(h=>h.favorite===!0),m=h=>{const g={};return l.filter(y=>y!=="allRecipes"&&y!=="groupByMealType"&&y!=="groupByDifficulty").length===0?{name:h.name,description:h.description,difficulty:h.difficulty,prepTime:h.prepTime,ingredients:h.ingredients,instructions:h.instructions,nutrition:h.nutrition,mealType:h.mealType,favorite:h.favorite}:(l.includes("name")&&(g.name=h.name),l.includes("description")&&h.description&&(g.description=h.description),l.includes("difficulty")&&h.difficulty&&(g.difficulty=h.difficulty),l.includes("prepTime")&&h.prepTime&&(g.prepTime=h.prepTime),l.includes("ingredients")&&(g.ingredients=h.ingredients),l.includes("instructions")&&(g.instructions=h.instructions),l.includes("nutrition")&&(g.nutrition=h.nutrition),l.includes("mealType")&&(g.mealType=h.mealType),l.includes("favorite")&&(g.favorite=h.favorite),g)};return l.includes("groupByMealType")&&l.includes("groupByDifficulty")?{recetas:u.reduce((g,x)=>{const y=x.mealType,v=x.difficulty||"sin_especificar";return g[y]||(g[y]={}),g[y][v]||(g[y][v]=[]),g[y][v].push(m(x)),g},{})}:l.includes("groupByMealType")?{recetas:u.reduce((g,x)=>{const y=x.mealType;return g[y]||(g[y]=[]),g[y].push(m(x)),g},{})}:l.includes("groupByDifficulty")?{recetas:u.reduce((g,x)=>{const y=x.difficulty||"sin_especificar";return g[y]||(g[y]=[]),g[y].push(m(x)),g},{})}:{recetas:u.map(m),total:u.length,tipo:d?"todas":"favoritas",exportedAt:new Date().toISOString()}}}]};return e.jsx(lv,{open:t,onOpenChange:a,config:r})},tC=({recipes:t,iconOnly:a=!1,className:s})=>{const[r,l]=p.useState(!1),o=()=>{l(!0)};return e.jsxs(e.Fragment,{children:[a?e.jsxs(P,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 ${s}`,onClick:o,children:[e.jsx(Or,{className:"w-4 h-4"}),e.jsx("span",{className:"sr-only",children:"Exportar"})]}):e.jsxs(P,{variant:"outline",size:"sm",onClick:o,className:`flex items-center gap-2 ${s}`,children:[e.jsx(Or,{className:"w-4 h-4"}),"Exportar"]}),e.jsx(KU,{open:r,onOpenChange:l})]})},XU=()=>{const{recipes:t,addRecipe:a,updateRecipe:s}=Uu(),[r,l]=p.useState(!1),o=gs(),d=it(),[u,m]=p.useState(null),[h,g]=p.useState(""),[x,y]=p.useState(""),[v,b]=p.useState("az"),N=p.useMemo(()=>{let w=t.filter(T=>T.name.toLowerCase().includes(h.toLowerCase()));x&&(w=w.filter(T=>T.mealType===x));const E=[...w];return E.sort((T,D)=>v==="az"?T.name.localeCompare(D.name):D.name.localeCompare(T.name)),E},[t,h,x,v]),S=async(w,E)=>E?(await s(E,w),E):await a(w);return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs(Jf,{title:"Recetas",views:[{key:"list",label:"Lista"}],activeViewKey:"list",onViewChange:()=>d(ae.recipes.view("list")),children:[e.jsx(Vs,{children:e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>l(!0),children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Agregar"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Agregar"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsx(tC,{recipes:t,iconOnly:!0})}),e.jsx(fa,{children:e.jsx("p",{children:"Exportar"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>d(ae.recipes.config),children:[e.jsx(_s,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Configuracion"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Configuracion"})})]})]})}),e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(Su,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(Nn,{align:"end",children:[e.jsxs(Lt,{onClick:()=>l(!0),children:[e.jsx(It,{className:"mr-2 h-4 w-4"}),"Agregar"]}),e.jsx(Lt,{asChild:!0,children:e.jsx(tC,{recipes:t})}),e.jsxs(Lt,{onClick:()=>d(ae.recipes.config),children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),"Configuracion"]}),e.jsx(Ou,{}),o.pathname!==ae.meal.view("weekly")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.meal.view("weekly"),className:"flex items-center",children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"}),"Plan de Comidas"]})}),!o.pathname.startsWith(ae.shoppingList.base)&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.shoppingList.view("list"),className:"flex items-center",children:[e.jsx(lr,{className:"mr-2 h-4 w-4"}),"Lista de Compras"]})}),o.pathname!==ae.recipes.view("list")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.recipes.view("list"),className:"flex items-center",children:[e.jsx(xl,{className:"mr-2 h-4 w-4"}),"Recetas"]})}),o.pathname!==ae.preparedMeals.view("list")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.preparedMeals.view("list"),className:"flex items-center",children:[e.jsx(gl,{className:"mr-2 h-4 w-4"}),"Comidas Preparadas"]})})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs("div",{className:"p-4 space-y-4 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[e.jsx(ye,{placeholder:"Buscar",value:h,onChange:w=>g(w.target.value),className:"sm:w-60"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(yt,{value:v,onValueChange:w=>b(w),children:[e.jsx(ft,{className:"w-32",children:e.jsx(vt,{placeholder:"Ordenar"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"az",children:"Nombre A-Z"}),e.jsx(Le,{value:"za",children:"Nombre Z-A"})]})]}),e.jsxs(yt,{value:x||"all",onValueChange:w=>y(w==="all"?"":w),children:[e.jsx(ft,{className:"w-40",children:e.jsx(vt,{placeholder:"Tipo"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"all",children:"Todos"}),Object.entries(fs).map(([w,E])=>e.jsx(Le,{value:w,children:E.title},w))]})]})]})]}),N.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No hay recetas guardadas"}):e.jsx("div",{className:"space-y-4",children:N.map(w=>e.jsxs(fe,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>d(ae.recipes.detail(w.id)),children:[e.jsxs(xt,{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(mt,{className:"text-base",children:w.name}),e.jsx(il,{children:fs[w.mealType].title})]}),e.jsx(P,{variant:"ghost",size:"sm",onClick:E=>{E.stopPropagation(),m(w),l(!0)},children:"Editar"})]}),e.jsxs(xe,{className:"space-y-3",children:[w.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:w.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Dificultad:"}),e.jsx("span",{className:"text-gray-600 capitalize",children:w.difficulty||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Tiempo:"}),e.jsx("span",{className:"text-gray-600",children:w.prepTime?`${w.prepTime} min`:"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Caloras:"}),e.jsxs("span",{className:"text-gray-600",children:[w.nutrition.calories," kcal"]})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Haz click para ver la receta completa"})]})]},w.id))})]})}),e.jsx(_k,{open:r,onOpenChange:w=>{w||m(null),l(w)},onSave:S,recipe:u||void 0})]})},Mk=[{key:"list",label:"Lista"}],aC="list",QU=()=>{const{viewKey:t}=Ss(),a=t||aC;return Mk.some(r=>r.key===a)?e.jsx(wi,{noPadding:!0,className:"h-full",children:e.jsx(XU,{})}):e.jsx(Ft,{to:`/recipes/view/${aC}`,replace:!0})},ZU=()=>{const t=it();return e.jsx(na,{title:"Configuracion de Recetas",icon:e.jsx(xl,{className:"h-4 w-4 text-white"}),views:Mk.map(a=>({...a,component:()=>null})),onViewChange:a=>t(`/recipes/view/${a}`),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"No hay configuraciones especificas para Recetas en este modulo."})})})})},JU=({open:t,onOpenChange:a,ingredients:s,availableItems:r,onSave:l})=>{const[o,d]=p.useState([]),[u,m]=p.useState(""),[h,g]=p.useState(null),[x,y]=p.useState(!1),[v,b]=p.useState("1"),[N,S]=p.useState(""),[w,E]=p.useState(""),[T,D]=p.useState(!1);p.useEffect(()=>{t&&(d(s.map(V=>({shoppingItemId:V.shoppingItemId,shoppingItemName:V.shoppingItem.name,quantity:V.quantity,unit:V.unit,notes:V.notes}))),m(""),g(null),y(!1))},[t,s]);const k=r.filter(V=>V.name.toLowerCase().includes(u.toLowerCase())&&!o.some(F=>F.shoppingItemId===V.id)),_=()=>{if(!h||!v||Number(v)<=0)return;const V=r.find(G=>G.id===h.id);if(!V)return;const F={shoppingItemId:h.id,shoppingItemName:V.name,quantity:Number(v),unit:N.trim()||void 0,notes:w.trim()||void 0};d([...o,F]),g(null),b("1"),S(""),E(""),m(""),y(!1)},R=V=>{d(o.filter(F=>F.shoppingItemId!==V))},L=(V,F,G)=>{d(o.map($=>$.shoppingItemId===V?{...$,[F]:G}:$))},U=async()=>{D(!0);try{await l(o),a(!1)}catch(V){console.error("Error saving ingredients:",V)}finally{D(!1)}};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Gestionar Ingredientes"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto py-4 space-y-6",children:[e.jsxs("div",{className:"space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx(Ce,{className:"text-base font-medium text-blue-900",children:"Agregar Ingrediente"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ye,{placeholder:"Buscar producto en tu lista de compras...",value:u,onChange:V=>{const F=V.target.value;m(F),y(F.length>0),(!h||h.name!==F)&&g(null)},onFocus:()=>{u.length>0&&y(!0)},className:"text-base h-11 bg-white"}),x&&u&&k.length>0&&e.jsx("div",{className:"absolute z-10 mt-1 w-full bg-white border rounded-md shadow-lg max-h-64 overflow-y-auto",children:k.slice(0,15).map(V=>e.jsxs("button",{type:"button",className:"w-full px-4 py-3 text-left hover:bg-blue-50 border-b last:border-b-0",onMouseDown:F=>{F.preventDefault(),g({id:V.id,name:V.name}),m(V.name),y(!1)},children:[e.jsx("div",{className:"font-medium text-base",children:V.name}),V.category&&e.jsx("div",{className:"text-sm text-gray-500 mt-0.5",children:V.category})]},V.id))})]}),h&&e.jsxs("p",{className:"text-xs text-blue-700",children:["Seleccionado: ",h.name]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-700",children:"Cantidad *"}),e.jsx(ye,{type:"number",placeholder:"1",value:v,onChange:V=>b(V.target.value),min:"0",step:"0.1",className:"h-10 bg-white"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-700",children:"Unidad"}),e.jsx(ye,{placeholder:"tazas, gramos...",value:N,onChange:V=>S(V.target.value),className:"h-10 bg-white"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-700",children:"Notas"}),e.jsx(ye,{placeholder:"picado, rallado...",value:w,onChange:V=>E(V.target.value),className:"h-10 bg-white"})]})]}),e.jsxs(P,{type:"button",onClick:_,disabled:!h||!v||Number(v)<=0,className:"w-full h-10 text-base",children:[e.jsx(It,{className:"w-5 h-5 mr-2"}),"Agregar Ingrediente"]})]})]}),o.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{className:"text-base font-medium",children:["Ingredientes de la Receta (",o.length,")"]}),e.jsx("div",{className:"border rounded-lg divide-y bg-white",children:o.map(V=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-base",children:V.shoppingItemName}),e.jsxs("p",{className:"text-sm text-gray-600 mt-0.5",children:[V.quantity," ",V.unit||"unidades",V.notes&&e.jsxs("span",{className:"text-gray-500",children:["  ",V.notes]})]})]}),e.jsx(P,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>R(V.shoppingItemId),children:e.jsx(Sn,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-500",children:"Cantidad"}),e.jsx(ye,{type:"number",value:V.quantity,onChange:F=>L(V.shoppingItemId,"quantity",Number(F.target.value)),min:"0",step:"0.1",className:"h-9"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-500",children:"Unidad"}),e.jsx(ye,{value:V.unit||"",onChange:F=>L(V.shoppingItemId,"unit",F.target.value),placeholder:"tazas, gramos...",className:"h-9"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{className:"text-xs text-gray-500",children:"Notas"}),e.jsx(ye,{value:V.notes||"",onChange:F=>L(V.shoppingItemId,"notes",F.target.value),placeholder:"opcional",className:"h-9"})]})]})]},V.shoppingItemId))})]}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("p",{className:"text-lg font-medium mb-2",children:"No hay ingredientes"}),e.jsx("p",{className:"text-sm",children:"Agrega ingredientes usando el buscador de arriba"})]})]}),e.jsxs(Cs,{className:"border-t pt-4",children:[e.jsx(P,{variant:"outline",onClick:()=>a(!1),children:"Cancelar"}),e.jsxs(P,{onClick:U,disabled:T,children:[e.jsx(l0,{className:"w-4 h-4 mr-2"}),T?"Guardando...":"Guardar Cambios"]})]})]})})},eV=()=>{const{recipeId:t}=Ss(),a=it(),{recipes:s,updateRecipe:r}=Uu(),{items:l}=bl(),[o,d]=te.useState(!1),[u,m]=te.useState(!1),h=p.useMemo(()=>s.find(b=>b.id===t),[s,t]),{ingredients:g=[],replaceAllIngredients:x}=Ak(t);if(!h)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Receta no encontrada"}),e.jsx(P,{onClick:()=>a(ae.recipes.view("list")),children:"Volver a Recetas"})]});const y=async(b,N)=>N?(await r(N,b),N):null,v=async b=>{if(!t)return;const N=b.map(S=>({shoppingItemId:S.shoppingItemId,quantity:S.quantity,unit:S.unit,notes:S.notes}));await x(N)};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs("div",{className:"border-b bg-white px-4 py-3 flex items-center gap-3",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:()=>a(ae.recipes.view("list")),children:e.jsx(fl,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold",children:h.name}),e.jsx("p",{className:"text-sm text-gray-500",children:fs[h.mealType].title})]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>d(!0),children:[e.jsx(Vn,{className:"w-4 h-4 mr-2"}),"Editar"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(fe,{children:e.jsx(xe,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h.prepTime||""}),e.jsx("p",{className:"text-xs text-gray-500",children:"minutos"})]})]})})}),e.jsx(fe,{children:e.jsx(xe,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xl,{className:"w-5 h-5 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold capitalize",children:h.difficulty||""}),e.jsx("p",{className:"text-xs text-gray-500",children:"dificultad"})]})]})})}),e.jsx(fe,{children:e.jsx(xe,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fc,{className:"w-5 h-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:h.nutrition.calories}),e.jsx("p",{className:"text-xs text-gray-500",children:"kcal"})]})]})})}),e.jsx(fe,{children:e.jsx(xe,{className:"pt-6",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Macros"}),e.jsxs("p",{className:"text-sm font-medium",children:["P: ",h.nutrition.protein,"g | C: ",h.nutrition.carbs,"g | G: ",h.nutrition.fat,"g"]})]})})})]}),h.description&&e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{className:"text-lg",children:"Descripcin"})}),e.jsx(xe,{children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:h.description})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(fe,{children:[e.jsxs(xt,{className:"flex flex-row items-start justify-between",children:[e.jsxs(mt,{className:"text-lg",children:["Ingredientes (",g?.length||0,")"]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>m(!0),children:[e.jsx(rw,{className:"w-4 h-4 mr-2"}),"Gestionar"]})]}),e.jsx(xe,{children:g&&g.length>0?e.jsx("ul",{className:"space-y-3",children:g.map(b=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-1",children:""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:b.shoppingItem.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[b.quantity," ",b.unit||"unidades",b.notes&&e.jsxs("span",{className:"text-gray-500",children:["  ",b.notes]})]})]})]},b.shoppingItemId))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"No hay ingredientes agregados"}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>m(!0),children:[e.jsx(rw,{className:"w-4 h-4 mr-2"}),"Agregar Ingredientes"]})]})})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{className:"text-lg",children:"Instrucciones"})}),e.jsx(xe,{children:e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"whitespace-pre-wrap text-gray-700",children:h.instructions})})})]})]})]})}),e.jsx(_k,{open:o,onOpenChange:d,onSave:y,recipe:h}),e.jsx(JU,{open:u,onOpenChange:m,ingredients:g,availableItems:l,onSave:v})]})},tV=()=>e.jsx(wi,{noPadding:!0,className:"h-full",children:e.jsx(eV,{})}),aV={module:"recipe",defaultRoute:ae.recipes.view(ae.recipes.defaultView),moduleRoutes:[{path:"recipes",element:e.jsx(Ft,{to:ae.recipes.view(ae.recipes.defaultView),replace:!0})},{path:"recipes/view/:viewKey",element:e.jsx(QU,{})},{path:"recipes/config",element:e.jsx(ZU,{})},{path:"recipes/:recipeId",element:e.jsx(tV,{})}]},sV=({open:t,onOpenChange:a,onSave:s,meal:r})=>{const[l,o]=p.useState(""),[d,u]=p.useState("");p.useEffect(()=>{r?(o(r.name),u(r.portions!==void 0?String(r.portions):"")):(o(""),u(""))},[r,t]);const m=()=>{const h={name:l};d&&(h.portions=Number(d)),s(h,r?.id),a(!1)};return e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-md",children:[e.jsx(Ot,{children:e.jsxs(Rt,{children:[r?"Editar":"Agregar"," Comida Preparada"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"pm-name",children:"Nombre"}),e.jsx(ye,{id:"pm-name",value:l,onChange:h=>o(h.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"pm-portions",children:"Cantidad/Porciones (opcional)"}),e.jsx(ye,{id:"pm-portions",type:"number",value:d,onChange:h=>u(h.target.value)})]})]}),e.jsx(Cs,{children:e.jsx(P,{onClick:m,children:"Guardar"})})]})})},nV=()=>{const{meals:t,addMeal:a,updateMeal:s,deleteMeal:r}=iv(),[l,o]=p.useState(!1),d=gs(),u=it(),[m,h]=p.useState(null),g=(x,y)=>{y?s(y,x):a(x)};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs(Jf,{title:"Comidas Preparadas",views:[{key:"list",label:"Lista"}],activeViewKey:"list",onViewChange:()=>u(ae.preparedMeals.view("list")),children:[e.jsx(Vs,{children:e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>o(!0),children:[e.jsx(It,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Agregar"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Agregar"})})]}),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>u(ae.preparedMeals.config),children:[e.jsx(_s,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Configuracion"})]})}),e.jsx(fa,{children:e.jsx("p",{children:"Configuracion"})})]})]})}),e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(Su,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(Nn,{align:"end",children:[e.jsxs(Lt,{onClick:()=>o(!0),children:[e.jsx(It,{className:"mr-2 h-4 w-4"}),"Agregar"]}),e.jsxs(Lt,{onClick:()=>u(ae.preparedMeals.config),children:[e.jsx(_s,{className:"mr-2 h-4 w-4"}),"Configuracion"]}),e.jsx(Ou,{}),d.pathname!==ae.meal.view("weekly")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.meal.view("weekly"),className:"flex items-center",children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"}),"Plan de Comidas"]})}),!d.pathname.startsWith(ae.shoppingList.base)&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.shoppingList.view("list"),className:"flex items-center",children:[e.jsx(lr,{className:"mr-2 h-4 w-4"}),"Lista de Compras"]})}),d.pathname!==ae.recipes.view("list")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.recipes.view("list"),className:"flex items-center",children:[e.jsx(xl,{className:"mr-2 h-4 w-4"}),"Recetas"]})}),d.pathname!==ae.preparedMeals.view("list")&&e.jsx(Lt,{asChild:!0,children:e.jsxs(La,{to:ae.preparedMeals.view("list"),className:"flex items-center",children:[e.jsx(gl,{className:"mr-2 h-4 w-4"}),"Comidas Preparadas"]})})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"p-4 space-y-4 h-full overflow-y-auto",children:t.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No hay comidas guardadas"}):e.jsx("div",{className:"space-y-2",children:t.map(x=>e.jsxs("div",{className:"flex justify-between items-center border p-2 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:x.name}),x.portions!==void 0&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Porciones: ",x.portions]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>{h(x),o(!0)},children:"Editar"}),e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>r(x.id),children:"Eliminar"})]})]},x.id))})})}),e.jsx(sV,{open:l||!!m,onOpenChange:x=>{x||h(null),o(x)},onSave:g,meal:m||void 0})]})},Ok=[{key:"list",label:"Lista"}],sC="list",rV=()=>{const{viewKey:t}=Ss(),a=t||sC;return Ok.some(r=>r.key===a)?e.jsx(wi,{noPadding:!0,className:"h-full",children:e.jsx(nV,{})}):e.jsx(Ft,{to:`/prepared-meals/view/${sC}`,replace:!0})},iV=()=>{const t=it();return e.jsx(na,{title:"Configuracion de Comidas Preparadas",icon:e.jsx(gl,{className:"h-4 w-4 text-white"}),views:Ok.map(a=>({...a,component:()=>null})),onViewChange:a=>t(`/prepared-meals/view/${a}`),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"No hay configuraciones especificas para Comidas Preparadas en este modulo."})})})})},lV={module:"prepared-meals",defaultRoute:ae.preparedMeals.view(ae.preparedMeals.defaultView),moduleRoutes:[{path:"prepared-meals",element:e.jsx(Ft,{to:ae.preparedMeals.view(ae.preparedMeals.defaultView),replace:!0})},{path:"prepared-meals/view/:viewKey",element:e.jsx(rV,{})},{path:"prepared-meals/config",element:e.jsx(iV,{})}]};class Yg{static client=ze;static table(a){return ze.from(a)}}const dv=t=>{const a={totalCount:0,byHabitId:{},byDate:{}};return Object.entries(t).forEach(([s])=>{const[r,l]=s.split("_"),o=parseInt(r);a.totalCount++,a.byHabitId[o]=(a.byHabitId[o]||0)+1,a.byDate[l]=(a.byDate[l]||0)+1}),a},oV=(t,a=5)=>{const s=dv(t);return Object.entries(s.byHabitId).sort(([,r],[,l])=>l-r).slice(0,a).map(([r,l])=>({habitId:parseInt(r),count:l}))},cV=(t,a=3)=>{const s=dv(t);return Object.entries(s.byDate).sort(([,r],[,l])=>l-r).slice(0,a).map(([r,l])=>({date:r,count:l}))},dV=()=>{const[t,a]=p.useState([]),[s,r]=p.useState("idle"),[l,o]=p.useState(null),{user:d}=st(),u=p.useMemo(()=>{const y={};return t.forEach(v=>{const b=new Date(v.timestamp).toISOString().split("T")[0],N=`${v.habit_id}_${b}`;y[N]={timestamp:v.timestamp,habitId:v.habit_id,...v.note&&{note:v.note}}}),y},[t]),m=p.useMemo(()=>({...dv(u),topHabits:oV(u),frequentDays:cV(u)}),[u]),h=p.useCallback(async()=>{if(d){r("loading"),o(null);try{const y=new Date,v=`${y.getFullYear()}-01-01`,b=`${y.getFullYear()}-12-31`,{data:N,error:S}=await Yg.table("negative_habit_logs").select("*").eq("user_id",d.id).gte("timestamp",new Date(v).getTime()).lte("timestamp",new Date(b).getTime()).order("timestamp",{ascending:!1});if(S)throw S;a(N||[]),r("saved")}catch(y){o(y instanceof Error?y.message:"Error al cargar los datos"),r("error")}}},[d]);return p.useEffect(()=>{h()},[h]),{habits:u,stats:m,status:s,error:l,logHabit:async(y,v,b)=>{if(d){r("saving"),o(null);try{const N=new Date(`${v}T12:00:00`).getTime(),{error:S}=await Yg.table("negative_habit_logs").insert({user_id:d.id,habit_id:y,timestamp:N,note:b});if(S)throw S;await h(),r("saved")}catch(N){o(N instanceof Error?N.message:"Error al guardar"),r("error")}}},removeLog:async(y,v)=>{if(d){r("saving"),o(null);try{const b=new Date(`${v}T00:00:00`).getTime(),N=new Date(`${v}T23:59:59`).getTime(),{error:S}=await Yg.table("negative_habit_logs").delete().eq("user_id",d.id).eq("habit_id",y).gte("timestamp",b).lte("timestamp",N);if(S)throw S;await h(),r("saved")}catch(b){o(b instanceof Error?b.message:"Error al eliminar"),r("error")}}},reload:h}},nC=({habits:t,completedHabits:a,weekDays:s,onLogHabit:r,onRemoveLog:l,disabled:o})=>e.jsx(Vs,{children:e.jsxs("div",{className:"grid grid-cols-[minmax(100px,1fr)_repeat(7,minmax(32px,1fr))] gap-1",children:[e.jsx("div",{}),s.map(d=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:d.dayName}),e.jsx("div",{className:"text-[10px] text-gray-400",children:d.fullDate.split("-").slice(1).join("/")})]},d.fullDate)),t.map(d=>e.jsxs(te.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:d.icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:d.name}),e.jsx("span",{className:"text-xs text-gray-500",children:d.category})]})]}),s.map(u=>{const m=`${d.id}_${u.fullDate}`,h=a[m];return e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsx(P,{variant:h?"destructive":"outline",size:"icon",className:"w-8 h-8 p-0",onClick:()=>h?l(d.id,u.fullDate):r(d.id,u.fullDate),disabled:o,children:h?e.jsx(Fa,{className:"w-4 h-4 text-white"}):e.jsx(hc,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsx(fa,{children:h?"Eliminar registro":"Registrar hbito"})]})},m)})]},d.id))]})}),cc={health:{icon:"",label:"Salud",description:"Hbitos que afectan tu salud fsica"},productivity:{icon:"",label:"Productividad",description:"Hbitos que reducen tu eficiencia"},social:{icon:"",label:"Social",description:"Hbitos que afectan tus relaciones"},emotional:{icon:"",label:"Emocional",description:"Hbitos que afectan tu bienestar emocional"},finance:{icon:"",label:"Finanzas",description:"Hbitos que impactan tus finanzas"},digital:{icon:"",label:"Digital",description:"Hbitos digitales nocivos"},environment:{icon:"",label:"Ambiente",description:"Hbitos que impactan al medio ambiente"}},dl=[{id:1,name:"Saltarse comidas",icon:"",category:"health"},{id:2,name:"Dormir poco",icon:"",category:"health"},{id:3,name:"No hacer ejercicio",icon:"",category:"health"},{id:4,name:"Comer en exceso",icon:"",category:"health"},{id:25,name:"Comida chatarra",icon:"",category:"health"},{id:26,name:"Exceso de azcar",icon:"",category:"health"},{id:27,name:"Masturbacin",icon:"",category:"health"},{id:5,name:"Procrastinar",icon:"",category:"productivity"},{id:6,name:"Distracciones",icon:"",category:"productivity"},{id:7,name:"Multitarea",icon:"",category:"productivity"},{id:8,name:"Desorganizacin",icon:"",category:"productivity"},{id:24,name:"Exceso de trabajo (Workaholic)",icon:"",category:"productivity"},{id:9,name:"Aislamiento",icon:"",category:"social"},{id:10,name:"Conflictos",icon:"",category:"social"},{id:11,name:"No escuchar",icon:"",category:"social"},{id:29,name:"Dejar en visto",icon:"",category:"social"},{id:15,name:"Sobrepensar cosas",icon:"",category:"emotional"},{id:16,name:"Negatividad / Pesimismo",icon:"",category:"emotional"},{id:17,name:"Ser grosero/estresarme",icon:"",category:"emotional"},{id:28,name:"Celos compulsivos",icon:"",category:"emotional"},{id:12,name:"Gastos impulsivos",icon:"",category:"finance"},{id:13,name:"No ahorrar",icon:"",category:"finance"},{id:14,name:"Ms Deudas",icon:"",category:"finance"},{id:18,name:"Exceso de Redes sociales",icon:"",category:"digital"},{id:19,name:"Exceso de Videojuegos",icon:"",category:"digital"},{id:20,name:"Exceso de Netflix",icon:"",category:"digital"},{id:21,name:"Desperdiciar agua",icon:"",category:"environment"},{id:22,name:"No reciclar",icon:"",category:"environment"},{id:23,name:"Consumo excesivo",icon:"",category:"environment"}],uV=t=>{const a=[],s=new Date(t),r=s.getDay(),l=r===0?-6:1-r;s.setDate(s.getDate()+l);for(let o=0;o<7;o++){const d=new Date(s);d.setDate(s.getDate()+o),a.push({dayName:d.toLocaleDateString("es-ES",{weekday:"short"}),fullDate:Ue(d)})}return a},mV=({habits:t,onLogHabit:a,onRemoveLog:s,disabled:r})=>{const l=uV(new Date),[o,d]=p.useState(""),[u,m]=p.useState(["health"]),[h,g]=p.useState(!1),x=p.useMemo(()=>{const N={};return dl.forEach(S=>{N[S.category]||(N[S.category]=[]),!(o&&!S.name.toLowerCase().includes(o.toLowerCase()))&&N[S.category].push(S)}),N},[o]),y=p.useMemo(()=>{const N=dl.length,S=Object.values(x).reduce((T,D)=>T+D.length,0),w={},E=new Date().toISOString().split("T")[0];return Object.entries(t).forEach(([T])=>{const[D,k]=T.split("_");if(k===E){const _=dl.find(R=>R.id===Number(D));_&&(w[_.category]=(w[_.category]||0)+1)}}),{totalHabits:N,filteredHabits:S,loggedByCategory:w,isFiltered:o.length>0}},[x,t,o]),v=p.useMemo(()=>{const N=new Map;return Object.entries(t).forEach(([S])=>{const[w]=S.split("_"),E=N.get(Number(w))||0;N.set(Number(w),E+1)}),dl.filter(S=>N.has(S.id)).sort((S,w)=>(N.get(w.id)||0)-(N.get(S.id)||0)).slice(0,5)},[t]),b=N=>{m(S=>S.includes(N)?S.filter(w=>w!==N):[...S,N])};return e.jsxs("div",{className:"space-y-4",children:["      ",e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(fo,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(ye,{placeholder:"Buscar hbito...",value:o,onChange:N=>d(N.target.value),className:"pl-8 pr-16"}),y.isFiltered&&e.jsxs("div",{className:"absolute right-2 top-2 bg-blue-100 text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium",children:[y.filteredHabits,"/",y.totalHabits]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(P,{variant:"outline",onClick:()=>g(!h),className:"flex-1 sm:flex-none",children:h?"Mostrar ms frecuentes":"Mostrar todos"}),Object.keys(y.loggedByCategory).length>0&&e.jsxs("div",{className:"bg-green-100 text-green-800 px-3 py-1.5 rounded-md text-sm font-medium",children:[Object.values(y.loggedByCategory).reduce((N,S)=>N+S,0)," hoy"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"sm:min-w-[640px]",children:h?e.jsx("div",{className:"space-y-6",children:Object.entries(x).map(([N,S])=>{if(S.length===0)return null;const w=u.includes(N),E=cc[N];return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(P,{variant:"ghost",onClick:()=>b(N),className:"w-full flex items-center justify-between p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:E.icon}),e.jsx("span",{className:"font-medium",children:E.label}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",S.length,")"]}),y.loggedByCategory[N]&&e.jsxs("span",{className:"bg-red-100 text-red-800 px-2 py-0.5 rounded-full text-xs font-medium ml-1",children:[y.loggedByCategory[N]," hoy"]})]}),w?e.jsx(rn,{size:20}):e.jsx(wn,{size:20})]}),w&&e.jsx(nC,{habits:S,completedHabits:t,weekDays:l,onLogHabit:a,onRemoveLog:s,disabled:r})]},N)})}):e.jsx(nC,{habits:v,completedHabits:t,weekDays:l,onLogHabit:a,onRemoveLog:s,disabled:r})})}),"      ",e.jsxs(ao,{variant:"destructive",children:[" ",e.jsx(so,{children:h?`Visualizacin completa de hbitos agrupados por categora${y.isFiltered?` (${y.filteredHabits} de ${y.totalHabits} hbitos mostrados)`:""}. Usa el buscador para encontrar hbitos especficos.`:`Mostrando solo tus ${v.length} hbitos ms frecuentes. Haz clic en "Mostrar todos" para ver la lista completa.`})]})]})},rC=({habits:t,completedHabits:a,onLogHabit:s,onRemoveLog:r})=>{const l=new Date().getFullYear();return e.jsx(Vs,{children:e.jsx("div",{className:"space-y-6",children:t.map(o=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sticky top-0 bg-white z-10 py-2",children:[e.jsx("span",{className:"text-xl",children:o.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:o.name}),e.jsx("p",{className:"text-sm text-gray-500",children:o.category})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(rD,{year:l,renderCell:d=>{const u=`${o.id}_${d}`,m=a[u],h=new Date().toISOString().split("T")[0]===d;return e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsx(P,{variant:m?"destructive":"ghost",onClick:()=>m?r(o.id,d):s(o.id,d),className:he("w-1 h-1 p-0 rounded-full border transition-all duration-200 hover:scale-110",m?"bg-red-600 border-red-700 hover:bg-red-700":"bg-gray-100 border-gray-200 hover:bg-gray-200 hover:border-gray-300",h&&"ring-2 ring-blue-400 ring-offset-1"),"aria-label":m?"Eliminar registro":"Registrar hbito"})}),e.jsx(fa,{children:e.jsx("p",{className:"text-sm",children:new Date(d).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})})]},d)}})})]},o.id))})})},hV=({habits:t,onLogHabit:a,onRemoveLog:s})=>{const[r,l]=p.useState(""),[o,d]=p.useState("all"),[u,m]=p.useState(["health"]),[h,g]=p.useState(!1),x=p.useMemo(()=>{const b=new Map;return Object.entries(t).forEach(([N])=>{const[S]=N.split("_"),w=b.get(Number(S))||0;b.set(Number(S),w+1)}),dl.filter(N=>b.has(N.id)).sort((N,S)=>(b.get(S.id)||0)-(b.get(N.id)||0)).slice(0,5)},[t]),y=p.useMemo(()=>{const b={};return dl.forEach(N=>{r&&!N.name.toLowerCase().includes(r.toLowerCase())||o!=="all"&&N.category!==o||(b[N.category]||(b[N.category]=[]),b[N.category].push(N))}),b},[r,o]),v=b=>{m(N=>N.includes(b)?N.filter(S=>S!==b):[...N,b])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(fo,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(ye,{placeholder:"Buscar hbito...",value:r,onChange:b=>l(b.target.value),className:"pl-8"})]}),e.jsxs(yt,{value:o,onValueChange:d,children:[e.jsx(ft,{className:"w-full sm:w-[180px]",children:e.jsx(vt,{placeholder:"Categora"})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"all",children:"Todas las categoras"}),Object.keys(cc).map(b=>e.jsx(Le,{value:b,children:cc[b].label},b))]})]}),e.jsx(P,{variant:"outline",onClick:()=>g(!h),className:"whitespace-nowrap",children:h?"Ver frecuentes":"Ver todos"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"sm:min-w-[800px] pb-4",children:h?e.jsx("div",{className:"space-y-8",children:Object.entries(y).map(([b,N])=>{if(N.length===0)return null;const S=u.includes(b),w=cc[b];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(P,{variant:"ghost",onClick:()=>v(b),className:"w-full flex items-center justify-between p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:w.icon}),e.jsx("span",{className:"font-medium",children:w.label}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",N.length,")"]})]}),S?e.jsx(rn,{size:20}):e.jsx(wn,{size:20})]}),S&&e.jsx(rC,{habits:N,completedHabits:t,onLogHabit:a,onRemoveLog:s})]},b)})}):e.jsx(rC,{habits:x,completedHabits:t,onLogHabit:a,onRemoveLog:s})})}),e.jsxs(ao,{variant:"destructive",children:[" ",e.jsx(so,{children:h?"Vista completa de hbitos por categora. Usa los filtros para encontrar hbitos especficos.":'Mostrando tus hbitos ms frecuentes. Cambia a "Ver todos" para la lista completa.'})]})]})},fV=({category:t,habits:a,onSelectHabit:s})=>{const r=cc[t];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:r.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:r.label}),e.jsx("p",{className:"text-sm text-gray-500",children:r.description})]})]}),e.jsx(Wf,{className:"h-[300px] pr-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:a.map(l=>e.jsxs(P,{variant:"outline",className:"h-auto py-3 px-2 flex flex-col items-center gap-2 group",onClick:()=>s(l.id),children:[e.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:l.icon}),e.jsx("span",{className:"text-xs text-center line-clamp-2",children:l.name})]},l.id))})})]})},pV=({onSelectHabit:t})=>{const[a,s]=p.useState("health"),r=dl.reduce((l,o)=>(l[o.category]||(l[o.category]=[]),l[o.category].push(o),l),{});return e.jsx("div",{className:"w-full",children:e.jsxs(Hu,{defaultValue:a,onValueChange:l=>s(l),className:"w-full",children:[e.jsx(Bc,{className:"grid grid-cols-4 gap-2 h-auto sm:grid-cols-7",children:Object.entries(cc).map(([l,{icon:o,label:d}])=>e.jsxs(rr,{value:l,className:"text-sm flex flex-col gap-1 py-2 h-auto",children:[e.jsx("span",{className:"text-xl",children:o}),e.jsx("span",{className:"hidden sm:inline text-xs",children:d})]},l))}),Object.entries(r).map(([l,o])=>e.jsx(ir,{value:l,className:"mt-4",children:e.jsx(fV,{category:l,habits:o,onSelectHabit:t})},l))]})})},xV=({isOpen:t,onClose:a,onLogHabit:s,selectedDate:r})=>e.jsx(Mt,{open:t,onOpenChange:a,children:e.jsxs(Tt,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col",children:[e.jsxs(Ot,{children:[e.jsx(Rt,{children:"Registrar Hbito Negativo"}),e.jsx("p",{className:"text-sm text-gray-500",children:Hh(r)})]}),e.jsx("div",{className:"flex-1 overflow-hidden py-4",children:e.jsx(pV,{onSelectHabit:s})})]})}),iu=Ci("negativeHabit"),gV=iu?`https://generativelanguage.googleapis.com/v1beta/models/${iu.model}:generateContent`:"",yV=({habits:t,open:a,onOpenChange:s})=>{const[r,l]=p.useState(!1),o=a!==void 0?a:r,d=s??l,[u,m]=p.useState(""),[h,g]=p.useState(""),[x,y]=p.useState(!1),[v,b]=p.useState(0),N="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",S=iu?.prompts?.impact??"Explica el impacto de mis hbitos negativos de acuerdo con mis registros.",w=iu?.prompts?.action??"Recomienda acciones para reducirlos cada vez que los registro.",E=iu?.params;p.useEffect(()=>{if(o){const _=T();g(`${S}
${w}
${_}`)}else g(""),m("")},[o,t]),p.useEffect(()=>{b(zr(h))},[h]);const T=()=>{const _={};let R=null,L=null;Object.keys(t).forEach(F=>{const[G,$]=F.split("_"),z=parseInt(G,10);_[z]=(_[z]||0)+1,(!R||$<R)&&(R=$),(!L||$>L)&&(L=$)});const U=R&&L?`Datos del ${R} al ${L}`:"Sin registros",V=dl.map(F=>`- ${F.name}: ${_[F.id]||0}`).join(`
`);return`${U}
${V}`},D=async()=>{y(!0);try{const L=(await(await fetch(`${gV}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}],...E})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text;m(L||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{y(!1)}},k=()=>{d(!1),m(""),g(""),b(0)};return e.jsxs(Mt,{open:o,onOpenChange:_=>_?d(!0):k(),children:[a===void 0&&e.jsxs(P,{size:"sm",variant:"outline",onClick:()=>d(!0),className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-4 h-4"}),"Analizar hbitos"]}),e.jsxs(Tt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0",children:[e.jsx(Rt,{className:"text-xl",children:"Anlisis de Hbitos Negativos con IA"}),e.jsx(Ms,{children:"La IA analizar el impacto de tus hbitos negativos y te recomendar acciones especficas para reducirlos. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:h,onChange:_=>g(_.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Datos de hbitos negativos para analizar..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",v]}),v>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:D,disabled:x||!N||v>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[x&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(os,{className:"w-4 h-4"}),x?"Consultando IA...":"Obtener anlisis"]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Impacto y recomendaciones"}),u&&e.jsxs(P,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(u),ut.success("Anlisis copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Rr,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-md p-4 overflow-auto",children:u?e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:uo.sanitize(u.replace(/\n/g,"<br>"))}}):x?e.jsx("div",{className:"text-sm text-gray-500",children:"Analizando impacto de hbitos negativos..."}):e.jsx("div",{className:"text-sm text-gray-500",children:"El anlisis del impacto de tus hbitos negativos aparecer aqu. La IA te dar recomendaciones especficas para reducir cada hbito."})})})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:" Tip: S honesto con tus registros para obtener mejores recomendaciones"}),!N]})})]})]})},vV=({habits:t})=>{const[a,s]=p.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Hn,{children:[e.jsx(Un,{asChild:!0,children:e.jsxs(P,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(os,{className:"w-4 h-4"}),"IA"]})}),e.jsx(Nn,{align:"end",children:e.jsx(Lt,{onSelect:()=>s(!0),children:"Analizar hbitos"})})]}),e.jsx(yV,{habits:t,open:a,onOpenChange:s})]})},Rk=[{key:"weekly",label:"Semanal"},{key:"yearly",label:"Anual"}],iC="weekly",bV=({selectedDate:t,habits:a,status:s,logHabit:r,removeLog:l,isOnline:o})=>e.jsx(mV,{habits:a,onLogHabit:(d,u)=>r(d,Ue(t),u),onRemoveLog:l,disabled:s==="saving"||!o}),jV=({habits:t,logHabit:a,removeLog:s})=>e.jsx(hV,{habits:t,onLogHabit:a,onRemoveLog:s}),NV=()=>{const t=it(),{viewKey:a}=Ss(),s=a||iC,[r,l]=p.useState(new Date),[o,d]=p.useState(!1),{user:u}=st(),{habits:m,status:h,error:g,logHabit:x,removeLog:y}=dV(),{isOnline:v}=Au(),b=Rk.map(E=>({...E,component:E.key==="weekly"?bV:jV})),N=b.find(E=>E.key===s);if(!N)return e.jsx(Ft,{to:ae.negativeHabits.view(iC),replace:!0});if(!u)return e.jsx(na,{title:"Habitos Negativos",icon:e.jsx(o0,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{className:"w-full",children:e.jsx(xe,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesion para registrar tus habitos negativos"})})})})});const S=[{id:"config",label:"Configuracion",icon:e.jsx(_s,{className:"h-4 w-4"}),onClick:()=>t(ae.negativeHabits.config),tooltip:"Configuracion"}],w=N.component;return e.jsxs(na,{title:"Habitos Negativos",subtitle:"Identifica y reduce comportamientos que quieres cambiar",icon:e.jsx(o0,{className:"h-4 w-4 text-white"}),views:b,activeViewKey:s,onViewChange:E=>t(ae.negativeHabits.view(E)),actions:S,children:[e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(jl,{selectedDate:r,onChange:l}),e.jsx(fe,{className:"w-full",children:e.jsxs(xe,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Registro de Habitos"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Identifica y registra los habitos que deseas cambiar"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(vV,{habits:m})})]}),e.jsx(w,{selectedDate:r,habits:m,status:h,error:g,logHabit:x,removeLog:y,isOnline:v}),g&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:g})]})})]}),e.jsx(xV,{isOpen:o,onClose:()=>d(!1),onLogHabit:async(E,T)=>{await x(E,Ue(r),T),d(!1)},selectedDate:r})]})},wV=()=>{const t=it();return e.jsx(na,{title:"Configuracion de Habitos Negativos",icon:e.jsx(o0,{className:"h-4 w-4 text-white"}),views:Rk.map(a=>({...a,component:()=>null})),onViewChange:a=>t(`/negative/view/${a}`),children:e.jsx("div",{className:"p-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"No hay configuraciones especificas para Habitos Negativos en este modulo."})})})})},SV={module:"negative-habits",defaultRoute:ae.negativeHabits.view(ae.negativeHabits.defaultView),moduleRoutes:[{path:"negative",element:e.jsx(Ft,{to:ae.negativeHabits.view(ae.negativeHabits.defaultView),replace:!0})},{path:"negative/view/:viewKey",element:e.jsx(NV,{})},{path:"negative/config",element:e.jsx(wV,{})}]},lC=1800,CV=({onComplete:t,onCancel:a,selectedDate:s})=>{const{user:r}=st(),[l,o]=p.useState(null),[d,u]=p.useState(!1),m=p.useRef(null),h=p.useRef(!1),g=fE();p.useEffect(()=>{g.setOnCompletion(D=>{console.log("Callback de finalizacin llamado, guardando sesin..."),t(D)})},[g,t]);const x=p.useCallback(()=>{m.current!==null&&(cancelAnimationFrame(m.current),m.current=null)},[]),y=p.useCallback(()=>{h.current||(h.current=!0,x(),g.stopTimer(),o(null),u(!1),setTimeout(()=>{h.current=!1},100))},[x,g]),v=p.useCallback(D=>{const k=(Date.now()-D)/1e3;return Math.max(0,lC-k)},[]),b=p.useCallback(async()=>{if(!r||l)return;const k={startTime:Date.now(),deviceId:crypto.randomUUID(),pausedAt:null};o(k),g.startTimer()},[r,l,g]),N=p.useCallback(async()=>{if(!l||d)return;u(!0);const D=Math.floor((Date.now()-l.startTime)/1e3);try{a(D)}finally{y()}},[l,d,a,y]);p.useEffect(()=>()=>{x()},[x]);const S=l?v(l.startTime):lC,w=l!==null,T=(D=>{const k=Math.floor(D/60),_=Math.floor(D%60);return`${k.toString().padStart(2,"0")}:${_.toString().padStart(2,"0")}`})(S);return{activePomodoro:l,startPomodoro:b,stopPomodoro:N,remainingTime:S,time:S,isActive:w,formattedTime:T,startTimer:b,stopTimer:N}};class ac{static client=ze;static table(a){return ze.from(a)}static async getSessionsRange(a,s,r){return ze.from("pomodoro_sessions").select("date, duration, completed").eq("user_id",a).gte("date",s).lte("date",r).order("date",{ascending:!0}).returns()}}const EV=t=>{const[a,s]=p.useState([]),[r,l]=p.useState(0),[o,d]=p.useState("idle"),[u,m]=p.useState(null),{user:h}=st(),g=Ue(t||new Date),x=async()=>{if(h){d("pending"),m(null);try{const{data:S,error:w}=await ac.table("pomodoro_sessions").select("*").eq("user_id",h.id).eq("date",g).order("start_time->timestamp",{ascending:!1});if(w)throw w;const E=(S||[]).map(T=>({startTime:T.start_time,endTime:T.end_time,duration:T.duration,completed:T.completed,...T.description&&{description:T.description}}));s(E),l(E.filter(T=>T.completed).length),d("saved")}catch(S){console.error("Pomodoro - Error loading data:",S),m(S instanceof Error?S.message:"Error loading pomodoro data"),d("error")}}};return p.useEffect(()=>{x()},[h,g]),{count:r,sessions:a,status:o,error:u,saveSession:async(S,w,E={})=>{if(h){d("saving"),m(null);try{const T=t||new Date,D=new Date,k=$n(T,D.getHours(),D.getMinutes()),_=new Date(D.getTime()-S*1e3),R=$n(T,_.getHours(),_.getMinutes()),L={startTime:{timestamp:R.timestamp,utcOffset:R.utcOffset,formatted:R.formatted},endTime:{timestamp:k.timestamp,utcOffset:k.utcOffset,formatted:k.formatted},duration:S,completed:w};E.description?.trim()&&(L.description=E.description.trim());const{error:U}=await ac.table("pomodoro_sessions").insert({user_id:h.id,date:g,start_time:L.startTime,end_time:L.endTime,duration:L.duration,completed:L.completed,description:L.description||null});if(U)throw U;await x()}catch(T){console.error("Pomodoro - Error al guardar:",T),m(T instanceof Error?T.message:"Error al guardar"),d("error")}}},deleteSession:async S=>{if(!h)return;d("saving"),m(null);const w=a,E=a.filter(T=>T.startTime.timestamp!==S.startTime.timestamp);s(E),l(E.filter(T=>T.completed).length);try{const{error:T}=await ac.table("pomodoro_sessions").delete().eq("user_id",h.id).eq("date",g).eq("start_time->timestamp",S.startTime.timestamp);if(T)throw T;d("saved")}catch(T){console.error("Pomodoro - Error al eliminar sesin:",T),s(w),l(w.filter(D=>D.completed).length),m(T instanceof Error?T.message:"Error al eliminar"),d("error")}},editSession:async(S,w)=>{if(!h)return;d("saving"),m(null);const E=a;try{const T=new Date(S.startTime.timestamp);let D=S.startTime,k=S.endTime;if(w.startTime){const V=new Date(w.startTime.timestamp),F=$n(T,V.getHours(),V.getMinutes());D={timestamp:F.timestamp,utcOffset:F.utcOffset,formatted:F.formatted}}if(w.endTime){const V=new Date(w.endTime.timestamp),F=$n(T,V.getHours(),V.getMinutes());k={timestamp:F.timestamp,utcOffset:F.utcOffset,formatted:F.formatted}}const _=(k.timestamp-D.timestamp)/1e3,R=a.map(V=>V.startTime.timestamp===S.startTime.timestamp?{...V,startTime:D,endTime:k,duration:_,completed:w.completed??V.completed,...w.description?.trim()?{description:w.description.trim()}:{}}:V);s(R),l(R.filter(V=>V.completed).length);const L={start_time:D,end_time:k,duration:_,completed:w.completed??S.completed};w.description!==void 0&&(L.description=w.description?.trim()||null);const{error:U}=await ac.table("pomodoro_sessions").update(L).eq("user_id",h.id).eq("date",g).eq("start_time->timestamp",S.startTime.timestamp);if(U)throw U;await x(),d("saved")}catch(T){console.error("Pomodoro - Error al editar sesin:",T),s(E),l(E.filter(D=>D.completed).length),m(T instanceof Error?T.message:"Error al editar"),d("error")}},addManualSession:async(S={})=>{if(h){d("saving"),m(null);try{const w=t||new Date,E=new Date,T=$n(w,E.getHours(),E.getMinutes()),D=new Date(E.getTime()-1800*1e3),k=$n(w,D.getHours(),D.getMinutes()),_={startTime:{timestamp:k.timestamp,utcOffset:k.utcOffset,formatted:k.formatted},endTime:{timestamp:T.timestamp,utcOffset:T.utcOffset,formatted:T.formatted},duration:1800,completed:!0};S.description?.trim()&&(_.description=S.description.trim());const{error:R}=await ac.table("pomodoro_sessions").insert({user_id:h.id,date:g,start_time:_.startTime,end_time:_.endTime,duration:_.duration,completed:_.completed,description:_.description||null});if(R)throw R;await x()}catch(w){console.error("Pomodoro - Error al agregar sesin manual:",w),m(w instanceof Error?w.message:"Error al guardar"),d("error")}}},loadPomodoroData:x}},TV=({count:t,onIncrement:a,disabled:s,status:r})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center min-w-[3rem]",children:[e.jsx("span",{className:"font-medium text-lg",children:t}),e.jsx("span",{className:"text-xs text-gray-500",children:"completados"})]}),e.jsx(P,{variant:"outline",size:"icon",onClick:a,disabled:s,className:"h-8 w-8",children:e.jsx(It,{className:"w-4 h-4"})}),r==="saving"&&e.jsx("span",{className:"text-xs text-blue-500 animate-pulse",children:"Guardando..."}),r==="error"&&e.jsx("span",{className:"text-xs text-red-500",children:"Error al guardar"})]}),oC=t=>new Date(t).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1}),DV=({sessions:t,onDeleteSession:a,onEditSession:s})=>{const[r,l]=p.useState(!1),o=[...t].sort((d,u)=>u.startTime.timestamp-d.startTime.timestamp);return e.jsx(Py,{type:"single",collapsible:!0,onValueChange:d=>l(!!d),value:r?"history":"",children:e.jsxs(Bf,{value:"history",className:"border-none",children:[e.jsx($f,{className:"w-full h-11 flex items-center justify-center gap-2 border rounded-lg bg-background hover:bg-accent data-[state=open]:rounded-b-none",children:e.jsx("span",{className:"text-sm font-semibold",children:"Historial de hoy"})}),e.jsx(Hf,{className:"mt-2 space-y-2",children:o.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm py-2",children:"No hay sesiones registradas hoy"}):o.map((d,u)=>e.jsxs("div",{className:"flex flex-col p-2.5 bg-muted rounded-lg text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[d.completed?e.jsx(xi,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):e.jsx(VM,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-gray-400 w-4",children:u+1}),e.jsx("span",{children:oC(d.startTime.timestamp)}),e.jsx("span",{className:"text-gray-400",children:""}),e.jsx("span",{children:oC(d.endTime.timestamp)})]})}),e.jsxs("span",{className:"text-gray-500 whitespace-nowrap",children:[Math.floor(d.duration/60),"min"]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[s&&e.jsx(P,{variant:"ghost",size:"icon",className:"h-auto w-auto p-1",onClick:()=>s(d),children:e.jsx(Vn,{className:"w-4 h-4 text-muted-foreground"})}),a&&e.jsx(P,{variant:"ghost",size:"icon",className:"h-auto w-auto p-1",onClick:()=>a(d),children:e.jsx(Sn,{className:"w-4 h-4 text-destructive"})})]})]}),d.description&&e.jsx("div",{className:"ml-6 mt-1 text-xs text-gray-500",children:d.description})]},d.startTime.timestamp))})]})})},kV=({time:t,isActive:a,onStart:s,onStop:r,disabled:l})=>{const[o,d]=p.useState(!1),u=async h=>{if(h.preventDefault(),!o)try{d(!0),await r()}finally{d(!1)}},m=async h=>{if(h.preventDefault(),!o)try{d(!0),await s()}finally{d(!1)}};return e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"text-6xl font-mono tracking-wider",children:t}),e.jsx("div",{className:"flex gap-4",children:a?e.jsxs(P,{size:"lg",onClick:u,disabled:l||o,variant:"destructive",className:"w-40 text-lg",children:[o?e.jsx(hs,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(ay,{className:"w-5 h-5 mr-2"}),o?"Deteniendo...":"Detener"]}):e.jsxs(P,{size:"lg",onClick:m,disabled:l||o,className:"w-40 text-lg",children:[o?e.jsx(hs,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(Bs,{className:"w-5 h-5 mr-2"}),o?"Iniciando...":"Iniciar"]})}),e.jsx("div",{className:"text-sm text-gray-500",children:a?e.jsx(e.Fragment,{children:o?e.jsx("span",{children:"Procesando cambio de estado..."}):e.jsx("span",{children:"Concentracin en progreso..."})}):e.jsx("span",{children:"30 minutos de concentracin"})})]})},AV=({progress:t,currentTime:a,totalTime:s,isActive:r})=>{const l=Math.min(Math.max(t,0),100);return e.jsxs("div",{className:"space-y-2",children:[e.jsx(Us,{value:l,className:`h-2 transition-all duration-300 ${r?"bg-gray-100":"bg-gray-50"}`}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:a}),e.jsx("span",{className:"text-gray-500",children:" restantes"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("span",{children:"Total: "}),e.jsx("span",{className:"font-medium",children:s})]})]}),e.jsx("div",{className:"text-center text-sm text-gray-500",children:l>0&&e.jsxs("span",{children:[Math.round(l),"% completado"]})})]})},_V=({session:t,onClose:a,onSave:s})=>{const[r,l]=p.useState(""),[o,d]=p.useState(""),[u,m]=p.useState(!1),[h,g]=p.useState("");if(p.useEffect(()=>{if(t){const y=new Date(t.startTime.timestamp),v=new Date(t.endTime.timestamp);l(`${String(y.getHours()).padStart(2,"0")}:${String(y.getMinutes()).padStart(2,"0")}`),d(`${String(v.getHours()).padStart(2,"0")}:${String(v.getMinutes()).padStart(2,"0")}`),m(t.completed),g(t.description||"")}},[t]),!t)return null;const x=()=>{const y=new Date(t.startTime.timestamp),[v,b]=r.split(":").map(Number),[N,S]=o.split(":").map(Number),w=new Date(y);w.setHours(v,b,0,0);const E=new Date(y);E.setHours(N,S,0,0),E<w&&E.setDate(E.getDate()+1);const T={startTime:{timestamp:w.getTime(),utcOffset:-w.getTimezoneOffset(),formatted:new Date(w).toLocaleString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})+` UTC${-w.getTimezoneOffset()>=0?"+":"-"}${Math.abs(Math.floor(-w.getTimezoneOffset()/60))}`},endTime:{timestamp:E.getTime(),utcOffset:-E.getTimezoneOffset(),formatted:new Date(E).toLocaleString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})+` UTC${-E.getTimezoneOffset()>=0?"+":"-"}${Math.abs(Math.floor(-E.getTimezoneOffset()/60))}`},duration:(E.getTime()-w.getTime())/1e3,completed:u,description:h.trim()||void 0};s(t,T),a()};return e.jsx(Mt,{open:!!t,onOpenChange:y=>{y||a()},children:e.jsxs(Tt,{className:"sm:max-w-md",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Editar Sesin Pomodoro"})}),e.jsxs("div",{className:"py-4 space-y-4",children:[" ",e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[" ",e.jsx(Ce,{htmlFor:"startTime",children:"Hora inicio"}),e.jsx(ye,{id:"startTime",type:"time",value:r,onChange:y=>l(y.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"endTime",children:"Hora fin"}),e.jsx(ye,{id:"endTime",type:"time",value:o,onChange:y=>d(y.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"description",children:"Descripcin (opcional)"}),e.jsx(ye,{id:"description",type:"text",value:h,onChange:y=>g(y.target.value),placeholder:"Qu hiciste en esta sesin?"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[" ",e.jsx(Va,{id:"completed",checked:u,onCheckedChange:y=>m(!!y)}),e.jsx(Ce,{htmlFor:"completed",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Sesin completada"})]})]}),e.jsxs(Cs,{children:[e.jsx(P,{variant:"outline",onClick:a,children:"Cancelar"}),e.jsx(P,{onClick:x,children:"Guardar cambios"})]})]})})},wh=t=>{const a=Math.floor(t/60),s=t%60;return a>0?`${a}h ${s}min`:`${s}min`},MV=t=>t===100?{icon:u1,message:"Meta diaria alcanzada! ",description:"Has completado tu objetivo del da Excelente trabajo!",color:"text-green-600"}:t>=75?{icon:Ac,message:"Casi ah! ",description:"Ests muy cerca de alcanzar tu meta diaria",color:"text-blue-600"}:t>=50?{icon:xs,message:"Buen progreso! ",description:"Mantn el ritmo, vas por buen camino",color:"text-indigo-600"}:t>=25?{icon:xs,message:"Sigue adelante! ",description:"Has comenzado bien, mantn el enfoque",color:"text-blue-600"}:{icon:xs,message:"Comencemos! ",description:"Es un buen momento para enfocarse en tus objetivos",color:"text-gray-600"},OV=t=>t>=100?{background:"bg-green-500",text:"text-green-700",icon:"bg-green-100"}:t>=75?{background:"bg-blue-500",text:"text-blue-700",icon:"bg-blue-100"}:t>=50?{background:"bg-indigo-500",text:"text-indigo-700",icon:"bg-indigo-100"}:t>=25?{background:"bg-blue-500",text:"text-blue-700",icon:"bg-blue-100"}:{background:"bg-gray-500",text:"text-gray-700",icon:"bg-gray-100"},RV=({sessions:t,dailyGoal:a=300})=>{const s=t.filter(x=>x.completed).reduce((x,y)=>x+y.duration,0),r=Math.floor(s/60),l=Math.min(Math.round(r/a*100),100),o=Math.max(a-r,0),{icon:d,message:u,description:m,color:h}=MV(l),g=OV(l);return e.jsx(fe,{className:"p-6 bg-gradient-to-br from-white to-gray-50",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${g.icon} mt-1`,children:e.jsx(d,{className:`w-5 h-5 ${h}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold text-lg ${h}`,children:u}),e.jsx("p",{className:"text-sm text-gray-600",children:m})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex justify-between items-center",children:[e.jsxs("span",{children:["Meta diaria: ",wh(a)]}),e.jsxs("span",{className:`font-medium ${h}`,children:[l,"% completado"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Us,{value:l,className:"h-3"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Tiempo efectivo"}),e.jsx("p",{className:`text-lg font-semibold ${g.text}`,children:wh(r)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Tiempo restante"}),e.jsx("p",{className:"text-lg font-semibold text-gray-700",children:wh(o)})]})]})]}),e.jsx("div",{className:"text-center",children:l<100?e.jsxs("p",{className:"text-sm text-gray-600",children:["Te faltan ",e.jsx("span",{className:"font-medium",children:wh(o)})," para alcanzar tu meta diaria"]}):e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Felicitaciones! Has superado tu meta diaria de productividad "})})]})})},qg=1800,IV=({selectedDate:t,dailyGoalMinutes:a=300})=>{const{user:s}=st(),r=a,[l,o]=p.useState(!1),[d,u]=p.useState(null),{supported:m,permission:h,preferences:g,requestPermission:x,sendNotification:y,updatePreferences:v,startPersistentNotification:b,stopPersistentNotification:N}=vy(),{count:S,sessions:w,status:E,error:T,saveSession:D,deleteSession:k,editSession:_,addManualSession:R}=EV(t),{isOnline:L}=Au(),U=p.useCallback(async M=>{await D(M,!0),g.enabled&&h==="granted"&&y("Pomodoro completado! ",{body:"Has completado exitosamente tu sesin de concentracin",requireInteraction:!0})},[D,g,h,y]),V=p.useCallback(async M=>{await D(M,!1,{description:"Sesin interrumpida manualmente"})},[D]),{time:F,isActive:G,formattedTime:$,startTimer:z,stopTimer:H}=CV({onComplete:U,onCancel:V,selectedDate:t}),I=(qg-F)/qg*100,O=async()=>{m&&(g.enabled?v({enabled:!1}):h==="default"?o(!0):h==="granted"&&v({enabled:!0}))},Y=async()=>{await x()&&v({enabled:!0}),o(!1)},le=async()=>{E==="saving"||!L||await R()},re=M=>{u(M)},Q=async(M,W)=>{await _(M,W),u(null)},q=p.useRef(F);return p.useEffect(()=>{q.current=F},[F]),p.useEffect(()=>{!m||!g.enabled||h!=="granted"||(G?b("Pomodoro en progreso",()=>`Tiempo restante: ${uS(Math.ceil(q.current))}`):N())},[G,m,g.enabled,h,b,N]),p.useEffect(()=>()=>{N()},[N]),s?e.jsxs("div",{className:"space-y-6",children:[e.jsx(RV,{sessions:w,dailyGoal:r}),e.jsx(fe,{className:"w-full",children:e.jsxs(xe,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xs,{className:"w-5 h-5"}),e.jsx("h2",{className:"text-lg font-medium",children:"Pomodoro Timer"})]}),m&&e.jsx(P,{variant:"outline",size:"sm",onClick:O,className:"flex items-center gap-2","aria-label":g.enabled?"Desactivar notificaciones":"Activar notificaciones",children:g.enabled?e.jsxs(e.Fragment,{children:[e.jsx(zh,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Sh,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline"})]})})]}),e.jsx(TV,{count:S,onIncrement:le,disabled:E==="saving",status:E})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(kV,{time:$,isActive:G,onStart:z,onStop:H,disabled:E==="saving"}),e.jsx(AV,{progress:I,currentTime:$,totalTime:uS(qg),isActive:G})]}),e.jsx("div",{className:"mt-6",children:e.jsx(DV,{sessions:w,onEditSession:re,onDeleteSession:k})})]})}),d&&e.jsx(_V,{session:d,onClose:()=>u(null),onSave:Q}),e.jsx(Ir,{open:l,onOpenChange:o,children:e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Activar notificaciones"}),e.jsx(fr,{children:"Te gustara recibir notificaciones cuando se complete un Pomodoro? Esto te ayudar a mantenerte informado incluso cuando el navegador est en segundo plano."})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"No, gracias"}),e.jsx(pr,{onClick:Y,children:"Activar notificaciones"})]})]})}),T&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:T}),e.jsxs("div",{className:"flex justify-center items-center gap-2 text-xs p-2",children:[E==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),E==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),E==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),E==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronizacin"}),!L&&e.jsx("span",{className:"text-orange-600",children:"Offline"})]})]}):e.jsx(fe,{className:"w-full",children:e.jsx(xe,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesin para usar el temporizador Pomodoro"})})})},zV=t=>{const a=new Date(t.getFullYear(),t.getMonth(),1);a.setHours(0,0,0,0);const s=new Date(t.getFullYear(),t.getMonth()+1,0);return s.setHours(23,59,59,999),{start:a,end:s}},LV=(t,a)=>{const{user:s}=st(),{settings:r}=Si("pomodoro",{dailyWorkMinutesGoal:300}),[l,o]=p.useState([]),[d,u]=p.useState(!0),m=Number(r.dailyWorkMinutesGoal)>0?Number(r.dailyWorkMinutesGoal):0,h=Number(a)>0?Number(a):m;p.useEffect(()=>{if(!s)return;const{start:y,end:v}=zV(t),b=Ue(y),N=Ue(v);let S=!1;return(async()=>{u(!0);const{data:E,error:T}=await ac.getSessionsRange(s.id,b,N);if(S)return;if(T){console.error("Error loading monthly pomodoro progress:",T),o([]),u(!1);return}const D=new Map;E?.forEach(_=>{const R=D.get(_.date)??{workedSeconds:0,entries:0};R.workedSeconds+=_.duration||0,R.entries+=1,D.set(_.date,R)});const k=Array.from(D.entries()).map(([_,R])=>{const L=Math.floor(R.workedSeconds/60),U=h>0?L/h*100:0;return{date:_,workedMinutes:L,entries:R.entries,goalMinutes:h,percent:U,met:U>=100}}).sort((_,R)=>_.date.localeCompare(R.date));o(k),u(!1)})(),()=>{S=!0}},[h,s,t]);const g=p.useMemo(()=>s?l:[],[l,s]),x=p.useMemo(()=>new Map(g.map(y=>[y.date,y])),[g]);return{dailyStats:g,dailyStatsMap:x,loading:s?d:!1,goalMinutes:h}},PV=["L","M","X","J","V","S","D"],q0=19,Fg=2*Math.PI*q0,BV={date:"",workedMinutes:0,entries:0,goalMinutes:0,percent:0,met:!1},$V=t=>{const a=(t.getDay()+6)%7,s=new Date(t);return s.setDate(s.getDate()-a),s},HV=t=>{const s=6-(t.getDay()+6)%7,r=new Date(t);return r.setDate(r.getDate()+s),r},UV=({selectedDate:t,onDateChange:a,goalMinutes:s})=>{const[r,l]=p.useState(()=>an(t)),{dailyStatsMap:o,loading:d,goalMinutes:u}=LV(r,s),m=Ue(new Date),h=p.useMemo(()=>an(r),[r]),g=p.useMemo(()=>wu(r),[r]),x=p.useMemo(()=>{const w=$V(h),E=HV(g);return uc({start:w,end:E}).map(T=>{const D=Ue(T),k=T.getMonth()===r.getMonth(),_=o.get(D)??{...BV,date:D,goalMinutes:u};return{date:T,dateKey:D,isCurrentMonth:k,isToday:D===m,isFuture:D>m,dayNumber:T.getDate(),aggregate:_}})},[o,g,h,u,m,r]),y=p.useMemo(()=>{const w=x.filter(V=>V.isCurrentMonth),E=w.length;let T=0,D=0,k=0;w.forEach(V=>{const F=V.aggregate;F.met&&(T+=1),F.entries>0&&(D+=1,k+=F.workedMinutes)});const _=D>0?Math.round(k/D):0,R=m<Ue(g)?new Date:g,L=uc({start:h,end:R}).reverse();let U=0;for(const V of L){const F=Ue(V),G=o.get(F);if(!(!G||G.entries===0)){if(G.met){U+=1;continue}break}}return{completedDays:T,workDays:D,totalDays:E,averageMinutes:_,currentStreak:U}},[x,o,g,h,m]),v=p.useMemo(()=>Jt(r,"MMMM yyyy",{locale:As}),[r]),b=p.useCallback(()=>{l(w=>an(ey(w)))},[]),N=p.useCallback(()=>{l(w=>an(vf(w,1)))},[]),S=p.useCallback(w=>{!w.isCurrentMonth||w.isFuture||a(new Date(w.date))},[a]);return e.jsxs(fe,{className:"w-full",children:[e.jsx(xt,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(P,{variant:"ghost",size:"icon",onClick:b,className:"h-8 w-8","aria-label":"Mes anterior",children:e.jsx(kc,{className:"h-4 w-4"})}),e.jsx(mt,{className:"text-base font-semibold capitalize text-center",children:v}),e.jsx(P,{variant:"ghost",size:"icon",onClick:N,className:"h-8 w-8","aria-label":"Mes siguiente",children:e.jsx(wn,{className:"h-4 w-4"})})]})}),e.jsxs(xe,{className:"space-y-5",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 text-center text-xs font-medium text-muted-foreground",children:PV.map(w=>e.jsx("span",{children:w},w))}),e.jsx(Vs,{children:e.jsx("div",{className:"grid grid-cols-7 gap-2",children:x.map(w=>{const E=Math.max(0,Math.min(w.aggregate.percent,100)),T=Fg-E/100*Fg,D=w.isCurrentMonth&&!w.isFuture;let k="#e9ecef";return w.aggregate.entries>0&&(k=w.aggregate.percent>100?"#ff6b00":"#f08c3d"),w.isFuture&&(k="#dee2e6"),e.jsxs(va,{children:[e.jsx(ba,{asChild:!0,children:e.jsxs("button",{type:"button",onClick:()=>S(w),disabled:!D,className:he("relative flex h-12 w-12 items-center justify-center rounded-full transition-colors","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",!w.isCurrentMonth&&"opacity-45",w.isFuture&&"cursor-not-allowed opacity-55",w.isToday&&"bg-orange-500/10 ring-1 ring-orange-500/25",D&&"hover:bg-muted/60"),children:[e.jsxs("svg",{className:"absolute h-11 w-11 -rotate-90",viewBox:"0 0 48 48","aria-hidden":"true",children:[e.jsx("circle",{cx:"24",cy:"24",r:q0,fill:"none",stroke:w.isFuture?"#edf0f2":"#e9ecef",strokeWidth:"4"}),w.aggregate.entries>0&&!w.isFuture&&e.jsx("circle",{cx:"24",cy:"24",r:q0,fill:"none",stroke:k,strokeWidth:"4",strokeLinecap:"round",strokeDasharray:Fg,strokeDashoffset:T})]}),e.jsx("span",{className:he("relative z-10 text-sm font-semibold",w.isCurrentMonth?"text-foreground":"text-muted-foreground",w.aggregate.entries===0&&"text-muted-foreground",w.isFuture&&"text-muted-foreground/80"),children:w.dayNumber})]})}),e.jsxs(fa,{side:"left",className:"max-w-[220px] space-y-1 text-sm",children:[e.jsx("p",{className:"font-medium capitalize",children:Jt(w.date,"EEEE d MMMM",{locale:As})}),e.jsxs("p",{children:[w.aggregate.workedMinutes," / ",w.aggregate.goalMinutes," min"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Math.round(w.aggregate.percent),"% del objetivo"]}),w.aggregate.met&&e.jsx("p",{className:"text-xs font-medium text-green-600",children:" Objetivo cumplido"})]})]},w.dateKey)})})}),d&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cargando progreso mensual..."}),e.jsxs("div",{className:"border-t border-border pt-4",children:[e.jsx("h3",{className:"mb-3 text-sm font-semibold",children:"Estadsticas del mes"}),e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2",children:[e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Racha actual"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold text-orange-600",children:[y.currentStreak," das ",e.jsx(pi,{className:"mb-1 ml-1 inline h-4 w-4 text-orange-600"})]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Das cumplidos"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[y.completedDays," / ",y.totalDays]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa]",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Das con trabajo"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[y.workDays," / ",y.totalDays]})]})}),e.jsx(fe,{className:"border border-border bg-[#f8f9fa] sm:col-span-2 lg:col-span-1 xl:col-span-2",children:e.jsxs(xe,{className:"p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Promedio diario"}),e.jsxs("p",{className:"mt-1 text-lg font-semibold",children:[y.averageMinutes," min"]})]})})]})]})]})]})},Ik=[{key:"timer",label:"Timer"}],cC="timer",VV=({selectedDate:t,onDateChange:a,goalMinutes:s})=>e.jsxs("div",{className:"space-y-6",children:[e.jsx(jl,{selectedDate:t,onChange:a}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr)_320px]",children:[e.jsx(IV,{selectedDate:t,dailyGoalMinutes:s}),e.jsx(UV,{selectedDate:t,onDateChange:a,goalMinutes:s})]})]});function YV(){const t=it(),{viewKey:a}=Ss(),s=a||cC,[r,l]=p.useState(new Date),{user:o}=st(),{settings:d}=Si("pomodoro",{dailyWorkMinutesGoal:300}),u=Number(d.dailyWorkMinutesGoal)>0?Number(d.dailyWorkMinutesGoal):300,m=Ik.map(y=>({...y,component:VV})),h=m.find(y=>y.key===s);if(!h)return e.jsx(Ft,{to:ae.pomodoro.view(cC),replace:!0});if(!o)return e.jsx(na,{title:"Pomodoro Timer",icon:e.jsx(pi,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"p-4 text-center",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesion para ver tus estadisticas"})})});const g=[{id:"config",label:"Configuracion",icon:e.jsx(_s,{className:"h-4 w-4"}),onClick:()=>t(ae.pomodoro.config),tooltip:"Configuracion"}],x=h.component;return e.jsx(na,{title:"Pomodoro Timer",subtitle:"Gestiona tus sesiones de trabajo y productividad",icon:e.jsx(pi,{className:"h-4 w-4 text-white"}),views:m,activeViewKey:s,onViewChange:y=>t(ae.pomodoro.view(y)),actions:g,children:e.jsx("div",{className:"p-4",children:e.jsx(x,{selectedDate:r,onDateChange:l,goalMinutes:u})})})}const qV=()=>{const t=it(),a={dailyWorkMinutesGoal:300},{settings:s,saveSettings:r,status:l,error:o}=Si("pomodoro",a),[d,u]=p.useState(null);return e.jsx(na,{title:"Configuracion de Pomodoro",icon:e.jsx(pi,{className:"h-4 w-4 text-white"}),views:Ik.map(m=>({...m,component:()=>null})),onViewChange:m=>t(`/pomodoro/view/${m}`),children:e.jsx("div",{className:"p-4",children:e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{children:"Objetivo diario de trabajo"})}),e.jsxs(xe,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ce,{htmlFor:"dailyWorkMinutesGoal",children:"Minutos diarios objetivo"}),e.jsx(ye,{id:"dailyWorkMinutesGoal",type:"number",value:d??s.dailyWorkMinutesGoal,onChange:m=>u(Number(m.target.value))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{onClick:()=>r({dailyWorkMinutesGoal:d??s.dailyWorkMinutesGoal}),children:"Guardar"}),l==="saving"&&e.jsx("span",{className:"text-xs text-gray-500",children:"Guardando..."}),l==="saved"&&e.jsx("span",{className:"text-xs text-green-600",children:"Guardado"}),o&&e.jsx("span",{className:"text-xs text-red-600",children:o})]})]})]})})})},FV={module:"pomodoro",defaultRoute:ae.pomodoro.view(ae.pomodoro.defaultView),moduleRoutes:[{path:"pomodoro",element:e.jsx(Ft,{to:ae.pomodoro.view(ae.pomodoro.defaultView),replace:!0})},{path:"pomodoro/view/:viewKey",element:e.jsx(YV,{})},{path:"pomodoro/config",element:e.jsx(qV,{})}]};class Pn{static client=ze;static table(a){return ze.from(a)}}const GV=()=>{const{user:t}=st(),[a,s]=p.useState([]),[r,l]=p.useState("idle"),[o,d]=p.useState(null),u=p.useCallback(async()=>{if(t){l("loading"),d(null);try{const{data:E,error:T}=await Pn.table("goals").select("*").eq("user_id",t.id);if(T)throw T;const D=(E||[]).map(z=>z.id),k=async z=>{if(D.length===0)return{data:[],error:null};const H=await Pn.table(z).select("*").in("goal_id",D);return H.status===404?{data:[],error:null}:H},_=D.length===0?Promise.resolve({data:[],error:null}):Pn.table("tasks").select("id, goal_id, title, completed, created_at, updated_at").eq("user_id",t.id).in("goal_id",D),[R,L,U]=await Promise.all([_,k("goal_entries"),k("goal_numeric_entries")]);if(R.error)throw R.error;const V={},F={},G={};(R.data||[]).forEach(z=>{V[z.goal_id]||(V[z.goal_id]=[]),V[z.goal_id].push({id:z.id,title:z.title,done:!!z.completed,createdAt:z.created_at,completedAt:z.completed&&z.updated_at||null})}),(L.data||[]).forEach(z=>{F[z.goal_id]||(F[z.goal_id]=[]),F[z.goal_id].push({text:z.text,date:z.date,isMilestone:z.is_milestone})}),(U.data||[]).forEach(z=>{G[z.goal_id]||(G[z.goal_id]=[]),G[z.goal_id].push({value:z.value,date:z.date,note:z.note})});const $=(E||[]).map(z=>({id:z.id,userId:z.user_id,title:z.title,description:z.description,status:z.status,startDate:z.start_date||null,dueDate:z.due_date||null,tasks:V[z.id]||[],entries:F[z.id]||[],positiveCount:z.positive_count||0,negativeCount:z.negative_count||0,numericGoal:z.numeric_goal||void 0,numericEntries:G[z.id]||[],createdAt:z.created_at,updatedAt:z.updated_at}));s($),l("idle")}catch(E){d(E instanceof Error?E.message:"Error al cargar"),l("error")}}},[t]);p.useEffect(()=>{if(!t){s([]);return}u()},[t,u]);const m=async E=>{if(t){l("saving"),d(null);try{const{data:T,error:D}=await Pn.table("goals").insert({user_id:t.id,title:E.title,description:E.description||null,status:E.status,start_date:E.startDate||null,due_date:E.dueDate||null,positive_count:0,negative_count:0,numeric_goal:E.numericGoal||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(D)throw D;s(k=>[...k,{...E,id:T.id,userId:t.id,positiveCount:0,negativeCount:0,numericEntries:[],createdAt:T.created_at,updatedAt:T.updated_at}]),l("idle")}catch(T){d(T instanceof Error?T.message:"Error al guardar"),l("error")}}},h=async(E,T)=>{if(!t)return;l("saving"),d(null);const D=a.find(_=>_.id===E);if(!D)return;const k={...D,...T};s(_=>_.map(R=>R.id===E?k:R));try{const _={updated_at:new Date().toISOString()};T.title!==void 0&&(_.title=T.title),T.description!==void 0&&(_.description=T.description),T.status!==void 0&&(_.status=T.status),T.startDate!==void 0&&(_.start_date=T.startDate),T.dueDate!==void 0&&(_.due_date=T.dueDate),T.positiveCount!==void 0&&(_.positive_count=T.positiveCount),T.negativeCount!==void 0&&(_.negative_count=T.negativeCount),T.numericGoal!==void 0&&(_.numeric_goal=T.numericGoal);const{error:R}=await Pn.table("goals").update(_).eq("id",E);if(R)throw R;l("idle")}catch(_){s(R=>R.map(L=>L.id===E?D:L)),d(_ instanceof Error?_.message:"Error al actualizar"),l("error")}};return{goals:a,status:r,error:o,addGoal:m,updateGoal:h,addTask:async(E,T)=>{if(!(!a.find(k=>k.id===E)||!t))try{const k=await Iy(t.id),{error:_}=await Pn.table("tasks").insert({user_id:t.id,goal_id:E,task_code:k,title:T,completed:!1,category:"other",priority:"delete",size:"pequea",progress:0,is_private:!1,is_recurrent:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});if(_)throw _;await u()}catch(k){d(k instanceof Error?k.message:"Error al agregar tarea"),l("error")}},toggleTask:async(E,T,D)=>{const k=a.find(R=>R.id===E);if(!k||!t)return;const _=k.tasks[D];if(_)try{let R=T||_.id;if(!R){const{data:U}=await Pn.table("tasks").select("id").eq("user_id",t.id).eq("goal_id",E).eq("title",_.title).order("created_at",{ascending:!0});if(!U||U.length<=D)return;R=U[D].id}const{error:L}=await Pn.table("tasks").update({completed:!_.done,updated_at:new Date().toISOString()}).eq("id",R);if(L)throw L;await u()}catch(R){d(R instanceof Error?R.message:"Error al actualizar tarea"),l("error")}},editTask:async(E,T,D)=>{if(!(!a.find(_=>_.id===E)||!t||!T))try{const{error:_}=await Pn.table("tasks").update({title:D.trim(),updated_at:new Date().toISOString()}).eq("id",T).eq("user_id",t.id);if(_)throw _;await u()}catch(_){d(_ instanceof Error?_.message:"Error al actualizar tarea"),l("error")}},deleteTask:async(E,T)=>{if(!(!a.find(k=>k.id===E)||!t||!T))try{const{error:k}=await Pn.table("tasks").delete().eq("id",T).eq("user_id",t.id);if(k)throw k;await u()}catch(k){d(k instanceof Error?k.message:"Error al eliminar tarea"),l("error")}},addEntry:async(E,T)=>{if(!(!a.find(k=>k.id===E)||!t))try{const{error:k}=await Pn.table("goal_entries").insert({goal_id:E,text:T.text,date:T.date||new Date().toISOString(),is_milestone:T.isMilestone});if(k)throw k;await u()}catch(k){d(k instanceof Error?k.message:"Error al agregar entrada"),l("error")}},incrementPositiveCount:async E=>{const T=a.find(k=>k.id===E);if(!T||!t)return;const D=(T.positiveCount||0)+1;await h(E,{positiveCount:D})},incrementNegativeCount:async E=>{const T=a.find(k=>k.id===E);if(!T||!t)return;const D=(T.negativeCount||0)+1;await h(E,{negativeCount:D})},addNumericEntry:async(E,T)=>{const D=a.find(k=>k.id===E);if(!(!D||!t))try{const{error:k}=await Pn.table("goal_numeric_entries").insert({goal_id:E,value:T.value,date:T.date||new Date().toISOString(),note:T.note||null});if(k)throw k;const _=D.numericGoal?{...D.numericGoal,currentValue:T.value}:void 0;await h(E,{numericGoal:_}),await u()}catch(k){d(k instanceof Error?k.message:"Error al agregar entrada numrica"),l("error")}},loadGoals:u}},WV=({goals:t,onSelect:a,onIncrementPositive:s,onIncrementNegative:r,onEdit:l})=>{if(t.length===0)return e.jsx(fe,{className:"p-6 text-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx(Ac,{className:"h-12 w-12 text-gray-400"}),e.jsxs("div",{children:[e.jsx(mt,{className:"text-lg text-gray-600",children:"No hay objetivos"}),e.jsx(il,{className:"mt-2",children:"Comienza creando tu primer objetivo para alcanzar tus metas"})]})]})});const o=(h,g)=>{if(h===g)return 100;if(h>g){const y=g===0?0:(h-g)/h*100;return Math.max(0,Math.min(100,100-y))}else{const y=g===0?0:h/g*100;return Math.max(0,Math.min(100,y))}},d=h=>{switch(h){case"completed":return"default";case"active":return"secondary";case"abandoned":return"destructive";default:return"outline"}},u=h=>{switch(h){case"completed":return e.jsx(xi,{className:"h-3 w-3"});case"active":return e.jsx(xs,{className:"h-3 w-3"});case"abandoned":return e.jsx(a1,{className:"h-3 w-3"});default:return null}},m=h=>{switch(h){case"completed":return"Completado";case"active":return"Activo";case"abandoned":return"Abandonado";default:return h}};return e.jsx(fe,{children:e.jsxs(xe,{className:"p-0",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 p-4 bg-gray-50 border-b text-sm font-medium text-gray-700",children:[e.jsx("div",{className:"col-span-4",children:"Objetivo"}),e.jsx("div",{className:"col-span-2 text-center",children:"Estado"}),e.jsx("div",{className:"col-span-2 text-center",children:"Progreso"}),e.jsx("div",{className:"col-span-2 text-center",children:"Fecha Lmite"}),e.jsx("div",{className:"col-span-2 text-center",children:"Acciones"})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:t.map((h,g)=>{const x=h.tasks.filter(w=>w.done).length,y=h.tasks.length,v=y>0?x/y*100:0,b=h.numericGoal?.enabled,N=b?o(h.numericGoal.currentValue,h.numericGoal.targetValue):0,S=b?N:v;return e.jsxs("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${g%2===0?"bg-white":"bg-gray-50/50"}`,onClick:()=>a(h.id),children:[e.jsxs("div",{className:"md:hidden space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:u(h.status)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:h.title}),h.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1",children:h.description})]})]}),e.jsx(wt,{variant:d(h.status),className:"text-xs",children:e.jsx("span",{children:m(h.status)})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:b?"Meta":"Tareas"}),e.jsx("span",{className:"font-medium",children:b?`${Math.round(N)}%`:`${x}/${y}`})]}),e.jsx(Us,{value:S,className:"h-2"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:[y," tareas"]}),h.entries.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[h.entries.length," avances"]})]}),h.dueDate&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx("span",{children:new Date(h.dueDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:w=>{w.stopPropagation(),s(h.id)},className:"h-6 w-6 p-0 text-green-600",children:e.jsx(c0,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-xs text-green-600",children:h.positiveCount||0}),e.jsx(P,{variant:"ghost",size:"sm",onClick:w=>{w.stopPropagation(),r(h.id)},className:"h-6 w-6 p-0 text-red-600",children:e.jsx(Oh,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-xs text-red-600",children:h.negativeCount||0}),e.jsx(P,{variant:"ghost",size:"sm",onClick:w=>{w.stopPropagation(),l(h)},className:"h-6 w-6 p-0 text-blue-600 ml-1",children:e.jsx(Vn,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4",children:[e.jsx("div",{className:"col-span-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:u(h.status)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:h.title}),h.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1",children:h.description}),e.jsx("div",{className:"flex items-center gap-3 mt-1",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsxs("span",{children:[y," tareas"]}),h.entries.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:[h.entries.length," avances"]})]})]})})]})]})}),e.jsx("div",{className:"col-span-2 flex justify-center",children:e.jsx(wt,{variant:d(h.status),className:"text-xs",children:e.jsx("span",{children:m(h.status)})})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:b?"Meta":"Tareas"}),e.jsx("span",{className:"font-medium",children:b?`${Math.round(N)}%`:`${x}/${y}`})]}),e.jsx(Us,{value:S,className:"h-2"})]})}),e.jsx("div",{className:"col-span-2 flex justify-center items-center",children:h.dueDate?e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-600",children:[e.jsx(Aa,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(h.dueDate).toLocaleDateString()})]}):e.jsx("span",{className:"text-xs text-gray-400",children:"Sin fecha"})}),e.jsxs("div",{className:"col-span-2 flex justify-center items-center gap-1",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:w=>{w.stopPropagation(),s(h.id)},className:"h-7 w-7 p-0 text-green-600 hover:text-green-700 hover:bg-green-50",title:"Voto positivo",children:e.jsx(c0,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-xs text-green-600 min-w-[1rem] text-center",children:h.positiveCount||0}),e.jsx(P,{variant:"ghost",size:"sm",onClick:w=>{w.stopPropagation(),r(h.id)},className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Voto negativo",children:e.jsx(Oh,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-xs text-red-600 min-w-[1rem] text-center",children:h.negativeCount||0}),e.jsx(P,{variant:"ghost",size:"sm",onClick:w=>{w.stopPropagation(),l(h)},className:"h-7 w-7 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50 ml-1",title:"Editar objetivo",children:e.jsx(Vn,{className:"h-3 w-3"})}),e.jsx(P,{variant:"ghost",size:"sm",onClick:w=>{w.stopPropagation(),a(h.id)},className:"h-7 w-7 p-0 text-gray-600 hover:text-gray-700 hover:bg-gray-100",title:"Ver detalles",children:e.jsx(Cu,{className:"h-3 w-3"})})]})]})]},h.id)})})]})})};var KV=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],XV=KV.reduce((t,a)=>{const s=Tf(`Primitive.${a}`),r=p.forwardRef((l,o)=>{const{asChild:d,...u}=l,m=d?s:a;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...u,ref:o})});return r.displayName=`Primitive.${a}`,{...t,[a]:r}},{}),QV="Separator",dC="horizontal",ZV=["horizontal","vertical"],zk=p.forwardRef((t,a)=>{const{decorative:s,orientation:r=dC,...l}=t,o=JV(r)?r:dC,u=s?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return e.jsx(XV.div,{"data-orientation":o,...u,...l,ref:a})});zk.displayName=QV;function JV(t){return ZV.includes(t)}var Lk=zk;const lu=p.forwardRef(({className:t,orientation:a="horizontal",decorative:s=!0,...r},l)=>e.jsx(Lk,{ref:l,decorative:s,orientation:a,className:he("shrink-0 bg-border",a==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));lu.displayName=Lk.displayName;const eY=async(t,a,s)=>{const r="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",l=`https://generativelanguage.googleapis.com/v1beta/models/${a.model}:generateContent`,d={contents:[{parts:[{text:a.prompt?`${a.prompt}

${t}`:t}]}],generationConfig:{temperature:s?.temperature??a.params?.temperature??.7,topP:s?.topP??a.params?.top_p??.8,maxOutputTokens:s?.maxOutputTokens??4096,candidateCount:1}};try{const u=await fetch(`${l}?key=${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!u.ok){const h=await u.json().catch(()=>({}));throw new Error(`Error en la API de Gemini (${u.status}): ${h.error?.message||u.statusText}`)}const m=await u.json();if(!m.candidates?.[0]?.content?.parts?.[0]?.text)throw new Error("Respuesta invlida de la API de Gemini");return m.candidates[0].content.parts[0].text.trim()}catch(u){throw u instanceof Error?u:new Error(`Error inesperado al generar respuesta AI: ${String(u)}`)}},tY=({goal:t,isOpen:a,onClose:s})=>{const[r,l]=p.useState(""),[o,d]=p.useState(""),[u,m]=p.useState(!1),[h,g]=p.useState(null),[x,y]=p.useState(0);p.useEffect(()=>{if(a){const N=t.tasks.filter(_=>_.done).length,S=t.tasks.length,w=S>0?Math.round(N/S*100):0,E=t.numericGoal?.enabled?`
Meta numrica: ${t.numericGoal.currentValue.toLocaleString()} / ${t.numericGoal.targetValue.toLocaleString()} ${t.numericGoal.unit} (${Math.round(t.numericGoal.currentValue/t.numericGoal.targetValue*100)}% completado)`:"",T=t.tasks.length>0?`
Tareas actuales:
${t.tasks.map((_,R)=>`${R+1}. ${_.title} ${_.done?"":""}`).join(`
`)}`:`
No hay tareas definidas an.`,D=t.entries.length>0?`
Avances registrados:
${t.entries.slice(-5).map((_,R)=>`${R+1}. ${_.text} ${_.isMilestone?"":""} (${new Date(_.date).toLocaleDateString()})`).join(`
`)}`:`
No hay avances registrados an.`,k=`OBJETIVO: ${t.title}
${t.description?`DESCRIPCIN: ${t.description}`:""}
ESTADO: ${t.status}
PROGRESO DE TAREAS: ${w}% (${N}/${S} completadas)${E}
FECHA LMITE: ${t.dueDate?new Date(t.dueDate).toLocaleDateString():"No definida"}
${T}
${D}

Por favor, sugiere tareas especficas y accionables que me ayuden a avanzar hacia este objetivo. Considera el progreso actual y las tareas existentes para evitar duplicados.`;d(k)}else d(""),l(""),g(null)},[a,t]),p.useEffect(()=>{y(zr(o))},[o]);const v=async()=>{if(o){m(!0),g(null);try{const N={...Zd.goals,prompt:Zd.goals.prompts?.taskSuggestions},S=await eY(o,N,{temperature:Zd.goals.params?.temperature,topP:Zd.goals.params?.top_p});l(S)}catch(N){g(N instanceof Error?N.message:"Error al generar sugerencias"),console.error("Error generating AI suggestions:",N)}finally{m(!1)}}},b=()=>{l(""),d(""),g(null),y(0),s()};return e.jsx(Mt,{open:a,onOpenChange:N=>N?s():b(),children:e.jsxs(Tt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(Ot,{className:"flex-shrink-0",children:[e.jsxs(Rt,{className:"flex items-center gap-2",children:[e.jsx(oi,{className:"h-5 w-5 text-purple-600"}),'Sugerencias de IA para "',t.title,'"']}),e.jsx(Ms,{children:"Obtn ideas inteligentes para tareas que te ayuden a completar tu objetivo"})]}),e.jsx(fe,{className:"flex-shrink-0",children:e.jsx(xe,{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:"Resumen del objetivo"}),e.jsxs(wt,{variant:"secondary",children:[t.tasks.filter(N=>N.done).length,"/",t.tasks.length," tareas"]})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600",children:t.description}),t.numericGoal?.enabled&&e.jsxs("p",{className:"text-sm text-blue-600",children:["Meta: ",t.numericGoal.currentValue.toLocaleString()," / ",t.numericGoal.targetValue.toLocaleString()," ",t.numericGoal.unit]})]})})}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(sa,{value:o,onChange:N=>d(N.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Contexto del objetivo..."})]}),e.jsxs("div",{className:"flex-shrink-0 space-y-3",children:[e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",x," ",x>3500&&e.jsx("span",{className:"text-red-500",children:"Prompt demasiado largo!"})]}),e.jsxs(P,{onClick:v,disabled:u||!1||x>3500,className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[u&&e.jsx(hs,{className:"w-4 h-4 animate-spin"}),e.jsx(oi,{className:"h-4 w-4"}),u?"Generando sugerencias...":"Generar sugerencias con IA"]}),u&&e.jsx(yi,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between flex-shrink-0",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(oi,{className:"h-4 w-4 text-purple-600"}),"Sugerencias de tareas"]}),r&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{type:"button",size:"icon",variant:"ghost",onClick:()=>{navigator.clipboard.writeText(r),ut.success("Sugerencias copiadas")},children:e.jsx(Rr,{className:"w-4 h-4"})}),e.jsxs(P,{variant:"outline",size:"sm",onClick:v,disabled:u,children:[e.jsx(io,{className:"h-3 w-3 mr-1"}),"Regenerar"]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:h?e.jsx(fe,{className:"border-red-200 bg-red-50",children:e.jsxs(xe,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx("span",{className:"font-medium",children:"Error:"}),e.jsx("span",{className:"text-sm",children:h})]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:v,className:"mt-2",children:[e.jsx(io,{className:"h-3 w-3 mr-1"}),"Reintentar"]})]})}):r?e.jsx(sa,{readOnly:!0,value:r,className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0 whitespace-pre-wrap"}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 text-sm",children:"Las sugerencias aparecern aqu una vez generadas"})})]})]}),e.jsx("div",{className:"flex justify-end space-x-2 pt-4 flex-shrink-0",children:e.jsx(P,{variant:"outline",onClick:b,children:"Cerrar"})})]})})},aY=({goal:t,onAddTask:a,onToggleTask:s,onEditTask:r,onDeleteTask:l,onAddEntry:o,onIncrementPositive:d,onIncrementNegative:u,onAddNumericEntry:m,onEdit:h})=>{const g=(K,oe)=>{if(K===oe)return 100;if(K>oe){const je=oe===0?0:(K-oe)/K*100;return Math.max(0,Math.min(100,100-je))}else{const je=oe===0?0:K/oe*100;return Math.max(0,Math.min(100,je))}},[x,y]=p.useState(""),[v,b]=p.useState(""),[N,S]=p.useState(new Date().toISOString().split("T")[0]),[w,E]=p.useState(!1),[T,D]=p.useState(""),[k,_]=p.useState(""),[R,L]=p.useState(new Date().toISOString().split("T")[0]),[U,V]=p.useState(!1),[F,G]=p.useState(null),[$,z]=p.useState(""),H=t.tasks.filter(K=>K.done).length,I=t.tasks.length,O=I>0?H/I*100:0,Y=K=>{switch(K){case"completed":return"default";case"active":return"secondary";case"abandoned":return"destructive";default:return"outline"}},le=K=>{switch(K){case"completed":return e.jsx(d0,{className:"h-4 w-4"});case"active":return e.jsx(xs,{className:"h-4 w-4"});case"abandoned":return e.jsx(Ac,{className:"h-4 w-4"});default:return null}},re=K=>{switch(K){case"completed":return"Completado";case"active":return"Activo";case"abandoned":return"Abandonado";default:return K}},Q=()=>{x.trim()&&(a(x.trim()),y(""))},q=(K,oe)=>{G(K),z(oe)},M=()=>{G(null),z("")},W=()=>{if(!F)return;const K=$.trim();K&&(r(F,K),M())},ie=()=>{v.trim()&&(o(v.trim(),N,w),b(""),S(new Date().toISOString().split("T")[0]),E(!1))},ve=()=>{const K=parseFloat(T);!isNaN(K)&&K>=0&&(m(K,k.trim()||void 0,R),D(""),_(""),L(new Date().toISOString().split("T")[0]))};return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(fe,{children:e.jsx(xt,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(mt,{className:"text-xl",children:t.title}),t.description&&e.jsx(il,{className:"mt-2",children:t.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wt,{variant:Y(t.status),children:e.jsxs("div",{className:"flex items-center gap-1",children:[le(t.status),e.jsx("span",{children:re(t.status)})]})}),e.jsx(P,{variant:"outline",size:"sm",onClick:h,children:e.jsx(Vn,{className:"h-4 w-4"})})]})]})})}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(mt,{className:"flex items-center gap-2",children:[e.jsx(Rh,{className:"h-5 w-5"}),"Tareas"]}),e.jsxs(il,{children:[H," de ",I," tareas completadas"]})]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>V(!0),className:"bg-gradient-to-r from-purple-50 to-blue-50 hover:from-purple-100 hover:to-blue-100 border-purple-200",children:[e.jsx(oi,{className:"h-4 w-4 mr-2 text-purple-600"}),e.jsx("span",{className:"text-purple-700",children:"Ideas con IA"})]})]})}),e.jsxs(xe,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Us,{value:O,className:"h-2"}),e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:[Math.round(O),"% completado"]})]}),e.jsx("div",{className:"space-y-2",children:t.tasks.length>0?t.tasks.map((K,oe)=>{const _e=F===K.id;return e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded hover:bg-gray-50",children:[e.jsx(Va,{id:`task-${oe}`,checked:K.done,onCheckedChange:()=>s(K.id,oe),disabled:_e}),_e?e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx(ye,{value:$,onChange:je=>z(je.target.value),onKeyDown:je=>{je.key==="Enter"&&W(),je.key==="Escape"&&M()},className:"h-8"}),e.jsx(P,{variant:"ghost",size:"icon",onClick:W,disabled:!$.trim(),children:e.jsx(cr,{className:"h-4 w-4"})}),e.jsx(P,{variant:"ghost",size:"icon",onClick:M,children:e.jsx(Fa,{className:"h-4 w-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{htmlFor:`task-${oe}`,className:`flex-1 cursor-pointer ${K.done?"line-through text-gray-500":""}`,children:K.title}),e.jsx(P,{variant:"ghost",size:"icon",onClick:()=>K.id&&q(K.id,K.title),disabled:!K.id,children:e.jsx(lo,{className:"h-4 w-4"})}),e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"icon",disabled:!K.id,children:e.jsx(Sn,{className:"h-4 w-4 text-red-500"})})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Eliminar tarea?"}),e.jsx(fr,{children:"Esta accion no se puede deshacer."})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"Cancelar"}),e.jsx(pr,{onClick:()=>K.id&&l(K.id),className:"bg-red-600 text-white hover:bg-red-700",children:"Eliminar"})]})]})]}),K.done&&e.jsx(d0,{className:"h-4 w-4 text-green-500"})]})]},K.id||oe)}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No hay tareas an. Agrega la primera tarea para empezar."})}),e.jsx(lu,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"new-task",children:"Nueva tarea"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ye,{id:"new-task",value:x,onChange:K=>y(K.target.value),placeholder:"Escribe una nueva tarea...",onKeyPress:K=>K.key==="Enter"&&Q()}),e.jsx(P,{onClick:Q,disabled:!x.trim(),children:e.jsx(It,{className:"h-4 w-4"})})]})]})]})]}),t.numericGoal?.enabled&&e.jsxs(fe,{children:[e.jsxs(xt,{children:[e.jsxs(mt,{className:"flex items-center gap-2",children:[e.jsx(iw,{className:"h-5 w-5"}),"Meta Numrica"]}),e.jsxs(il,{children:["Progreso hacia ",t.numericGoal.targetValue.toLocaleString()," ",t.numericGoal.unit]})]}),e.jsxs(xe,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Progreso"}),e.jsxs("span",{className:"font-medium",children:[t.numericGoal.currentValue.toLocaleString()," / ",t.numericGoal.targetValue.toLocaleString()," ",t.numericGoal.unit]})]}),e.jsx(Us,{value:g(t.numericGoal.currentValue,t.numericGoal.targetValue),className:"h-3"}),e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:[Math.round(g(t.numericGoal.currentValue,t.numericGoal.targetValue)),"% completado"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ce,{className:"text-sm font-medium",children:"Historial de valores"}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:t.numericEntries&&t.numericEntries.length>0?t.numericEntries.sort((K,oe)=>new Date(oe.date).getTime()-new Date(K.date).getTime()).map((K,oe)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg border bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[K.value.toLocaleString()," ",t.numericGoal.unit]}),K.note&&e.jsxs("span",{className:"text-xs text-gray-500",children:["- ",K.note]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(K.date).toLocaleDateString()})]},oe)):e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No hay registros numricos an"})})]}),e.jsx(lu,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ce,{htmlFor:"numeric-value",children:"Actualizar valor"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(ye,{id:"numeric-value",type:"number",min:"0",step:"0.01",value:T,onChange:K=>D(K.target.value),placeholder:`Valor en ${t.numericGoal.unit}`}),e.jsx(ye,{type:"date",value:R,onChange:K=>L(K.target.value)})]}),e.jsx(ye,{value:k,onChange:K=>_(K.target.value),placeholder:"Nota opcional..."}),e.jsxs(P,{onClick:ve,disabled:!T||isNaN(parseFloat(T)),className:"w-full",children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"Registrar valor"]})]})]})]}),e.jsxs(fe,{children:[e.jsxs(xt,{children:[e.jsxs(mt,{className:"flex items-center gap-2",children:[e.jsx(Ih,{className:"h-5 w-5"}),"Historial de Avances"]}),e.jsx(il,{children:"Registra tu progreso y logros importantes"})]}),e.jsxs(xe,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:t.entries.length>0?t.entries.sort((K,oe)=>new Date(oe.date).getTime()-new Date(K.date).getTime()).map((K,oe)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg border bg-gray-50",children:[e.jsx("div",{className:"flex-shrink-0",children:K.isMilestone?e.jsx(j1,{className:"h-4 w-4 text-yellow-500 mt-1"}):e.jsx(Aa,{className:"h-4 w-4 text-gray-400 mt-1"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm",children:K.text}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(K.date).toLocaleDateString()})]}),K.isMilestone&&e.jsx(wt,{variant:"secondary",className:"text-xs",children:"Hito"})]},oe)):e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No hay avances registrados. Comparte tu progreso aqu."})}),e.jsx(lu,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ce,{htmlFor:"new-entry",children:"Nuevo avance"}),e.jsx(sa,{id:"new-entry",value:v,onChange:K=>b(K.target.value),placeholder:"Describe tu progreso...",className:"min-h-[60px]"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{htmlFor:"entry-date",className:"text-sm",children:"Fecha:"}),e.jsx(ye,{id:"entry-date",type:"date",value:N,onChange:K=>S(K.target.value),className:"w-auto"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Va,{id:"milestone",checked:w,onCheckedChange:K=>E(K)}),e.jsx(Ce,{htmlFor:"milestone",className:"text-sm",children:"Marcar como hito"})]})]}),e.jsxs(P,{onClick:ie,disabled:!v.trim(),children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"Registrar avance"]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{className:"text-lg",children:"Estadsticas"})}),e.jsxs(xe,{className:"space-y-4",children:[(t.startDate||t.dueDate)&&e.jsxs("div",{className:"space-y-2",children:[t.startDate&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Aa,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Inicio:"}),e.jsx("span",{children:new Date(t.startDate).toLocaleDateString()})]}),t.dueDate&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Aa,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Lmite:"}),e.jsx("span",{children:new Date(t.dueDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Rh,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Tareas:"}),e.jsxs("span",{children:[H,"/",I]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ih,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Avances:"}),e.jsx("span",{children:t.entries.length})]}),t.numericGoal?.enabled&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(iw,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Progreso:"}),e.jsxs("span",{children:[Math.round(g(t.numericGoal.currentValue,t.numericGoal.targetValue)),"%"]})]})]})]})]}),e.jsxs(fe,{children:[e.jsxs(xt,{children:[e.jsx(mt,{className:"text-lg",children:"Motivacin"}),e.jsx(il,{children:"Registra tu estado de nimo hacia este objetivo"})]}),e.jsx(xe,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(P,{variant:"outline",className:"flex-1",onClick:d,children:[e.jsx(c0,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t.positiveCount||0})]}),e.jsxs(P,{variant:"outline",className:"flex-1",onClick:u,children:[e.jsx(Oh,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:t.negativeCount||0})]})]})})]})]}),e.jsx(tY,{goal:t,isOpen:U,onClose:()=>V(!1)})]})},uC=({goal:t,isOpen:a,onClose:s,onSave:r})=>{const[l,o]=p.useState({title:t?.title||"",description:t?.description||"",status:t?.status||"active",startDate:t?.startDate||"",dueDate:t?.dueDate||""}),[d,u]=p.useState({enabled:t?.numericGoal?.enabled||!1,targetValue:t?.numericGoal?.targetValue||0,currentValue:t?.numericGoal?.currentValue||0,unit:t?.numericGoal?.unit||"",unitType:t?.numericGoal?.unitType||"quantity"}),[m,h]=p.useState(!1),[g,x]=p.useState({});p.useEffect(()=>{o({title:t?.title||"",description:t?.description||"",status:t?.status||"active",startDate:t?.startDate||"",dueDate:t?.dueDate||""}),u({enabled:t?.numericGoal?.enabled||!1,targetValue:t?.numericGoal?.targetValue||0,currentValue:t?.numericGoal?.currentValue||0,unit:t?.numericGoal?.unit||"",unitType:t?.numericGoal?.unitType||"quantity"}),x({})},[t]);const y=()=>{const w={};if(l.title.trim()||(w.title="El ttulo es requerido"),l.startDate&&l.dueDate){const E=new Date(l.startDate),T=new Date(l.dueDate);E>T&&(w.dueDate="La fecha lmite debe ser posterior a la fecha de inicio")}return d.enabled&&(d.targetValue<=0&&(w.targetValue="El valor objetivo debe ser mayor a 0"),d.unit.trim()||(w.unit="La unidad es requerida para metas numricas"),d.currentValue<0&&(w.currentValue="El valor actual no puede ser negativo")),x(w),Object.keys(w).length===0},v=async w=>{if(w.preventDefault(),!!y()){h(!0);try{await r({...l,description:l.description.trim()||void 0,startDate:l.startDate||null,dueDate:l.dueDate||null,numericGoal:d.enabled?d:void 0,numericEntries:t?.numericEntries||[]}),s()}catch(E){console.error("Error saving goal:",E)}finally{h(!1)}}},b=()=>{const w=l.title.trim().length>0,E=!d.enabled||d.targetValue>0&&d.unit.trim().length>0;return w&&E&&Object.keys(g).length===0},N=()=>{o({title:t?.title||"",description:t?.description||"",status:t?.status||"active",startDate:t?.startDate||"",dueDate:t?.dueDate||""}),u({enabled:t?.numericGoal?.enabled||!1,targetValue:t?.numericGoal?.targetValue||0,currentValue:t?.numericGoal?.currentValue||0,unit:t?.numericGoal?.unit||"",unitType:t?.numericGoal?.unitType||"quantity"}),x({}),s()},S=w=>{switch(w){case"currency":return"Ej: COP, USD, EUR";case"weight":return"Ej: kg, lb, g";case"quantity":return"Ej: unidades, piezas";case"percentage":return"%";case"custom":return"Ej: horas, das";default:return"Unidad"}};return e.jsx(Mt,{open:a,onOpenChange:N,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ot,{children:[e.jsxs(Rt,{className:"flex items-center gap-2",children:[e.jsx(Ac,{className:"h-5 w-5"}),t?"Editar objetivo":"Crear nuevo objetivo"]}),e.jsx(Ms,{children:t?"Modifica los detalles de tu objetivo":"Define un nuevo objetivo para alcanzar tus metas"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"title",children:"Ttulo *"}),e.jsx(ye,{id:"title",value:l.title,onChange:w=>{o({...l,title:w.target.value}),g.title&&w.target.value.trim()&&x({...g,title:""})},placeholder:"Ej. Aprender React avanzado",className:g.title?"border-destructive":"",required:!0}),g.title&&e.jsx("p",{className:"text-sm text-destructive",children:g.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"description",children:"Descripcin"}),e.jsx(sa,{id:"description",value:l.description,onChange:w=>o({...l,description:w.target.value}),placeholder:"Describe tu objetivo con ms detalle...",className:"min-h-[80px]"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"status",children:"Estado"}),e.jsxs(yt,{value:l.status,onValueChange:w=>o({...l,status:w}),children:[e.jsx(ft,{children:e.jsx(vt,{})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"active",children:"Activo"}),e.jsx(Le,{value:"completed",children:"Completado"}),e.jsx(Le,{value:"abandoned",children:"Abandonado"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"startDate",children:"Fecha de inicio"}),e.jsx(ye,{id:"startDate",type:"date",value:l.startDate,onChange:w=>o({...l,startDate:w.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"dueDate",children:"Fecha lmite"}),e.jsx(ye,{id:"dueDate",type:"date",value:l.dueDate,onChange:w=>o({...l,dueDate:w.target.value}),className:g.dueDate?"border-destructive":""}),g.dueDate&&e.jsx("p",{className:"text-sm text-destructive",children:g.dueDate})]})]}),e.jsx(lu,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Va,{id:"numericGoal",checked:d.enabled,onCheckedChange:w=>u({...d,enabled:w})}),e.jsxs(Ce,{htmlFor:"numericGoal",className:"flex items-center gap-2",children:[e.jsx(Ih,{className:"h-4 w-4"}),"Agregar meta numrica"]})]}),d.enabled&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"targetValue",children:"Valor objetivo *"}),e.jsx(ye,{id:"targetValue",type:"number",min:"0",step:"0.01",value:d.targetValue,onChange:w=>{const E=parseFloat(w.target.value)||0;u({...d,targetValue:E}),g.targetValue&&E>0&&x({...g,targetValue:""})},placeholder:"Ej: 2000000",className:g.targetValue?"border-destructive":"",required:d.enabled}),g.targetValue&&e.jsx("p",{className:"text-sm text-destructive",children:g.targetValue})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"currentValue",children:"Valor actual"}),e.jsx(ye,{id:"currentValue",type:"number",min:"0",step:"0.01",value:d.currentValue,onChange:w=>u({...d,currentValue:parseFloat(w.target.value)||0}),placeholder:"Ej: 500000",className:g.currentValue?"border-destructive":""}),g.currentValue&&e.jsx("p",{className:"text-sm text-destructive",children:g.currentValue})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"unitType",children:"Tipo de unidad"}),e.jsxs(yt,{value:d.unitType,onValueChange:w=>u({...d,unitType:w,unit:""}),children:[e.jsx(ft,{children:e.jsx(vt,{})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"currency",children:"Moneda"}),e.jsx(Le,{value:"weight",children:"Peso"}),e.jsx(Le,{value:"quantity",children:"Cantidad"}),e.jsx(Le,{value:"percentage",children:"Porcentaje"}),e.jsx(Le,{value:"custom",children:"Personalizada"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"unit",children:"Unidad *"}),e.jsx(ye,{id:"unit",value:d.unit,onChange:w=>{u({...d,unit:w.target.value}),g.unit&&w.target.value.trim()&&x({...g,unit:""})},placeholder:S(d.unitType),className:g.unit?"border-destructive":"",required:d.enabled}),g.unit&&e.jsx("p",{className:"text-sm text-destructive",children:g.unit})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 bg-white p-3 rounded-md",children:[e.jsx("p",{className:"font-medium mb-1",children:"Ejemplos:"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1 text-xs",children:[e.jsx("span",{children:" Comprar colchn: 2,000,000 COP"}),e.jsx("span",{children:" Bajar peso: 3 kg"}),e.jsx("span",{children:" Ahorrar dinero: 500,000 COP"}),e.jsx("span",{children:" Completar curso: 100 %"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(P,{type:"button",variant:"outline",onClick:N,disabled:m,children:"Cancelar"}),e.jsx(P,{type:"submit",disabled:m||!b(),children:m?"Guardando...":t?"Actualizar":"Crear"})]})]})]})})},sY=()=>{const{goalId:t}=Ss(),a=it(),{goals:s,status:r,error:l,addGoal:o,updateGoal:d,addTask:u,toggleTask:m,editTask:h,deleteTask:g,addEntry:x,incrementPositiveCount:y,incrementNegativeCount:v,addNumericEntry:b}=GV(),[N,S]=p.useState(t||null),[w,E]=p.useState(!1),[T,D]=p.useState(void 0),[k,_]=p.useState(""),[R,L]=p.useState("active"),U=s.find(O=>O.id===N)||null;p.useEffect(()=>{t&&t!==N&&S(t)},[t,N]),p.useEffect(()=>{t&&s.length>0&&!s.find(O=>O.id===t)&&a(ae.goals.base)},[t,s,a]);const V=s.filter(O=>{const Y=O.title.toLowerCase().includes(k.toLowerCase())||O.description?.toLowerCase().includes(k.toLowerCase()),le=R==="all"||O.status===R;return Y&&le}),F=async O=>{await o({title:O.title||"",description:O.description,status:O.status||"active",startDate:O.startDate,dueDate:O.dueDate,tasks:[],entries:[]})},G=async O=>{T&&await d(T.id,O)},$=O=>{D(O),E(!0)},z=()=>{E(!1),D(void 0)},H=()=>{S(null),a(ae.goals.base)},I=O=>{S(O),a(ae.goals.detail(O))};return U?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(P,{variant:"outline",size:"sm",onClick:H,className:"flex items-center gap-2",children:[e.jsx(fl,{className:"h-4 w-4"}),"Volver a objetivos"]})}),e.jsx(aY,{goal:U,onAddTask:O=>u(U.id,O),onToggleTask:(O,Y)=>m(U.id,O,Y),onEditTask:(O,Y)=>h(U.id,O,Y),onDeleteTask:O=>g(U.id,O),onAddEntry:(O,Y,le)=>x(U.id,{text:O,date:Y,isMilestone:le}),onIncrementPositive:()=>y(U.id),onIncrementNegative:()=>v(U.id),onAddNumericEntry:(O,Y,le)=>b(U.id,{value:O,note:Y,date:le}),onEdit:()=>$(U)}),e.jsx(uC,{goal:T,isOpen:w,onClose:z,onSave:T?G:F})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(fe,{children:e.jsx(xt,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs(mt,{className:"flex items-center gap-2",children:[e.jsx(Ac,{className:"h-5 w-5"}),"Objetivos (",s.length,")"]})}),e.jsxs(P,{onClick:()=>E(!0),children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"Nuevo objetivo"]})]})})}),e.jsx(fe,{children:e.jsx(xe,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(ye,{placeholder:"Buscar objetivos...",value:k,onChange:O=>_(O.target.value),className:"pl-9"})]})}),e.jsxs("div",{className:"flex items-center gap-2 sm:w-48",children:[e.jsx(Eu,{className:"h-4 w-4 text-gray-400"}),e.jsxs(yt,{value:R,onValueChange:L,children:[e.jsx(ft,{children:e.jsx(vt,{})}),e.jsxs(pt,{children:[e.jsx(Le,{value:"all",children:"Todos"}),e.jsx(Le,{value:"active",children:"Activos"}),e.jsx(Le,{value:"completed",children:"Completados"}),e.jsx(Le,{value:"abandoned",children:"Abandonados"})]})]})]})]})})}),e.jsxs("div",{children:[r==="loading"&&e.jsx(fe,{className:"p-6 text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Cargando objetivos..."})]})}),l&&e.jsx(fe,{className:"p-6 text-center",children:e.jsxs("div",{className:"text-red-600",children:[e.jsx("p",{className:"font-medium",children:"Error al cargar objetivos"}),e.jsx("p",{className:"text-sm mt-1",children:l})]})}),r!=="loading"&&!l&&e.jsx(WV,{goals:V,onSelect:I,onIncrementPositive:y,onIncrementNegative:v,onEdit:$})]}),k||R!=="all"?e.jsx(fe,{children:e.jsx(xe,{className:"p-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:V.length===0?"No se encontraron objetivos que coincidan con los filtros":`Mostrando ${V.length} de ${s.length} objetivos`})})}):null]}),e.jsx(uC,{goal:T,isOpen:w,onClose:z,onSave:T?G:F})]})},mC=()=>e.jsx(wi,{children:e.jsx(sY,{})}),nY={module:"goals",defaultRoute:ae.goals.base,moduleRoutes:[{path:"goals",element:e.jsx(mC,{})},{path:"goals/:goalId",element:e.jsx(mC,{})}]},rY=({data:t,className:a})=>e.jsx("div",{className:he("h-24",a),children:e.jsx(gn,{width:"100%",height:"100%",children:e.jsxs(ol,{data:t,margin:{left:-20,right:10},children:[e.jsx(kr,{dataKey:"label",tick:{fontSize:10}}),e.jsx(Jn,{domain:[0,10],tick:{fontSize:10}}),e.jsx(yn,{}),e.jsx(ui,{type:"monotone",dataKey:"value",stroke:"#f59e0b",connectNulls:!1})]})})});class Wd{static client=ze;static async getDrinkLogsRange(a,s,r){return ze.from("drink_logs").select("date, amount").eq("user_id",a).gte("date",s).lte("date",r)}static async getExerciseLogsRange(a,s,r){return ze.from("exercise_logs").select("id, date, calories").eq("user_id",a).gte("date",s).lte("date",r)}static async getMoodEntriesRange(a,s,r){return ze.from("mood_entries").select("date, value").eq("user_id",a).gte("date",s).lte("date",r).order("date",{ascending:!0})}static async getJournalEntriesRange(a,s,r){return ze.from("journal_entries").select("date").eq("user_id",a).gte("date",s).lte("date",r)}static async getHabitCompletionsRange(a,s,r){return ze.from("habit_completions").select("habit_id, date, completed").eq("user_id",a).gte("date",s).lte("date",r)}}const hC={waterMl:0,exerciseCount:0,exerciseCalories:0,moodEntries:0,moodAverage:0,journalEntries:0,habitWeeklyCompletionPct:0,habitWeeklyCompleted:0,habitWeeklyTotal:nn.length*7},iY=t=>{const a=new Date;return a.setDate(a.getDate()-t),Ue(a)},lY=t=>new Date(`${t}T00:00:00`).toLocaleDateString("es-ES",{weekday:"short"}),oY=(t,a)=>{const s=[],r=new Date(`${t}T00:00:00`);for(let l=0;l<a;l+=1){const o=new Date(r);o.setDate(r.getDate()+l),s.push(Ue(o))}return s},cY=(t,a)=>{const s=t.filter(o=>o.completed).length,r=a*7,l=r>0?Number((s/r*100).toFixed(1)):0;return{completed:s,total:r,pct:l}},dY=()=>{const{user:t}=st(),[a,s]=p.useState({summary:hC,moodTrend:[]}),[r,l]=p.useState("idle"),[o,d]=p.useState(null),u=p.useCallback(async()=>{if(!t){s({summary:hC,moodTrend:[]}),l("ready");return}const m=Ue(new Date),h=iY(6);l("loading"),d(null);try{const[g,x,y,v,b]=await Promise.all([Wd.getDrinkLogsRange(t.id,h,m),Wd.getExerciseLogsRange(t.id,h,m),Wd.getMoodEntriesRange(t.id,h,m),Wd.getJournalEntriesRange(t.id,h,m),Wd.getHabitCompletionsRange(t.id,h,m)]);if(g.error)throw g.error;if(x.error)throw x.error;if(y.error)throw y.error;if(v.error)throw v.error;if(b.error)throw b.error;const N=(g.data||[]).reduce((L,U)=>L+(U.amount||0),0),S=(x.data||[]).length,w=(x.data||[]).reduce((L,U)=>L+(U.calories||0),0),E=(y.data||[]).length,T=E?(y.data||[]).reduce((L,U)=>L+(U.value||0),0)/E:0,D=(v.data||[]).length,k=cY(b.data||[],nn.length),_={};(y.data||[]).forEach(L=>{_[L.date]||(_[L.date]={total:0,count:0}),_[L.date].total+=L.value||0,_[L.date].count+=1});const R=oY(h,7).map(L=>({date:L,label:lY(L),value:_[L]?Number((_[L].total/_[L].count).toFixed(2)):null}));s({summary:{waterMl:N,exerciseCount:S,exerciseCalories:w,moodEntries:E,moodAverage:Number(T.toFixed(2)),journalEntries:D,habitWeeklyCompletionPct:k.pct,habitWeeklyCompleted:k.completed,habitWeeklyTotal:k.total},moodTrend:R}),l("ready")}catch(g){console.error("Error loading statistics dashboard:",g),d(g instanceof Error?g.message:"No se pudo cargar el dashboard"),l("error")}},[t]);return p.useEffect(()=>{u()},[u]),{data:a,status:r,error:o,reload:u}},fC=t=>new Intl.NumberFormat("es-ES").format(t),uY=()=>{const{data:t,status:a,error:s,reload:r}=dY();return e.jsxs(wi,{children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Estadisticas"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Resumen de los ultimos 7 dias (incluyendo hoy)."})]}),e.jsxs(P,{onClick:r,variant:"outline",disabled:a==="loading",children:[e.jsx(io,{className:`mr-2 h-4 w-4 ${a==="loading"?"animate-spin":""}`}),"Recargar"]})]}),a==="error"&&e.jsx(fe,{className:"border-red-300 bg-red-50",children:e.jsx(xe,{className:"pt-6 text-sm text-red-700",children:s||"Error cargando estadisticas"})}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-5",children:[e.jsxs(fe,{children:[e.jsx(xt,{className:"pb-2",children:e.jsxs(mt,{className:"text-base flex items-center gap-2",children:[e.jsx(no,{className:"h-4 w-4"})," Agua (7 dias)"]})}),e.jsx(xe,{children:e.jsxs("p",{className:"text-3xl font-semibold",children:[fC(t.summary.waterMl)," ml"]})})]}),e.jsxs(fe,{children:[e.jsx(xt,{className:"pb-2",children:e.jsxs(mt,{className:"text-base flex items-center gap-2",children:[e.jsx(mc,{className:"h-4 w-4"})," Ejercicio (7 dias)"]})}),e.jsxs(xe,{children:[e.jsxs("p",{className:"text-3xl font-semibold",children:[fC(t.summary.exerciseCalories)," kcal"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.summary.exerciseCount," sesiones"]})]})]}),e.jsxs(fe,{children:[e.jsx(xt,{className:"pb-2",children:e.jsxs(mt,{className:"text-base flex items-center gap-2",children:[e.jsx(bf,{className:"h-4 w-4"})," Estado de animo"]})}),e.jsxs(xe,{children:[e.jsxs("p",{className:"text-3xl font-semibold",children:[t.summary.moodAverage.toFixed(1)," / 10"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.summary.moodEntries," registros en 7 dias"]})]})]}),e.jsxs(fe,{children:[e.jsx(xt,{className:"pb-2",children:e.jsxs(mt,{className:"text-base flex items-center gap-2",children:[e.jsx(ro,{className:"h-4 w-4"})," Diario (7 dias)"]})}),e.jsxs(xe,{children:[e.jsx("p",{className:"text-3xl font-semibold",children:t.summary.journalEntries}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"entradas"})]})]}),e.jsxs(fe,{children:[e.jsx(xt,{className:"pb-2",children:e.jsxs(mt,{className:"text-base flex items-center gap-2",children:[e.jsx(hl,{className:"h-4 w-4"})," Habitos (7 dias)"]})}),e.jsxs(xe,{children:[e.jsxs("p",{className:"text-3xl font-semibold",children:[t.summary.habitWeeklyCompletionPct.toFixed(1),"%"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.summary.habitWeeklyCompleted,"/",t.summary.habitWeeklyTotal," completados"]})]})]})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsxs(mt,{className:"text-lg flex items-center gap-2",children:[e.jsx(g1,{className:"h-4 w-4"})," Tendencia de animo (7 dias)"]})}),e.jsx(xe,{children:t.moodTrend.length>0?e.jsx(rY,{data:t.moodTrend.map(l=>({label:l.label,value:l.value})),className:"h-36"}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay datos suficientes para graficar."})})]}),e.jsxs(fe,{children:[e.jsx(xt,{children:e.jsx(mt,{className:"text-lg",children:"Accesos rapidos"})}),e.jsxs(xe,{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(P,{asChild:!0,variant:"outline",children:e.jsx(La,{to:ae.water.view("weekly"),children:"Ver hidratacion"})}),e.jsx(P,{asChild:!0,variant:"outline",children:e.jsx(La,{to:ae.exercise.view("calendar"),children:"Ver ejercicio"})}),e.jsx(P,{asChild:!0,variant:"outline",children:e.jsx(La,{to:ae.mood.view("tracker"),children:"Ver estado de animo"})}),e.jsx(P,{asChild:!0,variant:"outline",children:e.jsx(La,{to:ae.journal.view("entries"),children:"Ver diario"})})]})]})]})},mY={module:"statistics",defaultRoute:ae.stats.home,moduleRoutes:[{path:"stats",element:e.jsx(uY,{})}]};var Vu=t=>t.type==="checkbox",Ql=t=>t instanceof Date,Js=t=>t==null;const Pk=t=>typeof t=="object";var as=t=>!Js(t)&&!Array.isArray(t)&&Pk(t)&&!Ql(t),hY=t=>as(t)&&t.target?Vu(t.target)?t.target.checked:t.target.value:t,fY=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,pY=(t,a)=>t.has(fY(a)),xY=t=>{const a=t.constructor&&t.constructor.prototype;return as(a)&&a.hasOwnProperty("isPrototypeOf")},uv=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function is(t){if(t instanceof Date)return new Date(t);const a=typeof FileList<"u"&&t instanceof FileList;if(uv&&(t instanceof Blob||a))return t;const s=Array.isArray(t);if(!s&&!(as(t)&&xY(t)))return t;const r=s?[]:Object.create(Object.getPrototypeOf(t));for(const l in t)Object.prototype.hasOwnProperty.call(t,l)&&(r[l]=is(t[l]));return r}var ep=t=>/^\w*$/.test(t),za=t=>t===void 0,mv=t=>Array.isArray(t)?t.filter(Boolean):[],hv=t=>mv(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Ze=(t,a,s)=>{if(!a||!as(t))return s;const r=(ep(a)?[a]:hv(a)).reduce((l,o)=>Js(l)?l:l[o],t);return za(r)||r===t?za(t[a])?s:t[a]:r},Er=t=>typeof t=="boolean",ar=t=>typeof t=="function",Da=(t,a,s)=>{let r=-1;const l=ep(a)?[a]:hv(a),o=l.length,d=o-1;for(;++r<o;){const u=l[r];let m=s;if(r!==d){const h=t[u];m=as(h)||Array.isArray(h)?h:isNaN(+l[r+1])?{}:[]}if(u==="__proto__"||u==="constructor"||u==="prototype")return;t[u]=m,t=t[u]}};const pC={BLUR:"blur",FOCUS_OUT:"focusout"},sr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ni={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},gY=te.createContext(null);gY.displayName="HookFormContext";var yY=(t,a,s,r=!0)=>{const l={defaultValues:a._defaultValues};for(const o in t)Object.defineProperty(l,o,{get:()=>{const d=o;return a._proxyFormState[d]!==sr.all&&(a._proxyFormState[d]=!r||sr.all),t[d]}});return l};const vY=typeof window<"u"?te.useLayoutEffect:te.useEffect;var vn=t=>typeof t=="string",bY=(t,a,s,r,l)=>vn(t)?(r&&a.watch.add(t),Ze(s,t,l)):Array.isArray(t)?t.map(o=>(r&&a.watch.add(o),Ze(s,o))):(r&&(a.watchAll=!0),s),F0=t=>Js(t)||!Pk(t);function ll(t,a,s=new WeakSet){if(F0(t)||F0(a))return Object.is(t,a);if(Ql(t)&&Ql(a))return Object.is(t.getTime(),a.getTime());const r=Object.keys(t),l=Object.keys(a);if(r.length!==l.length)return!1;if(s.has(t)||s.has(a))return!0;s.add(t),s.add(a);for(const o of r){const d=t[o];if(!l.includes(o))return!1;if(o!=="ref"){const u=a[o];if(Ql(d)&&Ql(u)||as(d)&&as(u)||Array.isArray(d)&&Array.isArray(u)?!ll(d,u,s):!Object.is(d,u))return!1}}return!0}var jY=(t,a,s,r,l)=>a?{...s[t],types:{...s[t]&&s[t].types?s[t].types:{},[r]:l||!0}}:{},ou=t=>Array.isArray(t)?t:[t],xC=()=>{let t=[];return{get observers(){return t},next:l=>{for(const o of t)o.next&&o.next(l)},subscribe:l=>(t.push(l),{unsubscribe:()=>{t=t.filter(o=>o!==l)}}),unsubscribe:()=>{t=[]}}};function Bk(t,a){const s={};for(const r in t)if(t.hasOwnProperty(r)){const l=t[r],o=a[r];if(l&&as(l)&&o){const d=Bk(l,o);as(d)&&(s[r]=d)}else t[r]&&(s[r]=o)}return s}var zs=t=>as(t)&&!Object.keys(t).length,fv=t=>t.type==="file",uf=t=>{if(!uv)return!1;const a=t?t.ownerDocument:0;return t instanceof(a&&a.defaultView?a.defaultView.HTMLElement:HTMLElement)},$k=t=>t.type==="select-multiple",pv=t=>t.type==="radio",NY=t=>pv(t)||Vu(t),Gg=t=>uf(t)&&t.isConnected;function wY(t,a){const s=a.slice(0,-1).length;let r=0;for(;r<s;)t=za(t)?r++:t[a[r++]];return t}function SY(t){for(const a in t)if(t.hasOwnProperty(a)&&!za(t[a]))return!1;return!0}function Ja(t,a){const s=Array.isArray(a)?a:ep(a)?[a]:hv(a),r=s.length===1?t:wY(t,s),l=s.length-1,o=s[l];return r&&delete r[o],l!==0&&(as(r)&&zs(r)||Array.isArray(r)&&SY(r))&&Ja(t,s.slice(0,-1)),t}var CY=t=>{for(const a in t)if(ar(t[a]))return!0;return!1};function Hk(t){return Array.isArray(t)||as(t)&&!CY(t)}function G0(t,a={}){for(const s in t){const r=t[s];Hk(r)?(a[s]=Array.isArray(r)?[]:{},G0(r,a[s])):za(r)||(a[s]=!0)}return a}function sc(t,a,s){s||(s=G0(a));for(const r in t){const l=t[r];if(Hk(l))za(a)||F0(s[r])?s[r]=G0(l,Array.isArray(l)?[]:{}):sc(l,Js(a)?{}:a[r],s[r]);else{const o=a[r];s[r]=!ll(l,o)}}return s}const gC={value:!1,isValid:!1},yC={value:!0,isValid:!0};var Uk=t=>{if(Array.isArray(t)){if(t.length>1){const a=t.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:a,isValid:!!a.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!za(t[0].attributes.value)?za(t[0].value)||t[0].value===""?yC:{value:t[0].value,isValid:!0}:yC:gC}return gC},Vk=(t,{valueAsNumber:a,valueAsDate:s,setValueAs:r})=>za(t)?t:a?t===""?NaN:t&&+t:s&&vn(t)?new Date(t):r?r(t):t;const vC={isValid:!1,value:null};var Yk=t=>Array.isArray(t)?t.reduce((a,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:a,vC):vC;function bC(t){const a=t.ref;return fv(a)?a.files:pv(a)?Yk(t.refs).value:$k(a)?[...a.selectedOptions].map(({value:s})=>s):Vu(a)?Uk(t.refs).value:Vk(za(a.value)?t.ref.value:a.value,t)}var EY=(t,a,s,r)=>{const l={};for(const o of t){const d=Ze(a,o);d&&Da(l,o,d._f)}return{criteriaMode:s,names:[...t],fields:l,shouldUseNativeValidation:r}},mf=t=>t instanceof RegExp,Kd=t=>za(t)?t:mf(t)?t.source:as(t)?mf(t.value)?t.value.source:t.value:t,jC=t=>({isOnSubmit:!t||t===sr.onSubmit,isOnBlur:t===sr.onBlur,isOnChange:t===sr.onChange,isOnAll:t===sr.all,isOnTouch:t===sr.onTouched});const NC="AsyncFunction";var TY=t=>!!t&&!!t.validate&&!!(ar(t.validate)&&t.validate.constructor.name===NC||as(t.validate)&&Object.values(t.validate).find(a=>a.constructor.name===NC)),DY=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),wC=(t,a,s)=>!s&&(a.watchAll||a.watch.has(t)||[...a.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const cu=(t,a,s,r)=>{for(const l of s||Object.keys(t)){const o=Ze(t,l);if(o){const{_f:d,...u}=o;if(d){if(d.refs&&d.refs[0]&&a(d.refs[0],l)&&!r)return!0;if(d.ref&&a(d.ref,d.name)&&!r)return!0;if(cu(u,a))break}else if(as(u)&&cu(u,a))break}}};function SC(t,a,s){const r=Ze(t,s);if(r||ep(s))return{error:r,name:s};const l=s.split(".");for(;l.length;){const o=l.join("."),d=Ze(a,o),u=Ze(t,o);if(d&&!Array.isArray(d)&&s!==o)return{name:s};if(u&&u.type)return{name:o,error:u};if(u&&u.root&&u.root.type)return{name:`${o}.root`,error:u.root};l.pop()}return{name:s}}var kY=(t,a,s,r)=>{s(t);const{name:l,...o}=t;return zs(o)||Object.keys(o).length>=Object.keys(a).length||Object.keys(o).find(d=>a[d]===(!r||sr.all))},AY=(t,a,s)=>!t||!a||t===a||ou(t).some(r=>r&&(s?r===a:r.startsWith(a)||a.startsWith(r))),_Y=(t,a,s,r,l)=>l.isOnAll?!1:!s&&l.isOnTouch?!(a||t):(s?r.isOnBlur:l.isOnBlur)?!t:(s?r.isOnChange:l.isOnChange)?t:!0,MY=(t,a)=>!mv(Ze(t,a)).length&&Ja(t,a),OY=(t,a,s)=>{const r=ou(Ze(t,s));return Da(r,"root",a[s]),Da(t,s,r),t};function CC(t,a,s="validate"){if(vn(t)||Array.isArray(t)&&t.every(vn)||Er(t)&&!t)return{type:s,message:vn(t)?t:"",ref:a}}var ec=t=>as(t)&&!mf(t)?t:{value:t,message:""},EC=async(t,a,s,r,l,o)=>{const{ref:d,refs:u,required:m,maxLength:h,minLength:g,min:x,max:y,pattern:v,validate:b,name:N,valueAsNumber:S,mount:w}=t._f,E=Ze(s,N);if(!w||a.has(N))return{};const T=u?u[0]:d,D=G=>{l&&T.reportValidity&&(T.setCustomValidity(Er(G)?"":G||""),T.reportValidity())},k={},_=pv(d),R=Vu(d),L=_||R,U=(S||fv(d))&&za(d.value)&&za(E)||uf(d)&&d.value===""||E===""||Array.isArray(E)&&!E.length,V=jY.bind(null,N,r,k),F=(G,$,z,H=ni.maxLength,I=ni.minLength)=>{const O=G?$:z;k[N]={type:G?H:I,message:O,ref:d,...V(G?H:I,O)}};if(o?!Array.isArray(E)||!E.length:m&&(!L&&(U||Js(E))||Er(E)&&!E||R&&!Uk(u).isValid||_&&!Yk(u).isValid)){const{value:G,message:$}=vn(m)?{value:!!m,message:m}:ec(m);if(G&&(k[N]={type:ni.required,message:$,ref:T,...V(ni.required,$)},!r))return D($),k}if(!U&&(!Js(x)||!Js(y))){let G,$;const z=ec(y),H=ec(x);if(!Js(E)&&!isNaN(E)){const I=d.valueAsNumber||E&&+E;Js(z.value)||(G=I>z.value),Js(H.value)||($=I<H.value)}else{const I=d.valueAsDate||new Date(E),O=re=>new Date(new Date().toDateString()+" "+re),Y=d.type=="time",le=d.type=="week";vn(z.value)&&E&&(G=Y?O(E)>O(z.value):le?E>z.value:I>new Date(z.value)),vn(H.value)&&E&&($=Y?O(E)<O(H.value):le?E<H.value:I<new Date(H.value))}if((G||$)&&(F(!!G,z.message,H.message,ni.max,ni.min),!r))return D(k[N].message),k}if((h||g)&&!U&&(vn(E)||o&&Array.isArray(E))){const G=ec(h),$=ec(g),z=!Js(G.value)&&E.length>+G.value,H=!Js($.value)&&E.length<+$.value;if((z||H)&&(F(z,G.message,$.message),!r))return D(k[N].message),k}if(v&&!U&&vn(E)){const{value:G,message:$}=ec(v);if(mf(G)&&!E.match(G)&&(k[N]={type:ni.pattern,message:$,ref:d,...V(ni.pattern,$)},!r))return D($),k}if(b){if(ar(b)){const G=await b(E,s),$=CC(G,T);if($&&(k[N]={...$,...V(ni.validate,$.message)},!r))return D($.message),k}else if(as(b)){let G={};for(const $ in b){if(!zs(G)&&!r)break;const z=CC(await b[$](E,s),T,$);z&&(G={...z,...V($,z.message)},D(z.message),r&&(k[N]=G))}if(!zs(G)&&(k[N]={ref:T,...G},!r))return k}}return D(!0),k};const RY={mode:sr.onSubmit,reValidateMode:sr.onChange,shouldFocusError:!0};function IY(t={}){let a={...RY,...t},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:ar(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1},r={},l=as(a.defaultValues)||as(a.values)?is(a.defaultValues||a.values)||{}:{},o=a.shouldUnregister?{}:is(l),d={action:!1,mount:!1,watch:!1,keepIsValid:!1},u={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},m,h=0;const g={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},x={...g};let y={...x};const v={array:xC(),state:xC()},b=a.criteriaMode===sr.all,N=X=>se=>{clearTimeout(h),h=setTimeout(X,se)},S=async X=>{if(!d.keepIsValid&&!a.disabled&&(x.isValid||y.isValid||X)){let se;a.resolver?(se=zs((await L()).errors),w()):se=await V(r,!0),se!==s.isValid&&v.state.next({isValid:se})}},w=(X,se)=>{!a.disabled&&(x.isValidating||x.validatingFields||y.isValidating||y.validatingFields)&&((X||Array.from(u.mount)).forEach(me=>{me&&(se?Da(s.validatingFields,me,se):Ja(s.validatingFields,me))}),v.state.next({validatingFields:s.validatingFields,isValidating:!zs(s.validatingFields)}))},E=(X,se=[],me,Oe,Re=!0,Ee=!0)=>{if(Oe&&me&&!a.disabled){if(d.action=!0,Ee&&Array.isArray(Ze(r,X))){const Pe=me(Ze(r,X),Oe.argA,Oe.argB);Re&&Da(r,X,Pe)}if(Ee&&Array.isArray(Ze(s.errors,X))){const Pe=me(Ze(s.errors,X),Oe.argA,Oe.argB);Re&&Da(s.errors,X,Pe),MY(s.errors,X)}if((x.touchedFields||y.touchedFields)&&Ee&&Array.isArray(Ze(s.touchedFields,X))){const Pe=me(Ze(s.touchedFields,X),Oe.argA,Oe.argB);Re&&Da(s.touchedFields,X,Pe)}(x.dirtyFields||y.dirtyFields)&&(s.dirtyFields=sc(l,o)),v.state.next({name:X,isDirty:G(X,se),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else Da(o,X,se)},T=(X,se)=>{Da(s.errors,X,se),v.state.next({errors:s.errors})},D=X=>{s.errors=X,v.state.next({errors:s.errors,isValid:!1})},k=(X,se,me,Oe)=>{const Re=Ze(r,X);if(Re){const Ee=Ze(o,X,za(me)?Ze(l,X):me);za(Ee)||Oe&&Oe.defaultChecked||se?Da(o,X,se?Ee:bC(Re._f)):H(X,Ee),d.mount&&!d.action&&S()}},_=(X,se,me,Oe,Re)=>{let Ee=!1,Pe=!1;const Je={name:X};if(!a.disabled){if(!me||Oe){(x.isDirty||y.isDirty)&&(Pe=s.isDirty,s.isDirty=Je.isDirty=G(),Ee=Pe!==Je.isDirty);const rt=ll(Ze(l,X),se);Pe=!!Ze(s.dirtyFields,X),rt?Ja(s.dirtyFields,X):Da(s.dirtyFields,X,!0),Je.dirtyFields=s.dirtyFields,Ee=Ee||(x.dirtyFields||y.dirtyFields)&&Pe!==!rt}if(me){const rt=Ze(s.touchedFields,X);rt||(Da(s.touchedFields,X,me),Je.touchedFields=s.touchedFields,Ee=Ee||(x.touchedFields||y.touchedFields)&&rt!==me)}Ee&&Re&&v.state.next(Je)}return Ee?Je:{}},R=(X,se,me,Oe)=>{const Re=Ze(s.errors,X),Ee=(x.isValid||y.isValid)&&Er(se)&&s.isValid!==se;if(a.delayError&&me?(m=N(()=>T(X,me)),m(a.delayError)):(clearTimeout(h),m=null,me?Da(s.errors,X,me):Ja(s.errors,X)),(me?!ll(Re,me):Re)||!zs(Oe)||Ee){const Pe={...Oe,...Ee&&Er(se)?{isValid:se}:{},errors:s.errors,name:X};s={...s,...Pe},v.state.next(Pe)}},L=async X=>(w(X,!0),await a.resolver(o,a.context,EY(X||u.mount,r,a.criteriaMode,a.shouldUseNativeValidation))),U=async X=>{const{errors:se}=await L(X);if(w(X),X)for(const me of X){const Oe=Ze(se,me);Oe?Da(s.errors,me,Oe):Ja(s.errors,me)}else s.errors=se;return se},V=async(X,se,me={valid:!0})=>{for(const Oe in X){const Re=X[Oe];if(Re){const{_f:Ee,...Pe}=Re;if(Ee){const Je=u.array.has(Ee.name),rt=Re._f&&TY(Re._f);rt&&x.validatingFields&&w([Ee.name],!0);const Et=await EC(Re,u.disabled,o,b,a.shouldUseNativeValidation&&!se,Je);if(rt&&x.validatingFields&&w([Ee.name]),Et[Ee.name]&&(me.valid=!1,se||t.shouldUseNativeValidation))break;!se&&(Ze(Et,Ee.name)?Je?OY(s.errors,Et,Ee.name):Da(s.errors,Ee.name,Et[Ee.name]):Ja(s.errors,Ee.name))}!zs(Pe)&&await V(Pe,se,me)}}return me.valid},F=()=>{for(const X of u.unMount){const se=Ze(r,X);se&&(se._f.refs?se._f.refs.every(me=>!Gg(me)):!Gg(se._f.ref))&&oe(X)}u.unMount=new Set},G=(X,se)=>!a.disabled&&(X&&se&&Da(o,X,se),!ll(Q(),l)),$=(X,se,me)=>bY(X,u,{...d.mount?o:za(se)?l:vn(X)?{[X]:se}:se},me,se),z=X=>mv(Ze(d.mount?o:l,X,a.shouldUnregister?Ze(l,X,[]):[])),H=(X,se,me={})=>{const Oe=Ze(r,X);let Re=se;if(Oe){const Ee=Oe._f;Ee&&(!Ee.disabled&&Da(o,X,Vk(se,Ee)),Re=uf(Ee.ref)&&Js(se)?"":se,$k(Ee.ref)?[...Ee.ref.options].forEach(Pe=>Pe.selected=Re.includes(Pe.value)):Ee.refs?Vu(Ee.ref)?Ee.refs.forEach(Pe=>{(!Pe.defaultChecked||!Pe.disabled)&&(Array.isArray(Re)?Pe.checked=!!Re.find(Je=>Je===Pe.value):Pe.checked=Re===Pe.value||!!Re)}):Ee.refs.forEach(Pe=>Pe.checked=Pe.value===Re):fv(Ee.ref)?Ee.ref.value="":(Ee.ref.value=Re,Ee.ref.type||v.state.next({name:X,values:is(o)})))}(me.shouldDirty||me.shouldTouch)&&_(X,Re,me.shouldTouch,me.shouldDirty,!0),me.shouldValidate&&re(X)},I=(X,se,me)=>{for(const Oe in se){if(!se.hasOwnProperty(Oe))return;const Re=se[Oe],Ee=X+"."+Oe,Pe=Ze(r,Ee);(u.array.has(X)||as(Re)||Pe&&!Pe._f)&&!Ql(Re)?I(Ee,Re,me):H(Ee,Re,me)}},O=(X,se,me={})=>{const Oe=Ze(r,X),Re=u.array.has(X),Ee=is(se);Da(o,X,Ee),Re?(v.array.next({name:X,values:is(o)}),(x.isDirty||x.dirtyFields||y.isDirty||y.dirtyFields)&&me.shouldDirty&&v.state.next({name:X,dirtyFields:sc(l,o),isDirty:G(X,Ee)})):Oe&&!Oe._f&&!Js(Ee)?I(X,Ee,me):H(X,Ee,me),wC(X,u)?v.state.next({...s,name:X,values:is(o)}):v.state.next({name:d.mount?X:void 0,values:is(o)})},Y=async X=>{d.mount=!0;const se=X.target;let me=se.name,Oe=!0;const Re=Ze(r,me),Ee=rt=>{Oe=Number.isNaN(rt)||Ql(rt)&&isNaN(rt.getTime())||ll(rt,Ze(o,me,rt))},Pe=jC(a.mode),Je=jC(a.reValidateMode);if(Re){let rt,Et;const Kt=se.type?bC(Re._f):hY(X),Ne=X.type===pC.BLUR||X.type===pC.FOCUS_OUT,Ve=!DY(Re._f)&&!a.resolver&&!Ze(s.errors,me)&&!Re._f.deps||_Y(Ne,Ze(s.touchedFields,me),s.isSubmitted,Je,Pe),nt=wC(me,u,Ne);Da(o,me,Kt),Ne?(!se||!se.readOnly)&&(Re._f.onBlur&&Re._f.onBlur(X),m&&m(0)):Re._f.onChange&&Re._f.onChange(X);const bt=_(me,Kt,Ne),Pt=!zs(bt)||nt;if(!Ne&&v.state.next({name:me,type:X.type,values:is(o)}),Ve)return(x.isValid||y.isValid)&&(a.mode==="onBlur"?Ne&&S():Ne||S()),Pt&&v.state.next({name:me,...nt?{}:bt});if(!Ne&&nt&&v.state.next({...s}),a.resolver){const{errors:_a}=await L([me]);if(w([me]),Ee(Kt),Oe){const Ma=SC(s.errors,r,me),qe=SC(_a,r,Ma.name||me);rt=qe.error,me=qe.name,Et=zs(_a)}}else w([me],!0),rt=(await EC(Re,u.disabled,o,b,a.shouldUseNativeValidation))[me],w([me]),Ee(Kt),Oe&&(rt?Et=!1:(x.isValid||y.isValid)&&(Et=await V(r,!0)));Oe&&(Re._f.deps&&(!Array.isArray(Re._f.deps)||Re._f.deps.length>0)&&re(Re._f.deps),R(me,Et,rt,bt))}},le=(X,se)=>{if(Ze(s.errors,se)&&X.focus)return X.focus(),1},re=async(X,se={})=>{let me,Oe;const Re=ou(X);if(a.resolver){const Ee=await U(za(X)?X:Re);me=zs(Ee),Oe=X?!Re.some(Pe=>Ze(Ee,Pe)):me}else X?(Oe=(await Promise.all(Re.map(async Ee=>{const Pe=Ze(r,Ee);return await V(Pe&&Pe._f?{[Ee]:Pe}:Pe)}))).every(Boolean),!(!Oe&&!s.isValid)&&S()):Oe=me=await V(r);return v.state.next({...!vn(X)||(x.isValid||y.isValid)&&me!==s.isValid?{}:{name:X},...a.resolver||!X?{isValid:me}:{},errors:s.errors}),se.shouldFocus&&!Oe&&cu(r,le,X?Re:u.mount),Oe},Q=(X,se)=>{let me={...d.mount?o:l};return se&&(me=Bk(se.dirtyFields?s.dirtyFields:s.touchedFields,me)),za(X)?me:vn(X)?Ze(me,X):X.map(Oe=>Ze(me,Oe))},q=(X,se)=>({invalid:!!Ze((se||s).errors,X),isDirty:!!Ze((se||s).dirtyFields,X),error:Ze((se||s).errors,X),isValidating:!!Ze(s.validatingFields,X),isTouched:!!Ze((se||s).touchedFields,X)}),M=X=>{X&&ou(X).forEach(se=>Ja(s.errors,se)),v.state.next({errors:X?s.errors:{}})},W=(X,se,me)=>{const Oe=(Ze(r,X,{_f:{}})._f||{}).ref,Re=Ze(s.errors,X)||{},{ref:Ee,message:Pe,type:Je,...rt}=Re;Da(s.errors,X,{...rt,...se,ref:Oe}),v.state.next({name:X,errors:s.errors,isValid:!1}),me&&me.shouldFocus&&Oe&&Oe.focus&&Oe.focus()},ie=(X,se)=>ar(X)?v.state.subscribe({next:me=>"values"in me&&X($(void 0,se),me)}):$(X,se,!0),ve=X=>v.state.subscribe({next:se=>{AY(X.name,se.name,X.exact)&&kY(se,X.formState||x,ja,X.reRenderRoot)&&X.callback({values:{...o},...s,...se,defaultValues:l})}}).unsubscribe,K=X=>(d.mount=!0,y={...y,...X.formState},ve({...X,formState:{...g,...X.formState}})),oe=(X,se={})=>{for(const me of X?ou(X):u.mount)u.mount.delete(me),u.array.delete(me),se.keepValue||(Ja(r,me),Ja(o,me)),!se.keepError&&Ja(s.errors,me),!se.keepDirty&&Ja(s.dirtyFields,me),!se.keepTouched&&Ja(s.touchedFields,me),!se.keepIsValidating&&Ja(s.validatingFields,me),!a.shouldUnregister&&!se.keepDefaultValue&&Ja(l,me);v.state.next({values:is(o)}),v.state.next({...s,...se.keepDirty?{isDirty:G()}:{}}),!se.keepIsValid&&S()},_e=({disabled:X,name:se})=>{(Er(X)&&d.mount||X||u.disabled.has(se))&&(X?u.disabled.add(se):u.disabled.delete(se))},je=(X,se={})=>{let me=Ze(r,X);const Oe=Er(se.disabled)||Er(a.disabled);return Da(r,X,{...me||{},_f:{...me&&me._f?me._f:{ref:{name:X}},name:X,mount:!0,...se}}),u.mount.add(X),me?_e({disabled:Er(se.disabled)?se.disabled:a.disabled,name:X}):k(X,!0,se.value),{...Oe?{disabled:se.disabled||a.disabled}:{},...a.progressive?{required:!!se.required,min:Kd(se.min),max:Kd(se.max),minLength:Kd(se.minLength),maxLength:Kd(se.maxLength),pattern:Kd(se.pattern)}:{},name:X,onChange:Y,onBlur:Y,ref:Re=>{if(Re){je(X,se),me=Ze(r,X);const Ee=za(Re.value)&&Re.querySelectorAll&&Re.querySelectorAll("input,select,textarea")[0]||Re,Pe=NY(Ee),Je=me._f.refs||[];if(Pe?Je.find(rt=>rt===Ee):Ee===me._f.ref)return;Da(r,X,{_f:{...me._f,...Pe?{refs:[...Je.filter(Gg),Ee,...Array.isArray(Ze(l,X))?[{}]:[]],ref:{type:Ee.type,name:X}}:{ref:Ee}}}),k(X,!1,void 0,Ee)}else me=Ze(r,X,{}),me._f&&(me._f.mount=!1),(a.shouldUnregister||se.shouldUnregister)&&!(pY(u.array,X)&&d.action)&&u.unMount.add(X)}}},Ie=()=>a.shouldFocusError&&cu(r,le,u.mount),ge=X=>{Er(X)&&(v.state.next({disabled:X}),cu(r,(se,me)=>{const Oe=Ze(r,me);Oe&&(se.disabled=Oe._f.disabled||X,Array.isArray(Oe._f.refs)&&Oe._f.refs.forEach(Re=>{Re.disabled=Oe._f.disabled||X}))},0,!1))},Be=(X,se)=>async me=>{let Oe;me&&(me.preventDefault&&me.preventDefault(),me.persist&&me.persist());let Re=is(o);if(v.state.next({isSubmitting:!0}),a.resolver){const{errors:Ee,values:Pe}=await L();w(),s.errors=Ee,Re=is(Pe)}else await V(r);if(u.disabled.size)for(const Ee of u.disabled)Ja(Re,Ee);if(Ja(s.errors,"root"),zs(s.errors)){v.state.next({errors:{}});try{await X(Re,me)}catch(Ee){Oe=Ee}}else se&&await se({...s.errors},me),Ie(),setTimeout(Ie);if(v.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:zs(s.errors)&&!Oe,submitCount:s.submitCount+1,errors:s.errors}),Oe)throw Oe},ke=(X,se={})=>{Ze(r,X)&&(za(se.defaultValue)?O(X,is(Ze(l,X))):(O(X,se.defaultValue),Da(l,X,is(se.defaultValue))),se.keepTouched||Ja(s.touchedFields,X),se.keepDirty||(Ja(s.dirtyFields,X),s.isDirty=se.defaultValue?G(X,is(Ze(l,X))):G()),se.keepError||(Ja(s.errors,X),x.isValid&&S()),v.state.next({...s}))},gt=(X,se={})=>{const me=X?is(X):l,Oe=is(me),Re=zs(X),Ee=Re?l:Oe;if(se.keepDefaultValues||(l=me),!se.keepValues){if(se.keepDirtyValues){const Pe=new Set([...u.mount,...Object.keys(sc(l,o))]);for(const Je of Array.from(Pe)){const rt=Ze(s.dirtyFields,Je),Et=Ze(o,Je),Kt=Ze(Ee,Je);rt&&!za(Et)?Da(Ee,Je,Et):!rt&&!za(Kt)&&O(Je,Kt)}}else{if(uv&&za(X))for(const Pe of u.mount){const Je=Ze(r,Pe);if(Je&&Je._f){const rt=Array.isArray(Je._f.refs)?Je._f.refs[0]:Je._f.ref;if(uf(rt)){const Et=rt.closest("form");if(Et){Et.reset();break}}}}if(se.keepFieldsRef)for(const Pe of u.mount)O(Pe,Ze(Ee,Pe));else r={}}o=a.shouldUnregister?se.keepDefaultValues?is(l):{}:is(Ee),v.array.next({values:{...Ee}}),v.state.next({values:{...Ee}})}u={mount:se.keepDirtyValues?u.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},d.mount=!x.isValid||!!se.keepIsValid||!!se.keepDirtyValues||!a.shouldUnregister&&!zs(Ee),d.watch=!!a.shouldUnregister,d.keepIsValid=!!se.keepIsValid,d.action=!1,se.keepErrors||(s.errors={}),v.state.next({submitCount:se.keepSubmitCount?s.submitCount:0,isDirty:Re?!1:se.keepDirty?s.isDirty:!!(se.keepDefaultValues&&!ll(X,l)),isSubmitted:se.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:Re?{}:se.keepDirtyValues?se.keepDefaultValues&&o?sc(l,o):s.dirtyFields:se.keepDefaultValues&&X?sc(l,X):se.keepDirty?s.dirtyFields:{},touchedFields:se.keepTouched?s.touchedFields:{},errors:se.keepErrors?s.errors:{},isSubmitSuccessful:se.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:l})},Dt=(X,se)=>gt(ar(X)?X(o):X,{...a.resetOptions,...se}),kt=(X,se={})=>{const me=Ze(r,X),Oe=me&&me._f;if(Oe){const Re=Oe.refs?Oe.refs[0]:Oe.ref;Re.focus&&setTimeout(()=>{Re.focus(),se.shouldSelect&&ar(Re.select)&&Re.select()})}},ja=X=>{s={...s,...X}},Vt={control:{register:je,unregister:oe,getFieldState:q,handleSubmit:Be,setError:W,_subscribe:ve,_runSchema:L,_updateIsValidating:w,_focusError:Ie,_getWatch:$,_getDirty:G,_setValid:S,_setFieldArray:E,_setDisabledField:_e,_setErrors:D,_getFieldArray:z,_reset:gt,_resetDefaultValues:()=>ar(a.defaultValues)&&a.defaultValues().then(X=>{Dt(X,a.resetOptions),v.state.next({isLoading:!1})}),_removeUnmounted:F,_disableForm:ge,_subjects:v,_proxyFormState:x,get _fields(){return r},get _formValues(){return o},get _state(){return d},set _state(X){d=X},get _defaultValues(){return l},get _names(){return u},set _names(X){u=X},get _formState(){return s},get _options(){return a},set _options(X){a={...a,...X}}},subscribe:K,trigger:re,register:je,handleSubmit:Be,watch:ie,setValue:O,getValues:Q,reset:Dt,resetField:ke,clearErrors:M,unregister:oe,setError:W,setFocus:kt,getFieldState:q};return{...Vt,formControl:Vt}}function zY(t={}){const a=te.useRef(void 0),s=te.useRef(void 0),[r,l]=te.useState({isDirty:!1,isValidating:!1,isLoading:ar(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:ar(t.defaultValues)?void 0:t.defaultValues});if(!a.current)if(t.formControl)a.current={...t.formControl,formState:r},t.defaultValues&&!ar(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:d,...u}=IY(t);a.current={...u,formState:r}}const o=a.current.control;return o._options=t,vY(()=>{const d=o._subscribe({formState:o._proxyFormState,callback:()=>l({...o._formState}),reRenderRoot:!0});return l(u=>({...u,isReady:!0})),o._formState.isReady=!0,d},[o]),te.useEffect(()=>o._disableForm(t.disabled),[o,t.disabled]),te.useEffect(()=>{t.mode&&(o._options.mode=t.mode),t.reValidateMode&&(o._options.reValidateMode=t.reValidateMode)},[o,t.mode,t.reValidateMode]),te.useEffect(()=>{t.errors&&(o._setErrors(t.errors),o._focusError())},[o,t.errors]),te.useEffect(()=>{t.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,t.shouldUnregister]),te.useEffect(()=>{if(o._proxyFormState.isDirty){const d=o._getDirty();d!==r.isDirty&&o._subjects.state.next({isDirty:d})}},[o,r.isDirty]),te.useEffect(()=>{var d;t.values&&!ll(t.values,s.current)?(o._reset(t.values,{keepFieldsRef:!0,...o._options.resetOptions}),!((d=o._options.resetOptions)===null||d===void 0)&&d.keepIsValid||o._setValid(),s.current=t.values,l(u=>({...u}))):o._resetDefaultValues()},[o,t.values]),te.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),a.current.formState=yY(r,o),a.current}const LY={"--background":"0 0% 100%","--foreground":"222.2 84% 4.9%","--card":"0 0% 100%","--card-foreground":"222.2 84% 4.9%","--popover":"0 0% 100%","--popover-foreground":"222.2 84% 4.9%","--primary":"262.1 83.3% 57.8%","--primary-foreground":"210 40% 98%","--secondary":"220 14.3% 95.9%","--secondary-foreground":"222.2 47.4% 11.2%","--muted":"220 14.3% 95.9%","--muted-foreground":"220 8.9% 46.1%","--accent":"220 14.3% 95.9%","--accent-foreground":"222.2 47.4% 11.2%","--destructive":"0 84.2% 60.2%","--destructive-foreground":"210 40% 98%","--border":"220 13% 91%","--input":"220 13% 91%","--ring":"262.1 83.3% 57.8%","--radius":"0.75rem","--chart-1":"262.1 83.3% 57.8%","--chart-2":"173 58% 39%","--chart-3":"197 37% 24%","--chart-4":"43 74% 66%","--chart-5":"27 87% 67%","--desktop-nav-width":"64px","--font-family":"system-ui, sans-serif"},PY={"--background":"0 0% 100%","--foreground":"222.2 84% 4.9%","--primary":"212 100% 50%","--primary-foreground":"210 40% 98%","--secondary":"220 14% 95%","--secondary-foreground":"222.2 47.4% 11.2%","--muted":"220 14.3% 95.9%","--muted-foreground":"220 8.9% 46.1%","--accent":"212 100% 50%","--accent-foreground":"210 40% 98%","--border":"220 13% 91%","--input":"220 13% 91%","--ring":"212 100% 60%","--font-family":"'Menlo', 'Courier New', monospace"},Wg={default:LY,programmer:PY},qk=p.createContext(null),TC="life-tracker-theme",BY=()=>{const t=p.useContext(qk);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t},$Y=({children:t,defaultTheme:a="default"})=>{const[s,r]=p.useState(a);p.useEffect(()=>{try{const o=localStorage.getItem(TC);o&&Object.keys(Wg).includes(o)&&r(o)}catch(o){console.error("Error loading theme from localStorage:",o)}},[]),p.useEffect(()=>{const o=Wg[s]||Wg[a];Object.entries(o).forEach(([d,u])=>{document.documentElement.style.setProperty(d,u)})},[s,a]);const l=p.useCallback(o=>{r(o);try{localStorage.setItem(TC,o)}catch(d){console.error("Error saving theme to localStorage:",d)}},[]);return e.jsx(qk.Provider,{value:{theme:s,setTheme:l},children:t})};function DC({onAdd:t,trigger:a}){const[s,r]=p.useState(!1),[l,o]=p.useState(""),[d,u]=p.useState(""),[m,h]=p.useState(Ig[0]),[g,x]=p.useState(null),y=b=>{if(b.preventDefault(),x(null),!l.trim()){x("El nombre del calendario es obligatorio");return}if(!d.trim()){x("La URL del calendario es obligatoria");return}if(!I2(d)){x("La URL debe ser una URL pblica de Google Calendar en formato iCal (HTTPS)");return}t(l.trim(),d.trim(),m),o(""),u(""),h(Ig[0]),r(!1)},v=b=>{r(b),b||x(null)};return e.jsxs(Mt,{open:s,onOpenChange:v,children:[e.jsx(FE,{asChild:!0,children:a||e.jsxs(P,{children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),"Agregar Calendario"]})}),e.jsx(Tt,{className:"sm:max-w-[500px]",children:e.jsxs("form",{onSubmit:y,children:[e.jsxs(Ot,{children:[e.jsx(Rt,{children:"Agregar Calendario Externo"}),e.jsx(Ms,{children:"Agrega un calendario de Google Calendar mediante su URL pblica en formato iCal."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"calendar-name",children:"Nombre del Calendario"}),e.jsx(ye,{id:"calendar-name",placeholder:"Ej: Calendario Laboral",value:l,onChange:b=>o(b.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"calendar-url",children:"URL Pblica (iCal)"}),e.jsx(ye,{id:"calendar-url",type:"url",placeholder:"https://calendar.google.com/calendar/ical/...",value:d,onChange:b=>u(b.target.value),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Debe ser una URL HTTPS que termine en .ics"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{children:"Color"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:Ig.map(b=>e.jsx("button",{type:"button",className:"w-8 h-8 rounded-full border-2 transition-all hover:scale-110",style:{backgroundColor:b,borderColor:m===b?"#000":"transparent"},onClick:()=>h(b),"aria-label":`Select color ${b}`},b))})]}),e.jsxs(ao,{children:[e.jsx(YM,{className:"h-4 w-4"}),e.jsxs(so,{className:"text-xs",children:[e.jsx("strong",{children:"Cmo obtener la URL?"}),e.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[e.jsx("li",{children:"Abre Google Calendar en tu navegador"}),e.jsx("li",{children:"Ve a Configuracin  Configuracin del calendario"}),e.jsx("li",{children:"Selecciona el calendario que deseas agregar"}),e.jsx("li",{children:'En "Integrar calendario", copia la "Direccin secreta en formato iCal"'})]}),e.jsxs("p",{className:"mt-2 text-muted-foreground",children:[e.jsx("strong",{children:"Nota:"})," La sincronizacin usa un proxy (corsproxy.io) para resolver restricciones CORS del navegador."]})]})]}),e.jsxs(ao,{variant:"destructive",children:[e.jsx(hc,{className:"h-4 w-4"}),e.jsxs(so,{className:"text-xs",children:[e.jsx("strong",{children:"Advertencia de Privacidad:"}),' Al usar calendarios pblicos, cualquier persona con la URL puede ver tus eventos. Para calendarios laborales, puedes usar el modo "mostrar solo si estoy ocupado o libre" en Google Calendar para ocultar detalles de eventos.']})]}),g&&e.jsxs(ao,{variant:"destructive",children:[e.jsx(hc,{className:"h-4 w-4"}),e.jsx(so,{children:g})]})]}),e.jsxs(Cs,{children:[e.jsx(P,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancelar"}),e.jsx(P,{type:"submit",children:"Agregar"})]})]})})]})}var tp="Switch",[HY,L7]=vi(tp),[UY,VY]=HY(tp),Fk=p.forwardRef((t,a)=>{const{__scopeSwitch:s,name:r,checked:l,defaultChecked:o,required:d,disabled:u,value:m="on",onCheckedChange:h,form:g,...x}=t,[y,v]=p.useState(null),b=Sa(a,T=>v(T)),N=p.useRef(!1),S=y?g||!!y.closest("form"):!0,[w,E]=Mr({prop:l,defaultProp:o??!1,onChange:h,caller:tp});return e.jsxs(UY,{scope:s,checked:w,disabled:u,children:[e.jsx(Gt.button,{type:"button",role:"switch","aria-checked":w,"aria-required":d,"data-state":Xk(w),"data-disabled":u?"":void 0,disabled:u,value:m,...x,ref:b,onClick:Nt(t.onClick,T=>{E(D=>!D),S&&(N.current=T.isPropagationStopped(),N.current||T.stopPropagation())})}),S&&e.jsx(Kk,{control:y,bubbles:!N.current,name:r,value:m,checked:w,required:d,disabled:u,form:g,style:{transform:"translateX(-100%)"}})]})});Fk.displayName=tp;var Gk="SwitchThumb",Wk=p.forwardRef((t,a)=>{const{__scopeSwitch:s,...r}=t,l=VY(Gk,s);return e.jsx(Gt.span,{"data-state":Xk(l.checked),"data-disabled":l.disabled?"":void 0,...r,ref:a})});Wk.displayName=Gk;var YY="SwitchBubbleInput",Kk=p.forwardRef(({__scopeSwitch:t,control:a,checked:s,bubbles:r=!0,...l},o)=>{const d=p.useRef(null),u=Sa(d,o),m=by(s),h=OC(a);return p.useEffect(()=>{const g=d.current;if(!g)return;const x=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(x,"checked").set;if(m!==s&&v){const b=new Event("click",{bubbles:r});v.call(g,s),g.dispatchEvent(b)}},[m,s,r]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...l,tabIndex:-1,ref:u,style:{...l.style,...h,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Kk.displayName=YY;function Xk(t){return t?"checked":"unchecked"}var Qk=Fk,qY=Wk;const xv=p.forwardRef(({className:t,...a},s)=>e.jsx(Qk,{className:he("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:e.jsx(qY,{className:he("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));xv.displayName=Qk.displayName;function FY({calendar:t,onToggle:a,onRemove:s,onSync:r,isSyncing:l=!1}){const o=t.lastSyncedAt?`Sincronizado ${JC(t.lastSyncedAt,{locale:As,addSuffix:!0})}`:"Nunca sincronizado";return e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[e.jsx("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:t.color}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium truncate",children:t.name}),!t.enabled&&e.jsx(wt,{variant:"secondary",className:"text-xs",children:"Deshabilitado"})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:t.url}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:o})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(P,{variant:"ghost",size:"sm",onClick:()=>r(t.id),disabled:l,children:e.jsx(io,{className:`w-4 h-4 ${l?"animate-spin":""}`})}),e.jsx(xv,{checked:t.enabled,onCheckedChange:()=>a(t.id)}),e.jsxs(Ir,{children:[e.jsx(Ni,{asChild:!0,children:e.jsx(P,{variant:"ghost",size:"sm",children:e.jsx(Sn,{className:"w-4 h-4 text-destructive"})})}),e.jsxs(dr,{children:[e.jsxs(ur,{children:[e.jsx(hr,{children:"Eliminar calendario?"}),e.jsxs(fr,{children:['Se eliminar "',t.name,'" y todos sus eventos de Life Tracker. Esta accin no afecta tu calendario en Google Calendar.']})]}),e.jsxs(mr,{children:[e.jsx(xr,{children:"Cancelar"}),e.jsx(pr,{onClick:()=>s(t.id),children:"Eliminar"})]})]})]})]})]})}const GY=()=>{const{settings:t,saveSettings:a}=ck(),{setTheme:s}=BY(),{user:r,signOut:l}=st(),o=it(),{register:d,handleSubmit:u,reset:m}=zY(),{calendars:h,addCalendar:g,toggleCalendar:x,removeCalendar:y,syncCalendar:v,syncAllCalendars:b,syncStatus:N,lastSyncTime:S}=z2();p.useEffect(()=>{t&&m(t)},[t,m]);const w=async D=>{try{await a(D),D.theme&&s(D.theme)}catch(k){console.error("Error al guardar configuracin:",k)}},E=async()=>{try{await l(),o(ae.auth.login)}catch(D){console.error("Error al cerrar sesin:",D)}},T=D=>D?D.split(" ").map(k=>k.charAt(0)).join("").toUpperCase().slice(0,2):"U";return e.jsx(wi,{children:e.jsxs("div",{className:"space-y-6 max-w-md",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Perfil y Configuracin"}),e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-white rounded-lg shadow-sm border",children:[e.jsx("div",{className:"relative",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold text-xl border-2 border-gray-200",children:T(r?.email||null)})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:r?.email?.split("@")[0]||"Usuario"}),e.jsx("p",{className:"text-sm text-gray-600",children:r?.email})]})]}),e.jsxs("form",{onSubmit:u(w),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"name",children:"Nombre"}),e.jsx(ye,{id:"name",...d("name")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"birthDate",children:"Fecha de nacimiento"}),e.jsx(ye,{id:"birthDate",type:"date",...d("birthDate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"lifeExpectancyYears",children:"Expectativa de vida (aos)"}),e.jsx(ye,{id:"lifeExpectancyYears",type:"number",min:1,max:150,step:1,...d("lifeExpectancyYears",{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"theme",children:"Tema"}),e.jsxs("select",{id:"theme",className:"border rounded-md p-2",...d("theme"),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"programmer",children:"Programador Claro"})]})]}),e.jsx(P,{type:"submit",children:"Guardar"})]}),e.jsxs("div",{className:"space-y-4 pt-6 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Calendarios Externos"}),e.jsx(L2,{onSync:b,syncStatus:N,lastSyncTime:S,variant:"outline",size:"sm"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sincroniza eventos de Google Calendar mediante URLs pblicas en formato iCal."}),h.length===0?e.jsxs("div",{className:"text-center py-8 border-2 border-dashed rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"No hay calendarios configurados"}),e.jsx(DC,{onAdd:g})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2",children:h.map(D=>e.jsx(FY,{calendar:D,onToggle:x,onRemove:y,onSync:v,isSyncing:N==="syncing"},D.id))}),e.jsx(DC,{onAdd:g})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(P,{variant:"destructive",onClick:E,className:"w-full",children:[e.jsx(qM,{className:"w-4 h-4 mr-2"}),"Cerrar Sesin"]})})]})})},WY={module:"settings",defaultRoute:ae.settings,moduleRoutes:[{path:"settings",element:e.jsx(GY,{})}]};class Ha{static client=ze;static table(a){return ze.from(a)}}const Kg=t=>({id:t.id,userId:t.user_id,name:t.name,sortOrder:t.sort_order??0,contactFrequencyDays:t.contact_frequency_days??void 0,description:t.description??void 0,createdAt:t.created_at??void 0,updatedAt:t.updated_at??void 0}),Fl=t=>({id:t.id,userId:t.user_id,circleId:t.circle_id,fullName:t.full_name,nickname:t.nickname??void 0,category:t.category,birthdayDate:t.birthday_date??void 0,birthdayMonth:t.birthday_month??void 0,birthdayDay:t.birthday_day??void 0,lastContactAt:t.last_contact_at??void 0,nextContactSuggestedAt:t.next_contact_suggested_at??void 0,notes:Array.isArray(t.notes)?t.notes:[],isArchived:!!t.is_archived,archivedAt:t.archived_at??void 0,createdAt:t.created_at??void 0,updatedAt:t.updated_at??void 0}),Xg=t=>({id:t.id,userId:t.user_id,relationshipId:t.relationship_id,title:t.title,eventType:t.event_type,eventDate:t.event_date,startDate:t.start_date??void 0,endDate:t.end_date??void 0,isArchived:!!t.is_archived,archivedAt:t.archived_at??void 0,createdAt:t.created_at??void 0,updatedAt:t.updated_at??void 0}),Qg=t=>({id:t.id,userId:t.user_id,relationshipId:t.relationship_id,taskId:t.task_id,createdAt:t.created_at??void 0,updatedAt:t.updated_at??void 0}),Zg=t=>({id:t.id,userId:t.user_id,title:t.title,completed:!!t.completed,isPrivate:!!t.is_private,category:t.category??void 0,startDate:t.start_date??void 0,endDate:t.end_date??void 0,createdAt:t.created_at??void 0,updatedAt:t.updated_at??void 0}),Zk=()=>{const{user:t}=st(),[a,s]=p.useState([]),[r,l]=p.useState([]),[o,d]=p.useState([]),[u,m]=p.useState([]),[h,g]=p.useState({}),[x,y]=p.useState("idle"),[v,b]=p.useState(null),[N,S]=p.useState(!1),w=p.useCallback(async()=>{if(t){y("loading"),b(null),S(!1);try{const[Q,q,M,W]=await Promise.all([Ha.table("circles").select("*").eq("user_id",t.id).order("sort_order",{ascending:!0}).order("name",{ascending:!0}),Ha.table("relationships").select("*").eq("user_id",t.id).order("full_name",{ascending:!0}),Ha.table("events").select("*").eq("user_id",t.id).order("event_date",{ascending:!1}),Ha.table("relationship_tasks").select("*").eq("user_id",t.id)]);if(Q.error)throw Q.error;if(q.error)throw q.error;if(M.error)throw M.error;if(W.error)throw W.error;const ie=(Q.data||[]).map(Kg),ve=(q.data||[]).map(Fl),K=(M.data||[]).map(Xg),oe=(W.data||[]).map(Qg),_e=Array.from(new Set(oe.map(Ie=>Ie.taskId)));let je={};if(_e.length>0){const Ie=await Ha.table("tasks").select("*").eq("user_id",t.id).in("id",_e);if(Ie.error)throw Ie.error;je=(Ie.data||[]).reduce((ge,Be)=>(ge[Be.id]=Zg(Be),ge),{})}s(ie),l(ve),d(K),m(oe),g(je),y("idle"),S(!0)}catch(Q){b(Q instanceof Error?Q.message:"Error al cargar relaciones"),y("error"),S(!0)}}},[t]);p.useEffect(()=>{if(!t){s([]),l([]),d([]),m([]),g({}),S(!1);return}w()},[t,w]);const E=p.useCallback(async Q=>{if(t){y("saving"),b(null);try{const{data:q,error:M}=await Ha.table("circles").insert({user_id:t.id,name:Q.name.trim(),sort_order:Q.sortOrder,contact_frequency_days:Q.contactFrequencyDays||null,description:Q.description?.trim()||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("*").single();if(M)throw M;s(W=>[...W,Kg(q)].sort((ie,ve)=>ie.sortOrder-ve.sortOrder||ie.name.localeCompare(ve.name))),y("idle")}catch(q){b(q instanceof Error?q.message:"No se pudo crear el crculo"),y("error")}}},[t]),T=p.useCallback(async(Q,q)=>{if(t){y("saving"),b(null);try{const M={updated_at:new Date().toISOString()};q.name!==void 0&&(M.name=q.name.trim()),q.sortOrder!==void 0&&(M.sort_order=q.sortOrder),q.contactFrequencyDays!==void 0&&(M.contact_frequency_days=q.contactFrequencyDays||null),q.description!==void 0&&(M.description=q.description?.trim()||null);const{data:W,error:ie}=await Ha.table("circles").update(M).eq("id",Q).eq("user_id",t.id).select("*").single();if(ie)throw ie;const ve=Kg(W);s(K=>K.map(oe=>oe.id===Q?ve:oe).sort((oe,_e)=>oe.sortOrder-_e.sortOrder||oe.name.localeCompare(_e.name))),y("idle")}catch(M){b(M instanceof Error?M.message:"No se pudo actualizar el crculo"),y("error")}}},[t]),D=p.useCallback(async Q=>{if(t){y("saving"),b(null);try{const{error:q}=await Ha.table("circles").delete().eq("id",Q).eq("user_id",t.id);if(q)throw q;s(M=>M.filter(W=>W.id!==Q)),y("idle")}catch(q){b(q instanceof Error?q.message:"No se pudo eliminar el crculo"),y("error")}}},[t]),k=p.useCallback(async Q=>{if(t){y("saving"),b(null);try{const{data:q,error:M}=await Ha.table("relationships").insert({user_id:t.id,circle_id:Q.circleId,full_name:Q.fullName.trim(),nickname:Q.nickname?.trim()||null,category:Q.category,birthday_date:Q.birthdayDate||null,birthday_month:Q.birthdayMonth||null,birthday_day:Q.birthdayDay||null,last_contact_at:Q.lastContactAt||null,next_contact_suggested_at:Q.nextContactSuggestedAt||null,notes:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("*").single();if(M)throw M;l(W=>[...W,Fl(q)].sort((ie,ve)=>ie.fullName.localeCompare(ve.fullName))),y("idle")}catch(q){b(q instanceof Error?q.message:"No se pudo crear la persona"),y("error")}}},[t]),_=p.useCallback(async(Q,q)=>{if(t){y("saving"),b(null);try{const M={updated_at:new Date().toISOString()};q.circleId!==void 0&&(M.circle_id=q.circleId),q.fullName!==void 0&&(M.full_name=q.fullName.trim()),q.nickname!==void 0&&(M.nickname=q.nickname?.trim()||null),q.category!==void 0&&(M.category=q.category),q.birthdayDate!==void 0&&(M.birthday_date=q.birthdayDate||null),q.birthdayMonth!==void 0&&(M.birthday_month=q.birthdayMonth||null),q.birthdayDay!==void 0&&(M.birthday_day=q.birthdayDay||null),q.lastContactAt!==void 0&&(M.last_contact_at=q.lastContactAt||null),q.nextContactSuggestedAt!==void 0&&(M.next_contact_suggested_at=q.nextContactSuggestedAt||null);const{data:W,error:ie}=await Ha.table("relationships").update(M).eq("id",Q).eq("user_id",t.id).select("*").single();if(ie)throw ie;const ve=Fl(W);l(K=>K.map(oe=>oe.id===Q?ve:oe)),y("idle")}catch(M){b(M instanceof Error?M.message:"No se pudo actualizar la persona"),y("error")}}},[t]),R=p.useCallback(async(Q,q)=>{if(!t)return;y("saving"),b(null);const M=new Date().toISOString();try{const{data:W,error:ie}=await Ha.table("relationships").update({is_archived:q,archived_at:q?M:null,updated_at:M}).eq("id",Q).eq("user_id",t.id).select("*").single();if(ie)throw ie;if(q){const{error:K}=await Ha.table("events").update({is_archived:!0,archived_at:M,updated_at:M}).eq("relationship_id",Q).eq("user_id",t.id);if(K)throw K;d(oe=>oe.map(_e=>_e.relationshipId===Q?{..._e,isArchived:!0,archivedAt:M,updatedAt:M}:_e))}const ve=Fl(W);l(K=>K.map(oe=>oe.id===Q?ve:oe)),y("idle")}catch(W){b(W instanceof Error?W.message:"No se pudo archivar/desarchivar"),y("error")}},[t]),L=p.useCallback(async(Q,q)=>{if(!(!t||!q.trim())){y("saving"),b(null);try{const M=r.find(oe=>oe.id===Q);if(!M)throw new Error("Persona no encontrada");const W=[...M.notes||[],{timestamp:new Date().toISOString(),text:q.trim()}],{data:ie,error:ve}=await Ha.table("relationships").update({notes:W,updated_at:new Date().toISOString()}).eq("id",Q).eq("user_id",t.id).select("*").single();if(ve)throw ve;const K=Fl(ie);l(oe=>oe.map(_e=>_e.id===Q?K:_e)),y("idle")}catch(M){b(M instanceof Error?M.message:"No se pudo agregar la nota"),y("error")}}},[t,r]),U=p.useCallback(async(Q,q)=>{if(!(!t||!q.text.trim())){y("saving"),b(null);try{const M=r.find(je=>je.id===Q);if(!M)throw new Error("Persona no encontrada");const W=new Date().toISOString(),ie=q.timestamp||W,ve=[...M.notes||[],{timestamp:ie,text:q.text.trim()}],{data:K,error:oe}=await Ha.table("relationships").update({notes:ve,last_contact_at:q.lastContactAt||null,next_contact_suggested_at:q.nextContactSuggestedAt||null,updated_at:W}).eq("id",Q).eq("user_id",t.id).select("*").single();if(oe)throw oe;const _e=Fl(K);l(je=>je.map(Ie=>Ie.id===Q?_e:Ie)),y("idle")}catch(M){throw b(M instanceof Error?M.message:"No se pudo guardar la nota y las fechas"),y("error"),M}}},[t,r]),V=p.useCallback(async(Q,q)=>{if(!(!t||!q.text.trim())){y("saving"),b(null);try{const M=r.find(oe=>oe.id===Q);if(!M)throw new Error("Persona no encontrada");if(q.noteIndex<0||q.noteIndex>=(M.notes||[]).length)throw new Error("ndice de nota invlido");const W=[...M.notes||[]];W[q.noteIndex]={timestamp:q.timestamp,text:q.text.trim()};const{data:ie,error:ve}=await Ha.table("relationships").update({notes:W,updated_at:new Date().toISOString()}).eq("id",Q).eq("user_id",t.id).select("*").single();if(ve)throw ve;const K=Fl(ie);l(oe=>oe.map(_e=>_e.id===Q?K:_e)),y("idle")}catch(M){throw b(M instanceof Error?M.message:"No se pudo actualizar la nota"),y("error"),M}}},[t,r]),F=p.useCallback(async Q=>{if(t){y("saving"),b(null);try{const{data:q,error:M}=await Ha.table("events").insert({user_id:t.id,relationship_id:Q.relationshipId,title:Q.title.trim(),event_type:Q.eventType,event_date:Q.eventDate,start_date:Q.startDate||null,end_date:Q.endDate||null,is_archived:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("*").single();if(M)throw M;d(W=>[Xg(q),...W]),y("idle")}catch(q){b(q instanceof Error?q.message:"No se pudo crear el evento"),y("error")}}},[t]),G=p.useCallback(async(Q,q)=>{if(!t)return;y("saving"),b(null);const M=new Date().toISOString();try{const{data:W,error:ie}=await Ha.table("events").update({is_archived:q,archived_at:q?M:null,updated_at:M}).eq("id",Q).eq("user_id",t.id).select("*").single();if(ie)throw ie;const ve=Xg(W);d(K=>K.map(oe=>oe.id===Q?ve:oe)),y("idle")}catch(W){b(W instanceof Error?W.message:"No se pudo actualizar el evento"),y("error")}},[t]),$=p.useCallback(Q=>u.filter(M=>M.relationshipId===Q).map(M=>M.taskId).map(M=>h[M]).filter(Boolean).sort((M,W)=>M.completed===W.completed?(W.updatedAt||"").localeCompare(M.updatedAt||""):M.completed?1:-1),[u,h]),z=p.useCallback(Q=>{const q=new Set(u.filter(M=>M.relationshipId===Q).map(M=>M.taskId));return Object.values(h).filter(M=>M.isPrivate&&!q.has(M.id)).sort((M,W)=>M.title.localeCompare(W.title))},[u,h]),H=p.useCallback(async()=>{if(!t)return;const{data:Q,error:q}=await Ha.table("tasks").select("*").eq("user_id",t.id).eq("is_private",!0).order("updated_at",{ascending:!1}).limit(200);if(q)throw q;const M=(Q||[]).reduce((W,ie)=>(W[ie.id]=Zg(ie),W),{});g(W=>({...W,...M}))},[t]),I=p.useCallback(async(Q,q)=>{if(t){y("saving"),b(null);try{const{data:M,error:W}=await Ha.table("relationship_tasks").insert({user_id:t.id,relationship_id:Q,task_id:q,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select("*").single();if(W)throw W;m(ie=>[...ie,Qg(M)]),await H(),y("idle")}catch(M){b(M instanceof Error?M.message:"No se pudo vincular la tarea"),y("error")}}},[t,H]),O=p.useCallback(async(Q,q)=>{if(t){y("saving"),b(null);try{const{error:M}=await Ha.table("relationship_tasks").delete().eq("user_id",t.id).eq("relationship_id",Q).eq("task_id",q);if(M)throw M;m(W=>W.filter(ie=>!(ie.relationshipId===Q&&ie.taskId===q))),y("idle")}catch(M){b(M instanceof Error?M.message:"No se pudo desvincular la tarea"),y("error")}}},[t]),Y=p.useCallback(async(Q,q,M=!0)=>{if(t){y("saving"),b(null);try{const W=await Iy(t.id),ie=new Date().toISOString(),{data:ve,error:K}=await Ha.table("tasks").insert({user_id:t.id,task_code:W,title:q.title.trim(),completed:!1,category:q.category||"social",priority:"delete",size:"pequea",progress:0,is_private:q.isPrivate??M,is_recurrent:!1,created_at:ie,updated_at:ie}).select("*").single();if(K)throw K;const oe=Zg(ve),{data:_e,error:je}=await Ha.table("relationship_tasks").insert({user_id:t.id,relationship_id:Q,task_id:oe.id,created_at:ie,updated_at:ie}).select("*").single();if(je)throw je;g(Ie=>({...Ie,[oe.id]:oe})),m(Ie=>[...Ie,Qg(_e)]),y("idle")}catch(W){b(W instanceof Error?W.message:"No se pudo crear/vincular la tarea"),y("error")}}},[t]),le=p.useMemo(()=>r.reduce((Q,q)=>{const M=q.circleId;return Q[M]||(Q[M]=[]),Q[M].push(q),Q},{}),[r]),re=p.useCallback(Q=>r.find(q=>q.id===Q),[r]);return{circles:a,relationships:r,relationshipsByCircle:le,events:o,taskLinks:u,tasksById:h,isLoaded:N,status:x,error:v,loadAll:w,addCircle:E,updateCircle:T,deleteCircle:D,addRelationship:k,updateRelationship:_,setRelationshipArchived:R,appendNote:L,addNoteWithContactUpdate:U,updateNote:V,addEvent:F,setEventArchived:G,getRelatedTasks:$,getAvailablePrivateTasks:z,linkExistingTask:I,unlinkTask:O,createRelatedTask:Y,getRelationshipById:re}},du={FAMILY:"familia",FRIENDSHIP:"amistad",SOCIAL:"social"},uu={familia:"Familia",amistad:"Amistad",social:"Social"},Jg={BIRTHDAY:"birthday",EXAM:"exam",SURGERY:"surgery",TRAVEL:"travel",GRIEF:"grief",MEDICAL_CHECK:"medical_check",CUSTOM:"custom"},kC={birthday:"Cumpleaos",exam:"Examen",surgery:"Ciruga",travel:"Viaje",grief:"Duelo",medical_check:"Chequeo mdico",custom:"Personalizado"},e0={OVERDUE:"overdue",EVENTS_WEEK:"events_week",NO_NEXT_CONTACT:"no_next_contact"},bc=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate()),KY=/^\d{4}-\d{2}-\d{2}$/,Cl=t=>{if(KY.test(t)){const[a,s,r]=t.split("-").map(Number);return new Date(a,s-1,r)}return new Date(t)},jc=t=>{if(!t)return null;const a=bc(Cl(t)),s=bc(new Date);return Math.floor((a.getTime()-s.getTime())/864e5)},gv=t=>{const a=jc(t);return a===null?"unscheduled":a<0?"overdue":a<=2?"due_soon":"upcoming"},XY=(t,a=7)=>{if(t.length===0)return!1;const s=bc(new Date),r=new Date(s);return r.setDate(r.getDate()+a),t.some(l=>{if(l.isArchived)return!1;const o=bc(Cl(l.eventDate));return o.getTime()>=s.getTime()&&o.getTime()<=r.getTime()})},QY=t=>gv(t.nextContactSuggestedAt)==="overdue",mi=t=>t?Cl(t).toLocaleDateString("es-CO",{day:"2-digit",month:"short",year:"numeric"}):"Sin fecha",ZY=t=>{if(!t)return"Sin registro";const a=jc(t);if(a===null)return mi(t);const s=Math.abs(a);return s===0?`${mi(t)} (hoy)`:a<0?`${mi(t)} (hace ${s} da${s===1?"":"s"})`:`${mi(t)} (en ${a} da${a===1?"":"s"})`},JY=t=>{const a=jc(t),s=gv(t);return a===null?{urgency:s,label:"Sin definir",className:"text-gray-600",dot:"bg-gray-400"}:a<0?{urgency:s,label:`${mi(t)} (vencido ${Math.abs(a)}d)`,className:"text-red-700",dot:"bg-red-500"}:a<=2?{urgency:s,label:a===0?`${mi(t)} (hoy)`:`${mi(t)} (en ${a}d)`,className:"text-amber-700",dot:"bg-amber-500"}:{urgency:s,label:`${mi(t)} (en ${a}d)`,className:"text-emerald-700",dot:"bg-emerald-500"}},e7=t=>t==="overdue"?{cardClassName:"border-red-300 bg-red-50/60 shadow-[0_0_0_1px_rgba(239,68,68,0.08)]",icon:e.jsx(oy,{className:"h-4 w-4 text-red-600"}),pulse:!0}:t==="due_soon"?{cardClassName:"border-amber-300 bg-amber-50/60",icon:e.jsx(lw,{className:"h-4 w-4 text-amber-600"}),pulse:!1}:t==="upcoming"?{cardClassName:"border-emerald-300 bg-emerald-50/50",icon:e.jsx(d0,{className:"h-4 w-4 text-emerald-600"}),pulse:!1}:{cardClassName:"border-slate-300 bg-white",icon:e.jsx(lw,{className:"h-4 w-4 text-slate-500"}),pulse:!1},t7=t=>{if(t.length===0)return null;const a=bc(new Date),s=t.map(o=>({event:o,date:bc(Cl(o.eventDate))})),r=s.filter(o=>o.date.getTime()>=a.getTime()).sort((o,d)=>o.date.getTime()-d.date.getTime());return r.length>0?r[0].event:s.sort((o,d)=>d.date.getTime()-o.date.getTime())[0]?.event||null},a7=({status:t,activeFilters:a,onToggleFilter:s,showArchived:r,onToggleArchived:l,searchQuery:o,onSearchChange:d,onCreateContact:u,onCreateCircle:m})=>e.jsx(fe,{className:"border-2 border-slate-200",children:e.jsxs(xe,{className:"p-4 flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-sky-500 to-indigo-600 flex items-center justify-center text-white",children:e.jsx(mu,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Relaciones"}),t!=="idle"&&t!=="error"&&e.jsx("p",{className:"text-xs text-slate-500",children:t==="loading"?"Cargando...":t==="saving"?"Guardando...":t})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"relative min-w-64",children:[e.jsx(fo,{className:"h-4 w-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"}),e.jsx(ye,{value:o,onChange:h=>d(h.target.value),placeholder:"Buscar por nombre o apodo",className:"pl-9"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(P,{size:"sm",variant:a.includes("overdue")?"default":"outline",onClick:()=>s("overdue"),className:a.includes("overdue")?"bg-red-600 hover:bg-red-700":"",children:"Vencidos"}),e.jsx(P,{size:"sm",variant:a.includes("events_week")?"default":"outline",onClick:()=>s("events_week"),className:a.includes("events_week")?"bg-amber-600 hover:bg-amber-700":"",children:"Eventos esta semana"}),e.jsx(P,{size:"sm",variant:a.includes("no_next_contact")?"default":"outline",onClick:()=>s("no_next_contact"),className:a.includes("no_next_contact")?"bg-slate-700 hover:bg-slate-800":"",children:"Sin prximo contacto"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsx(P,{variant:"outline",onClick:l,children:r?"Ocultar archivados":"Mostrar archivados"}),e.jsxs(P,{variant:"outline",onClick:m,children:[e.jsx(It,{className:"h-4 w-4 mr-1"}),"Nuevo crculo"]}),e.jsxs(P,{onClick:u,children:[e.jsx(It,{className:"h-4 w-4 mr-1"}),"Nuevo"]})]})]})}),s7=({circles:t,selectedCircleId:a,counts:s,overdueCounts:r,onSelectCircle:l,onAddCircle:o,onEditCircle:d,onDeleteCircle:u})=>e.jsxs(fe,{className:"h-full",children:[e.jsx(xt,{className:"pb-2",children:e.jsx(mt,{className:"text-lg",children:"Crculos"})}),e.jsxs(xe,{className:"space-y-2",children:[e.jsxs("button",{type:"button",onClick:()=>l("all"),className:`w-full rounded-xl border px-3 py-2 text-left transition-colors ${a==="all"?"border-sky-500 bg-sky-50 text-sky-900":"border-slate-200 hover:bg-slate-50"}`,children:[e.jsx("div",{className:"font-medium text-sm",children:"Todos los crculos"}),e.jsxs("div",{className:"text-xs text-slate-500",children:[Object.values(s).reduce((m,h)=>m+h,0)," contactos"]})]}),t.map(m=>e.jsxs("div",{className:`w-full text-left rounded-xl border px-3 py-2 transition-colors ${a===m.id?"border-sky-500 bg-sky-50 text-sky-900":"border-slate-200 hover:bg-slate-50"}`,children:[e.jsxs("button",{type:"button",onClick:()=>l(m.id),className:"w-full text-left",children:[e.jsxs("div",{className:"font-medium text-sm flex items-center justify-between gap-2",children:[e.jsx("span",{children:m.name}),(r[m.id]||0)>0&&e.jsx("span",{className:"inline-flex min-w-5 items-center justify-center rounded-full bg-red-100 px-1.5 py-0.5 text-[10px] font-semibold text-red-700",children:r[m.id]})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:[s[m.id]||0," contactos"]})]}),e.jsxs("div",{className:"mt-2 flex gap-1",children:[e.jsx(P,{size:"sm",variant:"outline",className:"h-7 px-2 text-xs",onClick:()=>d(m),children:"Editar"}),e.jsx(P,{size:"sm",variant:"outline",className:"h-7 px-2 text-xs",onClick:()=>u(m),children:"Eliminar"})]})]},m.id)),e.jsxs(P,{className:"w-full mt-3",variant:"outline",onClick:o,children:[e.jsx(It,{className:"h-4 w-4 mr-1"}),"Agregar crculo"]})]})]}),n7=({person:t,upcomingEvent:a,onOpen:s})=>{const r=JY(t.nextContactSuggestedAt),l=e7(r.urgency);return e.jsxs("button",{type:"button",onClick:s,className:`w-full rounded-2xl border text-left p-4 hover:shadow-md transition-shadow ${l.cardClassName}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:t.fullName}),t.nickname&&e.jsxs("p",{className:"text-sm text-slate-500",children:['"',t.nickname,'"']})]}),e.jsx(wt,{variant:"outline",children:uu[t.category]})]}),e.jsxs("div",{className:"mt-3 space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(Aa,{className:"h-4 w-4"}),e.jsxs("span",{children:["ltimo contacto: ",ZY(t.lastContactAt)]})]}),e.jsxs("div",{className:`flex items-center gap-2 ${r.className}`,children:[e.jsx("span",{className:`h-2.5 w-2.5 rounded-full ${r.dot} ${l.pulse?"animate-pulse":""}`}),l.icon,e.jsxs("span",{children:["Prximo contacto: ",r.label]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[e.jsx(zh,{className:"h-4 w-4"}),e.jsxs("span",{children:["Evento prximo:"," ",a?`${a.title} (${mi(a.eventDate)})`:"Sin eventos"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[e.jsx(N1,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.notes.length," notas registradas"]})]})]})]})},r7=({circle:t,people:a,eventsByRelationship:s,onOpenPerson:r})=>a.length===0?null:e.jsxs(fe,{className:"border-slate-300",children:[e.jsx(xt,{className:"pb-2",children:e.jsxs(mt,{className:"flex items-center gap-2 text-xl",children:[e.jsx("span",{className:"h-3 w-3 rounded-full bg-sky-500"}),e.jsx("span",{children:t.name}),t.contactFrequencyDays&&e.jsxs("span",{className:"text-base font-normal text-slate-500",children:["(Contacto cada ",t.contactFrequencyDays," das)"]})]})}),e.jsx(xe,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:a.map(l=>e.jsx(n7,{person:l,upcomingEvent:t7((s[l.id]||[]).filter(o=>!o.isArchived)),onOpen:()=>r(l.id)},l.id))})})]}),i7=(t,a)=>({effectiveSelectedCircleId:p.useMemo(()=>a==="all"?"all":t.some(r=>r.id===a)?a:"all",[a,t])}),l7=()=>{const t=it(),[a,s]=Ef(),{circles:r,relationships:l,relationshipsByCircle:o,events:d,status:u,error:m,addCircle:h,updateCircle:g,deleteCircle:x,addRelationship:y}=Zk(),v=a.get("circle"),b=a.get("archived")==="1",N=a.get("notFound")==="1",[S,w]=p.useState(v||"all"),[E,T]=p.useState(b),[D,k]=p.useState(""),[_,R]=p.useState([]),[L,U]=p.useState(!1),[V,F]=p.useState(!1),[G,$]=p.useState(""),[z,H]=p.useState(0),[I,O]=p.useState(""),[Y,le]=p.useState(""),[re,Q]=p.useState(""),[q,M]=p.useState(""),[W,ie]=p.useState(""),[ve,K]=p.useState(du.SOCIAL),[oe,_e]=p.useState(""),[je,Ie]=p.useState(""),[ge,Be]=p.useState(""),{effectiveSelectedCircleId:ke}=i7(r,S),gt=p.useCallback(Ne=>{const Ve=new URLSearchParams(a),nt=Ne.circle!==void 0?Ne.circle:ke,bt=Ne.archived!==void 0?Ne.archived:E;nt&&nt!=="all"?Ve.set("circle",nt):Ve.delete("circle"),Ve.set("archived",bt?"1":"0"),Ne.removeNotFound&&Ve.delete("notFound"),s(Ve,{replace:!0})},[a,ke,E,s]);p.useEffect(()=>{N&&gt({removeNotFound:!0})},[N,gt]);const Dt=p.useMemo(()=>d.reduce((Ne,Ve)=>(Ne[Ve.relationshipId]||(Ne[Ve.relationshipId]=[]),Ne[Ve.relationshipId].push(Ve),Ne),{}),[d]),kt=p.useMemo(()=>{const Ne=D.trim().toLowerCase();return l.filter(Ve=>{if(!E&&Ve.isArchived||!(!Ne||Ve.fullName.toLowerCase().includes(Ne)||(Ve.nickname||"").toLowerCase().includes(Ne)))return!1;if(_.length===0)return!0;const bt=Dt[Ve.id]||[],Pt={[e0.OVERDUE]:gv(Ve.nextContactSuggestedAt)==="overdue",[e0.EVENTS_WEEK]:XY(bt,7),[e0.NO_NEXT_CONTACT]:!Ve.nextContactSuggestedAt};return _.some(_a=>Pt[_a])})},[l,E,D,_,Dt]),ja=p.useMemo(()=>ke==="all"?kt:kt.filter(Ne=>Ne.circleId===ke),[kt,ke]),Wt=p.useMemo(()=>ja.reduce((Ne,Ve)=>(Ne[Ve.circleId]||(Ne[Ve.circleId]=[]),Ne[Ve.circleId].push(Ve),Ne),{}),[ja]),Vt=p.useMemo(()=>{const Ne=kt.reduce((Ve,nt)=>(Ve[nt.circleId]=(Ve[nt.circleId]||0)+1,Ve),{});return r.reduce((Ve,nt)=>(Ve[nt.id]=Ne[nt.id]||0,Ve),{})},[r,kt]),X=p.useMemo(()=>r.reduce((Ne,Ve)=>{const nt=(o[Ve.id]||[]).filter(bt=>E||!bt.isArchived);return Ne[Ve.id]=nt.filter(bt=>QY(bt)).length,Ne},{}),[r,o,E]),se=p.useMemo(()=>{if(ke!=="all"){const Ne=r.find(Ve=>Ve.id===ke);return Ne?[Ne]:[]}return r.filter(Ne=>(Wt[Ne.id]?.length||0)>0)},[r,ke,Wt]),me=Ne=>{w(Ne),gt({circle:Ne})},Oe=Ne=>{R(Ve=>Ve.includes(Ne)?Ve.filter(nt=>nt!==Ne):[...Ve,Ne])},Re=()=>{const Ne=!E;T(Ne),gt({archived:Ne})},Ee=async()=>{G.trim()&&(await h({name:G,sortOrder:Number.isNaN(z)?0:z,contactFrequencyDays:Y?Number(Y):void 0,description:I||void 0}),$(""),H(0),O(""),le(""),F(!1))},Pe=async Ne=>{const Ve=r.find(dt=>dt.id===Ne);if(!Ve)return;const nt=window.prompt("Nuevo nombre del crculo",Ve.name);if(!nt||!nt.trim())return;const bt=window.prompt("Nuevo orden",String(Ve.sortOrder)),Pt=Number(bt),_a=window.prompt("Frecuencia de contacto en das (vaco para sin regla)",Ve.contactFrequencyDays?String(Ve.contactFrequencyDays):""),Ma=_a?Number(_a):void 0,qe=Ma!==void 0&&Number.isFinite(Ma)?Ma:void 0;await g(Ne,{name:nt.trim(),sortOrder:Number.isFinite(Pt)?Pt:Ve.sortOrder,contactFrequencyDays:qe})},Je=async Ne=>{window.confirm("Eliminar este crculo? Solo funciona si no tiene personas asociadas.")&&await x(Ne)},rt=async()=>{const Ne=re||(ke!=="all"?ke:r[0]?.id);!Ne||!q.trim()||(await y({circleId:Ne,fullName:q,nickname:W||void 0,category:ve,birthdayDate:oe||void 0,birthdayMonth:je?Number(je):void 0,birthdayDay:ge?Number(ge):void 0}),Q(""),M(""),ie(""),K(du.SOCIAL),_e(""),Ie(""),Be(""),U(!1))},Et=Ne=>{const Ve=new URLSearchParams;ke!=="all"&&Ve.set("circle",ke),Ve.set("archived",E?"1":"0"),t(`${ae.relationships.detail(Ne)}?${Ve.toString()}`)},Kt=[{id:"toggle-archived",label:E?"Ocultar archivados":"Mostrar archivados",icon:E?e.jsx(p1,{className:"h-4 w-4"}):e.jsx(Cu,{className:"h-4 w-4"}),onClick:Re,showLabel:!0},{id:"new-circle",label:"Nuevo crculo",icon:e.jsx(It,{className:"h-4 w-4"}),onClick:()=>F(!0),showLabel:!0},{id:"new-contact",label:"Nuevo",icon:e.jsx(It,{className:"h-4 w-4"}),onClick:()=>U(!0),showLabel:!0,className:"bg-black text-white hover:bg-gray-800"}];return e.jsxs(na,{title:"Relaciones",subtitle:"CRM personal",icon:e.jsx(mu,{className:"h-4 w-4 text-white"}),actions:Kt,children:[e.jsxs("div",{className:"p-4 space-y-4",children:[N&&e.jsx(fe,{className:"border-amber-300 bg-amber-50",children:e.jsxs(xe,{className:"p-3 text-sm text-amber-800 flex items-center gap-2",children:[e.jsx(oy,{className:"h-4 w-4"}),e.jsx("span",{children:"Contacto no encontrado o sin acceso."})]})}),m&&e.jsx(fe,{className:"border-red-300 bg-red-50",children:e.jsx(xe,{className:"p-3 text-sm text-red-700",children:m})}),e.jsx(a7,{status:u,activeFilters:_,onToggleFilter:Oe,showArchived:E,onToggleArchived:Re,searchQuery:D,onSearchChange:k,onCreateContact:()=>U(!0),onCreateCircle:()=>F(!0)}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-[280px_1fr]",children:[e.jsx(s7,{circles:r,selectedCircleId:ke,counts:Vt,overdueCounts:X,onSelectCircle:me,onAddCircle:()=>F(!0),onEditCircle:Ne=>Pe(Ne.id),onDeleteCircle:Ne=>Je(Ne.id)}),e.jsxs("div",{className:"space-y-4",children:[se.length===0&&e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-slate-600",children:"No hay contactos para los filtros actuales."})}),se.map(Ne=>e.jsx(r7,{circle:Ne,people:Wt[Ne.id]||[],eventsByRelationship:Dt,onOpenPerson:Et},Ne.id))]})]})]}),e.jsx(Mt,{open:V,onOpenChange:F,children:e.jsxs(Tt,{className:"sm:max-w-lg",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Nuevo crculo"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ye,{placeholder:"Nombre",value:G,onChange:Ne=>$(Ne.target.value)}),e.jsx(ye,{type:"number",placeholder:"Orden",value:z,onChange:Ne=>H(Number(Ne.target.value||0))}),e.jsx(ye,{type:"number",min:1,placeholder:"Frecuencia contacto (das)",value:Y,onChange:Ne=>le(Ne.target.value)}),e.jsx(ye,{placeholder:"Descripcin (opcional)",value:I,onChange:Ne=>O(Ne.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>F(!1),children:"Cancelar"}),e.jsx(P,{onClick:Ee,children:"Crear crculo"})]})]})]})}),e.jsx(Mt,{open:L,onOpenChange:U,children:e.jsxs(Tt,{className:"sm:max-w-lg",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Nuevo contacto"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("select",{value:re||(ke!=="all"?ke:""),onChange:Ne=>Q(Ne.target.value),className:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Selecciona crculo"}),r.map(Ne=>e.jsx("option",{value:Ne.id,children:Ne.name},Ne.id))]}),e.jsx(ye,{placeholder:"Nombre completo",value:q,onChange:Ne=>M(Ne.target.value)}),e.jsx(ye,{placeholder:"Apodo (opcional)",value:W,onChange:Ne=>ie(Ne.target.value)}),e.jsx("select",{value:ve,onChange:Ne=>K(Ne.target.value),className:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm",children:Object.values(du).map(Ne=>e.jsx("option",{value:Ne,children:uu[Ne]},Ne))}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(ye,{placeholder:"Mes",type:"number",min:1,max:12,value:je,onChange:Ne=>Ie(Ne.target.value)}),e.jsx(ye,{placeholder:"Da",type:"number",min:1,max:31,value:ge,onChange:Ne=>Be(Ne.target.value)}),e.jsx(ye,{placeholder:"Fecha completa",type:"date",value:oe,onChange:Ne=>_e(Ne.target.value)})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>U(!1),children:"Cancelar"}),e.jsx(P,{onClick:rt,children:"Crear contacto"})]})]})]})})]})},dc=t=>t?Cl(t).toLocaleDateString("es-CO",{day:"2-digit",month:"short",year:"numeric"}):"Sin fecha",o7=t=>t?Cl(t).toLocaleString("es-CO",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Sin fecha",c7=t=>t.birthdayDate?dc(t.birthdayDate):t.birthdayMonth&&t.birthdayDay?`${t.birthdayDay.toString().padStart(2,"0")}/${t.birthdayMonth.toString().padStart(2,"0")}`:"Sin registro",d7=t=>{const a=jc(t);if(a===null)return{className:"text-slate-500",label:"Sin definir"};if(a<0){const s=Math.abs(a);return{className:"text-red-600",label:`${dc(t)} (vencido ${s} da${s===1?"":"s"})`}}return a===0?{className:"text-amber-600",label:`${dc(t)} (hoy)`}:{className:"text-blue-600",label:`${dc(t)} (en ${a} da${a===1?"":"s"})`}},u7=t=>t?/^\d{4}-\d{2}-\d{2}$/.test(t)?t:Cl(t).toISOString().slice(0,10):"",tc=t=>{if(!t)return"";const a=Cl(t),s=r=>r.toString().padStart(2,"0");return`${a.getFullYear()}-${s(a.getMonth()+1)}-${s(a.getDate())}T${s(a.getHours())}:${s(a.getMinutes())}`},m7=(t,a)=>{const s=new Date(t);return s.setDate(s.getDate()+a),s},AC=t=>new Date(t.getFullYear(),t.getMonth(),t.getDate()),h7=t=>{if(!t)return null;const a=new Date(t);return Number.isNaN(a.getTime())?null:a},_C=(t,a)=>{const s=h7(t);if(!s)return a==="next"?"Sin fecha definida":"Sin registro";const r=Math.floor((AC(s).getTime()-AC(new Date).getTime())/864e5),l=s.toLocaleDateString("es-CO",{weekday:"long"});return r===0?"hoy":r===-1?"ayer":r===1?a==="next"?`maana - ${l}`:"maana":r<0?`hace ${Math.abs(r)} das`:`en ${r} das - ${l}`},f7=t=>{if(t.length<2)return null;const a=t.map(l=>new Date(l).getTime()).sort((l,o)=>l-o);let s=0,r=0;for(let l=1;l<a.length;l+=1){const o=a[l]-a[l-1];o>0&&(s+=o/864e5,r+=1)}return r===0?null:Math.max(1,Math.round(s/r))},p7=()=>{const t=it(),{relationshipId:a}=Ss(),[s]=Ef(),{isLoaded:r,error:l,circles:o,getRelationshipById:d,events:u,getRelatedTasks:m,getAvailablePrivateTasks:h,updateRelationship:g,setRelationshipArchived:x,addNoteWithContactUpdate:y,updateNote:v,addEvent:b,setEventArchived:N,linkExistingTask:S,unlinkTask:w,createRelatedTask:E}=Zk(),[T,D]=p.useState(!1),[k,_]=p.useState(!1),[R,L]=p.useState(!1),[U,V]=p.useState(!1),[F,G]=p.useState(!1),[$,z]=p.useState(""),[H,I]=p.useState(""),[O,Y]=p.useState(du.SOCIAL),[le,re]=p.useState(""),[Q,q]=p.useState(""),[M,W]=p.useState(""),[ie,ve]=p.useState(""),[K,oe]=p.useState(""),[_e,je]=p.useState(""),[Ie,ge]=p.useState(""),[Be,ke]=p.useState(Jg.CUSTOM),[gt,Dt]=p.useState(""),[kt,ja]=p.useState(""),[Wt,Vt]=p.useState(""),[X,se]=p.useState(""),[me,Oe]=p.useState(""),[Re,Ee]=p.useState(null),[Pe,Je]=p.useState(-1),[rt,Et]=p.useState(""),[Kt,Ne]=p.useState(""),[Ve,nt]=p.useState(null),[bt,Pt]=p.useState("new"),[_a,Ma]=p.useState(""),[qe,dt]=p.useState(ml.SOCIAL),[jt,Xe]=p.useState(!0),[et,$e]=p.useState(""),Ae=a?d(a):void 0,Fe=o.find(Te=>Te.id===Ae?.circleId),lt=p.useMemo(()=>{const Te=new URLSearchParams,He=s.get("circle")||Ae?.circleId,J=s.get("archived")||"0";return He&&Te.set("circle",He),Te.set("archived",J),Te.toString()},[s,Ae?.circleId]);if(p.useEffect(()=>{r&&!Ae&&t(`${ae.relationships.index}?notFound=1`,{replace:!0})},[r,Ae,t]),r&&!Ae)return null;if(!Ae)return e.jsx(na,{title:"Relaciones",subtitle:"Cargando contacto",icon:e.jsx(mu,{className:"h-4 w-4 text-white"}),children:e.jsx("div",{className:"py-4",children:e.jsx(fe,{children:e.jsx(xe,{className:"p-6 text-sm text-gray-600",children:"Cargando..."})})})});const Xt=u.filter(Te=>Te.relationshipId===Ae.id).sort((Te,He)=>new Date(He.eventDate).getTime()-new Date(Te.eventDate).getTime()),ht=m(Ae.id),ct=h(Ae.id),pa=d7(Ae.nextContactSuggestedAt),qt=Ae.lastContactAt?Math.max(0,Math.abs(jc(Ae.lastContactAt)||0)):null,da=Xt.filter(Te=>{if(Te.isArchived)return!1;const He=jc(Te.eventDate);return He!==null&&He>=0}).length,Na=f7(Ae.notes.map(Te=>Te.timestamp)),xa=()=>{z(Ae.fullName),I(Ae.nickname||""),Y(Ae.category),re(Ae.circleId),q(u7(Ae.birthdayDate)),W(Ae.birthdayMonth?String(Ae.birthdayMonth):""),ve(Ae.birthdayDay?String(Ae.birthdayDay):""),oe(tc(Ae.lastContactAt)),je(tc(Ae.nextContactSuggestedAt)),D(!0)},ys=async()=>{await g(Ae.id,{fullName:$,nickname:H||void 0,category:O,circleId:le||Ae.circleId,birthdayDate:Q||void 0,birthdayMonth:M?Number(M):void 0,birthdayDay:ie?Number(ie):void 0,lastContactAt:K?new Date(K).toISOString():void 0,nextContactSuggestedAt:_e?new Date(_e).toISOString():void 0}),D(!1)},on=async()=>{!Ie.trim()||!gt||(await b({relationshipId:Ae.id,title:Ie,eventType:Be,eventDate:gt}),ge(""),ke(Jg.CUSTOM),Dt(""),_(!1))},cs=()=>{const Te=new Date,He=tc(Te.toISOString()),J=He;let Me="";const Ye=Fe?.contactFrequencyDays;Ye&&Ye>0?Me=tc(m7(Te,Ye).toISOString()):Ae.nextContactSuggestedAt&&(Me=tc(Ae.nextContactSuggestedAt)),Ee(null),ja(""),Vt(He),se(J),Oe(Me),L(!0)},Pa=async()=>{if(!kt.trim()){Ee("La nota es obligatoria.");return}Ee(null);try{await y(Ae.id,{text:kt.trim(),timestamp:Wt?new Date(Wt).toISOString():void 0,lastContactAt:X?new Date(X).toISOString():void 0,nextContactSuggestedAt:me?new Date(me).toISOString():void 0}),ja(""),Vt(""),se(""),Oe(""),L(!1)}catch{Ee("No se pudo guardar la nota con las fechas de contacto.")}},wa=Te=>{const He=Ae.notes[Te];He&&(Je(Te),Et(He.text),Ne(tc(He.timestamp)),nt(null),V(!0))},Gn=async()=>{if(!rt.trim()){nt("La nota es obligatoria.");return}nt(null);try{await v(Ae.id,{noteIndex:Pe,text:rt.trim(),timestamp:Kt?new Date(Kt).toISOString():new Date().toISOString()}),Je(-1),Et(""),Ne(""),V(!1)}catch{nt("No se pudo actualizar la nota.")}},Ei=async()=>{_a.trim()&&(await E(Ae.id,{title:_a,category:qe,isPrivate:jt},!0),Ma(""),dt(ml.SOCIAL),Xe(!0),G(!1))},yo=async()=>{et&&(await S(Ae.id,et),$e(""),G(!1))},vo=[{id:"back",label:"Volver",icon:e.jsx(fl,{className:"h-4 w-4"}),onClick:()=>t(`${ae.relationships.index}?${lt}`),showLabel:!0},{id:"edit",label:"Editar",icon:e.jsx(lo,{className:"h-4 w-4"}),onClick:xa,showLabel:!0}];return e.jsxs(na,{title:"Relaciones",subtitle:"Ficha de contacto",icon:e.jsx(mu,{className:"h-4 w-4 text-white"}),actions:vo,children:[e.jsxs("div",{className:"py-4 space-y-4",children:[l&&e.jsx(fe,{className:"border-red-300 bg-red-50",children:e.jsx(xe,{className:"p-3 text-sm text-red-700",children:l})}),e.jsx(fe,{className:"border-2 border-slate-300 bg-sky-50/40",children:e.jsx(xe,{className:"p-5 flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-slate-900",children:Ae.fullName}),e.jsx(wt,{variant:"outline",className:"text-sm px-3 py-1 border-red-400 text-red-600 bg-red-50",children:uu[Ae.category]}),Fe&&e.jsxs(wt,{variant:"outline",className:"text-sm px-3 py-1 border-blue-500 text-blue-700 bg-blue-50",children:[Fe.name,Fe.contactFrequencyDays?`  cada ${Fe.contactFrequencyDays} das`:""]}),Ae.isArchived&&e.jsx(wt,{variant:"destructive",children:"Archivado"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 xl:grid-cols-[360px_1fr]",children:[e.jsx(fe,{className:"border-slate-300",children:e.jsxs(xe,{className:"p-4 space-y-6",children:[e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-2xl font-semibold text-slate-900",children:"Informacin de contacto"}),e.jsxs("div",{className:"border-t pt-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between gap-3",children:[e.jsx("span",{className:"text-slate-500",children:"Nombre"}),e.jsx("span",{className:"font-medium text-slate-900 text-right",children:Ae.fullName})]}),e.jsxs("div",{className:"flex justify-between gap-3",children:[e.jsx("span",{className:"text-slate-500",children:"Apodo"}),e.jsx("span",{className:"font-medium text-slate-900 text-right",children:Ae.nickname||"Sin apodo"})]}),e.jsxs("div",{className:"flex justify-between gap-3",children:[e.jsx("span",{className:"text-slate-500",children:"Categora"}),e.jsx("span",{className:"font-medium text-slate-900 text-right",children:uu[Ae.category]})]}),e.jsxs("div",{className:"flex justify-between gap-3",children:[e.jsx("span",{className:"text-slate-500",children:"Cumpleaos"}),e.jsx("span",{className:"font-medium text-slate-900 text-right",children:c7(Ae)})]})]})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsx("h3",{className:"text-2xl font-semibold text-slate-900",children:"Fechas importantes"}),e.jsxs("div",{className:"border-t pt-3 space-y-2 text-sm",children:[e.jsxs("div",{className:"text-slate-700",children:["ltimo contacto: ",Ae.lastContactAt?`${dc(Ae.lastContactAt)} (hace ${qt??0} das)`:"Sin registro"]}),e.jsxs("div",{className:pa.className,children:["Prximo contacto: ",pa.label]})]})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-2xl font-semibold text-slate-900 flex items-center gap-2",children:[e.jsx(o1,{className:"h-5 w-5"})," Estadsticas"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 border-t pt-3",children:[e.jsxs("div",{className:"rounded-xl border border-blue-300 bg-blue-50 p-3",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Total interacciones"}),e.jsx("div",{className:"text-3xl font-bold text-blue-700",children:Ae.notes.length})]}),e.jsxs("div",{className:"rounded-xl border border-emerald-300 bg-emerald-50 p-3",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Frecuencia promedio (notas)"}),e.jsx("div",{className:"text-3xl font-bold text-emerald-700",children:Na?`${Na} das`:"-"})]}),e.jsxs("div",{className:"rounded-xl border border-amber-300 bg-amber-50 p-3",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Das sin contacto"}),e.jsx("div",{className:"text-3xl font-bold text-amber-700",children:qt??"-"})]}),e.jsxs("div",{className:"rounded-xl border border-violet-300 bg-violet-50 p-3",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Eventos prximos"}),e.jsx("div",{className:"text-3xl font-bold text-violet-700",children:da})]})]})]}),e.jsx(P,{variant:Ae.isArchived?"default":"outline",className:"w-full",onClick:()=>x(Ae.id,!Ae.isArchived),children:Ae.isArchived?e.jsxs(e.Fragment,{children:[e.jsx(h1,{className:"h-4 w-4 mr-2"}),"Desarchivar contacto"]}):e.jsxs(e.Fragment,{children:[e.jsx(FM,{className:"h-4 w-4 mr-2"}),"Archivar contacto"]})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(fe,{className:"border-slate-300",children:e.jsxs(xe,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200 p-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-slate-50 px-4 py-2 text-2xl font-semibold text-slate-700",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Eventos"})]}),e.jsxs(P,{onClick:()=>_(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(It,{className:"h-4 w-4 mr-1"}),"Agregar Evento"]})]}),e.jsxs("div",{className:"space-y-3",children:[Xt.length===0&&e.jsx("div",{className:"text-sm text-slate-500",children:"Sin eventos registrados."}),Xt.map(Te=>e.jsx("div",{className:"rounded-xl border border-slate-200 p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900",children:Te.title}),e.jsxs("div",{className:"text-sm text-slate-500",children:[kC[Te.eventType]," - ",dc(Te.eventDate)]}),Te.isArchived&&e.jsx(wt,{variant:"outline",className:"mt-1",children:"Archivado"})]}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>N(Te.id,!Te.isArchived),children:Te.isArchived?"Desarchivar":"Archivar"})]})},Te.id))]})]})}),e.jsx(fe,{className:"border-slate-300",children:e.jsxs(xe,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200 p-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-lg border border-blue-500 bg-blue-50 px-4 py-2 text-2xl font-semibold text-blue-700",children:[e.jsx(N1,{className:"h-5 w-5"}),e.jsx("span",{children:"Comentarios"})]}),e.jsxs(P,{onClick:cs,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(It,{className:"h-4 w-4 mr-1"}),"Agregar Nota"]})]}),e.jsxs("div",{className:"space-y-3",children:[Ae.notes.length===0&&e.jsx("div",{className:"text-sm text-slate-500",children:"Sin notas registradas."}),Ae.notes.slice().reverse().map((Te,He)=>{const J=Ae.notes.length-1-He;return e.jsxs("div",{className:"rounded-xl border border-slate-200 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"text-sm text-slate-500 flex items-center gap-2",children:[e.jsx(Aa,{className:"h-4 w-4"}),o7(Te.timestamp)]}),e.jsxs(P,{size:"sm",variant:"ghost",onClick:()=>wa(J),className:"h-7 px-2",children:[e.jsx(lo,{className:"h-3 w-3 mr-1"}),"Editar"]})]}),e.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap text-slate-900",children:Te.text})]},`${Te.timestamp}-${He}`)})]})]})}),e.jsx(fe,{className:"border-slate-300",children:e.jsxs(xe,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-xl border border-slate-200 p-2",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-300 bg-slate-50 px-4 py-2 text-2xl font-semibold text-slate-700",children:[e.jsx(hl,{className:"h-5 w-5"}),e.jsx("span",{children:"Tareas relacionadas"})]}),e.jsxs(P,{onClick:()=>G(!0),className:"bg-black text-white hover:bg-gray-800",children:[e.jsx(It,{className:"h-4 w-4 mr-1"}),"Agregar Tarea"]})]}),e.jsxs("div",{className:"space-y-3",children:[ht.length===0&&e.jsx("div",{className:"text-sm text-slate-500",children:"Sin tareas relacionadas."}),ht.map(Te=>e.jsx("div",{className:"rounded-xl border border-slate-200 p-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900",children:Te.title}),e.jsxs("div",{className:"mt-1 flex flex-wrap gap-2",children:[e.jsx(wt,{variant:Te.completed?"secondary":"outline",children:Te.completed?"Completada":"Activa"}),e.jsx(wt,{variant:"outline",children:Te.isPrivate?"Privada":"No privada"}),Te.category&&e.jsx(wt,{variant:"outline",children:Ya[Te.category]||Te.category})]})]}),e.jsx(P,{size:"sm",variant:"outline",onClick:()=>w(Ae.id,Te.id),children:"Desvincular"})]})},Te.id))]})]})})]})]})]}),e.jsx(Mt,{open:T,onOpenChange:D,children:e.jsxs(Tt,{className:"sm:max-w-2xl",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Editar contacto"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(fe,{children:e.jsxs(xe,{className:"p-4 space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wide",children:"Perfil"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"edit-name",children:"Nombre completo"}),e.jsx(ye,{id:"edit-name",value:$,onChange:Te=>z(Te.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"edit-nickname",children:"Apodo"}),e.jsx(ye,{id:"edit-nickname",value:H,onChange:Te=>I(Te.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{children:"Categora"}),e.jsxs(yt,{value:O,onValueChange:Te=>Y(Te),children:[e.jsx(ft,{children:e.jsx(vt,{placeholder:"Categora"})}),e.jsx(pt,{children:Object.values(du).map(Te=>e.jsx(Le,{value:Te,children:uu[Te]},Te))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{children:"Crculo"}),e.jsxs(yt,{value:le,onValueChange:re,children:[e.jsx(ft,{children:e.jsx(vt,{placeholder:"Crculo"})}),e.jsx(pt,{children:o.map(Te=>e.jsx(Le,{value:Te.id,children:Te.name},Te.id))})]})]})]})]})}),e.jsx(fe,{children:e.jsxs(xe,{className:"p-4 space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wide",children:"Cumpleaos"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"edit-birthday-date",children:"Fecha completa (si la conoces)"}),e.jsx(ye,{id:"edit-birthday-date",type:"date",value:Q,onChange:Te=>q(Te.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"edit-birthday-month",children:"Mes"}),e.jsx(ye,{id:"edit-birthday-month",type:"number",min:1,max:12,value:M,onChange:Te=>W(Te.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"edit-birthday-day",children:"Da"}),e.jsx(ye,{id:"edit-birthday-day",type:"number",min:1,max:31,value:ie,onChange:Te=>ve(Te.target.value)})]})]})]})}),e.jsx(fe,{children:e.jsxs(xe,{className:"p-4 space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wide",children:"Seguimiento de contacto"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"edit-last-contact",children:"ltimo contacto"}),e.jsx(ye,{id:"edit-last-contact",type:"datetime-local",value:K,onChange:Te=>oe(Te.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"edit-next-contact",children:"Prximo contacto sugerido"}),e.jsx(ye,{id:"edit-next-contact",type:"datetime-local",value:_e,onChange:Te=>je(Te.target.value)})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>D(!1),children:"Cancelar"}),e.jsx(P,{onClick:ys,children:"Guardar cambios"})]})]})]})}),e.jsx(Mt,{open:k,onOpenChange:_,children:e.jsxs(Tt,{className:"sm:max-w-lg",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Agregar evento"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(ye,{placeholder:"Ttulo",value:Ie,onChange:Te=>ge(Te.target.value)}),e.jsxs(yt,{value:Be,onValueChange:Te=>ke(Te),children:[e.jsx(ft,{children:e.jsx(vt,{placeholder:"Tipo de evento"})}),e.jsx(pt,{children:Object.values(Jg).map(Te=>e.jsx(Le,{value:Te,children:kC[Te]},Te))})]}),e.jsx(ye,{type:"date",value:gt,onChange:Te=>Dt(Te.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>_(!1),children:"Cancelar"}),e.jsx(P,{onClick:on,children:"Guardar"})]})]})]})}),e.jsx(Mt,{open:R,onOpenChange:Te=>{L(Te),Te||Ee(null)},children:e.jsxs(Tt,{className:"sm:max-w-xl",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Agregar nota"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(sa,{placeholder:"Escribe aqu la nota del contacto...",value:kt,onChange:Te=>ja(Te.target.value),className:"min-h-[180px]"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"note-timestamp",children:"Fecha del comentario"}),e.jsx(ye,{id:"note-timestamp",type:"datetime-local",value:Wt,onChange:Te=>Vt(Te.target.value)}),e.jsx("p",{className:"text-xs text-slate-500",children:"Fecha en la que ocurri este comentario o interaccin"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"note-last-contact",children:"ltimo contacto"}),e.jsx(ye,{id:"note-last-contact",type:"datetime-local",value:X,onChange:Te=>se(Te.target.value)}),e.jsx("p",{className:"text-xs text-slate-500",children:_C(X,"last")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"note-next-contact",children:"Prximo contacto sugerido"}),e.jsx(ye,{id:"note-next-contact",type:"datetime-local",value:me,onChange:Te=>Oe(Te.target.value)}),e.jsx("p",{className:"text-xs text-slate-500",children:_C(me,"next")})]})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Calculado por frecuencia del crculo, editable."}),Re&&e.jsx("p",{className:"text-sm text-red-600",children:Re}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>L(!1),children:"Cancelar"}),e.jsx(P,{onClick:Pa,children:"Guardar"})]})]})]})}),e.jsx(Mt,{open:U,onOpenChange:Te=>{V(Te),Te||nt(null)},children:e.jsxs(Tt,{className:"sm:max-w-xl",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Editar nota"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(sa,{placeholder:"Escribe aqu la nota del contacto...",value:rt,onChange:Te=>Et(Te.target.value),className:"min-h-[180px]"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"edit-note-timestamp",children:"Fecha del comentario"}),e.jsx(ye,{id:"edit-note-timestamp",type:"datetime-local",value:Kt,onChange:Te=>Ne(Te.target.value)}),e.jsx("p",{className:"text-xs text-slate-500",children:"Fecha en la que ocurri este comentario o interaccin"})]}),Ve&&e.jsx("p",{className:"text-sm text-red-600",children:Ve}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>V(!1),children:"Cancelar"}),e.jsx(P,{onClick:Gn,children:"Guardar cambios"})]})]})]})}),e.jsx(Mt,{open:F,onOpenChange:G,children:e.jsxs(Tt,{className:"sm:max-w-2xl",children:[e.jsx(Ot,{children:e.jsx(Rt,{children:"Tareas relacionadas"})}),e.jsxs(Hu,{value:bt,onValueChange:Pt,className:"space-y-4",children:[e.jsxs(Bc,{className:"grid w-full grid-cols-2",children:[e.jsx(rr,{value:"new",children:"Crear tarea"}),e.jsx(rr,{value:"link",children:"Vincular existente"})]}),e.jsxs(ir,{value:"new",className:"space-y-4",children:[e.jsx(fe,{children:e.jsxs(xe,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{htmlFor:"task-title",children:"Ttulo"}),e.jsx(ye,{id:"task-title",value:_a,onChange:Te=>Ma(Te.target.value),placeholder:"Nueva tarea..."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{children:"Categora"}),e.jsxs(yt,{value:qe,onValueChange:Te=>dt(Te),children:[e.jsx(ft,{children:e.jsx(vt,{placeholder:"Categora"})}),e.jsx(pt,{children:Object.values(ml).map(Te=>e.jsx(Le,{value:Te,children:Ya[Te]},Te))})]})]}),e.jsxs("div",{className:"space-y-2 rounded-lg border border-slate-200 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx(Ce,{htmlFor:"task-private",className:"text-sm font-medium",children:"Privada"}),e.jsx(xv,{id:"task-private",checked:jt,onCheckedChange:Xe})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Desde Relaciones se crea privada por defecto, pero puedes cambiarlo."})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>G(!1),children:"Cancelar"}),e.jsx(P,{onClick:Ei,className:"bg-black text-white hover:bg-gray-800",children:"Crear y vincular"})]})]}),e.jsxs(ir,{value:"link",className:"space-y-4",children:[e.jsx(fe,{children:e.jsx(xe,{className:"p-4 space-y-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ce,{children:"Tarea privada existente"}),e.jsxs(yt,{value:et,onValueChange:$e,children:[e.jsx(ft,{children:e.jsx(vt,{placeholder:"Selecciona una tarea privada"})}),e.jsx(pt,{children:ct.length===0?e.jsx(Le,{value:"none",disabled:!0,children:"No hay tareas privadas disponibles"}):ct.map(Te=>e.jsx(Le,{value:Te.id,children:Te.title},Te.id))})]})]})})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",onClick:()=>G(!1),children:"Cancelar"}),e.jsx(P,{onClick:yo,disabled:!et||et==="none",children:"Vincular tarea"})]})]})]})]})})]})},x7={module:"relationships",defaultRoute:ae.relationships.index,moduleRoutes:[{path:"relationships",element:e.jsx(l7,{})},{path:"relationships/:relationshipId",element:e.jsx(p7,{})}],legacyRedirects:[{path:"relationships/view/:viewKey",element:e.jsx(Ft,{to:ae.relationships.index,replace:!0})}]},MC=[oL,wP,NH,$H,l8,M8,eU,EU,GU,aV,lV,SV,FV,nY,mY,WY,x7],g7=[...MC.flatMap(t=>t.moduleRoutes),...MC.flatMap(t=>t.legacyRedirects||[]),{path:"*",element:e.jsx(Ft,{to:ae.home,replace:!0})}],y7=[{path:"habit/:habitId/run",element:e.jsx(J5,{})},{path:"shopping/run",element:e.jsx($I,{})}],v7=t=>t?[{path:"/",element:e.jsx(K3,{}),children:g7},...y7,{path:"*",element:e.jsx(Ft,{to:ae.home,replace:!0})}]:[{path:ae.auth.login,element:e.jsx(Tw,{})},{path:"*",element:e.jsx(Tw,{})}],b7=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});function j7(){const{user:t,loading:a}=st(),s=L4(v7(!!t));return a?e.jsx(b7,{}):s}"serviceWorker"in navigator&&IO({onNeedRefresh(){window.dispatchEvent(new CustomEvent("sw-update-available"))},onOfflineReady(){console.log("La aplicacin est lista para usar sin conexin"),window.dispatchEvent(new CustomEvent("sw-offline-ready"))},onRegisterError(t){console.warn("Error al registrar el service worker:",t)},immediate:!0});ZM.createRoot(document.getElementById("root")).render(e.jsx(te.StrictMode,{children:e.jsx(NO,{basename:"/life-tracker",children:e.jsx($Y,{children:e.jsx(j7,{})})})}));
