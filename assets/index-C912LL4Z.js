import{j as e,S as Pw,c as ih,a as mr,b as lh,u as bs,A as Mw,P as Bt,d as Ct,e as Pn,D as Rw,C as Iw,R as $w,f as Lw,g as Jc,h as Qr,i as zw,O as eo,k as to,l as _i,T as so,m as ao,n as Xc,o as Zc,p as Qc,q as ch,I as Fw,r as dh,s as uh,t as Hw,v as mh,V as Ww,L as fh,w as hh,x as Bw,y as Uw,z as ph,B as qw,E as Vw,F as xh,G as En,H as gh,J as Yw,K as vh,M as yh,N as jh,Q as Gw,U as Kw,W as Jw,X as Xw,Y as bh,Z as Zw,$ as Nh,a0 as wh,a1 as Qw,a2 as Sh,a3 as Ch,a4 as Eh,a5 as Dh,a6 as Th,a7 as _h,a8 as Ah,a9 as e1,aa as t1}from"../chunks/ui-NL8EBHs1.js";import{a as s1,r as f,c as Q,b as a1,d as Lr}from"../chunks/vendor-B6CgFIIW.js";import{u as kh,a as Oh,O as n1,L as ff,R as r1,b as Gt,B as o1}from"../chunks/router-DJv1u1v8.js";import{t as i1,c as l1,s as Qe,a as Wr,e as vs,b as Pc,d as hf,f as pf,g as yc,h as zr,i as c1,j as Fr,k as vt,l as yt,m as gt,n as sa,o as Vr,p as Ht,q as pi,r as Oa,u as Yr,v as ed,w as Ft,x as Mc,y as d1,z as u1,A as m1,B as f1,C as jc,D as xf,E as h1,F as p1,G as Ph,H as ea,I as td,J as Ia,K as x1,L as g1,M as Mh,N as v1,O as Zs,P as y1,Q as j1,R as Tn}from"../chunks/utils-DV0z_7ww.js";import{i as b1,g as N1,a as w1,o as S1,G as C1,s as E1,b as D1,d as ue,c as Ot,e as ht,f as et,h as Be,j as tt,k as fr,q as ns,w as Ge,T as _n,l as ji,u as Br,m as on,n as T1,p as _1,r as A1}from"../chunks/firebase-GaJRKqcK.js";import{C as Mn,L as k1,D as no,a as O1,S as P1,b as Ai,B as M1,T as ro,U as Rh,c as R1,K as I1,d as Ih,e as $1,f as L1,X as Rs,g as ga,h as hr,W as gf,i as ki,j as $h,k as pr,l as Oi,m as Pi,n as Wt,I as mn,P as ys,o as Mi,p as oo,q as Lh,r as z1,s as sd,t as F1,u as H1,v as zh,w as W1,x as pa,y as B1,z as U1,A as q1,E as V1,F as Y1,G as G1,H as K1,J as Ri,M as Fh,N as rs,O as J1,Q as Hh,R as ad,V as Wh,Y as X1,Z as Bh,_ as Z1,$ as Ii,a0 as Uh,a1 as nd,a2 as vf,a3 as qh,a4 as Vh,a5 as Rc,a6 as Yh,a7 as Gr,a8 as Q1,a9 as eS,aa as tS,ab as sS,ac as aS,ad as nS,ae as rd,af as rS,ag as oS,ah as iS,ai as Gh,aj as lS,ak as cS,al as Kh,am as Jh}from"../chunks/icons-DJpZuXDM.js";import{R as jt,L as Pa,C as ha,X as gs,Y as as,T as bt,a as Ms,P as Rn,b as In,c as $n,B as $i,d as Kr,e as ka}from"../chunks/charts-BAPas6Rk.js";import{p as On,m as Li}from"../chunks/markdown-7WTVriAQ.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const d of i)if(d.type==="childList")for(const l of d.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function a(i){const d={};return i.integrity&&(d.integrity=i.integrity),i.referrerPolicy&&(d.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?d.credentials="include":i.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(i){if(i.ep)return;i.ep=!0;const d=a(i);fetch(i.href,d)}})();var Ic={},yf=s1;Ic.createRoot=yf.createRoot,Ic.hydrateRoot=yf.hydrateRoot;const dS="modulepreload",uS=function(s){return"/life-tracker/"+s},jf={},mS=function(r,a,o){let i=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(a.map(m=>{if(m=uS(m),m in jf)return;jf[m]=!0;const h=m.endsWith(".css"),x=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":dS,h||(p.as="script"),p.crossOrigin="",p.href=m,u&&p.setAttribute("nonce",u),document.head.appendChild(p),h)return new Promise((g,v)=>{p.addEventListener("load",g),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${m}`)))})}))}function d(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return i.then(l=>{for(const u of l||[])u.status==="rejected"&&d(u.reason);return r().catch(d)})};function fS(s={}){const{immediate:r=!1,onNeedRefresh:a,onOfflineReady:o,onRegistered:i,onRegisteredSW:d,onRegisterError:l}=s;let u,m;const h=async(p=!0)=>{await m};async function x(){if("serviceWorker"in navigator){if(u=await mS(async()=>{const{Workbox:p}=await import("../chunks/workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:p}},[]).then(({Workbox:p})=>new p("/life-tracker/sw.js",{scope:"/life-tracker/",type:"classic"})).catch(p=>{l==null||l(p)}),!u)return;u.addEventListener("activated",p=>{(p.isUpdate||p.isExternal)&&window.location.reload()}),u.addEventListener("installed",p=>{p.isUpdate||o==null||o()}),u.register({immediate:r}).then(p=>{d?d("/life-tracker/sw.js",p):i==null||i(p)}).catch(p=>{l==null||l(p)})}}return m=x(),h}const Xh=()=>{const[s,r]=f.useState(()=>{if(typeof window>"u")return{deviceType:"desktop",orientation:"landscape",isMobile:!1,isTablet:!1,isDesktop:!0,screenWidth:1920,screenHeight:1080};const a=window.innerWidth,o=window.innerHeight;return{deviceType:a<768?"mobile":a<1024?"tablet":"desktop",orientation:a<o?"portrait":"landscape",isMobile:a<768,isTablet:a>=768&&a<1024,isDesktop:a>=1024,screenWidth:a,screenHeight:o}});return f.useEffect(()=>{const a=()=>{const i=window.innerWidth,d=window.innerHeight;r({deviceType:i<768?"mobile":i<1024?"tablet":"desktop",orientation:i<d?"portrait":"landscape",isMobile:i<768,isTablet:i>=768&&i<1024,isDesktop:i>=1024,screenWidth:i,screenHeight:d})},o=()=>{setTimeout(a,100)};return window.addEventListener("resize",a),window.addEventListener("orientationchange",o),()=>{window.removeEventListener("resize",a),window.removeEventListener("orientationchange",o)}},[]),s},hS=()=>{const[s,r]=f.useState(!1),[a,o]=f.useState(!1),[i,d]=f.useState(null);return f.useEffect(()=>{const u=window.matchMedia("(display-mode: standalone)").matches,m=window.navigator.standalone===!0;r(u||m);const h=x=>{x.preventDefault(),d(x),o(!0)};return window.addEventListener("beforeinstallprompt",h),()=>{window.removeEventListener("beforeinstallprompt",h)}},[]),{isInstalled:s,canInstall:a,promptInstall:async()=>{if(!i)return!1;i.prompt();const{outcome:u}=await i.userChoice;return u==="accepted"?(o(!1),d(null),!0):!1}}};function Zh(s){var r,a,o="";if(typeof s=="string"||typeof s=="number")o+=s;else if(typeof s=="object")if(Array.isArray(s))for(r=0;r<s.length;r++)s[r]&&(a=Zh(s[r]))&&(o&&(o+=" "),o+=a);else for(r in s)s[r]&&(o&&(o+=" "),o+=r);return o}function pS(){for(var s,r,a=0,o="";a<arguments.length;)(s=arguments[a++])&&(r=Zh(s))&&(o&&(o+=" "),o+=r);return o}const bf=s=>typeof s=="boolean"?"".concat(s):s===0?"0":s,Nf=pS,io=(s,r)=>a=>{var o;if((r==null?void 0:r.variants)==null)return Nf(s,a==null?void 0:a.class,a==null?void 0:a.className);const{variants:i,defaultVariants:d}=r,l=Object.keys(i).map(h=>{const x=a==null?void 0:a[h],p=d==null?void 0:d[h];if(x===null)return null;const g=bf(x)||bf(p);return i[h][g]}),u=a&&Object.entries(a).reduce((h,x)=>{let[p,g]=x;return g===void 0||(h[p]=g),h},{}),m=r==null||(o=r.compoundVariants)===null||o===void 0?void 0:o.reduce((h,x)=>{let{class:p,className:g,...v}=x;return Object.entries(v).every(j=>{let[b,N]=j;return Array.isArray(N)?N.includes({...d,...u}[b]):{...d,...u}[b]===N})?[...h,p,g]:h},[]);return Nf(s,l,m,a==null?void 0:a.class,a==null?void 0:a.className)};function Z(...s){return i1(l1(s))}const Jr=io("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 touch-manipulation active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-md",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"gradient-bg-primary text-white shadow-lg border-0 hover:opacity-90",glass:"glass-card text-gray-700 hover:bg-white/30 backdrop-blur-sm border border-white/20"},size:{default:"h-10 md:h-11 px-4 py-2",sm:"h-8 md:h-9 rounded-md px-3 text-xs md:text-sm",lg:"h-12 md:h-13 rounded-md px-8 text-sm md:text-base",icon:"h-10 w-10 md:h-11 md:w-11",touch:"h-11 md:h-12 px-6 py-3 text-base md:text-lg min-w-[44px]"}},defaultVariants:{variant:"default",size:"default"}}),F=f.forwardRef(({className:s,variant:r,size:a,asChild:o=!1,...i},d)=>{const l=o?Pw:"button";return e.jsx(l,{className:Z(Jr({variant:r,size:a,className:s})),ref:d,...i})});F.displayName="Button";var xS=f.forwardRef((s,r)=>{const{children:a,...o}=s,i=f.Children.toArray(a),d=i.find(gS);if(d){const l=d.props.children,u=i.map(m=>m===d?f.Children.count(l)>1?f.Children.only(null):f.isValidElement(l)?l.props.children:null:m);return e.jsx($c,{...o,ref:r,children:f.isValidElement(l)?f.cloneElement(l,void 0,u):null})}return e.jsx($c,{...o,ref:r,children:a})});xS.displayName="Slot";var $c=f.forwardRef((s,r)=>{const{children:a,...o}=s;if(f.isValidElement(a)){const i=yS(a);return f.cloneElement(a,{...vS(o,a.props),ref:r?ih(r,i):i})}return f.Children.count(a)>1?f.Children.only(null):null});$c.displayName="SlotClone";var Qh=({children:s})=>e.jsx(e.Fragment,{children:s});function gS(s){return f.isValidElement(s)&&s.type===Qh}function vS(s,r){const a={...r};for(const o in r){const i=s[o],d=r[o];/^on[A-Z]/.test(o)?i&&d?a[o]=(...u)=>{d(...u),i(...u)}:i&&(a[o]=i):o==="style"?a[o]={...i,...d}:o==="className"&&(a[o]=[i,d].filter(Boolean).join(" "))}return{...s,...a}}function yS(s){var o,i;let r=(o=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:o.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?s.ref:(r=(i=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:i.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?s.props.ref:s.props.ref||s.ref)}var[zi,V4]=mr("Tooltip",[lh]),Fi=lh(),ep="TooltipProvider",jS=700,Lc="tooltip.open",[bS,od]=zi(ep),tp=s=>{const{__scopeTooltip:r,delayDuration:a=jS,skipDelayDuration:o=300,disableHoverableContent:i=!1,children:d}=s,[l,u]=f.useState(!0),m=f.useRef(!1),h=f.useRef(0);return f.useEffect(()=>{const x=h.current;return()=>window.clearTimeout(x)},[]),e.jsx(bS,{scope:r,isOpenDelayed:l,delayDuration:a,onOpen:f.useCallback(()=>{window.clearTimeout(h.current),u(!1)},[]),onClose:f.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>u(!0),o)},[o]),isPointerInTransitRef:m,onPointerInTransitChange:f.useCallback(x=>{m.current=x},[]),disableHoverableContent:i,children:d})};tp.displayName=ep;var Hi="Tooltip",[NS,Wi]=zi(Hi),sp=s=>{const{__scopeTooltip:r,children:a,open:o,defaultOpen:i=!1,onOpenChange:d,disableHoverableContent:l,delayDuration:u}=s,m=od(Hi,s.__scopeTooltip),h=Fi(r),[x,p]=f.useState(null),g=Jc(),v=f.useRef(0),j=l??m.disableHoverableContent,b=u??m.delayDuration,N=f.useRef(!1),[C=!1,S]=Qr({prop:o,defaultProp:i,onChange:P=>{P?(m.onOpen(),document.dispatchEvent(new CustomEvent(Lc))):m.onClose(),d==null||d(P)}}),_=f.useMemo(()=>C?N.current?"delayed-open":"instant-open":"closed",[C]),A=f.useCallback(()=>{window.clearTimeout(v.current),N.current=!1,S(!0)},[S]),k=f.useCallback(()=>{window.clearTimeout(v.current),S(!1)},[S]),D=f.useCallback(()=>{window.clearTimeout(v.current),v.current=window.setTimeout(()=>{N.current=!0,S(!0)},b)},[b,S]);return f.useEffect(()=>()=>window.clearTimeout(v.current),[]),e.jsx(zw,{...h,children:e.jsx(NS,{scope:r,contentId:g,open:C,stateAttribute:_,trigger:x,onTriggerChange:p,onTriggerEnter:f.useCallback(()=>{m.isOpenDelayed?D():A()},[m.isOpenDelayed,D,A]),onTriggerLeave:f.useCallback(()=>{j?k():window.clearTimeout(v.current)},[k,j]),onOpen:A,onClose:k,disableHoverableContent:j,children:a})})};sp.displayName=Hi;var zc="TooltipTrigger",ap=f.forwardRef((s,r)=>{const{__scopeTooltip:a,...o}=s,i=Wi(zc,a),d=od(zc,a),l=Fi(a),u=f.useRef(null),m=bs(r,u,i.onTriggerChange),h=f.useRef(!1),x=f.useRef(!1),p=f.useCallback(()=>h.current=!1,[]);return f.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),e.jsx(Mw,{asChild:!0,...l,children:e.jsx(Bt.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...o,ref:m,onPointerMove:Ct(s.onPointerMove,g=>{g.pointerType!=="touch"&&!x.current&&!d.isPointerInTransitRef.current&&(i.onTriggerEnter(),x.current=!0)}),onPointerLeave:Ct(s.onPointerLeave,()=>{i.onTriggerLeave(),x.current=!1}),onPointerDown:Ct(s.onPointerDown,()=>{h.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:Ct(s.onFocus,()=>{h.current||i.onOpen()}),onBlur:Ct(s.onBlur,i.onClose),onClick:Ct(s.onClick,i.onClose)})})});ap.displayName=zc;var wS="TooltipPortal",[Y4,SS]=zi(wS,{forceMount:void 0}),lr="TooltipContent",np=f.forwardRef((s,r)=>{const a=SS(lr,s.__scopeTooltip),{forceMount:o=a.forceMount,side:i="top",...d}=s,l=Wi(lr,s.__scopeTooltip);return e.jsx(Pn,{present:o||l.open,children:l.disableHoverableContent?e.jsx(rp,{side:i,...d,ref:r}):e.jsx(CS,{side:i,...d,ref:r})})}),CS=f.forwardRef((s,r)=>{const a=Wi(lr,s.__scopeTooltip),o=od(lr,s.__scopeTooltip),i=f.useRef(null),d=bs(r,i),[l,u]=f.useState(null),{trigger:m,onClose:h}=a,x=i.current,{onPointerInTransitChange:p}=o,g=f.useCallback(()=>{u(null),p(!1)},[p]),v=f.useCallback((j,b)=>{const N=j.currentTarget,C={x:j.clientX,y:j.clientY},S=_S(C,N.getBoundingClientRect()),_=AS(C,S),A=kS(b.getBoundingClientRect()),k=PS([..._,...A]);u(k),p(!0)},[p]);return f.useEffect(()=>()=>g(),[g]),f.useEffect(()=>{if(m&&x){const j=N=>v(N,x),b=N=>v(N,m);return m.addEventListener("pointerleave",j),x.addEventListener("pointerleave",b),()=>{m.removeEventListener("pointerleave",j),x.removeEventListener("pointerleave",b)}}},[m,x,v,g]),f.useEffect(()=>{if(l){const j=b=>{const N=b.target,C={x:b.clientX,y:b.clientY},S=(m==null?void 0:m.contains(N))||(x==null?void 0:x.contains(N)),_=!OS(C,l);S?g():_&&(g(),h())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[m,x,l,h,g]),e.jsx(rp,{...s,ref:d})}),[ES,DS]=zi(Hi,{isInside:!1}),rp=f.forwardRef((s,r)=>{const{__scopeTooltip:a,children:o,"aria-label":i,onEscapeKeyDown:d,onPointerDownOutside:l,...u}=s,m=Wi(lr,a),h=Fi(a),{onClose:x}=m;return f.useEffect(()=>(document.addEventListener(Lc,x),()=>document.removeEventListener(Lc,x)),[x]),f.useEffect(()=>{if(m.trigger){const p=g=>{const v=g.target;v!=null&&v.contains(m.trigger)&&x()};return window.addEventListener("scroll",p,{capture:!0}),()=>window.removeEventListener("scroll",p,{capture:!0})}},[m.trigger,x]),e.jsx(Rw,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:d,onPointerDownOutside:l,onFocusOutside:p=>p.preventDefault(),onDismiss:x,children:e.jsxs(Iw,{"data-state":m.stateAttribute,...h,...u,ref:r,style:{...u.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Qh,{children:o}),e.jsx(ES,{scope:a,isInside:!0,children:e.jsx($w,{id:m.contentId,role:"tooltip",children:i||o})})]})})});np.displayName=lr;var op="TooltipArrow",TS=f.forwardRef((s,r)=>{const{__scopeTooltip:a,...o}=s,i=Fi(a);return DS(op,a).isInside?null:e.jsx(Lw,{...i,...o,ref:r})});TS.displayName=op;function _S(s,r){const a=Math.abs(r.top-s.y),o=Math.abs(r.bottom-s.y),i=Math.abs(r.right-s.x),d=Math.abs(r.left-s.x);switch(Math.min(a,o,i,d)){case d:return"left";case i:return"right";case a:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function AS(s,r,a=5){const o=[];switch(r){case"top":o.push({x:s.x-a,y:s.y+a},{x:s.x+a,y:s.y+a});break;case"bottom":o.push({x:s.x-a,y:s.y-a},{x:s.x+a,y:s.y-a});break;case"left":o.push({x:s.x+a,y:s.y-a},{x:s.x+a,y:s.y+a});break;case"right":o.push({x:s.x-a,y:s.y-a},{x:s.x-a,y:s.y+a});break}return o}function kS(s){const{top:r,right:a,bottom:o,left:i}=s;return[{x:i,y:r},{x:a,y:r},{x:a,y:o},{x:i,y:o}]}function OS(s,r){const{x:a,y:o}=s;let i=!1;for(let d=0,l=r.length-1;d<r.length;l=d++){const u=r[d].x,m=r[d].y,h=r[l].x,x=r[l].y;m>o!=x>o&&a<(h-u)*(o-m)/(x-m)+u&&(i=!i)}return i}function PS(s){const r=s.slice();return r.sort((a,o)=>a.x<o.x?-1:a.x>o.x?1:a.y<o.y?-1:a.y>o.y?1:0),MS(r)}function MS(s){if(s.length<=1)return s.slice();const r=[];for(let o=0;o<s.length;o++){const i=s[o];for(;r.length>=2;){const d=r[r.length-1],l=r[r.length-2];if((d.x-l.x)*(i.y-l.y)>=(d.y-l.y)*(i.x-l.x))r.pop();else break}r.push(i)}r.pop();const a=[];for(let o=s.length-1;o>=0;o--){const i=s[o];for(;a.length>=2;){const d=a[a.length-1],l=a[a.length-2];if((d.x-l.x)*(i.y-l.y)>=(d.y-l.y)*(i.x-l.x))a.pop();else break}a.push(i)}return a.pop(),r.length===1&&a.length===1&&r[0].x===a[0].x&&r[0].y===a[0].y?r:r.concat(a)}var RS=tp,IS=sp,$S=ap,ip=np;const An=RS,ln=IS,cn=$S,Ma=f.forwardRef(({className:s,sideOffset:r=4,...a},o)=>e.jsx(ip,{ref:o,sideOffset:r,className:Z("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));Ma.displayName=ip.displayName;const LS={apiKey:"AIzaSyA1UeSwJ_gjygFI5SL4ZANSDHWTnuOxD_o",authDomain:"lifetracker-9e171.firebaseapp.com",projectId:"lifetracker-9e171",storageBucket:"lifetracker-9e171.firebasestorage.app",messagingSenderId:"160072327627",appId:"1:160072327627:web:664a48e910b6eedd59964e"},lp=b1(LS),bc=N1(lp),ne=w1(lp);function Se(){const[s,r]=f.useState(null),[a,o]=f.useState(!0);return f.useEffect(()=>S1(bc,u=>{r(u),o(!1)}),[]),{user:s,loading:a,signIn:async()=>{const l=new C1;try{await E1(bc,l)}catch(u){console.error("Error al iniciar sesión:",u)}},signOut:async()=>{try{await D1(bc)}catch(l){console.error("Error al cerrar sesión:",l)}}}}const Aa=[{icon:k1,label:"Inicio",path:"/"},{icon:no,label:"Hidratación",path:"/water"},{icon:O1,label:"Ejercicio",path:"/exercise"},{icon:P1,label:"Hábitos",path:"/habit"},{icon:Ai,label:"Estado",path:"/mood"},{icon:M1,label:"Diario",path:"/journal"},{icon:ro,label:"Pomodoro",path:"/pomodoro"},{icon:Rh,label:"Comidas",path:"/meal"},{icon:R1,label:"Tareas",path:"/task"},{icon:I1,label:"Kanban",path:"/kanban"},{icon:Ih,label:"Estadísticas",path:"/stats"},{icon:$1,label:"Hábitos Negativos",path:"/negative"},{icon:L1,label:"Salir",path:"/logout"}],zS=()=>{const s=kh(),r=Oh(),{signOut:a}=Se(),[o,i]=f.useState(()=>localStorage.getItem("desktop-nav-expanded")==="true");f.useEffect(()=>{localStorage.setItem("desktop-nav-expanded",JSON.stringify(o)),document.documentElement.style.setProperty("--desktop-nav-width",o?"256px":"64px")},[o]);const d=async()=>{try{await a(),r("/login")}catch(u){console.error("Error al cerrar sesión:",u)}},l=({icon:u,label:m,path:h,onClick:x})=>{const p=s.pathname===h,g=e.jsxs(e.Fragment,{children:[e.jsx(u,{className:`w-5 h-5 flex-shrink-0 ${p?"text-white":"text-gray-600"}`}),o&&e.jsx("span",{className:`ml-3 font-medium truncate ${p?"text-white":"text-gray-700"}`,children:m})]}),v=`
      w-full flex items-center justify-start rounded-xl transition-colors duration-150
      ${o?"px-4 py-3":"p-3"} 
      ${p?"gradient-bg-primary text-white shadow-lg":"hover:bg-white/20"}
    `;return o?e.jsx(F,{variant:"ghost",className:v,onClick:()=>x?x():r(h),children:g}):e.jsx(An,{children:e.jsxs(ln,{delayDuration:0,children:[e.jsx(cn,{asChild:!0,children:e.jsx(F,{variant:"ghost",className:v,onClick:()=>x?x():r(h),children:g})}),e.jsx(Ma,{side:"right",className:"bg-black text-white border-gray-700",children:e.jsx("p",{children:m})})]})})};return e.jsxs("aside",{className:`hidden md:flex flex-col h-screen fixed top-0 left-0 transition-all duration-300 glass-card z-50 border-r-0
      ${o?"w-64":"w-16"}`,children:[e.jsxs("div",{className:"flex flex-col items-center space-y-3 p-4",children:[o?e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"Daily Tracker"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Organiza tu vida"})]}):e.jsx("div",{className:"w-10 h-10 gradient-bg-primary rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white font-bold text-sm",children:"DT"})}),"        ",e.jsx(F,{variant:"ghost",size:"icon",title:"Expand/Collapse Menu",onClick:()=>i(!o),className:"p-2 hover:bg-white/20 rounded-lg",children:e.jsx(Mn,{className:`w-4 h-4 transform transition-transform duration-200 
            ${o?"rotate-180":""}`})})]}),e.jsxs("nav",{className:"flex-1 p-3 overflow-y-auto space-y-2",children:[e.jsx("div",{className:"flex-1 space-y-1",children:Aa.slice(0,-1).map(u=>e.jsx(l,{icon:u.icon,label:u.label,path:u.path},u.path))}),e.jsx("div",{className:"border-t border-white/20 pt-3 mt-auto",children:e.jsx(l,{icon:Aa[Aa.length-1].icon,label:Aa[Aa.length-1].label,path:Aa[Aa.length-1].path,onClick:d})})]})]})},FS=Zc,HS=Qc,WS=Xc,cp=f.forwardRef(({className:s,...r},a)=>e.jsx(eo,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:a}));cp.displayName=eo.displayName;const BS=io("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),dp=f.forwardRef(({side:s="right",className:r,children:a,...o},i)=>e.jsxs(WS,{children:[e.jsx(cp,{}),e.jsxs(to,{ref:i,className:Z(BS({side:s}),r),...o,children:[a,e.jsxs(_i,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Rs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));dp.displayName=to.displayName;const up=({className:s,...r})=>e.jsx("div",{className:Z("flex flex-col space-y-2 text-center sm:text-left",s),...r});up.displayName="SheetHeader";const mp=f.forwardRef(({className:s,...r},a)=>e.jsx(so,{ref:a,className:Z("text-lg font-semibold text-foreground",s),...r}));mp.displayName=so.displayName;const US=f.forwardRef(({className:s,...r},a)=>e.jsx(ao,{ref:a,className:Z("text-sm text-muted-foreground",s),...r}));US.displayName=ao.displayName;const qS=()=>{const s=kh(),r=Oh(),{signOut:a}=Se(),[o,i]=f.useState(!1),d=async()=>{try{i(!1),await a(),r("/login")}catch(h){console.error("Error al cerrar sesión:",h)}},l=Aa.slice(0,4),u=Aa.slice(4),m=({icon:h,label:x,path:p,onClick:g})=>{const v=s.pathname===p;return e.jsxs(F,{variant:"ghost",className:`flex flex-col items-center justify-center h-auto px-2 py-2 text-xs rounded-xl transition-all duration-300 active:scale-95 touch-manipulation
          ${v?"text-blue-600 bg-blue-50 shadow-sm scale-105":"text-gray-600 hover:text-blue-600 hover:bg-blue-50/50 hover:scale-105"}`,onClick:()=>{g?g():r(p),i(!1)},children:[e.jsx(h,{className:`w-5 h-5 sm:w-6 sm:h-6 ${v?"animate-pulse":""}`}),e.jsx("span",{className:"mt-1 font-medium leading-tight",children:x})]})};return e.jsxs("div",{className:"md:hidden",children:[e.jsx("div",{className:"fixed top-0 left-0 right-0 bg-white/95 backdrop-blur-md border-b border-gray-200 z-30 shadow-sm",children:e.jsx("div",{className:"flex justify-between items-center px-4 h-16 max-w-screen-sm mx-auto",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-xs",children:"DT"})}),e.jsx("h1",{className:"text-base sm:text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Daily Tracker"})]})})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-200 z-30 shadow-lg",children:e.jsxs("nav",{className:"flex justify-around items-center px-1 py-1 max-w-screen-sm mx-auto",children:[l.map(h=>e.jsx(m,{icon:h.icon,label:h.label,path:h.path},h.path)),e.jsxs(FS,{open:o,onOpenChange:i,children:[e.jsx(HS,{asChild:!0,children:e.jsxs(F,{variant:"ghost",className:`flex flex-col items-center justify-center h-auto px-2 py-2 text-xs rounded-xl transition-all duration-300 active:scale-95 touch-manipulation
                  ${o?"text-blue-600 bg-blue-50 scale-105":"text-gray-600 hover:bg-blue-50/50 hover:scale-105"}`,children:[e.jsx(ga,{className:`w-5 h-5 sm:w-6 sm:h-6 transform transition-transform duration-300
                  ${o?"rotate-180":""}`}),e.jsx("span",{className:"mt-1 font-medium leading-tight",children:"Más"})]})}),e.jsxs(dp,{side:"bottom",className:"rounded-t-2xl bg-white/95 backdrop-blur-md border-t border-gray-200 max-w-screen-sm mx-auto",children:[e.jsx(up,{className:"mb-4",children:e.jsx(mp,{className:"text-center text-lg font-semibold text-gray-800",children:"Más opciones"})}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 p-2",children:u.map(h=>e.jsx(m,{icon:h.icon,label:h.label,path:h.path,onClick:h.path==="/logout"?d:void 0},h.path))})]})]})]})})]})},VS=()=>{const{isMobile:s,isTablet:r}=Xh(),a=s||r&&window.innerWidth<900;return e.jsx(e.Fragment,{children:a?e.jsx(qS,{}):e.jsx(zS,{})})},YS=()=>{const{canInstall:s,promptInstall:r,isInstalled:a}=hS(),[o,i]=f.useState(!1),[d,l]=f.useState(!1);f.useEffect(()=>{if(s&&!a&&!d){const h=setTimeout(()=>{i(!0)},1e4);return()=>clearTimeout(h)}},[s,a,d]);const u=async()=>{await r()&&i(!1)},m=()=>{i(!1),l(!0),sessionStorage.setItem("pwa-install-dismissed","true")};return a||!s||!o||sessionStorage.getItem("pwa-install-dismissed")?null:e.jsx("div",{className:"fixed bottom-20 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-white rounded-lg shadow-lg border border-gray-200 p-4 z-50 animate-in slide-in-from-bottom-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(hr,{className:"w-5 h-5 text-blue-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Instalar Life Tracker"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Instala la app para un acceso más rápido y funciones offline."}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(F,{size:"sm",onClick:u,className:"text-xs px-3 py-1 h-auto",children:"Instalar"}),e.jsx(F,{variant:"ghost",size:"sm",onClick:m,className:"text-xs px-3 py-1 h-auto",children:"Ahora no"})]})]}),e.jsx(F,{variant:"ghost",size:"sm",onClick:m,className:"flex-shrink-0 p-1 h-auto w-auto",children:e.jsx(Rs,{className:"w-4 h-4"})})]})})},GS=()=>{const[s,r]=f.useState(navigator.onLine),[a,o]=f.useState(!1),[i,d]=f.useState(!1);f.useEffect(()=>{const u=()=>{r(!0),o(!1)},m=()=>{r(!1),o(!0),setTimeout(()=>o(!1),5e3)},h=()=>{d(!0)};return window.addEventListener("online",u),window.addEventListener("offline",m),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",x=>{x.data&&x.data.type==="SKIP_WAITING"&&h()}),()=>{window.removeEventListener("online",u),window.removeEventListener("offline",m)}},[]);const l=()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(u=>{u&&u.waiting&&(u.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:!s&&e.jsxs("div",{className:"flex items-center gap-1 bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs",children:[e.jsx(gf,{className:"w-3 h-3"}),e.jsx("span",{children:"Offline"})]})}),a&&e.jsxs("div",{className:"fixed top-16 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-orange-50 border border-orange-200 rounded-lg p-3 z-50 animate-in slide-in-from-top-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gf,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"text-orange-800 text-sm font-medium",children:"Sin conexión"})]}),e.jsx("p",{className:"text-orange-700 text-xs mt-1",children:"Trabajando en modo offline. Los datos se sincronizarán cuando vuelvas a conectarte."})]}),i&&e.jsxs("div",{className:"fixed top-16 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-blue-50 border border-blue-200 rounded-lg p-3 z-50 animate-in slide-in-from-top-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ki,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-blue-800 text-sm font-medium",children:"Actualización disponible"})]}),e.jsx("p",{className:"text-blue-700 text-xs mt-1",children:"Hay una nueva versión disponible."}),e.jsx(F,{size:"sm",onClick:l,className:"mt-2 text-xs px-3 py-1 h-auto",children:"Actualizar"})]})]})},KS=({children:s})=>{const{isMobile:r}=Xh(),[a,o]=f.useState(0),[i,d]=f.useState(!1);return f.useEffect(()=>{if(!r)return;let l=0,u=0,m=!0;const h=g=>{l=g.touches[0].clientY,m=window.scrollY===0},x=g=>{if(!m)return;u=g.touches[0].clientY;const v=u-l;v>0&&v<150&&(d(!0),o(v),g.preventDefault())},p=()=>{i&&a>100&&window.location.reload(),d(!1),o(0)};return document.addEventListener("touchstart",h,{passive:!1}),document.addEventListener("touchmove",x,{passive:!1}),document.addEventListener("touchend",p),()=>{document.removeEventListener("touchstart",h),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",p)}},[r,i,a]),r?e.jsxs("div",{className:"relative",children:[i&&e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-blue-500 text-white text-center py-2 text-sm transition-transform duration-200",style:{transform:`translateY(${Math.min(a-50,0)}px)`,opacity:a/100},children:a>100?"¡Suelta para actualizar!":"Tira hacia abajo para actualizar"}),s]}):e.jsx(e.Fragment,{children:s})};var wf=["light","dark"],JS="(prefers-color-scheme: dark)",XS=f.createContext(void 0),ZS={setTheme:s=>{},themes:[]},QS=()=>{var s;return(s=f.useContext(XS))!=null?s:ZS};f.memo(({forcedTheme:s,storageKey:r,attribute:a,enableSystem:o,enableColorScheme:i,defaultTheme:d,value:l,attrs:u,nonce:m})=>{let h=d==="system",x=a==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${u.map(j=>`'${j}'`).join(",")})`};`:`var d=document.documentElement,n='${a}',s='setAttribute';`,p=i?wf.includes(d)&&d?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${d}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",g=(j,b=!1,N=!0)=>{let C=l?l[j]:j,S=b?j+"|| ''":`'${C}'`,_="";return i&&N&&!b&&wf.includes(j)&&(_+=`d.style.colorScheme = '${j}';`),a==="class"?b||C?_+=`c.add(${S})`:_+="null":C&&(_+=`d[s](n,${S})`),_},v=s?`!function(){${x}${g(s)}}()`:o?`!function(){try{${x}var e=localStorage.getItem('${r}');if('system'===e||(!e&&${h})){var t='${JS}',m=window.matchMedia(t);if(m.media!==t||m.matches){${g("dark")}}else{${g("light")}}}else if(e){${l?`var x=${JSON.stringify(l)};`:""}${g(l?"x[e]":"e",!0)}}${h?"":"else{"+g(d,!1,!1)+"}"}${p}}catch(e){}}()`:`!function(){try{${x}var e=localStorage.getItem('${r}');if(e){${l?`var x=${JSON.stringify(l)};`:""}${g(l?"x[e]":"e",!0)}}else{${g(d,!1,!1)};}${p}}catch(t){}}();`;return f.createElement("script",{nonce:m,dangerouslySetInnerHTML:{__html:v}})});var eC=s=>{switch(s){case"success":return aC;case"info":return rC;case"warning":return nC;case"error":return oC;default:return null}},tC=Array(12).fill(0),sC=({visible:s,className:r})=>Q.createElement("div",{className:["sonner-loading-wrapper",r].filter(Boolean).join(" "),"data-visible":s},Q.createElement("div",{className:"sonner-spinner"},tC.map((a,o)=>Q.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${o}`})))),aC=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Q.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),nC=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Q.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),rC=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Q.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),oC=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Q.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),iC=Q.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Q.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Q.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),lC=()=>{let[s,r]=Q.useState(document.hidden);return Q.useEffect(()=>{let a=()=>{r(document.hidden)};return document.addEventListener("visibilitychange",a),()=>window.removeEventListener("visibilitychange",a)},[]),s},Fc=1,cC=class{constructor(){this.subscribe=s=>(this.subscribers.push(s),()=>{let r=this.subscribers.indexOf(s);this.subscribers.splice(r,1)}),this.publish=s=>{this.subscribers.forEach(r=>r(s))},this.addToast=s=>{this.publish(s),this.toasts=[...this.toasts,s]},this.create=s=>{var r;let{message:a,...o}=s,i=typeof(s==null?void 0:s.id)=="number"||((r=s.id)==null?void 0:r.length)>0?s.id:Fc++,d=this.toasts.find(u=>u.id===i),l=s.dismissible===void 0?!0:s.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),d?this.toasts=this.toasts.map(u=>u.id===i?(this.publish({...u,...s,id:i,title:a}),{...u,...s,id:i,dismissible:l,title:a}):u):this.addToast({title:a,...o,dismissible:l,id:i}),i},this.dismiss=s=>(this.dismissedToasts.add(s),s||this.toasts.forEach(r=>{this.subscribers.forEach(a=>a({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:s,dismiss:!0})),s),this.message=(s,r)=>this.create({...r,message:s}),this.error=(s,r)=>this.create({...r,message:s,type:"error"}),this.success=(s,r)=>this.create({...r,type:"success",message:s}),this.info=(s,r)=>this.create({...r,type:"info",message:s}),this.warning=(s,r)=>this.create({...r,type:"warning",message:s}),this.loading=(s,r)=>this.create({...r,type:"loading",message:s}),this.promise=(s,r)=>{if(!r)return;let a;r.loading!==void 0&&(a=this.create({...r,promise:s,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let o=s instanceof Promise?s:s(),i=a!==void 0,d,l=o.then(async m=>{if(d=["resolve",m],Q.isValidElement(m))i=!1,this.create({id:a,type:"default",message:m});else if(uC(m)&&!m.ok){i=!1;let h=typeof r.error=="function"?await r.error(`HTTP error! status: ${m.status}`):r.error,x=typeof r.description=="function"?await r.description(`HTTP error! status: ${m.status}`):r.description;this.create({id:a,type:"error",message:h,description:x})}else if(r.success!==void 0){i=!1;let h=typeof r.success=="function"?await r.success(m):r.success,x=typeof r.description=="function"?await r.description(m):r.description;this.create({id:a,type:"success",message:h,description:x})}}).catch(async m=>{if(d=["reject",m],r.error!==void 0){i=!1;let h=typeof r.error=="function"?await r.error(m):r.error,x=typeof r.description=="function"?await r.description(m):r.description;this.create({id:a,type:"error",message:h,description:x})}}).finally(()=>{var m;i&&(this.dismiss(a),a=void 0),(m=r.finally)==null||m.call(r)}),u=()=>new Promise((m,h)=>l.then(()=>d[0]==="reject"?h(d[1]):m(d[1])).catch(h));return typeof a!="string"&&typeof a!="number"?{unwrap:u}:Object.assign(a,{unwrap:u})},this.custom=(s,r)=>{let a=(r==null?void 0:r.id)||Fc++;return this.create({jsx:s(a),id:a,...r}),a},this.getActiveToasts=()=>this.toasts.filter(s=>!this.dismissedToasts.has(s.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ss=new cC,dC=(s,r)=>{let a=(r==null?void 0:r.id)||Fc++;return ss.addToast({title:s,...r,id:a}),a},uC=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number",mC=dC,fC=()=>ss.toasts,hC=()=>ss.getActiveToasts(),At=Object.assign(mC,{success:ss.success,info:ss.info,warning:ss.warning,error:ss.error,custom:ss.custom,message:ss.message,promise:ss.promise,dismiss:ss.dismiss,loading:ss.loading},{getHistory:fC,getToasts:hC});function pC(s,{insertAt:r}={}){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",r==="top"&&a.firstChild?a.insertBefore(o,a.firstChild):a.appendChild(o),o.styleSheet?o.styleSheet.cssText=s:o.appendChild(document.createTextNode(s))}pC(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function di(s){return s.label!==void 0}var xC=3,gC="32px",vC="16px",Sf=4e3,yC=356,jC=14,bC=20,NC=200;function Gs(...s){return s.filter(Boolean).join(" ")}function wC(s){let[r,a]=s.split("-"),o=[];return r&&o.push(r),a&&o.push(a),o}var SC=s=>{var r,a,o,i,d,l,u,m,h,x,p;let{invert:g,toast:v,unstyled:j,interacting:b,setHeights:N,visibleToasts:C,heights:S,index:_,toasts:A,expanded:k,removeToast:D,defaultRichColors:P,closeButton:M,style:$,cancelButtonStyle:W,actionButtonStyle:I,className:B="",descriptionClassName:H="",duration:U,position:ee,gap:re,loadingIcon:J,expandByDefault:te,classNames:me,icons:Ce,closeButtonAriaLabel:_e="Close toast",pauseWhenPageIsHidden:Ee}=s,[Ne,V]=Q.useState(null),[ie,at]=Q.useState(null),[qe,is]=Q.useState(!1),[Ut,zs]=Q.useState(!1),[Pt,Ns]=Q.useState(!1),[de,ye]=Q.useState(!1),[Mt,Fs]=Q.useState(!1),[Rt,Hs]=Q.useState(0),[zn,Ws]=Q.useState(0),Dt=Q.useRef(v.duration||U||Sf),Fa=Q.useRef(null),ws=Q.useRef(null),ol=_===0,hn=_+1<=C,Xt=v.type,Ss=v.dismissible!==!1,Ha=v.className||"",jr=v.descriptionClassName||"",Wa=Q.useMemo(()=>S.findIndex(je=>je.toastId===v.id)||0,[S,v.id]),br=Q.useMemo(()=>{var je;return(je=v.closeButton)!=null?je:M},[v.closeButton,M]),Fn=Q.useMemo(()=>v.duration||U||Sf,[v.duration,U]),pn=Q.useRef(0),ia=Q.useRef(0),Hn=Q.useRef(0),la=Q.useRef(null),[Nr,il]=ee.split("-"),yo=Q.useMemo(()=>S.reduce((je,Ve,ot)=>ot>=Wa?je:je+Ve.height,0),[S,Wa]),jo=lC(),bo=v.invert||g,Wn=Xt==="loading";ia.current=Q.useMemo(()=>Wa*re+yo,[Wa,yo]),Q.useEffect(()=>{Dt.current=Fn},[Fn]),Q.useEffect(()=>{is(!0)},[]),Q.useEffect(()=>{let je=ws.current;if(je){let Ve=je.getBoundingClientRect().height;return Ws(Ve),N(ot=>[{toastId:v.id,height:Ve,position:v.position},...ot]),()=>N(ot=>ot.filter(ls=>ls.toastId!==v.id))}},[N,v.id]),Q.useLayoutEffect(()=>{if(!qe)return;let je=ws.current,Ve=je.style.height;je.style.height="auto";let ot=je.getBoundingClientRect().height;je.style.height=Ve,Ws(ot),N(ls=>ls.find(cs=>cs.toastId===v.id)?ls.map(cs=>cs.toastId===v.id?{...cs,height:ot}:cs):[{toastId:v.id,height:ot,position:v.position},...ls])},[qe,v.title,v.description,N,v.id]);let ca=Q.useCallback(()=>{zs(!0),Hs(ia.current),N(je=>je.filter(Ve=>Ve.toastId!==v.id)),setTimeout(()=>{D(v)},NC)},[v,D,N,ia]);Q.useEffect(()=>{if(v.promise&&Xt==="loading"||v.duration===1/0||v.type==="loading")return;let je;return k||b||Ee&&jo?(()=>{if(Hn.current<pn.current){let Ve=new Date().getTime()-pn.current;Dt.current=Dt.current-Ve}Hn.current=new Date().getTime()})():Dt.current!==1/0&&(pn.current=new Date().getTime(),je=setTimeout(()=>{var Ve;(Ve=v.onAutoClose)==null||Ve.call(v,v),ca()},Dt.current)),()=>clearTimeout(je)},[k,b,v,Xt,Ee,jo,ca]),Q.useEffect(()=>{v.delete&&ca()},[ca,v.delete]);function ll(){var je,Ve,ot;return Ce!=null&&Ce.loading?Q.createElement("div",{className:Gs(me==null?void 0:me.loader,(je=v==null?void 0:v.classNames)==null?void 0:je.loader,"sonner-loader"),"data-visible":Xt==="loading"},Ce.loading):J?Q.createElement("div",{className:Gs(me==null?void 0:me.loader,(Ve=v==null?void 0:v.classNames)==null?void 0:Ve.loader,"sonner-loader"),"data-visible":Xt==="loading"},J):Q.createElement(sC,{className:Gs(me==null?void 0:me.loader,(ot=v==null?void 0:v.classNames)==null?void 0:ot.loader),visible:Xt==="loading"})}return Q.createElement("li",{tabIndex:0,ref:ws,className:Gs(B,Ha,me==null?void 0:me.toast,(r=v==null?void 0:v.classNames)==null?void 0:r.toast,me==null?void 0:me.default,me==null?void 0:me[Xt],(a=v==null?void 0:v.classNames)==null?void 0:a[Xt]),"data-sonner-toast":"","data-rich-colors":(o=v.richColors)!=null?o:P,"data-styled":!(v.jsx||v.unstyled||j),"data-mounted":qe,"data-promise":!!v.promise,"data-swiped":Mt,"data-removed":Ut,"data-visible":hn,"data-y-position":Nr,"data-x-position":il,"data-index":_,"data-front":ol,"data-swiping":Pt,"data-dismissible":Ss,"data-type":Xt,"data-invert":bo,"data-swipe-out":de,"data-swipe-direction":ie,"data-expanded":!!(k||te&&qe),style:{"--index":_,"--toasts-before":_,"--z-index":A.length-_,"--offset":`${Ut?Rt:ia.current}px`,"--initial-height":te?"auto":`${zn}px`,...$,...v.style},onDragEnd:()=>{Ns(!1),V(null),la.current=null},onPointerDown:je=>{Wn||!Ss||(Fa.current=new Date,Hs(ia.current),je.target.setPointerCapture(je.pointerId),je.target.tagName!=="BUTTON"&&(Ns(!0),la.current={x:je.clientX,y:je.clientY}))},onPointerUp:()=>{var je,Ve,ot,ls;if(de||!Ss)return;la.current=null;let cs=Number(((je=ws.current)==null?void 0:je.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),da=Number(((Ve=ws.current)==null?void 0:Ve.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Bs=new Date().getTime()-((ot=Fa.current)==null?void 0:ot.getTime()),ds=Ne==="x"?cs:da,Cs=Math.abs(ds)/Bs;if(Math.abs(ds)>=bC||Cs>.11){Hs(ia.current),(ls=v.onDismiss)==null||ls.call(v,v),at(Ne==="x"?cs>0?"right":"left":da>0?"down":"up"),ca(),ye(!0),Fs(!1);return}Ns(!1),V(null)},onPointerMove:je=>{var Ve,ot,ls,cs;if(!la.current||!Ss||((Ve=window.getSelection())==null?void 0:Ve.toString().length)>0)return;let da=je.clientY-la.current.y,Bs=je.clientX-la.current.x,ds=(ot=s.swipeDirections)!=null?ot:wC(ee);!Ne&&(Math.abs(Bs)>1||Math.abs(da)>1)&&V(Math.abs(Bs)>Math.abs(da)?"x":"y");let Cs={x:0,y:0};Ne==="y"?(ds.includes("top")||ds.includes("bottom"))&&(ds.includes("top")&&da<0||ds.includes("bottom")&&da>0)&&(Cs.y=da):Ne==="x"&&(ds.includes("left")||ds.includes("right"))&&(ds.includes("left")&&Bs<0||ds.includes("right")&&Bs>0)&&(Cs.x=Bs),(Math.abs(Cs.x)>0||Math.abs(Cs.y)>0)&&Fs(!0),(ls=ws.current)==null||ls.style.setProperty("--swipe-amount-x",`${Cs.x}px`),(cs=ws.current)==null||cs.style.setProperty("--swipe-amount-y",`${Cs.y}px`)}},br&&!v.jsx?Q.createElement("button",{"aria-label":_e,"data-disabled":Wn,"data-close-button":!0,onClick:Wn||!Ss?()=>{}:()=>{var je;ca(),(je=v.onDismiss)==null||je.call(v,v)},className:Gs(me==null?void 0:me.closeButton,(i=v==null?void 0:v.classNames)==null?void 0:i.closeButton)},(d=Ce==null?void 0:Ce.close)!=null?d:iC):null,v.jsx||f.isValidElement(v.title)?v.jsx?v.jsx:typeof v.title=="function"?v.title():v.title:Q.createElement(Q.Fragment,null,Xt||v.icon||v.promise?Q.createElement("div",{"data-icon":"",className:Gs(me==null?void 0:me.icon,(l=v==null?void 0:v.classNames)==null?void 0:l.icon)},v.promise||v.type==="loading"&&!v.icon?v.icon||ll():null,v.type!=="loading"?v.icon||(Ce==null?void 0:Ce[Xt])||eC(Xt):null):null,Q.createElement("div",{"data-content":"",className:Gs(me==null?void 0:me.content,(u=v==null?void 0:v.classNames)==null?void 0:u.content)},Q.createElement("div",{"data-title":"",className:Gs(me==null?void 0:me.title,(m=v==null?void 0:v.classNames)==null?void 0:m.title)},typeof v.title=="function"?v.title():v.title),v.description?Q.createElement("div",{"data-description":"",className:Gs(H,jr,me==null?void 0:me.description,(h=v==null?void 0:v.classNames)==null?void 0:h.description)},typeof v.description=="function"?v.description():v.description):null),f.isValidElement(v.cancel)?v.cancel:v.cancel&&di(v.cancel)?Q.createElement("button",{"data-button":!0,"data-cancel":!0,style:v.cancelButtonStyle||W,onClick:je=>{var Ve,ot;di(v.cancel)&&Ss&&((ot=(Ve=v.cancel).onClick)==null||ot.call(Ve,je),ca())},className:Gs(me==null?void 0:me.cancelButton,(x=v==null?void 0:v.classNames)==null?void 0:x.cancelButton)},v.cancel.label):null,f.isValidElement(v.action)?v.action:v.action&&di(v.action)?Q.createElement("button",{"data-button":!0,"data-action":!0,style:v.actionButtonStyle||I,onClick:je=>{var Ve,ot;di(v.action)&&((ot=(Ve=v.action).onClick)==null||ot.call(Ve,je),!je.defaultPrevented&&ca())},className:Gs(me==null?void 0:me.actionButton,(p=v==null?void 0:v.classNames)==null?void 0:p.actionButton)},v.action.label):null))};function Cf(){if(typeof window>"u"||typeof document>"u")return"ltr";let s=document.documentElement.getAttribute("dir");return s==="auto"||!s?window.getComputedStyle(document.documentElement).direction:s}function CC(s,r){let a={};return[s,r].forEach((o,i)=>{let d=i===1,l=d?"--mobile-offset":"--offset",u=d?vC:gC;function m(h){["top","right","bottom","left"].forEach(x=>{a[`${l}-${x}`]=typeof h=="number"?`${h}px`:h})}typeof o=="number"||typeof o=="string"?m(o):typeof o=="object"?["top","right","bottom","left"].forEach(h=>{o[h]===void 0?a[`${l}-${h}`]=u:a[`${l}-${h}`]=typeof o[h]=="number"?`${o[h]}px`:o[h]}):m(u)}),a}var EC=f.forwardRef(function(s,r){let{invert:a,position:o="bottom-right",hotkey:i=["altKey","KeyT"],expand:d,closeButton:l,className:u,offset:m,mobileOffset:h,theme:x="light",richColors:p,duration:g,style:v,visibleToasts:j=xC,toastOptions:b,dir:N=Cf(),gap:C=jC,loadingIcon:S,icons:_,containerAriaLabel:A="Notifications",pauseWhenPageIsHidden:k}=s,[D,P]=Q.useState([]),M=Q.useMemo(()=>Array.from(new Set([o].concat(D.filter(Ee=>Ee.position).map(Ee=>Ee.position)))),[D,o]),[$,W]=Q.useState([]),[I,B]=Q.useState(!1),[H,U]=Q.useState(!1),[ee,re]=Q.useState(x!=="system"?x:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),J=Q.useRef(null),te=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),me=Q.useRef(null),Ce=Q.useRef(!1),_e=Q.useCallback(Ee=>{P(Ne=>{var V;return(V=Ne.find(ie=>ie.id===Ee.id))!=null&&V.delete||ss.dismiss(Ee.id),Ne.filter(({id:ie})=>ie!==Ee.id)})},[]);return Q.useEffect(()=>ss.subscribe(Ee=>{if(Ee.dismiss){P(Ne=>Ne.map(V=>V.id===Ee.id?{...V,delete:!0}:V));return}setTimeout(()=>{a1.flushSync(()=>{P(Ne=>{let V=Ne.findIndex(ie=>ie.id===Ee.id);return V!==-1?[...Ne.slice(0,V),{...Ne[V],...Ee},...Ne.slice(V+1)]:[Ee,...Ne]})})})}),[]),Q.useEffect(()=>{if(x!=="system"){re(x);return}if(x==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?re("dark"):re("light")),typeof window>"u")return;let Ee=window.matchMedia("(prefers-color-scheme: dark)");try{Ee.addEventListener("change",({matches:Ne})=>{re(Ne?"dark":"light")})}catch{Ee.addListener(({matches:V})=>{try{re(V?"dark":"light")}catch(ie){console.error(ie)}})}},[x]),Q.useEffect(()=>{D.length<=1&&B(!1)},[D]),Q.useEffect(()=>{let Ee=Ne=>{var V,ie;i.every(at=>Ne[at]||Ne.code===at)&&(B(!0),(V=J.current)==null||V.focus()),Ne.code==="Escape"&&(document.activeElement===J.current||(ie=J.current)!=null&&ie.contains(document.activeElement))&&B(!1)};return document.addEventListener("keydown",Ee),()=>document.removeEventListener("keydown",Ee)},[i]),Q.useEffect(()=>{if(J.current)return()=>{me.current&&(me.current.focus({preventScroll:!0}),me.current=null,Ce.current=!1)}},[J.current]),Q.createElement("section",{ref:r,"aria-label":`${A} ${te}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},M.map((Ee,Ne)=>{var V;let[ie,at]=Ee.split("-");return D.length?Q.createElement("ol",{key:Ee,dir:N==="auto"?Cf():N,tabIndex:-1,ref:J,className:u,"data-sonner-toaster":!0,"data-theme":ee,"data-y-position":ie,"data-lifted":I&&D.length>1&&!d,"data-x-position":at,style:{"--front-toast-height":`${((V=$[0])==null?void 0:V.height)||0}px`,"--width":`${yC}px`,"--gap":`${C}px`,...v,...CC(m,h)},onBlur:qe=>{Ce.current&&!qe.currentTarget.contains(qe.relatedTarget)&&(Ce.current=!1,me.current&&(me.current.focus({preventScroll:!0}),me.current=null))},onFocus:qe=>{qe.target instanceof HTMLElement&&qe.target.dataset.dismissible==="false"||Ce.current||(Ce.current=!0,me.current=qe.relatedTarget)},onMouseEnter:()=>B(!0),onMouseMove:()=>B(!0),onMouseLeave:()=>{H||B(!1)},onDragEnd:()=>B(!1),onPointerDown:qe=>{qe.target instanceof HTMLElement&&qe.target.dataset.dismissible==="false"||U(!0)},onPointerUp:()=>U(!1)},D.filter(qe=>!qe.position&&Ne===0||qe.position===Ee).map((qe,is)=>{var Ut,zs;return Q.createElement(SC,{key:qe.id,icons:_,index:is,toast:qe,defaultRichColors:p,duration:(Ut=b==null?void 0:b.duration)!=null?Ut:g,className:b==null?void 0:b.className,descriptionClassName:b==null?void 0:b.descriptionClassName,invert:a,visibleToasts:j,closeButton:(zs=b==null?void 0:b.closeButton)!=null?zs:l,interacting:H,position:Ee,style:b==null?void 0:b.style,unstyled:b==null?void 0:b.unstyled,classNames:b==null?void 0:b.classNames,cancelButtonStyle:b==null?void 0:b.cancelButtonStyle,actionButtonStyle:b==null?void 0:b.actionButtonStyle,removeToast:_e,toasts:D.filter(Pt=>Pt.position==qe.position),heights:$.filter(Pt=>Pt.position==qe.position),setHeights:W,expandByDefault:d,gap:C,loadingIcon:S,expanded:I,pauseWhenPageIsHidden:k,swipeDirections:s.swipeDirections})})):null}))});const DC=({...s})=>{const{theme:r="system"}=QS();return e.jsx(EC,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},TC=()=>e.jsx(KS,{children:e.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden",children:[e.jsx(VS,{}),e.jsxs("div",{className:"flex-1 flex flex-col main-content-adaptive overflow-hidden",children:[e.jsx("div",{className:"pt-16 md:pt-0 flex-1 flex flex-col overflow-hidden",children:e.jsx("main",{className:"flex-1 overflow-auto scroll-container",children:e.jsx(n1,{})})}),e.jsx("div",{className:"pb-16 md:pb-0"})]}),e.jsx(GS,{}),e.jsx(YS,{}),e.jsx(DC,{})]})}),xa=({selectedDate:s,onChange:r})=>{const[a,o]=f.useState(!1);f.useEffect(()=>{const h=()=>{o(window.innerWidth<768)};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]);const i=()=>{const h=new Date(s);h.setDate(h.getDate()-1),r(h)},d=()=>{const h=new Date(s);h.setDate(h.getDate()+1),r(h)},l=()=>{r(new Date)},u=h=>a?h.toLocaleDateString("es-ES",{weekday:"short",month:"short",day:"numeric"}):h.toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),m=h=>{const x=new Date;return h.toDateString()===x.toDateString()};return e.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200 rounded-2xl p-4 mb-6 shadow-sm md:p-6 md:mb-8",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 md:gap-4",children:[e.jsx(F,{variant:"outline",size:"icon",onClick:i,className:"rounded-full border-2 bg-white/80 w-8 h-8 md:w-10 md:h-10 touch-manipulation active:scale-95 transition-transform",children:e.jsx($h,{className:"w-3 h-3 md:w-4 md:h-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("h2",{className:"text-sm md:text-xl font-semibold bg-gradient-to-r from-gray-700 to-gray-900 bg-clip-text text-transparent capitalize",children:u(s)}),!m(s)&&e.jsxs(F,{variant:"ghost",className:"text-xs md:text-sm mt-1 md:mt-2 rounded-full h-6 md:h-auto px-2 md:px-4 touch-manipulation active:scale-95 transition-transform",onClick:l,children:[e.jsx(pr,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Ir a hoy"}),e.jsx("span",{className:"md:hidden",children:"Hoy"})]}),m(s)&&e.jsx("div",{className:"inline-flex items-center px-2 md:px-3 py-1 mt-1 md:mt-2 rounded-full bg-green-100 text-green-800 text-xs font-medium",children:"Hoy"})]}),e.jsx(F,{variant:"outline",size:"icon",onClick:d,className:"rounded-full border-2 bg-white/80 w-8 h-8 md:w-10 md:h-10 touch-manipulation active:scale-95 transition-transform",children:e.jsx(Mn,{className:"w-3 h-3 md:w-4 md:h-4"})})]})})},Le=qw,ze=Vw,Re=f.forwardRef(({className:s,children:r,...a},o)=>e.jsxs(ch,{ref:o,className:Z("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[r,e.jsx(Fw,{asChild:!0,children:e.jsx(ga,{className:"h-4 w-4 opacity-50"})})]}));Re.displayName=ch.displayName;const fp=f.forwardRef(({className:s,...r},a)=>e.jsx(dh,{ref:a,className:Z("flex cursor-default items-center justify-center py-1",s),...r,children:e.jsx(Oi,{className:"h-4 w-4"})}));fp.displayName=dh.displayName;const hp=f.forwardRef(({className:s,...r},a)=>e.jsx(uh,{ref:a,className:Z("flex cursor-default items-center justify-center py-1",s),...r,children:e.jsx(ga,{className:"h-4 w-4"})}));hp.displayName=uh.displayName;const Ie=f.forwardRef(({className:s,children:r,position:a="popper",...o},i)=>e.jsx(Hw,{children:e.jsxs(mh,{ref:i,className:Z("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...o,children:[e.jsx(fp,{}),e.jsx(Ww,{className:Z("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),e.jsx(hp,{})]})}));Ie.displayName=mh.displayName;const _C=f.forwardRef(({className:s,...r},a)=>e.jsx(fh,{ref:a,className:Z("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r}));_C.displayName=fh.displayName;const le=f.forwardRef(({className:s,children:r,...a},o)=>e.jsxs(hh,{ref:o,className:Z("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Bw,{children:e.jsx(Pi,{className:"h-4 w-4"})})}),e.jsx(Uw,{children:r})]}));le.displayName=hh.displayName;const AC=f.forwardRef(({className:s,...r},a)=>e.jsx(ph,{ref:a,className:Z("-mx-1 my-1 h-px bg-muted",s),...r}));AC.displayName=ph.displayName;const Ef={lastMonth:{label:"Último mes",getValue:s=>({start:Qe(Wr(s,1)),end:vs(Wr(s,1))})},currentMonth:{label:"Mes actual",getValue:s=>({start:Qe(s),end:vs(s)})},last3Months:{label:"Últimos 3 meses",getValue:s=>({start:Qe(Wr(s,2)),end:vs(s)})},last6Months:{label:"Últimos 6 meses",getValue:s=>({start:Qe(Wr(s,5)),end:vs(s)})},lastYear:{label:"Último año",getValue:s=>({start:Pc(hf(s,1)),end:pf(hf(s,1))})},currentYear:{label:"Año actual",getValue:s=>({start:Pc(s),end:pf(s)})}},kC=({onPeriodChange:s})=>{const r=a=>{const o=new Date,i=Ef[a];if(i){const{start:d,end:l}=i.getValue(o);s(d,l)}};return e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("span",{className:"text-sm font-medium",children:"Mostrar período:"}),e.jsxs(Le,{onValueChange:r,defaultValue:"currentMonth",children:[e.jsx(Re,{className:"w-[180px]",children:e.jsx(ze,{placeholder:"Seleccionar período"})}),e.jsx(Ie,{children:Object.entries(Ef).map(([a,{label:o}])=>e.jsx(le,{value:a,children:o},a))})]})]})},se=f.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:Z("rounded-lg border bg-card text-card-foreground shadow-sm overflow-hidden",s),...r}));se.displayName="Card";const Oe=f.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:Z("flex flex-col space-y-1.5 p-4 md:p-6",s),...r}));Oe.displayName="CardHeader";const Pe=f.forwardRef(({className:s,...r},a)=>e.jsx("h3",{ref:a,className:Z("text-lg md:text-2xl font-semibold leading-none tracking-tight",s),...r}));Pe.displayName="CardTitle";const pp=f.forwardRef(({className:s,...r},a)=>e.jsx("p",{ref:a,className:Z("text-sm md:text-base text-muted-foreground",s),...r}));pp.displayName="CardDescription";const ae=f.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:Z("p-4 md:p-6 pt-0",s),...r}));ae.displayName="CardContent";const Bi=f.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:Z("flex items-center p-4 md:p-6 pt-0",s),...r}));Bi.displayName="CardFooter";const Xr={water:"Agua",dairy:"Lácteos",caffeine:"Cafeína",hydration:"Hidratación",soda:"Gaseosas",alcohol:"Alcohol",other:"Otros"},Jt={water:{name:"Agua",icon:"Droplet",hydrationFactor:1,color:"text-blue-500",amounts:[100,200,300],category:"water"},sparklingWater:{name:"Agua con gas",icon:"Waves",hydrationFactor:1,color:"text-blue-400",amounts:[100,200,300],category:"water"},flavoredWater:{name:"Agua saborizada",icon:"Droplets",hydrationFactor:.95,color:"text-blue-300",amounts:[100,200,300],category:"water"},milk:{name:"Leche",icon:"Milk",hydrationFactor:.9,color:"text-blue-500",amounts:[100,200,300],category:"dairy"},chocolate:{name:"Chocolate",icon:"Milk",hydrationFactor:.8,color:"text-brown-500",amounts:[100,200,300],category:"dairy"},colagranulada:{name:"Cola Granulada",icon:"Milk",hydrationFactor:.9,color:"text-red-500",amounts:[100,200,300],category:"dairy"},ensure:{name:"Ensure / Pediasure",icon:"Milk",hydrationFactor:.9,color:"text-red-500",amounts:[100,200,300],category:"dairy"},yogurt:{name:"Yogurt",icon:"Milk",hydrationFactor:.6,color:"text-amber-600",amounts:[100,200,300],category:"dairy"},coffee:{name:"Café",icon:"Coffee",hydrationFactor:.8,color:"text-amber-800",amounts:[100,200,300],category:"caffeine"},energyDrink:{name:"Energizante",icon:"Zap",hydrationFactor:.6,color:"text-yellow-500",amounts:[100,250,500],category:"caffeine"},juice:{name:"Jugo",icon:"Cherry",hydrationFactor:.85,color:"text-orange-500",amounts:[100,200,300],category:"hydration"},sportsdrink:{name:"Bebida deportiva",icon:"Dumbbell",hydrationFactor:.9,color:"text-green-500",amounts:[250,500,750],category:"hydration"},soup:{name:"Sopa",icon:"Soup",hydrationFactor:.6,color:"text-orange-500",amounts:[200,400,600],category:"other"},soda:{name:"Gaseosa",icon:"CircleDot",hydrationFactor:.6,color:"text-purple-500",amounts:[200,350,500],category:"soda"},beer:{name:"Cerveza",icon:"Beer",hydrationFactor:.8,color:"text-yellow-600",amounts:[330,500,750],category:"alcohol"},aguardiente:{name:"Aguardiente",icon:"Beer",hydrationFactor:.2,color:"text-yellow-600",amounts:[50,100,200],category:"alcohol"},wine:{name:"Vino",icon:"Wine",hydrationFactor:.1,color:"text-red-600",amounts:[150,250,750],category:"alcohol"},aromatica:{name:"Aromática",icon:"Coffee",hydrationFactor:.95,color:"text-green-600",amounts:[100,200,300],category:"other"},iceCream:{name:"Helado",icon:"Cookie",hydrationFactor:.4,color:"text-cyan-400",amounts:[50,100,150],category:"other"},granizado:{name:"Granizado",icon:"Cookie",hydrationFactor:.8,color:"text-blue-300",amounts:[150,250,350],category:"hydration"},tea:{name:"Té",icon:"Coffee",hydrationFactor:.9,color:"text-green-500",amounts:[100,200,300],category:"caffeine"}},OC={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},PC=(s,r,a)=>{let o;const i=OC[s];return typeof i=="string"?o=i:r===1?o=i.one:o=i.other.replace("{{count}}",r.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"en "+o:"hace "+o:o},MC={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},RC={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},IC={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},$C={date:yc({formats:MC,defaultWidth:"full"}),time:yc({formats:RC,defaultWidth:"full"}),dateTime:yc({formats:IC,defaultWidth:"full"})},LC={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},zC={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},FC=(s,r,a,o)=>r.getHours()!==1?zC[s]:LC[s],HC={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},WC={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},BC={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},UC={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},qC={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},VC={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},YC=(s,r)=>Number(s)+"º",GC={ordinalNumber:YC,era:zr({values:HC,defaultWidth:"wide"}),quarter:zr({values:WC,defaultWidth:"wide",argumentCallback:s=>Number(s)-1}),month:zr({values:BC,defaultWidth:"wide"}),day:zr({values:UC,defaultWidth:"wide"}),dayPeriod:zr({values:qC,defaultWidth:"wide",formattingValues:VC,defaultFormattingWidth:"wide"})},KC=/^(\d+)(º)?/i,JC=/\d+/i,XC={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},ZC={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},QC={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},e2={any:[/1/i,/2/i,/3/i,/4/i]},t2={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},s2={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},a2={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},n2={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},r2={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},o2={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},i2={ordinalNumber:c1({matchPattern:KC,parsePattern:JC,valueCallback:function(s){return parseInt(s,10)}}),era:Fr({matchPatterns:XC,defaultMatchWidth:"wide",parsePatterns:ZC,defaultParseWidth:"any"}),quarter:Fr({matchPatterns:QC,defaultMatchWidth:"wide",parsePatterns:e2,defaultParseWidth:"any",valueCallback:s=>s+1}),month:Fr({matchPatterns:t2,defaultMatchWidth:"wide",parsePatterns:s2,defaultParseWidth:"any"}),day:Fr({matchPatterns:a2,defaultMatchWidth:"wide",parsePatterns:n2,defaultParseWidth:"any"}),dayPeriod:Fr({matchPatterns:r2,defaultMatchWidth:"any",parsePatterns:o2,defaultParseWidth:"any"})},Qs={code:"es",formatDistance:PC,formatLong:$C,formatRelative:FC,localize:GC,match:i2,options:{weekStartsOn:1,firstWeekContainsDate:1}},pe=(s=new Date)=>{const r=new Date(s.getTime());return r.setHours(0,0,0,0),r.toISOString().split("T")[0]},Dn=s=>{const r=new Date(s);return r.setHours(12,0,0,0),r},id=s=>{const r=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],a=s.getDate(),o=r[s.getMonth()],i=s.getFullYear();let d=s.getHours();const l=s.getMinutes().toString().padStart(2,"0"),u=s.getSeconds().toString().padStart(2,"0"),m=d>=12?"p.m.":"a.m.";d=d%12,d=d||12;const h=-s.getTimezoneOffset(),x=Math.abs(Math.floor(h/60)),p=h>=0?"+":"-";return`${a} de ${o} de ${i}, ${d}:${l}:${u} ${m} UTC${p}${x}`},Kt=(s,r,a)=>{const o=new Date(s);return o.setHours(r,a,0,0),{timestamp:o.getTime(),utcOffset:-o.getTimezoneOffset(),formatted:id(o)}},l2=(s=new Date,r="daily",a=1)=>{const o=yt(s);switch(r){case"daily":return gt(o,1);case"weekly":return Vr(o,1);case"monthly":return sa(o,1);case"custom":return gt(o,a);default:return o}},xp=(s,r,a)=>{const o=vt(s,"'próximo' EEEE",{locale:Qs});switch(r){case"daily":return`Diariamente (${o})`;case"weekly":return`Semanalmente (${o})`;case"monthly":return`Mensualmente (${vt(s,"'próximo' d 'de' MMMM",{locale:Qs})})`;case"custom":return`Cada ${a} día${a!==1?"s":""} (${o})`;default:return""}},Hc=s=>{const r=s.getTimezoneOffset();return new Date(s.getTime()-r*60*1e3).toISOString().split("T")[0]},c2=s=>vt(s,"EEEE, d 'de' MMMM 'de' yyyy",{locale:Qs}),d2=s=>Array.from({length:12},(r,a)=>({name:new Date(s,a).toLocaleString("es",{month:"short"}),days:new Date(s,a+1,0).getDate(),number:a+1}));var bi={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */bi.exports;(function(s,r){(function(){var a,o="4.17.21",i=200,d="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",u="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",h=500,x="__lodash_placeholder__",p=1,g=2,v=4,j=1,b=2,N=1,C=2,S=4,_=8,A=16,k=32,D=64,P=128,M=256,$=512,W=30,I="...",B=800,H=16,U=1,ee=2,re=3,J=1/0,te=9007199254740991,me=17976931348623157e292,Ce=NaN,_e=4294967295,Ee=_e-1,Ne=_e>>>1,V=[["ary",P],["bind",N],["bindKey",C],["curry",_],["curryRight",A],["flip",$],["partial",k],["partialRight",D],["rearg",M]],ie="[object Arguments]",at="[object Array]",qe="[object AsyncFunction]",is="[object Boolean]",Ut="[object Date]",zs="[object DOMException]",Pt="[object Error]",Ns="[object Function]",de="[object GeneratorFunction]",ye="[object Map]",Mt="[object Number]",Fs="[object Null]",Rt="[object Object]",Hs="[object Promise]",zn="[object Proxy]",Ws="[object RegExp]",Dt="[object Set]",Fa="[object String]",ws="[object Symbol]",ol="[object Undefined]",hn="[object WeakMap]",Xt="[object WeakSet]",Ss="[object ArrayBuffer]",Ha="[object DataView]",jr="[object Float32Array]",Wa="[object Float64Array]",br="[object Int8Array]",Fn="[object Int16Array]",pn="[object Int32Array]",ia="[object Uint8Array]",Hn="[object Uint8ClampedArray]",la="[object Uint16Array]",Nr="[object Uint32Array]",il=/\b__p \+= '';/g,yo=/\b(__p \+=) '' \+/g,jo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bo=/&(?:amp|lt|gt|quot|#39);/g,Wn=/[&<>"']/g,ca=RegExp(bo.source),ll=RegExp(Wn.source),je=/<%-([\s\S]+?)%>/g,Ve=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,ls=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cs=/^\w*$/,da=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bs=/[\\^$.*+?()[\]{}|]/g,ds=RegExp(Bs.source),Cs=/^\s+/,ug=/\s/,mg=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,fg=/\{\n\/\* \[wrapped with (.+)\] \*/,hg=/,? & /,pg=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,xg=/[()=,{}\[\]\/\s]/,gg=/\\(\\)?/g,vg=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Fd=/\w*$/,yg=/^[-+]0x[0-9a-f]+$/i,jg=/^0b[01]+$/i,bg=/^\[object .+?Constructor\]$/,Ng=/^0o[0-7]+$/i,wg=/^(?:0|[1-9]\d*)$/,Sg=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,No=/($^)/,Cg=/['\n\r\u2028\u2029\\]/g,wo="\\ud800-\\udfff",Eg="\\u0300-\\u036f",Dg="\\ufe20-\\ufe2f",Tg="\\u20d0-\\u20ff",Hd=Eg+Dg+Tg,Wd="\\u2700-\\u27bf",Bd="a-z\\xdf-\\xf6\\xf8-\\xff",_g="\\xac\\xb1\\xd7\\xf7",Ag="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",kg="\\u2000-\\u206f",Og=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ud="A-Z\\xc0-\\xd6\\xd8-\\xde",qd="\\ufe0e\\ufe0f",Vd=_g+Ag+kg+Og,cl="['’]",Pg="["+wo+"]",Yd="["+Vd+"]",So="["+Hd+"]",Gd="\\d+",Mg="["+Wd+"]",Kd="["+Bd+"]",Jd="[^"+wo+Vd+Gd+Wd+Bd+Ud+"]",dl="\\ud83c[\\udffb-\\udfff]",Rg="(?:"+So+"|"+dl+")",Xd="[^"+wo+"]",ul="(?:\\ud83c[\\udde6-\\uddff]){2}",ml="[\\ud800-\\udbff][\\udc00-\\udfff]",Bn="["+Ud+"]",Zd="\\u200d",Qd="(?:"+Kd+"|"+Jd+")",Ig="(?:"+Bn+"|"+Jd+")",eu="(?:"+cl+"(?:d|ll|m|re|s|t|ve))?",tu="(?:"+cl+"(?:D|LL|M|RE|S|T|VE))?",su=Rg+"?",au="["+qd+"]?",$g="(?:"+Zd+"(?:"+[Xd,ul,ml].join("|")+")"+au+su+")*",Lg="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",zg="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",nu=au+su+$g,Fg="(?:"+[Mg,ul,ml].join("|")+")"+nu,Hg="(?:"+[Xd+So+"?",So,ul,ml,Pg].join("|")+")",Wg=RegExp(cl,"g"),Bg=RegExp(So,"g"),fl=RegExp(dl+"(?="+dl+")|"+Hg+nu,"g"),Ug=RegExp([Bn+"?"+Kd+"+"+eu+"(?="+[Yd,Bn,"$"].join("|")+")",Ig+"+"+tu+"(?="+[Yd,Bn+Qd,"$"].join("|")+")",Bn+"?"+Qd+"+"+eu,Bn+"+"+tu,zg,Lg,Gd,Fg].join("|"),"g"),qg=RegExp("["+Zd+wo+Hd+qd+"]"),Vg=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Yg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Gg=-1,dt={};dt[jr]=dt[Wa]=dt[br]=dt[Fn]=dt[pn]=dt[ia]=dt[Hn]=dt[la]=dt[Nr]=!0,dt[ie]=dt[at]=dt[Ss]=dt[is]=dt[Ha]=dt[Ut]=dt[Pt]=dt[Ns]=dt[ye]=dt[Mt]=dt[Rt]=dt[Ws]=dt[Dt]=dt[Fa]=dt[hn]=!1;var lt={};lt[ie]=lt[at]=lt[Ss]=lt[Ha]=lt[is]=lt[Ut]=lt[jr]=lt[Wa]=lt[br]=lt[Fn]=lt[pn]=lt[ye]=lt[Mt]=lt[Rt]=lt[Ws]=lt[Dt]=lt[Fa]=lt[ws]=lt[ia]=lt[Hn]=lt[la]=lt[Nr]=!0,lt[Pt]=lt[Ns]=lt[hn]=!1;var Kg={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Jg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Xg={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Zg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Qg=parseFloat,ev=parseInt,ru=typeof Lr=="object"&&Lr&&Lr.Object===Object&&Lr,tv=typeof self=="object"&&self&&self.Object===Object&&self,Tt=ru||tv||Function("return this")(),hl=r&&!r.nodeType&&r,xn=hl&&!0&&s&&!s.nodeType&&s,ou=xn&&xn.exports===hl,pl=ou&&ru.process,Es=function(){try{var L=xn&&xn.require&&xn.require("util").types;return L||pl&&pl.binding&&pl.binding("util")}catch{}}(),iu=Es&&Es.isArrayBuffer,lu=Es&&Es.isDate,cu=Es&&Es.isMap,du=Es&&Es.isRegExp,uu=Es&&Es.isSet,mu=Es&&Es.isTypedArray;function us(L,Y,q){switch(q.length){case 0:return L.call(Y);case 1:return L.call(Y,q[0]);case 2:return L.call(Y,q[0],q[1]);case 3:return L.call(Y,q[0],q[1],q[2])}return L.apply(Y,q)}function sv(L,Y,q,ce){for(var be=-1,We=L==null?0:L.length;++be<We;){var Nt=L[be];Y(ce,Nt,q(Nt),L)}return ce}function Ds(L,Y){for(var q=-1,ce=L==null?0:L.length;++q<ce&&Y(L[q],q,L)!==!1;);return L}function av(L,Y){for(var q=L==null?0:L.length;q--&&Y(L[q],q,L)!==!1;);return L}function fu(L,Y){for(var q=-1,ce=L==null?0:L.length;++q<ce;)if(!Y(L[q],q,L))return!1;return!0}function Ba(L,Y){for(var q=-1,ce=L==null?0:L.length,be=0,We=[];++q<ce;){var Nt=L[q];Y(Nt,q,L)&&(We[be++]=Nt)}return We}function Co(L,Y){var q=L==null?0:L.length;return!!q&&Un(L,Y,0)>-1}function xl(L,Y,q){for(var ce=-1,be=L==null?0:L.length;++ce<be;)if(q(Y,L[ce]))return!0;return!1}function ut(L,Y){for(var q=-1,ce=L==null?0:L.length,be=Array(ce);++q<ce;)be[q]=Y(L[q],q,L);return be}function Ua(L,Y){for(var q=-1,ce=Y.length,be=L.length;++q<ce;)L[be+q]=Y[q];return L}function gl(L,Y,q,ce){var be=-1,We=L==null?0:L.length;for(ce&&We&&(q=L[++be]);++be<We;)q=Y(q,L[be],be,L);return q}function nv(L,Y,q,ce){var be=L==null?0:L.length;for(ce&&be&&(q=L[--be]);be--;)q=Y(q,L[be],be,L);return q}function vl(L,Y){for(var q=-1,ce=L==null?0:L.length;++q<ce;)if(Y(L[q],q,L))return!0;return!1}var rv=yl("length");function ov(L){return L.split("")}function iv(L){return L.match(pg)||[]}function hu(L,Y,q){var ce;return q(L,function(be,We,Nt){if(Y(be,We,Nt))return ce=We,!1}),ce}function Eo(L,Y,q,ce){for(var be=L.length,We=q+(ce?1:-1);ce?We--:++We<be;)if(Y(L[We],We,L))return We;return-1}function Un(L,Y,q){return Y===Y?yv(L,Y,q):Eo(L,pu,q)}function lv(L,Y,q,ce){for(var be=q-1,We=L.length;++be<We;)if(ce(L[be],Y))return be;return-1}function pu(L){return L!==L}function xu(L,Y){var q=L==null?0:L.length;return q?bl(L,Y)/q:Ce}function yl(L){return function(Y){return Y==null?a:Y[L]}}function jl(L){return function(Y){return L==null?a:L[Y]}}function gu(L,Y,q,ce,be){return be(L,function(We,Nt,it){q=ce?(ce=!1,We):Y(q,We,Nt,it)}),q}function cv(L,Y){var q=L.length;for(L.sort(Y);q--;)L[q]=L[q].value;return L}function bl(L,Y){for(var q,ce=-1,be=L.length;++ce<be;){var We=Y(L[ce]);We!==a&&(q=q===a?We:q+We)}return q}function Nl(L,Y){for(var q=-1,ce=Array(L);++q<L;)ce[q]=Y(q);return ce}function dv(L,Y){return ut(Y,function(q){return[q,L[q]]})}function vu(L){return L&&L.slice(0,Nu(L)+1).replace(Cs,"")}function ms(L){return function(Y){return L(Y)}}function wl(L,Y){return ut(Y,function(q){return L[q]})}function wr(L,Y){return L.has(Y)}function yu(L,Y){for(var q=-1,ce=L.length;++q<ce&&Un(Y,L[q],0)>-1;);return q}function ju(L,Y){for(var q=L.length;q--&&Un(Y,L[q],0)>-1;);return q}function uv(L,Y){for(var q=L.length,ce=0;q--;)L[q]===Y&&++ce;return ce}var mv=jl(Kg),fv=jl(Jg);function hv(L){return"\\"+Zg[L]}function pv(L,Y){return L==null?a:L[Y]}function qn(L){return qg.test(L)}function xv(L){return Vg.test(L)}function gv(L){for(var Y,q=[];!(Y=L.next()).done;)q.push(Y.value);return q}function Sl(L){var Y=-1,q=Array(L.size);return L.forEach(function(ce,be){q[++Y]=[be,ce]}),q}function bu(L,Y){return function(q){return L(Y(q))}}function qa(L,Y){for(var q=-1,ce=L.length,be=0,We=[];++q<ce;){var Nt=L[q];(Nt===Y||Nt===x)&&(L[q]=x,We[be++]=q)}return We}function Do(L){var Y=-1,q=Array(L.size);return L.forEach(function(ce){q[++Y]=ce}),q}function vv(L){var Y=-1,q=Array(L.size);return L.forEach(function(ce){q[++Y]=[ce,ce]}),q}function yv(L,Y,q){for(var ce=q-1,be=L.length;++ce<be;)if(L[ce]===Y)return ce;return-1}function jv(L,Y,q){for(var ce=q+1;ce--;)if(L[ce]===Y)return ce;return ce}function Vn(L){return qn(L)?Nv(L):rv(L)}function Us(L){return qn(L)?wv(L):ov(L)}function Nu(L){for(var Y=L.length;Y--&&ug.test(L.charAt(Y)););return Y}var bv=jl(Xg);function Nv(L){for(var Y=fl.lastIndex=0;fl.test(L);)++Y;return Y}function wv(L){return L.match(fl)||[]}function Sv(L){return L.match(Ug)||[]}var Cv=function L(Y){Y=Y==null?Tt:Yn.defaults(Tt.Object(),Y,Yn.pick(Tt,Yg));var q=Y.Array,ce=Y.Date,be=Y.Error,We=Y.Function,Nt=Y.Math,it=Y.Object,Cl=Y.RegExp,Ev=Y.String,Ts=Y.TypeError,To=q.prototype,Dv=We.prototype,Gn=it.prototype,_o=Y["__core-js_shared__"],Ao=Dv.toString,Ze=Gn.hasOwnProperty,Tv=0,wu=function(){var t=/[^.]+$/.exec(_o&&_o.keys&&_o.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),ko=Gn.toString,_v=Ao.call(it),Av=Tt._,kv=Cl("^"+Ao.call(Ze).replace(Bs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Oo=ou?Y.Buffer:a,Va=Y.Symbol,Po=Y.Uint8Array,Su=Oo?Oo.allocUnsafe:a,Mo=bu(it.getPrototypeOf,it),Cu=it.create,Eu=Gn.propertyIsEnumerable,Ro=To.splice,Du=Va?Va.isConcatSpreadable:a,Sr=Va?Va.iterator:a,gn=Va?Va.toStringTag:a,Io=function(){try{var t=Nn(it,"defineProperty");return t({},"",{}),t}catch{}}(),Ov=Y.clearTimeout!==Tt.clearTimeout&&Y.clearTimeout,Pv=ce&&ce.now!==Tt.Date.now&&ce.now,Mv=Y.setTimeout!==Tt.setTimeout&&Y.setTimeout,$o=Nt.ceil,Lo=Nt.floor,El=it.getOwnPropertySymbols,Rv=Oo?Oo.isBuffer:a,Tu=Y.isFinite,Iv=To.join,$v=bu(it.keys,it),wt=Nt.max,It=Nt.min,Lv=ce.now,zv=Y.parseInt,_u=Nt.random,Fv=To.reverse,Dl=Nn(Y,"DataView"),Cr=Nn(Y,"Map"),Tl=Nn(Y,"Promise"),Kn=Nn(Y,"Set"),Er=Nn(Y,"WeakMap"),Dr=Nn(it,"create"),zo=Er&&new Er,Jn={},Hv=wn(Dl),Wv=wn(Cr),Bv=wn(Tl),Uv=wn(Kn),qv=wn(Er),Fo=Va?Va.prototype:a,Tr=Fo?Fo.valueOf:a,Au=Fo?Fo.toString:a;function E(t){if(ft(t)&&!we(t)&&!(t instanceof $e)){if(t instanceof _s)return t;if(Ze.call(t,"__wrapped__"))return km(t)}return new _s(t)}var Xn=function(){function t(){}return function(n){if(!mt(n))return{};if(Cu)return Cu(n);t.prototype=n;var c=new t;return t.prototype=a,c}}();function Ho(){}function _s(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=a}E.templateSettings={escape:je,evaluate:Ve,interpolate:ot,variable:"",imports:{_:E}},E.prototype=Ho.prototype,E.prototype.constructor=E,_s.prototype=Xn(Ho.prototype),_s.prototype.constructor=_s;function $e(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=_e,this.__views__=[]}function Vv(){var t=new $e(this.__wrapped__);return t.__actions__=Zt(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Zt(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Zt(this.__views__),t}function Yv(){if(this.__filtered__){var t=new $e(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Gv(){var t=this.__wrapped__.value(),n=this.__dir__,c=we(t),y=n<0,w=c?t.length:0,T=oy(0,w,this.__views__),O=T.start,R=T.end,z=R-O,G=y?R:O-1,K=this.__iteratees__,X=K.length,oe=0,fe=It(z,this.__takeCount__);if(!c||!y&&w==z&&fe==z)return em(t,this.__actions__);var xe=[];e:for(;z--&&oe<fe;){G+=n;for(var Te=-1,ge=t[G];++Te<X;){var Me=K[Te],Fe=Me.iteratee,ps=Me.type,Yt=Fe(ge);if(ps==ee)ge=Yt;else if(!Yt){if(ps==U)continue e;break e}}xe[oe++]=ge}return xe}$e.prototype=Xn(Ho.prototype),$e.prototype.constructor=$e;function vn(t){var n=-1,c=t==null?0:t.length;for(this.clear();++n<c;){var y=t[n];this.set(y[0],y[1])}}function Kv(){this.__data__=Dr?Dr(null):{},this.size=0}function Jv(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function Xv(t){var n=this.__data__;if(Dr){var c=n[t];return c===m?a:c}return Ze.call(n,t)?n[t]:a}function Zv(t){var n=this.__data__;return Dr?n[t]!==a:Ze.call(n,t)}function Qv(t,n){var c=this.__data__;return this.size+=this.has(t)?0:1,c[t]=Dr&&n===a?m:n,this}vn.prototype.clear=Kv,vn.prototype.delete=Jv,vn.prototype.get=Xv,vn.prototype.has=Zv,vn.prototype.set=Qv;function ya(t){var n=-1,c=t==null?0:t.length;for(this.clear();++n<c;){var y=t[n];this.set(y[0],y[1])}}function e0(){this.__data__=[],this.size=0}function t0(t){var n=this.__data__,c=Wo(n,t);if(c<0)return!1;var y=n.length-1;return c==y?n.pop():Ro.call(n,c,1),--this.size,!0}function s0(t){var n=this.__data__,c=Wo(n,t);return c<0?a:n[c][1]}function a0(t){return Wo(this.__data__,t)>-1}function n0(t,n){var c=this.__data__,y=Wo(c,t);return y<0?(++this.size,c.push([t,n])):c[y][1]=n,this}ya.prototype.clear=e0,ya.prototype.delete=t0,ya.prototype.get=s0,ya.prototype.has=a0,ya.prototype.set=n0;function ja(t){var n=-1,c=t==null?0:t.length;for(this.clear();++n<c;){var y=t[n];this.set(y[0],y[1])}}function r0(){this.size=0,this.__data__={hash:new vn,map:new(Cr||ya),string:new vn}}function o0(t){var n=ei(this,t).delete(t);return this.size-=n?1:0,n}function i0(t){return ei(this,t).get(t)}function l0(t){return ei(this,t).has(t)}function c0(t,n){var c=ei(this,t),y=c.size;return c.set(t,n),this.size+=c.size==y?0:1,this}ja.prototype.clear=r0,ja.prototype.delete=o0,ja.prototype.get=i0,ja.prototype.has=l0,ja.prototype.set=c0;function yn(t){var n=-1,c=t==null?0:t.length;for(this.__data__=new ja;++n<c;)this.add(t[n])}function d0(t){return this.__data__.set(t,m),this}function u0(t){return this.__data__.has(t)}yn.prototype.add=yn.prototype.push=d0,yn.prototype.has=u0;function qs(t){var n=this.__data__=new ya(t);this.size=n.size}function m0(){this.__data__=new ya,this.size=0}function f0(t){var n=this.__data__,c=n.delete(t);return this.size=n.size,c}function h0(t){return this.__data__.get(t)}function p0(t){return this.__data__.has(t)}function x0(t,n){var c=this.__data__;if(c instanceof ya){var y=c.__data__;if(!Cr||y.length<i-1)return y.push([t,n]),this.size=++c.size,this;c=this.__data__=new ja(y)}return c.set(t,n),this.size=c.size,this}qs.prototype.clear=m0,qs.prototype.delete=f0,qs.prototype.get=h0,qs.prototype.has=p0,qs.prototype.set=x0;function ku(t,n){var c=we(t),y=!c&&Sn(t),w=!c&&!y&&Xa(t),T=!c&&!y&&!w&&tr(t),O=c||y||w||T,R=O?Nl(t.length,Ev):[],z=R.length;for(var G in t)(n||Ze.call(t,G))&&!(O&&(G=="length"||w&&(G=="offset"||G=="parent")||T&&(G=="buffer"||G=="byteLength"||G=="byteOffset")||Sa(G,z)))&&R.push(G);return R}function Ou(t){var n=t.length;return n?t[zl(0,n-1)]:a}function g0(t,n){return ti(Zt(t),jn(n,0,t.length))}function v0(t){return ti(Zt(t))}function _l(t,n,c){(c!==a&&!Vs(t[n],c)||c===a&&!(n in t))&&ba(t,n,c)}function _r(t,n,c){var y=t[n];(!(Ze.call(t,n)&&Vs(y,c))||c===a&&!(n in t))&&ba(t,n,c)}function Wo(t,n){for(var c=t.length;c--;)if(Vs(t[c][0],n))return c;return-1}function y0(t,n,c,y){return Ya(t,function(w,T,O){n(y,w,c(w),O)}),y}function Pu(t,n){return t&&ma(n,St(n),t)}function j0(t,n){return t&&ma(n,es(n),t)}function ba(t,n,c){n=="__proto__"&&Io?Io(t,n,{configurable:!0,enumerable:!0,value:c,writable:!0}):t[n]=c}function Al(t,n){for(var c=-1,y=n.length,w=q(y),T=t==null;++c<y;)w[c]=T?a:dc(t,n[c]);return w}function jn(t,n,c){return t===t&&(c!==a&&(t=t<=c?t:c),n!==a&&(t=t>=n?t:n)),t}function As(t,n,c,y,w,T){var O,R=n&p,z=n&g,G=n&v;if(c&&(O=w?c(t,y,w,T):c(t)),O!==a)return O;if(!mt(t))return t;var K=we(t);if(K){if(O=ly(t),!R)return Zt(t,O)}else{var X=$t(t),oe=X==Ns||X==de;if(Xa(t))return am(t,R);if(X==Rt||X==ie||oe&&!w){if(O=z||oe?{}:Nm(t),!R)return z?X0(t,j0(O,t)):J0(t,Pu(O,t))}else{if(!lt[X])return w?t:{};O=cy(t,X,R)}}T||(T=new qs);var fe=T.get(t);if(fe)return fe;T.set(t,O),Xm(t)?t.forEach(function(ge){O.add(As(ge,n,c,ge,t,T))}):Km(t)&&t.forEach(function(ge,Me){O.set(Me,As(ge,n,c,Me,t,T))});var xe=G?z?Jl:Kl:z?es:St,Te=K?a:xe(t);return Ds(Te||t,function(ge,Me){Te&&(Me=ge,ge=t[Me]),_r(O,Me,As(ge,n,c,Me,t,T))}),O}function b0(t){var n=St(t);return function(c){return Mu(c,t,n)}}function Mu(t,n,c){var y=c.length;if(t==null)return!y;for(t=it(t);y--;){var w=c[y],T=n[w],O=t[w];if(O===a&&!(w in t)||!T(O))return!1}return!0}function Ru(t,n,c){if(typeof t!="function")throw new Ts(l);return Ir(function(){t.apply(a,c)},n)}function Ar(t,n,c,y){var w=-1,T=Co,O=!0,R=t.length,z=[],G=n.length;if(!R)return z;c&&(n=ut(n,ms(c))),y?(T=xl,O=!1):n.length>=i&&(T=wr,O=!1,n=new yn(n));e:for(;++w<R;){var K=t[w],X=c==null?K:c(K);if(K=y||K!==0?K:0,O&&X===X){for(var oe=G;oe--;)if(n[oe]===X)continue e;z.push(K)}else T(n,X,y)||z.push(K)}return z}var Ya=lm(ua),Iu=lm(Ol,!0);function N0(t,n){var c=!0;return Ya(t,function(y,w,T){return c=!!n(y,w,T),c}),c}function Bo(t,n,c){for(var y=-1,w=t.length;++y<w;){var T=t[y],O=n(T);if(O!=null&&(R===a?O===O&&!hs(O):c(O,R)))var R=O,z=T}return z}function w0(t,n,c,y){var w=t.length;for(c=De(c),c<0&&(c=-c>w?0:w+c),y=y===a||y>w?w:De(y),y<0&&(y+=w),y=c>y?0:Qm(y);c<y;)t[c++]=n;return t}function $u(t,n){var c=[];return Ya(t,function(y,w,T){n(y,w,T)&&c.push(y)}),c}function _t(t,n,c,y,w){var T=-1,O=t.length;for(c||(c=uy),w||(w=[]);++T<O;){var R=t[T];n>0&&c(R)?n>1?_t(R,n-1,c,y,w):Ua(w,R):y||(w[w.length]=R)}return w}var kl=cm(),Lu=cm(!0);function ua(t,n){return t&&kl(t,n,St)}function Ol(t,n){return t&&Lu(t,n,St)}function Uo(t,n){return Ba(n,function(c){return Ca(t[c])})}function bn(t,n){n=Ka(n,t);for(var c=0,y=n.length;t!=null&&c<y;)t=t[fa(n[c++])];return c&&c==y?t:a}function zu(t,n,c){var y=n(t);return we(t)?y:Ua(y,c(t))}function qt(t){return t==null?t===a?ol:Fs:gn&&gn in it(t)?ry(t):vy(t)}function Pl(t,n){return t>n}function S0(t,n){return t!=null&&Ze.call(t,n)}function C0(t,n){return t!=null&&n in it(t)}function E0(t,n,c){return t>=It(n,c)&&t<wt(n,c)}function Ml(t,n,c){for(var y=c?xl:Co,w=t[0].length,T=t.length,O=T,R=q(T),z=1/0,G=[];O--;){var K=t[O];O&&n&&(K=ut(K,ms(n))),z=It(K.length,z),R[O]=!c&&(n||w>=120&&K.length>=120)?new yn(O&&K):a}K=t[0];var X=-1,oe=R[0];e:for(;++X<w&&G.length<z;){var fe=K[X],xe=n?n(fe):fe;if(fe=c||fe!==0?fe:0,!(oe?wr(oe,xe):y(G,xe,c))){for(O=T;--O;){var Te=R[O];if(!(Te?wr(Te,xe):y(t[O],xe,c)))continue e}oe&&oe.push(xe),G.push(fe)}}return G}function D0(t,n,c,y){return ua(t,function(w,T,O){n(y,c(w),T,O)}),y}function kr(t,n,c){n=Ka(n,t),t=Em(t,n);var y=t==null?t:t[fa(Os(n))];return y==null?a:us(y,t,c)}function Fu(t){return ft(t)&&qt(t)==ie}function T0(t){return ft(t)&&qt(t)==Ss}function _0(t){return ft(t)&&qt(t)==Ut}function Or(t,n,c,y,w){return t===n?!0:t==null||n==null||!ft(t)&&!ft(n)?t!==t&&n!==n:A0(t,n,c,y,Or,w)}function A0(t,n,c,y,w,T){var O=we(t),R=we(n),z=O?at:$t(t),G=R?at:$t(n);z=z==ie?Rt:z,G=G==ie?Rt:G;var K=z==Rt,X=G==Rt,oe=z==G;if(oe&&Xa(t)){if(!Xa(n))return!1;O=!0,K=!1}if(oe&&!K)return T||(T=new qs),O||tr(t)?ym(t,n,c,y,w,T):ay(t,n,z,c,y,w,T);if(!(c&j)){var fe=K&&Ze.call(t,"__wrapped__"),xe=X&&Ze.call(n,"__wrapped__");if(fe||xe){var Te=fe?t.value():t,ge=xe?n.value():n;return T||(T=new qs),w(Te,ge,c,y,T)}}return oe?(T||(T=new qs),ny(t,n,c,y,w,T)):!1}function k0(t){return ft(t)&&$t(t)==ye}function Rl(t,n,c,y){var w=c.length,T=w,O=!y;if(t==null)return!T;for(t=it(t);w--;){var R=c[w];if(O&&R[2]?R[1]!==t[R[0]]:!(R[0]in t))return!1}for(;++w<T;){R=c[w];var z=R[0],G=t[z],K=R[1];if(O&&R[2]){if(G===a&&!(z in t))return!1}else{var X=new qs;if(y)var oe=y(G,K,z,t,n,X);if(!(oe===a?Or(K,G,j|b,y,X):oe))return!1}}return!0}function Hu(t){if(!mt(t)||fy(t))return!1;var n=Ca(t)?kv:bg;return n.test(wn(t))}function O0(t){return ft(t)&&qt(t)==Ws}function P0(t){return ft(t)&&$t(t)==Dt}function M0(t){return ft(t)&&ii(t.length)&&!!dt[qt(t)]}function Wu(t){return typeof t=="function"?t:t==null?ts:typeof t=="object"?we(t)?qu(t[0],t[1]):Uu(t):uf(t)}function Il(t){if(!Rr(t))return $v(t);var n=[];for(var c in it(t))Ze.call(t,c)&&c!="constructor"&&n.push(c);return n}function R0(t){if(!mt(t))return gy(t);var n=Rr(t),c=[];for(var y in t)y=="constructor"&&(n||!Ze.call(t,y))||c.push(y);return c}function $l(t,n){return t<n}function Bu(t,n){var c=-1,y=Qt(t)?q(t.length):[];return Ya(t,function(w,T,O){y[++c]=n(w,T,O)}),y}function Uu(t){var n=Zl(t);return n.length==1&&n[0][2]?Sm(n[0][0],n[0][1]):function(c){return c===t||Rl(c,t,n)}}function qu(t,n){return ec(t)&&wm(n)?Sm(fa(t),n):function(c){var y=dc(c,t);return y===a&&y===n?uc(c,t):Or(n,y,j|b)}}function qo(t,n,c,y,w){t!==n&&kl(n,function(T,O){if(w||(w=new qs),mt(T))I0(t,n,O,c,qo,y,w);else{var R=y?y(sc(t,O),T,O+"",t,n,w):a;R===a&&(R=T),_l(t,O,R)}},es)}function I0(t,n,c,y,w,T,O){var R=sc(t,c),z=sc(n,c),G=O.get(z);if(G){_l(t,c,G);return}var K=T?T(R,z,c+"",t,n,O):a,X=K===a;if(X){var oe=we(z),fe=!oe&&Xa(z),xe=!oe&&!fe&&tr(z);K=z,oe||fe||xe?we(R)?K=R:pt(R)?K=Zt(R):fe?(X=!1,K=am(z,!0)):xe?(X=!1,K=nm(z,!0)):K=[]:$r(z)||Sn(z)?(K=R,Sn(R)?K=ef(R):(!mt(R)||Ca(R))&&(K=Nm(z))):X=!1}X&&(O.set(z,K),w(K,z,y,T,O),O.delete(z)),_l(t,c,K)}function Vu(t,n){var c=t.length;if(c)return n+=n<0?c:0,Sa(n,c)?t[n]:a}function Yu(t,n,c){n.length?n=ut(n,function(T){return we(T)?function(O){return bn(O,T.length===1?T[0]:T)}:T}):n=[ts];var y=-1;n=ut(n,ms(he()));var w=Bu(t,function(T,O,R){var z=ut(n,function(G){return G(T)});return{criteria:z,index:++y,value:T}});return cv(w,function(T,O){return K0(T,O,c)})}function $0(t,n){return Gu(t,n,function(c,y){return uc(t,y)})}function Gu(t,n,c){for(var y=-1,w=n.length,T={};++y<w;){var O=n[y],R=bn(t,O);c(R,O)&&Pr(T,Ka(O,t),R)}return T}function L0(t){return function(n){return bn(n,t)}}function Ll(t,n,c,y){var w=y?lv:Un,T=-1,O=n.length,R=t;for(t===n&&(n=Zt(n)),c&&(R=ut(t,ms(c)));++T<O;)for(var z=0,G=n[T],K=c?c(G):G;(z=w(R,K,z,y))>-1;)R!==t&&Ro.call(R,z,1),Ro.call(t,z,1);return t}function Ku(t,n){for(var c=t?n.length:0,y=c-1;c--;){var w=n[c];if(c==y||w!==T){var T=w;Sa(w)?Ro.call(t,w,1):Wl(t,w)}}return t}function zl(t,n){return t+Lo(_u()*(n-t+1))}function z0(t,n,c,y){for(var w=-1,T=wt($o((n-t)/(c||1)),0),O=q(T);T--;)O[y?T:++w]=t,t+=c;return O}function Fl(t,n){var c="";if(!t||n<1||n>te)return c;do n%2&&(c+=t),n=Lo(n/2),n&&(t+=t);while(n);return c}function Ae(t,n){return ac(Cm(t,n,ts),t+"")}function F0(t){return Ou(sr(t))}function H0(t,n){var c=sr(t);return ti(c,jn(n,0,c.length))}function Pr(t,n,c,y){if(!mt(t))return t;n=Ka(n,t);for(var w=-1,T=n.length,O=T-1,R=t;R!=null&&++w<T;){var z=fa(n[w]),G=c;if(z==="__proto__"||z==="constructor"||z==="prototype")return t;if(w!=O){var K=R[z];G=y?y(K,z,R):a,G===a&&(G=mt(K)?K:Sa(n[w+1])?[]:{})}_r(R,z,G),R=R[z]}return t}var Ju=zo?function(t,n){return zo.set(t,n),t}:ts,W0=Io?function(t,n){return Io(t,"toString",{configurable:!0,enumerable:!1,value:fc(n),writable:!0})}:ts;function B0(t){return ti(sr(t))}function ks(t,n,c){var y=-1,w=t.length;n<0&&(n=-n>w?0:w+n),c=c>w?w:c,c<0&&(c+=w),w=n>c?0:c-n>>>0,n>>>=0;for(var T=q(w);++y<w;)T[y]=t[y+n];return T}function U0(t,n){var c;return Ya(t,function(y,w,T){return c=n(y,w,T),!c}),!!c}function Vo(t,n,c){var y=0,w=t==null?y:t.length;if(typeof n=="number"&&n===n&&w<=Ne){for(;y<w;){var T=y+w>>>1,O=t[T];O!==null&&!hs(O)&&(c?O<=n:O<n)?y=T+1:w=T}return w}return Hl(t,n,ts,c)}function Hl(t,n,c,y){var w=0,T=t==null?0:t.length;if(T===0)return 0;n=c(n);for(var O=n!==n,R=n===null,z=hs(n),G=n===a;w<T;){var K=Lo((w+T)/2),X=c(t[K]),oe=X!==a,fe=X===null,xe=X===X,Te=hs(X);if(O)var ge=y||xe;else G?ge=xe&&(y||oe):R?ge=xe&&oe&&(y||!fe):z?ge=xe&&oe&&!fe&&(y||!Te):fe||Te?ge=!1:ge=y?X<=n:X<n;ge?w=K+1:T=K}return It(T,Ee)}function Xu(t,n){for(var c=-1,y=t.length,w=0,T=[];++c<y;){var O=t[c],R=n?n(O):O;if(!c||!Vs(R,z)){var z=R;T[w++]=O===0?0:O}}return T}function Zu(t){return typeof t=="number"?t:hs(t)?Ce:+t}function fs(t){if(typeof t=="string")return t;if(we(t))return ut(t,fs)+"";if(hs(t))return Au?Au.call(t):"";var n=t+"";return n=="0"&&1/t==-J?"-0":n}function Ga(t,n,c){var y=-1,w=Co,T=t.length,O=!0,R=[],z=R;if(c)O=!1,w=xl;else if(T>=i){var G=n?null:ty(t);if(G)return Do(G);O=!1,w=wr,z=new yn}else z=n?[]:R;e:for(;++y<T;){var K=t[y],X=n?n(K):K;if(K=c||K!==0?K:0,O&&X===X){for(var oe=z.length;oe--;)if(z[oe]===X)continue e;n&&z.push(X),R.push(K)}else w(z,X,c)||(z!==R&&z.push(X),R.push(K))}return R}function Wl(t,n){return n=Ka(n,t),t=Em(t,n),t==null||delete t[fa(Os(n))]}function Qu(t,n,c,y){return Pr(t,n,c(bn(t,n)),y)}function Yo(t,n,c,y){for(var w=t.length,T=y?w:-1;(y?T--:++T<w)&&n(t[T],T,t););return c?ks(t,y?0:T,y?T+1:w):ks(t,y?T+1:0,y?w:T)}function em(t,n){var c=t;return c instanceof $e&&(c=c.value()),gl(n,function(y,w){return w.func.apply(w.thisArg,Ua([y],w.args))},c)}function Bl(t,n,c){var y=t.length;if(y<2)return y?Ga(t[0]):[];for(var w=-1,T=q(y);++w<y;)for(var O=t[w],R=-1;++R<y;)R!=w&&(T[w]=Ar(T[w]||O,t[R],n,c));return Ga(_t(T,1),n,c)}function tm(t,n,c){for(var y=-1,w=t.length,T=n.length,O={};++y<w;){var R=y<T?n[y]:a;c(O,t[y],R)}return O}function Ul(t){return pt(t)?t:[]}function ql(t){return typeof t=="function"?t:ts}function Ka(t,n){return we(t)?t:ec(t,n)?[t]:Am(Ye(t))}var q0=Ae;function Ja(t,n,c){var y=t.length;return c=c===a?y:c,!n&&c>=y?t:ks(t,n,c)}var sm=Ov||function(t){return Tt.clearTimeout(t)};function am(t,n){if(n)return t.slice();var c=t.length,y=Su?Su(c):new t.constructor(c);return t.copy(y),y}function Vl(t){var n=new t.constructor(t.byteLength);return new Po(n).set(new Po(t)),n}function V0(t,n){var c=n?Vl(t.buffer):t.buffer;return new t.constructor(c,t.byteOffset,t.byteLength)}function Y0(t){var n=new t.constructor(t.source,Fd.exec(t));return n.lastIndex=t.lastIndex,n}function G0(t){return Tr?it(Tr.call(t)):{}}function nm(t,n){var c=n?Vl(t.buffer):t.buffer;return new t.constructor(c,t.byteOffset,t.length)}function rm(t,n){if(t!==n){var c=t!==a,y=t===null,w=t===t,T=hs(t),O=n!==a,R=n===null,z=n===n,G=hs(n);if(!R&&!G&&!T&&t>n||T&&O&&z&&!R&&!G||y&&O&&z||!c&&z||!w)return 1;if(!y&&!T&&!G&&t<n||G&&c&&w&&!y&&!T||R&&c&&w||!O&&w||!z)return-1}return 0}function K0(t,n,c){for(var y=-1,w=t.criteria,T=n.criteria,O=w.length,R=c.length;++y<O;){var z=rm(w[y],T[y]);if(z){if(y>=R)return z;var G=c[y];return z*(G=="desc"?-1:1)}}return t.index-n.index}function om(t,n,c,y){for(var w=-1,T=t.length,O=c.length,R=-1,z=n.length,G=wt(T-O,0),K=q(z+G),X=!y;++R<z;)K[R]=n[R];for(;++w<O;)(X||w<T)&&(K[c[w]]=t[w]);for(;G--;)K[R++]=t[w++];return K}function im(t,n,c,y){for(var w=-1,T=t.length,O=-1,R=c.length,z=-1,G=n.length,K=wt(T-R,0),X=q(K+G),oe=!y;++w<K;)X[w]=t[w];for(var fe=w;++z<G;)X[fe+z]=n[z];for(;++O<R;)(oe||w<T)&&(X[fe+c[O]]=t[w++]);return X}function Zt(t,n){var c=-1,y=t.length;for(n||(n=q(y));++c<y;)n[c]=t[c];return n}function ma(t,n,c,y){var w=!c;c||(c={});for(var T=-1,O=n.length;++T<O;){var R=n[T],z=y?y(c[R],t[R],R,c,t):a;z===a&&(z=t[R]),w?ba(c,R,z):_r(c,R,z)}return c}function J0(t,n){return ma(t,Ql(t),n)}function X0(t,n){return ma(t,jm(t),n)}function Go(t,n){return function(c,y){var w=we(c)?sv:y0,T=n?n():{};return w(c,t,he(y,2),T)}}function Zn(t){return Ae(function(n,c){var y=-1,w=c.length,T=w>1?c[w-1]:a,O=w>2?c[2]:a;for(T=t.length>3&&typeof T=="function"?(w--,T):a,O&&Vt(c[0],c[1],O)&&(T=w<3?a:T,w=1),n=it(n);++y<w;){var R=c[y];R&&t(n,R,y,T)}return n})}function lm(t,n){return function(c,y){if(c==null)return c;if(!Qt(c))return t(c,y);for(var w=c.length,T=n?w:-1,O=it(c);(n?T--:++T<w)&&y(O[T],T,O)!==!1;);return c}}function cm(t){return function(n,c,y){for(var w=-1,T=it(n),O=y(n),R=O.length;R--;){var z=O[t?R:++w];if(c(T[z],z,T)===!1)break}return n}}function Z0(t,n,c){var y=n&N,w=Mr(t);function T(){var O=this&&this!==Tt&&this instanceof T?w:t;return O.apply(y?c:this,arguments)}return T}function dm(t){return function(n){n=Ye(n);var c=qn(n)?Us(n):a,y=c?c[0]:n.charAt(0),w=c?Ja(c,1).join(""):n.slice(1);return y[t]()+w}}function Qn(t){return function(n){return gl(cf(lf(n).replace(Wg,"")),t,"")}}function Mr(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var c=Xn(t.prototype),y=t.apply(c,n);return mt(y)?y:c}}function Q0(t,n,c){var y=Mr(t);function w(){for(var T=arguments.length,O=q(T),R=T,z=er(w);R--;)O[R]=arguments[R];var G=T<3&&O[0]!==z&&O[T-1]!==z?[]:qa(O,z);if(T-=G.length,T<c)return pm(t,n,Ko,w.placeholder,a,O,G,a,a,c-T);var K=this&&this!==Tt&&this instanceof w?y:t;return us(K,this,O)}return w}function um(t){return function(n,c,y){var w=it(n);if(!Qt(n)){var T=he(c,3);n=St(n),c=function(R){return T(w[R],R,w)}}var O=t(n,c,y);return O>-1?w[T?n[O]:O]:a}}function mm(t){return wa(function(n){var c=n.length,y=c,w=_s.prototype.thru;for(t&&n.reverse();y--;){var T=n[y];if(typeof T!="function")throw new Ts(l);if(w&&!O&&Qo(T)=="wrapper")var O=new _s([],!0)}for(y=O?y:c;++y<c;){T=n[y];var R=Qo(T),z=R=="wrapper"?Xl(T):a;z&&tc(z[0])&&z[1]==(P|_|k|M)&&!z[4].length&&z[9]==1?O=O[Qo(z[0])].apply(O,z[3]):O=T.length==1&&tc(T)?O[R]():O.thru(T)}return function(){var G=arguments,K=G[0];if(O&&G.length==1&&we(K))return O.plant(K).value();for(var X=0,oe=c?n[X].apply(this,G):K;++X<c;)oe=n[X].call(this,oe);return oe}})}function Ko(t,n,c,y,w,T,O,R,z,G){var K=n&P,X=n&N,oe=n&C,fe=n&(_|A),xe=n&$,Te=oe?a:Mr(t);function ge(){for(var Me=arguments.length,Fe=q(Me),ps=Me;ps--;)Fe[ps]=arguments[ps];if(fe)var Yt=er(ge),xs=uv(Fe,Yt);if(y&&(Fe=om(Fe,y,w,fe)),T&&(Fe=im(Fe,T,O,fe)),Me-=xs,fe&&Me<G){var xt=qa(Fe,Yt);return pm(t,n,Ko,ge.placeholder,c,Fe,xt,R,z,G-Me)}var Ys=X?c:this,Da=oe?Ys[t]:t;return Me=Fe.length,R?Fe=yy(Fe,R):xe&&Me>1&&Fe.reverse(),K&&z<Me&&(Fe.length=z),this&&this!==Tt&&this instanceof ge&&(Da=Te||Mr(Da)),Da.apply(Ys,Fe)}return ge}function fm(t,n){return function(c,y){return D0(c,t,n(y),{})}}function Jo(t,n){return function(c,y){var w;if(c===a&&y===a)return n;if(c!==a&&(w=c),y!==a){if(w===a)return y;typeof c=="string"||typeof y=="string"?(c=fs(c),y=fs(y)):(c=Zu(c),y=Zu(y)),w=t(c,y)}return w}}function Yl(t){return wa(function(n){return n=ut(n,ms(he())),Ae(function(c){var y=this;return t(n,function(w){return us(w,y,c)})})})}function Xo(t,n){n=n===a?" ":fs(n);var c=n.length;if(c<2)return c?Fl(n,t):n;var y=Fl(n,$o(t/Vn(n)));return qn(n)?Ja(Us(y),0,t).join(""):y.slice(0,t)}function ey(t,n,c,y){var w=n&N,T=Mr(t);function O(){for(var R=-1,z=arguments.length,G=-1,K=y.length,X=q(K+z),oe=this&&this!==Tt&&this instanceof O?T:t;++G<K;)X[G]=y[G];for(;z--;)X[G++]=arguments[++R];return us(oe,w?c:this,X)}return O}function hm(t){return function(n,c,y){return y&&typeof y!="number"&&Vt(n,c,y)&&(c=y=a),n=Ea(n),c===a?(c=n,n=0):c=Ea(c),y=y===a?n<c?1:-1:Ea(y),z0(n,c,y,t)}}function Zo(t){return function(n,c){return typeof n=="string"&&typeof c=="string"||(n=Ps(n),c=Ps(c)),t(n,c)}}function pm(t,n,c,y,w,T,O,R,z,G){var K=n&_,X=K?O:a,oe=K?a:O,fe=K?T:a,xe=K?a:T;n|=K?k:D,n&=~(K?D:k),n&S||(n&=~(N|C));var Te=[t,n,w,fe,X,xe,oe,R,z,G],ge=c.apply(a,Te);return tc(t)&&Dm(ge,Te),ge.placeholder=y,Tm(ge,t,n)}function Gl(t){var n=Nt[t];return function(c,y){if(c=Ps(c),y=y==null?0:It(De(y),292),y&&Tu(c)){var w=(Ye(c)+"e").split("e"),T=n(w[0]+"e"+(+w[1]+y));return w=(Ye(T)+"e").split("e"),+(w[0]+"e"+(+w[1]-y))}return n(c)}}var ty=Kn&&1/Do(new Kn([,-0]))[1]==J?function(t){return new Kn(t)}:xc;function xm(t){return function(n){var c=$t(n);return c==ye?Sl(n):c==Dt?vv(n):dv(n,t(n))}}function Na(t,n,c,y,w,T,O,R){var z=n&C;if(!z&&typeof t!="function")throw new Ts(l);var G=y?y.length:0;if(G||(n&=~(k|D),y=w=a),O=O===a?O:wt(De(O),0),R=R===a?R:De(R),G-=w?w.length:0,n&D){var K=y,X=w;y=w=a}var oe=z?a:Xl(t),fe=[t,n,c,y,w,K,X,T,O,R];if(oe&&xy(fe,oe),t=fe[0],n=fe[1],c=fe[2],y=fe[3],w=fe[4],R=fe[9]=fe[9]===a?z?0:t.length:wt(fe[9]-G,0),!R&&n&(_|A)&&(n&=~(_|A)),!n||n==N)var xe=Z0(t,n,c);else n==_||n==A?xe=Q0(t,n,R):(n==k||n==(N|k))&&!w.length?xe=ey(t,n,c,y):xe=Ko.apply(a,fe);var Te=oe?Ju:Dm;return Tm(Te(xe,fe),t,n)}function gm(t,n,c,y){return t===a||Vs(t,Gn[c])&&!Ze.call(y,c)?n:t}function vm(t,n,c,y,w,T){return mt(t)&&mt(n)&&(T.set(n,t),qo(t,n,a,vm,T),T.delete(n)),t}function sy(t){return $r(t)?a:t}function ym(t,n,c,y,w,T){var O=c&j,R=t.length,z=n.length;if(R!=z&&!(O&&z>R))return!1;var G=T.get(t),K=T.get(n);if(G&&K)return G==n&&K==t;var X=-1,oe=!0,fe=c&b?new yn:a;for(T.set(t,n),T.set(n,t);++X<R;){var xe=t[X],Te=n[X];if(y)var ge=O?y(Te,xe,X,n,t,T):y(xe,Te,X,t,n,T);if(ge!==a){if(ge)continue;oe=!1;break}if(fe){if(!vl(n,function(Me,Fe){if(!wr(fe,Fe)&&(xe===Me||w(xe,Me,c,y,T)))return fe.push(Fe)})){oe=!1;break}}else if(!(xe===Te||w(xe,Te,c,y,T))){oe=!1;break}}return T.delete(t),T.delete(n),oe}function ay(t,n,c,y,w,T,O){switch(c){case Ha:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case Ss:return!(t.byteLength!=n.byteLength||!T(new Po(t),new Po(n)));case is:case Ut:case Mt:return Vs(+t,+n);case Pt:return t.name==n.name&&t.message==n.message;case Ws:case Fa:return t==n+"";case ye:var R=Sl;case Dt:var z=y&j;if(R||(R=Do),t.size!=n.size&&!z)return!1;var G=O.get(t);if(G)return G==n;y|=b,O.set(t,n);var K=ym(R(t),R(n),y,w,T,O);return O.delete(t),K;case ws:if(Tr)return Tr.call(t)==Tr.call(n)}return!1}function ny(t,n,c,y,w,T){var O=c&j,R=Kl(t),z=R.length,G=Kl(n),K=G.length;if(z!=K&&!O)return!1;for(var X=z;X--;){var oe=R[X];if(!(O?oe in n:Ze.call(n,oe)))return!1}var fe=T.get(t),xe=T.get(n);if(fe&&xe)return fe==n&&xe==t;var Te=!0;T.set(t,n),T.set(n,t);for(var ge=O;++X<z;){oe=R[X];var Me=t[oe],Fe=n[oe];if(y)var ps=O?y(Fe,Me,oe,n,t,T):y(Me,Fe,oe,t,n,T);if(!(ps===a?Me===Fe||w(Me,Fe,c,y,T):ps)){Te=!1;break}ge||(ge=oe=="constructor")}if(Te&&!ge){var Yt=t.constructor,xs=n.constructor;Yt!=xs&&"constructor"in t&&"constructor"in n&&!(typeof Yt=="function"&&Yt instanceof Yt&&typeof xs=="function"&&xs instanceof xs)&&(Te=!1)}return T.delete(t),T.delete(n),Te}function wa(t){return ac(Cm(t,a,Mm),t+"")}function Kl(t){return zu(t,St,Ql)}function Jl(t){return zu(t,es,jm)}var Xl=zo?function(t){return zo.get(t)}:xc;function Qo(t){for(var n=t.name+"",c=Jn[n],y=Ze.call(Jn,n)?c.length:0;y--;){var w=c[y],T=w.func;if(T==null||T==t)return w.name}return n}function er(t){var n=Ze.call(E,"placeholder")?E:t;return n.placeholder}function he(){var t=E.iteratee||hc;return t=t===hc?Wu:t,arguments.length?t(arguments[0],arguments[1]):t}function ei(t,n){var c=t.__data__;return my(n)?c[typeof n=="string"?"string":"hash"]:c.map}function Zl(t){for(var n=St(t),c=n.length;c--;){var y=n[c],w=t[y];n[c]=[y,w,wm(w)]}return n}function Nn(t,n){var c=pv(t,n);return Hu(c)?c:a}function ry(t){var n=Ze.call(t,gn),c=t[gn];try{t[gn]=a;var y=!0}catch{}var w=ko.call(t);return y&&(n?t[gn]=c:delete t[gn]),w}var Ql=El?function(t){return t==null?[]:(t=it(t),Ba(El(t),function(n){return Eu.call(t,n)}))}:gc,jm=El?function(t){for(var n=[];t;)Ua(n,Ql(t)),t=Mo(t);return n}:gc,$t=qt;(Dl&&$t(new Dl(new ArrayBuffer(1)))!=Ha||Cr&&$t(new Cr)!=ye||Tl&&$t(Tl.resolve())!=Hs||Kn&&$t(new Kn)!=Dt||Er&&$t(new Er)!=hn)&&($t=function(t){var n=qt(t),c=n==Rt?t.constructor:a,y=c?wn(c):"";if(y)switch(y){case Hv:return Ha;case Wv:return ye;case Bv:return Hs;case Uv:return Dt;case qv:return hn}return n});function oy(t,n,c){for(var y=-1,w=c.length;++y<w;){var T=c[y],O=T.size;switch(T.type){case"drop":t+=O;break;case"dropRight":n-=O;break;case"take":n=It(n,t+O);break;case"takeRight":t=wt(t,n-O);break}}return{start:t,end:n}}function iy(t){var n=t.match(fg);return n?n[1].split(hg):[]}function bm(t,n,c){n=Ka(n,t);for(var y=-1,w=n.length,T=!1;++y<w;){var O=fa(n[y]);if(!(T=t!=null&&c(t,O)))break;t=t[O]}return T||++y!=w?T:(w=t==null?0:t.length,!!w&&ii(w)&&Sa(O,w)&&(we(t)||Sn(t)))}function ly(t){var n=t.length,c=new t.constructor(n);return n&&typeof t[0]=="string"&&Ze.call(t,"index")&&(c.index=t.index,c.input=t.input),c}function Nm(t){return typeof t.constructor=="function"&&!Rr(t)?Xn(Mo(t)):{}}function cy(t,n,c){var y=t.constructor;switch(n){case Ss:return Vl(t);case is:case Ut:return new y(+t);case Ha:return V0(t,c);case jr:case Wa:case br:case Fn:case pn:case ia:case Hn:case la:case Nr:return nm(t,c);case ye:return new y;case Mt:case Fa:return new y(t);case Ws:return Y0(t);case Dt:return new y;case ws:return G0(t)}}function dy(t,n){var c=n.length;if(!c)return t;var y=c-1;return n[y]=(c>1?"& ":"")+n[y],n=n.join(c>2?", ":" "),t.replace(mg,`{
/* [wrapped with `+n+`] */
`)}function uy(t){return we(t)||Sn(t)||!!(Du&&t&&t[Du])}function Sa(t,n){var c=typeof t;return n=n??te,!!n&&(c=="number"||c!="symbol"&&wg.test(t))&&t>-1&&t%1==0&&t<n}function Vt(t,n,c){if(!mt(c))return!1;var y=typeof n;return(y=="number"?Qt(c)&&Sa(n,c.length):y=="string"&&n in c)?Vs(c[n],t):!1}function ec(t,n){if(we(t))return!1;var c=typeof t;return c=="number"||c=="symbol"||c=="boolean"||t==null||hs(t)?!0:cs.test(t)||!ls.test(t)||n!=null&&t in it(n)}function my(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function tc(t){var n=Qo(t),c=E[n];if(typeof c!="function"||!(n in $e.prototype))return!1;if(t===c)return!0;var y=Xl(c);return!!y&&t===y[0]}function fy(t){return!!wu&&wu in t}var hy=_o?Ca:vc;function Rr(t){var n=t&&t.constructor,c=typeof n=="function"&&n.prototype||Gn;return t===c}function wm(t){return t===t&&!mt(t)}function Sm(t,n){return function(c){return c==null?!1:c[t]===n&&(n!==a||t in it(c))}}function py(t){var n=ri(t,function(y){return c.size===h&&c.clear(),y}),c=n.cache;return n}function xy(t,n){var c=t[1],y=n[1],w=c|y,T=w<(N|C|P),O=y==P&&c==_||y==P&&c==M&&t[7].length<=n[8]||y==(P|M)&&n[7].length<=n[8]&&c==_;if(!(T||O))return t;y&N&&(t[2]=n[2],w|=c&N?0:S);var R=n[3];if(R){var z=t[3];t[3]=z?om(z,R,n[4]):R,t[4]=z?qa(t[3],x):n[4]}return R=n[5],R&&(z=t[5],t[5]=z?im(z,R,n[6]):R,t[6]=z?qa(t[5],x):n[6]),R=n[7],R&&(t[7]=R),y&P&&(t[8]=t[8]==null?n[8]:It(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=w,t}function gy(t){var n=[];if(t!=null)for(var c in it(t))n.push(c);return n}function vy(t){return ko.call(t)}function Cm(t,n,c){return n=wt(n===a?t.length-1:n,0),function(){for(var y=arguments,w=-1,T=wt(y.length-n,0),O=q(T);++w<T;)O[w]=y[n+w];w=-1;for(var R=q(n+1);++w<n;)R[w]=y[w];return R[n]=c(O),us(t,this,R)}}function Em(t,n){return n.length<2?t:bn(t,ks(n,0,-1))}function yy(t,n){for(var c=t.length,y=It(n.length,c),w=Zt(t);y--;){var T=n[y];t[y]=Sa(T,c)?w[T]:a}return t}function sc(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var Dm=_m(Ju),Ir=Mv||function(t,n){return Tt.setTimeout(t,n)},ac=_m(W0);function Tm(t,n,c){var y=n+"";return ac(t,dy(y,jy(iy(y),c)))}function _m(t){var n=0,c=0;return function(){var y=Lv(),w=H-(y-c);if(c=y,w>0){if(++n>=B)return arguments[0]}else n=0;return t.apply(a,arguments)}}function ti(t,n){var c=-1,y=t.length,w=y-1;for(n=n===a?y:n;++c<n;){var T=zl(c,w),O=t[T];t[T]=t[c],t[c]=O}return t.length=n,t}var Am=py(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(da,function(c,y,w,T){n.push(w?T.replace(gg,"$1"):y||c)}),n});function fa(t){if(typeof t=="string"||hs(t))return t;var n=t+"";return n=="0"&&1/t==-J?"-0":n}function wn(t){if(t!=null){try{return Ao.call(t)}catch{}try{return t+""}catch{}}return""}function jy(t,n){return Ds(V,function(c){var y="_."+c[0];n&c[1]&&!Co(t,y)&&t.push(y)}),t.sort()}function km(t){if(t instanceof $e)return t.clone();var n=new _s(t.__wrapped__,t.__chain__);return n.__actions__=Zt(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function by(t,n,c){(c?Vt(t,n,c):n===a)?n=1:n=wt(De(n),0);var y=t==null?0:t.length;if(!y||n<1)return[];for(var w=0,T=0,O=q($o(y/n));w<y;)O[T++]=ks(t,w,w+=n);return O}function Ny(t){for(var n=-1,c=t==null?0:t.length,y=0,w=[];++n<c;){var T=t[n];T&&(w[y++]=T)}return w}function wy(){var t=arguments.length;if(!t)return[];for(var n=q(t-1),c=arguments[0],y=t;y--;)n[y-1]=arguments[y];return Ua(we(c)?Zt(c):[c],_t(n,1))}var Sy=Ae(function(t,n){return pt(t)?Ar(t,_t(n,1,pt,!0)):[]}),Cy=Ae(function(t,n){var c=Os(n);return pt(c)&&(c=a),pt(t)?Ar(t,_t(n,1,pt,!0),he(c,2)):[]}),Ey=Ae(function(t,n){var c=Os(n);return pt(c)&&(c=a),pt(t)?Ar(t,_t(n,1,pt,!0),a,c):[]});function Dy(t,n,c){var y=t==null?0:t.length;return y?(n=c||n===a?1:De(n),ks(t,n<0?0:n,y)):[]}function Ty(t,n,c){var y=t==null?0:t.length;return y?(n=c||n===a?1:De(n),n=y-n,ks(t,0,n<0?0:n)):[]}function _y(t,n){return t&&t.length?Yo(t,he(n,3),!0,!0):[]}function Ay(t,n){return t&&t.length?Yo(t,he(n,3),!0):[]}function ky(t,n,c,y){var w=t==null?0:t.length;return w?(c&&typeof c!="number"&&Vt(t,n,c)&&(c=0,y=w),w0(t,n,c,y)):[]}function Om(t,n,c){var y=t==null?0:t.length;if(!y)return-1;var w=c==null?0:De(c);return w<0&&(w=wt(y+w,0)),Eo(t,he(n,3),w)}function Pm(t,n,c){var y=t==null?0:t.length;if(!y)return-1;var w=y-1;return c!==a&&(w=De(c),w=c<0?wt(y+w,0):It(w,y-1)),Eo(t,he(n,3),w,!0)}function Mm(t){var n=t==null?0:t.length;return n?_t(t,1):[]}function Oy(t){var n=t==null?0:t.length;return n?_t(t,J):[]}function Py(t,n){var c=t==null?0:t.length;return c?(n=n===a?1:De(n),_t(t,n)):[]}function My(t){for(var n=-1,c=t==null?0:t.length,y={};++n<c;){var w=t[n];y[w[0]]=w[1]}return y}function Rm(t){return t&&t.length?t[0]:a}function Ry(t,n,c){var y=t==null?0:t.length;if(!y)return-1;var w=c==null?0:De(c);return w<0&&(w=wt(y+w,0)),Un(t,n,w)}function Iy(t){var n=t==null?0:t.length;return n?ks(t,0,-1):[]}var $y=Ae(function(t){var n=ut(t,Ul);return n.length&&n[0]===t[0]?Ml(n):[]}),Ly=Ae(function(t){var n=Os(t),c=ut(t,Ul);return n===Os(c)?n=a:c.pop(),c.length&&c[0]===t[0]?Ml(c,he(n,2)):[]}),zy=Ae(function(t){var n=Os(t),c=ut(t,Ul);return n=typeof n=="function"?n:a,n&&c.pop(),c.length&&c[0]===t[0]?Ml(c,a,n):[]});function Fy(t,n){return t==null?"":Iv.call(t,n)}function Os(t){var n=t==null?0:t.length;return n?t[n-1]:a}function Hy(t,n,c){var y=t==null?0:t.length;if(!y)return-1;var w=y;return c!==a&&(w=De(c),w=w<0?wt(y+w,0):It(w,y-1)),n===n?jv(t,n,w):Eo(t,pu,w,!0)}function Wy(t,n){return t&&t.length?Vu(t,De(n)):a}var By=Ae(Im);function Im(t,n){return t&&t.length&&n&&n.length?Ll(t,n):t}function Uy(t,n,c){return t&&t.length&&n&&n.length?Ll(t,n,he(c,2)):t}function qy(t,n,c){return t&&t.length&&n&&n.length?Ll(t,n,a,c):t}var Vy=wa(function(t,n){var c=t==null?0:t.length,y=Al(t,n);return Ku(t,ut(n,function(w){return Sa(w,c)?+w:w}).sort(rm)),y});function Yy(t,n){var c=[];if(!(t&&t.length))return c;var y=-1,w=[],T=t.length;for(n=he(n,3);++y<T;){var O=t[y];n(O,y,t)&&(c.push(O),w.push(y))}return Ku(t,w),c}function nc(t){return t==null?t:Fv.call(t)}function Gy(t,n,c){var y=t==null?0:t.length;return y?(c&&typeof c!="number"&&Vt(t,n,c)?(n=0,c=y):(n=n==null?0:De(n),c=c===a?y:De(c)),ks(t,n,c)):[]}function Ky(t,n){return Vo(t,n)}function Jy(t,n,c){return Hl(t,n,he(c,2))}function Xy(t,n){var c=t==null?0:t.length;if(c){var y=Vo(t,n);if(y<c&&Vs(t[y],n))return y}return-1}function Zy(t,n){return Vo(t,n,!0)}function Qy(t,n,c){return Hl(t,n,he(c,2),!0)}function ej(t,n){var c=t==null?0:t.length;if(c){var y=Vo(t,n,!0)-1;if(Vs(t[y],n))return y}return-1}function tj(t){return t&&t.length?Xu(t):[]}function sj(t,n){return t&&t.length?Xu(t,he(n,2)):[]}function aj(t){var n=t==null?0:t.length;return n?ks(t,1,n):[]}function nj(t,n,c){return t&&t.length?(n=c||n===a?1:De(n),ks(t,0,n<0?0:n)):[]}function rj(t,n,c){var y=t==null?0:t.length;return y?(n=c||n===a?1:De(n),n=y-n,ks(t,n<0?0:n,y)):[]}function oj(t,n){return t&&t.length?Yo(t,he(n,3),!1,!0):[]}function ij(t,n){return t&&t.length?Yo(t,he(n,3)):[]}var lj=Ae(function(t){return Ga(_t(t,1,pt,!0))}),cj=Ae(function(t){var n=Os(t);return pt(n)&&(n=a),Ga(_t(t,1,pt,!0),he(n,2))}),dj=Ae(function(t){var n=Os(t);return n=typeof n=="function"?n:a,Ga(_t(t,1,pt,!0),a,n)});function uj(t){return t&&t.length?Ga(t):[]}function mj(t,n){return t&&t.length?Ga(t,he(n,2)):[]}function fj(t,n){return n=typeof n=="function"?n:a,t&&t.length?Ga(t,a,n):[]}function rc(t){if(!(t&&t.length))return[];var n=0;return t=Ba(t,function(c){if(pt(c))return n=wt(c.length,n),!0}),Nl(n,function(c){return ut(t,yl(c))})}function $m(t,n){if(!(t&&t.length))return[];var c=rc(t);return n==null?c:ut(c,function(y){return us(n,a,y)})}var hj=Ae(function(t,n){return pt(t)?Ar(t,n):[]}),pj=Ae(function(t){return Bl(Ba(t,pt))}),xj=Ae(function(t){var n=Os(t);return pt(n)&&(n=a),Bl(Ba(t,pt),he(n,2))}),gj=Ae(function(t){var n=Os(t);return n=typeof n=="function"?n:a,Bl(Ba(t,pt),a,n)}),vj=Ae(rc);function yj(t,n){return tm(t||[],n||[],_r)}function jj(t,n){return tm(t||[],n||[],Pr)}var bj=Ae(function(t){var n=t.length,c=n>1?t[n-1]:a;return c=typeof c=="function"?(t.pop(),c):a,$m(t,c)});function Lm(t){var n=E(t);return n.__chain__=!0,n}function Nj(t,n){return n(t),t}function si(t,n){return n(t)}var wj=wa(function(t){var n=t.length,c=n?t[0]:0,y=this.__wrapped__,w=function(T){return Al(T,t)};return n>1||this.__actions__.length||!(y instanceof $e)||!Sa(c)?this.thru(w):(y=y.slice(c,+c+(n?1:0)),y.__actions__.push({func:si,args:[w],thisArg:a}),new _s(y,this.__chain__).thru(function(T){return n&&!T.length&&T.push(a),T}))});function Sj(){return Lm(this)}function Cj(){return new _s(this.value(),this.__chain__)}function Ej(){this.__values__===a&&(this.__values__=Zm(this.value()));var t=this.__index__>=this.__values__.length,n=t?a:this.__values__[this.__index__++];return{done:t,value:n}}function Dj(){return this}function Tj(t){for(var n,c=this;c instanceof Ho;){var y=km(c);y.__index__=0,y.__values__=a,n?w.__wrapped__=y:n=y;var w=y;c=c.__wrapped__}return w.__wrapped__=t,n}function _j(){var t=this.__wrapped__;if(t instanceof $e){var n=t;return this.__actions__.length&&(n=new $e(this)),n=n.reverse(),n.__actions__.push({func:si,args:[nc],thisArg:a}),new _s(n,this.__chain__)}return this.thru(nc)}function Aj(){return em(this.__wrapped__,this.__actions__)}var kj=Go(function(t,n,c){Ze.call(t,c)?++t[c]:ba(t,c,1)});function Oj(t,n,c){var y=we(t)?fu:N0;return c&&Vt(t,n,c)&&(n=a),y(t,he(n,3))}function Pj(t,n){var c=we(t)?Ba:$u;return c(t,he(n,3))}var Mj=um(Om),Rj=um(Pm);function Ij(t,n){return _t(ai(t,n),1)}function $j(t,n){return _t(ai(t,n),J)}function Lj(t,n,c){return c=c===a?1:De(c),_t(ai(t,n),c)}function zm(t,n){var c=we(t)?Ds:Ya;return c(t,he(n,3))}function Fm(t,n){var c=we(t)?av:Iu;return c(t,he(n,3))}var zj=Go(function(t,n,c){Ze.call(t,c)?t[c].push(n):ba(t,c,[n])});function Fj(t,n,c,y){t=Qt(t)?t:sr(t),c=c&&!y?De(c):0;var w=t.length;return c<0&&(c=wt(w+c,0)),li(t)?c<=w&&t.indexOf(n,c)>-1:!!w&&Un(t,n,c)>-1}var Hj=Ae(function(t,n,c){var y=-1,w=typeof n=="function",T=Qt(t)?q(t.length):[];return Ya(t,function(O){T[++y]=w?us(n,O,c):kr(O,n,c)}),T}),Wj=Go(function(t,n,c){ba(t,c,n)});function ai(t,n){var c=we(t)?ut:Bu;return c(t,he(n,3))}function Bj(t,n,c,y){return t==null?[]:(we(n)||(n=n==null?[]:[n]),c=y?a:c,we(c)||(c=c==null?[]:[c]),Yu(t,n,c))}var Uj=Go(function(t,n,c){t[c?0:1].push(n)},function(){return[[],[]]});function qj(t,n,c){var y=we(t)?gl:gu,w=arguments.length<3;return y(t,he(n,4),c,w,Ya)}function Vj(t,n,c){var y=we(t)?nv:gu,w=arguments.length<3;return y(t,he(n,4),c,w,Iu)}function Yj(t,n){var c=we(t)?Ba:$u;return c(t,oi(he(n,3)))}function Gj(t){var n=we(t)?Ou:F0;return n(t)}function Kj(t,n,c){(c?Vt(t,n,c):n===a)?n=1:n=De(n);var y=we(t)?g0:H0;return y(t,n)}function Jj(t){var n=we(t)?v0:B0;return n(t)}function Xj(t){if(t==null)return 0;if(Qt(t))return li(t)?Vn(t):t.length;var n=$t(t);return n==ye||n==Dt?t.size:Il(t).length}function Zj(t,n,c){var y=we(t)?vl:U0;return c&&Vt(t,n,c)&&(n=a),y(t,he(n,3))}var Qj=Ae(function(t,n){if(t==null)return[];var c=n.length;return c>1&&Vt(t,n[0],n[1])?n=[]:c>2&&Vt(n[0],n[1],n[2])&&(n=[n[0]]),Yu(t,_t(n,1),[])}),ni=Pv||function(){return Tt.Date.now()};function eb(t,n){if(typeof n!="function")throw new Ts(l);return t=De(t),function(){if(--t<1)return n.apply(this,arguments)}}function Hm(t,n,c){return n=c?a:n,n=t&&n==null?t.length:n,Na(t,P,a,a,a,a,n)}function Wm(t,n){var c;if(typeof n!="function")throw new Ts(l);return t=De(t),function(){return--t>0&&(c=n.apply(this,arguments)),t<=1&&(n=a),c}}var oc=Ae(function(t,n,c){var y=N;if(c.length){var w=qa(c,er(oc));y|=k}return Na(t,y,n,c,w)}),Bm=Ae(function(t,n,c){var y=N|C;if(c.length){var w=qa(c,er(Bm));y|=k}return Na(n,y,t,c,w)});function Um(t,n,c){n=c?a:n;var y=Na(t,_,a,a,a,a,a,n);return y.placeholder=Um.placeholder,y}function qm(t,n,c){n=c?a:n;var y=Na(t,A,a,a,a,a,a,n);return y.placeholder=qm.placeholder,y}function Vm(t,n,c){var y,w,T,O,R,z,G=0,K=!1,X=!1,oe=!0;if(typeof t!="function")throw new Ts(l);n=Ps(n)||0,mt(c)&&(K=!!c.leading,X="maxWait"in c,T=X?wt(Ps(c.maxWait)||0,n):T,oe="trailing"in c?!!c.trailing:oe);function fe(xt){var Ys=y,Da=w;return y=w=a,G=xt,O=t.apply(Da,Ys),O}function xe(xt){return G=xt,R=Ir(Me,n),K?fe(xt):O}function Te(xt){var Ys=xt-z,Da=xt-G,mf=n-Ys;return X?It(mf,T-Da):mf}function ge(xt){var Ys=xt-z,Da=xt-G;return z===a||Ys>=n||Ys<0||X&&Da>=T}function Me(){var xt=ni();if(ge(xt))return Fe(xt);R=Ir(Me,Te(xt))}function Fe(xt){return R=a,oe&&y?fe(xt):(y=w=a,O)}function ps(){R!==a&&sm(R),G=0,y=z=w=R=a}function Yt(){return R===a?O:Fe(ni())}function xs(){var xt=ni(),Ys=ge(xt);if(y=arguments,w=this,z=xt,Ys){if(R===a)return xe(z);if(X)return sm(R),R=Ir(Me,n),fe(z)}return R===a&&(R=Ir(Me,n)),O}return xs.cancel=ps,xs.flush=Yt,xs}var tb=Ae(function(t,n){return Ru(t,1,n)}),sb=Ae(function(t,n,c){return Ru(t,Ps(n)||0,c)});function ab(t){return Na(t,$)}function ri(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new Ts(l);var c=function(){var y=arguments,w=n?n.apply(this,y):y[0],T=c.cache;if(T.has(w))return T.get(w);var O=t.apply(this,y);return c.cache=T.set(w,O)||T,O};return c.cache=new(ri.Cache||ja),c}ri.Cache=ja;function oi(t){if(typeof t!="function")throw new Ts(l);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function nb(t){return Wm(2,t)}var rb=q0(function(t,n){n=n.length==1&&we(n[0])?ut(n[0],ms(he())):ut(_t(n,1),ms(he()));var c=n.length;return Ae(function(y){for(var w=-1,T=It(y.length,c);++w<T;)y[w]=n[w].call(this,y[w]);return us(t,this,y)})}),ic=Ae(function(t,n){var c=qa(n,er(ic));return Na(t,k,a,n,c)}),Ym=Ae(function(t,n){var c=qa(n,er(Ym));return Na(t,D,a,n,c)}),ob=wa(function(t,n){return Na(t,M,a,a,a,n)});function ib(t,n){if(typeof t!="function")throw new Ts(l);return n=n===a?n:De(n),Ae(t,n)}function lb(t,n){if(typeof t!="function")throw new Ts(l);return n=n==null?0:wt(De(n),0),Ae(function(c){var y=c[n],w=Ja(c,0,n);return y&&Ua(w,y),us(t,this,w)})}function cb(t,n,c){var y=!0,w=!0;if(typeof t!="function")throw new Ts(l);return mt(c)&&(y="leading"in c?!!c.leading:y,w="trailing"in c?!!c.trailing:w),Vm(t,n,{leading:y,maxWait:n,trailing:w})}function db(t){return Hm(t,1)}function ub(t,n){return ic(ql(n),t)}function mb(){if(!arguments.length)return[];var t=arguments[0];return we(t)?t:[t]}function fb(t){return As(t,v)}function hb(t,n){return n=typeof n=="function"?n:a,As(t,v,n)}function pb(t){return As(t,p|v)}function xb(t,n){return n=typeof n=="function"?n:a,As(t,p|v,n)}function gb(t,n){return n==null||Mu(t,n,St(n))}function Vs(t,n){return t===n||t!==t&&n!==n}var vb=Zo(Pl),yb=Zo(function(t,n){return t>=n}),Sn=Fu(function(){return arguments}())?Fu:function(t){return ft(t)&&Ze.call(t,"callee")&&!Eu.call(t,"callee")},we=q.isArray,jb=iu?ms(iu):T0;function Qt(t){return t!=null&&ii(t.length)&&!Ca(t)}function pt(t){return ft(t)&&Qt(t)}function bb(t){return t===!0||t===!1||ft(t)&&qt(t)==is}var Xa=Rv||vc,Nb=lu?ms(lu):_0;function wb(t){return ft(t)&&t.nodeType===1&&!$r(t)}function Sb(t){if(t==null)return!0;if(Qt(t)&&(we(t)||typeof t=="string"||typeof t.splice=="function"||Xa(t)||tr(t)||Sn(t)))return!t.length;var n=$t(t);if(n==ye||n==Dt)return!t.size;if(Rr(t))return!Il(t).length;for(var c in t)if(Ze.call(t,c))return!1;return!0}function Cb(t,n){return Or(t,n)}function Eb(t,n,c){c=typeof c=="function"?c:a;var y=c?c(t,n):a;return y===a?Or(t,n,a,c):!!y}function lc(t){if(!ft(t))return!1;var n=qt(t);return n==Pt||n==zs||typeof t.message=="string"&&typeof t.name=="string"&&!$r(t)}function Db(t){return typeof t=="number"&&Tu(t)}function Ca(t){if(!mt(t))return!1;var n=qt(t);return n==Ns||n==de||n==qe||n==zn}function Gm(t){return typeof t=="number"&&t==De(t)}function ii(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=te}function mt(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function ft(t){return t!=null&&typeof t=="object"}var Km=cu?ms(cu):k0;function Tb(t,n){return t===n||Rl(t,n,Zl(n))}function _b(t,n,c){return c=typeof c=="function"?c:a,Rl(t,n,Zl(n),c)}function Ab(t){return Jm(t)&&t!=+t}function kb(t){if(hy(t))throw new be(d);return Hu(t)}function Ob(t){return t===null}function Pb(t){return t==null}function Jm(t){return typeof t=="number"||ft(t)&&qt(t)==Mt}function $r(t){if(!ft(t)||qt(t)!=Rt)return!1;var n=Mo(t);if(n===null)return!0;var c=Ze.call(n,"constructor")&&n.constructor;return typeof c=="function"&&c instanceof c&&Ao.call(c)==_v}var cc=du?ms(du):O0;function Mb(t){return Gm(t)&&t>=-te&&t<=te}var Xm=uu?ms(uu):P0;function li(t){return typeof t=="string"||!we(t)&&ft(t)&&qt(t)==Fa}function hs(t){return typeof t=="symbol"||ft(t)&&qt(t)==ws}var tr=mu?ms(mu):M0;function Rb(t){return t===a}function Ib(t){return ft(t)&&$t(t)==hn}function $b(t){return ft(t)&&qt(t)==Xt}var Lb=Zo($l),zb=Zo(function(t,n){return t<=n});function Zm(t){if(!t)return[];if(Qt(t))return li(t)?Us(t):Zt(t);if(Sr&&t[Sr])return gv(t[Sr]());var n=$t(t),c=n==ye?Sl:n==Dt?Do:sr;return c(t)}function Ea(t){if(!t)return t===0?t:0;if(t=Ps(t),t===J||t===-J){var n=t<0?-1:1;return n*me}return t===t?t:0}function De(t){var n=Ea(t),c=n%1;return n===n?c?n-c:n:0}function Qm(t){return t?jn(De(t),0,_e):0}function Ps(t){if(typeof t=="number")return t;if(hs(t))return Ce;if(mt(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=mt(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=vu(t);var c=jg.test(t);return c||Ng.test(t)?ev(t.slice(2),c?2:8):yg.test(t)?Ce:+t}function ef(t){return ma(t,es(t))}function Fb(t){return t?jn(De(t),-te,te):t===0?t:0}function Ye(t){return t==null?"":fs(t)}var Hb=Zn(function(t,n){if(Rr(n)||Qt(n)){ma(n,St(n),t);return}for(var c in n)Ze.call(n,c)&&_r(t,c,n[c])}),tf=Zn(function(t,n){ma(n,es(n),t)}),ci=Zn(function(t,n,c,y){ma(n,es(n),t,y)}),Wb=Zn(function(t,n,c,y){ma(n,St(n),t,y)}),Bb=wa(Al);function Ub(t,n){var c=Xn(t);return n==null?c:Pu(c,n)}var qb=Ae(function(t,n){t=it(t);var c=-1,y=n.length,w=y>2?n[2]:a;for(w&&Vt(n[0],n[1],w)&&(y=1);++c<y;)for(var T=n[c],O=es(T),R=-1,z=O.length;++R<z;){var G=O[R],K=t[G];(K===a||Vs(K,Gn[G])&&!Ze.call(t,G))&&(t[G]=T[G])}return t}),Vb=Ae(function(t){return t.push(a,vm),us(sf,a,t)});function Yb(t,n){return hu(t,he(n,3),ua)}function Gb(t,n){return hu(t,he(n,3),Ol)}function Kb(t,n){return t==null?t:kl(t,he(n,3),es)}function Jb(t,n){return t==null?t:Lu(t,he(n,3),es)}function Xb(t,n){return t&&ua(t,he(n,3))}function Zb(t,n){return t&&Ol(t,he(n,3))}function Qb(t){return t==null?[]:Uo(t,St(t))}function eN(t){return t==null?[]:Uo(t,es(t))}function dc(t,n,c){var y=t==null?a:bn(t,n);return y===a?c:y}function tN(t,n){return t!=null&&bm(t,n,S0)}function uc(t,n){return t!=null&&bm(t,n,C0)}var sN=fm(function(t,n,c){n!=null&&typeof n.toString!="function"&&(n=ko.call(n)),t[n]=c},fc(ts)),aN=fm(function(t,n,c){n!=null&&typeof n.toString!="function"&&(n=ko.call(n)),Ze.call(t,n)?t[n].push(c):t[n]=[c]},he),nN=Ae(kr);function St(t){return Qt(t)?ku(t):Il(t)}function es(t){return Qt(t)?ku(t,!0):R0(t)}function rN(t,n){var c={};return n=he(n,3),ua(t,function(y,w,T){ba(c,n(y,w,T),y)}),c}function oN(t,n){var c={};return n=he(n,3),ua(t,function(y,w,T){ba(c,w,n(y,w,T))}),c}var iN=Zn(function(t,n,c){qo(t,n,c)}),sf=Zn(function(t,n,c,y){qo(t,n,c,y)}),lN=wa(function(t,n){var c={};if(t==null)return c;var y=!1;n=ut(n,function(T){return T=Ka(T,t),y||(y=T.length>1),T}),ma(t,Jl(t),c),y&&(c=As(c,p|g|v,sy));for(var w=n.length;w--;)Wl(c,n[w]);return c});function cN(t,n){return af(t,oi(he(n)))}var dN=wa(function(t,n){return t==null?{}:$0(t,n)});function af(t,n){if(t==null)return{};var c=ut(Jl(t),function(y){return[y]});return n=he(n),Gu(t,c,function(y,w){return n(y,w[0])})}function uN(t,n,c){n=Ka(n,t);var y=-1,w=n.length;for(w||(w=1,t=a);++y<w;){var T=t==null?a:t[fa(n[y])];T===a&&(y=w,T=c),t=Ca(T)?T.call(t):T}return t}function mN(t,n,c){return t==null?t:Pr(t,n,c)}function fN(t,n,c,y){return y=typeof y=="function"?y:a,t==null?t:Pr(t,n,c,y)}var nf=xm(St),rf=xm(es);function hN(t,n,c){var y=we(t),w=y||Xa(t)||tr(t);if(n=he(n,4),c==null){var T=t&&t.constructor;w?c=y?new T:[]:mt(t)?c=Ca(T)?Xn(Mo(t)):{}:c={}}return(w?Ds:ua)(t,function(O,R,z){return n(c,O,R,z)}),c}function pN(t,n){return t==null?!0:Wl(t,n)}function xN(t,n,c){return t==null?t:Qu(t,n,ql(c))}function gN(t,n,c,y){return y=typeof y=="function"?y:a,t==null?t:Qu(t,n,ql(c),y)}function sr(t){return t==null?[]:wl(t,St(t))}function vN(t){return t==null?[]:wl(t,es(t))}function yN(t,n,c){return c===a&&(c=n,n=a),c!==a&&(c=Ps(c),c=c===c?c:0),n!==a&&(n=Ps(n),n=n===n?n:0),jn(Ps(t),n,c)}function jN(t,n,c){return n=Ea(n),c===a?(c=n,n=0):c=Ea(c),t=Ps(t),E0(t,n,c)}function bN(t,n,c){if(c&&typeof c!="boolean"&&Vt(t,n,c)&&(n=c=a),c===a&&(typeof n=="boolean"?(c=n,n=a):typeof t=="boolean"&&(c=t,t=a)),t===a&&n===a?(t=0,n=1):(t=Ea(t),n===a?(n=t,t=0):n=Ea(n)),t>n){var y=t;t=n,n=y}if(c||t%1||n%1){var w=_u();return It(t+w*(n-t+Qg("1e-"+((w+"").length-1))),n)}return zl(t,n)}var NN=Qn(function(t,n,c){return n=n.toLowerCase(),t+(c?of(n):n)});function of(t){return mc(Ye(t).toLowerCase())}function lf(t){return t=Ye(t),t&&t.replace(Sg,mv).replace(Bg,"")}function wN(t,n,c){t=Ye(t),n=fs(n);var y=t.length;c=c===a?y:jn(De(c),0,y);var w=c;return c-=n.length,c>=0&&t.slice(c,w)==n}function SN(t){return t=Ye(t),t&&ll.test(t)?t.replace(Wn,fv):t}function CN(t){return t=Ye(t),t&&ds.test(t)?t.replace(Bs,"\\$&"):t}var EN=Qn(function(t,n,c){return t+(c?"-":"")+n.toLowerCase()}),DN=Qn(function(t,n,c){return t+(c?" ":"")+n.toLowerCase()}),TN=dm("toLowerCase");function _N(t,n,c){t=Ye(t),n=De(n);var y=n?Vn(t):0;if(!n||y>=n)return t;var w=(n-y)/2;return Xo(Lo(w),c)+t+Xo($o(w),c)}function AN(t,n,c){t=Ye(t),n=De(n);var y=n?Vn(t):0;return n&&y<n?t+Xo(n-y,c):t}function kN(t,n,c){t=Ye(t),n=De(n);var y=n?Vn(t):0;return n&&y<n?Xo(n-y,c)+t:t}function ON(t,n,c){return c||n==null?n=0:n&&(n=+n),zv(Ye(t).replace(Cs,""),n||0)}function PN(t,n,c){return(c?Vt(t,n,c):n===a)?n=1:n=De(n),Fl(Ye(t),n)}function MN(){var t=arguments,n=Ye(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var RN=Qn(function(t,n,c){return t+(c?"_":"")+n.toLowerCase()});function IN(t,n,c){return c&&typeof c!="number"&&Vt(t,n,c)&&(n=c=a),c=c===a?_e:c>>>0,c?(t=Ye(t),t&&(typeof n=="string"||n!=null&&!cc(n))&&(n=fs(n),!n&&qn(t))?Ja(Us(t),0,c):t.split(n,c)):[]}var $N=Qn(function(t,n,c){return t+(c?" ":"")+mc(n)});function LN(t,n,c){return t=Ye(t),c=c==null?0:jn(De(c),0,t.length),n=fs(n),t.slice(c,c+n.length)==n}function zN(t,n,c){var y=E.templateSettings;c&&Vt(t,n,c)&&(n=a),t=Ye(t),n=ci({},n,y,gm);var w=ci({},n.imports,y.imports,gm),T=St(w),O=wl(w,T),R,z,G=0,K=n.interpolate||No,X="__p += '",oe=Cl((n.escape||No).source+"|"+K.source+"|"+(K===ot?vg:No).source+"|"+(n.evaluate||No).source+"|$","g"),fe="//# sourceURL="+(Ze.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Gg+"]")+`
`;t.replace(oe,function(ge,Me,Fe,ps,Yt,xs){return Fe||(Fe=ps),X+=t.slice(G,xs).replace(Cg,hv),Me&&(R=!0,X+=`' +
__e(`+Me+`) +
'`),Yt&&(z=!0,X+=`';
`+Yt+`;
__p += '`),Fe&&(X+=`' +
((__t = (`+Fe+`)) == null ? '' : __t) +
'`),G=xs+ge.length,ge}),X+=`';
`;var xe=Ze.call(n,"variable")&&n.variable;if(!xe)X=`with (obj) {
`+X+`
}
`;else if(xg.test(xe))throw new be(u);X=(z?X.replace(il,""):X).replace(yo,"$1").replace(jo,"$1;"),X="function("+(xe||"obj")+`) {
`+(xe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(z?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+X+`return __p
}`;var Te=df(function(){return We(T,fe+"return "+X).apply(a,O)});if(Te.source=X,lc(Te))throw Te;return Te}function FN(t){return Ye(t).toLowerCase()}function HN(t){return Ye(t).toUpperCase()}function WN(t,n,c){if(t=Ye(t),t&&(c||n===a))return vu(t);if(!t||!(n=fs(n)))return t;var y=Us(t),w=Us(n),T=yu(y,w),O=ju(y,w)+1;return Ja(y,T,O).join("")}function BN(t,n,c){if(t=Ye(t),t&&(c||n===a))return t.slice(0,Nu(t)+1);if(!t||!(n=fs(n)))return t;var y=Us(t),w=ju(y,Us(n))+1;return Ja(y,0,w).join("")}function UN(t,n,c){if(t=Ye(t),t&&(c||n===a))return t.replace(Cs,"");if(!t||!(n=fs(n)))return t;var y=Us(t),w=yu(y,Us(n));return Ja(y,w).join("")}function qN(t,n){var c=W,y=I;if(mt(n)){var w="separator"in n?n.separator:w;c="length"in n?De(n.length):c,y="omission"in n?fs(n.omission):y}t=Ye(t);var T=t.length;if(qn(t)){var O=Us(t);T=O.length}if(c>=T)return t;var R=c-Vn(y);if(R<1)return y;var z=O?Ja(O,0,R).join(""):t.slice(0,R);if(w===a)return z+y;if(O&&(R+=z.length-R),cc(w)){if(t.slice(R).search(w)){var G,K=z;for(w.global||(w=Cl(w.source,Ye(Fd.exec(w))+"g")),w.lastIndex=0;G=w.exec(K);)var X=G.index;z=z.slice(0,X===a?R:X)}}else if(t.indexOf(fs(w),R)!=R){var oe=z.lastIndexOf(w);oe>-1&&(z=z.slice(0,oe))}return z+y}function VN(t){return t=Ye(t),t&&ca.test(t)?t.replace(bo,bv):t}var YN=Qn(function(t,n,c){return t+(c?" ":"")+n.toUpperCase()}),mc=dm("toUpperCase");function cf(t,n,c){return t=Ye(t),n=c?a:n,n===a?xv(t)?Sv(t):iv(t):t.match(n)||[]}var df=Ae(function(t,n){try{return us(t,a,n)}catch(c){return lc(c)?c:new be(c)}}),GN=wa(function(t,n){return Ds(n,function(c){c=fa(c),ba(t,c,oc(t[c],t))}),t});function KN(t){var n=t==null?0:t.length,c=he();return t=n?ut(t,function(y){if(typeof y[1]!="function")throw new Ts(l);return[c(y[0]),y[1]]}):[],Ae(function(y){for(var w=-1;++w<n;){var T=t[w];if(us(T[0],this,y))return us(T[1],this,y)}})}function JN(t){return b0(As(t,p))}function fc(t){return function(){return t}}function XN(t,n){return t==null||t!==t?n:t}var ZN=mm(),QN=mm(!0);function ts(t){return t}function hc(t){return Wu(typeof t=="function"?t:As(t,p))}function ew(t){return Uu(As(t,p))}function tw(t,n){return qu(t,As(n,p))}var sw=Ae(function(t,n){return function(c){return kr(c,t,n)}}),aw=Ae(function(t,n){return function(c){return kr(t,c,n)}});function pc(t,n,c){var y=St(n),w=Uo(n,y);c==null&&!(mt(n)&&(w.length||!y.length))&&(c=n,n=t,t=this,w=Uo(n,St(n)));var T=!(mt(c)&&"chain"in c)||!!c.chain,O=Ca(t);return Ds(w,function(R){var z=n[R];t[R]=z,O&&(t.prototype[R]=function(){var G=this.__chain__;if(T||G){var K=t(this.__wrapped__),X=K.__actions__=Zt(this.__actions__);return X.push({func:z,args:arguments,thisArg:t}),K.__chain__=G,K}return z.apply(t,Ua([this.value()],arguments))})}),t}function nw(){return Tt._===this&&(Tt._=Av),this}function xc(){}function rw(t){return t=De(t),Ae(function(n){return Vu(n,t)})}var ow=Yl(ut),iw=Yl(fu),lw=Yl(vl);function uf(t){return ec(t)?yl(fa(t)):L0(t)}function cw(t){return function(n){return t==null?a:bn(t,n)}}var dw=hm(),uw=hm(!0);function gc(){return[]}function vc(){return!1}function mw(){return{}}function fw(){return""}function hw(){return!0}function pw(t,n){if(t=De(t),t<1||t>te)return[];var c=_e,y=It(t,_e);n=he(n),t-=_e;for(var w=Nl(y,n);++c<t;)n(c);return w}function xw(t){return we(t)?ut(t,fa):hs(t)?[t]:Zt(Am(Ye(t)))}function gw(t){var n=++Tv;return Ye(t)+n}var vw=Jo(function(t,n){return t+n},0),yw=Gl("ceil"),jw=Jo(function(t,n){return t/n},1),bw=Gl("floor");function Nw(t){return t&&t.length?Bo(t,ts,Pl):a}function ww(t,n){return t&&t.length?Bo(t,he(n,2),Pl):a}function Sw(t){return xu(t,ts)}function Cw(t,n){return xu(t,he(n,2))}function Ew(t){return t&&t.length?Bo(t,ts,$l):a}function Dw(t,n){return t&&t.length?Bo(t,he(n,2),$l):a}var Tw=Jo(function(t,n){return t*n},1),_w=Gl("round"),Aw=Jo(function(t,n){return t-n},0);function kw(t){return t&&t.length?bl(t,ts):0}function Ow(t,n){return t&&t.length?bl(t,he(n,2)):0}return E.after=eb,E.ary=Hm,E.assign=Hb,E.assignIn=tf,E.assignInWith=ci,E.assignWith=Wb,E.at=Bb,E.before=Wm,E.bind=oc,E.bindAll=GN,E.bindKey=Bm,E.castArray=mb,E.chain=Lm,E.chunk=by,E.compact=Ny,E.concat=wy,E.cond=KN,E.conforms=JN,E.constant=fc,E.countBy=kj,E.create=Ub,E.curry=Um,E.curryRight=qm,E.debounce=Vm,E.defaults=qb,E.defaultsDeep=Vb,E.defer=tb,E.delay=sb,E.difference=Sy,E.differenceBy=Cy,E.differenceWith=Ey,E.drop=Dy,E.dropRight=Ty,E.dropRightWhile=_y,E.dropWhile=Ay,E.fill=ky,E.filter=Pj,E.flatMap=Ij,E.flatMapDeep=$j,E.flatMapDepth=Lj,E.flatten=Mm,E.flattenDeep=Oy,E.flattenDepth=Py,E.flip=ab,E.flow=ZN,E.flowRight=QN,E.fromPairs=My,E.functions=Qb,E.functionsIn=eN,E.groupBy=zj,E.initial=Iy,E.intersection=$y,E.intersectionBy=Ly,E.intersectionWith=zy,E.invert=sN,E.invertBy=aN,E.invokeMap=Hj,E.iteratee=hc,E.keyBy=Wj,E.keys=St,E.keysIn=es,E.map=ai,E.mapKeys=rN,E.mapValues=oN,E.matches=ew,E.matchesProperty=tw,E.memoize=ri,E.merge=iN,E.mergeWith=sf,E.method=sw,E.methodOf=aw,E.mixin=pc,E.negate=oi,E.nthArg=rw,E.omit=lN,E.omitBy=cN,E.once=nb,E.orderBy=Bj,E.over=ow,E.overArgs=rb,E.overEvery=iw,E.overSome=lw,E.partial=ic,E.partialRight=Ym,E.partition=Uj,E.pick=dN,E.pickBy=af,E.property=uf,E.propertyOf=cw,E.pull=By,E.pullAll=Im,E.pullAllBy=Uy,E.pullAllWith=qy,E.pullAt=Vy,E.range=dw,E.rangeRight=uw,E.rearg=ob,E.reject=Yj,E.remove=Yy,E.rest=ib,E.reverse=nc,E.sampleSize=Kj,E.set=mN,E.setWith=fN,E.shuffle=Jj,E.slice=Gy,E.sortBy=Qj,E.sortedUniq=tj,E.sortedUniqBy=sj,E.split=IN,E.spread=lb,E.tail=aj,E.take=nj,E.takeRight=rj,E.takeRightWhile=oj,E.takeWhile=ij,E.tap=Nj,E.throttle=cb,E.thru=si,E.toArray=Zm,E.toPairs=nf,E.toPairsIn=rf,E.toPath=xw,E.toPlainObject=ef,E.transform=hN,E.unary=db,E.union=lj,E.unionBy=cj,E.unionWith=dj,E.uniq=uj,E.uniqBy=mj,E.uniqWith=fj,E.unset=pN,E.unzip=rc,E.unzipWith=$m,E.update=xN,E.updateWith=gN,E.values=sr,E.valuesIn=vN,E.without=hj,E.words=cf,E.wrap=ub,E.xor=pj,E.xorBy=xj,E.xorWith=gj,E.zip=vj,E.zipObject=yj,E.zipObjectDeep=jj,E.zipWith=bj,E.entries=nf,E.entriesIn=rf,E.extend=tf,E.extendWith=ci,pc(E,E),E.add=vw,E.attempt=df,E.camelCase=NN,E.capitalize=of,E.ceil=yw,E.clamp=yN,E.clone=fb,E.cloneDeep=pb,E.cloneDeepWith=xb,E.cloneWith=hb,E.conformsTo=gb,E.deburr=lf,E.defaultTo=XN,E.divide=jw,E.endsWith=wN,E.eq=Vs,E.escape=SN,E.escapeRegExp=CN,E.every=Oj,E.find=Mj,E.findIndex=Om,E.findKey=Yb,E.findLast=Rj,E.findLastIndex=Pm,E.findLastKey=Gb,E.floor=bw,E.forEach=zm,E.forEachRight=Fm,E.forIn=Kb,E.forInRight=Jb,E.forOwn=Xb,E.forOwnRight=Zb,E.get=dc,E.gt=vb,E.gte=yb,E.has=tN,E.hasIn=uc,E.head=Rm,E.identity=ts,E.includes=Fj,E.indexOf=Ry,E.inRange=jN,E.invoke=nN,E.isArguments=Sn,E.isArray=we,E.isArrayBuffer=jb,E.isArrayLike=Qt,E.isArrayLikeObject=pt,E.isBoolean=bb,E.isBuffer=Xa,E.isDate=Nb,E.isElement=wb,E.isEmpty=Sb,E.isEqual=Cb,E.isEqualWith=Eb,E.isError=lc,E.isFinite=Db,E.isFunction=Ca,E.isInteger=Gm,E.isLength=ii,E.isMap=Km,E.isMatch=Tb,E.isMatchWith=_b,E.isNaN=Ab,E.isNative=kb,E.isNil=Pb,E.isNull=Ob,E.isNumber=Jm,E.isObject=mt,E.isObjectLike=ft,E.isPlainObject=$r,E.isRegExp=cc,E.isSafeInteger=Mb,E.isSet=Xm,E.isString=li,E.isSymbol=hs,E.isTypedArray=tr,E.isUndefined=Rb,E.isWeakMap=Ib,E.isWeakSet=$b,E.join=Fy,E.kebabCase=EN,E.last=Os,E.lastIndexOf=Hy,E.lowerCase=DN,E.lowerFirst=TN,E.lt=Lb,E.lte=zb,E.max=Nw,E.maxBy=ww,E.mean=Sw,E.meanBy=Cw,E.min=Ew,E.minBy=Dw,E.stubArray=gc,E.stubFalse=vc,E.stubObject=mw,E.stubString=fw,E.stubTrue=hw,E.multiply=Tw,E.nth=Wy,E.noConflict=nw,E.noop=xc,E.now=ni,E.pad=_N,E.padEnd=AN,E.padStart=kN,E.parseInt=ON,E.random=bN,E.reduce=qj,E.reduceRight=Vj,E.repeat=PN,E.replace=MN,E.result=uN,E.round=_w,E.runInContext=L,E.sample=Gj,E.size=Xj,E.snakeCase=RN,E.some=Zj,E.sortedIndex=Ky,E.sortedIndexBy=Jy,E.sortedIndexOf=Xy,E.sortedLastIndex=Zy,E.sortedLastIndexBy=Qy,E.sortedLastIndexOf=ej,E.startCase=$N,E.startsWith=LN,E.subtract=Aw,E.sum=kw,E.sumBy=Ow,E.template=zN,E.times=pw,E.toFinite=Ea,E.toInteger=De,E.toLength=Qm,E.toLower=FN,E.toNumber=Ps,E.toSafeInteger=Fb,E.toString=Ye,E.toUpper=HN,E.trim=WN,E.trimEnd=BN,E.trimStart=UN,E.truncate=qN,E.unescape=VN,E.uniqueId=gw,E.upperCase=YN,E.upperFirst=mc,E.each=zm,E.eachRight=Fm,E.first=Rm,pc(E,function(){var t={};return ua(E,function(n,c){Ze.call(E.prototype,c)||(t[c]=n)}),t}(),{chain:!1}),E.VERSION=o,Ds(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){E[t].placeholder=E}),Ds(["drop","take"],function(t,n){$e.prototype[t]=function(c){c=c===a?1:wt(De(c),0);var y=this.__filtered__&&!n?new $e(this):this.clone();return y.__filtered__?y.__takeCount__=It(c,y.__takeCount__):y.__views__.push({size:It(c,_e),type:t+(y.__dir__<0?"Right":"")}),y},$e.prototype[t+"Right"]=function(c){return this.reverse()[t](c).reverse()}}),Ds(["filter","map","takeWhile"],function(t,n){var c=n+1,y=c==U||c==re;$e.prototype[t]=function(w){var T=this.clone();return T.__iteratees__.push({iteratee:he(w,3),type:c}),T.__filtered__=T.__filtered__||y,T}}),Ds(["head","last"],function(t,n){var c="take"+(n?"Right":"");$e.prototype[t]=function(){return this[c](1).value()[0]}}),Ds(["initial","tail"],function(t,n){var c="drop"+(n?"":"Right");$e.prototype[t]=function(){return this.__filtered__?new $e(this):this[c](1)}}),$e.prototype.compact=function(){return this.filter(ts)},$e.prototype.find=function(t){return this.filter(t).head()},$e.prototype.findLast=function(t){return this.reverse().find(t)},$e.prototype.invokeMap=Ae(function(t,n){return typeof t=="function"?new $e(this):this.map(function(c){return kr(c,t,n)})}),$e.prototype.reject=function(t){return this.filter(oi(he(t)))},$e.prototype.slice=function(t,n){t=De(t);var c=this;return c.__filtered__&&(t>0||n<0)?new $e(c):(t<0?c=c.takeRight(-t):t&&(c=c.drop(t)),n!==a&&(n=De(n),c=n<0?c.dropRight(-n):c.take(n-t)),c)},$e.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},$e.prototype.toArray=function(){return this.take(_e)},ua($e.prototype,function(t,n){var c=/^(?:filter|find|map|reject)|While$/.test(n),y=/^(?:head|last)$/.test(n),w=E[y?"take"+(n=="last"?"Right":""):n],T=y||/^find/.test(n);w&&(E.prototype[n]=function(){var O=this.__wrapped__,R=y?[1]:arguments,z=O instanceof $e,G=R[0],K=z||we(O),X=function(Me){var Fe=w.apply(E,Ua([Me],R));return y&&oe?Fe[0]:Fe};K&&c&&typeof G=="function"&&G.length!=1&&(z=K=!1);var oe=this.__chain__,fe=!!this.__actions__.length,xe=T&&!oe,Te=z&&!fe;if(!T&&K){O=Te?O:new $e(this);var ge=t.apply(O,R);return ge.__actions__.push({func:si,args:[X],thisArg:a}),new _s(ge,oe)}return xe&&Te?t.apply(this,R):(ge=this.thru(X),xe?y?ge.value()[0]:ge.value():ge)})}),Ds(["pop","push","shift","sort","splice","unshift"],function(t){var n=To[t],c=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",y=/^(?:pop|shift)$/.test(t);E.prototype[t]=function(){var w=arguments;if(y&&!this.__chain__){var T=this.value();return n.apply(we(T)?T:[],w)}return this[c](function(O){return n.apply(we(O)?O:[],w)})}}),ua($e.prototype,function(t,n){var c=E[n];if(c){var y=c.name+"";Ze.call(Jn,y)||(Jn[y]=[]),Jn[y].push({name:n,func:c})}}),Jn[Ko(a,C).name]=[{name:"wrapper",func:a}],$e.prototype.clone=Vv,$e.prototype.reverse=Yv,$e.prototype.value=Gv,E.prototype.at=wj,E.prototype.chain=Sj,E.prototype.commit=Cj,E.prototype.next=Ej,E.prototype.plant=Tj,E.prototype.reverse=_j,E.prototype.toJSON=E.prototype.valueOf=E.prototype.value=Aj,E.prototype.first=E.prototype.head,Sr&&(E.prototype[Sr]=Dj),E},Yn=Cv();xn?((xn.exports=Yn)._=Yn,hl._=Yn):Tt._=Yn}).call(Lr)})(bi,bi.exports);var Lt=bi.exports;const gp=(s,r)=>{const[a,o]=f.useState(null),[i,d]=f.useState(!0),[l,u]=f.useState(null),{user:m}=Se();return f.useEffect(()=>{(async()=>{if(o(null),!!m){d(!0),u(null);try{const x=[],p=new Date(s),g=new Date(r);for(;p<=g;)x.push(pe(p)),p.setDate(p.getDate()+1);const v=new Map(x.map(B=>[B,{date:B,drinks:[],totalWater:0}])),j=x.map(B=>{const H=ue(ne,"water",`${m.uid}_${B}`);return Ot(H)});(await Promise.all(j)).forEach(B=>{if(B.exists()){const H=B.data();v.set(H.date,{date:H.date,drinks:H.drinks||[],totalWater:H.totalWater||0})}});const N=Array.from(v.values()),C=Lt.sumBy(N,"totalWater"),S=N.filter(B=>B.totalWater>0).length,_=N.filter(B=>B.totalWater>=2e3).length,A=S>0?C/S:0,k=N.flatMap(B=>B.drinks),D=Lt.groupBy(k,"type"),P=Object.entries(D).map(([B,H])=>({type:B,count:H.length,totalAmount:Lt.sumBy(H,"amount"),percentage:Lt.sumBy(H,"amount")/C*100||0})).sort((B,H)=>H.totalAmount-B.totalAmount),M=Lt.groupBy(k,B=>Jt[B.type].category),$=Object.entries(M).map(([B,H])=>({category:B,totalAmount:Lt.sumBy(H,"amount"),percentage:Lt.sumBy(H,"amount")/C*100||0})).sort((B,H)=>H.totalAmount-B.totalAmount);let W;r.getTime()-s.getTime()>2592e6&&(W=Object.entries(Lt.groupBy(N,B=>B.date.substring(0,7))).map(([B,H])=>({month:`${B}-01`,average:Lt.sumBy(H,"totalWater")/H.length})).sort((B,H)=>new Date(B.month).getTime()-new Date(H.month).getTime()));const I=N.map(B=>({date:B.date,intake:B.totalWater}));o({dailyStats:I,summary:{totalIntake:C,avgDailyIntake:A,daysTracked:S,daysWithGoal:_},drinkStats:P,categoryStats:$,...W&&{monthlyAverages:W}})}catch(x){console.error("Error al cargar estadísticas:",x),u(x instanceof Error?x.message:"Error al cargar estadísticas")}finally{d(!1)}}})()},[m,s,r]),{stats:a,loading:i,error:l}},Df=["#60A5FA","#34D399","#A78BFA","#F87171","#FBBF24","#A3E635"],u2=({startDate:s,endDate:r})=>{const{stats:a,loading:o,error:i}=gp(s,r);if(o)return e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"flex items-center justify-center p-6",children:e.jsx(Wt,{className:"w-6 h-6 animate-spin"})})});if(i||!a)return e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-6",children:e.jsx("p",{className:"text-red-500",children:"Error al cargar estadísticas"})})});const d=l=>vt(new Date(l),"dd MMM",{locale:Qs});return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(se,{className:"w-full md:col-span-2",children:[e.jsx(Oe,{className:"pb-2",children:e.jsx(Pe,{children:"Resumen del Período"})}),e.jsx(ae,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[" ",e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(a.summary.avgDailyIntake),"ml"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Promedio diario"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[" ",e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.summary.daysTracked}),e.jsx("div",{className:"text-sm text-gray-600",children:"Días registrados"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[" ",e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:a.summary.daysWithGoal}),e.jsx("div",{className:"text-sm text-gray-600",children:"Días meta alcanzada"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[" ",e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[Math.round(a.summary.totalIntake/1e3),"L"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total consumido"})]})]})})]}),e.jsxs(se,{className:"w-full md:col-span-2",children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Tendencia de Consumo"})}),e.jsx(ae,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Pa,{data:a.dailyStats,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"date",tickFormatter:d,interval:"preserveStartEnd"}),e.jsx(as,{tickFormatter:l=>`${l}ml`}),e.jsx(bt,{formatter:l=>[`${l}ml`,"Consumo"],labelFormatter:l=>vt(new Date(l),"dd MMMM yyyy",{locale:Qs})}),e.jsx(Ms,{type:"monotone",dataKey:"intake",stroke:"#60A5FA",strokeWidth:2,dot:!1})]})})})})]}),e.jsxs(se,{className:"w-full",children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Distribución por Categoría"})}),e.jsx(ae,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Rn,{children:[e.jsx(In,{data:a.categoryStats,dataKey:"totalAmount",nameKey:"category",cx:"50%",cy:"50%",outerRadius:100,label:({category:l})=>Xr[l],children:a.categoryStats.map((l,u)=>e.jsx($n,{fill:Df[u%Df.length]},l.category))}),e.jsx(bt,{formatter:l=>[`${l}ml`,"Cantidad"],labelFormatter:l=>Xr[l]})]})})})})]}),e.jsxs(se,{className:"w-full",children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Top Bebidas"})}),"        ",e.jsx(ae,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[" ",a.drinkStats.slice(0,6).map(l=>{const u=Jt[l.type],m=mn[u.icon];return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted hover:bg-accent transition-colors",children:[e.jsx(m,{className:`w-8 h-8 ${u.color} flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[" ",e.jsx("div",{className:"font-medium text-base",children:u.name})," ",e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",Math.round(l.totalAmount),"ml"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[" ",l.count," veces (",Math.round(l.percentage),"%)"]})]})]},l.type)})]})})]}),a.monthlyAverages&&e.jsxs(se,{className:"w-full md:col-span-2",children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Promedios Mensuales"})}),e.jsx(ae,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs($i,{data:a.monthlyAverages,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"month",tickFormatter:l=>{const u=new Date(l);return vt(u,"MMM yyyy",{locale:Qs})}}),e.jsx(as,{tickFormatter:l=>`${Math.round(l)}ml`}),e.jsx(bt,{formatter:l=>[`${Math.round(l)}ml`,"Promedio"],labelFormatter:l=>{const u=new Date(l);return vt(u,"MMMM yyyy",{locale:Qs})}}),e.jsx(Kr,{dataKey:"average",fill:"#60A5FA"})]})})})})]})]})};function m2(s,r=[]){let a=[];function o(d,l){const u=f.createContext(l),m=a.length;a=[...a,l];function h(p){const{scope:g,children:v,...j}=p,b=(g==null?void 0:g[s][m])||u,N=f.useMemo(()=>j,Object.values(j));return e.jsx(b.Provider,{value:N,children:v})}function x(p,g){const v=(g==null?void 0:g[s][m])||u,j=f.useContext(v);if(j)return j;if(l!==void 0)return l;throw new Error(`\`${p}\` must be used within \`${d}\``)}return h.displayName=d+"Provider",[h,x]}const i=()=>{const d=a.map(l=>f.createContext(l));return function(u){const m=(u==null?void 0:u[s])||d;return f.useMemo(()=>({[`__scope${s}`]:{...u,[s]:m}}),[u,m])}};return i.scopeName=s,[o,f2(i,...r)]}function f2(...s){const r=s[0];if(s.length===1)return r;const a=()=>{const o=s.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(d){const l=o.reduce((u,{useScope:m,scopeName:h})=>{const p=m(d)[`__scope${h}`];return{...u,...p}},{});return f.useMemo(()=>({[`__scope${r.scopeName}`]:l}),[l])}};return a.scopeName=r.scopeName,a}var ld="Progress",cd=100,[h2,G4]=m2(ld),[p2,x2]=h2(ld),vp=f.forwardRef((s,r)=>{const{__scopeProgress:a,value:o=null,max:i,getValueLabel:d=g2,...l}=s;(i||i===0)&&!Tf(i)&&console.error(v2(`${i}`,"Progress"));const u=Tf(i)?i:cd;o!==null&&!_f(o,u)&&console.error(y2(`${o}`,"Progress"));const m=_f(o,u)?o:null,h=Ni(m)?d(m,u):void 0;return e.jsx(p2,{scope:a,value:m,max:u,children:e.jsx(Bt.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":Ni(m)?m:void 0,"aria-valuetext":h,role:"progressbar","data-state":bp(m,u),"data-value":m??void 0,"data-max":u,...l,ref:r})})});vp.displayName=ld;var yp="ProgressIndicator",jp=f.forwardRef((s,r)=>{const{__scopeProgress:a,...o}=s,i=x2(yp,a);return e.jsx(Bt.div,{"data-state":bp(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...o,ref:r})});jp.displayName=yp;function g2(s,r){return`${Math.round(s/r*100)}%`}function bp(s,r){return s==null?"indeterminate":s===r?"complete":"loading"}function Ni(s){return typeof s=="number"}function Tf(s){return Ni(s)&&!isNaN(s)&&s>0}function _f(s,r){return Ni(s)&&!isNaN(s)&&s<=r&&s>=0}function v2(s,r){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${cd}\`.`}function y2(s,r){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${cd} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Np=vp,j2=jp;const kt=f.forwardRef(({className:s,value:r,...a},o)=>e.jsx(Np,{ref:o,className:Z("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(j2,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));kt.displayName=Np.displayName;const b2=({intake:s,goal:r})=>{const a=()=>{const o=s/r*100;return o>=100?"¡Excelente! Has alcanzado tu meta diaria 🎉":o>=75?"¡Vas muy bien! Ya casi llegas a tu meta 💪":o>=50?"¡A mitad de camino! Sigue así 🌊":o>=25?"¡Buen comienzo! Mantén el ritmo 💧":"¡Comienza tu día con buena hidratación! 🚰"};return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-medium text-lg flex items-center gap-2",children:[e.jsx(no,{className:"w-5 h-5"}),"Hidratación"]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:s>r?"text-blue-500 font-medium":"",children:[s,"ml / ",r,"ml"]}),e.jsx("div",{className:"text-xs text-gray-500",children:s>r?`+${s-r}ml extra`:""})]})]}),e.jsx(kt,{value:Math.min(s/r*100,100),className:"h-3"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:a()})]})},st=Zc,Ui=Qc,N2=Xc,wp=f.forwardRef(({className:s,...r},a)=>e.jsx(eo,{ref:a,className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r}));wp.displayName=eo.displayName;const Ke=f.forwardRef(({className:s,children:r,...a},o)=>e.jsxs(N2,{children:[e.jsx(wp,{}),e.jsxs(to,{ref:o,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[r,e.jsxs(_i,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Rs,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ke.displayName=to.displayName;const Je=({className:s,...r})=>e.jsx("div",{className:Z("flex flex-col space-y-1.5 text-center sm:text-left",s),...r});Je.displayName="DialogHeader";const os=({className:s,...r})=>e.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...r});os.displayName="DialogFooter";const Xe=f.forwardRef(({className:s,...r},a)=>e.jsx(so,{ref:a,className:Z("text-lg font-semibold leading-none tracking-tight",s),...r}));Xe.displayName=so.displayName;const na=f.forwardRef(({className:s,...r},a)=>e.jsx(ao,{ref:a,className:Z("text-sm text-muted-foreground",s),...r}));na.displayName=ao.displayName;function w2(s,r){return f.useReducer((a,o)=>r[a][o]??a,s)}var dd="ScrollArea",[Sp,K4]=mr(dd),[S2,Is]=Sp(dd),Cp=f.forwardRef((s,r)=>{const{__scopeScrollArea:a,type:o="hover",dir:i,scrollHideDelay:d=600,...l}=s,[u,m]=f.useState(null),[h,x]=f.useState(null),[p,g]=f.useState(null),[v,j]=f.useState(null),[b,N]=f.useState(null),[C,S]=f.useState(0),[_,A]=f.useState(0),[k,D]=f.useState(!1),[P,M]=f.useState(!1),$=bs(r,I=>m(I)),W=xh(i);return e.jsx(S2,{scope:a,type:o,dir:W,scrollHideDelay:d,scrollArea:u,viewport:h,onViewportChange:x,content:p,onContentChange:g,scrollbarX:v,onScrollbarXChange:j,scrollbarXEnabled:k,onScrollbarXEnabledChange:D,scrollbarY:b,onScrollbarYChange:N,scrollbarYEnabled:P,onScrollbarYEnabledChange:M,onCornerWidthChange:S,onCornerHeightChange:A,children:e.jsx(Bt.div,{dir:W,...l,ref:$,style:{position:"relative","--radix-scroll-area-corner-width":C+"px","--radix-scroll-area-corner-height":_+"px",...s.style}})})});Cp.displayName=dd;var Ep="ScrollAreaViewport",Dp=f.forwardRef((s,r)=>{const{__scopeScrollArea:a,children:o,asChild:i,nonce:d,...l}=s,u=Is(Ep,a),m=f.useRef(null),h=bs(r,m,u.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:d}),e.jsx(Bt.div,{"data-radix-scroll-area-viewport":"",...l,asChild:i,ref:h,style:{overflowX:u.scrollbarXEnabled?"scroll":"hidden",overflowY:u.scrollbarYEnabled?"scroll":"hidden",...s.style},children:M2({asChild:i,children:o},x=>e.jsx("div",{"data-radix-scroll-area-content":"",ref:u.onContentChange,style:{minWidth:u.scrollbarXEnabled?"fit-content":void 0},children:x}))})]})});Dp.displayName=Ep;var va="ScrollAreaScrollbar",ud=f.forwardRef((s,r)=>{const{forceMount:a,...o}=s,i=Is(va,s.__scopeScrollArea),{onScrollbarXEnabledChange:d,onScrollbarYEnabledChange:l}=i,u=s.orientation==="horizontal";return f.useEffect(()=>(u?d(!0):l(!0),()=>{u?d(!1):l(!1)}),[u,d,l]),i.type==="hover"?e.jsx(C2,{...o,ref:r,forceMount:a}):i.type==="scroll"?e.jsx(E2,{...o,ref:r,forceMount:a}):i.type==="auto"?e.jsx(Tp,{...o,ref:r,forceMount:a}):i.type==="always"?e.jsx(md,{...o,ref:r}):null});ud.displayName=va;var C2=f.forwardRef((s,r)=>{const{forceMount:a,...o}=s,i=Is(va,s.__scopeScrollArea),[d,l]=f.useState(!1);return f.useEffect(()=>{const u=i.scrollArea;let m=0;if(u){const h=()=>{window.clearTimeout(m),l(!0)},x=()=>{m=window.setTimeout(()=>l(!1),i.scrollHideDelay)};return u.addEventListener("pointerenter",h),u.addEventListener("pointerleave",x),()=>{window.clearTimeout(m),u.removeEventListener("pointerenter",h),u.removeEventListener("pointerleave",x)}}},[i.scrollArea,i.scrollHideDelay]),e.jsx(Pn,{present:a||d,children:e.jsx(Tp,{"data-state":d?"visible":"hidden",...o,ref:r})})}),E2=f.forwardRef((s,r)=>{const{forceMount:a,...o}=s,i=Is(va,s.__scopeScrollArea),d=s.orientation==="horizontal",l=Vi(()=>m("SCROLL_END"),100),[u,m]=w2("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return f.useEffect(()=>{if(u==="idle"){const h=window.setTimeout(()=>m("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(h)}},[u,i.scrollHideDelay,m]),f.useEffect(()=>{const h=i.viewport,x=d?"scrollLeft":"scrollTop";if(h){let p=h[x];const g=()=>{const v=h[x];p!==v&&(m("SCROLL"),l()),p=v};return h.addEventListener("scroll",g),()=>h.removeEventListener("scroll",g)}},[i.viewport,d,m,l]),e.jsx(Pn,{present:a||u!=="hidden",children:e.jsx(md,{"data-state":u==="hidden"?"hidden":"visible",...o,ref:r,onPointerEnter:Ct(s.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:Ct(s.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),Tp=f.forwardRef((s,r)=>{const a=Is(va,s.__scopeScrollArea),{forceMount:o,...i}=s,[d,l]=f.useState(!1),u=s.orientation==="horizontal",m=Vi(()=>{if(a.viewport){const h=a.viewport.offsetWidth<a.viewport.scrollWidth,x=a.viewport.offsetHeight<a.viewport.scrollHeight;l(u?h:x)}},10);return cr(a.viewport,m),cr(a.content,m),e.jsx(Pn,{present:o||d,children:e.jsx(md,{"data-state":d?"visible":"hidden",...i,ref:r})})}),md=f.forwardRef((s,r)=>{const{orientation:a="vertical",...o}=s,i=Is(va,s.__scopeScrollArea),d=f.useRef(null),l=f.useRef(0),[u,m]=f.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=Pp(u.viewport,u.content),x={...o,sizes:u,onSizesChange:m,hasThumb:h>0&&h<1,onThumbChange:g=>d.current=g,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:g=>l.current=g};function p(g,v){return O2(g,l.current,u,v)}return a==="horizontal"?e.jsx(D2,{...x,ref:r,onThumbPositionChange:()=>{if(i.viewport&&d.current){const g=i.viewport.scrollLeft,v=Af(g,u,i.dir);d.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:g=>{i.viewport&&(i.viewport.scrollLeft=g)},onDragScroll:g=>{i.viewport&&(i.viewport.scrollLeft=p(g,i.dir))}}):a==="vertical"?e.jsx(T2,{...x,ref:r,onThumbPositionChange:()=>{if(i.viewport&&d.current){const g=i.viewport.scrollTop,v=Af(g,u);d.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:g=>{i.viewport&&(i.viewport.scrollTop=g)},onDragScroll:g=>{i.viewport&&(i.viewport.scrollTop=p(g))}}):null}),D2=f.forwardRef((s,r)=>{const{sizes:a,onSizesChange:o,...i}=s,d=Is(va,s.__scopeScrollArea),[l,u]=f.useState(),m=f.useRef(null),h=bs(r,m,d.onScrollbarXChange);return f.useEffect(()=>{m.current&&u(getComputedStyle(m.current))},[m]),e.jsx(Ap,{"data-orientation":"horizontal",...i,ref:h,sizes:a,style:{bottom:0,left:d.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:d.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":qi(a)+"px",...s.style},onThumbPointerDown:x=>s.onThumbPointerDown(x.x),onDragScroll:x=>s.onDragScroll(x.x),onWheelScroll:(x,p)=>{if(d.viewport){const g=d.viewport.scrollLeft+x.deltaX;s.onWheelScroll(g),Rp(g,p)&&x.preventDefault()}},onResize:()=>{m.current&&d.viewport&&l&&o({content:d.viewport.scrollWidth,viewport:d.viewport.offsetWidth,scrollbar:{size:m.current.clientWidth,paddingStart:Si(l.paddingLeft),paddingEnd:Si(l.paddingRight)}})}})}),T2=f.forwardRef((s,r)=>{const{sizes:a,onSizesChange:o,...i}=s,d=Is(va,s.__scopeScrollArea),[l,u]=f.useState(),m=f.useRef(null),h=bs(r,m,d.onScrollbarYChange);return f.useEffect(()=>{m.current&&u(getComputedStyle(m.current))},[m]),e.jsx(Ap,{"data-orientation":"vertical",...i,ref:h,sizes:a,style:{top:0,right:d.dir==="ltr"?0:void 0,left:d.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":qi(a)+"px",...s.style},onThumbPointerDown:x=>s.onThumbPointerDown(x.y),onDragScroll:x=>s.onDragScroll(x.y),onWheelScroll:(x,p)=>{if(d.viewport){const g=d.viewport.scrollTop+x.deltaY;s.onWheelScroll(g),Rp(g,p)&&x.preventDefault()}},onResize:()=>{m.current&&d.viewport&&l&&o({content:d.viewport.scrollHeight,viewport:d.viewport.offsetHeight,scrollbar:{size:m.current.clientHeight,paddingStart:Si(l.paddingTop),paddingEnd:Si(l.paddingBottom)}})}})}),[_2,_p]=Sp(va),Ap=f.forwardRef((s,r)=>{const{__scopeScrollArea:a,sizes:o,hasThumb:i,onThumbChange:d,onThumbPointerUp:l,onThumbPointerDown:u,onThumbPositionChange:m,onDragScroll:h,onWheelScroll:x,onResize:p,...g}=s,v=Is(va,a),[j,b]=f.useState(null),N=bs(r,$=>b($)),C=f.useRef(null),S=f.useRef(""),_=v.viewport,A=o.content-o.viewport,k=En(x),D=En(m),P=Vi(p,10);function M($){if(C.current){const W=$.clientX-C.current.left,I=$.clientY-C.current.top;h({x:W,y:I})}}return f.useEffect(()=>{const $=W=>{const I=W.target;(j==null?void 0:j.contains(I))&&k(W,A)};return document.addEventListener("wheel",$,{passive:!1}),()=>document.removeEventListener("wheel",$,{passive:!1})},[_,j,A,k]),f.useEffect(D,[o,D]),cr(j,P),cr(v.content,P),e.jsx(_2,{scope:a,scrollbar:j,hasThumb:i,onThumbChange:En(d),onThumbPointerUp:En(l),onThumbPositionChange:D,onThumbPointerDown:En(u),children:e.jsx(Bt.div,{...g,ref:N,style:{position:"absolute",...g.style},onPointerDown:Ct(s.onPointerDown,$=>{$.button===0&&($.target.setPointerCapture($.pointerId),C.current=j.getBoundingClientRect(),S.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),M($))}),onPointerMove:Ct(s.onPointerMove,M),onPointerUp:Ct(s.onPointerUp,$=>{const W=$.target;W.hasPointerCapture($.pointerId)&&W.releasePointerCapture($.pointerId),document.body.style.webkitUserSelect=S.current,v.viewport&&(v.viewport.style.scrollBehavior=""),C.current=null})})})}),wi="ScrollAreaThumb",kp=f.forwardRef((s,r)=>{const{forceMount:a,...o}=s,i=_p(wi,s.__scopeScrollArea);return e.jsx(Pn,{present:a||i.hasThumb,children:e.jsx(A2,{ref:r,...o})})}),A2=f.forwardRef((s,r)=>{const{__scopeScrollArea:a,style:o,...i}=s,d=Is(wi,a),l=_p(wi,a),{onThumbPositionChange:u}=l,m=bs(r,p=>l.onThumbChange(p)),h=f.useRef(),x=Vi(()=>{h.current&&(h.current(),h.current=void 0)},100);return f.useEffect(()=>{const p=d.viewport;if(p){const g=()=>{if(x(),!h.current){const v=P2(p,u);h.current=v,u()}};return u(),p.addEventListener("scroll",g),()=>p.removeEventListener("scroll",g)}},[d.viewport,x,u]),e.jsx(Bt.div,{"data-state":l.hasThumb?"visible":"hidden",...i,ref:m,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...o},onPointerDownCapture:Ct(s.onPointerDownCapture,p=>{const v=p.target.getBoundingClientRect(),j=p.clientX-v.left,b=p.clientY-v.top;l.onThumbPointerDown({x:j,y:b})}),onPointerUp:Ct(s.onPointerUp,l.onThumbPointerUp)})});kp.displayName=wi;var fd="ScrollAreaCorner",Op=f.forwardRef((s,r)=>{const a=Is(fd,s.__scopeScrollArea),o=!!(a.scrollbarX&&a.scrollbarY);return a.type!=="scroll"&&o?e.jsx(k2,{...s,ref:r}):null});Op.displayName=fd;var k2=f.forwardRef((s,r)=>{const{__scopeScrollArea:a,...o}=s,i=Is(fd,a),[d,l]=f.useState(0),[u,m]=f.useState(0),h=!!(d&&u);return cr(i.scrollbarX,()=>{var p;const x=((p=i.scrollbarX)==null?void 0:p.offsetHeight)||0;i.onCornerHeightChange(x),m(x)}),cr(i.scrollbarY,()=>{var p;const x=((p=i.scrollbarY)==null?void 0:p.offsetWidth)||0;i.onCornerWidthChange(x),l(x)}),h?e.jsx(Bt.div,{...o,ref:r,style:{width:d,height:u,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...s.style}}):null});function Si(s){return s?parseInt(s,10):0}function Pp(s,r){const a=s/r;return isNaN(a)?0:a}function qi(s){const r=Pp(s.viewport,s.content),a=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,o=(s.scrollbar.size-a)*r;return Math.max(o,18)}function O2(s,r,a,o="ltr"){const i=qi(a),d=i/2,l=r||d,u=i-l,m=a.scrollbar.paddingStart+l,h=a.scrollbar.size-a.scrollbar.paddingEnd-u,x=a.content-a.viewport,p=o==="ltr"?[0,x]:[x*-1,0];return Mp([m,h],p)(s)}function Af(s,r,a="ltr"){const o=qi(r),i=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,d=r.scrollbar.size-i,l=r.content-r.viewport,u=d-o,m=a==="ltr"?[0,l]:[l*-1,0],h=Yw(s,m);return Mp([0,l],[0,u])(h)}function Mp(s,r){return a=>{if(s[0]===s[1]||r[0]===r[1])return r[0];const o=(r[1]-r[0])/(s[1]-s[0]);return r[0]+o*(a-s[0])}}function Rp(s,r){return s>0&&s<r}var P2=(s,r=()=>{})=>{let a={left:s.scrollLeft,top:s.scrollTop},o=0;return function i(){const d={left:s.scrollLeft,top:s.scrollTop},l=a.left!==d.left,u=a.top!==d.top;(l||u)&&r(),a=d,o=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(o)};function Vi(s,r){const a=En(s),o=f.useRef(0);return f.useEffect(()=>()=>window.clearTimeout(o.current),[]),f.useCallback(()=>{window.clearTimeout(o.current),o.current=window.setTimeout(a,r)},[a,r])}function cr(s,r){const a=En(r);gh(()=>{let o=0;if(s){const i=new ResizeObserver(()=>{cancelAnimationFrame(o),o=window.requestAnimationFrame(a)});return i.observe(s),()=>{window.cancelAnimationFrame(o),i.unobserve(s)}}},[s,a])}function M2(s,r){const{asChild:a,children:o}=s;if(!a)return typeof r=="function"?r(o):r;const i=f.Children.only(o);return f.cloneElement(i,{children:typeof r=="function"?r(i.props.children):r})}var Ip=Cp,R2=Dp,I2=Op;const hd=f.forwardRef(({className:s,children:r,...a},o)=>e.jsxs(Ip,{ref:o,className:Z("relative overflow-hidden",s),...a,children:[e.jsx(R2,{className:"h-full w-full rounded-[inherit]",children:r}),e.jsx($p,{}),e.jsx(I2,{})]}));hd.displayName=Ip.displayName;const $p=f.forwardRef(({className:s,orientation:r="vertical",...a},o)=>e.jsx(ud,{ref:o,orientation:r,className:Z("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(kp,{className:"relative flex-1 rounded-full bg-border"})}));$p.displayName=ud.displayName;const $2=({isOpen:s,onClose:r,onSelect:a})=>{var x;const[o,i]=f.useState(null),[d,l]=f.useState("water"),u=Object.entries(Jt).reduce((p,[g,v])=>{const j=v.category;return p[j]||(p[j]=[]),p[j].push({key:g,...v}),p},{}),m=p=>{i(o===p?null:p)},h=p=>{o&&(a(o,p),i(null),r())};return e.jsx(st,{open:s,onOpenChange:r,children:e.jsxs(Ke,{className:"sm:max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(Je,{children:e.jsx(Xe,{className:"text-xl",children:"Seleccionar bebida"})}),e.jsxs("div",{className:"flex flex-col gap-4 flex-1",children:[e.jsxs(Le,{value:d,onValueChange:l,children:[e.jsx(Re,{className:"w-full md:w-64",children:e.jsx(ze,{placeholder:"Selecciona una categoría"})}),e.jsx(Ie,{children:Object.entries(Xr).map(([p,g])=>e.jsx(le,{value:p,children:g},p))})]}),e.jsx(hd,{className:"flex-1",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 p-1",children:(x=u[d])==null?void 0:x.map(p=>{const g=mn[p.icon],v=o===p.key;return e.jsx("div",{className:"relative",children:e.jsxs(F,{variant:v?"default":"outline",className:"w-full h-20 flex flex-col items-center justify-center gap-2 p-3 text-center transition-all hover:scale-105 transform",onClick:()=>m(p.key),children:[e.jsx(g,{className:`w-6 h-6 ${v?"text-white":p.color} flex-shrink-0`}),e.jsx("span",{className:"text-xs leading-tight break-words font-medium",children:p.name})]})},p.key)})})}),o&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-3 sm:flex-shrink-0",children:(()=>{const p=Jt[o],g=mn[p.icon];return e.jsxs(e.Fragment,{children:[e.jsx(g,{className:`w-6 h-6 ${p.color}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:p.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Selecciona la cantidad"})]})]})})()}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2",children:Jt[o].amounts.map(p=>e.jsxs(F,{variant:"outline",size:"sm",className:"bg-white hover:bg-blue-50 border-blue-200 text-blue-700 font-medium transition-all hover:scale-105 transform",onClick:()=>h(p),children:[p,"ml"]},p))})}),e.jsx(F,{variant:"ghost",size:"sm",className:"text-gray-500 hover:text-gray-700 sm:flex-shrink-0",onClick:()=>i(null),children:"✕"})]})})]})]})})},L2=["water","sparklingWater","flavoredWater","coffee","tea","aromatica","milk","juice","sportsdrink","soda","energyDrink"],z2=({selectedDrink:s,onDrinkSelect:r,onAmountSelect:a,disabled:o})=>{const[i,d]=f.useState(!1),l=(m,h)=>{a(m,h),d(!1)},u=m=>{r(s===m?null:m)};return e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Agregar bebida"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Selecciona una bebida para registrar"})]}),"      ",e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:[L2.map(m=>{const h=Jt[m],x=mn[h.icon],p=s===m;return e.jsxs(F,{variant:p?"default":"outline",className:Z("h-20 w-full flex flex-col items-center justify-center gap-1 p-2","transition-all duration-200 hover:scale-105",p&&"ring-2 ring-blue-500 ring-offset-1"),onClick:()=>u(m),disabled:o,children:[e.jsx(x,{className:Z("w-5 h-5 flex-shrink-0",p?"text-white":h.color)}),e.jsx("span",{className:"text-xs font-medium leading-tight text-center",children:h.name})]},m)}),e.jsxs(F,{variant:"outline",className:"h-20 w-full flex flex-col items-center justify-center gap-1 p-2 border-dashed border-2 hover:border-blue-300 hover:bg-blue-50",onClick:()=>d(!0),disabled:o,children:[e.jsx(ys,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Más"})]})]}),s&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:(()=>{const m=Jt[s],h=mn[m.icon];return e.jsxs(e.Fragment,{children:[e.jsx(h,{className:Z("w-5 h-5",m.color)}),e.jsx("span",{className:"font-medium text-gray-900",children:m.name})]})})()}),e.jsx(F,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-600 h-8 w-8 p-0",onClick:()=>r(null),children:e.jsx(Rs,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Jt[s].amounts.map(m=>e.jsx(F,{variant:"outline",className:"h-10 bg-white hover:bg-blue-50 hover:border-blue-300",onClick:()=>{a(s,m),r(null)},children:e.jsxs("span",{className:"font-medium",children:[m,"ml"]})},m))})]}),e.jsx($2,{isOpen:i,onClose:()=>d(!1),onSelect:l})]})},ke=f.forwardRef(({className:s,type:r,...a},o)=>e.jsx("input",{type:r,className:Z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:o,...a}));ke.displayName="Input";const F2=({drink:s,isOpen:r,onClose:a,onSave:o})=>{const[i,d]=f.useState(""),[l,u]=f.useState("");if(f.useEffect(()=>{s&&(d(s.amount.toString()),u(s.time))},[s]),!s)return null;const m=Jt[s.type],h=mn[m.icon],x=()=>{const p={...s,amount:parseInt(i),time:l,hydration:parseInt(i)*m.hydrationFactor};o(p),a()};return e.jsx(st,{open:r,onOpenChange:a,children:e.jsxs(Ke,{className:"sm:max-w-md",children:[e.jsx(Je,{children:e.jsxs(Xe,{className:"flex items-center gap-2",children:[e.jsx(h,{className:`w-5 h-5 ${m.color}`}),"Editar ",m.name]})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"amount",className:"text-sm font-medium",children:"Cantidad (ml)"}),e.jsx(ke,{id:"amount",type:"number",value:i,onChange:p=>d(p.target.value),min:"0",step:"50"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"time",className:"text-sm font-medium",children:"Hora"}),e.jsx(ke,{id:"time",type:"time",value:l,onChange:p=>u(p.target.value)})]})]}),e.jsxs(os,{className:"sm:justify-start",children:[e.jsx(F,{type:"button",variant:"secondary",onClick:a,children:"Cancelar"}),e.jsx(F,{type:"button",onClick:x,disabled:!i||!l,children:"Guardar cambios"})]})]})})},H2=({drinks:s,showHistory:r,onToggleHistory:a,onDeleteDrink:o,onEditDrink:i,isCurrentDate:d})=>{const[l,u]=f.useState(null),m=(x,p)=>{u({index:x,drink:p})},h=x=>{l&&(i(l.index,x),u(null))};return e.jsxs("div",{children:[e.jsxs(F,{variant:"outline",className:"w-full",onClick:a,children:[r?e.jsx(Oi,{className:"w-4 h-4 mr-2"}):e.jsx(ga,{className:"w-4 h-4 mr-2"}),"Historial de hoy"]}),r&&s.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:s.map((x,p)=>{const g=Jt[x.type],v=mn[g.icon];return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[e.jsx(v,{className:`w-5 h-5 ${g.color} flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:g.name}),e.jsxs("span",{className:"text-muted-foreground text-sm font-medium",children:[x.amount,"ml"]})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:x.time})]}),d&&e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(F,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-accent-foreground/10 touch-manipulation",onClick:()=>m(p,x),title:"Editar",children:e.jsx(Mi,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(F,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-destructive/10 touch-manipulation",onClick:()=>o(p),title:"Eliminar",children:e.jsx(oo,{className:"h-4 w-4 text-destructive"})})]})]},x.timestamp)})}),r&&s.length===0&&e.jsxs("div",{className:"mt-4 text-center text-muted-foreground text-sm py-4",children:[" ","No hay registros para este día"]}),e.jsx(F2,{drink:(l==null?void 0:l.drink)||null,isOpen:!!l,onClose:()=>u(null),onSave:h})]})},W2=s=>{const[r,a]=f.useState(0),[o,i]=f.useState([]),[d,l]=f.useState("idle"),[u,m]=f.useState(null),{user:h}=Se(),x=j=>j.reduce((b,N)=>b+N.hydration,0);return f.useEffect(()=>{if(!h)return;const j=pe(s),b=ue(ne,"water",`${h.uid}_${j}`),N=ht(b,C=>{if(C.exists()){const _=C.data().drinks||[],A=x(_);a(A),i(_),l("saved")}else a(0),i([]),l("idle")},C=>{console.error("Error en snapshot:",C),m(C.message),l("error")});return()=>N()},[h,s]),{intake:r,drinks:o,status:d,error:u,addDrink:async(j,b)=>{if(h){l("saving"),m(null);try{const N=pe(s),C=ue(ne,"water",`${h.uid}_${N}`),S=new Date,_=Kt(s,S.getHours(),S.getMinutes()),A=b*Jt[j].hydrationFactor,k={type:j,amount:b,hydration:A,timestamp:_.timestamp.toString(),time:S.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1})},D=[...o,k],P=x(D);await et(C,{userId:h.uid,date:N,drinks:D,totalWater:P,updatedAt:Be()},{merge:!0}),l("saved")}catch(N){m(N instanceof Error?N.message:"Error al guardar"),l("error")}}},editDrink:async(j,b)=>{if(h){l("saving"),m(null);try{const N=pe(s),C=ue(ne,"water",`${h.uid}_${N}`),[S,_]=b.time.split(":").map(Number),A=Kt(s,S,_),k={...b,timestamp:A.timestamp.toString(),hydration:b.amount*Jt[b.type].hydrationFactor},D=[...o];D[j]=k;const P=x(D);await et(C,{userId:h.uid,date:N,drinks:D,totalWater:P,updatedAt:Be()},{merge:!0}),l("saved")}catch(N){m(N instanceof Error?N.message:"Error al editar"),l("error")}}},deleteDrink:async j=>{if(h){l("saving"),m(null);try{const b=pe(s),N=ue(ne,"water",`${h.uid}_${b}`),C=o.filter((_,A)=>A!==j),S=x(C);await et(N,{userId:h.uid,date:b,drinks:C,totalWater:S,updatedAt:Be()},{merge:!0}),l("saved")}catch(b){m(b instanceof Error?b.message:"Error al eliminar"),l("error")}}}}};var ve=function(){return ve=Object.assign||function(r){for(var a,o=1,i=arguments.length;o<i;o++){a=arguments[o];for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(r[d]=a[d])}return r},ve.apply(this,arguments)};function B2(s,r){var a={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&r.indexOf(o)<0&&(a[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(s);i<o.length;i++)r.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(s,o[i])&&(a[o[i]]=s[o[i]]);return a}function Lp(s,r,a){for(var o=0,i=r.length,d;o<i;o++)(d||!(o in r))&&(d||(d=Array.prototype.slice.call(r,0,o)),d[o]=r[o]);return s.concat(d||Array.prototype.slice.call(r))}function lo(s){return s.mode==="multiple"}function co(s){return s.mode==="range"}function Yi(s){return s.mode==="single"}var U2={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function q2(s,r){return vt(s,"LLLL y",r)}function V2(s,r){return vt(s,"d",r)}function Y2(s,r){return vt(s,"LLLL",r)}function G2(s){return"".concat(s)}function K2(s,r){return vt(s,"cccccc",r)}function J2(s,r){return vt(s,"yyyy",r)}var X2=Object.freeze({__proto__:null,formatCaption:q2,formatDay:V2,formatMonthCaption:Y2,formatWeekNumber:G2,formatWeekdayName:K2,formatYearCaption:J2}),Z2=function(s,r,a){return vt(s,"do MMMM (EEEE)",a)},Q2=function(){return"Month: "},eE=function(){return"Go to next month"},tE=function(){return"Go to previous month"},sE=function(s,r){return vt(s,"cccc",r)},aE=function(s){return"Week n. ".concat(s)},nE=function(){return"Year: "},rE=Object.freeze({__proto__:null,labelDay:Z2,labelMonthDropdown:Q2,labelNext:eE,labelPrevious:tE,labelWeekNumber:aE,labelWeekday:sE,labelYearDropdown:nE});function oE(){var s="buttons",r=U2,a=m1,o={},i={},d=1,l={},u=new Date;return{captionLayout:s,classNames:r,formatters:X2,labels:rE,locale:a,modifiersClassNames:o,modifiers:i,numberOfMonths:d,styles:l,today:u,mode:"default"}}function iE(s){var r=s.fromYear,a=s.toYear,o=s.fromMonth,i=s.toMonth,d=s.fromDate,l=s.toDate;return o?d=Qe(o):r&&(d=new Date(r,0,1)),i?l=vs(i):a&&(l=new Date(a,11,31)),{fromDate:d?yt(d):void 0,toDate:l?yt(l):void 0}}var zp=f.createContext(void 0);function lE(s){var r,a=s.initialProps,o=oE(),i=iE(a),d=i.fromDate,l=i.toDate,u=(r=a.captionLayout)!==null&&r!==void 0?r:o.captionLayout;u!=="buttons"&&(!d||!l)&&(u="buttons");var m;(Yi(a)||lo(a)||co(a))&&(m=a.onSelect);var h=ve(ve(ve({},o),a),{captionLayout:u,classNames:ve(ve({},o.classNames),a.classNames),components:ve({},a.components),formatters:ve(ve({},o.formatters),a.formatters),fromDate:d,labels:ve(ve({},o.labels),a.labels),mode:a.mode||o.mode,modifiers:ve(ve({},o.modifiers),a.modifiers),modifiersClassNames:ve(ve({},o.modifiersClassNames),a.modifiersClassNames),onSelect:m,styles:ve(ve({},o.styles),a.styles),toDate:l});return e.jsx(zp.Provider,{value:h,children:s.children})}function ct(){var s=f.useContext(zp);if(!s)throw new Error("useDayPicker must be used within a DayPickerProvider.");return s}function Fp(s){var r=ct(),a=r.locale,o=r.classNames,i=r.styles,d=r.formatters.formatCaption;return e.jsx("div",{className:o.caption_label,style:i.caption_label,"aria-live":"polite",role:"presentation",id:s.id,children:d(s.displayMonth,{locale:a})})}function cE(s){return e.jsx("svg",ve({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},s,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Hp(s){var r,a,o=s.onChange,i=s.value,d=s.children,l=s.caption,u=s.className,m=s.style,h=ct(),x=(a=(r=h.components)===null||r===void 0?void 0:r.IconDropdown)!==null&&a!==void 0?a:cE;return e.jsxs("div",{className:u,style:m,children:[e.jsx("span",{className:h.classNames.vhidden,children:s["aria-label"]}),e.jsx("select",{name:s.name,"aria-label":s["aria-label"],className:h.classNames.dropdown,style:h.styles.dropdown,value:i,onChange:o,children:d}),e.jsxs("div",{className:h.classNames.caption_label,style:h.styles.caption_label,"aria-hidden":"true",children:[l,e.jsx(x,{className:h.classNames.dropdown_icon,style:h.styles.dropdown_icon})]})]})}function dE(s){var r,a=ct(),o=a.fromDate,i=a.toDate,d=a.styles,l=a.locale,u=a.formatters.formatMonthCaption,m=a.classNames,h=a.components,x=a.labels.labelMonthDropdown;if(!o)return e.jsx(e.Fragment,{});if(!i)return e.jsx(e.Fragment,{});var p=[];if(f1(o,i))for(var g=Qe(o),v=o.getMonth();v<=i.getMonth();v++)p.push(jc(g,v));else for(var g=Qe(new Date),v=0;v<=11;v++)p.push(jc(g,v));var j=function(N){var C=Number(N.target.value),S=jc(Qe(s.displayMonth),C);s.onChange(S)},b=(r=h==null?void 0:h.Dropdown)!==null&&r!==void 0?r:Hp;return e.jsx(b,{name:"months","aria-label":x(),className:m.dropdown_month,style:d.dropdown_month,onChange:j,value:s.displayMonth.getMonth(),caption:u(s.displayMonth,{locale:l}),children:p.map(function(N){return e.jsx("option",{value:N.getMonth(),children:u(N,{locale:l})},N.getMonth())})})}function uE(s){var r,a=s.displayMonth,o=ct(),i=o.fromDate,d=o.toDate,l=o.locale,u=o.styles,m=o.classNames,h=o.components,x=o.formatters.formatYearCaption,p=o.labels.labelYearDropdown,g=[];if(!i)return e.jsx(e.Fragment,{});if(!d)return e.jsx(e.Fragment,{});for(var v=i.getFullYear(),j=d.getFullYear(),b=v;b<=j;b++)g.push(xf(Pc(new Date),b));var N=function(S){var _=xf(Qe(a),Number(S.target.value));s.onChange(_)},C=(r=h==null?void 0:h.Dropdown)!==null&&r!==void 0?r:Hp;return e.jsx(C,{name:"years","aria-label":p(),className:m.dropdown_year,style:u.dropdown_year,onChange:N,value:a.getFullYear(),caption:x(a,{locale:l}),children:g.map(function(S){return e.jsx("option",{value:S.getFullYear(),children:x(S,{locale:l})},S.getFullYear())})})}function mE(s,r){var a=f.useState(s),o=a[0],i=a[1],d=r===void 0?o:r;return[d,i]}function fE(s){var r=s.month,a=s.defaultMonth,o=s.today,i=r||a||o||new Date,d=s.toDate,l=s.fromDate,u=s.numberOfMonths,m=u===void 0?1:u;if(d&&Yr(d,i)<0){var h=-1*(m-1);i=sa(d,h)}return l&&Yr(i,l)<0&&(i=l),Qe(i)}function hE(){var s=ct(),r=fE(s),a=mE(r,s.month),o=a[0],i=a[1],d=function(l){var u;if(!s.disableNavigation){var m=Qe(l);i(m),(u=s.onMonthChange)===null||u===void 0||u.call(s,m)}};return[o,d]}function pE(s,r){for(var a=r.reverseMonths,o=r.numberOfMonths,i=Qe(s),d=Qe(sa(i,o)),l=Yr(d,i),u=[],m=0;m<l;m++){var h=sa(i,m);u.push(h)}return a&&(u=u.reverse()),u}function xE(s,r){if(!r.disableNavigation){var a=r.toDate,o=r.pagedNavigation,i=r.numberOfMonths,d=i===void 0?1:i,l=o?d:1,u=Qe(s);if(!a)return sa(u,l);var m=Yr(a,s);if(!(m<d))return sa(u,l)}}function gE(s,r){if(!r.disableNavigation){var a=r.fromDate,o=r.pagedNavigation,i=r.numberOfMonths,d=i===void 0?1:i,l=o?d:1,u=Qe(s);if(!a)return sa(u,-l);var m=Yr(u,a);if(!(m<=0))return sa(u,-l)}}var Wp=f.createContext(void 0);function vE(s){var r=ct(),a=hE(),o=a[0],i=a[1],d=pE(o,r),l=xE(o,r),u=gE(o,r),m=function(p){return d.some(function(g){return ed(p,g)})},h=function(p,g){m(p)||(g&&Ft(p,g)?i(sa(p,1+r.numberOfMonths*-1)):i(p))},x={currentMonth:o,displayMonths:d,goToMonth:i,goToDate:h,previousMonth:u,nextMonth:l,isDateDisplayed:m};return e.jsx(Wp.Provider,{value:x,children:s.children})}function uo(){var s=f.useContext(Wp);if(!s)throw new Error("useNavigation must be used within a NavigationProvider");return s}function kf(s){var r,a=ct(),o=a.classNames,i=a.styles,d=a.components,l=uo().goToMonth,u=function(x){l(sa(x,s.displayIndex?-s.displayIndex:0))},m=(r=d==null?void 0:d.CaptionLabel)!==null&&r!==void 0?r:Fp,h=e.jsx(m,{id:s.id,displayMonth:s.displayMonth});return e.jsxs("div",{className:o.caption_dropdowns,style:i.caption_dropdowns,children:[e.jsx("div",{className:o.vhidden,children:h}),e.jsx(dE,{onChange:u,displayMonth:s.displayMonth}),e.jsx(uE,{onChange:u,displayMonth:s.displayMonth})]})}function yE(s){return e.jsx("svg",ve({width:"16px",height:"16px",viewBox:"0 0 120 120"},s,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function jE(s){return e.jsx("svg",ve({width:"16px",height:"16px",viewBox:"0 0 120 120"},s,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Ci=f.forwardRef(function(s,r){var a=ct(),o=a.classNames,i=a.styles,d=[o.button_reset,o.button];s.className&&d.push(s.className);var l=d.join(" "),u=ve(ve({},i.button_reset),i.button);return s.style&&Object.assign(u,s.style),e.jsx("button",ve({},s,{ref:r,type:"button",className:l,style:u}))});function bE(s){var r,a,o=ct(),i=o.dir,d=o.locale,l=o.classNames,u=o.styles,m=o.labels,h=m.labelPrevious,x=m.labelNext,p=o.components;if(!s.nextMonth&&!s.previousMonth)return e.jsx(e.Fragment,{});var g=h(s.previousMonth,{locale:d}),v=[l.nav_button,l.nav_button_previous].join(" "),j=x(s.nextMonth,{locale:d}),b=[l.nav_button,l.nav_button_next].join(" "),N=(r=p==null?void 0:p.IconRight)!==null&&r!==void 0?r:jE,C=(a=p==null?void 0:p.IconLeft)!==null&&a!==void 0?a:yE;return e.jsxs("div",{className:l.nav,style:u.nav,children:[!s.hidePrevious&&e.jsx(Ci,{name:"previous-month","aria-label":g,className:v,style:u.nav_button_previous,disabled:!s.previousMonth,onClick:s.onPreviousClick,children:i==="rtl"?e.jsx(N,{className:l.nav_icon,style:u.nav_icon}):e.jsx(C,{className:l.nav_icon,style:u.nav_icon})}),!s.hideNext&&e.jsx(Ci,{name:"next-month","aria-label":j,className:b,style:u.nav_button_next,disabled:!s.nextMonth,onClick:s.onNextClick,children:i==="rtl"?e.jsx(C,{className:l.nav_icon,style:u.nav_icon}):e.jsx(N,{className:l.nav_icon,style:u.nav_icon})})]})}function Of(s){var r=ct().numberOfMonths,a=uo(),o=a.previousMonth,i=a.nextMonth,d=a.goToMonth,l=a.displayMonths,u=l.findIndex(function(j){return ed(s.displayMonth,j)}),m=u===0,h=u===l.length-1,x=r>1&&(m||!h),p=r>1&&(h||!m),g=function(){o&&d(o)},v=function(){i&&d(i)};return e.jsx(bE,{displayMonth:s.displayMonth,hideNext:x,hidePrevious:p,nextMonth:i,previousMonth:o,onPreviousClick:g,onNextClick:v})}function NE(s){var r,a=ct(),o=a.classNames,i=a.disableNavigation,d=a.styles,l=a.captionLayout,u=a.components,m=(r=u==null?void 0:u.CaptionLabel)!==null&&r!==void 0?r:Fp,h;return i?h=e.jsx(m,{id:s.id,displayMonth:s.displayMonth}):l==="dropdown"?h=e.jsx(kf,{displayMonth:s.displayMonth,id:s.id}):l==="dropdown-buttons"?h=e.jsxs(e.Fragment,{children:[e.jsx(kf,{displayMonth:s.displayMonth,displayIndex:s.displayIndex,id:s.id}),e.jsx(Of,{displayMonth:s.displayMonth,displayIndex:s.displayIndex,id:s.id})]}):h=e.jsxs(e.Fragment,{children:[e.jsx(m,{id:s.id,displayMonth:s.displayMonth,displayIndex:s.displayIndex}),e.jsx(Of,{displayMonth:s.displayMonth,id:s.id})]}),e.jsx("div",{className:o.caption,style:d.caption,children:h})}function wE(s){var r=ct(),a=r.footer,o=r.styles,i=r.classNames.tfoot;return a?e.jsx("tfoot",{className:i,style:o.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:a})})}):e.jsx(e.Fragment,{})}function SE(s,r,a){for(var o=a?td(new Date):Ia(new Date,{locale:s,weekStartsOn:r}),i=[],d=0;d<7;d++){var l=gt(o,d);i.push(l)}return i}function CE(){var s=ct(),r=s.classNames,a=s.styles,o=s.showWeekNumber,i=s.locale,d=s.weekStartsOn,l=s.ISOWeek,u=s.formatters.formatWeekdayName,m=s.labels.labelWeekday,h=SE(i,d,l);return e.jsxs("tr",{style:a.head_row,className:r.head_row,children:[o&&e.jsx("td",{style:a.head_cell,className:r.head_cell}),h.map(function(x,p){return e.jsx("th",{scope:"col",className:r.head_cell,style:a.head_cell,"aria-label":m(x,{locale:i}),children:u(x,{locale:i})},p)})]})}function EE(){var s,r=ct(),a=r.classNames,o=r.styles,i=r.components,d=(s=i==null?void 0:i.HeadRow)!==null&&s!==void 0?s:CE;return e.jsx("thead",{style:o.head,className:a.head,children:e.jsx(d,{})})}function DE(s){var r=ct(),a=r.locale,o=r.formatters.formatDay;return e.jsx(e.Fragment,{children:o(s.date,{locale:a})})}var pd=f.createContext(void 0);function TE(s){if(!lo(s.initialProps)){var r={selected:void 0,modifiers:{disabled:[]}};return e.jsx(pd.Provider,{value:r,children:s.children})}return e.jsx(_E,{initialProps:s.initialProps,children:s.children})}function _E(s){var r=s.initialProps,a=s.children,o=r.selected,i=r.min,d=r.max,l=function(h,x,p){var g,v;(g=r.onDayClick)===null||g===void 0||g.call(r,h,x,p);var j=!!(x.selected&&i&&(o==null?void 0:o.length)===i);if(!j){var b=!!(!x.selected&&d&&(o==null?void 0:o.length)===d);if(!b){var N=o?Lp([],o):[];if(x.selected){var C=N.findIndex(function(S){return Ht(h,S)});N.splice(C,1)}else N.push(h);(v=r.onSelect)===null||v===void 0||v.call(r,N,h,x,p)}}},u={disabled:[]};o&&u.disabled.push(function(h){var x=d&&o.length>d-1,p=o.some(function(g){return Ht(g,h)});return!!(x&&!p)});var m={selected:o,onDayClick:l,modifiers:u};return e.jsx(pd.Provider,{value:m,children:a})}function xd(){var s=f.useContext(pd);if(!s)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return s}function AE(s,r){var a=r||{},o=a.from,i=a.to;return o&&i?Ht(i,s)&&Ht(o,s)?void 0:Ht(i,s)?{from:i,to:void 0}:Ht(o,s)?void 0:Mc(o,s)?{from:s,to:i}:{from:o,to:s}:i?Mc(s,i)?{from:i,to:s}:{from:s,to:i}:o?Ft(s,o)?{from:s,to:o}:{from:o,to:s}:{from:s,to:void 0}}var gd=f.createContext(void 0);function kE(s){if(!co(s.initialProps)){var r={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(gd.Provider,{value:r,children:s.children})}return e.jsx(OE,{initialProps:s.initialProps,children:s.children})}function OE(s){var r=s.initialProps,a=s.children,o=r.selected,i=o||{},d=i.from,l=i.to,u=r.min,m=r.max,h=function(v,j,b){var N,C;(N=r.onDayClick)===null||N===void 0||N.call(r,v,j,b);var S=AE(v,o);(C=r.onSelect)===null||C===void 0||C.call(r,S,v,j,b)},x={range_start:[],range_end:[],range_middle:[],disabled:[]};if(d?(x.range_start=[d],l?(x.range_end=[l],Ht(d,l)||(x.range_middle=[{after:d,before:l}])):x.range_end=[d]):l&&(x.range_start=[l],x.range_end=[l]),u&&(d&&!l&&x.disabled.push({after:pi(d,u-1),before:gt(d,u-1)}),d&&l&&x.disabled.push({after:d,before:gt(d,u-1)}),!d&&l&&x.disabled.push({after:pi(l,u-1),before:gt(l,u-1)})),m){if(d&&!l&&(x.disabled.push({before:gt(d,-m+1)}),x.disabled.push({after:gt(d,m-1)})),d&&l){var p=Oa(l,d)+1,g=m-p;x.disabled.push({before:pi(d,g)}),x.disabled.push({after:gt(l,g)})}!d&&l&&(x.disabled.push({before:gt(l,-m+1)}),x.disabled.push({after:gt(l,m-1)}))}return e.jsx(gd.Provider,{value:{selected:o,onDayClick:h,modifiers:x},children:a})}function vd(){var s=f.useContext(gd);if(!s)throw new Error("useSelectRange must be used within a SelectRangeProvider");return s}function xi(s){return Array.isArray(s)?Lp([],s):s!==void 0?[s]:[]}function PE(s){var r={};return Object.entries(s).forEach(function(a){var o=a[0],i=a[1];r[o]=xi(i)}),r}var aa;(function(s){s.Outside="outside",s.Disabled="disabled",s.Selected="selected",s.Hidden="hidden",s.Today="today",s.RangeStart="range_start",s.RangeEnd="range_end",s.RangeMiddle="range_middle"})(aa||(aa={}));var ME=aa.Selected,Ta=aa.Disabled,RE=aa.Hidden,IE=aa.Today,Nc=aa.RangeEnd,wc=aa.RangeMiddle,Sc=aa.RangeStart,$E=aa.Outside;function LE(s,r,a){var o,i=(o={},o[ME]=xi(s.selected),o[Ta]=xi(s.disabled),o[RE]=xi(s.hidden),o[IE]=[s.today],o[Nc]=[],o[wc]=[],o[Sc]=[],o[$E]=[],o);return s.fromDate&&i[Ta].push({before:s.fromDate}),s.toDate&&i[Ta].push({after:s.toDate}),lo(s)?i[Ta]=i[Ta].concat(r.modifiers[Ta]):co(s)&&(i[Ta]=i[Ta].concat(a.modifiers[Ta]),i[Sc]=a.modifiers[Sc],i[wc]=a.modifiers[wc],i[Nc]=a.modifiers[Nc]),i}var Bp=f.createContext(void 0);function zE(s){var r=ct(),a=xd(),o=vd(),i=LE(r,a,o),d=PE(r.modifiers),l=ve(ve({},i),d);return e.jsx(Bp.Provider,{value:l,children:s.children})}function Up(){var s=f.useContext(Bp);if(!s)throw new Error("useModifiers must be used within a ModifiersProvider");return s}function FE(s){return!!(s&&typeof s=="object"&&"before"in s&&"after"in s)}function HE(s){return!!(s&&typeof s=="object"&&"from"in s)}function WE(s){return!!(s&&typeof s=="object"&&"after"in s)}function BE(s){return!!(s&&typeof s=="object"&&"before"in s)}function UE(s){return!!(s&&typeof s=="object"&&"dayOfWeek"in s)}function qE(s,r){var a,o=r.from,i=r.to;if(o&&i){var d=Oa(i,o)<0;d&&(a=[i,o],o=a[0],i=a[1]);var l=Oa(s,o)>=0&&Oa(i,s)>=0;return l}return i?Ht(i,s):o?Ht(o,s):!1}function VE(s){return Mh(s)}function YE(s){return Array.isArray(s)&&s.every(Mh)}function GE(s,r){return r.some(function(a){if(typeof a=="boolean")return a;if(VE(a))return Ht(s,a);if(YE(a))return a.includes(s);if(HE(a))return qE(s,a);if(UE(a))return a.dayOfWeek.includes(s.getDay());if(FE(a)){var o=Oa(a.before,s),i=Oa(a.after,s),d=o>0,l=i<0,u=Mc(a.before,a.after);return u?l&&d:d||l}return WE(a)?Oa(s,a.after)>0:BE(a)?Oa(a.before,s)>0:typeof a=="function"?a(s):!1})}function yd(s,r,a){var o=Object.keys(r).reduce(function(d,l){var u=r[l];return GE(s,u)&&d.push(l),d},[]),i={};return o.forEach(function(d){return i[d]=!0}),a&&!ed(s,a)&&(i.outside=!0),i}function KE(s,r){for(var a=Qe(s[0]),o=vs(s[s.length-1]),i,d,l=a;l<=o;){var u=yd(l,r),m=!u.disabled&&!u.hidden;if(!m){l=gt(l,1);continue}if(u.selected)return l;u.today&&!d&&(d=l),i||(i=l),l=gt(l,1)}return d||i}var JE=365;function qp(s,r){var a=r.moveBy,o=r.direction,i=r.context,d=r.modifiers,l=r.retry,u=l===void 0?{count:0,lastFocused:s}:l,m=i.weekStartsOn,h=i.fromDate,x=i.toDate,p=i.locale,g={day:gt,week:Vr,month:sa,year:v1,startOfWeek:function(N){return i.ISOWeek?td(N):Ia(N,{locale:p,weekStartsOn:m})},endOfWeek:function(N){return i.ISOWeek?Ph(N):ea(N,{locale:p,weekStartsOn:m})}},v=g[a](s,o==="after"?1:-1);o==="before"&&h?v=h1([h,v]):o==="after"&&x&&(v=p1([x,v]));var j=!0;if(d){var b=yd(v,d);j=!b.disabled&&!b.hidden}return j?v:u.count>JE?u.lastFocused:qp(v,{moveBy:a,direction:o,context:i,modifiers:d,retry:ve(ve({},u),{count:u.count+1})})}var Vp=f.createContext(void 0);function XE(s){var r=uo(),a=Up(),o=f.useState(),i=o[0],d=o[1],l=f.useState(),u=l[0],m=l[1],h=KE(r.displayMonths,a),x=i??(u&&r.isDateDisplayed(u))?u:h,p=function(){m(i),d(void 0)},g=function(N){d(N)},v=ct(),j=function(N,C){if(i){var S=qp(i,{moveBy:N,direction:C,context:v,modifiers:a});Ht(i,S)||(r.goToDate(S,i),g(S))}},b={focusedDay:i,focusTarget:x,blur:p,focus:g,focusDayAfter:function(){return j("day","after")},focusDayBefore:function(){return j("day","before")},focusWeekAfter:function(){return j("week","after")},focusWeekBefore:function(){return j("week","before")},focusMonthBefore:function(){return j("month","before")},focusMonthAfter:function(){return j("month","after")},focusYearBefore:function(){return j("year","before")},focusYearAfter:function(){return j("year","after")},focusStartOfWeek:function(){return j("startOfWeek","before")},focusEndOfWeek:function(){return j("endOfWeek","after")}};return e.jsx(Vp.Provider,{value:b,children:s.children})}function jd(){var s=f.useContext(Vp);if(!s)throw new Error("useFocusContext must be used within a FocusProvider");return s}function ZE(s,r){var a=Up(),o=yd(s,a,r);return o}var bd=f.createContext(void 0);function QE(s){if(!Yi(s.initialProps)){var r={selected:void 0};return e.jsx(bd.Provider,{value:r,children:s.children})}return e.jsx(eD,{initialProps:s.initialProps,children:s.children})}function eD(s){var r=s.initialProps,a=s.children,o=function(d,l,u){var m,h,x;if((m=r.onDayClick)===null||m===void 0||m.call(r,d,l,u),l.selected&&!r.required){(h=r.onSelect)===null||h===void 0||h.call(r,void 0,d,l,u);return}(x=r.onSelect)===null||x===void 0||x.call(r,d,d,l,u)},i={selected:r.selected,onDayClick:o};return e.jsx(bd.Provider,{value:i,children:a})}function Yp(){var s=f.useContext(bd);if(!s)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return s}function tD(s,r){var a=ct(),o=Yp(),i=xd(),d=vd(),l=jd(),u=l.focusDayAfter,m=l.focusDayBefore,h=l.focusWeekAfter,x=l.focusWeekBefore,p=l.blur,g=l.focus,v=l.focusMonthBefore,j=l.focusMonthAfter,b=l.focusYearBefore,N=l.focusYearAfter,C=l.focusStartOfWeek,S=l.focusEndOfWeek,_=function(J){var te,me,Ce,_e;Yi(a)?(te=o.onDayClick)===null||te===void 0||te.call(o,s,r,J):lo(a)?(me=i.onDayClick)===null||me===void 0||me.call(i,s,r,J):co(a)?(Ce=d.onDayClick)===null||Ce===void 0||Ce.call(d,s,r,J):(_e=a.onDayClick)===null||_e===void 0||_e.call(a,s,r,J)},A=function(J){var te;g(s),(te=a.onDayFocus)===null||te===void 0||te.call(a,s,r,J)},k=function(J){var te;p(),(te=a.onDayBlur)===null||te===void 0||te.call(a,s,r,J)},D=function(J){var te;(te=a.onDayMouseEnter)===null||te===void 0||te.call(a,s,r,J)},P=function(J){var te;(te=a.onDayMouseLeave)===null||te===void 0||te.call(a,s,r,J)},M=function(J){var te;(te=a.onDayPointerEnter)===null||te===void 0||te.call(a,s,r,J)},$=function(J){var te;(te=a.onDayPointerLeave)===null||te===void 0||te.call(a,s,r,J)},W=function(J){var te;(te=a.onDayTouchCancel)===null||te===void 0||te.call(a,s,r,J)},I=function(J){var te;(te=a.onDayTouchEnd)===null||te===void 0||te.call(a,s,r,J)},B=function(J){var te;(te=a.onDayTouchMove)===null||te===void 0||te.call(a,s,r,J)},H=function(J){var te;(te=a.onDayTouchStart)===null||te===void 0||te.call(a,s,r,J)},U=function(J){var te;(te=a.onDayKeyUp)===null||te===void 0||te.call(a,s,r,J)},ee=function(J){var te;switch(J.key){case"ArrowLeft":J.preventDefault(),J.stopPropagation(),a.dir==="rtl"?u():m();break;case"ArrowRight":J.preventDefault(),J.stopPropagation(),a.dir==="rtl"?m():u();break;case"ArrowDown":J.preventDefault(),J.stopPropagation(),h();break;case"ArrowUp":J.preventDefault(),J.stopPropagation(),x();break;case"PageUp":J.preventDefault(),J.stopPropagation(),J.shiftKey?b():v();break;case"PageDown":J.preventDefault(),J.stopPropagation(),J.shiftKey?N():j();break;case"Home":J.preventDefault(),J.stopPropagation(),C();break;case"End":J.preventDefault(),J.stopPropagation(),S();break}(te=a.onDayKeyDown)===null||te===void 0||te.call(a,s,r,J)},re={onClick:_,onFocus:A,onBlur:k,onKeyDown:ee,onKeyUp:U,onMouseEnter:D,onMouseLeave:P,onPointerEnter:M,onPointerLeave:$,onTouchCancel:W,onTouchEnd:I,onTouchMove:B,onTouchStart:H};return re}function sD(){var s=ct(),r=Yp(),a=xd(),o=vd(),i=Yi(s)?r.selected:lo(s)?a.selected:co(s)?o.selected:void 0;return i}function aD(s){return Object.values(aa).includes(s)}function nD(s,r){var a=[s.classNames.day];return Object.keys(r).forEach(function(o){var i=s.modifiersClassNames[o];if(i)a.push(i);else if(aD(o)){var d=s.classNames["day_".concat(o)];d&&a.push(d)}}),a}function rD(s,r){var a=ve({},s.styles.day);return Object.keys(r).forEach(function(o){var i;a=ve(ve({},a),(i=s.modifiersStyles)===null||i===void 0?void 0:i[o])}),a}function oD(s,r,a){var o,i,d,l=ct(),u=jd(),m=ZE(s,r),h=tD(s,m),x=sD(),p=!!(l.onDayClick||l.mode!=="default");f.useEffect(function(){var D;m.outside||u.focusedDay&&p&&Ht(u.focusedDay,s)&&((D=a.current)===null||D===void 0||D.focus())},[u.focusedDay,s,a,p,m.outside]);var g=nD(l,m).join(" "),v=rD(l,m),j=!!(m.outside&&!l.showOutsideDays||m.hidden),b=(d=(i=l.components)===null||i===void 0?void 0:i.DayContent)!==null&&d!==void 0?d:DE,N=e.jsx(b,{date:s,displayMonth:r,activeModifiers:m}),C={style:v,className:g,children:N,role:"gridcell"},S=u.focusTarget&&Ht(u.focusTarget,s)&&!m.outside,_=u.focusedDay&&Ht(u.focusedDay,s),A=ve(ve(ve({},C),(o={disabled:m.disabled,role:"gridcell"},o["aria-selected"]=m.selected,o.tabIndex=_||S?0:-1,o)),h),k={isButton:p,isHidden:j,activeModifiers:m,selectedDays:x,buttonProps:A,divProps:C};return k}function iD(s){var r=f.useRef(null),a=oD(s.date,s.displayMonth,r);return a.isHidden?e.jsx("div",{role:"gridcell"}):a.isButton?e.jsx(Ci,ve({name:"day",ref:r},a.buttonProps)):e.jsx("div",ve({},a.divProps))}function lD(s){var r=s.number,a=s.dates,o=ct(),i=o.onWeekNumberClick,d=o.styles,l=o.classNames,u=o.locale,m=o.labels.labelWeekNumber,h=o.formatters.formatWeekNumber,x=h(Number(r),{locale:u});if(!i)return e.jsx("span",{className:l.weeknumber,style:d.weeknumber,children:x});var p=m(Number(r),{locale:u}),g=function(v){i(r,a,v)};return e.jsx(Ci,{name:"week-number","aria-label":p,className:l.weeknumber,style:d.weeknumber,onClick:g,children:x})}function cD(s){var r,a,o=ct(),i=o.styles,d=o.classNames,l=o.showWeekNumber,u=o.components,m=(r=u==null?void 0:u.Day)!==null&&r!==void 0?r:iD,h=(a=u==null?void 0:u.WeekNumber)!==null&&a!==void 0?a:lD,x;return l&&(x=e.jsx("td",{className:d.cell,style:i.cell,children:e.jsx(h,{number:s.weekNumber,dates:s.dates})})),e.jsxs("tr",{className:d.row,style:i.row,children:[x,s.dates.map(function(p){return e.jsx("td",{className:d.cell,style:i.cell,role:"presentation",children:e.jsx(m,{displayMonth:s.displayMonth,date:p})},d1(p))})]})}function Pf(s,r,a){for(var o=a!=null&&a.ISOWeek?Ph(r):ea(r,a),i=a!=null&&a.ISOWeek?td(s):Ia(s,a),d=Oa(o,i),l=[],u=0;u<=d;u++)l.push(gt(i,u));var m=l.reduce(function(h,x){var p=a!=null&&a.ISOWeek?x1(x):g1(x,a),g=h.find(function(v){return v.weekNumber===p});return g?(g.dates.push(x),h):(h.push({weekNumber:p,dates:[x]}),h)},[]);return m}function dD(s,r){var a=Pf(Qe(s),vs(s),r);if(r!=null&&r.useFixedWeeks){var o=u1(s,r);if(o<6){var i=a[a.length-1],d=i.dates[i.dates.length-1],l=Vr(d,6-o),u=Pf(Vr(d,1),l,r);a.push.apply(a,u)}}return a}function uD(s){var r,a,o,i=ct(),d=i.locale,l=i.classNames,u=i.styles,m=i.hideHead,h=i.fixedWeeks,x=i.components,p=i.weekStartsOn,g=i.firstWeekContainsDate,v=i.ISOWeek,j=dD(s.displayMonth,{useFixedWeeks:!!h,ISOWeek:v,locale:d,weekStartsOn:p,firstWeekContainsDate:g}),b=(r=x==null?void 0:x.Head)!==null&&r!==void 0?r:EE,N=(a=x==null?void 0:x.Row)!==null&&a!==void 0?a:cD,C=(o=x==null?void 0:x.Footer)!==null&&o!==void 0?o:wE;return e.jsxs("table",{id:s.id,className:l.table,style:u.table,role:"grid","aria-labelledby":s["aria-labelledby"],children:[!m&&e.jsx(b,{}),e.jsx("tbody",{className:l.tbody,style:u.tbody,children:j.map(function(S){return e.jsx(N,{displayMonth:s.displayMonth,dates:S.dates,weekNumber:S.weekNumber},S.weekNumber)})}),e.jsx(C,{displayMonth:s.displayMonth})]})}function mD(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var fD=mD()?f.useLayoutEffect:f.useEffect,Cc=!1,hD=0;function Mf(){return"react-day-picker-".concat(++hD)}function pD(s){var r,a=s??(Cc?Mf():null),o=f.useState(a),i=o[0],d=o[1];return fD(function(){i===null&&d(Mf())},[]),f.useEffect(function(){Cc===!1&&(Cc=!0)},[]),(r=s??i)!==null&&r!==void 0?r:void 0}function xD(s){var r,a,o=ct(),i=o.dir,d=o.classNames,l=o.styles,u=o.components,m=uo().displayMonths,h=pD(o.id?"".concat(o.id,"-").concat(s.displayIndex):void 0),x=o.id?"".concat(o.id,"-grid-").concat(s.displayIndex):void 0,p=[d.month],g=l.month,v=s.displayIndex===0,j=s.displayIndex===m.length-1,b=!v&&!j;i==="rtl"&&(r=[v,j],j=r[0],v=r[1]),v&&(p.push(d.caption_start),g=ve(ve({},g),l.caption_start)),j&&(p.push(d.caption_end),g=ve(ve({},g),l.caption_end)),b&&(p.push(d.caption_between),g=ve(ve({},g),l.caption_between));var N=(a=u==null?void 0:u.Caption)!==null&&a!==void 0?a:NE;return e.jsxs("div",{className:p.join(" "),style:g,children:[e.jsx(N,{id:h,displayMonth:s.displayMonth,displayIndex:s.displayIndex}),e.jsx(uD,{id:x,"aria-labelledby":h,displayMonth:s.displayMonth})]},s.displayIndex)}function gD(s){var r=ct(),a=r.classNames,o=r.styles;return e.jsx("div",{className:a.months,style:o.months,children:s.children})}function vD(s){var r,a,o=s.initialProps,i=ct(),d=jd(),l=uo(),u=f.useState(!1),m=u[0],h=u[1];f.useEffect(function(){i.initialFocus&&d.focusTarget&&(m||(d.focus(d.focusTarget),h(!0)))},[i.initialFocus,m,d.focus,d.focusTarget,d]);var x=[i.classNames.root,i.className];i.numberOfMonths>1&&x.push(i.classNames.multiple_months),i.showWeekNumber&&x.push(i.classNames.with_weeknumber);var p=ve(ve({},i.styles.root),i.style),g=Object.keys(o).filter(function(j){return j.startsWith("data-")}).reduce(function(j,b){var N;return ve(ve({},j),(N={},N[b]=o[b],N))},{}),v=(a=(r=o.components)===null||r===void 0?void 0:r.Months)!==null&&a!==void 0?a:gD;return e.jsx("div",ve({className:x.join(" "),style:p,dir:i.dir,id:i.id,nonce:o.nonce,title:o.title,lang:o.lang},g,{children:e.jsx(v,{children:l.displayMonths.map(function(j,b){return e.jsx(xD,{displayIndex:b,displayMonth:j},b)})})}))}function yD(s){var r=s.children,a=B2(s,["children"]);return e.jsx(lE,{initialProps:a,children:e.jsx(vE,{children:e.jsx(QE,{initialProps:a,children:e.jsx(TE,{initialProps:a,children:e.jsx(kE,{initialProps:a,children:e.jsx(zE,{children:e.jsx(XE,{children:r})})})})})})})}function jD(s){return e.jsx(yD,ve({},s,{children:e.jsx(vD,{initialProps:s})}))}function Gi({className:s,classNames:r,showOutsideDays:a=!0,components:o,...i}){return e.jsx(jD,{showOutsideDays:a,className:Z("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Z(Jr({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Z(Jr({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:()=>e.jsx($h,{className:"h-4 w-4"}),IconRight:()=>e.jsx(Mn,{className:"h-4 w-4"}),...o},...i})}Gi.displayName="Calendar";const bD=({selectedDate:s,goal:r=2500})=>{const[a,o]=f.useState(Qe(s));f.useEffect(()=>{o(Qe(s))},[s]);const i=f.useMemo(()=>Qe(a),[a]),d=f.useMemo(()=>vs(a),[a]),{stats:l,loading:u}=gp(i,d),m=f.useMemo(()=>{const x={};return l==null||l.dailyStats.forEach(({date:p,intake:g})=>{x[p]=g}),x},[l]),h=x=>{const p=pe(x.date),g=m[p]||0,v=Math.min(g/r,1),j=28,b=3,N=(j-b)/2,C=2*Math.PI*N,S=C-v*C,_=g>=r;return e.jsxs("div",{className:"relative flex items-center justify-center w-7 h-7",children:[e.jsxs("svg",{width:j,height:j,className:"absolute",children:[e.jsx("circle",{cx:j/2,cy:j/2,r:N,stroke:_?"#bfdbfe":"#e5e7eb",strokeWidth:b,fill:"none"}),e.jsx("circle",{cx:j/2,cy:j/2,r:N,stroke:_?"#3b82f6":"#9ca3af",strokeWidth:b,fill:"none",strokeDasharray:C,strokeDashoffset:S,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),e.jsx("span",{className:"text-[10px] font-medium z-10",children:x.date.getDate()})]})};return e.jsxs(se,{className:"w-full",children:[e.jsxs(Oe,{className:"flex flex-col items-center gap-2",children:[e.jsx(no,{className:"w-5 h-5 text-blue-600"}),e.jsx(Pe,{className:"text-center",children:"Historial Mensual"})]}),e.jsxs(ae,{className:"relative p-4",children:[u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 z-10",children:e.jsx(Wt,{className:"w-6 h-6 animate-spin"})}),e.jsx(Gi,{month:a,onMonthChange:o,showOutsideDays:!0,components:{DayContent:h},className:"p-0 w-full"})]})]})},Gp=({selectedDate:s})=>{const[r,a]=f.useState(null),[o,i]=f.useState(!1),{user:d}=Se(),l=2e3,{intake:u,drinks:m,status:h,error:x,addDrink:p,editDrink:g,deleteDrink:v}=W2(s);if(!d)return e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tu hidratación"})})});const j=pe(s)===pe(new Date);return e.jsx(se,{className:"w-full shadow-sm border-0 bg-gradient-to-br from-white to-blue-50/30",children:e.jsx(ae,{className:"p-6 md:p-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(b2,{intake:u,goal:l}),j&&e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:e.jsx(z2,{selectedDrink:r,onDrinkSelect:a,onAmountSelect:(b,N)=>{p(b,N),a(null)},disabled:h==="saving"})}),e.jsx(H2,{drinks:m,showHistory:o,onToggleHistory:()=>i(!o),onDeleteDrink:v,onEditDrink:g,isCurrentDate:j}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 shadow-sm",children:e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex-shrink-0"}),x]})}),h==="saving"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow-sm",children:e.jsxs("p",{className:"text-sm text-blue-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin flex-shrink-0"}),"Guardando tu progreso..."]})})]})})})},ND=s=>{const[r,a]=f.useState(null),[o,i]=f.useState(!0),[d,l]=f.useState(null),{user:u}=Se();return f.useEffect(()=>{(async()=>{if(u){i(!0),l(null);try{const h=[];for(let _=6;_>=0;_--){const A=new Date(s);A.setDate(A.getDate()-_),h.push(pe(A))}const x=await Promise.all(h.map(async _=>{const A=ue(ne,"water",`${u.uid}_${_}`),k=await Ot(A);return k.exists()?{date:_,drinks:k.data().drinks||[],totalWater:k.data().totalWater||0}:{date:_,drinks:[],totalWater:0}})),p=Lt.sumBy(x,"totalWater"),g=p/7,v=x.flatMap(_=>_.drinks),j=Lt.groupBy(v,"type"),b=Object.entries(j).map(([_,A])=>({type:_,count:A.length,totalAmount:Lt.sumBy(A,"amount"),percentage:Lt.sumBy(A,"amount")/p*100||0})).sort((_,A)=>A.count-_.count),N=Lt.groupBy(v,_=>Jt[_.type].category),C=Object.entries(N).map(([_,A])=>({category:_,totalAmount:Lt.sumBy(A,"amount"),percentage:Lt.sumBy(A,"amount")/p*100||0})).sort((_,A)=>A.totalAmount-_.totalAmount),S=x.map(_=>({date:_.date,intake:_.totalWater}));a({totalIntake:p,avgDailyIntake:g,commonDrinks:b,dailyIntake:S,categoryStats:C})}catch(h){console.error("Error al cargar estadísticas:",h),l(h instanceof Error?h.message:"Error al cargar estadísticas")}finally{i(!1)}}})()},[u,s]),{stats:r,loading:o,error:d}},Rf=["#60A5FA","#34D399","#A78BFA","#F87171","#FBBF24","#A3E635"],wD=({selectedDate:s})=>{const{stats:r,loading:a,error:o}=ND(s);return a?e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"flex items-center justify-center p-6",children:e.jsx(Wt,{className:"w-6 h-6 animate-spin"})})}):o||!r?e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-6",children:e.jsx("p",{className:"text-red-500",children:"Error al cargar estadísticas"})})}):e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(se,{className:"w-full",children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Consumo Diario"})}),e.jsxs(ae,{children:[e.jsx("div",{className:"h-64",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs($i,{data:r.dailyIntake,children:[e.jsx(gs,{dataKey:"date",tickFormatter:i=>new Date(i).toLocaleDateString("es-ES",{weekday:"short"})}),e.jsx(as,{tickFormatter:i=>`${i}ml`}),e.jsx(bt,{formatter:i=>[`${i}ml`,"Consumo"],labelFormatter:i=>new Date(i).toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"short"})}),e.jsx(Kr,{dataKey:"intake",fill:"#60A5FA"})]})})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-500 text-center",children:["Promedio diario: ",Math.round(r.avgDailyIntake),"ml"]})]})]}),e.jsxs(se,{className:"w-full",children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Distribución por Categoría"})}),e.jsx(ae,{children:e.jsx("div",{className:"h-64",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Rn,{children:[e.jsx(In,{data:r.categoryStats,dataKey:"totalAmount",nameKey:"category",cx:"50%",cy:"50%",outerRadius:80,label:({category:i})=>Xr[i],children:r.categoryStats.map((i,d)=>e.jsx($n,{fill:Rf[d%Rf.length]},i.category))}),e.jsx(bt,{formatter:i=>[`${i}ml`,"Cantidad"],labelFormatter:i=>Xr[i]})]})})})})]}),e.jsxs(se,{className:"w-full md:col-span-2",children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Bebidas Más Consumidas"})}),e.jsxs(ae,{children:["          ",e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:[" ",r.commonDrinks.slice(0,6).map(i=>{const d=Jt[i.type],l=mn[d.icon];return e.jsxs("div",{className:"flex flex-col items-center p-4 rounded-lg bg-muted text-center",children:[e.jsx(l,{className:`w-6 h-6 ${d.color} mb-2 flex-shrink-0`}),e.jsx("span",{className:"font-medium text-sm leading-tight",children:d.name})," ",e.jsxs("span",{className:"text-sm text-muted-foreground mt-1",children:[" ",i.totalAmount,"ml"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[" ",i.count," veces"]})]},i.type)})]})]})]})]})},Et=({children:s,className:r,fullHeight:a=!1,noPadding:o=!1,showFloatingButton:i=!1,onFloatingButtonClick:d,floatingButtonLabel:l="Agregar"})=>o?e.jsxs("div",{className:Z("h-full",r),children:[s,i&&e.jsx(F,{onClick:d,className:"fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow z-50 md:hidden",size:"icon",title:l,children:e.jsx(ys,{className:"h-6 w-6"})})]}):e.jsxs("div",{className:Z(a?"h-full flex flex-col":"min-h-full","px-3 sm:px-4 md:px-6 lg:px-8 xl:px-12 2xl:px-16","pt-4 md:pt-6 lg:pt-8","pb-4 md:pb-6 lg:pb-8",r),children:[e.jsx("div",{className:Z(a?"flex-1 flex flex-col":"","space-y-4 sm:space-y-6 md:space-y-8 lg:space-y-10","max-w-screen-2xl mx-auto w-full","container-wide"),children:s}),i&&e.jsx(F,{onClick:d,className:"fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow z-50 md:hidden",size:"icon",title:l,children:e.jsx(ys,{className:"h-6 w-6"})})]}),ra=Gw,$s=f.forwardRef(({className:s,...r},a)=>e.jsx(vh,{ref:a,className:Z("inline-flex h-10 md:h-12 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground w-full md:w-auto overflow-x-auto",s),...r}));$s.displayName=vh.displayName;const nt=f.forwardRef(({className:s,...r},a)=>e.jsx(yh,{ref:a,className:Z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 md:px-4 md:py-2 text-sm md:text-base font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm touch-manipulation active:scale-95 min-w-0 flex-1 md:flex-initial",s),...r}));nt.displayName=yh.displayName;const rt=f.forwardRef(({className:s,...r},a)=>e.jsx(jh,{ref:a,className:Z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r}));rt.displayName=jh.displayName;const SD=()=>{const[s,r]=f.useState(new Date),[a,o]=f.useState(new Date),[i,d]=f.useState(new Date),{user:l}=Se(),u=(m,h)=>{o(m),d(h)};return l?e.jsxs(Et,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Control de Hidratación"}),e.jsx("p",{className:"text-gray-500",children:"Registra y monitorea tu consumo diario de agua"})]}),e.jsxs(ra,{defaultValue:"daily",className:"w-full",children:[e.jsxs($s,{className:"mb-6",children:[e.jsx(nt,{value:"daily",children:"Registro Diario"}),e.jsx(nt,{value:"stats",children:"Estadísticas"})]}),e.jsxs(rt,{value:"daily",children:[e.jsx(xa,{selectedDate:s,onChange:r}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[1fr_300px]",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(Gp,{selectedDate:s}),e.jsx(wD,{selectedDate:s})]}),e.jsx("div",{children:e.jsx(bD,{selectedDate:s})})]})]}),e.jsxs(rt,{value:"stats",children:[e.jsx(kC,{onPeriodChange:u}),e.jsx(u2,{startDate:a,endDate:i})]})]})]}):e.jsx(Et,{children:e.jsx(se,{children:e.jsx(ae,{className:"p-6",children:e.jsx("p",{className:"text-center",children:"Inicia sesión para ver tus estadísticas de hidratación"})})})})},ui=crypto.randomUUID(),_a=30*60,CD=({onComplete:s,onCancel:r,selectedDate:a})=>{const{user:o}=Se(),[i,d]=f.useState(_a),[l,u]=f.useState(!1),[m,h]=f.useState(null),[x,p]=f.useState(!1),g=f.useRef(),v=f.useRef(!1),j=pe(a||new Date),b=f.useCallback(()=>{g.current&&(cancelAnimationFrame(g.current),g.current=void 0)},[]),N=f.useCallback(()=>{v.current||(v.current=!0,b(),d(_a),u(!1),h(null),p(!1),setTimeout(()=>{v.current=!1},100))},[b]),C=f.useCallback(k=>{const D=(Date.now()-k)/1e3;return Math.max(0,_a-D)},[]);f.useEffect(()=>{if(!l||!m||x){b();return}const k=m.startTime.timestamp,D=()=>{const P=(Date.now()-k)/1e3,M=Math.max(0,_a-P);if(M<=0){b(),m.deviceId===ui&&s(_a),N();return}d(M),g.current=requestAnimationFrame(D)};return g.current=requestAnimationFrame(D),b},[l,m,x,b,N,s,C]),f.useEffect(()=>{if(!o)return;const k=ue(ne,"pomodoro",`${o.uid}_${j}`),D=ht(k,P=>{if(!P.exists()){N();return}const $=P.data().activePomodoro;if(!$||x){N();return}if($.deviceId!==ui&&!l)return;const W=C($.startTime.timestamp);if(W<=0){et(k,{activePomodoro:null},{merge:!0}),$.deviceId===ui&&s(_a),N();return}h($),d(W),u(!0)});return()=>{D(),b()}},[o,j,l,x,C,b,N,s]);const S=f.useCallback(async()=>{if(!o||l)return;const k=new Date,P={startTime:Kt(a||k,k.getHours(),k.getMinutes()),duration:_a,deviceId:ui};h(P),d(_a),u(!0),p(!1);try{const M=ue(ne,"pomodoro",`${o.uid}_${j}`);await et(M,{activePomodoro:P,updatedAt:Be()},{merge:!0})}catch(M){console.error("Error starting timer:",M),N()}},[o,j,l,a,N]),_=f.useCallback(async()=>{if(!(!o||!m||x))try{p(!0);const k=ue(ne,"pomodoro",`${o.uid}_${j}`);await et(k,{activePomodoro:null,updatedAt:Be()},{merge:!0});const D=_a-i;D>0&&r(D),N()}catch(k){console.error("Error stopping timer:",k),p(!1)}},[o,j,m,x,i,r,N]);return{time:i,isActive:l,formattedTime:(k=>{const D=Math.floor(k/60),P=Math.floor(k%60);return`${D<10?"0":""}${D}:${P<10?"0":""}${P}`})(i),startTimer:S,stopTimer:_}},ED=s=>{const[r,a]=f.useState(null),[o,i]=f.useState("idle"),[d,l]=f.useState(null),{user:u}=Se(),m=pe(s||new Date);f.useEffect(()=>{if(!u)return;const v=ue(ne,"pomodoro",`${u.uid}_${m}`),j=ht(v,b=>{if(b.exists()){const N=b.data(),C=N.sessions.filter(S=>S.completed).length;a({...N,count:C}),i("saved")}else a({userId:u.uid,date:m,count:0,sessions:[],updatedAt:null}),i("idle")},b=>{console.error("Pomodoro - Error en snapshot:",b),l(b.message),i("error")});return()=>j()},[u,m]);const h=async(v={})=>{var j;if(!(!u||!r)){i("saving"),l(null);try{const b=s||new Date,N=new Date,C=Kt(b,N.getHours(),N.getMinutes()),S=new Date(N.getTime()-30*60*1e3),_=Kt(b,S.getHours(),S.getMinutes()),A={startTime:{timestamp:_.timestamp,utcOffset:_.utcOffset,formatted:_.formatted},endTime:{timestamp:C.timestamp,utcOffset:C.utcOffset,formatted:C.formatted},duration:30*60,completed:!0};(j=v.description)!=null&&j.trim()&&(A.description=v.description.trim());const k=[...r.sessions,A].sort((W,I)=>I.startTime.timestamp-W.startTime.timestamp),{activePomodoro:D,...P}=r,M={...P,count:k.filter(W=>W.completed).length,sessions:k,updatedAt:Be()},$=ue(ne,"pomodoro",`${u.uid}_${m}`);await et($,M),i("saved")}catch(b){console.error("Pomodoro - Error al agregar sesión manual:",b),l(b instanceof Error?b.message:"Error al guardar"),i("error")}}},x=async(v,j,b={})=>{var N;if(!(!u||!r)){i("saving"),l(null);try{const C=s||new Date,S=new Date,_=Kt(C,S.getHours(),S.getMinutes()),A=new Date(S.getTime()-v*1e3),k=Kt(C,A.getHours(),A.getMinutes()),D={startTime:{timestamp:k.timestamp,utcOffset:k.utcOffset,formatted:k.formatted},endTime:{timestamp:_.timestamp,utcOffset:_.utcOffset,formatted:_.formatted},duration:v,completed:j};(N=b.description)!=null&&N.trim()&&(D.description=b.description.trim());const P=[...r.sessions,D],M=P.filter(H=>H.completed).length,{activePomodoro:$,...W}=r,I={...W,count:M,sessions:P,updatedAt:Be()},B=ue(ne,"pomodoro",`${u.uid}_${m}`);await et(B,I),i("saved")}catch(C){console.error("Pomodoro - Error al guardar:",C),l(C instanceof Error?C.message:"Error al guardar"),i("error")}}},p=async v=>{if(!(!u||!r)){i("saving"),l(null);try{const j=r.sessions.filter(_=>_.startTime.timestamp!==v.startTime.timestamp),{activePomodoro:b,...N}=r,C={...N,count:j.filter(_=>_.completed).length,sessions:j,updatedAt:Be()},S=ue(ne,"pomodoro",`${u.uid}_${m}`);await et(S,C),i("saved")}catch(j){console.error("Pomodoro - Error al eliminar sesión:",j),l(j instanceof Error?j.message:"Error al eliminar"),i("error")}}},g=async(v,j)=>{if(!(!u||!r)){i("saving"),l(null);try{const b=new Date(v.startTime.timestamp);let N=v.startTime,C=v.endTime;if(j.startTime){const D=new Date(j.startTime.timestamp),P=Kt(b,D.getHours(),D.getMinutes());N={timestamp:P.timestamp,utcOffset:P.utcOffset,formatted:P.formatted}}if(j.endTime){const D=new Date(j.endTime.timestamp),P=Kt(b,D.getHours(),D.getMinutes());C={timestamp:P.timestamp,utcOffset:P.utcOffset,formatted:P.formatted}}const S=(C.timestamp-N.timestamp)/1e3,_=r.sessions.map(D=>{var P;return D.startTime.timestamp===v.startTime.timestamp?{...D,startTime:N,endTime:C,duration:S,completed:j.completed??D.completed,...(P=j.description)!=null&&P.trim()?{description:j.description.trim()}:{}}:D}),A={...r,count:_.filter(D=>D.completed).length,sessions:_,updatedAt:Be()},k=ue(ne,"pomodoro",`${u.uid}_${m}`);await et(k,A),i("saved")}catch(b){console.error("Pomodoro - Error al editar sesión:",b),l(b instanceof Error?b.message:"Error al editar"),i("error")}}};return{count:(r==null?void 0:r.count)??0,sessions:(r==null?void 0:r.sessions)??[],status:o,error:d,saveSession:x,deleteSession:p,editSession:g,addManualSession:h}},DD=(s="week")=>{const[r,a]=f.useState(null),[o,i]=f.useState(!0),[d,l]=f.useState(null),{user:u}=Se();return f.useEffect(()=>{(async()=>{if(!u){i(!1);return}try{i(!0),l(null);const h=Zs(new Date),x=yt(s==="week"?pi(h,7):Wr(h,1)),p=y1({start:x,end:h}),g=[],v={};for(const S of p){const _=pe(S),A=ue(ne,"pomodoro",`${u.uid}_${_}`),k=await Ot(A);if(k.exists()){const D=k.data();g.push(...D.sessions);const P=D.sessions.filter(M=>M.completed).length;P>0&&(v[_]=P)}}if(g.length===0){a({totalSessions:0,completedSessions:0,totalTime:0,averageSessionTime:0,completionRate:0}),i(!1);return}const j=Object.entries(v).reduce((S,[_,A])=>A>S[1]?[_,A]:S,["",0]),b=g.filter(S=>S.completed),N=g.reduce((S,_)=>S+_.duration,0),C={totalSessions:g.length,completedSessions:b.length,totalTime:N,averageSessionTime:N/g.length,completionRate:b.length/g.length*100,...j[1]>0&&{bestDay:{date:vt(new Date(j[0]),"dd/MM/yyyy"),sessions:j[1]}}};a(C)}catch(h){console.error("Error fetching pomodoro stats:",h),l(h instanceof Error?h.message:"Error al cargar las estadísticas")}finally{i(!1)}})()},[u,s]),{stats:r,loading:o,error:d}},TD=(s,r)=>{const[a,o]=f.useState(null),[i,d]=f.useState(!0),[l,u]=f.useState(null),{user:m}=Se();return f.useEffect(()=>{(async()=>{if(o(null),!!m){d(!0),u(null);try{const x=[],p=new Date(s);for(;p<=r;)x.push(pe(p)),p.setDate(p.getDate()+1);const v=(await Promise.all(x.map(j=>Ot(ue(ne,"pomodoro",`${m.uid}_${j}`))))).map((j,b)=>{const C=(j.exists()?j.data().sessions||[]:[]).filter(S=>S.completed).reduce((S,_)=>S+(_.duration||0),0)/60;return{date:x[b],minutes:C}});o({dailyStats:v})}catch(x){console.error("Error al cargar estadísticas:",x),u(x instanceof Error?x.message:"Error al cargar estadísticas")}finally{d(!1)}}})()},[m,s,r]),{stats:a,loading:i,error:l}},_D=()=>{const[s,r]=f.useState("default"),[a,o]=f.useState({enabled:!1,sound:!0,vibration:!0}),i=f.useRef(null),d=f.useRef(),l=f.useCallback(()=>"Notification"in window,[]),u=f.useCallback(async()=>{if(!l())return!1;try{const v=await Notification.requestPermission();return r(v),v==="granted"}catch(v){return console.error("Error requesting notification permission:",v),!1}},[]),m=f.useCallback((v,j)=>{if(!(!l()||s!=="granted"))try{const b=new Notification(v,{icon:"/icon-192x192.png",silent:!a.sound,...j});b.onclick=()=>{window.focus(),b.close()}}catch(b){console.error("Error sending notification:",b)}},[s,a]),h=f.useCallback((v,j)=>{var b;if(!(!l()||s!=="granted"))try{(b=i.current)==null||b.close();const N=new Notification(v,{body:j,icon:"/icon-192x192.png",silent:!a.sound,requireInteraction:!0});N.onclick=()=>{window.focus(),N.close()},i.current=N}catch(N){console.error("Error sending persistent notification:",N)}},[s,a,l]),x=f.useCallback((v,j,b=6e4)=>{h(v,j()),d.current&&clearInterval(d.current),d.current=window.setInterval(()=>{h(v,j())},b)},[h]),p=f.useCallback(()=>{d.current&&(clearInterval(d.current),d.current=void 0),i.current&&(i.current.close(),i.current=null)},[]);f.useEffect(()=>{const v=localStorage.getItem("pomodoroNotificationPrefs");if(v)try{o(JSON.parse(v))}catch{console.warn("Invalid pomodoro prefs in storage")}l()&&r(Notification.permission)},[]);const g=f.useCallback(v=>{o(j=>{const b={...j,...v};return localStorage.setItem("pomodoroNotificationPrefs",JSON.stringify(b)),b})},[]);return{supported:l(),permission:s,preferences:a,requestPermission:u,sendNotification:m,updatePreferences:g,startPersistentNotification:x,stopPersistentNotification:p}},AD=({count:s,onIncrement:r,disabled:a,status:o})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center min-w-[3rem]",children:[e.jsx("span",{className:"font-medium text-lg",children:s}),e.jsx("span",{className:"text-xs text-gray-500",children:"completados"})]}),e.jsx(F,{variant:"outline",size:"icon",onClick:r,disabled:a,className:"h-8 w-8",children:e.jsx(ys,{className:"w-4 h-4"})}),o==="saving"&&e.jsx("span",{className:"text-xs text-blue-500 animate-pulse",children:"Guardando..."}),o==="error"&&e.jsx("span",{className:"text-xs text-red-500",children:"Error al guardar"})]});var Nd="Collapsible",[kD,Kp]=mr(Nd),[OD,wd]=kD(Nd),Jp=f.forwardRef((s,r)=>{const{__scopeCollapsible:a,open:o,defaultOpen:i,disabled:d,onOpenChange:l,...u}=s,[m=!1,h]=Qr({prop:o,defaultProp:i,onChange:l});return e.jsx(OD,{scope:a,disabled:d,contentId:Jc(),open:m,onOpenToggle:f.useCallback(()=>h(x=>!x),[h]),children:e.jsx(Bt.div,{"data-state":Cd(m),"data-disabled":d?"":void 0,...u,ref:r})})});Jp.displayName=Nd;var Xp="CollapsibleTrigger",Zp=f.forwardRef((s,r)=>{const{__scopeCollapsible:a,...o}=s,i=wd(Xp,a);return e.jsx(Bt.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":Cd(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...o,ref:r,onClick:Ct(s.onClick,i.onOpenToggle)})});Zp.displayName=Xp;var Sd="CollapsibleContent",Qp=f.forwardRef((s,r)=>{const{forceMount:a,...o}=s,i=wd(Sd,s.__scopeCollapsible);return e.jsx(Pn,{present:a||i.open,children:({present:d})=>e.jsx(PD,{...o,ref:r,present:d})})});Qp.displayName=Sd;var PD=f.forwardRef((s,r)=>{const{__scopeCollapsible:a,present:o,children:i,...d}=s,l=wd(Sd,a),[u,m]=f.useState(o),h=f.useRef(null),x=bs(r,h),p=f.useRef(0),g=p.current,v=f.useRef(0),j=v.current,b=l.open||u,N=f.useRef(b),C=f.useRef();return f.useEffect(()=>{const S=requestAnimationFrame(()=>N.current=!1);return()=>cancelAnimationFrame(S)},[]),gh(()=>{const S=h.current;if(S){C.current=C.current||{transitionDuration:S.style.transitionDuration,animationName:S.style.animationName},S.style.transitionDuration="0s",S.style.animationName="none";const _=S.getBoundingClientRect();p.current=_.height,v.current=_.width,N.current||(S.style.transitionDuration=C.current.transitionDuration,S.style.animationName=C.current.animationName),m(o)}},[l.open,o]),e.jsx(Bt.div,{"data-state":Cd(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!b,...d,ref:x,style:{"--radix-collapsible-content-height":g?`${g}px`:void 0,"--radix-collapsible-content-width":j?`${j}px`:void 0,...s.style},children:b&&i})});function Cd(s){return s?"open":"closed"}var MD=Jp,RD=Zp,ID=Qp,La="Accordion",$D=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ed,LD,zD]=Kw(La),[Ki,J4]=mr(La,[zD,Kp]),Dd=Kp(),ex=Q.forwardRef((s,r)=>{const{type:a,...o}=s,i=o,d=o;return e.jsx(Ed.Provider,{scope:s.__scopeAccordion,children:a==="multiple"?e.jsx(BD,{...d,ref:r}):e.jsx(WD,{...i,ref:r})})});ex.displayName=La;var[tx,FD]=Ki(La),[sx,HD]=Ki(La,{collapsible:!1}),WD=Q.forwardRef((s,r)=>{const{value:a,defaultValue:o,onValueChange:i=()=>{},collapsible:d=!1,...l}=s,[u,m]=Qr({prop:a,defaultProp:o,onChange:i});return e.jsx(tx,{scope:s.__scopeAccordion,value:u?[u]:[],onItemOpen:m,onItemClose:Q.useCallback(()=>d&&m(""),[d,m]),children:e.jsx(sx,{scope:s.__scopeAccordion,collapsible:d,children:e.jsx(ax,{...l,ref:r})})})}),BD=Q.forwardRef((s,r)=>{const{value:a,defaultValue:o,onValueChange:i=()=>{},...d}=s,[l=[],u]=Qr({prop:a,defaultProp:o,onChange:i}),m=Q.useCallback(x=>u((p=[])=>[...p,x]),[u]),h=Q.useCallback(x=>u((p=[])=>p.filter(g=>g!==x)),[u]);return e.jsx(tx,{scope:s.__scopeAccordion,value:l,onItemOpen:m,onItemClose:h,children:e.jsx(sx,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(ax,{...d,ref:r})})})}),[UD,Ji]=Ki(La),ax=Q.forwardRef((s,r)=>{const{__scopeAccordion:a,disabled:o,dir:i,orientation:d="vertical",...l}=s,u=Q.useRef(null),m=bs(u,r),h=LD(a),p=xh(i)==="ltr",g=Ct(s.onKeyDown,v=>{var M;if(!$D.includes(v.key))return;const j=v.target,b=h().filter($=>{var W;return!((W=$.ref.current)!=null&&W.disabled)}),N=b.findIndex($=>$.ref.current===j),C=b.length;if(N===-1)return;v.preventDefault();let S=N;const _=0,A=C-1,k=()=>{S=N+1,S>A&&(S=_)},D=()=>{S=N-1,S<_&&(S=A)};switch(v.key){case"Home":S=_;break;case"End":S=A;break;case"ArrowRight":d==="horizontal"&&(p?k():D());break;case"ArrowDown":d==="vertical"&&k();break;case"ArrowLeft":d==="horizontal"&&(p?D():k());break;case"ArrowUp":d==="vertical"&&D();break}const P=S%C;(M=b[P].ref.current)==null||M.focus()});return e.jsx(UD,{scope:a,disabled:o,direction:i,orientation:d,children:e.jsx(Ed.Slot,{scope:a,children:e.jsx(Bt.div,{...l,"data-orientation":d,ref:m,onKeyDown:o?void 0:g})})})}),Ei="AccordionItem",[qD,Td]=Ki(Ei),nx=Q.forwardRef((s,r)=>{const{__scopeAccordion:a,value:o,...i}=s,d=Ji(Ei,a),l=FD(Ei,a),u=Dd(a),m=Jc(),h=o&&l.value.includes(o)||!1,x=d.disabled||s.disabled;return e.jsx(qD,{scope:a,open:h,disabled:x,triggerId:m,children:e.jsx(MD,{"data-orientation":d.orientation,"data-state":dx(h),...u,...i,ref:r,disabled:x,open:h,onOpenChange:p=>{p?l.onItemOpen(o):l.onItemClose(o)}})})});nx.displayName=Ei;var rx="AccordionHeader",ox=Q.forwardRef((s,r)=>{const{__scopeAccordion:a,...o}=s,i=Ji(La,a),d=Td(rx,a);return e.jsx(Bt.h3,{"data-orientation":i.orientation,"data-state":dx(d.open),"data-disabled":d.disabled?"":void 0,...o,ref:r})});ox.displayName=rx;var Wc="AccordionTrigger",ix=Q.forwardRef((s,r)=>{const{__scopeAccordion:a,...o}=s,i=Ji(La,a),d=Td(Wc,a),l=HD(Wc,a),u=Dd(a);return e.jsx(Ed.ItemSlot,{scope:a,children:e.jsx(RD,{"aria-disabled":d.open&&!l.collapsible||void 0,"data-orientation":i.orientation,id:d.triggerId,...u,...o,ref:r})})});ix.displayName=Wc;var lx="AccordionContent",cx=Q.forwardRef((s,r)=>{const{__scopeAccordion:a,...o}=s,i=Ji(La,a),d=Td(lx,a),l=Dd(a);return e.jsx(ID,{role:"region","aria-labelledby":d.triggerId,"data-orientation":i.orientation,...l,...o,ref:r,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});cx.displayName=lx;function dx(s){return s?"open":"closed"}var VD=ex,YD=nx,GD=ox,ux=ix,mx=cx;const _d=VD,Xi=f.forwardRef(({className:s,...r},a)=>e.jsx(YD,{ref:a,className:Z("border-b",s),...r}));Xi.displayName="AccordionItem";const Zi=f.forwardRef(({className:s,children:r,...a},o)=>e.jsx(GD,{className:"flex",children:e.jsxs(ux,{ref:o,className:Z("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...a,children:[r,e.jsx(ga,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));Zi.displayName=ux.displayName;const Qi=f.forwardRef(({className:s,children:r,...a},o)=>e.jsx(mx,{ref:o,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:e.jsx("div",{className:Z("pb-4 pt-0",s),children:r})}));Qi.displayName=mx.displayName;const If=s=>new Date(s).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1}),KD=({sessions:s,onDeleteSession:r,onEditSession:a})=>{const[o,i]=f.useState(!1),d=[...s].sort((l,u)=>u.startTime.timestamp-l.startTime.timestamp);return e.jsx(_d,{type:"single",collapsible:!0,onValueChange:l=>i(!!l),value:o?"history":"",children:e.jsxs(Xi,{value:"history",className:"border-none",children:[e.jsx(Zi,{className:"w-full h-11 flex items-center justify-center gap-2 border rounded-lg bg-background hover:bg-accent data-[state=open]:rounded-b-none",children:e.jsx("span",{className:"text-sm font-semibold",children:"Historial de hoy"})}),e.jsx(Qi,{className:"mt-2 space-y-2",children:d.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm py-2",children:"No hay sesiones registradas hoy"}):d.map((l,u)=>e.jsxs("div",{className:"flex flex-col p-2.5 bg-muted rounded-lg text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l.completed?e.jsx(Lh,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):e.jsx(z1,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-gray-400 w-4",children:u+1}),e.jsx("span",{children:If(l.startTime.timestamp)}),e.jsx("span",{className:"text-gray-400",children:"→"}),e.jsx("span",{children:If(l.endTime.timestamp)})]})}),e.jsxs("span",{className:"text-gray-500 whitespace-nowrap",children:[Math.floor(l.duration/60),"min"]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[a&&e.jsx(F,{variant:"ghost",size:"icon",className:"h-auto w-auto p-1",onClick:()=>a(l),children:e.jsx(sd,{className:"w-4 h-4 text-muted-foreground"})}),r&&e.jsx(F,{variant:"ghost",size:"icon",className:"h-auto w-auto p-1",onClick:()=>r(l),children:e.jsx(oo,{className:"w-4 h-4 text-destructive"})})]})]}),l.description&&e.jsx("div",{className:"ml-6 mt-1 text-xs text-gray-500",children:l.description})]},l.startTime.timestamp))})]})})},JD=({time:s,isActive:r,onStart:a,onStop:o,disabled:i})=>{const[d,l]=f.useState(!1),u=async h=>{if(h.preventDefault(),!d)try{l(!0),await o()}finally{l(!1)}},m=async h=>{if(h.preventDefault(),!d)try{l(!0),await a()}finally{l(!1)}};return e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"text-6xl font-mono tracking-wider",children:s}),e.jsx("div",{className:"flex gap-4",children:r?e.jsxs(F,{size:"lg",onClick:u,disabled:i||d,variant:"destructive",className:"w-40 text-lg",children:[d?e.jsx(Wt,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(H1,{className:"w-5 h-5 mr-2"}),d?"Deteniendo...":"Detener"]}):e.jsxs(F,{size:"lg",onClick:m,disabled:i||d,className:"w-40 text-lg",children:[d?e.jsx(Wt,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(F1,{className:"w-5 h-5 mr-2"}),d?"Iniciando...":"Iniciar"]})}),e.jsx("div",{className:"text-sm text-gray-500",children:r?e.jsx(e.Fragment,{children:d?e.jsx("span",{children:"Procesando cambio de estado..."}):e.jsx("span",{children:"Concentración en progreso..."})}):e.jsx("span",{children:"30 minutos de concentración"})})]})},XD=({progress:s,currentTime:r,totalTime:a,isActive:o})=>{const i=Math.min(Math.max(s,0),100);return e.jsxs("div",{className:"space-y-2",children:[e.jsx(kt,{value:i,className:`h-2 transition-all duration-300 ${o?"bg-gray-100":"bg-gray-50"}`}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:r}),e.jsx("span",{className:"text-gray-500",children:" restantes"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("span",{children:"Total: "}),e.jsx("span",{className:"font-medium",children:a})]})]}),e.jsx("div",{className:"text-center text-sm text-gray-500",children:i>0&&e.jsxs("span",{children:[Math.round(i),"% completado"]})})]})};var Ad="Checkbox",[ZD,X4]=mr(Ad),[QD,eT]=ZD(Ad),fx=f.forwardRef((s,r)=>{const{__scopeCheckbox:a,name:o,checked:i,defaultChecked:d,required:l,disabled:u,value:m="on",onCheckedChange:h,form:x,...p}=s,[g,v]=f.useState(null),j=bs(r,A=>v(A)),b=f.useRef(!1),N=g?x||!!g.closest("form"):!0,[C=!1,S]=Qr({prop:i,defaultProp:d,onChange:h}),_=f.useRef(C);return f.useEffect(()=>{const A=g==null?void 0:g.form;if(A){const k=()=>S(_.current);return A.addEventListener("reset",k),()=>A.removeEventListener("reset",k)}},[g,S]),e.jsxs(QD,{scope:a,state:C,disabled:u,children:[e.jsx(Bt.button,{type:"button",role:"checkbox","aria-checked":dn(C)?"mixed":C,"aria-required":l,"data-state":xx(C),"data-disabled":u?"":void 0,disabled:u,value:m,...p,ref:j,onKeyDown:Ct(s.onKeyDown,A=>{A.key==="Enter"&&A.preventDefault()}),onClick:Ct(s.onClick,A=>{S(k=>dn(k)?!0:!k),N&&(b.current=A.isPropagationStopped(),b.current||A.stopPropagation())})}),N&&e.jsx(tT,{control:g,bubbles:!b.current,name:o,value:m,checked:C,required:l,disabled:u,form:x,style:{transform:"translateX(-100%)"},defaultChecked:dn(d)?!1:d})]})});fx.displayName=Ad;var hx="CheckboxIndicator",px=f.forwardRef((s,r)=>{const{__scopeCheckbox:a,forceMount:o,...i}=s,d=eT(hx,a);return e.jsx(Pn,{present:o||dn(d.state)||d.state===!0,children:e.jsx(Bt.span,{"data-state":xx(d.state),"data-disabled":d.disabled?"":void 0,...i,ref:r,style:{pointerEvents:"none",...s.style}})})});px.displayName=hx;var tT=s=>{const{control:r,checked:a,bubbles:o=!0,defaultChecked:i,...d}=s,l=f.useRef(null),u=Jw(a),m=Xw(r);f.useEffect(()=>{const x=l.current,p=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(p,"checked").set;if(u!==a&&v){const j=new Event("click",{bubbles:o});x.indeterminate=dn(a),v.call(x,dn(a)?!1:a),x.dispatchEvent(j)}},[u,a,o]);const h=f.useRef(dn(a)?!1:a);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??h.current,...d,tabIndex:-1,ref:l,style:{...s.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function dn(s){return s==="indeterminate"}function xx(s){return dn(s)?"indeterminate":s?"checked":"unchecked"}var gx=fx,sT=px;const Ra=f.forwardRef(({className:s,...r},a)=>e.jsx(gx,{ref:a,className:Z("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:e.jsx(sT,{className:Z("flex items-center justify-center text-current"),children:e.jsx(Pi,{className:"h-4 w-4"})})}));Ra.displayName=gx.displayName;var aT="Label",vx=f.forwardRef((s,r)=>e.jsx(Bt.label,{...s,ref:r,onMouseDown:a=>{var i;a.target.closest("button, input, select, textarea")||((i=s.onMouseDown)==null||i.call(s,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));vx.displayName=aT;var yx=vx;const nT=io("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),He=f.forwardRef(({className:s,...r},a)=>e.jsx(yx,{ref:a,className:Z(nT(),s),...r}));He.displayName=yx.displayName;const rT=({session:s,onClose:r,onSave:a})=>{const[o,i]=f.useState(""),[d,l]=f.useState(""),[u,m]=f.useState(!1),[h,x]=f.useState("");if(f.useEffect(()=>{if(s){const g=new Date(s.startTime.timestamp),v=new Date(s.endTime.timestamp);i(`${String(g.getHours()).padStart(2,"0")}:${String(g.getMinutes()).padStart(2,"0")}`),l(`${String(v.getHours()).padStart(2,"0")}:${String(v.getMinutes()).padStart(2,"0")}`),m(s.completed),x(s.description||"")}},[s]),!s)return null;const p=()=>{const g=new Date(s.startTime.timestamp),[v,j]=o.split(":").map(Number),[b,N]=d.split(":").map(Number),C=new Date(g);C.setHours(v,j,0,0);const S=new Date(g);S.setHours(b,N,0,0),S<C&&S.setDate(S.getDate()+1);const _={startTime:{timestamp:C.getTime(),utcOffset:-C.getTimezoneOffset(),formatted:new Date(C).toLocaleString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})+` UTC${-C.getTimezoneOffset()>=0?"+":"-"}${Math.abs(Math.floor(-C.getTimezoneOffset()/60))}`},endTime:{timestamp:S.getTime(),utcOffset:-S.getTimezoneOffset(),formatted:new Date(S).toLocaleString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})+` UTC${-S.getTimezoneOffset()>=0?"+":"-"}${Math.abs(Math.floor(-S.getTimezoneOffset()/60))}`},duration:(S.getTime()-C.getTime())/1e3,completed:u,description:h.trim()||void 0};a(s,_),r()};return e.jsx(st,{open:!!s,onOpenChange:g=>{g||r()},children:e.jsxs(Ke,{className:"sm:max-w-md",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Editar Sesión Pomodoro"})}),e.jsxs("div",{className:"py-4 space-y-4",children:[" ",e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[" ",e.jsx(He,{htmlFor:"startTime",children:"Hora inicio"}),e.jsx(ke,{id:"startTime",type:"time",value:o,onChange:g=>i(g.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"endTime",children:"Hora fin"}),e.jsx(ke,{id:"endTime",type:"time",value:d,onChange:g=>l(g.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"description",children:"Descripción (opcional)"}),e.jsx(ke,{id:"description",type:"text",value:h,onChange:g=>x(g.target.value),placeholder:"¿Qué hiciste en esta sesión?"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[" ",e.jsx(Ra,{id:"completed",checked:u,onCheckedChange:g=>m(!!g)}),e.jsx(He,{htmlFor:"completed",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Sesión completada"})]})]}),e.jsxs(os,{children:[e.jsx(F,{variant:"outline",onClick:r,children:"Cancelar"}),e.jsx(F,{onClick:p,children:"Guardar cambios"})]})]})})},mi=s=>{const r=Math.floor(s/60),a=s%60;return r>0?`${r}h ${a}min`:`${a}min`},oT=s=>s===100?{icon:zh,message:"¡Meta diaria alcanzada! 🎉",description:"Has completado tu objetivo del día ¡Excelente trabajo!",color:"text-green-600"}:s>=75?{icon:W1,message:"¡Casi ahí! 💪",description:"Estás muy cerca de alcanzar tu meta diaria",color:"text-blue-600"}:s>=50?{icon:pa,message:"¡Buen progreso! 👍",description:"Mantén el ritmo, vas por buen camino",color:"text-indigo-600"}:s>=25?{icon:pa,message:"¡Sigue adelante! 🎯",description:"Has comenzado bien, mantén el enfoque",color:"text-blue-600"}:{icon:pa,message:"¡Comencemos! 🚀",description:"Es un buen momento para enfocarse en tus objetivos",color:"text-gray-600"},iT=s=>s>=100?{background:"bg-green-500",text:"text-green-700",icon:"bg-green-100"}:s>=75?{background:"bg-blue-500",text:"text-blue-700",icon:"bg-blue-100"}:s>=50?{background:"bg-indigo-500",text:"text-indigo-700",icon:"bg-indigo-100"}:s>=25?{background:"bg-blue-500",text:"text-blue-700",icon:"bg-blue-100"}:{background:"bg-gray-500",text:"text-gray-700",icon:"bg-gray-100"},lT=({sessions:s,dailyGoal:r=300})=>{const a=s.filter(p=>p.completed).reduce((p,g)=>p+g.duration,0),o=Math.floor(a/60),i=Math.min(Math.round(o/r*100),100),d=Math.max(r-o,0),{icon:l,message:u,description:m,color:h}=oT(i),x=iT(i);return e.jsx(se,{className:"p-6 bg-gradient-to-br from-white to-gray-50",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${x.icon} mt-1`,children:e.jsx(l,{className:`w-5 h-5 ${h}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold text-lg ${h}`,children:u}),e.jsx("p",{className:"text-sm text-gray-600",children:m})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex justify-between items-center",children:[e.jsxs("span",{children:["Meta diaria: ",mi(r)]}),e.jsxs("span",{className:`font-medium ${h}`,children:[i,"% completado"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(kt,{value:i,className:"h-3"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Tiempo efectivo"}),e.jsx("p",{className:`text-lg font-semibold ${x.text}`,children:mi(o)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Tiempo restante"}),e.jsx("p",{className:"text-lg font-semibold text-gray-700",children:mi(d)})]})]})]}),e.jsx("div",{className:"text-center",children:i<100?e.jsxs("p",{className:"text-sm text-gray-600",children:["Te faltan ",e.jsx("span",{className:"font-medium",children:mi(d)})," para alcanzar tu meta diaria"]}):e.jsx("p",{className:"text-sm font-medium text-green-600",children:"¡Felicitaciones! Has superado tu meta diaria de productividad 🎉"})})]})})},$f=s=>{const r=Math.floor(s/60),a=s%60;return`${r<10?"0":""}${r}:${a<10?"0":""}${a}`},Di=s=>{if(s<60)return`${s} min`;const r=Math.floor(s/60),a=s%60;return`${r}h ${a}min`};var cT=f.forwardRef((s,r)=>{const{children:a,...o}=s,i=f.Children.toArray(a),d=i.find(dT);if(d){const l=d.props.children,u=i.map(m=>m===d?f.Children.count(l)>1?f.Children.only(null):f.isValidElement(l)?l.props.children:null:m);return e.jsx(Bc,{...o,ref:r,children:f.isValidElement(l)?f.cloneElement(l,void 0,u):null})}return e.jsx(Bc,{...o,ref:r,children:a})});cT.displayName="Slot";var Bc=f.forwardRef((s,r)=>{const{children:a,...o}=s;if(f.isValidElement(a)){const i=mT(a);return f.cloneElement(a,{...uT(o,a.props),ref:r?ih(r,i):i})}return f.Children.count(a)>1?f.Children.only(null):null});Bc.displayName="SlotClone";var jx=({children:s})=>e.jsx(e.Fragment,{children:s});function dT(s){return f.isValidElement(s)&&s.type===jx}function uT(s,r){const a={...r};for(const o in r){const i=s[o],d=r[o];/^on[A-Z]/.test(o)?i&&d?a[o]=(...u)=>{d(...u),i(...u)}:i&&(a[o]=i):o==="style"?a[o]={...i,...d}:o==="className"&&(a[o]=[i,d].filter(Boolean).join(" "))}return{...s,...a}}function mT(s){var o,i;let r=(o=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:o.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?s.ref:(r=(i=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:i.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?s.props.ref:s.props.ref||s.ref)}var bx="AlertDialog",[fT,Z4]=mr(bx,[bh]),za=bh(),Nx=s=>{const{__scopeAlertDialog:r,...a}=s,o=za(r);return e.jsx(Zc,{...o,...a,modal:!0})};Nx.displayName=bx;var hT="AlertDialogTrigger",wx=f.forwardRef((s,r)=>{const{__scopeAlertDialog:a,...o}=s,i=za(a);return e.jsx(Qc,{...i,...o,ref:r})});wx.displayName=hT;var pT="AlertDialogPortal",Sx=s=>{const{__scopeAlertDialog:r,...a}=s,o=za(r);return e.jsx(Xc,{...o,...a})};Sx.displayName=pT;var xT="AlertDialogOverlay",Cx=f.forwardRef((s,r)=>{const{__scopeAlertDialog:a,...o}=s,i=za(a);return e.jsx(eo,{...i,...o,ref:r})});Cx.displayName=xT;var or="AlertDialogContent",[gT,vT]=fT(or),Ex=f.forwardRef((s,r)=>{const{__scopeAlertDialog:a,children:o,...i}=s,d=za(a),l=f.useRef(null),u=bs(r,l),m=f.useRef(null);return e.jsx(Zw,{contentName:or,titleName:Dx,docsSlug:"alert-dialog",children:e.jsx(gT,{scope:a,cancelRef:m,children:e.jsxs(to,{role:"alertdialog",...d,...i,ref:u,onOpenAutoFocus:Ct(i.onOpenAutoFocus,h=>{var x;h.preventDefault(),(x=m.current)==null||x.focus({preventScroll:!0})}),onPointerDownOutside:h=>h.preventDefault(),onInteractOutside:h=>h.preventDefault(),children:[e.jsx(jx,{children:o}),e.jsx(jT,{contentRef:l})]})})})});Ex.displayName=or;var Dx="AlertDialogTitle",Tx=f.forwardRef((s,r)=>{const{__scopeAlertDialog:a,...o}=s,i=za(a);return e.jsx(so,{...i,...o,ref:r})});Tx.displayName=Dx;var _x="AlertDialogDescription",Ax=f.forwardRef((s,r)=>{const{__scopeAlertDialog:a,...o}=s,i=za(a);return e.jsx(ao,{...i,...o,ref:r})});Ax.displayName=_x;var yT="AlertDialogAction",kx=f.forwardRef((s,r)=>{const{__scopeAlertDialog:a,...o}=s,i=za(a);return e.jsx(_i,{...i,...o,ref:r})});kx.displayName=yT;var Ox="AlertDialogCancel",Px=f.forwardRef((s,r)=>{const{__scopeAlertDialog:a,...o}=s,{cancelRef:i}=vT(Ox,a),d=za(a),l=bs(r,i);return e.jsx(_i,{...d,...o,ref:l})});Px.displayName=Ox;var jT=({contentRef:s})=>{const r=`\`${or}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${or}\` by passing a \`${_x}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${or}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return f.useEffect(()=>{var o;document.getElementById((o=s.current)==null?void 0:o.getAttribute("aria-describedby"))||console.warn(r)},[r,s]),null},bT=Nx,NT=wx,wT=Sx,Mx=Cx,Rx=Ex,Ix=kx,$x=Px,Lx=Tx,zx=Ax;const el=bT,Fx=NT,ST=wT,Hx=f.forwardRef(({className:s,...r},a)=>e.jsx(Mx,{className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:a}));Hx.displayName=Mx.displayName;const mo=f.forwardRef(({className:s,...r},a)=>e.jsxs(ST,{children:[e.jsx(Hx,{}),e.jsx(Rx,{ref:a,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...r})]}));mo.displayName=Rx.displayName;const fo=({className:s,...r})=>e.jsx("div",{className:Z("flex flex-col space-y-2 text-center sm:text-left",s),...r});fo.displayName="AlertDialogHeader";const ho=({className:s,...r})=>e.jsx("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...r});ho.displayName="AlertDialogFooter";const po=f.forwardRef(({className:s,...r},a)=>e.jsx(Lx,{ref:a,className:Z("text-lg font-semibold",s),...r}));po.displayName=Lx.displayName;const xo=f.forwardRef(({className:s,...r},a)=>e.jsx(zx,{ref:a,className:Z("text-sm text-muted-foreground",s),...r}));xo.displayName=zx.displayName;const go=f.forwardRef(({className:s,...r},a)=>e.jsx(Ix,{ref:a,className:Z(Jr(),s),...r}));go.displayName=Ix.displayName;const vo=f.forwardRef(({className:s,...r},a)=>e.jsx($x,{ref:a,className:Z(Jr({variant:"outline"}),"mt-2 sm:mt-0",s),...r}));vo.displayName=$x.displayName;const Ec=30*60,Wx=({selectedDate:s})=>{const{user:r}=Se(),a=300,[o,i]=f.useState(!1),[d,l]=f.useState(null),{supported:u,permission:m,preferences:h,requestPermission:x,sendNotification:p,updatePreferences:g,startPersistentNotification:v,stopPersistentNotification:j}=_D(),{count:b,sessions:N,status:C,error:S,saveSession:_,deleteSession:A,editSession:k,addManualSession:D}=ED(s),P=f.useCallback(async _e=>{await _(_e,!0),h.enabled&&m==="granted"&&p("¡Pomodoro completado! 🎉",{body:"Has completado exitosamente tu sesión de concentración",requireInteraction:!0})},[_,h,m,p]),M=f.useCallback(async _e=>{await _(_e,!1,{description:"Sesión interrumpida manualmente"})},[_]),{time:$,isActive:W,formattedTime:I,startTimer:B,stopTimer:H}=CD({onComplete:P,onCancel:M,selectedDate:s}),U=(Ec-$)/Ec*100,ee=async()=>{u&&(h.enabled?g({enabled:!1}):m==="default"?i(!0):m==="granted"&&g({enabled:!0}))},re=async()=>{await x()&&g({enabled:!0}),i(!1)},J=async()=>{C!=="saving"&&await D()},te=_e=>{l(_e)},me=async(_e,Ee)=>{await k(_e,Ee),l(null)},Ce=f.useRef($);return f.useEffect(()=>{Ce.current=$},[$]),f.useEffect(()=>{!u||!h.enabled||m!=="granted"||(W?v("Pomodoro en progreso",()=>`Tiempo restante: ${$f(Math.ceil(Ce.current))}`):j())},[W,u,h.enabled,m,v,j]),f.useEffect(()=>()=>{j()},[j]),r?e.jsxs("div",{className:"space-y-6",children:[e.jsx(lT,{sessions:N,dailyGoal:a}),e.jsx(se,{className:"w-full",children:e.jsxs(ae,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pa,{className:"w-5 h-5"}),e.jsx("h2",{className:"text-lg font-medium",children:"Pomodoro Timer"})]}),u&&e.jsx(F,{variant:"outline",size:"sm",onClick:ee,className:"flex items-center gap-2","aria-label":h.enabled?"Desactivar notificaciones":"Activar notificaciones",children:h.enabled?e.jsxs(e.Fragment,{children:[e.jsx(B1,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline"})]}):e.jsxs(e.Fragment,{children:[e.jsx(U1,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline"})]})})]}),e.jsx(AD,{count:b,onIncrement:J,disabled:C==="saving",status:C})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(JD,{time:I,isActive:W,onStart:B,onStop:H,disabled:C==="saving"}),e.jsx(XD,{progress:U,currentTime:I,totalTime:$f(Ec),isActive:W})]}),e.jsx("div",{className:"mt-6",children:e.jsx(KD,{sessions:N,onEditSession:te,onDeleteSession:A})})]})}),d&&e.jsx(rT,{session:d,onClose:()=>l(null),onSave:me}),e.jsx(el,{open:o,onOpenChange:i,children:e.jsxs(mo,{children:[e.jsxs(fo,{children:[e.jsx(po,{children:"Activar notificaciones"}),e.jsx(xo,{children:"¿Te gustaría recibir notificaciones cuando se complete un Pomodoro? Esto te ayudará a mantenerte informado incluso cuando el navegador esté en segundo plano."})]}),e.jsxs(ho,{children:[e.jsx(vo,{children:"No, gracias"}),e.jsx(go,{onClick:re,children:"Activar notificaciones"})]})]})}),S&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:S})]}):e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para usar el temporizador Pomodoro"})})})},Lf=({dateRange:s})=>{const{user:r}=Se(),{stats:a,loading:o,error:i}=DD(s);return r?o?e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsxs(Pe,{children:["Estadísticas (",s==="week"?"Semana":"Mes",")"]})}),e.jsx(ae,{children:e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx("p",{className:"text-gray-500",children:"Cargando estadísticas..."})})})]}):i?e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsxs(Pe,{children:["Estadísticas (",s==="week"?"Semana":"Mes",")"]})}),e.jsx(ae,{children:e.jsx("div",{className:"text-red-500",children:"Error al cargar las estadísticas. Por favor, intenta de nuevo."})})]}):a?e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsxs(Pe,{children:["Estadísticas ",s==="week"?"de la Semana":"del Mes"]})}),e.jsx(ae,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Sesiones Totales"}),e.jsx("p",{className:"text-2xl font-bold",children:a.totalSessions})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Completadas"}),e.jsx("p",{className:"text-2xl font-bold",children:a.completedSessions})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo Total"}),e.jsx("p",{className:"text-2xl font-bold",children:Di(Math.floor(a.totalTime/60))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Promedio/Sesión"}),e.jsx("p",{className:"text-2xl font-bold",children:Di(Math.floor(a.averageSessionTime/60))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Completitud"}),e.jsxs("p",{className:"text-2xl font-bold",children:[a.completionRate.toFixed(1),"%"]})]}),a.bestDay&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Mejor Día"}),e.jsx("p",{className:"text-2xl font-bold",children:a.bestDay.sessions}),e.jsx("p",{className:"text-xs text-gray-400",children:a.bestDay.date})]})]})})]}):e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsxs(Pe,{children:["Estadísticas (",s==="week"?"Semana":"Mes",")"]})}),e.jsx(ae,{children:e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500",children:"No hay datos disponibles"})})})]}):null},CT=({selectedDate:s,goal:r=300})=>{const[a,o]=f.useState(Qe(s));f.useEffect(()=>{o(Qe(s))},[s]);const i=f.useMemo(()=>Qe(a),[a]),d=f.useMemo(()=>vs(a),[a]),{stats:l,loading:u}=TD(i,d),m=f.useMemo(()=>{const x={};return l==null||l.dailyStats.forEach(({date:p,minutes:g})=>{x[p]=g}),x},[l]),h=x=>{const p=pe(x.date),g=m[p]||0,v=Math.min(g/r,1),j=28,b=3,N=(j-b)/2,C=2*Math.PI*N,S=C-v*C,_=g>=r;return e.jsxs("div",{className:"relative flex items-center justify-center w-7 h-7",children:[e.jsxs("svg",{width:j,height:j,className:"absolute",children:[e.jsx("circle",{cx:j/2,cy:j/2,r:N,stroke:_?"#fecaca":"#e5e7eb",strokeWidth:b,fill:"none"}),e.jsx("circle",{cx:j/2,cy:j/2,r:N,stroke:_?"#f87171":"#9ca3af",strokeWidth:b,fill:"none",strokeDasharray:C,strokeDashoffset:S,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),e.jsx("span",{className:"text-[10px] font-medium z-10",children:x.date.getDate()})]})};return e.jsxs(se,{className:"w-full",children:[e.jsxs(Oe,{className:"flex flex-col items-center gap-2",children:[e.jsx(ro,{className:"w-5 h-5 text-red-600"}),e.jsx(Pe,{className:"text-center",children:"Historial Mensual"})]}),e.jsxs(ae,{className:"relative p-4",children:[u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 z-10",children:e.jsx(Wt,{className:"w-6 h-6 animate-spin"})}),e.jsx(Gi,{month:a,onMonthChange:o,showOutsideDays:!0,components:{DayContent:h},className:"p-0 w-full"})]})]})};function ET(){const[s,r]=f.useState(new Date),{user:a}=Se();return a?e.jsxs(Et,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Pomodoro Timer"}),e.jsx("p",{className:"text-gray-500",children:"Gestiona tus sesiones de trabajo y productividad"})]}),e.jsx(xa,{selectedDate:s,onChange:r}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[1fr_300px]",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(Wx,{selectedDate:s}),e.jsx(Lf,{dateRange:"week"}),e.jsx(Lf,{dateRange:"month"})]}),e.jsx("div",{className:"space-y-6",children:e.jsx(CT,{selectedDate:s})})]})]}):e.jsx(Et,{children:e.jsx("div",{className:"text-center py-8",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesión para ver tus estadísticas"})})})}const Ti=s=>{const r=rr.find(a=>a.text===s);return(r==null?void 0:r.value)??5},DT=s=>{if(s.length===0)return 0;const r=s.reduce((a,o)=>a+(o.value??Ti(o.text)),0);return Math.round(r/s.length*10)/10},rr=[{emoji:"😍",text:"Enamorado",value:10},{emoji:"😊",text:"Feliz",value:10},{emoji:"🌟",text:"Energético",value:10},{emoji:"🧠",text:"Productivo",value:10},{emoji:"😎",text:"Confiado",value:9},{emoji:"😌",text:"Tranquilo",value:8},{emoji:"🤔",text:"Pensativo",value:6},{emoji:"🥱",text:"Aburrido",value:5},{emoji:"😴",text:"Pereza",value:4},{emoji:"😕",text:"Confundido",value:5},{emoji:"😬",text:"Nervioso",value:3},{emoji:"🤯",text:"Abrumado",value:3},{emoji:"😤",text:"Frustración",value:3},{emoji:"😰",text:"Ansioso",value:2},{emoji:"😪",text:"Cansado",value:2},{emoji:"😢",text:"Triste",value:1},{emoji:"😡",text:"Enojado",value:1},{emoji:"🤒",text:"Enfermo",value:1}],Bx=({onSelect:s,disabled:r})=>e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:rr.map(a=>e.jsx("div",{className:"relative",children:e.jsxs(F,{variant:"outline",onClick:()=>s(a),className:"h-12 text-lg w-full relative",disabled:r,children:[e.jsx("span",{children:a.emoji}),e.jsx("span",{className:"w-full text-center text-xs text-gray-500 mt-1",children:a.text})]})},a.emoji))}),TT=({isOpen:s,onClose:r,moodEntry:a,onSave:o,onDelete:i})=>{const[d,l]=f.useState(""),[u,m]=f.useState(!1);f.useEffect(()=>{a!=null&&a.time&&l(a.time)},[a]);const h=async()=>{if(a){m(!0);try{const[p,g]=d.split(":").map(Number),v=new Date(a.timestamp),j=Kt(v,p,g);await o({...a,time:d,timestamp:j.timestamp}),r()}catch(p){console.error("Error al guardar:",p)}finally{m(!1)}}},x=async()=>{if(i){m(!0);try{await i(),r()}catch(p){console.error("Error al eliminar:",p)}finally{m(!1)}}};return e.jsx(st,{open:s,onOpenChange:r,children:e.jsxs(Ke,{className:"sm:max-w-md",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Editar registro"})}),e.jsxs("div",{className:"flex items-center gap-4 py-4",children:[e.jsx("span",{className:"text-2xl",children:a==null?void 0:a.emoji}),e.jsx("span",{children:a==null?void 0:a.text})]}),e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"time",className:"text-sm",children:"Hora:"}),e.jsx(ke,{id:"time",type:"time",value:d,onChange:p=>l(p.target.value)})]})}),e.jsxs(os,{className:"gap-2 sm:gap-0",children:[i&&e.jsx(F,{variant:"destructive",onClick:x,disabled:u,className:"w-full sm:w-auto",children:"Eliminar"}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(F,{variant:"outline",onClick:r,disabled:u,className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(F,{onClick:h,disabled:u,className:"flex-1 sm:flex-none",children:"Guardar"})]})]})]})})},_T=({moods:s,onUpdateMood:r,onDeleteMood:a})=>{const[o,i]=f.useState(!1),[d,l]=f.useState(null),u=[...s].sort((v,j)=>v.timestamp-j.timestamp),m=o?u:u.slice(0,3),h=s.length>3,x=v=>{l(v)},p=async v=>{d&&await r(d.timestamp,v)},g=async()=>{d&&await a(d.timestamp)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4 space-y-2",children:[m.map((v,j)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded hover:bg-accent transition-colors",children:[e.jsx("span",{className:"text-xl",children:v.emoji}),e.jsx("span",{children:v.text}),e.jsx("span",{className:"text-gray-500 ml-auto",children:v.time}),e.jsx(F,{variant:"ghost",size:"sm",className:"ml-2 h-8 w-8 p-0",onClick:()=>x(v),children:e.jsx(Mi,{className:"h-4 w-4"})})]},`${v.timestamp}_${j}`)),h&&e.jsx(F,{variant:"ghost",className:"w-full h-8 text-sm text-gray-500 hover:text-gray-900",onClick:()=>i(!o),children:o?e.jsxs("span",{className:"flex items-center gap-1",children:["Ver menos ",e.jsx(Oi,{className:"h-4 w-4"})]}):e.jsxs("span",{className:"flex items-center gap-1",children:["Ver más (",s.length-3,") ",e.jsx(ga,{className:"h-4 w-4"})]})}),s.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"No hay registros para este día"})]}),e.jsx(TT,{isOpen:d!==null,onClose:()=>l(null),moodEntry:d,onSave:p,onDelete:g})]})},AT=["bg-red-500 text-white","bg-orange-500 text-white","bg-yellow-400 text-black","bg-lime-500 text-black","bg-green-600 text-white"],kT=[q1,V1,Y1,G1,K1],Ux=({onSelect:s,disabled:r})=>{const[a,o]=f.useState(""),i=d=>{s(d,a||void 0),o("")};return e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Comentario opcional",value:a,onChange:d=>o(d.target.value),className:"w-full border rounded p-2 text-sm"}),e.jsx("div",{className:"grid grid-cols-5 gap-2 mb-2",children:[1,2,3,4,5].map(d=>{const l=kT[d-1];return e.jsx(F,{variant:"default",className:`h-12 w-full ${AT[d-1]} flex items-center justify-center`,onClick:()=>i(d),disabled:r,children:e.jsx(l,{className:"h-5 w-5"})},d)})})]})},OT=({isOpen:s,onClose:r,energyEntry:a,onSave:o,onDelete:i})=>{const[d,l]=f.useState(""),[u,m]=f.useState(3),[h,x]=f.useState(""),[p,g]=f.useState(!1);f.useEffect(()=>{a&&(l(a.time),m(a.level),x(a.comment||""))},[a]);const v=async()=>{if(a){g(!0);try{const[b,N]=d.split(":").map(Number),C=new Date(a.timestamp),S=Kt(C,b,N);await o({level:u,comment:h||void 0,time:d,timestamp:S.timestamp}),r()}finally{g(!1)}}},j=async()=>{if(!(!i||!a)){g(!0);try{await i(),r()}finally{g(!1)}}};return e.jsx(st,{open:s,onOpenChange:r,children:e.jsxs(Ke,{className:"sm:max-w-md",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Editar registro"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"time",className:"text-sm",children:"Hora:"}),e.jsx(ke,{id:"time",type:"time",value:d,onChange:b=>l(b.target.value)})]}),e.jsx(ke,{type:"text",placeholder:"Comentario opcional",value:h,onChange:b=>x(b.target.value)}),e.jsx(Ux,{onSelect:b=>m(b),disabled:!1})]}),e.jsxs(os,{className:"gap-2 sm:gap-0",children:[i&&e.jsx(F,{variant:"destructive",onClick:j,disabled:p,className:"w-full sm:w-auto",children:"Eliminar"}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(F,{variant:"outline",onClick:r,disabled:p,className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(F,{onClick:v,disabled:p,className:"flex-1 sm:flex-none",children:"Guardar"})]})]})]})})},PT=["bg-red-500","bg-orange-500","bg-yellow-400","bg-lime-500","bg-green-600"],MT=({entries:s,onUpdate:r,onDelete:a})=>{const[o,i]=f.useState(!1),[d,l]=f.useState(null),u=[...s].sort((p,g)=>p.timestamp-g.timestamp),m=s.length>0?Math.round(s.reduce((p,g)=>p+g.level,0)/s.length*10)/10:0,h=async p=>{d&&(await r(d.timestamp,p),l(null))},x=async()=>{d&&(await a(d.timestamp),l(null))};return e.jsxs(e.Fragment,{children:[e.jsx(_d,{type:"single",collapsible:!0,value:o?"history":"",onValueChange:p=>i(!!p),children:e.jsxs(Xi,{value:"history",className:"border-none",children:[e.jsx(Zi,{className:"w-full h-11 flex items-center justify-between gap-2 border rounded-lg bg-background hover:bg-accent data-[state=open]:rounded-b-none",children:e.jsx("span",{className:"text-sm font-semibold",children:"Historial de hoy"})}),e.jsxs(Qi,{className:"mt-2 space-y-2",children:[u.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm py-2",children:"No hay registros para este día"}):u.map((p,g)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${PT[p.level-1]}`}),e.jsxs("span",{className:"text-sm",children:["Nivel ",p.level]}),p.comment&&e.jsx("span",{className:"text-sm flex-1",children:p.comment}),e.jsx("span",{className:"text-gray-500 ml-auto text-sm",children:p.time}),e.jsx(F,{variant:"ghost",size:"sm",className:"ml-2 h-8 w-8 p-0",onClick:()=>l(p),children:e.jsx(Mi,{className:"h-4 w-4"})})]},`${p.timestamp}_${g}`)),u.length>0&&e.jsxs("div",{className:"text-center text-xs text-muted-foreground",children:["Promedio del día: ",m]})]})]})}),e.jsx(OT,{isOpen:d!==null,onClose:()=>l(null),energyEntry:d,onSave:h,onDelete:x})]})},Ue=f.forwardRef(({className:s,...r},a)=>e.jsx("textarea",{className:Z("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:a,...r}));Ue.displayName="Textarea";const RT=io("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),xr=f.forwardRef(({className:s,variant:r,...a},o)=>e.jsx("div",{ref:o,role:"alert",className:Z(RT({variant:r}),s),...a}));xr.displayName="Alert";const IT=f.forwardRef(({className:s,...r},a)=>e.jsx("h5",{ref:a,className:Z("mb-1 font-medium leading-none tracking-tight",s),...r}));IT.displayName="AlertTitle";const gr=f.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:Z("text-sm [&_p]:leading-relaxed",s),...r}));gr.displayName="AlertDescription";const $T=()=>{const[s,r]=f.useState(!1),[a,o]=f.useState(""),[i,d]=f.useState(null),[l,u]=f.useState(!1),{user:m}=Se(),h=async()=>{var p;if(!(!m||!a.trim())){u(!0),d(null);try{const g=JSON.parse(a);if(!Array.isArray(g))throw new Error("El JSON debe ser un array de objetos");let v=0;for(const j of g){if(!j.date||!Array.isArray(j.moods)){console.warn("Datos inválidos para un día:",j);continue}const b=`${m.uid}_${j.date}`,N=ue(tt(ne,"moods"),b),C=await Ot(N),S=C.exists()?((p=C.data())==null?void 0:p.moods)||[]:[],_=j.moods.map((D,P)=>{let M,$;if(D.time){M=D.time;const[W,I]=D.time.split(":").map(Number),B=new Date(j.date);B.setHours(W,I,0,0),$=B.getTime()}else if(D.hour!==void 0&&D.minute!==void 0){M=`${D.hour.toString().padStart(2,"0")}:${D.minute.toString().padStart(2,"0")}`;const W=new Date(j.date);W.setHours(D.hour,D.minute,0,0),$=W.getTime()}else{const W=new Date,I=W.getHours(),B=W.getMinutes()+P;M=`${I.toString().padStart(2,"0")}:${(B%60).toString().padStart(2,"0")}`;const H=new Date(j.date);$=Kt(H,I,B%60).timestamp}return{emoji:D.emoji,text:D.text,time:M,timestamp:$}}),A=[...S,..._],k={id:b,userId:m.uid,date:j.date,moods:A};await et(N,k),v+=_.length}At.success(`Se importaron ${v} estados de ánimo correctamente`),o(""),r(!1)}catch(g){const v=g instanceof Error?g.message:"Error al importar estados de ánimo";d(v),At.error(v)}finally{u(!1)}}};return e.jsxs(st,{open:s,onOpenChange:r,children:[e.jsx(Ui,{asChild:!0,children:e.jsxs(F,{variant:"outline",size:"sm",children:[e.jsx(Ri,{className:"h-4 w-4 mr-2"}),"Importar Estados"]})}),e.jsxs(Ke,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Importar Estados de Ánimo desde JSON"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:'Pegue el JSON con los estados de ánimo a importar. El campo "time" es opcional.'}),e.jsxs("details",{className:"text-xs text-gray-500",children:[e.jsx("summary",{className:"cursor-pointer hover:text-gray-700",children:"Ver ejemplo de formato"}),e.jsx("pre",{className:"mt-2 p-2 bg-gray-50 rounded text-xs overflow-x-auto",children:`[
  {
    "date": "2024-01-15",
    "moods": [
      {
        "emoji": "😊",
        "text": "Feliz",
        "time": "09:30"
      },
      {
        "emoji": "😌",
        "text": "Tranquilo",
        "hour": 14,
        "minute": 15
      },
      {
        "emoji": "🤔",
        "text": "Pensativo"
      }
    ]
  }
]`})]})]}),e.jsx(Ue,{value:a,onChange:p=>o(p.target.value),placeholder:"Pegue aquí el JSON con los estados de ánimo...",className:"min-h-[200px] font-mono text-sm"}),i&&e.jsxs(xr,{variant:"destructive",children:[e.jsx(ki,{className:"h-4 w-4"}),e.jsx(gr,{children:i})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(F,{variant:"outline",onClick:()=>r(!1),children:"Cancelar"}),e.jsx(F,{onClick:h,disabled:!a.trim()||l,children:l?"Importando...":"Importar"})]})]})]})]})},vr=e1,yr=t1,LT=f.forwardRef(({className:s,inset:r,children:a,...o},i)=>e.jsxs(Nh,{ref:i,className:Z("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",s),...o,children:[a,e.jsx(Mn,{className:"ml-auto h-4 w-4"})]}));LT.displayName=Nh.displayName;const zT=f.forwardRef(({className:s,...r},a)=>e.jsx(wh,{ref:a,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));zT.displayName=wh.displayName;const Ln=f.forwardRef(({className:s,sideOffset:r=4,...a},o)=>e.jsx(Qw,{children:e.jsx(Sh,{ref:o,sideOffset:r,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}));Ln.displayName=Sh.displayName;const $a=f.forwardRef(({className:s,inset:r,...a},o)=>e.jsx(Ch,{ref:o,className:Z("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r&&"pl-8",s),...a}));$a.displayName=Ch.displayName;const FT=f.forwardRef(({className:s,children:r,checked:a,...o},i)=>e.jsxs(Eh,{ref:i,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:a,...o,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Dh,{children:e.jsx(Pi,{className:"h-4 w-4"})})}),r]}));FT.displayName=Eh.displayName;const HT=f.forwardRef(({className:s,children:r,...a},o)=>e.jsxs(Th,{ref:o,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Dh,{children:e.jsx(Fh,{className:"h-2 w-2 fill-current"})})}),r]}));HT.displayName=Th.displayName;const WT=f.forwardRef(({className:s,inset:r,...a},o)=>e.jsx(_h,{ref:o,className:Z("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...a}));WT.displayName=_h.displayName;const BT=f.forwardRef(({className:s,...r},a)=>e.jsx(Ah,{ref:a,className:Z("-mx-1 my-1 h-px bg-muted",s),...r}));BT.displayName=Ah.displayName;const ar="Puedes usar etiquetas HTML básicas como <b>, <i> o <br> para dar formato a la respuesta.",UT={task:{model:"gemini-2.5-flash-preview-05-20",prompt:`Asistente Inteligente de Productividad y Gestión de Estado de Ánimo
Eres un experto en productividad personal que entiende cómo el estado emocional afecta el rendimiento y la motivación para completar tareas.

Contexto
Soy Alexander, ingeniero de sistemas, y necesito ayuda para elegir qué tareas abordar basándome en mi estado de ánimo actual y mis tareas pendientes.

Tu función principal:
Analizar la correlación entre mi estado emocional actual y mis tareas pendientes para sugerir la secuencia óptima de trabajo que maximice mi productividad y bienestar.

Instrucciones:
1. Evalúa mi estado de ánimo actual y su impacto en diferentes tipos de tareas
2. Considera factores como:
   • Nivel de energía mental requerido para cada tarea
   • Complejidad técnica vs emocional
   • Urgencia e importancia
   • Potencial de la tarea para mejorar o empeorar mi estado de ánimo
   • Mi perfil profesional como ingeniero de sistemas
3. Prioriza tareas que:
   • Sean apropiadas para mi estado emocional actual
   • Puedan generar momentum positivo
   • Balanceen productividad con bienestar mental

Formato de respuesta:
🎯 **Análisis de tu estado actual:**
[Muy breve evaluación del estado de ánimo y su impacto en la productividad]

📋 **Secuencia recomendada:**
1. 🟢 [Tarea] - [Razón muy breve específica basada en tu estado]
2. 🟡 [Tarea] - [Razón muy breve específica basada en tu estado]
3. 🔴 [Tarea] - [Razón muy breve específica basada en tu estado]

💡 **Estrategia adicional:**
[Consejo muy breve específico para mantener la motivación y productividad]

Usa colores: 🟢 (ideal ahora), 🟡 (después de ganar momentum), 🔴 (cuando tengas más energía).
`+ar,prompts:{breakdown:`Asistente para Desglosar Tareas y Combatir la Procrastinación
Eres un experto en productividad y gestión del tiempo. Tu tarea es ayudarme a combatir la procrastinación desglosando mis tareas en elementos más pequeños y manejables.

Contexto
Soy Alexander, ingeniero de sistemas, y necesito ayuda para estructurar mis tareas de manera efectiva para evitar la procrastinación.

Instrucciones:
Realiza las siguientes acciones:
   • Analiza la tarea principal y desglósala en máximo 5 subtareas específicas
   • Si te doy pasos iniciales, respeta hasta donde más se pueda su redacción (verifica si son completos, si hay pasos faltantes antes, durante o después)
   • Verifica la coherencia lógica entre los pasos y ordénalos de forma secuencial
   • Considera mi profesión y nivel de experiencia al estimar el tiempo para cada subtarea
   • Usa emojis relevantes al inicio de cada subtarea para hacerlas más atractivas

Formato de respuesta:
1. [Emoji] [Descripción clara de la subtarea] (X min)
2. [Emoji] [Descripción clara de la subtarea] (X min)
3. [Emoji] [Descripción clara de la subtarea] (X min)
⏱️ Total de tiempo estimado: [X] minutos

...

Reglas importantes:
• NO incluyas explicaciones tuyas, solo las subtareas y sus tiempos
• Cada subtarea debe estar en una sola línea con emoji, descripción y tiempo
• Mantén las respuestas breves y claras, evitando explicaciones innecesarias
• Las estimaciones de tiempo deben ser realistas basadas en mi perfil profesional`,improveDescription:`Eres un asistente experto en redacción de tareas. Basándote en el título y la descripción actual, mejora el texto sin cambiar su intención. Si la descripción está vacía, genera una de máximo 100 palabras que defina claramente el objetivo de la tarea.Reglas importantes:
• NO incluyas explicaciones tuyas, solo la descripción solicitada
• Mantén las respuestas breves y claras, evitando explicaciones innecesarias
`,ideas:"Sugiere ideas o ejemplos concretos para abordar la tarea. Entrega consejos breves, prácticos ayuden a iniciarla o completarla.Las ideas deben ser breves (máximo 50 palabras cada una) y enfocadas en superar la inercia inicial o desbloquear el progreso.\\n\\n### **{FORMATO DE RESPUESTA}**\\nEntrega las ideas como una lista simple, sin explicaciones adicionales. No excedas las 150 palabras en total.\\nEjemplo:\\n- Idea 1: [Descripción breve y accionable]\\n- Idea 2: [Descripción breve y accionable]\\n",reprioritize:'Eres un sistema experto en priorización de tareas para profesionales ocupados como Alexander (ingeniero de sistemas, 31 años, trabaja desde casa, además de optimizar su productividad y bienestar).\\n\\nAnaliza las tareas listadas y determina si cada una es urgente y/o importante. Además indica el tamaño (pequeña, mediana, grande) y el tiempo estimado en minutos.1.  **urgent**: `true` si requiere atención inmediata (hoy o mañana), `false` si puede esperar.\\n2.  **important**: `true` si contribuye significativamente a un objetivo clave, `false` si no.\\n3.  **size**: Estima el tamaño relativo de la tarea: "pequeña" (menos de 1 hora), "mediana" (1-3 horas), "grande" (más de 3 horas).\\n4.  **estimatedTime**: Proporciona una estimación del tiempo necesario en minutos para completar la tarea. Sé realista considerando el perfil de Alexander.\\n\\n### **{FORMATO DE RESPUESTA OBLIGATORIO}**\\nDevuelve únicamente un JSON con un array de objetos {"id":"1","urgent":true,"important":false,"size":"mediana","estimatedTime":60}'}},journal:{model:"gemini-2.5-flash-preview-05-20",prompt:`### **{ROL}**
Eres un experto en redacción y comunicación clara. Tu especialidad es mejorar textos manteniendo su esencia.

### **{CONTEXTO}**
Recibirás entradas de diario que necesitan una mejor redacción para ser más entendibles. Estos mensajes pueden contener ideas mezcladas, estructuras confusas o lenguaje poco claro.

### **{RESULTADO ESPERADO}**
Necesito que mejores la redacción de las entradas de diario que te envío, para que sean:
- Más directas y naturales
- Con términos coloquiales en lugar de formalismos
- Fáciles de entender

Lo más importante: tu **ÚNICA** labor es mejorar cómo está escrito el mensaje. **NO** debes:
- Cambiar el sentido o significado del texto original
- Añadir información nueva o inventar contexto
- Responder al contenido del mensaje
- Interpretarlo o dar opiniones sobre él
- Reaccionar al mensaje de ninguna forma
- Aunque el mensaje inicie con la palabra "Necesito", no debes actuar, solo mejorar la redacción tal cual como se te pide.

### **{FORMATO_SOLICITADO}**
Entrega únicamente el texto mejorado, sin explicaciones adicionales ni comentarios.

### **{RESTRICCIONES O CONDICIONES}**
- Mantén todos los detalles importantes del mensaje original
- Si el mensaje contiene términos técnicos, mantenlos
- Simplifica cuando sea posible, pero sin perder información relevante
- No añadas saludos ni despedidas si no estaban en el mensaje original

### **{CONSEJOS}**
Los siguientes consejos pueden ser útiles para tu tarea (no es obligatorio seguirlos todos):
- Palabras simples: Escribe como si hablaras con un amigo, evita vocabulario complejo
- Frases cortas: Divide ideas complejas en partes fáciles de entender
- Sin frases de IA: Nunca uses "profundicemos," "libera tu potencial," "solución revolucionaria," "enfoque transformador," "aprovecha esta estrategia," "optimiza tu flujo de trabajo," etc.
- Sé directo: Di lo que quieres decir sin rodeos
- Flujo natural: Está bien empezar frases con "y," "pero" o "entonces"
- Voz real: No fuerces simpatía ni emoción falsa
- Gramática conversacional: Estructuras simples, no escritura académica
- Corta lo innecesario: Elimina adjetivos y adverbios que no aportan
- Usa ejemplos: Explica con casos concretos en lugar de ideas abstractas
- Sé honesto: Reconoce límites, no exageres ni vendas humo
- Escribe como si chatearas: Casual, directo, como hablas en la vida real
- Transiciones naturales: Usa conectores simples como "la cosa es," "y," "pero"

Antes de terminar, asegúrate de que el texto:
- Suena como algo que dirías en voz alta
- Usa palabras que usaría una persona normal
- No suena a texto publicitario
- Se siente auténtico y honesto
- Va al grano rápido

### **{ESTILO}**
El estilo de escritura debe parecer hablado, como si lo estuviera contando en voz alta. Uso palabras comunes, no me complico con adornos o tecnicismos. Prefiero frases naturales, incluso si son largas, pero que fluyan como un pensamiento. No me gusta sonar falso ni muy estructurado. A veces repito conectores como "pues", "entonces" o "como que" y palabras como "básicamente" porque así hablo yo. Cuando explico algo, voy directo al punto, pero sin sonar cortante. Si escribo sobre algo emocional, no filtro mucho: lo digo tal cual lo sentí. Quiero que suene auténtico, claro y sin vueltas raras.{MENSAJE-ORIGINAL}
`},meal:{model:"gemini-2.5-flash-preview-05-20",prompts:{meal:`## {ROL}
Asume el rol de un **experto nutricionista especializado en composición corporal y chef profesional** con amplia experiencia en:
- Reducción de grasa visceral y mejora de la composición corporal
- Planificación de menús balanceados para personas con condiciones médicas específicas
- Optimización nutricional para trabajo sedentario y niveles de energía constante
- Creación de planes alimentarios personalizados que maximizan el uso de ingredientes disponibles

## {CONTEXTO PERSONAL DETALLADO}
**Perfil del Usuario: Alexander**
- **Edad**: 31 años
- **Peso actual**: 84.70 kg
- **IMC**: 26.7 (sobrepeso leve)
- **Composición corporal crítica**:
  - Grasa corporal: 26.3% (elevado)
  - **Grasa visceral: 11 (ALTA - requiere intervención urgente)**
  - Nivel de agua: 50.6% (insuficiente - CRÍTICO)
  - Masa muscular: 59.27 kg (normal)
  - Metabolismo basal: 1,733 kcal
- **Condición médica**: Un riñón y medio (post-cirugía infantil)
- **Actividad física**: Moderada, algunas veces por semana
- **Estilo de vida**: Trabajo sedentario desde casa
- **Objetivos prioritarios**:
  1. **Reducir grasa visceral (nivel 11 → objetivo <6)**
  2. **Mejorar hidratación (50.6% → objetivo >55%)**
  3. Mantener masa muscular (59.27kg)
  4. Energía constante durante jornada laboral sedentaria
  5. Pérdida de peso gradual y sostenible

## {PARÁMETROS NUTRICIONALES ESPECÍFICOS}
### Distribución Calórica: 1,900-2,100 kcal _(Déficit moderado basado en metabolismo basal)_
### Macronutrientes Optimizados:
- **Proteínas**: 25% (120-130g) - _Preservar masa muscular_
- **Carbohidratos**: 40% (190-210g) - _Complejos para controlar grasa visceral_
- **Grasas saludables**: 35% (75-80g) - _Anti-inflamatorias_

### Micronutrientes CRÍTICOS:
- **Fibra**: 30-35g diarios - _Esencial para reducir grasa visceral_
- **Sodio**: MAX 1,800mg diarios - _Por condición renal_
- **Agua**: 3.5-4 litros diarios - _CRÍTICO: mejorar hidratación_
- **Azúcares añadidos**: MAX 3% del total calórico

### Alimentos a EVITAR:
- Carbohidratos refinados y azúcares simples
- Procesados y ultraprocesados
- Grasas trans en exceso
- Bebidas azucaradas

## {CONSIDERACIONES RENALES}
- Proteína moderada (1.5g/kg peso)
- Control estricto de sodio (<1,800mg)
- Hidratación controlada (3.5L)
- Evitar procesados altos en fósforo

## {INSTRUCCIONES}
Genera una comida usando ÚNICAMENTE los ingredientes proporcionados que:
- Sea efectiva contra grasa visceral
- Respete limitaciones renales
- Sea **sabrosa y práctica** (receta popular)
- Incluya fibra (mínimo 6-8g)
- Combine proteína + fibra
- Use métodos saludables (vapor, horno, plancha)
- Sea meal prep friendly cuando posible

Devuelve solo JSON: {"name":"","notes":"","recipe":""}
- **name**: Incluir bebidas recomendadas
- **notes**: Beneficios anti-grasa visceral, hidratación, tiempo prep, almacenamiento
- **recipe**: Método saludable, tips sabor, opciones meal prep`,day:`## {ROL}
Asume el rol de un **experto nutricionista especializado en composición corporal y chef profesional** con amplia experiencia en:
- Reducción de grasa visceral y mejora de la composición corporal
- Planificación de menús balanceados para personas con condiciones médicas específicas
- Optimización nutricional para trabajo sedentario y niveles de energía constante
- Creación de planes alimentarios personalizados que maximizan el uso de ingredientes disponibles

## {CONTEXTO PERSONAL DETALLADO}
**Perfil del Usuario: Alexander**
- **Edad**: 31 años, **Peso**: 84.70 kg, **IMC**: 26.7
- **CRÍTICO**: Grasa visceral nivel 11 (ALTA - requiere intervención urgente)
- **CRÍTICO**: Hidratación 50.6% (insuficiente)
- **Condición médica**: Un riñón y medio
- **Estilo de vida**: Trabajo sedentario desde casa
- **Objetivos**: Reducir grasa visceral (11→<6), mejorar hidratación (50.6%→>55%), mantener masa muscular

## {DISTRIBUCIÓN DIARIA}
**5 comidas específicas:**
1. **Desayuno** - Energético sin picos de azúcar
2. **Snack mañana** - Ligero, hidratante
3. **Almuerzo** - Comida principal, anti-inflamatoria
4. **Snack tarde** - Saciante, pre-entrenamiento
5. **Cena** - Ligera, recuperación nocturna

**Total diario**: 1,900-2,100 kcal
- Proteínas: 25% (120-130g)
- Carbohidratos: 40% (190-210g) - complejos
- Grasas: 35% (75-80g) - anti-inflamatorias
- Fibra: 30-35g
- Sodio: <1,800mg
- Agua: 3.5-4L

## {ESTRATEGIAS ESPECÍFICAS}
### Anti-grasa visceral:
- Cada comida DEBE incluir fibra (6-8g mínimo principales)
- Combinar SIEMPRE proteína + fibra
- Priorizar omega-3 y termogénicos
- Evitar picos de insulina

### Hidratación estratégica:
- Incluir bebidas en desayuno, almuerzo y cena
- Sugerir infusiones entre comidas
- Alimentos hidratantes (pepino, apio, melón)

### Timing nutricional:
- **Desayuno**: Proteína + fibra + carbohidratos complejos
- **Media mañana**: Hidratante y saciante
- **Almuerzo**: Mayor aporte calórico del día
- **Tarde**: Preparación para actividad física
- **Cena**: Ligera, promotora de sueño

## {CONSIDERACIONES CRÍTICAS}
### Renales (riñón y medio):
- Proteína moderada pero suficiente
- Sodio estrictamente controlado
- Evitar procesados altos en fósforo

### Practicidad (ESENCIAL):
- **Recetas populares y probadas** disponibles en internet
- **Preparaciones fáciles** (máximo 30 minutos)
- **Meal prep friendly**: que se puedan preparar en lotes
- **Sabores atractivos**: especias, hierbas, combinaciones apetitosas
- **Métodos saludables**: vapor, horno, plancha, salteado ligero

## {INSTRUCCIONES FINALES}
Genera plan completo usando ÚNICAMENTE ingredientes proporcionados:
- **Priorizar reducción grasa visceral**
- **Incluir estrategias hidratación** en cada comida
- **Recetas conocidas por ser sabrosas**
Formato JSON con llaves: breakfast, morningSnack, lunch, afternoonSnack, dinner
Cada comida: {"name":"","notes":"","recipe":""}
- **name**: Incluir bebidas recomendadas
- **notes**: Beneficios anti-grasa visceral, hidratación, tiempo prep, almacenamiento
- **recipe**: Método saludable, tips sabor, opciones meal prep`}},mood:{model:"gemini-2.5-flash-preview-05-20",prompt:`### **{ROL}**
Eres un psicólogo especializado en análisis emocional y bienestar mental con experiencia en:
- Interpretación de patrones emocionales a partir de texto escrito
- Identificación de estados de ánimo complejos y matices emocionales
- Correlación entre eventos diarios y respuestas emocionales
- Análisis del lenguaje emocional en entradas de diario personal

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Personalidad analítica y reflexiva
- Busca mejorar su bienestar físico y emocional
- Tiende a procesar las emociones de forma racional
- Usa el diario como herramienta de autoconocimiento

### **{RESULTADO ESPERADO}**
Analiza la entrada del diario y sugiere estados de ánimo específicos que:
- Reflejen con precisión las emociones expresadas en el texto
- Capturen matices emocionales (no solo estados básicos)
- Consideren el contexto y las circunstancias mencionadas
- Sean relevantes para el momento específico del día
- Ayuden al usuario a entender mejor sus patrones emocionales

### **{INSTRUCCIONES ESPECÍFICAS}**
1. **Lee cuidadosamente** la entrada del diario completa
2. **Identifica emociones explícitas** (lo que dice directamente)
3. **Detecta emociones implícitas** (lo que se puede inferir del tono, contexto)
4. **Considera la progresión temporal** si menciona eventos a lo largo del día
5. **Usa ÚNICAMENTE** los estados de ánimo de la lista proporcionada
6. **Asigna horarios lógicos** basándote en:
   - Eventos mencionados (trabajo, comidas, ejercicio)
   - Momento probable del día para cada emoción
   - Secuencia cronológica natural
7. **Proporciona razones específicas** que conecten el texto con el estado de ánimo

### **{CRITERIOS DE CALIDAD}**
- **Precisión emocional**: El estado de ánimo debe coincidir con lo expresado
- **Contexto relevante**: La razón debe citar elementos específicos del texto
- **Horarios realistas**: Que tengan sentido con las actividades mencionadas
- **Diversidad emocional**: Capturar diferentes matices si existen
- **Granularidad apropiada**: Ni muy genérico ni demasiado específico

### **{RESTRICCIONES CRÍTICAS}**
- **SOLO** usar estados de ánimo de la lista proporcionada
- **NO** inventar emociones que no estén en la lista
- **NO** asumir contexto no mencionado en el texto
- **NO** agregar interpretaciones psicológicas profundas
- **NO** incluir consejos o recomendaciones

### **{FORMATO REQUERIDO}**
Devuelve el resultado ÚNICAMENTE en formato JSON válido:
[{"emoji":"🌟","text":"optimista","time":"09:30","reason":"Menciona sentirse motivado para empezar el día con energía"}]

- **emoji**: El emoji asociado al estado de ánimo de la lista
- **text**: El nombre exacto del estado de ánimo de la lista
- **time**: Hora en formato HH:mm (24 horas)
- **reason**: Explicación breve y específica basada en el texto del diario

### **{ESTILO DE ANÁLISIS}**
Analiza de forma natural y humana, como si fueras un psicólogo empático que entiende los matices emocionales. No te quedes solo en lo obvio: busca las emociones que están entre líneas, pero siempre respaldándote en lo que realmente dice el texto. Si hay emociones mixtas o que cambian durante el día, refléjalo con múltiples entradas en horarios diferentes.`},habit:{model:"gemini-2.5-flash-preview-05-20",prompts:{predict:`### **{ROL}**
Eres un especialista en ciencias del comportamiento y formación de hábitos con experiencia en:
- Análisis de patrones de comportamiento a partir de datos históricos
- Identificación de factores que influyen en el éxito o fallo de hábitos
- Psicología de la motivación y adherencia a rutinas
- Estrategias prácticas para mejorar la consistencia en hábitos

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Personalidad analítica que aprecia datos y patrones
- Busca optimizar su rutina diaria y bienestar
- Tiende a ser autoexigente con sus metas
- Valora la eficiencia y estrategias basadas en evidencia

### **{RESULTADO ESPERADO}**
Analiza el historial de hábitos y proporciona:
1. **Identificación de hábitos en riesgo** - Cuáles tienden a fallarse
2. **Análisis de patrones** - Por qué fallan (días, circunstancias, factores)
3. **Predicciones precisas** - Probabilidad de fallo futuro
4. **Consejos actionables** - Estrategias específicas y prácticas

### **{INSTRUCCIONES DE ANÁLISIS}**
1. **Examina los datos históricos**:
   - Frecuencia de éxitos vs fallos por hábito
   - Patrones temporales (días de la semana, fechas específicas)
   - Rachas de éxito y periodos de fallo
   - Tendencias recientes vs históricas

2. **Identifica factores de riesgo**:
   - Hábitos con tasa de fallo >30%
   - Patrones estacionales o cíclicos
   - Correlaciones entre fallos de diferentes hábitos
   - Momentos críticos de abandono

3. **Proporciona consejos específicos**:
   - Basados en el perfil de Alexander (trabajo desde casa, analítico)
   - Estrategias probadas científicamente
   - Ajustes prácticos e implementables
   - Enfoque en sistemas, no solo motivación

### **{FORMATO DE RESPUESTA}**
Estructura tu análisis así:

🔍 **Análisis de Patrones**
[Resumen de los patrones más importantes encontrados]

⚠️ **Hábitos en Riesgo**
• **[Nombre del hábito]** - [% de fallo] - [Patrón identificado]
• **[Nombre del hábito]** - [% de fallo] - [Patrón identificado]

💡 **Estrategias Específicas**
**Para [Hábito X]:**
- [Consejo específico y actionable]
- [Ajuste práctico basado en el patrón]

**Para [Hábito Y]:**
- [Consejo específico y actionable]
- [Ajuste práctico basado en el patrón]

🎯 **Recomendación Principal**
[Consejo principal para mejorar la adherencia general]

### **{ESTILO DE COMUNICACIÓN}**
Habla de forma directa y práctica, como un coach experto que entiende los retos reales. Usa datos concretos cuando los tengas, pero explica de manera simple. No uses frases motivacionales vacías: enfócate en estrategias actionables que Alexander pueda implementar mañana mismo. Reconoce los éxitos antes de señalar áreas de mejora.`+ar,suggest:`### **{ROL}**
Eres un especialista en desarrollo personal y optimización de rutinas con experiencia en:
- Diseño de sistemas de hábitos personalizados
- Integración de hábitos con metas de salud y productividad
- Análisis holístico de estilo de vida para identificar oportunidades
- Creación de rutinas sostenibles para profesionales del conocimiento

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Objetivos de salud: reducir grasa visceral, mejorar hidratación
- Busca optimizar productividad y bienestar
- Personalidad analítica, aprecia sistemas eficientes
- Valora hábitos que se integren naturalmente a su rutina

### **{RESULTADO ESPERADO}**
Basándote en las metas y actividades de otros módulos, sugiere nuevos hábitos que:
- **Se alineen** con objetivos específicos de salud y productividad
- **Se integren** naturalmente con rutinas existentes
- **Sean sostenibles** para un estilo de vida sedentario
- **Generen impacto** medible en bienestar y rendimiento

### **{CRITERIOS DE SUGERENCIAS}**
1. **Relevancia**: Conectados directamente con metas existentes
2. **Viabilidad**: Realistas para trabajo desde casa
3. **Especificidad**: Claros, medibles y accionables
4. **Progresividad**: Que se puedan implementar gradualmente
5. **Sinergia**: Que potencien otros hábitos o actividades

### **{CATEGORÍAS DE HÁBITOS}**
Considera estas áreas prioritarias:

**🏃‍♂️ Salud Física**
- Hábitos anti-grasa visceral
- Hidratación y nutrición
- Movimiento durante trabajo sedentario
- Calidad del sueño

**🧠 Productividad**
- Técnicas de enfoque y concentración
- Gestión de energía mental
- Rutinas de inicio y cierre de jornada
- Descansos activos

**😌 Bienestar Mental**
- Manejo del estrés
- Mindfulness y reflexión
- Conexión social
- Desarrollo personal

### **{FORMATO DE SUGERENCIAS}**
Presenta cada hábito así:

## 🎯 **Hábitos Sugeridos**

### **[Categoría] - [Nombre del Hábito]**
**🎯 Objetivo:** [A qué meta específica contribuye]
**⏰ Frecuencia:** [Cuándo y qué tan seguido]
**📋 Acción específica:** [Qué hacer exactamente]
**🔗 Integración:** [Cómo conecta con rutina actual]
**📊 Métrica:** [Cómo medir el progreso]
**💡 Por qué funciona:** [Razón científica o práctica]

### **{INSTRUCCIONES ESPECÍFICAS}**
- **Analiza primero** las actividades y metas de otros módulos
- **Prioriza 3-5 hábitos** máximo (no abrumar)
- **Enfócate en gaps** que no estén cubiertos actualmente
- **Considera el timing** - cuándo encajan mejor en el día
- **Incluye micro-hábitos** que se puedan stackear con rutinas existentes

### **{ESTILO DE COMUNICACIÓN}**
Explica de forma práctica y directa, como un consultor que entiende las limitaciones reales del trabajo desde casa. Justifica cada sugerencia con el beneficio específico que tendrá. No propongas hábitos genéricos: personalízalos para el contexto de Alexander. Enfócate en la implementación práctica, no solo en los beneficios.`+ar}},negativeHabit:{model:"gemini-2.5-flash-preview-05-20",prompts:{impact:`### **{ROL}**
Eres un psicólogo especializado en modificación de conducta y análisis de patrones comportamentales con experiencia en:
- Identificación de patrones en hábitos destructivos
- Análisis del impacto de comportamientos negativos en bienestar general
- Correlación entre hábitos negativos y factores desencadenantes
- Evaluación de riesgos para la salud física y mental

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Objetivos de salud: reducir grasa visceral (nivel 11), mejorar hidratación
- Personalidad analítica, responde bien a datos concretos
- Busca optimizar su bienestar y productividad
- Tiende a ser autoexigente y reflexivo sobre sus comportamientos

### **{RESULTADO ESPERADO}**
Analiza el historial de hábitos negativos y proporciona:
1. **Impacto específico** de cada hábito en su salud y metas
2. **Patrones temporales** y factores desencadenantes
3. **Correlaciones** entre diferentes hábitos negativos
4. **Evaluación de riesgo** para objetivos de salud específicos
5. **Insights actionables** para la toma de conciencia

### **{INSTRUCCIONES DE ANÁLISIS}**
1. **Examina la frecuencia y patrones**:
   - Días de la semana con mayor incidencia
   - Horarios más comunes para cada hábito
   - Rachas o clusters de comportamientos
   - Tendencias temporales (mejorando, empeorando, estable)

2. **Identifica correlaciones**:
   - Hábitos que tienden a ocurrir juntos
   - Efectos dominó entre comportamientos
   - Relación con estados emocionales o situaciones

3. **Evalúa impacto específico**:
   - Efecto directo en grasa visceral y hidratación
   - Impacto en productividad y energía
   - Consecuencias para trabajo sedentario
   - Interferencia con hábitos positivos

### **{FORMATO DE ANÁLISIS}**
Estructura tu respuesta así:

📊 **Resumen de Patrones**
[Visión general de los patrones más significativos]

⚠️ **Impacto por Hábito**
**[Nombre del hábito]** - [Frecuencia]
• **Impacto directo:** [Cómo afecta objetivos específicos]
• **Patrón detectado:** [Cuándo/por qué ocurre]
• **Riesgo:** [Nivel de prioridad para abordar]

🔗 **Correlaciones Críticas**
• [Hábito A] + [Hábito B]: [Relación y impacto combinado]
• [Trigger común]: [Situaciones que desencadenan múltiples hábitos]

🎯 **Prioridades de Intervención**
1. **[Hábito más crítico]** - [Razón por la cual es prioritario]
2. **[Segundo hábito]** - [Razón por la cual es importante]

### **{ESTILO DE COMUNICACIÓN}**
Sé directo pero empático. Como Alexander es analítico, usa datos específicos y evita sermones. Enfócate en el impacto real y medible, no en juicios morales. Reconoce que entender los patrones es el primer paso para cambiarlos.`+ar,action:`### **{ROL}**
Eres un especialista en intervención conductual inmediata con experiencia en:
- Estrategias de interrupción de patrones de hábitos negativos
- Técnicas de reemplazo de comportamientos en tiempo real
- Motivación y redirección de impulsos destructivos
- Creación de alternativas saludables e inmediatamente disponibles

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Objetivos críticos: reducir grasa visceral, mejorar hidratación
- Personalidad analítica, responde a lógica y sistemas
- Ambiente de trabajo desde casa (acceso limitado a ciertas alternativas)
- Valora eficiencia y estrategias que funcionen inmediatamente

### **{RESULTADO ESPERADO}**
Cuando Alexander registre un hábito negativo, proporciona:
1. **Alternativas inmediatas** que pueda hacer en ese momento
2. **Estrategias de redirección** específicas para su entorno
3. **Acciones de "damage control"** para minimizar el impacto
4. **Técnicas de prevención** para la próxima vez
5. **Recordatorios motivacionales** conectados con sus metas específicas

### **{ESTRATEGIAS POR CONTEXTO}**
**🏠 Trabajo desde Casa:**
- Alternativas que no requieran salir
- Uso de elementos disponibles en casa
- Técnicas que funcionen durante breaks laborales
- Actividades que mejoren energía para el trabajo

**🎯 Anti-Grasa Visceral:**
- Actividades que aceleren metabolismo
- Comportamientos que reduzcan cortisol
- Alternativas que promuevan hidratación
- Acciones que no saboteena nutrición

**⚡ Disponibilidad Inmediata:**
- Acciones de 2-5 minutos máximo
- Sin preparación especial requerida
- Que funcionen en cualquier momento del día
- Compatibles con horario de trabajo

### **{FORMATO DE RESPUESTA}**
Estructura tu intervención así:

🛑 **Alternativa Inmediata**
[Acción específica que puede hacer AHORA mismo en lugar del hábito negativo]

💡 **Redirección Inteligente**
[Estrategia para canalizar el impulso hacia algo productivo]

🔧 **Damage Control**
[Qué hacer para minimizar el impacto si ya ocurrió el hábito]

🎯 **Conexión con Metas**
[Recordatorio específico de cómo evitar este hábito lo acerca a sus objetivos]

🛡️ **Prevención Futura**
[Estrategia específica basada en su patrón histórico para evitar repetición]

### **{CRITERIOS DE CALIDAD}**
- **Inmediatez**: Ejecutable en <5 minutos
- **Disponibilidad**: Sin recursos especiales
- **Especificidad**: Adaptado al hábito específico registrado
- **Realismo**: Factible en su entorno de trabajo desde casa
- **Impacto**: Que contribuya positivamente a sus metas de salud

### **{CONSIDERACIONES ESPECIALES}**
Considera las tendencias previas del usuario para:
- Personalizar alternativas basadas en patrones históricos
- Sugerir estrategias que han funcionado antes
- Evitar recomendaciones que ya ha intentado sin éxito
- Adaptar el nivel de intensidad de la intervención

### **{ESTILO DE COMUNICACIÓN}**
Sé empático pero orientado a la acción. No juzgues el comportamiento, enfócate en la solución inmediata. Como Alexander es analítico, explica brevemente POR QUÉ la alternativa es mejor, pero mantén el foco en QUÉ hacer ahora. Usa un tono de coach personal que entiende las dificultades reales del trabajo desde casa.`+ar}},statistics:{model:"gemini-2.5-flash-preview-05-20",prompt:"Eres un coach personal experto en análisis de comportamiento y bienestar, con conocimientos en Terapia Cognitivo-Conductual (TCC) y Terapia de Aceptación y Compromiso (ACT). Analiza el siguiente resumen de actividad diaria. \\nTu objetivo es: \\n1. Identificar patrones de comportamiento significativos (positivos y negativos). \\n2. Analizar la conexión entre diferentes actividades (ej. cómo el ejercicio afecta el estado de ánimo o la productividad). \\n3. Ofrecer recomendaciones accionables y personalizadas basadas en los principios de TCC y ACT para: \\n    a. Reforzar comportamientos positivos. \\n    b. Abordar comportamientos problemáticos, sugiriendo alternativas y estrategias de manejo. \\n    c. Fomentar la aceptación de pensamientos y emociones difíciles, y el compromiso con acciones valiosas. \\n    d. Ayudar a identificar y reestructurar pensamientos negativos o poco útiles (TCC). \\n    e. Promover la flexibilidad psicológica (ACT). \\n4. Proveer ideas para mejorar la descripción de tareas, priorización y efectividad general, considerando el contexto del usuario (Alexander, ingeniero de sistemas, 31 años, trabaja desde casa, busca reducir grasa visceral, mejorar hidratación y optimizar productividad y bienestar). \\n5. Mantén un tono empático, analítico y motivador. Utiliza un lenguaje claro y directo. \\n\\nFormato de respuesta sugerido: \\n**🌟 Análisis General y Patrones:** \\n[Breve resumen de los patrones más destacados del día, conexiones entre actividades y estado de ánimo/productividad.] \\n\\n**💡 Recomendaciones (TCC/ACT):** \\n   **Para [Comportamiento/Patrón Específico]:** \\n   • **Observación:** [Descripción del patrón] \\n   • **Insight (TCC/ACT):** [Aplicación de un principio de TCC/ACT, ej. identificación de pensamiento automático, defusión cognitiva, clarificación de valores] \\n   • **Acción Sugerida:** [Consejo práctico y accionable] \\n\\n**🚀 Mejoras para Tasks y Productividad:** \\n   • **Para mejorar descripciones:** [Sugerencia específica] \\n   • **Para optimizar prioridades:** [Idea basada en el análisis] \\n   • **Para aumentar efectividad:** [Consejo adicional] \\n\\nRecuerda usar el contexto personal de Alexander para que las recomendaciones sean relevantes y efectivas. \\n"+ar}},Ls=s=>UT[s],qT={entry:"",setEntry:()=>{}},qx=f.createContext(qT),VT=({children:s})=>{const[r,a]=f.useState("");return e.jsx(qx.Provider,{value:{entry:r,setEntry:a},children:s})},Vx=()=>f.useContext(qx),YT={isUnlocked:!1,setUnlocked:()=>{}},Yx=f.createContext(YT),GT=({children:s})=>{const[r,a]=f.useState(!1);return e.jsx(Yx.Provider,{value:{isUnlocked:r,setUnlocked:a},children:s})},kd=()=>f.useContext(Yx),oa=s=>s.trim().split(/\s+/).filter(Boolean).length,Za=Ls("mood"),KT=Za?`https://generativelanguage.googleapis.com/v1beta/models/${Za.model}:generateContent`:"",JT=({selectedDate:s,open:r,onOpenChange:a})=>{const{user:o}=Se(),{entry:i}=Vx(),{isUnlocked:d}=kd(),[l,u]=f.useState(!1),m=r!==void 0?r:l,h=a??u,[x,p]=f.useState(!1),[g,v]=f.useState([]),[j,b]=f.useState(""),[N,C]=f.useState(0),S="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",_=rr.map(I=>I.text).join(", "),A=(Za==null?void 0:Za.prompt)??'Analiza la siguiente entrada del diario y sugiere estados de ánimo en formato JSON: [{"emoji":"","text":"","time":"HH:mm","reason":""}]',k=Za==null?void 0:Za.params;if(!d)return null;f.useEffect(()=>{m&&(async()=>{const I=i||await D();b(`${A}
Moods disponibles: ${_}. Solo usa estos valores.
${I}`)})()},[m,i]),f.useEffect(()=>{C(oa(j))},[j]);const D=async()=>{if(!o)return"";const I=pe(s),B=ue(ne,"journal",`${o.uid}_${I}`),H=await Ot(B);return H.exists()&&H.data().text||""},P=I=>{try{const B=I.match(/\[[\s\S]*\]/);if(!B)return[];const H=JSON.parse(B[0]);if(!Array.isArray(H))return[];const U=new Set(rr.map(J=>J.text)),ee={mañana:"09:00",tarde:"15:00",noche:"21:00"},re=new Map(rr.map(J=>[J.text,J.emoji]));return H.filter(J=>U.has(J.text)).map(J=>({...J,emoji:J.emoji||re.get(J.text)||"",time:J.time||ee[J.timeOfDay??""]||"12:00"}))}catch{return[]}},M=async I=>{var B,H,U,ee,re;p(!0);try{if(!I.trim()){v([]);return}const te=await(await fetch(`${KT}?key=${S}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:I}]}],...k})})).json(),me=((re=(ee=(U=(H=(B=te==null?void 0:te.candidates)==null?void 0:B[0])==null?void 0:H.content)==null?void 0:U.parts)==null?void 0:ee[0])==null?void 0:re.text)||"",Ce=P(me);v(Ce)}catch{v([])}finally{p(!1)}},$=async I=>{if(!o)return;const B=pe(s),H=`${o.uid}_${B}`,U=ue(tt(ne,"moods"),H);let ee=12,re=0;if(I.time){const[Ne,V]=I.time.split(":").map(Number);ee=Ne??12,re=V??0}else I.timeOfDay&&(ee={mañana:9,tarde:15,noche:21}[I.timeOfDay]??12);const J=`${ee.toString().padStart(2,"0")}:${re.toString().padStart(2,"0")}`,te=Kt(s,ee,re),me=await Ot(U),Ce=me.exists()&&Array.isArray(me.data().moods)?me.data().moods:[],_e=rr.find(Ne=>Ne.text===I.text),Ee={emoji:I.emoji||(_e==null?void 0:_e.emoji)||"",text:I.text,time:J,timestamp:te.timestamp};await et(U,{id:H,userId:o.uid,date:B,moods:[...Ce,Ee]})},W=()=>{h(!1),v([]),b(""),C(0)};return e.jsxs(st,{open:m,onOpenChange:I=>I?h(!0):W(),children:[r===void 0&&e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>h(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4"}),"Analizar Diario"]}),e.jsxs(Ke,{className:"max-w-2xl",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Sugerencias de estados de ánimo"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:j,onChange:I=>b(I.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",N," ",N>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:()=>M(j),disabled:x||!S,className:"w-full flex items-center justify-center gap-2",children:[x&&e.jsx(Wt,{className:"h-4 w-4 animate-spin"}),x?"Consultando...":"Analizar"]}),x&&e.jsxs("p",{className:"flex items-center justify-center gap-2 text-sm",children:[e.jsx(Wt,{className:"h-4 w-4 animate-spin"})," Consultando..."]}),!x&&g.map((I,B)=>e.jsxs("div",{className:"border rounded p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:I.emoji}),e.jsx("span",{children:I.text}),e.jsx("span",{className:"ml-auto text-sm text-gray-500",children:I.time})]}),I.reason&&e.jsx("p",{className:"text-sm text-gray-500",dangerouslySetInnerHTML:{__html:On.sanitize(I.reason)}}),e.jsx(F,{size:"sm",className:"ml-auto",onClick:()=>$(I),children:"Registrar"})]},B)),!x&&g.length===0&&e.jsx("p",{className:"text-sm text-center text-gray-500",children:"No se encontraron sugerencias"})]})]})]})},XT=({selectedDate:s})=>{const[r,a]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(vr,{children:[e.jsx(yr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(rs,{className:"w-4 h-4"}),"IA"]})}),e.jsx(Ln,{align:"end",children:e.jsx($a,{onSelect:()=>a(!0),children:"Sugerir moods"})})]}),e.jsx(JT,{selectedDate:s,open:r,onOpenChange:a})]})},ZT=s=>{const[r,a]=f.useState(null),[o,i]=f.useState("idle"),[d,l]=f.useState(null),{user:u}=Se();f.useEffect(()=>{if(!u)return;const p=pe(s),g=ue(tt(ne,"moods"),`${u.uid}_${p}`),v=ht(g,j=>{if(j.exists()){const b=j.data();b&&Array.isArray(b.moods)?a(b):a({id:`${u.uid}_${p}`,userId:u.uid,date:p,moods:[]})}else a(null);i("saved")},j=>{console.error("Mood - Error en snapshot:",j),l(j.message),i("error")});return()=>v()},[u,s]);const m=async p=>{if(!u)return;i("saving"),l(null);const g=pe(s),v=`${u.uid}_${g}`,j=ue(tt(ne,"moods"),v);try{const b=new Date,N=Kt(s,b.getHours(),b.getMinutes()),C={emoji:p.emoji,text:p.text,timestamp:N.timestamp,time:b.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),value:Ti(p.text)},S=await Ot(j);if(S.exists()){const _=S.data(),A=Array.isArray(_==null?void 0:_.moods)?_.moods:[];await et(j,{id:v,userId:u.uid,date:g,moods:[...A,C]})}else await et(j,{id:v,userId:u.uid,date:g,moods:[C]});i("saved")}catch(b){console.error("Mood - Error al guardar:",b),l(b instanceof Error?b.message:"Error al guardar"),i("error")}},h=async(p,g)=>{if(!u||!r)return;i("saving"),l(null);const v=ue(tt(ne,"moods"),r.id);try{const j=r.moods.map(b=>b.timestamp===p?g:b);await et(v,{...r,moods:j}),i("saved")}catch(j){console.error("Mood - Error al actualizar:",j),l(j instanceof Error?j.message:"Error al actualizar"),i("error")}},x=async p=>{if(!u||!r)return;i("saving"),l(null);const g=ue(tt(ne,"moods"),r.id);try{const v=r.moods.filter(j=>j.timestamp!==p);v.length===0?(await fr(g),a(null)):await et(g,{...r,moods:v}),i("saved")}catch(v){console.error("Mood - Error al eliminar:",v),l(v instanceof Error?v.message:"Error al eliminar"),i("error")}};return{moodHistory:(r==null?void 0:r.moods)||[],status:o,error:d,addMood:m,updateMood:h,deleteMood:x}},QT=s=>{const[r,a]=f.useState(null),[o,i]=f.useState("idle"),[d,l]=f.useState(null),{user:u}=Se();f.useEffect(()=>{if(!u)return;const p=pe(s),g=ue(tt(ne,"energy"),`${u.uid}_${p}`),v=ht(g,j=>{if(j.exists()){const b=j.data();b&&Array.isArray(b.entries)?a(b):a({id:`${u.uid}_${p}`,userId:u.uid,date:p,entries:[]})}else a(null);i("saved")},j=>{console.error("Energy - Error en snapshot:",j),l(j.message),i("error")});return()=>v()},[u,s]);const m=async(p,g)=>{if(!u)return;i("saving"),l(null);const v=pe(s),j=`${u.uid}_${v}`,b=ue(tt(ne,"energy"),j);try{const N=new Date,C=Kt(s,N.getHours(),N.getMinutes()),S={level:p,comment:g,timestamp:C.timestamp,time:N.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})},_=await Ot(b);if(_.exists()){const A=_.data(),k=Array.isArray(A==null?void 0:A.entries)?A.entries:[];await et(b,{id:j,userId:u.uid,date:v,entries:[...k,S]})}else await et(b,{id:j,userId:u.uid,date:v,entries:[S]});i("saved")}catch(N){console.error("Energy - Error al guardar:",N),l(N instanceof Error?N.message:"Error al guardar"),i("error")}},h=async(p,g)=>{if(!u||!r)return;i("saving"),l(null);const v=ue(tt(ne,"energy"),r.id);try{const j=r.entries.map(b=>b.timestamp===p?g:b);await et(v,{...r,entries:j}),i("saved")}catch(j){console.error("Energy - Error al actualizar:",j),l(j instanceof Error?j.message:"Error al actualizar"),i("error")}},x=async p=>{if(!u||!r)return;i("saving"),l(null);const g=ue(tt(ne,"energy"),r.id);try{const v=r.entries.filter(j=>j.timestamp!==p);v.length===0?(await fr(g),a(null)):await et(g,{...r,entries:v}),i("saved")}catch(v){console.error("Energy - Error al eliminar:",v),l(v instanceof Error?v.message:"Error al eliminar"),i("error")}};return{energyHistory:(r==null?void 0:r.entries)||[],status:o,error:d,addEntry:m,updateEntry:h,deleteEntry:x}},Od=({selectedDate:s,energyFirst:r=!1})=>{const{user:a}=Se(),{isUnlocked:o}=kd(),{moodHistory:i,status:d,error:l,addMood:u,updateMood:m,deleteMood:h}=ZT(s),{energyHistory:x,status:p,error:g,addEntry:v,updateEntry:j,deleteEntry:b}=QT(s),N=x.slice().sort((k,D)=>D.timestamp-k.timestamp)[0],C=["text-red-500","text-orange-500","text-yellow-500","text-lime-600","text-green-600"];if(!a)return e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tu estado de ánimo"})})});const S=pe(s)===pe(new Date),_=e.jsx(se,{className:"w-full",children:e.jsxs(ae,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"font-medium",children:"Estado de ánimo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($T,{}),o&&e.jsx(XT,{selectedDate:s}),d==="saving"&&e.jsx("span",{className:"text-xs text-blue-500",children:"Guardando..."}),d==="error"&&e.jsx("span",{className:"text-xs text-red-500",children:"Error al guardar"})]})]}),S&&e.jsx(Bx,{onSelect:u,disabled:d==="saving"}),e.jsx(_T,{moods:i,onUpdateMood:m,onDeleteMood:h}),l&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:l})]})}),A=e.jsx(se,{className:"w-full",children:e.jsxs(ae,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h3",{className:"font-medium",children:["Nivel de energía",N&&e.jsxs("span",{className:`ml-2 ${C[N.level-1]}`,children:["(",N.level,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[p==="saving"&&e.jsx("span",{className:"text-xs text-blue-500",children:"Guardando..."}),p==="error"&&e.jsx("span",{className:"text-xs text-red-500",children:"Error al guardar"})]})]}),S&&e.jsx("div",{className:"mb-4",children:e.jsx(Ux,{onSelect:v,disabled:p==="saving"})}),e.jsx(MT,{entries:x,onUpdate:j,onDelete:b}),g&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:g})]})});return e.jsxs("div",{className:"space-y-4",children:[r?A:_,r?_:A]})},zf=["#FF8042","#00C49F","#FFBB28","#FF8042","#0088FE","#FF0000"],e_=()=>{const[s,r]=f.useState(new Date),[a]=f.useState([]);return e.jsxs(Et,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Estado de Ánimo"}),e.jsx("p",{className:"text-gray-500",children:"Registra y analiza tu estado emocional para mejorar tu bienestar"})]}),e.jsx(xa,{selectedDate:s,onChange:r}),e.jsxs(ra,{defaultValue:"tracker",className:"space-y-4",children:[e.jsxs($s,{children:[e.jsx(nt,{value:"tracker",children:"Registro Diario"}),e.jsx(nt,{value:"analytics",children:"Análisis"}),e.jsx(nt,{value:"settings",children:"Configuración"})]}),e.jsx(rt,{value:"tracker",className:"space-y-4",children:e.jsx(Od,{selectedDate:s})}),e.jsx(rt,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(se,{children:e.jsxs(ae,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Distribución de Estados de Ánimo"}),e.jsx("div",{className:"h-64",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Rn,{children:[e.jsx(In,{data:a,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({cx:o,cy:i,midAngle:d,innerRadius:l,outerRadius:u,value:m,index:h})=>{const x=Math.PI/180,p=25+l+(u-l),g=o+p*Math.cos(-d*x),v=i+p*Math.sin(-d*x);return e.jsx("text",{x:g,y:v,fill:"#888",textAnchor:g>o?"start":"end",dominantBaseline:"central",children:`${a[h].name} (${m})`})},children:a.map(o=>e.jsx($n,{fill:zf[o%zf.length]},`cell-${o}`))}),e.jsx(bt,{})]})})})]})}),e.jsx(se,{children:e.jsx(ae,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Patrones y Tendencias"})})})]})}),e.jsxs(rt,{value:"settings",className:"space-y-4",children:[e.jsx(se,{children:e.jsx(ae,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Configuración de Estados de Ánimo"})})}),"        "]})]})]})},t_=({status:s,onLock:r})=>e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J1,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Mi Diario"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long"})}),s==="saving"&&e.jsx("span",{className:"text-sm text-blue-500",children:"Guardando..."}),s==="saved"&&e.jsx("span",{className:"text-sm text-green-500",children:"Guardado"}),s==="error"&&e.jsx("span",{className:"text-sm text-red-500",children:"Error al guardar"})]}),e.jsx(F,{variant:"ghost",size:"icon",onClick:r,title:"Bloquear diario",children:e.jsx(Hh,{className:"w-4 h-4"})})]})]}),s_=({value:s,onChange:r})=>e.jsx(Ue,{value:s,onChange:a=>r(a.target.value),placeholder:"¿Cómo ha sido tu día?",className:"w-full h-64 resize-none"}),Gx=({lastUpdated:s,className:r=""})=>s?e.jsxs("div",{className:`flex items-center gap-2 text-sm text-gray-500 ${r}`,children:[e.jsx(pa,{className:"w-4 h-4"}),e.jsxs("span",{children:["Última actualización: ",s]})]}):null,a_=({onUnlock:s,lastUpdated:r})=>{const[a,o]=f.useState(""),[i,d]=f.useState(!1),l=u=>{u.preventDefault(),a==="1234"?(s(),d(!1)):d(!0)};return e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-4",children:e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx(Hh,{className:"w-12 h-12 text-blue-500"})}),e.jsx("h3",{className:"text-center text-lg font-medium",children:"Diario Protegido"}),e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Ingresa la contraseña para acceder a tu diario"}),e.jsx(ke,{type:"password",value:a,onChange:u=>o(u.target.value),placeholder:"Contraseña",className:i?"border-destructive focus-visible:ring-destructive":""}),i&&e.jsx("p",{className:"text-sm text-red-500 text-center",children:"Contraseña incorrecta"}),e.jsx(F,{type:"submit",className:"w-full",children:"Desbloquear"}),e.jsx(Gx,{lastUpdated:r,className:"justify-center"})]})})})},n_=io("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function zt({className:s,variant:r,...a}){return e.jsx("div",{className:Z(n_({variant:r}),s),...a})}const tl={PERSONAL:"personal",WORK:"work",HOME:"home",HEALTH:"health",SHOPPING:"shopping",STUDY:"study",SOCIAL:"social",OTHER:"other"},ta={personal:"Personal",work:"Trabajo",home:"Casa",health:"Salud",shopping:"Compras",study:"Estudio",social:"Social",other:"Otro"},Uc={personal:{bg:"bg-purple-100",text:"text-purple-700"},work:{bg:"bg-blue-100",text:"text-blue-700"},home:{bg:"bg-green-100",text:"text-green-700"},health:{bg:"bg-red-100",text:"text-red-700"},shopping:{bg:"bg-yellow-100",text:"text-yellow-700"},study:{bg:"bg-indigo-100",text:"text-indigo-700"},social:{bg:"bg-pink-100",text:"text-pink-700"},other:{bg:"bg-gray-100",text:"text-gray-700"}},r_={MORNING:"morning",AFTERNOON:"afternoon",EVENING:"evening"},qc={morning:"Mañana",afternoon:"Tarde",evening:"Noche"};Li.setOptions({breaks:!0,gfm:!0});const o_=s=>{try{const r=Li.parse(s);return On.sanitize(r)}catch{return On.sanitize(s.replace(/\n/g,"<br>"))}},Pd=s=>{const r=s.match(/^\s*- \[(?: |x|X)\]/gm);if(!r||r.length===0)return{total:0,checked:0};const a=r.filter(o=>o.toLowerCase().startsWith("- [x]")).length;return{total:r.length,checked:a}},fi=s=>{const{total:r,checked:a}=Pd(s);return r?a/r*100:0},dr={small:"w-3 h-3",medium:"w-3.5 h-3.5",large:"w-5 h-5"},Kx={small:"h-5 w-5",medium:"h-6 w-6"},i_={daily:"Diario",weekly:"Semanal",monthly:"Mensual"},Ff={do:{label:"HACER",color:"bg-red-500",text:"Urgente e importante"},decide:{label:"DECIDIR",color:"bg-orange-500",text:"Importante, no urgente"},delegate:{label:"DELEGAR",color:"bg-blue-500",text:"Urgente, no importante"},delete:{label:"ELIMINAR",color:"bg-gray-500",text:"Ni urgente ni importante"},none:{label:"",color:"",text:""}},Dc={do:{icon:"🔥",num:1,style:"bg-red-600 text-white"},decide:{icon:"🤔",num:2,style:"bg-orange-500 text-white"},delegate:{icon:"📬",num:3,style:"bg-blue-500 text-white"},delete:{icon:"🗑️",num:4,style:"bg-gray-500 text-white"},none:{icon:"🗑️",num:4,style:"bg-gray-500 text-white"}},l_=s=>vt(s,"dd/MM"),c_=s=>s!=null&&s.type&&i_[s.type]||"",d_=(s="none")=>Ff[s]||Ff.none,u_=s=>s?Ft(yt(s),yt(new Date)):!1,Jx=f.memo(f.forwardRef(({completed:s,onToggle:r},a)=>e.jsx(F,{ref:a,variant:"ghost",size:"icon",className:Z(Kx.medium,"p-0 rounded-full shrink-0 hover:bg-transparent"),onClick:r,children:s?e.jsx(ad,{className:Z(dr.large,"text-green-600")}):e.jsx(Fh,{className:Z(dr.large,"text-gray-400 hover:text-gray-600 transition-colors")})})));Jx.displayName="TaskToggleButton";const gi=f.forwardRef(({children:s,...r},a)=>e.jsx(zt,{...r,ref:a,children:s}));gi.displayName="BadgeWithRef";const Vc=f.memo(({task:s,showCategoryLabel:r,overdue:a,variant:o})=>{var h,x;const i={bg:((h=Uc[s.category])==null?void 0:h.bg)||"bg-purple-100",text:((x=Uc[s.category])==null?void 0:x.text)||"text-purple-800"},d=d_(s.priority),l=c_(s.recurrence),u=o==="list"?"text-xs px-1 py-0.5 h-auto":"text-xs px-1.5 py-0.5",m=dr.small;return e.jsxs("div",{className:"flex flex-wrap gap-1",children:[r&&e.jsxs(zt,{className:Z(u,i.bg,i.text),children:[e.jsx(Wh,{className:Z(m,"mr-1")}),ta[s.category]]}),o==="list"&&!r&&d.label&&e.jsx(An,{children:e.jsxs(ln,{children:[e.jsx(cn,{asChild:!0,children:e.jsx(gi,{className:Z(u,"text-white",d.color),children:d.label})}),e.jsx(Ma,{children:d.text})]})}),!r&&s.size&&e.jsx(zt,{variant:"outline",className:u,children:s.size}),s.dueDate&&e.jsxs(zt,{variant:a?"destructive":"secondary",className:u,children:[e.jsx(pr,{className:Z(m,"mr-1")}),l_(s.dueDate),a&&" (vencida)"]}),o==="kanban"&&e.jsx(An,{children:e.jsxs(ln,{children:[e.jsx(cn,{asChild:!0,children:e.jsxs(gi,{className:Z(u,"gap-0.5",Dc[s.priority||"none"].style),children:[e.jsx("span",{className:"mr-0.5",children:Dc[s.priority||"none"].icon}),Dc[s.priority||"none"].num]})}),e.jsx(Ma,{children:d.text})]})}),o==="kanban"&&s.estimatedTime!==void 0&&e.jsxs(zt,{variant:"outline",className:u,children:[e.jsx(pa,{className:Z(m,"mr-1")}),s.estimatedTime,"m"]}),s.isRecurrent&&l&&e.jsxs(zt,{variant:"outline",className:u,children:[e.jsx(X1,{className:Z(m,"mr-1")}),l]}),o==="list"&&!s.isRecurrent&&d.label&&e.jsx(An,{children:e.jsxs(ln,{children:[e.jsx(cn,{asChild:!0,children:e.jsx(gi,{className:Z(u,"text-white cursor-help",d.color),children:d.label})}),e.jsx(Ma,{children:d.text})]})})]})});Vc.displayName="TaskBadges";const nr=f.forwardRef(({children:s,...r},a)=>e.jsx(F,{ref:a,...r,children:s}));nr.displayName="ActionButton";const Yc=f.memo(({task:s,onEdit:r,onDelete:a,onMove:o,variant:i})=>{const d=f.useCallback(g=>{g.stopPropagation(),o==null||o(s.id,Dn(new Date))},[o,s.id]),l=f.useCallback(g=>{g.stopPropagation(),o==null||o(s.id,Dn(gt(new Date,1)))},[o,s.id]),u=f.useCallback(g=>{g.stopPropagation(),o==null||o(s.id,null)},[o,s.id]),m=f.useCallback(g=>{g.stopPropagation(),r(s)},[r,s]),h=f.useCallback(()=>{a(s.id)},[a,s.id]),x=Z(Kx.medium,"md:h-5 md:w-5 p-0 rounded-full hover:bg-muted"),p=i==="kanban"&&o&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(nr,{variant:"ghost",size:"icon",className:x,title:"Asignar para hoy",onClick:d,children:e.jsx("span",{role:"img","aria-label":"hoy",className:"text-sm md:text-xs",children:"📅"})}),e.jsx(nr,{variant:"ghost",size:"icon",className:x,title:"Asignar para mañana",onClick:l,children:e.jsx("span",{role:"img","aria-label":"mañana",className:"text-sm md:text-xs",children:"🌅"})}),e.jsx(nr,{variant:"ghost",size:"icon",className:x,title:"Quitar fecha",onClick:u,children:e.jsx("span",{role:"img","aria-label":"sin fecha",className:"text-sm md:text-xs",children:"❌"})})]});return e.jsxs("div",{className:Z("flex gap-1",i==="kanban"?"justify-between w-full":"shrink-0 opacity-60 hover:opacity-100 transition-opacity"),children:[p,e.jsxs("div",{className:"flex gap-1",children:[e.jsx(nr,{variant:"ghost",size:"icon",className:x,title:"Editar tarea",onClick:m,children:e.jsx(sd,{className:Z(dr.medium,"md:w-3 md:h-3 text-muted-foreground")})}),e.jsxs(el,{children:[e.jsx(Fx,{asChild:!0,children:e.jsx(nr,{variant:"ghost",size:"icon",className:Z(x,"hover:bg-red-50"),title:"Eliminar tarea",onClick:g=>g.stopPropagation(),children:e.jsx(Rs,{className:Z(dr.medium,"md:w-3 md:h-3 text-red-500")})})}),e.jsxs(mo,{children:[e.jsxs(fo,{children:[e.jsx(po,{children:"¿Eliminar tarea?"}),e.jsxs(xo,{children:['Esta acción no se puede deshacer. La tarea "',s.title,'" será eliminada permanentemente.']})]}),e.jsxs(ho,{children:[e.jsx(vo,{children:"Cancelar"}),e.jsx(go,{onClick:h,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})]})});Yc.displayName="TaskActions";const Gc=f.memo(({open:s,onOpenChange:r,onConfirm:a,taskTitle:o})=>e.jsx(el,{open:s,onOpenChange:r,children:e.jsxs(mo,{children:[e.jsxs(fo,{children:[e.jsx(po,{children:"¿Marcar tarea como completada?"}),e.jsxs(xo,{children:['La tarea "',o,'" se marcará como completada.']})]}),e.jsxs(ho,{children:[e.jsx(vo,{children:"Cancelar"}),e.jsx(go,{onClick:a,children:"Completar"})]})]})}));Gc.displayName="ConfirmCompleteDialog";const ur=f.memo(({task:s,onToggle:r,onDelete:a,onEdit:o,onView:i,onMove:d,variant:l="list",showCategoryLabel:u=!0})=>{const[m,h]=f.useState(!1),x=u_(s.dueDate??null),{total:p,checked:g}=Pd(s.description||""),v=p?s.progress??g/p*100:0,j=f.useCallback(S=>{S.stopPropagation(),s.completed?r(s.id,!1):h(!0)},[s.completed,s.id,r]),b=f.useCallback(()=>{r(s.id,!0),h(!1)},[s.id,r]),N=f.useCallback(()=>{i==null||i(s)},[i,s]),C=Z("cursor-pointer relative hover:shadow-md transition-all duration-200 border-0 shadow-sm",l==="kanban"&&"text-sm w-full max-w-none lg:max-w-[18rem]",l==="list"&&"mb-2",s.completed?l==="kanban"?"bg-muted/30":"opacity-70 bg-gray-50":"bg-white",!s.completed&&x&&"border-l-4 border-l-red-500 bg-red-50",l==="list"&&"hover:bg-gray-50");return l==="kanban"?e.jsxs(e.Fragment,{children:[e.jsxs(se,{onClick:N,className:C,children:[e.jsx(ae,{className:"p-2 md:p-2 flex flex-col gap-1.5",children:e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.isPrivate&&e.jsx("span",{className:"text-xs",children:"🔒"}),e.jsx("span",{className:Z("text-sm break-words line-clamp-2 font-medium",s.completed?"line-through text-muted-foreground":"text-foreground"),children:s.title})]}),s.description&&e.jsx("p",{className:Z("text-xs text-muted-foreground line-clamp-2 break-words leading-relaxed",s.completed&&"line-through"),children:s.description}),e.jsx("div",{className:"flex flex-wrap gap-1 pt-0.5",children:e.jsx(Vc,{task:s,showCategoryLabel:u,overdue:x,variant:"kanban"})}),p>0&&e.jsxs("div",{className:"pt-1 space-y-0.5",children:[e.jsx(kt,{value:v,className:"h-1"}),e.jsxs("p",{className:"text-[10px] text-right text-muted-foreground",children:[g," de ",p]})]})]})})}),e.jsx(Bi,{className:"px-2 py-1.5 bg-gray-50/50 border-t border-gray-100 p-0 md:p-0",children:e.jsx("div",{className:"px-2 py-1.5 w-full",children:e.jsx(Yc,{task:s,onEdit:o,onDelete:a,onMove:d,variant:"kanban"})})})]}),e.jsx(Gc,{open:m,onOpenChange:h,onConfirm:b,taskTitle:s.title})]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{onClick:N,className:C,children:e.jsxs(ae,{className:"flex items-center gap-2.5 py-2 px-3 md:py-2 md:px-3",children:[e.jsx(Jx,{completed:s.completed,onToggle:()=>j}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-0.5",children:[e.jsxs("div",{className:"space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.isPrivate&&e.jsx("span",{className:"text-xs opacity-70",children:"🔒"}),e.jsx("span",{className:Z("text-sm break-words line-clamp-1 leading-tight font-medium",s.completed?"line-through text-muted-foreground":"text-foreground"),children:s.title}),s.description&&e.jsx(Bh,{className:"w-3 h-3 text-muted-foreground shrink-0 opacity-50"})]}),s.description&&e.jsx("p",{className:Z("text-xs text-muted-foreground line-clamp-1 break-words leading-tight",s.completed&&"line-through"),children:s.description})]}),e.jsx(Vc,{task:s,showCategoryLabel:u,overdue:x,variant:"list"})]}),e.jsx(Yc,{task:s,onEdit:o,onDelete:a,variant:"list"})]})}),e.jsx(Gc,{open:m,onOpenChange:h,onConfirm:b,taskTitle:s.title})]})});ur.displayName="TaskItem";const m_=s=>{const r={do:{label:"HACER",color:"bg-red-500",text:"Urgente e importante",urgent:!0,important:!0},decide:{label:"DECIDIR",color:"bg-yellow-500",text:"Importante pero no urgente",urgent:!1,important:!0},delegate:{label:"DELEGAR",color:"bg-blue-500",text:"Urgente pero no importante",urgent:!0,important:!1},delete:{label:"ELIMINAR",color:"bg-gray-500",text:"Ni urgente ni importante",urgent:!1,important:!1},none:{label:"",color:"",text:"",urgent:!1,important:!1}};return r[s]||r.none},sl=({task:s,isOpen:r,onClose:a,onEdit:o,onToggle:i})=>{if(!s)return null;const d=Uc[s.category],l=m_(s.priority),u=s.isRecurrent&&s.recurrence?xp(s.dueDate||new Date,s.recurrence.pattern,s.recurrence.customDays):"",m=s.dueDate&&Ft(yt(s.dueDate),yt(new Date)),{total:h,checked:x}=Pd(s.description||""),p=h>0,g=p?s.progress??x/h*100:0,v=o_(s.description||"");return e.jsx(st,{open:r,onOpenChange:j=>{j||a()},children:e.jsxs(Ke,{className:"max-w-[90vw] w-[90vw] max-h-[90vh] overflow-y-auto sm:max-w-[90vw] sm:w-[90vw] lg:max-w-[85vw] lg:w-[85vw]",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-12",children:[e.jsx("div",{className:"md:col-span-8 space-y-4",children:e.jsxs(Je,{className:"text-left",children:[e.jsx(Xe,{children:s.title}),s.description&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"prose max-w-none",dangerouslySetInnerHTML:{__html:v}}),p&&e.jsxs("div",{className:"mt-1 space-y-0.5",children:[e.jsx(kt,{value:g}),e.jsxs("p",{className:"text-xs text-right text-muted-foreground",children:[x," de ",h]})]})]})]})}),"          ",e.jsxs("div",{className:"md:col-span-4 space-y-4 text-sm",children:[s.dueDate&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Fecha límite:"}),e.jsxs(zt,{variant:m?"destructive":"secondary",className:"text-xs font-normal px-2 py-0.5",children:[c2(s.dueDate),m?" (vencida)":""]})]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Categoría:"}),e.jsx("span",{className:`${d.bg} ${d.text} px-2 py-0.5 rounded-md text-xs flex items-center`,children:ta[s.category]})]}),l.label&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Prioridad:"}),e.jsx(zt,{className:`text-xs text-white ${l.color}`,children:l.label}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",l.text,")"]})]}),s.size&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Tamaño:"}),e.jsx(zt,{variant:"outline",className:"text-xs",children:s.size})]}),"            ",s.priority&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Urgente:"}),e.jsx(zt,{variant:l.urgent?"default":"secondary",className:"text-xs",children:l.urgent?"Sí":"No"})]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Importante:"}),e.jsx(zt,{variant:l.important?"default":"secondary",className:"text-xs",children:l.important?"Sí":"No"})]})]}),s.isPrivate&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Privada:"}),e.jsx(zt,{variant:"outline",className:"text-xs",children:"🔒 Sí"})]}),s.isRecurrent&&s.recurrence&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Recurrencia:"}),e.jsx(zt,{variant:"outline",className:"text-xs font-normal px-2 py-0.5 text-accent-foreground border-accent",children:u})]})]})]}),e.jsxs(os,{className:"mt-6",children:[e.jsx(F,{variant:"outline",onClick:a,children:"Cerrar"}),i&&e.jsx(F,{variant:"secondary",onClick:()=>i(s.id,!s.completed),children:s.completed?"Marcar incompleta":"Completar"}),e.jsx(F,{onClick:()=>o(s),children:"Editar"})]})]})})},f_=({value:s,onChange:r,multiline:a})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Z1,{className:"w-4 h-4"}),"Título"]}),a?e.jsx(Ue,{value:s,onChange:o=>r(o.target.value),placeholder:"Una tarea por línea",className:"min-h-[120px]"}):e.jsx(ke,{value:s,onChange:o=>r(o.target.value),placeholder:"Título de la tarea..."})]}),h_=({value:s,onChange:r})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Bh,{className:"w-4 h-4"}),"Descripción de la tarea"]}),e.jsx(Ue,{value:s,onChange:a=>r(a.target.value),placeholder:"Agrega más detalles sobre la tarea...",className:"min-h-[250px] resize-y"})]}),fn=({className:s})=>{const[r,a]=f.useState(0);return f.useEffect(()=>{const o=setInterval(()=>{a(i=>{const d=i+5;return d>=100?(clearInterval(o),100):d})},500);return()=>clearInterval(o)},[]),e.jsxs("div",{className:`flex items-center gap-2 ${s??""}`,children:[e.jsx(kt,{value:r,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-8 text-right",children:[r,"%"]})]})},Qa=Ls("task"),p_=Qa?`https://generativelanguage.googleapis.com/v1beta/models/${Qa.model}:generateContent`:"",x_=({title:s,description:r,onInsert:a})=>{var S;const[o,i]=f.useState(!1),[d,l]=f.useState(""),[u,m]=f.useState(""),[h,x]=f.useState(!1),[p,g]=f.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",j=((S=Qa==null?void 0:Qa.prompts)==null?void 0:S.breakdown)??"Desglosa la siguiente tarea en subtareas concretas y accionables:",b=Qa==null?void 0:Qa.params;f.useEffect(()=>{o&&l(`${j}
Tarea: ${s}
Descripcion: ${r}`)},[o,s,r]),f.useEffect(()=>{g(oa(d))},[d]);const N=async()=>{var _,A,k,D,P;if(s){x(!0);try{const $=await(await fetch(`${p_}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:d}]}],...b})})).json(),W=(P=(D=(k=(A=(_=$==null?void 0:$.candidates)==null?void 0:_[0])==null?void 0:A.content)==null?void 0:k.parts)==null?void 0:D[0])==null?void 0:P.text;m(W||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{x(!1)}}},C=()=>{u&&(a(u),i(!1),m(""))};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"})," Subtareas IA"]}),e.jsx(st,{open:o,onOpenChange:i,children:e.jsxs(Ke,{className:"w-full sm:max-w-xl max-h-[90vh] overflow-auto",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Desglose de tarea"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:d,onChange:_=>l(_.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",p," ",p>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsx(F,{onClick:N,disabled:h||!v,className:"w-full",children:h?"Consultando...":"Obtener subtareas"}),h&&e.jsx(fn,{className:"mt-2"}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ue,{readOnly:!0,value:u,className:"max-h-[300px]"}),e.jsx(F,{type:"button",onClick:C,className:"w-full",children:"Insertar en descripción"})]})]})]})})]})},en=Ls("task"),g_=en?`https://generativelanguage.googleapis.com/v1beta/models/${en.model}:generateContent`:"",v_=({title:s,description:r,onInsert:a})=>{var S;const[o,i]=f.useState(!1),[d,l]=f.useState(""),[u,m]=f.useState(""),[h,x]=f.useState(!1),[p,g]=f.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",j=((S=en==null?void 0:en.prompts)==null?void 0:S.improveDescription)??"Mejora la descripción de la tarea sin cambiar su esencia. Si no hay descripción, genera una basada en el título (máx. 150 palabras).",b=en==null?void 0:en.params;f.useEffect(()=>{o&&l(`${j}
Título: ${s}
Descripción actual: ${r||"N/A"}`)},[o,s,r]),f.useEffect(()=>{g(oa(d))},[d]);const N=async()=>{var _,A,k,D,P;if(s){x(!0);try{const $=await(await fetch(`${g_}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:d}]}],...b})})).json(),W=(P=(D=(k=(A=(_=$==null?void 0:$.candidates)==null?void 0:_[0])==null?void 0:A.content)==null?void 0:k.parts)==null?void 0:D[0])==null?void 0:P.text;m(W||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{x(!1)}}},C=()=>{u&&(a(u),i(!1),m(""))};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"})," Mejorar descripción"]}),e.jsx(st,{open:o,onOpenChange:i,children:e.jsxs(Ke,{className:"w-full sm:max-w-xl max-h-[90vh] overflow-auto",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Descripción mejorada"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:d,onChange:_=>l(_.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",p," ",p>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsx(F,{onClick:N,disabled:h||!v,className:"w-full",children:h?"Consultando...":"Obtener descripción"}),h&&e.jsx(fn,{className:"mt-2"}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ue,{readOnly:!0,value:u,className:"max-h-[300px]"}),e.jsx(F,{type:"button",onClick:C,className:"w-full",children:"Insertar en descripción"})]})]})]})})]})},tn=Ls("task"),y_=tn?`https://generativelanguage.googleapis.com/v1beta/models/${tn.model}:generateContent`:"",j_=({title:s,description:r,onInsert:a})=>{var S;const[o,i]=f.useState(!1),[d,l]=f.useState(""),[u,m]=f.useState(""),[h,x]=f.useState(!1),[p,g]=f.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",j=((S=tn==null?void 0:tn.prompts)==null?void 0:S.ideas)??"Sugiere ejemplos o estrategias breves para abordar la tarea. Máximo 150 palabras.",b=tn==null?void 0:tn.params;f.useEffect(()=>{o&&l(`${j}
Título: ${s}
Descripción: ${r}`)},[o,s,r]),f.useEffect(()=>{g(oa(d))},[d]);const N=async()=>{var _,A,k,D,P;if(s){x(!0);try{const $=await(await fetch(`${y_}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:d}]}],...b})})).json(),W=(P=(D=(k=(A=(_=$==null?void 0:$.candidates)==null?void 0:_[0])==null?void 0:A.content)==null?void 0:k.parts)==null?void 0:D[0])==null?void 0:P.text;m(W||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{x(!1)}}},C=()=>{u&&(a(u),i(!1),m(""))};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"})," Ideas"]}),e.jsx(st,{open:o,onOpenChange:i,children:e.jsxs(Ke,{className:"w-full sm:max-w-xl max-h-[90vh] overflow-auto",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Ideas para la tarea"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:d,onChange:_=>l(_.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",p," ",p>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsx(F,{onClick:N,disabled:h||!v,className:"w-full",children:h?"Consultando...":"Obtener ideas"}),h&&e.jsx(fn,{className:"mt-2"}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ue,{readOnly:!0,value:u,className:"max-h-[300px]"}),e.jsx(F,{type:"button",onClick:C,className:"w-full",children:"Insertar en descripción"})]})]})]})})]})},Tc=({value:s,onChange:r,showClearButton:a=!1,label:o="Fecha límite"})=>{const i=l=>pe(l),d=l=>{const[u,m,h]=l.split("-").map(Number),x=new Date;return x.setFullYear(u,m-1,h),x.setHours(12,0,0,0),x};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pr,{className:"w-4 h-4"}),o]}),a&&s&&e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>r(void 0),children:"Quitar fecha"})]}),e.jsx(ke,{type:"date",value:s?i(s):"",onChange:l=>{if(!l.target.value){r(void 0);return}const u=d(l.target.value);r(u)}})]})},b_=({value:s,onChange:r})=>{const a=Object.values(tl);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Wh,{className:"w-4 h-4"}),"Categoría"]}),e.jsxs(Le,{value:s,onValueChange:o=>r(o),children:[e.jsx(Re,{children:e.jsx(ze,{placeholder:"Selecciona una categoría",children:ta[s]})}),e.jsx(Ie,{children:a.map(o=>e.jsx(le,{value:o,children:ta[o]},o))})]})]})},N_=({value:s,onChange:r})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pa,{className:"w-4 h-4"}),"Tiempo estimado (min)"]}),e.jsx(ke,{type:"number",min:"0",placeholder:"Ej. 30",value:s??"",onChange:a=>{const o=a.target.value;r(o===""?void 0:Number(o))}})]}),_c="none",w_=({value:s,onChange:r})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(pa,{className:"w-4 h-4"}),"Momento del día"]}),e.jsxs(Le,{value:s||_c,onValueChange:a=>r(a===_c?void 0:a),children:[e.jsx(Re,{children:e.jsx(ze,{placeholder:"Sin asignar",children:s?qc[s]:"Sin asignar"})}),e.jsxs(Ie,{children:[Object.values(r_).map(a=>e.jsx(le,{value:a,children:qc[a]},a)),e.jsx(le,{value:_c,children:"Sin asignar"})]})]})]}),Xx=({initialDate:s,initialConfig:r}={})=>{const[a,o]=f.useState(s||new Date),[i,d]=f.useState(r),l=(h,x)=>x?l2(h,x.pattern,x.customDays):h;return{date:a,setDate:o,config:i,setConfig:d,calculateNextDate:l,getRecurrenceText:(h,x)=>x?xp(h,x.pattern,x.customDays):"",updateRecurrenceConfig:(h,x)=>{const p={pattern:h,frequency:1,...h==="custom"&&{customDays:x||1}};d(p),o(l(new Date,p))},formatDateForInput:Hc}},S_=({isRecurrent:s,onRecurrentChange:r,config:a,onConfigChange:o})=>{const{getRecurrenceText:i}=Xx({initialConfig:a}),d=l=>{const u={...a||{},frequency:1,pattern:l,...l==="custom"&&{customDays:(a==null?void 0:a.customDays)||1}};o(u)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ra,{id:"isRecurrent",checked:s,onCheckedChange:l=>{r(l)}}),e.jsx("label",{htmlFor:"isRecurrent",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tarea recurrente"})]}),s&&a&&e.jsxs("div",{className:"pl-6 space-y-4",children:[e.jsxs(Le,{value:a.pattern,onValueChange:l=>d(l),children:[e.jsx(Re,{className:"w-full",children:e.jsx(ze,{placeholder:"Selecciona frecuencia"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"daily",children:"Diariamente"}),e.jsx(le,{value:"weekly",children:"Semanalmente"}),e.jsx(le,{value:"monthly",children:"Mensualmente"}),e.jsx(le,{value:"custom",children:"Personalizado"})]})]}),a.pattern==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ke,{type:"number",min:"1",value:a.customDays,onChange:l=>{const u=parseInt(l.target.value);u>0&&o({...a,customDays:u})},className:"w-24"}),e.jsx("span",{className:"text-sm text-gray-500",children:"días"})]}),a&&e.jsx("div",{className:"text-sm text-blue-600",children:i(new Date,a)})]})]})},al=({isOpen:s,onClose:r,onConfirm:a,task:o,mode:i})=>{const{calculateNextDate:d}=Xx({initialConfig:o.recurrence,initialDate:o.dueDate}),[l,u]=f.useState(()=>i==="create"?{title:"",description:"",category:"personal",isRecurrent:!1,isPrivate:o.isPrivate||!1,priority:"delete",size:"pequeña",estimatedTime:void 0,timeOfDay:void 0}:{title:o.title||"",description:o.description||"",dueDate:i==="complete"?d(new Date,o.recurrence):o.dueDate||void 0,isRecurrent:o.isRecurrent??!1,isPrivate:o.isPrivate??!1,category:o.category||"personal",recurrence:o.recurrence,priority:o.priority||"delete",size:o.size||"pequeña",estimatedTime:o.estimatedTime,timeOfDay:o.timeOfDay}),[m,h]=f.useState(()=>o.priority==="do"||o.priority==="delegate"),[x,p]=f.useState(()=>o.priority==="do"||o.priority==="decide"),[g,v]=f.useState(o.size||"pequeña");f.useEffect(()=>{s&&(i==="create"?(u({title:"",description:"",category:"personal",isRecurrent:!1,isPrivate:o.isPrivate||!1,priority:"delete",size:"pequeña",estimatedTime:void 0,timeOfDay:void 0}),h(!1),p(!1),v("pequeña")):(u({title:o.title||"",description:o.description||"",dueDate:i==="complete"?d(new Date,o.recurrence):o.dueDate||void 0,isRecurrent:o.isRecurrent||!1,isPrivate:o.isPrivate||!1,category:o.category||"personal",recurrence:o.recurrence,priority:o.priority||"delete",size:o.size||"pequeña",estimatedTime:o.estimatedTime,timeOfDay:o.timeOfDay}),h(o.priority==="do"||o.priority==="delegate"),p(o.priority==="do"||o.priority==="decide"),v(o.size||"pequeña")))},[o,i,s]);const j=()=>{if(!l.title.trim())return;const N=m&&x?"do":x?"decide":m?"delegate":"delete";i==="create"?(l.title.split(`
`).map(S=>S.trim()).filter(Boolean).forEach(S=>{a({...l,title:S,priority:N,size:g})}),r()):a({...l,priority:N,size:g})},b=()=>{switch(i){case"create":return"Nueva Tarea";case"edit":return"Editar Tarea";case"complete":return"Completar Tarea";default:return""}};return e.jsx(st,{open:s,onOpenChange:r,children:e.jsxs(Ke,{className:"max-w-[95vw] w-[95vw] max-h-[90vh] h-[80vh] overflow-y-auto sm:max-w-[90vw] sm:w-[90vw] lg:max-w-[85vw] lg:w-[85vw]",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:b()}),i==="complete"&&e.jsx(na,{children:o.title})]}),e.jsxs("div",{className:"grid gap-6 py-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[i!=="complete"&&e.jsx(f_,{multiline:i==="create",value:l.title,onChange:N=>u({...l,title:N})}),e.jsx(h_,{value:l.description||"",onChange:N=>u({...l,description:N})}),i==="edit"&&e.jsxs(e.Fragment,{children:[e.jsx(x_,{title:l.title,description:l.description||"",onInsert:N=>u({...l,description:(l.description?l.description+`
`:"")+N})}),e.jsx(v_,{title:l.title,description:l.description||"",onInsert:N=>u({...l,description:(l.description?l.description+`
`:"")+N})}),e.jsx(j_,{title:l.title,description:l.description||"",onInsert:N=>u({...l,description:(l.description?l.description+`
`:"")+N})})]})]}),e.jsxs("div",{className:"space-y-6",children:[i!=="complete"&&e.jsx(b_,{value:l.category,onChange:N=>u({...l,category:N})}),i==="edit"?e.jsx(Tc,{value:l.dueDate,onChange:N=>u({...l,dueDate:N}),showClearButton:!0}):i==="create"?e.jsx(Tc,{value:l.dueDate,onChange:N=>u({...l,dueDate:N}),showClearButton:!0}):o.isRecurrent&&e.jsx(Tc,{value:l.dueDate,onChange:N=>u({...l,dueDate:N}),label:"Próxima fecha"}),i!=="complete"&&e.jsx(w_,{value:l.timeOfDay,onChange:N=>u({...l,timeOfDay:N})}),i!=="complete"&&e.jsx(S_,{isRecurrent:l.isRecurrent??!1,onRecurrentChange:N=>u({...l,isRecurrent:N,recurrence:N?{pattern:"daily",frequency:1}:void 0}),config:l.recurrence,onConfigChange:N=>u({...l,recurrence:N})}),i!=="complete"&&e.jsx(N_,{value:l.estimatedTime,onChange:N=>u({...l,estimatedTime:N})}),i!=="complete"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ra,{checked:m,onCheckedChange:N=>h(!!N)}),"Urgente"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ra,{checked:x,onCheckedChange:N=>p(!!N)}),"Importante"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ra,{checked:l.isPrivate??!1,onCheckedChange:N=>u({...l,isPrivate:!!N})}),"🔒 Privada (solo en Journal)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Tamaño"}),e.jsxs(Le,{value:g,onValueChange:N=>v(N),children:[e.jsx(Re,{className:"h-8 w-28",children:e.jsx(ze,{placeholder:"Tamaño"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"pequeña",children:"pequeña"}),e.jsx(le,{value:"mediana",children:"mediana"}),e.jsx(le,{value:"grande",children:"grande"})]})]})]})]})]})]}),e.jsxs(os,{children:[e.jsx(F,{variant:"outline",onClick:r,children:"Cancelar"}),e.jsx(F,{onClick:j,disabled:!l.title.trim(),children:i==="complete"?"Completar":i==="create"?"Crear":"Guardar cambios"})]})]})})},nl=()=>{const[s,r]=f.useState([]),[a,o]=f.useState("idle"),[i,d]=f.useState(null),[l,u]=f.useState(!1),[m,h]=f.useState(null),[x,p]=f.useState("create"),{user:g}=Se(),v=()=>s.filter(D=>!D.isPrivate),j=f.useCallback(()=>{u(!1),h(null),o("idle"),d(null),p("create")},[]);f.useEffect(()=>{if(!g)return;o("loading");const D=ns(tt(ne,"tasks"),Ge("userId","==",g.uid)),P=ht(D,M=>{const $=M.docs.map(W=>{var B,H;const I=W.data();return{id:W.id,title:I.title,description:I.description||"",completed:I.completed,createdAt:I.createdAt,dueDate:(B=I.dueDate)==null?void 0:B.toDate(),isRecurrent:I.isRecurrent||!1,isPrivate:I.isPrivate||!1,category:I.category||"other",priority:I.priority||"delete",size:I.size||"pequeña",estimatedTime:I.estimatedTime,timeOfDay:I.timeOfDay,progress:typeof I.progress=="number"?I.progress:fi(I.description||""),recurrence:I.recurrence?{frequency:I.recurrence.frequency,pattern:I.recurrence.pattern,customDays:I.recurrence.customDays,nextDate:(H=I.recurrence.nextDate)==null?void 0:H.toDate()}:void 0}}).filter(W=>!W.completed).sort((W,I)=>{var B,H;return W.dueDate&&I.dueDate?W.dueDate.getTime()-I.dueDate.getTime():W.dueDate?-1:I.dueDate?1:(((B=I.createdAt)==null?void 0:B.seconds)||0)-(((H=W.createdAt)==null?void 0:H.seconds)||0)});r($),a!=="saving"&&o("idle")},M=>{console.error("Error en snapshot:",M),d(M instanceof Error?M.message:"An unknown error occurred"),o("error")});return()=>P()},[g]);const b=async D=>{var P;if(!(!D.title.trim()||!g)){o("saving"),d(null);try{const M={userId:g.uid,title:D.title.trim(),completed:!1,createdAt:Be(),category:D.category||"other",priority:D.priority||"delete",size:D.size||"pequeña",...D.timeOfDay&&{timeOfDay:D.timeOfDay},...D.estimatedTime!==void 0&&{estimatedTime:D.estimatedTime}};M.progress=fi(D.description||""),(P=D.description)!=null&&P.trim()&&(M.description=D.description.trim()),D.dueDate&&(M.dueDate=_n.fromDate(D.dueDate)),D.isPrivate&&(M.isPrivate=!0),D.isRecurrent&&D.recurrence&&(M.isRecurrent=!0,M.recurrence={frequency:D.recurrence.frequency,pattern:D.recurrence.pattern},D.recurrence.pattern==="custom"&&D.recurrence.customDays&&(M.recurrence.customDays=D.recurrence.customDays)),await ji(tt(ne,"tasks"),M),o("idle")}catch(M){console.error("Error al guardar:",M),d(M instanceof Error?M.message:"Error al guardar"),o("error")}}},N=async(D,P)=>{var M;if(g){o("saving");try{const $=ue(ne,"tasks",D),W={updatedAt:Be()};(M=P.title)!=null&&M.trim()&&(W.title=P.title.trim()),typeof P.description=="string"&&(W.description=P.description.trim()||null),P.dueDate!==void 0&&(W.dueDate=P.dueDate?_n.fromDate(P.dueDate):null),P.category&&(W.category=P.category),P.priority&&(W.priority=P.priority),P.size&&(W.size=P.size),P.estimatedTime!==void 0&&(W.estimatedTime=P.estimatedTime),P.timeOfDay&&(W.timeOfDay=P.timeOfDay),P.isPrivate!==void 0&&(W.isPrivate=P.isPrivate),P.isRecurrent!==void 0&&(W.isRecurrent=P.isRecurrent,P.isRecurrent||(W.recurrence=null)),P.recurrence&&(W.recurrence={frequency:P.recurrence.frequency,pattern:P.recurrence.pattern},P.recurrence.pattern==="custom"&&P.recurrence.customDays&&(W.recurrence.customDays=P.recurrence.customDays));const I=s.find(B=>B.id===D);W.progress=fi(typeof P.description=="string"?P.description:(I==null?void 0:I.description)||""),await Br($,W),j()}catch($){console.error("Error al actualizar:",$),d($ instanceof Error?$.message:"Error al actualizar"),o("error")}}},C=async(D,P)=>{if(g){o("saving");try{const M=s.find($=>$.id===D);if(!M)throw new Error("Tarea no encontrada");if(!M.isRecurrent){const $=ue(ne,"tasks",D);await Br($,{completed:P,updatedAt:Be()}),o("idle");return}h(M),p("complete"),u(!0),o("idle")}catch(M){console.error("Error al actualizar estado:",M),d(M instanceof Error?M.message:"Error al actualizar"),o("error")}}},S=async D=>{if(g){o("saving");try{await fr(ue(ne,"tasks",D)),o("idle")}catch(P){console.error("Error al eliminar:",P),d(P instanceof Error?P.message:"Error al eliminar"),o("error")}}},_=async D=>{var P,M,$,W,I;if(!(!m||!g)){o("saving");try{const B=ue(ne,"tasks",m.id);await Br(B,{completed:!0,updatedAt:Be()});const H={userId:g.uid,title:m.title,completed:!1,createdAt:Be(),dueDate:D.dueDate?_n.fromDate(D.dueDate):null,isRecurrent:!0,category:m.category,priority:m.priority||"delete",size:m.size||"pequeña",...D.timeOfDay&&{timeOfDay:D.timeOfDay},recurrence:{pattern:((P=m.recurrence)==null?void 0:P.pattern)||"daily",frequency:((M=m.recurrence)==null?void 0:M.frequency)||1,...(($=m.recurrence)==null?void 0:$.pattern)==="custom"&&{customDays:m.recurrence.customDays}}};((W=D.description)!=null&&W.trim()||m.description)&&(H.description=((I=D.description)==null?void 0:I.trim())||m.description),H.progress=fi(H.description||""),await ji(tt(ne,"tasks"),H),j()}catch(B){console.error("Error al procesar tarea recurrente:",B),d(B instanceof Error?B.message:"Error al actualizar tarea recurrente"),o("error")}}},A=f.useCallback((D,P)=>{p("create"),h({id:"",title:"",completed:!1,category:"personal",priority:"delete",size:"pequeña",createdAt:{seconds:Date.now()/1e3},...D?{dueDate:D}:{},...P?{isPrivate:!0}:{},timeOfDay:void 0,progress:0}),u(!0)},[]),k=D=>{h(D),p("edit"),u(!0),o("idle")};return{tasks:v(),allTasks:s,status:a,error:i,showRecurrenceModal:l,currentTask:m,modalMode:x,addTask:b,editTask:N,toggleTask:C,deleteTask:S,completeRecurrentTask:_,setShowRecurrenceModal:j,openEditModal:k,openCreateModal:A,getPublicTasks:v}},C_=({selectedDate:s})=>{const{allTasks:r,status:a,error:o,showRecurrenceModal:i,currentTask:d,modalMode:l,addTask:u,editTask:m,toggleTask:h,deleteTask:x,completeRecurrentTask:p,setShowRecurrenceModal:g,openEditModal:v,openCreateModal:j}=nl(),[b,N]=f.useState(null),[C,S]=f.useState(!1),[_,A]=f.useState(""),[k,D]=f.useState(!1),P=r.filter(H=>H.isPrivate),M=P.filter(H=>H.dueDate&&Ht(H.dueDate,s)),$=P.filter(H=>!H.completed&&(!H.dueDate||!Ht(H.dueDate,s))),W=()=>{j(s,!0)},I=()=>{try{const H=JSON.parse(_);if(!Array.isArray(H)){At.error("El JSON debe contener un array de tareas");return}let U=0,ee=0;H.forEach(re=>{if(re.title){let J;if(re.dueDate){const te=new Date(re.dueDate);isNaN(te.getTime())?(ee++,console.warn(`Fecha inválida para tarea "${re.title}": ${re.dueDate}`)):J=te}u({title:re.title,description:re.description||"",dueDate:J,category:re.category||"personal",priority:re.priority||void 0,isPrivate:!0,isRecurrent:re.isRecurrent||!1,size:re.size||void 0}),U++}}),ee>0?At.warning(`${U} tareas importadas. ${ee} fechas inválidas fueron omitidas.`):At.success(`${U} tareas privadas importadas correctamente`),A(""),D(!1)}catch(H){At.error("Error al importar las tareas. Verifica el formato JSON."),console.error("Error de importación:",H)}},B=()=>{const H=P.map(ee=>{var re,J;return{title:ee.title,description:ee.description||"",dueDate:(re=ee.dueDate)==null?void 0:re.toISOString(),category:ee.category,priority:ee.priority,size:ee.size,completed:ee.completed,isRecurrent:ee.isRecurrent||!1,...ee.recurrence&&{recurrence:{frequency:ee.recurrence.frequency,pattern:ee.recurrence.pattern,customDays:ee.recurrence.customDays,nextDate:(J=ee.recurrence.nextDate)==null?void 0:J.toISOString()}}}}),U=JSON.stringify(H,null,2);navigator.clipboard.writeText(U).then(()=>{At.success("Tareas privadas copiadas al portapapeles con fechas incluidas")})};return e.jsxs(se,{className:"w-full mt-4",children:[e.jsx(Oe,{children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"text-lg",children:"🔒 Tareas Privadas"}),e.jsxs(zt,{variant:"secondary",className:"text-xs",children:[P.length," total"]})]})})}),e.jsxs(ae,{className:"space-y-4",children:[M.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-gray-600 mb-2",children:["Para hoy (",M.length,")"]}),e.jsx("div",{className:"space-y-2",children:M.map(H=>e.jsx(ur,{task:H,onToggle:h,onDelete:x,onEdit:v,onView:U=>{N(U),S(!0)},variant:"list"},H.id))})]}),$.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-gray-600 mb-2",children:["Pendientes (",$.length,")"]}),e.jsx("div",{className:"space-y-2",children:$.map(H=>e.jsx(ur,{task:H,onToggle:h,onDelete:x,onEdit:v,onView:U=>{N(U),S(!0)},variant:"list"},H.id))})]}),P.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No tienes tareas privadas"}),e.jsx("p",{className:"text-sm",children:"Crea una nueva o importa desde JSON"})]}),a==="saving"&&e.jsx(zt,{variant:"secondary",className:"text-xs",children:"Guardando..."}),o&&e.jsx("p",{className:"text-sm text-red-500",children:o})]}),e.jsxs(Bi,{className:"justify-end flex-wrap gap-2",children:[e.jsxs(st,{open:k,onOpenChange:D,children:[e.jsx(Ui,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",children:[e.jsx(Ri,{className:"w-4 h-4 mr-2"}),"Importar"]})}),e.jsxs(Ke,{children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Importar Tareas Privadas"}),e.jsx(na,{children:"Pega el JSON con las tareas a importar. Todas se marcar\\u00e1n como privadas."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{placeholder:`Ejemplo - Puedes incluir fechas en formato ISO (YYYY-MM-DD) o dejarlas sin fecha:
[
  {
    "title": "Reflexión personal importante",
    "description": "Pensar sobre mis metas de vida",
    "dueDate": "2024-12-31",
    "category": "personal",
    "priority": "do",
    "size": "mediana"
  },
  {
    "title": "Tarea sensible del trabajo",
    "description": "Revisar tema confidencial",
    "dueDate": "2024-06-15T14:30:00Z",
    "category": "work",
    "priority": "decide"
  },
  {
    "title": "Tarea sin fecha específica",
    "description": "Esta tarea no tiene fecha límite",
    "category": "personal"
  }
]

Formatos de fecha soportados:
- "2024-12-31" (solo fecha)
- "2024-06-15T14:30:00Z" (fecha y hora ISO)
- "2024-06-15T14:30:00" (fecha y hora local)
- Sin campo "dueDate" = sin fecha asignada`,value:_,onChange:H=>A(H.target.value),rows:15,className:"font-mono text-sm"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(F,{variant:"outline",onClick:()=>D(!1),children:"Cancelar"}),e.jsx(F,{onClick:I,disabled:!_.trim(),children:"Importar Tareas"})]})]})]})]}),e.jsxs(F,{size:"sm",variant:"outline",onClick:B,children:[e.jsx(hr,{className:"w-4 h-4 mr-2"}),"Exportar"]}),e.jsxs(F,{size:"sm",onClick:W,children:[e.jsx(ys,{className:"w-4 h-4 mr-2"}),"Nueva Privada"]})]}),e.jsx(al,{isOpen:i,onClose:()=>g(),onConfirm:H=>{const U={...H,isPrivate:!0};l==="complete"?p(U):l==="edit"?m(d.id,U):u(U)},task:d||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:l}),e.jsx(sl,{task:b,isOpen:C,onClose:()=>S(!1),onEdit:H=>{S(!1),v(H)},onToggle:(H,U)=>h(H,U)})]})},E_=s=>s.charAt(0).toUpperCase()+s.slice(1),D_=()=>{const{user:s}=Se();return{exportRange:async(a,o)=>{var x;if(!s)return;const i=new Date(a);i.setHours(0,0,0,0);const d=new Date(o);d.setHours(0,0,0,0);let l=`# Diario del ${vt(i,"dd MMMM yyyy",{locale:Qs})} al ${vt(d,"dd MMMM yyyy",{locale:Qs})}

`;for(let p=new Date(i);p<=d;p.setDate(p.getDate()+1)){const g=pe(p),v=ue(ne,"journal",`${s.uid}_${g}`),j=await Ot(v),b=j.exists()&&j.data().text||"",N=ue(ne,"moods",`${s.uid}_${g}`),C=await Ot(N),S=C.exists()?C.data():null,_=ns(tt(ne,"tasks"),Ge("userId","==",s.uid),Ge("completed","==",!0)),k=(await on(_)).docs.map(P=>({id:P.id,...P.data()})).filter(P=>{var $;if(!(($=P.createdAt)!=null&&$.seconds))return!1;const M=new Date(P.createdAt.seconds*1e3);return pe(M)===g}),D=vt(p,"EEEE, d 'de' MMMM 'de' yyyy",{locale:Qs});l+=`### ${E_(D)}

`,S!=null&&S.moods&&S.moods.length>0&&(l+=`**Estados de ánimo:**
`,S.moods.forEach(P=>{l+=`- ${P.time}: ${P.emoji} ${P.text}
`}),l+=`
`),k.length>0&&(l+=`**Tareas completadas:**
`,k.forEach(P=>{l+=`- ✅ ${P.title}${P.description?` - ${P.description}`:""}
`}),l+=`
`),b.trim()?l+=`**Diario:**
${b}

`:!((x=S==null?void 0:S.moods)!=null&&x.length)&&!k.length&&(l+=`_Sin entradas para este día_

`)}const u=new Blob([l],{type:"text/markdown;charset=utf-8"}),m=URL.createObjectURL(u),h=document.createElement("a");h.href=m,h.download=`${pe(i)}_a_${pe(d)}.md`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(m)}}},T_=()=>{const{exportRange:s}=D_(),[r,a]=f.useState(!1),[o,i]=f.useState("thisWeek"),[d,l]=f.useState(new Date),[u,m]=f.useState(new Date),h=()=>{const x=new Date;let p,g;if(o==="thisWeek")p=Ia(x,{weekStartsOn:1}),g=ea(x,{weekStartsOn:1});else if(o==="lastWeek"){const v=j1(x,1);p=Ia(v,{weekStartsOn:1}),g=ea(v,{weekStartsOn:1})}else p=d,g=u;s(p,g),a(!1)};return e.jsxs(st,{open:r,onOpenChange:a,children:[e.jsx(Ui,{asChild:!0,children:e.jsxs(F,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(hr,{className:"w-4 h-4"}),"Exportar Diario"]})}),e.jsxs(Ke,{children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Exportar Diario"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Le,{value:o,onValueChange:x=>i(x),children:[e.jsx(Re,{className:"w-full",children:e.jsx(ze,{placeholder:"Seleccionar rango"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"thisWeek",children:"Esta semana"}),e.jsx(le,{value:"lastWeek",children:"Semana pasada"}),e.jsx(le,{value:"custom",children:"Rango personalizado"})]})]}),o==="custom"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",className:"border rounded-md px-2 py-1 flex-1",value:Hc(d),onChange:x=>l(new Date(x.target.value))}),e.jsx("input",{type:"date",className:"border rounded-md px-2 py-1 flex-1",value:Hc(u),onChange:x=>m(new Date(x.target.value))})]})]}),e.jsxs(os,{className:"gap-2",children:[e.jsx(F,{variant:"outline",onClick:()=>a(!1),children:"Cancelar"}),e.jsx(F,{onClick:h,children:"Exportar"})]})]})]})},Hr=({title:s,tasks:r,onToggle:a,onDelete:o,onEdit:i,onView:d})=>{if(r.length===0)return null;const l={do:0,decide:1,delegate:2,delete:3},u=r.sort((m,h)=>{var g,v;const x=l[m.priority||"none"]??4,p=l[h.priority||"none"]??4;return x!==p?x-p:m.dueDate&&h.dueDate?m.dueDate.getTime()-h.dueDate.getTime():!m.dueDate&&!h.dueDate?(((g=h.createdAt)==null?void 0:g.seconds)||0)-(((v=m.createdAt)==null?void 0:v.seconds)||0):m.dueDate?-1:1});return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-500 uppercase tracking-wider pt-4",children:s}),u.map(m=>e.jsx(ur,{task:m,onToggle:a,onDelete:o,onEdit:i,onView:d,variant:"list"},m.id))]})},Hf={all:"Todas las fechas",today:"Hoy",week:"Esta semana",month:"Este mes",overdue:"Vencidas",noDate:"Sin fecha"},__=({tasks:s,onToggle:r,onDelete:a,onEdit:o,onView:i})=>{const[d,l]=f.useState("all"),[u,m]=f.useState("all"),[h,x]=f.useState(!1),[p,g]=f.useState(""),v=f.useMemo(()=>{let C=d==="all"?s:s.filter(M=>M.category===d);if(p.trim()){const M=p.toLowerCase().trim();C=C.filter($=>$.title.toLowerCase().includes(M)||$.description&&$.description.toLowerCase().includes(M))}const S=new Date,_=yt(S),A=Ia(S),k=ea(S),D=Qe(S),P=vs(S);switch(u){case"today":return C.filter(M=>M.dueDate&&Tn(M.dueDate,{start:_,end:Zs(S)}));case"week":return C.filter(M=>M.dueDate&&Tn(M.dueDate,{start:A,end:k}));case"month":return C.filter(M=>M.dueDate&&Tn(M.dueDate,{start:D,end:P}));case"overdue":return C.filter(M=>M.dueDate&&Ft(M.dueDate,_));case"noDate":return C.filter(M=>!M.dueDate);default:return C}},[s,d,u,p]),j=f.useMemo(()=>p.trim()!==""||d!=="all"||u!=="all",[p,d,u]),b=()=>{g(""),l("all"),m("all")},N=f.useMemo(()=>{const C=new Date,S=yt(C),_=Zs(C),A=ea(C);return v.reduce((k,D)=>(D.dueDate&&Ft(D.dueDate,S)?k.overdue.push(D):D.dueDate?Ft(D.dueDate,_)?k.today.push(D):Ft(D.dueDate,A)?k.thisWeek.push(D):k.future.push(D):k.noDate.push(D),k),{overdue:[],today:[],thisWeek:[],future:[],noDate:[]})},[v]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 items-stretch sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ke,{placeholder:"Buscar tareas por nombre...",value:p,onChange:C=>g(C.target.value),className:"pl-10 pr-10"}),p&&e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>g(""),className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Rs,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"md:hidden flex gap-2",children:[e.jsxs(F,{variant:j?"default":"outline",onClick:()=>x(!h),className:`flex items-center gap-2 ${j?"bg-blue-600 hover:bg-blue-700":""}`,children:[e.jsx(Uh,{className:"w-4 h-4"}),"Filtros",j&&e.jsx("span",{className:"bg-white text-blue-600 rounded-full px-2 py-0.5 text-xs font-medium",children:"Activos"})]}),j&&e.jsx(F,{variant:"ghost",onClick:b,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Rs,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"hidden md:flex",children:j&&e.jsxs(F,{variant:"ghost",onClick:b,className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(Rs,{className:"w-4 h-4"}),"Limpiar filtros"]})})]}),"      ",e.jsxs("div",{className:`space-y-4 md:space-y-0 md:flex md:items-center md:gap-4 ${h?"block":"hidden md:flex"}`,children:[e.jsxs("div",{className:"flex-1 space-y-2 md:space-y-0",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium block md:inline md:mr-2",children:"Categoría:"}),e.jsxs(Le,{value:d,onValueChange:C=>l(C),children:[e.jsx(Re,{className:`w-full md:w-[180px] ${d!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:d==="all"?"Todas las categorías":ta[d]})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todas las categorías"}),Object.entries(tl).map(([C,S])=>e.jsx(le,{value:S,children:ta[S]},C))]})]})]}),e.jsxs("div",{className:"flex-1 space-y-2 md:space-y-0",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium block md:inline md:mr-2",children:"Fecha:"}),e.jsxs(Le,{value:u,onValueChange:C=>m(C),children:[e.jsx(Re,{className:`w-full md:w-[180px] ${u!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:Hf[u]})}),e.jsx(Ie,{children:Object.entries(Hf).map(([C,S])=>e.jsx(le,{value:C,children:S},C))})]})]})]}),e.jsxs("div",{children:[e.jsx(Hr,{title:"Tareas Vencidas",tasks:N.overdue,onToggle:r,onDelete:a,onEdit:o,onView:i}),e.jsx(Hr,{title:"Para Hoy",tasks:N.today,onToggle:r,onDelete:a,onEdit:o,onView:i}),e.jsx(Hr,{title:"Esta Semana",tasks:N.thisWeek,onToggle:r,onDelete:a,onEdit:o,onView:i}),e.jsx(Hr,{title:"Próximamente",tasks:N.future,onToggle:r,onDelete:a,onEdit:o,onView:i}),e.jsx(Hr,{title:"Sin Fecha",tasks:N.noDate,onToggle:r,onDelete:a,onEdit:o,onView:i}),v.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:d==="all"&&u==="all"?"No hay tareas pendientes":"No hay tareas pendientes con los filtros seleccionados"})]})]})},sn=Ls("task"),A_=sn?`https://generativelanguage.googleapis.com/v1beta/models/${sn.model}:generateContent`:"",k_=({tasks:s,open:r,onOpenChange:a})=>{const[o,i]=f.useState(!1),d=r!==void 0?r:o,l=a??i,[u,m]=f.useState(""),[h,x]=f.useState(null),[p,g]=f.useState(""),[v,j]=f.useState(!1),[b,N]=f.useState(""),[C,S]=f.useState(0),_="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",A=(sn==null?void 0:sn.prompt)??"Eres un asistente de productividad. Basándote en el estado de ánimo y las tareas pendientes sugiere cuál debería abordar primero.",k=sn==null?void 0:sn.params;f.useEffect(()=>{if(u&&h){const M=s.filter($=>$.category===u).sort(($,W)=>{var I,B;return(((I=$.dueDate)==null?void 0:I.getTime())||1/0)-(((B=W.dueDate)==null?void 0:B.getTime())||1/0)}).slice(0,10).map($=>`- ${$.title}${$.dueDate?` (vence ${vt($.dueDate,"yyyy-MM-dd")})`:""}`).join(`
`);N(`${A}
Estado de ánimo: ${h.text}
Categoría: ${ta[u]}
Tareas:
${M}`)}else N("")},[u,h,s]),f.useEffect(()=>{S(oa(b))},[b]);const D=async()=>{var M,$,W,I,B;if(!(!h||!u)){j(!0);try{const U=await(await fetch(`${A_}?key=${_}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:b}]}],...k})})).json(),ee=(B=(I=(W=($=(M=U==null?void 0:U.candidates)==null?void 0:M[0])==null?void 0:$.content)==null?void 0:W.parts)==null?void 0:I[0])==null?void 0:B.text;g(ee||"No se pudo obtener sugerencia")}catch{g("Error al consultar la API")}finally{j(!1)}}},P=()=>{l(!1),g(""),x(null),m("")};return e.jsxs(st,{open:d,onOpenChange:M=>M?l(!0):P(),children:[r===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>l(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"}),"Sugerir tarea"]}),e.jsxs(Ke,{className:"w-full sm:max-w-5xl max-h-[90vh] overflow-auto",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Sugerencia de tarea"}),e.jsx(na,{children:"Selecciona una categoría y cómo te sientes para recibir una recomendación"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Le,{value:u,onValueChange:M=>m(M),children:[e.jsx(Re,{className:"w-full",children:e.jsx(ze,{placeholder:"Categoría"})}),e.jsx(Ie,{children:Object.values(tl).map(M=>e.jsx(le,{value:M,children:ta[M]},M))})]}),u&&!h&&e.jsx(Bx,{onSelect:M=>x(M)}),u&&h&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-center text-sm",children:["Estado de ánimo: ",h.emoji," ",h.text]}),e.jsx(Ue,{value:b,onChange:M=>N(M.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",C," ",C>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsx(F,{onClick:D,disabled:v||!_,className:"w-full",children:v?"Consultando...":"Obtener sugerencia"}),v&&e.jsx(fn,{className:"mt-2"}),p&&e.jsx("div",{className:"p-4 bg-muted rounded-md prose max-w-none",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:On.sanitize(p)}})})]})]})]})]})},an=Ls("task"),O_=an?`https://generativelanguage.googleapis.com/v1beta/models/${an.model}:generateContent`:"",P_=({tasks:s,onUpdate:r,open:a,onOpenChange:o})=>{var A;const[i,d]=f.useState(!1),l=a!==void 0?a:i,u=o??d,[m,h]=f.useState(!1),[x,p]=f.useState(""),[g,v]=f.useState(""),[j,b]=f.useState(0),N="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",C=((A=an==null?void 0:an.prompts)==null?void 0:A.reprioritize)??"Analiza la lista de tareas y devuelve un JSON con id, urgent, important, size y estimatedTime (minutos).",S=an==null?void 0:an.params;f.useEffect(()=>{if(l){const k=s.map(D=>`- id:${D.id} title:${D.title} desc:${D.description||""} priority:${D.priority||""} size:${D.size||""} time:${D.estimatedTime||""}`).join(`
`);v(`${C}
${k}`)}},[l,s]),f.useEffect(()=>{b(oa(g))},[g]);const _=async()=>{var k,D,P,M,$;if(s.length!==0){h(!0);try{const I=await(await fetch(`${O_}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:g}]}],...S})})).json(),B=(($=(M=(P=(D=(k=I==null?void 0:I.candidates)==null?void 0:k[0])==null?void 0:D.content)==null?void 0:P.parts)==null?void 0:M[0])==null?void 0:$.text)||"";p(B);const H=B.match(/```json([\s\S]*?)```/),U=H?H[1]:B;JSON.parse(U).forEach(re=>{const J=re.urgent&&re.important?"do":re.important?"decide":re.urgent?"delegate":"delete";r(re.id,{priority:J,size:re.size,estimatedTime:re.estimatedTime})})}catch{p("Error al consultar la API")}finally{h(!1)}}};return e.jsxs(e.Fragment,{children:[a===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>u(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"}),"Repriorizar"]}),e.jsx(st,{open:l,onOpenChange:u,children:e.jsxs(Ke,{className:"w-full sm:max-w-lg",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Repriorizar tareas visibles"}),e.jsx(na,{children:"La IA ajustará prioridad, tamaño y tiempo estimado."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:g,onChange:k=>v(k.target.value),className:"max-h-[300px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",j]}),e.jsx(F,{onClick:_,disabled:m||!N,className:"w-full",children:m?"Analizando...":"Repriorizar"}),m&&e.jsx(fn,{}),x&&e.jsx("pre",{className:"text-xs bg-muted p-2 rounded max-h-48 overflow-auto whitespace-pre-wrap",children:x})]})]})})]})},Zx=({tasks:s,onUpdate:r})=>{const[a,o]=f.useState(!1),[i,d]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(vr,{children:[e.jsx(yr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(rs,{className:"w-4 h-4"}),"IA"]})}),e.jsxs(Ln,{align:"end",children:[e.jsx($a,{onSelect:()=>o(!0),children:"Sugerir tareas"}),e.jsx($a,{onSelect:()=>d(!0),children:"Repriorizar visibles"})]})]}),e.jsx(k_,{tasks:s,open:a,onOpenChange:o}),e.jsx(P_,{tasks:s,onUpdate:r,open:i,onOpenChange:d})]})},Wf={all:"Todas las fechas",today:"Hoy",tomorrow:"Mañana",week:"Esta semana",month:"Este mes",overdue:"Vencidas",noDate:"Sin fecha"},Bf={all:"Todas",do:"do",decide:"decide",delegate:"delegate",delete:"delete"},Uf={all:"Todas",none:"Sin tamaño",pequeña:"pequeña",mediana:"mediana",grande:"grande"},hi={all:"Todas",yes:"Sí",no:"No"},qf={all:"Todas",t60:"≤1h",t120:"≤2h",t180:"≤3h",none:"Sin estimación"},Vf={default:"Predeterminado",priorityAsc:"Prioridad ↓",priorityDesc:"Prioridad ↑",durationAsc:"Duración ↓",durationDesc:"Duración ↑"},M_=({tasks:s,onToggle:r,onDelete:a,onEdit:o,onView:i,onMove:d,onAdd:l,onFilteredTasksChange:u})=>{const[m,h]=f.useState(null),[x,p]=f.useState("all"),[g,v]=f.useState("today"),[j,b]=f.useState("all"),[N,C]=f.useState("all"),[S,_]=f.useState("all"),[A,k]=f.useState("all"),[D,P]=f.useState("all"),[M,$]=f.useState("default"),[W,I]=f.useState(!1),[B,H]=f.useState(""),U=f.useMemo(()=>{let V=s.filter(de=>!de.isRecurrent&&!de.isPrivate);if(B.trim()){const de=B.toLowerCase().trim();V=V.filter(ye=>ye.title.toLowerCase().includes(de)||ye.description&&ye.description.toLowerCase().includes(de))}if(x!=="all"&&(V=V.filter(de=>de.category===x)),j!=="all"&&(V=V.filter(de=>de.priority===j)),N!=="all"&&(N==="none"?V=V.filter(de=>!de.size):V=V.filter(de=>de.size===N)),D!=="all")if(D==="none")V=V.filter(de=>de.estimatedTime===void 0);else{const ye={t60:60,t120:120,t180:180,all:1/0,none:0}[D];V=V.filter(Mt=>(Mt.estimatedTime??1/0)<=ye)}S!=="all"&&(V=V.filter(de=>{const ye=de.priority==="do"||de.priority==="delegate";return S==="yes"?ye:!ye})),A!=="all"&&(V=V.filter(de=>{const ye=de.priority==="do"||de.priority==="decide";return A==="yes"?ye:!ye}));const ie=new Date,at=yt(ie),qe=Ia(ie),is=ea(ie),Ut=Qe(ie),zs=vs(ie),Pt=gt(at,1),Ns=Zs(Pt);switch(g){case"today":return V.filter(de=>de.dueDate&&Tn(de.dueDate,{start:at,end:Zs(ie)}));case"tomorrow":return V.filter(de=>de.dueDate&&Tn(de.dueDate,{start:Pt,end:Ns}));case"week":return V.filter(de=>de.dueDate&&Tn(de.dueDate,{start:qe,end:is}));case"month":return V.filter(de=>de.dueDate&&Tn(de.dueDate,{start:Ut,end:zs}));case"overdue":return V.filter(de=>de.dueDate&&Ft(de.dueDate,at));case"noDate":return V.filter(de=>!de.dueDate);default:return V}},[s,x,j,N,S,A,D,g,B]);f.useEffect(()=>{u==null||u(U)},[U,u]);const ee=f.useMemo(()=>B.trim()!==""||x!=="all"||g!=="today"||j!=="all"||N!=="all"||S!=="all"||A!=="all"||D!=="all",[B,x,g,j,N,S,A,D]),re=()=>{H(""),p("all"),v("today"),b("all"),C("all"),_("all"),k("all"),P("all"),$("default")},J=f.useMemo(()=>{const V=new Date,ie=yt(V),at=Zs(V),qe=gt(yt(V),1),is=Zs(qe),Ut=ea(V),zs={do:0,decide:1,delegate:2,delete:3},Pt=U.reduce((de,ye)=>(ye.dueDate&&Ft(ye.dueDate,ie)?de.overdue.push(ye):ye.dueDate?Ft(ye.dueDate,at)?de.today.push(ye):Ft(ye.dueDate,is)?de.tomorrow.push(ye):Ft(ye.dueDate,Ut)?de.thisWeek.push(ye):de.future.push(ye):de.noDate.push(ye),de),{overdue:[],today:[],tomorrow:[],thisWeek:[],future:[],noDate:[]}),Ns=(de,ye)=>{var zn,Ws;const Mt=zs[de.priority||"none"]??4,Fs=zs[ye.priority||"none"]??4,Rt=de.estimatedTime??1/0,Hs=ye.estimatedTime??1/0;switch(M){case"priorityAsc":if(Mt!==Fs)return Fs-Mt;break;case"priorityDesc":if(Mt!==Fs)return Mt-Fs;break;case"durationAsc":if(Rt!==Hs)return Rt-Hs;break;case"durationDesc":if(Rt!==Hs)return Hs-Rt;break;default:if(Mt!==Fs)return Mt-Fs}return de.dueDate&&ye.dueDate?de.dueDate.getTime()-ye.dueDate.getTime():!de.dueDate&&!ye.dueDate?(((zn=ye.createdAt)==null?void 0:zn.seconds)||0)-(((Ws=de.createdAt)==null?void 0:Ws.seconds)||0):de.dueDate?-1:1};return Object.values(Pt).forEach(de=>{de.sort(Ns)}),Pt},[U,M]),te=f.useMemo(()=>{const V={overdue:0,today:0,tomorrow:0,thisWeek:0,future:0,noDate:0};return Object.keys(J).forEach(ie=>{V[ie]=J[ie].reduce((at,qe)=>at+(qe.estimatedTime||0),0)}),V},[J]),me=f.useMemo(()=>Object.values(te).reduce((V,ie)=>V+ie,0),[te]),Ce=[{key:"overdue",title:"Vencidas"},{key:"today",title:"Para Hoy"},{key:"tomorrow",title:"Mañana"},{key:"thisWeek",title:"Esta Semana"},{key:"future",title:"Próximamente"},{key:"noDate",title:"Sin Fecha"}],_e=V=>{const ie=new Date;switch(V){case"overdue":return Dn(gt(yt(ie),-1));case"today":return Dn(ie);case"tomorrow":return Dn(gt(yt(ie),1));case"thisWeek":return Dn(ea(ie));case"future":return Dn(Vr(ie,1));case"noDate":default:return null}},Ee=V=>{m&&(d(m.id,_e(V)),h(null))},Ne=()=>{const V=U.map(at=>({nombre:at.title,descripción:at.description||"",categoria:ta[at.category],prioridad:at.priority||"sin prioridad",tamaño:at.size||"sin tamaño",fecha:at.dueDate?new Date(at.dueDate).toLocaleDateString("es-ES"):"sin fecha",completada:at.completed?"Sí":"No"})),ie=JSON.stringify(V,null,2);navigator.clipboard.writeText(ie).then(()=>{At.success(`${V.length} tareas filtradas copiadas al portapapeles`)}).catch(()=>{At.error("Error al copiar las tareas")})};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-end items-center text-xs text-gray-500 gap-1",children:[e.jsx(pa,{className:"w-3 h-3"}),Di(me)]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 items-stretch sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ke,{placeholder:"Buscar tareas por nombre...",value:B,onChange:V=>H(V.target.value),className:"pl-10 pr-10"}),B&&e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>H(""),className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Rs,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"md:hidden flex gap-2",children:[e.jsxs(F,{variant:ee?"default":"outline",onClick:()=>I(!W),className:`flex items-center gap-2 ${ee?"bg-blue-600 hover:bg-blue-700":""}`,children:[e.jsx(Uh,{className:"w-4 h-4"}),"Filtros",ee&&e.jsx("span",{className:"bg-white text-blue-600 rounded-full px-2 py-0.5 text-xs font-medium",children:"Activos"})]}),ee&&e.jsx(F,{variant:"ghost",onClick:re,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Rs,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"hidden md:flex",children:ee&&e.jsxs(F,{variant:"ghost",onClick:re,className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(Rs,{className:"w-4 h-4"}),"Limpiar filtros"]})})]}),e.jsx("div",{className:`${W?"block":"hidden md:block"}`,children:e.jsxs("div",{className:"flex flex-wrap items-end gap-3 md:gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Categoría"}),e.jsxs(Le,{value:x,onValueChange:V=>p(V),children:[e.jsx(Re,{className:`w-32 ${x!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:x==="all"?"Todas":ta[x]})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todas"}),Object.values(tl).map(V=>e.jsx(le,{value:V,children:ta[V]},V))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Fecha"}),e.jsxs(Le,{value:g,onValueChange:V=>v(V),children:[e.jsx(Re,{className:`w-32 ${g!=="today"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:Wf[g]})}),e.jsx(Ie,{children:Object.entries(Wf).map(([V,ie])=>e.jsx(le,{value:V,children:ie},V))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Prioridad"}),e.jsxs(Le,{value:j,onValueChange:V=>b(V),children:[e.jsx(Re,{className:`w-24 ${j!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:Bf[j]})}),e.jsx(Ie,{children:Object.entries(Bf).map(([V,ie])=>e.jsx(le,{value:V,children:ie},V))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Tamaño"}),e.jsxs(Le,{value:N,onValueChange:V=>C(V),children:[e.jsx(Re,{className:`w-24 ${N!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:Uf[N]})}),e.jsx(Ie,{children:Object.entries(Uf).map(([V,ie])=>e.jsx(le,{value:V,children:ie},V))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Urgente"}),e.jsxs(Le,{value:S,onValueChange:V=>_(V),children:[e.jsx(Re,{className:`w-20 ${S!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:hi[S]})}),e.jsx(Ie,{children:Object.entries(hi).map(([V,ie])=>e.jsx(le,{value:V,children:ie},V))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Importante"}),e.jsxs(Le,{value:A,onValueChange:V=>k(V),children:[e.jsx(Re,{className:`w-20 ${A!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:hi[A]})}),e.jsx(Ie,{children:Object.entries(hi).map(([V,ie])=>e.jsx(le,{value:V,children:ie},V))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Estimado"}),e.jsxs(Le,{value:D,onValueChange:V=>P(V),children:[e.jsx(Re,{className:`w-24 ${D!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(ze,{children:qf[D]})}),e.jsx(Ie,{children:Object.entries(qf).map(([V,ie])=>e.jsx(le,{value:V,children:ie},V))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ordenar"}),e.jsxs(Le,{value:M,onValueChange:V=>$(V),children:[e.jsx(Re,{className:"w-28",children:e.jsx(ze,{children:Vf[M]})}),e.jsx(Ie,{children:Object.entries(Vf).map(([V,ie])=>e.jsx(le,{value:V,children:ie},V))})]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Exportar filtradas"}),e.jsxs(F,{variant:"outline",size:"sm",onClick:Ne,className:"flex items-center gap-1 min-w-fit",disabled:U.length===0,title:`Copia al portapapeles las ${U.length} tareas que se muestran actualmente con todos los filtros aplicados`,children:[e.jsx(nd,{className:"w-3 h-3"}),e.jsxs("span",{className:"whitespace-nowrap",children:["Copiar visibles (",U.length,")"]})]})]})})]})}),e.jsx("div",{className:"flex flex-col lg:flex-row items-start gap-2 lg:gap-4 overflow-x-auto pb-2 p-2 lg:p-3 rounded bg-gradient-to-br from-blue-50 via-indigo-50 to-indigo-100",children:Ce.map(V=>e.jsxs("div",{className:"w-full lg:w-[16rem] xl:w-[18rem] lg:flex-shrink-0 space-y-2",onDragOver:ie=>ie.preventDefault(),onDrop:()=>Ee(V.key),children:[e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("h3",{className:"font-medium text-xs lg:text-sm text-gray-500 uppercase tracking-wider flex items-center gap-1",children:[V.title,te[V.key]>0&&e.jsxs("span",{className:"text-[10px] text-gray-400 flex items-center gap-1",children:[e.jsx(pa,{className:"w-3 h-3"}),Di(te[V.key])]})]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(F,{size:"icon",variant:"ghost",onClick:()=>l(_e(V.key)),className:"h-6 w-6 lg:h-8 lg:w-8",children:e.jsx(ys,{className:"w-3 h-3 lg:w-4 lg:h-4"})})})]}),J[V.key].map(ie=>e.jsx("div",{draggable:!0,onDragStart:()=>h(ie),onDragEnd:()=>h(null),children:e.jsx(ur,{task:ie,onToggle:r,onDelete:a,onEdit:o,onView:i,onMove:d,variant:"kanban",showCategoryLabel:x==="all"})},ie.id))]},V.key))})]})},R_={do:{color:"bg-red-500",text:"Hacer (urgente + importante)",label:"🔥 do"},decide:{color:"bg-orange-500",text:"Decidir (importante)",label:"🤔 decide"},delegate:{color:"bg-blue-500",text:"Delegar (urgente)",label:"📤 delegate"},delete:{color:"bg-gray-400",text:"Eliminar (sin prioridad)",label:"🗑️ delete"}},I_=()=>e.jsxs("div",{className:"mt-6 text-sm",children:[e.jsx("h2",{className:"font-medium mb-2",children:"Convenciones de prioridad"}),e.jsx("ul",{className:"space-y-1",children:Object.entries(R_).map(([s,r])=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(zt,{className:`text-xs font-normal px-2 py-0.5 text-white ${r.color}`,children:r.label}),e.jsx("span",{children:r.text})]},s))})]}),Yf={morning:"🌅",afternoon:"🏙️",evening:"🌙"},$_=({task:s,onAssign:r,onView:a})=>{const o=(i,d)=>{i.stopPropagation(),r(s.id,d)};return e.jsx(se,{onClick:()=>a==null?void 0:a(s),className:"bg-white hover:shadow p-2 cursor-pointer space-y-2",children:e.jsxs(ae,{className:"p-0 space-y-2",children:[e.jsx("span",{className:"text-sm font-medium break-words line-clamp-2 block",children:s.title}),e.jsx("div",{className:"flex gap-1",children:Object.keys(Yf).map(i=>e.jsx(F,{size:"icon",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-muted",title:`Asignar a ${i}`,onClick:d=>o(d,i),children:Yf[i]},i))})]})})},L_=["morning","afternoon","evening"],z_=({tasks:s,onToggle:r,onDelete:a,onEdit:o,onView:i,onAssignTimeOfDay:d})=>{const l=yt(new Date),u=Zs(l),m=gt(l,1),h=Zs(m),x={overdue:{morning:[],afternoon:[],evening:[]},today:{morning:[],afternoon:[],evening:[]},tomorrow:{morning:[],afternoon:[],evening:[]}},p=[];return s.forEach(g=>{if(!g.dueDate||!g.timeOfDay){p.push(g);return}Ft(g.dueDate,l)?x.overdue[g.timeOfDay].push(g):Ft(g.dueDate,u)?x.today[g.timeOfDay].push(g):Ft(g.dueDate,h)?x.tomorrow[g.timeOfDay].push(g):p.push(g)}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsx("div",{className:"min-w-[700px] grid grid-cols-3 gap-2",children:[{key:"overdue",label:"Vencidas"},{key:"today",label:"Hoy"},{key:"tomorrow",label:"Mañana"}].map(({key:g,label:v})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-center text-sm font-medium",children:v}),L_.map(j=>e.jsxs("div",{className:"min-h-[6rem] border rounded p-1 space-y-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:qc[j]}),x[g][j].map(b=>e.jsx(ur,{task:b,onToggle:r,onDelete:a,onEdit:o,onView:i,variant:"list"},b.id))]},j))]},g))})}),p.length>0&&e.jsxs("div",{className:"w-56 space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Sin asignar"}),p.map(g=>e.jsx($_,{task:g,onView:i,onAssign:d},g.id))]})]})},F_=()=>{const{tasks:s,status:r,error:a,showRecurrenceModal:o,currentTask:i,modalMode:d,addTask:l,editTask:u,toggleTask:m,deleteTask:h,completeRecurrentTask:x,setShowRecurrenceModal:p,openEditModal:g,openCreateModal:v}=nl(),[j,b]=f.useState(null),[N,C]=f.useState(!1);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Pe,{children:"Calendario"}),e.jsxs("div",{className:"flex items-center gap-4",children:[r==="saving"&&e.jsx("span",{className:"text-xs text-blue-500",children:"Guardando..."}),e.jsxs(F,{onClick:()=>v(),size:"sm",children:[e.jsx(ys,{className:"w-4 h-4 mr-2"}),"Nueva Tarea"]})]})]})}),e.jsxs(ae,{children:[e.jsx(z_,{tasks:s,onToggle:m,onDelete:h,onEdit:g,onAssignTimeOfDay:(S,_)=>u(S,{timeOfDay:_}),onView:S=>{b(S),C(!0)}}),a&&e.jsx("p",{className:"text-sm text-red-500 mt-4",children:a})]})]}),e.jsx(al,{isOpen:o,onClose:()=>p(),onConfirm:S=>{d==="complete"?x(S):d==="edit"?u(i.id,S):l(S)},task:i||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:d}),e.jsx(sl,{task:j,isOpen:N,onClose:()=>C(!1),onEdit:S=>{C(!1),g(S)}})]})},H_=()=>{const{tasks:s,status:r,error:a,showRecurrenceModal:o,currentTask:i,modalMode:d,addTask:l,editTask:u,toggleTask:m,deleteTask:h,completeRecurrentTask:x,setShowRecurrenceModal:p,openEditModal:g,openCreateModal:v}=nl(),[j,b]=f.useState(null),[N,C]=f.useState(!1),[S,_]=f.useState([]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(se,{className:"w-full",children:[e.jsx(Oe,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Pe,{children:"Tablero Kanban"}),e.jsxs("div",{className:"flex items-center gap-4",children:[r==="saving"&&e.jsx("span",{className:"text-xs text-blue-500",children:"Guardando..."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zx,{tasks:S,onUpdate:(A,k)=>u(A,k)}),e.jsxs(F,{onClick:()=>v(),size:"sm",children:[e.jsx(ys,{className:"w-4 h-4 mr-2"}),"Nueva Tarea"]})]})]})]})}),e.jsxs(ae,{className:"overflow-x-auto",children:[e.jsx(M_,{tasks:s,onToggle:m,onDelete:h,onEdit:g,onView:A=>{b(A),C(!0)},onMove:(A,k)=>u(A,{dueDate:k??void 0}),onAdd:A=>v(A??void 0),onFilteredTasksChange:_}),a&&e.jsx("p",{className:"text-sm text-red-500 mt-4",children:a})]})]}),e.jsx(al,{isOpen:o,onClose:()=>p(),onConfirm:A=>{d==="complete"?x(A):d==="edit"?u(i.id,A):l(A)},task:i||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:d}),e.jsx(sl,{task:j,isOpen:N,onClose:()=>C(!1),onEdit:A=>{C(!1),g(A)},onToggle:(A,k)=>m(A,k)}),e.jsx(I_,{})]})},Qx=({showFloatingButton:s=!1})=>{const{user:r}=Se(),{tasks:a,status:o,error:i,showRecurrenceModal:d,currentTask:l,modalMode:u,addTask:m,editTask:h,toggleTask:x,deleteTask:p,completeRecurrentTask:g,setShowRecurrenceModal:v,openEditModal:j,openCreateModal:b}=nl(),[N,C]=f.useState(null),[S,_]=f.useState(!1),[A,k]=f.useState(""),[D,P]=f.useState(!1),M=a.filter(I=>!I.isPrivate),$=()=>{try{const I=JSON.parse(A);if(!Array.isArray(I)){At.error("El JSON debe contener un array de tareas");return}let B=0,H=0;I.forEach(U=>{if(U.title){let ee;if(U.dueDate){const re=new Date(U.dueDate);isNaN(re.getTime())?(H++,console.warn(`Fecha inválida para tarea "${U.title}": ${U.dueDate}`)):ee=re}m({title:U.title,description:U.description||"",dueDate:ee,category:U.category||"personal",priority:U.priority||void 0,isPrivate:!1,isRecurrent:U.isRecurrent||!1,size:U.size||void 0}),B++}}),H>0?At.warning(`${B} tareas importadas. ${H} fechas inválidas fueron omitidas.`):At.success(`${B} tareas importadas correctamente`),k(""),P(!1)}catch(I){At.error("Error al importar las tareas. Verifica el formato JSON."),console.error("Error de importación:",I)}},W=()=>{const I=M.map(H=>{var U,ee;return{title:H.title,description:H.description||"",dueDate:(U=H.dueDate)==null?void 0:U.toISOString(),category:H.category,priority:H.priority,size:H.size,completed:H.completed,isRecurrent:H.isRecurrent||!1,...H.recurrence&&{recurrence:{frequency:H.recurrence.frequency,pattern:H.recurrence.pattern,customDays:H.recurrence.customDays,nextDate:(ee=H.recurrence.nextDate)==null?void 0:ee.toISOString()}}}}),B=JSON.stringify(I,null,2);navigator.clipboard.writeText(B).then(()=>{At.success("Tareas copiadas al portapapeles con fechas incluidas")})};return r?e.jsxs("div",{className:"space-y-8 relative",children:[e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Pe,{children:"Tareas Pendientes"}),e.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[o==="saving"&&e.jsx("span",{className:"text-xs text-blue-500",children:"Guardando..."}),e.jsxs(st,{open:D,onOpenChange:P,children:[e.jsx(Ui,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",children:[e.jsx(Ri,{className:"w-4 h-4 mr-2"}),"Importar"]})}),e.jsxs(Ke,{className:"max-w-4xl",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Importar Tareas"}),e.jsx(na,{children:"Pega el JSON con las tareas a importar. Puedes incluir fechas en varios formatos."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{placeholder:`Ejemplo - Importa tareas con fechas en diferentes formatos:
[
  {
    "title": "Completar proyecto importante",
    "description": "Terminar la implementación",
    "dueDate": "2024-12-31",
    "category": "work",
    "priority": "do",
    "size": "grande"
  },
  {
    "title": "Revisión médica anual", 
    "description": "Chequeo general de salud",
    "dueDate": "2024-07-15T09:00:00Z",
    "category": "health",
    "priority": "decide"
  },
  {
    "title": "Tarea flexible",
    "description": "Esta tarea no tiene fecha límite específica",
    "category": "personal",
    "isRecurrent": true
  }
]

Formatos de fecha soportados:
- "2024-12-31" (solo fecha)
- "2024-06-15T14:30:00Z" (fecha y hora ISO)
- "2024-06-15T14:30:00" (fecha y hora local)
- Sin campo "dueDate" = sin fecha asignada

Campos opcionales:
- description, dueDate, priority, size, isRecurrent`,value:A,onChange:I=>k(I.target.value),rows:20,className:"font-mono text-sm"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(F,{variant:"outline",onClick:()=>P(!1),children:"Cancelar"}),e.jsx(F,{onClick:$,disabled:!A.trim(),children:"Importar Tareas"})]})]})]})]}),e.jsxs(F,{size:"sm",variant:"outline",onClick:W,children:[e.jsx(hr,{className:"w-4 h-4 mr-2"}),"Exportar"]}),e.jsx(Zx,{tasks:a,onUpdate:(I,B)=>h(I,B)}),e.jsxs(F,{onClick:()=>b(),size:"sm",children:[e.jsx(ys,{className:"w-4 h-4 mr-2"}),"Nueva Tarea"]})]}),e.jsx("div",{className:"md:hidden",children:o==="saving"&&e.jsx("span",{className:"text-xs text-blue-500",children:"Guardando..."})})]})}),e.jsx(ae,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(__,{tasks:a,onToggle:x,onDelete:p,onEdit:j,onView:I=>{C(I),_(!0)}}),i&&e.jsx("p",{className:"text-sm text-red-500",children:i})]})})]}),s&&e.jsx("div",{className:"md:hidden fixed bottom-20 right-4 z-50",children:e.jsx(F,{onClick:()=>b(),size:"lg",className:"w-14 h-14 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 bg-blue-600 hover:bg-blue-700 active:scale-95 border-0 flex items-center justify-center text-white",children:e.jsx(ys,{className:"w-6 h-6 text-white"})})}),e.jsx(al,{isOpen:d,onClose:()=>v(),onConfirm:I=>{u==="complete"?g(I):u==="edit"?h(l.id,I):m(I)},task:l||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:u}),e.jsx(sl,{task:N,isOpen:S,onClose:()=>_(!1),onEdit:I=>{_(!1),j(I)}})]}):e.jsx(se,{children:e.jsx(ae,{className:"p-8 text-center",children:e.jsx("p",{children:"Inicia sesión para gestionar tus tareas"})})})},nn=Ls("journal"),W_=nn?`https://generativelanguage.googleapis.com/v1beta/models/${nn.model}:generateContent`:"",B_=({entry:s,open:r,onOpenChange:a,onInsert:o})=>{const[i,d]=f.useState(!1),l=r!==void 0?r:i,u=a??d,[m,h]=f.useState(""),[x,p]=f.useState(!1),[g,v]=f.useState(""),[j,b]=f.useState(0),N="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",C=(nn==null?void 0:nn.prompt)??"Reescribe el siguiente texto del diario de forma clara y natural:",S=nn==null?void 0:nn.params;f.useEffect(()=>{l&&v(`${C}
${s}`)},[l,s]),f.useEffect(()=>{b(oa(g))},[g]);const _=async()=>{var k,D,P,M,$;if(s){p(!0);try{const I=await(await fetch(`${W_}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:g}]}],...S})})).json(),B=($=(M=(P=(D=(k=I==null?void 0:I.candidates)==null?void 0:k[0])==null?void 0:D.content)==null?void 0:P.parts)==null?void 0:M[0])==null?void 0:$.text;h(B||"No se pudo obtener respuesta")}catch{h("Error al consultar la API")}finally{p(!1)}}},A=()=>{u(!1),h(""),v(""),b(0)};return e.jsxs(st,{open:l,onOpenChange:k=>k?u(!0):A(),children:[r===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>u(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"}),"Mejorar entrada"]}),e.jsxs(Ke,{className:"w-full sm:max-w-5xl max-h-[90vh] overflow-auto",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Reescribir Diario"}),e.jsx(na,{children:"Gemini transformará tu texto en un estilo más natural."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:g,onChange:k=>v(k.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",j," ",j>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:_,disabled:x||!N,className:"w-full flex items-center justify-center gap-2",children:[x&&e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),x?"Consultando...":"Generar versión mejorada"]}),x&&e.jsx(fn,{className:"mt-2"}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(F,{type:"button",size:"icon",variant:"ghost",onClick:()=>{navigator.clipboard.writeText(m),At.success("Texto copiado")},children:e.jsx(nd,{className:"w-4 h-4"})})}),e.jsx(Ue,{readOnly:!0,value:m,className:"max-h-[300px]"}),o&&e.jsx(F,{type:"button",className:"w-full",onClick:()=>o(m),children:"Insertar en entrada"})]})]})]})]})},Ur=Ls("journal"),U_=Ur?`https://generativelanguage.googleapis.com/v1beta/models/${Ur.model}:generateContent`:"",q_=({entry:s,selectedDate:r,open:a,onOpenChange:o})=>{const{user:i}=Se(),[d,l]=f.useState(!1),u=a!==void 0?a:d,m=o??l,[h,x]=f.useState(""),[p,g]=f.useState(""),[v,j]=f.useState(!1),[b,N]=f.useState(0),C="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",S="Analiza la siguiente entrada del diario y los estados de ánimo del día. Da una breve opinión sobre cómo fue y sugiere mejoras para mañana.",_=Ur==null?void 0:Ur.params;f.useEffect(()=>{u?(async()=>{let D="";if(i){const P=pe(r),M=ue(tt(ne,"moods"),`${i.uid}_${P}`),$=await Ot(M);D=($.exists()&&Array.isArray($.data().moods)?$.data().moods:[]).map(I=>`${I.emoji} ${I.text}`).join(", ")}g(`${S}
Moods: ${D}
Diario:
${s}`)})():(g(""),x(""))},[u,s,i,r]),f.useEffect(()=>{N(oa(p))},[p]);const A=async()=>{var D,P,M,$,W;if(p){j(!0);try{const B=await(await fetch(`${U_}?key=${C}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:p}]}],..._})})).json(),H=(W=($=(M=(P=(D=B==null?void 0:B.candidates)==null?void 0:D[0])==null?void 0:P.content)==null?void 0:M.parts)==null?void 0:$[0])==null?void 0:W.text;x(H||"No se pudo obtener respuesta")}catch{x("Error al consultar la API")}finally{j(!1)}}},k=()=>{m(!1),x(""),g(""),N(0)};return e.jsx(st,{open:u,onOpenChange:D=>D?m(!0):k(),children:e.jsxs(Ke,{className:"w-full sm:max-w-5xl max-h-[90vh] overflow-auto",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Opinión del día"}),e.jsx(na,{children:"Resumen y sugerencias para mañana."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:p,onChange:D=>g(D.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",b," ",b>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:A,disabled:v||!C,className:"w-full flex items-center justify-center gap-2",children:[v&&e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),v?"Consultando...":"Analizar día"]}),v&&e.jsx(fn,{className:"mt-2"}),h&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(F,{type:"button",size:"icon",variant:"ghost",onClick:()=>{navigator.clipboard.writeText(h),At.success("Texto copiado")},children:e.jsx(nd,{className:"w-4 h-4"})})}),e.jsx(Ue,{readOnly:!0,value:h,className:"max-h-[300px]"})]})]})]})})},V_=({entry:s,selectedDate:r,onInsert:a})=>{const[o,i]=f.useState(!1),[d,l]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(vr,{children:[e.jsx(yr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(rs,{className:"w-4 h-4"}),"IA"]})}),e.jsxs(Ln,{align:"end",children:[e.jsx($a,{onSelect:()=>i(!0),children:"Reescribir entrada"}),e.jsx($a,{onSelect:()=>l(!0),children:"Opinión y consejos"})]})]}),e.jsx(B_,{entry:s,open:o,onOpenChange:i,onInsert:a}),e.jsx(q_,{entry:s,selectedDate:r,open:d,onOpenChange:l})]})},Y_=s=>{const[r,a]=f.useState(""),[o,i]=f.useState("idle"),[d,l]=f.useState(null),[u,m]=f.useState(void 0),{user:h}=Se();return f.useEffect(()=>{if(!h)return;const p=pe(s),g=ue(ne,"journal",`${h.uid}_${p}`),v=ht(g,j=>{if(j.exists()){if(a(j.data().text||""),i("saved"),j.data().lastUpdated){const b=j.data().lastUpdated.toDate();m(id(b))}}else a(""),i("idle"),m(void 0)},j=>{l(j.message),i("error")});return()=>v()},[h,s]),{entry:r,setEntry:a,status:o,error:d,saveEntry:async p=>{if(!h)return;i("saving"),l(null);const g=pe(s),v=ue(ne,"journal",`${h.uid}_${g}`);try{await et(v,{userId:h.uid,text:p,date:g,lastUpdated:Be(),displayTime:new Date().toLocaleString("es-ES",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"})},{merge:!0}),i("saved")}catch(j){l(j instanceof Error?j.message:"Error al guardar"),i("error")}},lastUpdated:u}},eg=({selectedDate:s})=>{const{user:r}=Se(),{isUnlocked:a,setUnlocked:o}=kd(),{entry:i,setEntry:d,status:l,error:u,saveEntry:m,lastUpdated:h}=Y_(s),{entry:x,setEntry:p}=Vx();f.useEffect(()=>{p(i)},[i,p]);const g=()=>{o(!1)};return r?a?e.jsxs(e.Fragment,{children:[e.jsxs(se,{className:"w-full",children:[e.jsxs(ae,{className:"p-4",children:[e.jsx(t_,{status:l,onLock:g,isUnlocked:a}),e.jsx(s_,{value:x,onChange:v=>{p(v),d(v)}}),u&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:u})]}),e.jsxs(Bi,{className:"flex flex-col items-end gap-2 sm:flex-row sm:justify-between",children:[e.jsx(Gx,{lastUpdated:h}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{onClick:()=>m(x),disabled:l==="saving",children:l==="saving"?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(vf,{className:"w-4 h-4 animate-spin"}),"Guardando..."]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(vf,{className:"w-4 h-4"}),"Guardar entrada"]})}),e.jsx(V_,{entry:x,selectedDate:s,onInsert:v=>{p(j=>j+(j?`
`:"")+v),d(j=>j+(j?`
`:"")+v)}}),e.jsx(T_,{})]})]})]}),e.jsx(C_,{selectedDate:s})]}):e.jsx(a_,{onUnlock:()=>o(!0),lastUpdated:h}):e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para usar el diario"})})})},G_=({selectedDate:s})=>e.jsx(VT,{children:e.jsx(GT,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(eg,{selectedDate:s})}),e.jsxs("div",{className:"md:col-span-1 space-y-4",children:[e.jsx(Od,{selectedDate:s,energyFirst:!0}),e.jsxs(xr,{children:[e.jsx(Ai,{className:"h-4 w-4"}),e.jsx(gr,{children:"Registrar tu estado de ánimo junto con tus entradas del diario te ayuda a mantener un mejor seguimiento de tus emociones y experiencias."})]})]})]})})})}),Gf={currentWeek:{label:"Semana actual",getValue:s=>({start:Ia(s),end:ea(s)})},currentMonth:{label:"Mes actual",getValue:s=>({start:Qe(s),end:vs(s)})}},K_=({onPeriodChange:s})=>{const r=a=>{const o=new Date,i=Gf[a];if(i){const{start:d,end:l}=i.getValue(o);s(d,l)}};return e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("span",{className:"text-sm font-medium",children:"Mostrar período:"}),e.jsxs(Le,{onValueChange:r,defaultValue:"currentWeek",children:[e.jsx(Re,{className:"w-[180px]",children:e.jsx(ze,{placeholder:"Seleccionar período"})}),e.jsx(Ie,{children:Object.entries(Gf).map(([a,{label:o}])=>e.jsx(le,{value:a,children:o},a))})]})]})},J_=(s,r)=>{const[a,o]=f.useState(null),[i,d]=f.useState(!0),[l,u]=f.useState(null),{user:m}=Se();return f.useEffect(()=>{(async()=>{if(m){d(!0),u(null);try{const x=[],p=new Date(s),g=new Date(r);for(;p<=g;)x.push(pe(p)),p.setDate(p.getDate()+1);const v=x.map(P=>{const M=ue(ne,"journal",`${m.uid}_${P}`);return Ot(M)}),j=x.map(P=>{const M=ue(ne,"moods",`${m.uid}_${P}`);return Ot(M)}),b=await Promise.all(v),N=await Promise.all(j),C=new Map(x.map(P=>[P,{date:P,words:0,characters:0}]));b.forEach(P=>{var M,$;if(P.exists()){const W=P.data();C.set(W.date,{date:W.date,words:((M=W.text)==null?void 0:M.split(/\s+/).filter(Boolean).length)||0,characters:(($=W.text)==null?void 0:$.length)||0})}});const S=Array.from(C.values()).sort((P,M)=>P.date<M.date?1:-1),_={};N.forEach(P=>{if(P.exists()){const M=P.data();Array.isArray(M.moods)&&M.moods.forEach($=>{_[$.text]=(_[$.text]||0)+1})}});const A=Object.entries(_).map(([P,M])=>({name:P,value:M})).sort((P,M)=>M.value-P.value).slice(0,5),k=S.filter(P=>P.words>0).length,D=k>0?Math.round(S.reduce((P,M)=>P+M.words,0)/k):0;o({entries:S,moodStats:A,totalEntries:k,averageWords:D})}catch(x){console.error("Error al cargar estadísticas del diario:",x),u(x instanceof Error?x.message:"Error al cargar estadísticas")}finally{d(!1)}}})()},[m,s,r]),{stats:a,loading:i,error:l}},Kf=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c"],X_=()=>{const[s,r]=f.useState(new Date),[a,o]=f.useState(Ia(new Date)),[i,d]=f.useState(ea(new Date)),{user:l}=Se(),{stats:u,loading:m,error:h}=J_(a,i),x=(p,g)=>{o(p),d(g)};return l?e.jsxs(Et,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Diario Personal"}),e.jsx("p",{className:"text-gray-500",children:"Escribe y reflexiona sobre tus experiencias diarias"})]}),e.jsx(xa,{selectedDate:s,onChange:r}),e.jsxs(ra,{defaultValue:"entry",className:"space-y-4",children:[e.jsxs($s,{children:[e.jsx(nt,{value:"entry",children:"Entrada Diaria"}),e.jsx(nt,{value:"analytics",children:"Análisis"}),e.jsx(nt,{value:"settings",children:"Configuración"})]}),e.jsx(rt,{value:"entry",className:"space-y-4",children:e.jsx(G_,{selectedDate:s})}),e.jsxs(rt,{value:"analytics",className:"space-y-4",children:[e.jsx(K_,{onPeriodChange:x}),m||!u?e.jsx("div",{className:"p-4",children:"Cargando estadísticas..."}):h?e.jsx("div",{className:"p-4 text-red-500",children:"Error al cargar estadísticas"}):e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(se,{children:e.jsxs(ae,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Actividad de Escritura"}),e.jsx("div",{className:"h-64",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs($i,{data:u.entries,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"date"}),e.jsx(as,{}),e.jsx(bt,{}),e.jsx(ka,{}),e.jsx(Kr,{dataKey:"words",name:"Palabras",fill:"#8884d8"})]})})})]})}),e.jsx(se,{children:e.jsxs(ae,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Estados de Ánimo Frecuentes"}),e.jsx("div",{className:"h-64",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Rn,{children:[e.jsx(In,{data:u.moodStats,nameKey:"name",dataKey:"value",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:u.moodStats.map((p,g)=>e.jsx($n,{fill:Kf[g%Kf.length]},p.name))}),e.jsx(bt,{}),e.jsx(ka,{})]})})})]})}),e.jsx(se,{children:e.jsxs(ae,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Estadísticas Generales"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total de entradas"}),e.jsx("p",{className:"text-2xl font-bold",children:u.totalEntries})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Promedio de palabras"}),e.jsx("p",{className:"text-2xl font-bold",children:u.averageWords})]})]})]})}),e.jsx(se,{children:e.jsxs(ae,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Sugerencias"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("p",{children:"• Escribe regularmente para mantener un mejor seguimiento de tus emociones"}),e.jsx("p",{children:"• Registra tu estado de ánimo junto con tus entradas del diario"}),e.jsx("p",{children:"• Revisa tus entradas anteriores para identificar patrones"}),e.jsx("p",{children:"• Usa las estadísticas para entender mejor tus hábitos de escritura"})]})]})})]})]}),e.jsx(rt,{value:"settings",className:"space-y-4",children:e.jsxs(se,{children:[e.jsx(ae,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Configuración del Diario"})}),"          "]})})]})]}):e.jsx(Et,{children:e.jsx("div",{className:"text-center py-8",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesión para acceder a tu diario"})})})},Jf=["#0088FE","#00C49F","#FFBB28","#FF8042"],tg=({defaultTab:s="list"})=>{const[r,a]=f.useState([]),[o,i]=f.useState([]),{user:d}=Se();f.useEffect(()=>{d&&l()},[d]);const l=async()=>{if(!d)return;const u=ns(tt(ne,"tasks"),Ge("userId","==",d.uid),_1("createdAt","desc"),T1(100)),h=(await on(u)).docs.map(v=>v.data()),x=h.reduce((v,j)=>{var N,C,S,_;const b=((_=(S=(C=(N=j.createdAt)==null?void 0:N.toDate)==null?void 0:C.call(N))==null?void 0:S.toISOString)==null?void 0:_.call(S).split("T")[0])||"unknown";return v[b]||(v[b]={date:b,completed:0,pending:0}),v[b][j.completed?"completed":"pending"]++,v},{});a(Object.values(x));const p=h.filter(v=>v.completed).length,g=h.filter(v=>!v.completed).length;i([{name:"Completadas",value:p},{name:"Pendientes",value:g}])};return d?e.jsxs(Et,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Gestor de Tareas"}),e.jsx("p",{className:"text-gray-500",children:"Organiza y gestiona tus tareas pendientes y completadas"})]}),e.jsxs(ra,{defaultValue:s,className:"space-y-4",children:[e.jsxs($s,{children:[e.jsx(nt,{value:"list",children:"Lista de Tareas"}),e.jsx(nt,{value:"kanban",children:"Kanban"}),e.jsx(nt,{value:"analytics",children:"Análisis"}),e.jsx(nt,{value:"week",children:"Calendario"}),e.jsx(nt,{value:"settings",children:"Configuración"})]}),e.jsx(rt,{value:"list",className:"space-y-4",children:e.jsx(Qx,{})}),e.jsx(rt,{value:"kanban",className:"space-y-4",children:e.jsx(H_,{})}),e.jsx(rt,{value:"week",className:"space-y-4",children:e.jsx(F_,{})}),e.jsx(rt,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 xl:grid-cols-2 gap-4 lg:gap-6 xl:gap-8 desktop-grid-responsive",children:[e.jsx(se,{className:"desktop-card-enhanced",children:e.jsxs(ae,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Progreso de Tareas"}),e.jsx("div",{className:"h-64 lg:h-80",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Pa,{data:r,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"date"}),e.jsx(as,{}),e.jsx(bt,{}),e.jsx(ka,{}),e.jsx(Ms,{type:"monotone",dataKey:"completed",name:"Completadas",stroke:"#8884d8"}),e.jsx(Ms,{type:"monotone",dataKey:"pending",name:"Pendientes",stroke:"#82ca9d"})]})})})]})}),e.jsx(se,{className:"desktop-card-enhanced",children:e.jsxs(ae,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Estado General"}),e.jsx("div",{className:"h-64 lg:h-80",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Rn,{children:[e.jsx(In,{data:o,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({cx:u,cy:m,midAngle:h,innerRadius:x,outerRadius:p,percent:g,name:v})=>{const j=Math.PI/180,b=25+x+(p-x),N=u+b*Math.cos(-h*j),C=m+b*Math.sin(-h*j);return e.jsx("text",{x:N,y:C,fill:"#888",textAnchor:N>u?"start":"end",dominantBaseline:"central",children:`${v} (${(g*100).toFixed(0)}%)`})},children:o.map(u=>e.jsx($n,{fill:Jf[u%Jf.length]},`cell-${u}`))}),e.jsx(bt,{})]})})})]})})]})}),e.jsx(rt,{value:"settings",className:"space-y-4",children:e.jsxs(se,{children:[e.jsx(ae,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Configuración de Tareas"})}),"          "]})})]})]}):e.jsx(Et,{children:e.jsx("div",{className:"text-center py-8",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesión para ver tus tareas"})})})},Z_=()=>e.jsx(tg,{defaultTab:"kanban"}),Q_=({view:s,onViewChange:r})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:s==="weekly"?"default":"outline",size:"sm",onClick:()=>r("weekly"),className:"gap-2",children:[e.jsx(pr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Semanal"})]}),e.jsxs(F,{variant:s==="graph"?"default":"outline",size:"sm",onClick:()=>r("graph"),className:"gap-2",children:[e.jsx(qh,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Anual"})]})]}),un=[{id:1,name:"Tomar Agua",icon:"💧",timeOfDay:"morning",goal:"5 min"},{id:2,name:"Ejercicio",icon:"🎾",timeOfDay:"morning",goal:"40 min"},{id:3,name:"Ducha fria",icon:"🚿",timeOfDay:"morning",goal:"10 min"},{id:4,name:"Desayuno",icon:"🍳",timeOfDay:"morning",goal:"30 min"},{id:5,name:"Lavarme los dientes",icon:"🪥",timeOfDay:"morning",goal:"2 min"},{id:6,name:"Seda Dental",icon:"🦷",timeOfDay:"morning",goal:"2 min"},{id:7,name:"Tender la cama",icon:"🛏️",timeOfDay:"morning",goal:"3 min"},{id:8,name:"Almuerzo",icon:"🍽️",timeOfDay:"afternoon",goal:"60 min"},{id:9,name:"Siesta",icon:"🛌",timeOfDay:"afternoon",goal:"15 min"},{id:10,name:"Lavarme los dientes",icon:"🪥",timeOfDay:"afternoon",goal:"2 min"},{id:11,name:"Seda Dental",icon:"🦷",timeOfDay:"afternoon",goal:"2 min"},{id:12,name:"Cena",icon:"🍽️",timeOfDay:"night",goal:"30 min"},{id:13,name:"Lavarme los dientes",icon:"🪥",timeOfDay:"night",goal:"2 min"},{id:14,name:"Seda Dental",icon:"🦷",timeOfDay:"night",goal:"2 min"},{id:15,name:"Llevar el diario",icon:"📓",timeOfDay:"anytime",goal:"10 min"},{id:16,name:"Botar algo que no sirva",icon:"🗑️",timeOfDay:"night",goal:"10 min"},{id:17,name:"Organizar la cocina",icon:"🍴",timeOfDay:"night",goal:"15 min"},{id:18,name:"Lectura",icon:"📚",timeOfDay:"night",goal:"5 min"}],eA={1:"bg-blue-500",2:"bg-green-500",3:"bg-yellow-500",4:"bg-orange-500",5:"bg-purple-500",6:"bg-pink-500",7:"bg-red-500",8:"bg-teal-500",9:"bg-indigo-500",10:"bg-gray-500",11:"bg-lime-500",12:"bg-amber-500",13:"bg-cyan-500",14:"bg-fuchsia-500",15:"bg-rose-500",16:"bg-violet-500",17:"bg-sky-500",18:"bg-emerald-500",19:"bg-indigo-500"},sg=(s=new Date)=>{const r=new Date(s);let a=r.getDay();a=a===0?6:a-1;const o=[];for(let i=0;i<7;i++){const d=new Date(r);d.setDate(r.getDate()-a+i),o.push({dayName:["L","M","X","J","V","S","D"][i],fullDate:pe(d)})}return o},Xf={morning:{icon:Vh,title:"Mañana",defaultOpen:()=>{const s=new Date().getHours();return s>=5&&s<12}},afternoon:{icon:Rc,title:"Tarde",defaultOpen:()=>{const s=new Date().getHours();return s>=12&&s<18}},night:{icon:Yh,title:"Noche",defaultOpen:()=>{const s=new Date().getHours();return s>=18||s<5}},anytime:{icon:Rc,title:"Cualquier momento",defaultOpen:()=>!1}},tA=s=>s>=.9?"¡Increíble! ¡Sigue así! 🌟":s>=.7?"¡Vas muy bien! ¡No pares! 💪":s>=.5?"¡Buen progreso! ¡Sigue adelante! 🎯":s>=.3?"¡Cada pequeño paso cuenta! 🌱":"¡Hoy es un buen día para empezar! 🚀",sA=(s,r)=>{const a=new Date;let o=0;for(let i=0;i<30;i++){const d=new Date(a);d.setDate(d.getDate()-i);const l=pe(d);if(s.every(m=>r[`${m.id}_${l}`]))o++;else if(i<7)break}return o},ag=({children:s,completedHabits:r})=>{const[a,o]=f.useState(()=>Object.entries(Xf).filter(([l,u])=>u.defaultOpen()).map(([l])=>l)),i=Q.useMemo(()=>un.reduce((l,u)=>(l[u.timeOfDay]||(l[u.timeOfDay]=[]),l[u.timeOfDay].push(u),l),{}),[]),d=l=>{const u=sg(),m=pe(),h=l.filter(g=>r[`${g.id}_${m}`]).length;let x=0;const p=l.length*u.length;return u.forEach(g=>{l.forEach(v=>{r[`${v.id}_${g.fullDate}`]&&x++})}),{daily:{completed:h,total:l.length},weekly:{completed:x,total:p}}};return e.jsx(_d,{type:"multiple",value:a,onValueChange:o,className:"w-full space-y-4",children:Object.entries(i).map(([l,u])=>{const m=Xf[l],h=m.icon,x=d(u),p=sA(u,r),g=x.daily.completed/x.daily.total;return e.jsxs(Xi,{value:l,className:"rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx(Zi,{className:"w-full px-6 py-4 flex items-center justify-between text-left hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring data-[state=closed]:rounded-b-lg data-[state=open]:border-b",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:m.title}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Hoy: ",x.daily.completed,"/",x.daily.total]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Semana: ",x.weekly.completed,"/",x.weekly.total]}),p>0&&e.jsxs("div",{className:"flex items-center gap-1 text-amber-500",children:[e.jsx(Gr,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:p})]})]})]})}),e.jsx(Qi,{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-6",children:[s(u),e.jsxs("div",{className:"pt-2 space-y-3 border-t border-gray-100",children:[e.jsx(kt,{value:x.daily.completed/x.daily.total*100,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:tA(g)}),x.daily.completed===x.daily.total&&e.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[e.jsx(zh,{className:"w-4 h-4"}),e.jsx("span",{children:"¡Completado!"})]})]})]})]})})]},l)})})},aA=({completedHabits:s,onToggle:r,disabled:a})=>{const o=sg(new Date),i=d=>e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-[480px] sm:min-w-[600px]",children:e.jsxs("div",{className:"grid grid-cols-[minmax(80px,140px)_repeat(7,minmax(32px,1fr))] sm:grid-cols-[minmax(120px,180px)_repeat(7,minmax(40px,1fr))] gap-1 sm:gap-2",children:[e.jsx("div",{}),o.map(l=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-xs sm:text-sm",children:l.dayName}),e.jsx("div",{className:"text-[9px] sm:text-[10px] text-gray-400",children:l.fullDate.split("-").slice(1).join("/")})]},l.fullDate)),d.map(l=>e.jsxs(Q.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 pr-1",children:[e.jsx("span",{className:"text-sm sm:text-base shrink-0",children:l.icon}),e.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium truncate leading-tight",children:l.name}),e.jsx("span",{className:"text-[10px] sm:text-xs text-gray-500 truncate leading-tight",children:l.goal})]})]}),o.map(u=>{const m=s[`${l.id}_${u.fullDate}`];return e.jsx(F,{variant:m?"default":"outline",className:`h-8 w-8 sm:h-10 sm:w-10 p-0 aspect-square rounded-lg flex items-center justify-center transition-colors mx-auto my-0.5 sm:my-1
                      ${m?eA[l.id]:"border-gray-300"}`,onClick:()=>r(l.id,u.fullDate),disabled:a,children:m?e.jsx(Lh,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}):null},`${l.id}_${u.fullDate}`)})]},l.id))]})})});return e.jsx("div",{className:"w-full",children:e.jsx(ag,{completedHabits:s,children:i})})},ng=({year:s,renderCell:r})=>{const a=d2(s);return e.jsxs("div",{className:"inline-block min-w-full",children:[e.jsx("div",{className:"flex gap-1 mb-2 ml-8",children:a.map((o,i)=>e.jsx("div",{className:Z("text-xs text-gray-500 text-center",i===0?"w-8":"w-14"),style:{minWidth:i===0?"32px":`${Math.ceil(o.days/7)*12}px`},children:o.name.slice(0,3)},o.name))}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("div",{className:"flex flex-col gap-1 text-xs text-gray-500 pr-2",children:[e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"L"}),e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"M"}),e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"V"}),e.jsx("div",{className:"h-3"})]}),e.jsx("div",{className:"flex gap-1",children:a.map(o=>{const i=String(o.number).padStart(2,"0"),d=new Date(s,o.number-1,1).getDay(),l=d===0?6:d-1,u=l+o.days,m=Math.ceil(u/7);return e.jsx("div",{className:"flex gap-1",children:Array.from({length:m},(h,x)=>e.jsx("div",{className:"flex flex-col gap-1",children:Array.from({length:7},(p,g)=>{const v=x*7+g-l+1;if(v<1||v>o.days)return e.jsx("div",{className:"w-3 h-3"},g);const j=String(v).padStart(2,"0"),b=`${s}-${i}-${j}`;return e.jsx(Q.Fragment,{children:r(b)},b)})},x))},o.name)})})]})]})},nA=({completedHabits:s,onToggle:r})=>{const a=new Date().getFullYear(),o=i=>e.jsx("div",{className:"space-y-8",children:i.map(d=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-xl",children:d.icon}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-base",children:d.name}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",d.goal,")"]})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx(ng,{year:a,renderCell:l=>{const u=s[`${d.id}_${l}`],m=new Date().toISOString().split("T")[0]===l;return e.jsx(F,{variant:"ghost",onClick:()=>r(d.id,l),className:Z("w-3 h-3 p-0 rounded-full border transition-all duration-200 hover:scale-110",u?"bg-green-600 border-green-700 hover:bg-green-700":"bg-gray-100 border-gray-200 hover:bg-gray-200 hover:border-gray-300",m&&"ring-2 ring-blue-400 ring-offset-1"),title:`${d.name} - ${new Date(l).toLocaleDateString("es-ES")}${u?" (Completado)":""}`})}}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 text-xs text-gray-600",children:[e.jsx("span",{children:"Menos"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-100 border border-gray-200 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-200 border border-green-300 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-400 border border-green-500 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-600 border border-green-700 rounded-full"})]}),e.jsx("span",{children:"Más"})]})]})]},d.id))});return e.jsx("div",{className:"w-full",children:e.jsx(ag,{completedHabits:s,children:o})})},rA=()=>{const[s,r]=f.useState({}),[a,o]=f.useState("idle"),[i,d]=f.useState(null),{user:l}=Se(),u=f.useMemo(()=>Object.values(s).reduce((h,x)=>({...h,...x}),{}),[s]);return f.useEffect(()=>{if(!l)return;const h=new Date,x=h.getFullYear(),p=h.getMonth()+1,g=`${x}-${String(p).padStart(2,"0")}`,v=ue(ne,"habits",`${l.uid}_${g}`),j=ht(v,N=>{if(N.exists()){const C=N.data();r(S=>({...S,[g]:C.habits||{}})),o("saved")}},N=>{d(N instanceof Error?N.message:"An unknown error occurred"),o("error")});return(async()=>{const N=oA(h),C=tt(ne,"habits");for(const S of N)if(S!==g)try{(await on(ns(C,Ge("userId","==",l.uid),Ge("yearMonth","==",S)))).forEach(A=>{const k=A.data();r(D=>({...D,[S]:k.habits||{}}))})}catch(_){console.error(`Error fetching month ${S}:`,_)}})(),()=>j()},[l]),{completedHabits:u,status:a,error:i,toggleHabit:async(h,x)=>{if(!l)return;o("saving"),d(null);const[p,g]=x.split("-"),v=`${p}-${g}`,j=`${h}_${x}`,b=s[v]||{},N={...b,[j]:!b[j]},C=ue(ne,"habits",`${l.uid}_${v}`);try{await et(C,{userId:l.uid,yearMonth:v,habits:N,updatedAt:Be()},{merge:!0}),o("saved")}catch(S){d(S instanceof Error?S.message:"Error al guardar"),o("error")}}}},oA=s=>{const r=[],a=s.getFullYear();for(let o=1;o<=12;o++)r.push(`${a}-${String(o).padStart(2,"0")}`);return r},Ks=Ls("habit"),iA=Ks?`https://generativelanguage.googleapis.com/v1beta/models/${Ks.model}:generateContent`:"";Li.setOptions({breaks:!0,gfm:!0});const lA=({completedHabits:s,open:r,onOpenChange:a})=>{var P,M;const[o,i]=f.useState(!1),d=r!==void 0?r:o,l=a??i,[u,m]=f.useState(""),[h,x]=f.useState(""),[p,g]=f.useState(!1),[v,j]=f.useState(0),b="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",N=((P=Ks==null?void 0:Ks.prompts)==null?void 0:P.predict)??"Analiza mis hábitos recientes y predice cuáles pueden fallar. Dame consejos para cumplirlos.",C=((M=Ks==null?void 0:Ks.prompts)==null?void 0:M.suggest)??"Sugiere nuevos hábitos basados en mis intereses y actividades.",S=Ks==null?void 0:Ks.params;f.useEffect(()=>{if(d){const $=A();x(`${N}
${C}
${$}`)}else x(""),m("")},[d,s]),f.useEffect(()=>{j(oa(h))},[h]);const _=$=>{try{const W=Li.parse($);return On.sanitize(W)}catch(W){return console.error("Error procesando Markdown:",W),On.sanitize($.replace(/\n/g,"<br>"))}},A=()=>{const $={};let W=null,I=null;const B=new Set;Object.entries(s).forEach(([re,J])=>{const[te,me]=re.split("_"),Ce=parseInt(te,10);if(B.add(me),(!W||me<W)&&(W=me),(!I||me>I)&&(I=me),J){const _e=$[Ce]||{success:0,fail:0};_e.success+=1,$[Ce]=_e}});const H=Array.from(B).sort();un.forEach(re=>{const J=$[re.id]||{success:0,fail:0};H.forEach(te=>{const me=`${re.id}_${te}`;s[me]||(J.fail+=1)}),$[re.id]=J});const U=W&&I?`Datos del ${W} al ${I}`:"Sin registros",ee=un.map(re=>{const J=$[re.id]||{success:0,fail:0};return`- ${re.name}: completado ${J.success} veces, no ejecutado ${J.fail} veces`}).join(`
`);return`${U}
${ee}`},k=async()=>{var $,W,I,B,H;g(!0);try{const ee=await(await fetch(`${iA}?key=${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}],...S})})).json(),re=(H=(B=(I=(W=($=ee==null?void 0:ee.candidates)==null?void 0:$[0])==null?void 0:W.content)==null?void 0:I.parts)==null?void 0:B[0])==null?void 0:H.text;m(re||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{g(!1)}},D=()=>{l(!1),m(""),x(""),j(0)};return e.jsxs(st,{open:d,onOpenChange:$=>$?l(!0):D(),children:[r===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>l(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"}),"Analizar hábitos"]}),e.jsxs(Ke,{className:"w-full sm:max-w-5xl max-h-[90vh] overflow-auto",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Sugerencias de hábitos"}),e.jsx(na,{children:"Predicción de fallos y recomendaciones."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:h,onChange:$=>x($.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",v," ",v>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:k,disabled:p||!b,className:"w-full flex items-center justify-center gap-2",children:[p&&e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),p?"Consultando...":"Obtener sugerencia"]}),"          ",u&&e.jsx("div",{className:"p-4 bg-muted rounded-md",children:e.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert
                  prose-headings:text-foreground prose-p:text-foreground 
                  prose-strong:text-foreground prose-ul:text-foreground 
                  prose-ol:text-foreground prose-li:text-foreground
                  prose-code:bg-accent prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-foreground
                  prose-pre:bg-accent prose-pre:border prose-pre:text-foreground
                  prose-blockquote:border-l-accent prose-blockquote:text-foreground`,dangerouslySetInnerHTML:{__html:_(u)}})})]})]})]})},cA=({completedHabits:s})=>{const[r,a]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(vr,{children:[e.jsx(yr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(rs,{className:"w-4 h-4"}),"IA"]})}),e.jsx(Ln,{align:"end",children:e.jsx($a,{onSelect:()=>a(!0),children:"Analizar hábitos"})})]}),e.jsx(lA,{completedHabits:s,open:r,onOpenChange:a})]})},rg=()=>{const[s,r]=f.useState("weekly"),{user:a}=Se(),{completedHabits:o,status:i,error:d,toggleHabit:l}=rA();return a?e.jsx(se,{className:"w-full",children:e.jsxs(ae,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Hábitos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cA,{completedHabits:o}),e.jsx(Q_,{view:s,onViewChange:r})]})]}),s==="weekly"?e.jsx(aA,{completedHabits:o,onToggle:l,disabled:i==="saving"}):e.jsx(nA,{completedHabits:o,onToggle:l}),d&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:d})]})}):e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tus hábitos"})})})},dA=()=>{const[s,r]=f.useState(new Date),[a]=f.useState([]);return e.jsxs(Et,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Seguimiento de Hábitos"}),e.jsx("p",{className:"text-gray-500",children:"Registra y analiza tus hábitos diarios para mejorar tu estilo de vida"})]}),e.jsx(xa,{selectedDate:s,onChange:r}),e.jsxs(ra,{defaultValue:"tracker",children:[e.jsxs($s,{children:[e.jsx(nt,{value:"tracker",children:"Registro Diario"}),e.jsx(nt,{value:"analytics",children:"Análisis"})]}),e.jsx(rt,{value:"tracker",children:e.jsx("div",{className:"grid grid-cols-1",children:e.jsx(rg,{selectedDate:s})})}),"        ",e.jsx(rt,{value:"analytics",className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 gap-4 lg:gap-6 xl:gap-8 desktop-grid-responsive",children:[e.jsx(se,{className:"desktop-card-enhanced",children:e.jsxs(ae,{className:"p-4 lg:p-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Tendencias de Hábitos"}),e.jsx("div",{className:"h-64 md:h-80 lg:h-96",children:e.jsx(jt,{children:e.jsxs(Pa,{data:a,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"date"}),e.jsx(as,{}),e.jsx(bt,{}),e.jsx(ka,{}),un.map(o=>e.jsx(Ms,{type:"monotone",dataKey:o.name,name:`${o.icon} ${o.name}`,stroke:`var(--${o.name.toLowerCase()}-color)`},o.id))]})})})]})}),e.jsx(se,{className:"desktop-card-enhanced",children:e.jsx(ae,{className:"p-4 lg:p-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Resumen del Mes"})})})]})})]})]})},js={breakfast:{icon:Rc,title:"Desayuno",color:"bg-amber-100",hoverColor:"hover:bg-amber-200",order:1},morningSnack:{icon:Vh,title:"Media Mañana",color:"bg-orange-100",hoverColor:"hover:bg-orange-200",order:2},lunch:{icon:Rh,title:"Almuerzo",color:"bg-emerald-100",hoverColor:"hover:bg-emerald-200",order:3},afternoonSnack:{icon:Q1,title:"Merienda",color:"bg-purple-100",hoverColor:"hover:bg-purple-200",order:4},dinner:{icon:Yh,title:"Cena",color:"bg-indigo-100",hoverColor:"hover:bg-indigo-200",order:5}},Md={breakfast:8,morningSnack:11,lunch:14,afternoonSnack:17,dinner:20},uA=(s,r)=>{const[a,o,i]=s.split("-").map(Number);return new Date(a,o-1,i,Md[r]||0,0,0,0).getTime()<Date.now()},mA=(s=new Date)=>{const r=new Date(s);let a=r.getDay();a=a===0?6:a-1;const o=[];for(let i=0;i<7;i++){const d=new Date(r);d.setDate(r.getDate()-a+i),o.push({dayName:["L","M","X","J","V","S","D"][i],fullDate:pe(d),isCurrentMonth:d.getMonth()===r.getMonth(),date:new Date(d)})}return o},fA=()=>{const s=new Date;return`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`},hA=1,pA=1e6;let Ac=0;function xA(){return Ac=(Ac+1)%Number.MAX_SAFE_INTEGER,Ac.toString()}const kc=new Map,Zf=s=>{if(kc.has(s))return;const r=setTimeout(()=>{kc.delete(s),qr({type:"REMOVE_TOAST",toastId:s})},pA);kc.set(s,r)},gA=(s,r)=>{switch(r.type){case"ADD_TOAST":return{...s,toasts:[r.toast,...s.toasts].slice(0,hA)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===r.toast.id?{...a,...r.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=r;return a?Zf(a):s.toasts.forEach(o=>{Zf(o.id)}),{...s,toasts:s.toasts.map(o=>o.id===a||a===void 0?{...o,open:!1}:o)}}case"REMOVE_TOAST":return r.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==r.toastId)}}},vi=[];let yi={toasts:[]};function qr(s){yi=gA(yi,s),vi.forEach(r=>{r(yi)})}function vA({...s}){const r=xA(),a=i=>qr({type:"UPDATE_TOAST",toast:{...i,id:r}}),o=()=>qr({type:"DISMISS_TOAST",toastId:r});return qr({type:"ADD_TOAST",toast:{...s,id:r,open:!0,onOpenChange:i=>{i||o()}}}),{id:r,dismiss:o,update:a}}function rl(){const[s,r]=f.useState(yi);return f.useEffect(()=>(vi.push(r),()=>{const a=vi.indexOf(r);a>-1&&vi.splice(a,1)}),[s]),{...s,toast:vA,dismiss:a=>qr({type:"DISMISS_TOAST",toastId:a})}}const yA=({day:s,mealPlan:r,onOpenModal:a})=>{const o=new Date,i=new Date(s.fullDate),d=i.toDateString()===o.toDateString(),l=i<o&&!d,[u,m]=f.useState(!l),h=Object.keys(r[s.fullDate]||{}).length,x=Object.keys(js).length;return e.jsxs("div",{className:`mx-2 my-3 rounded-xl shadow-sm border transition-all duration-200 ${l?"bg-gray-50 border-gray-200 opacity-75":"bg-white border-gray-100"}`,children:[e.jsxs("div",{className:`flex justify-between items-center p-4 ${l?"cursor-pointer hover:bg-gray-100":""} ${u?"border-b border-gray-100 rounded-t-xl":"rounded-xl"}`,onClick:l?()=>m(!u):void 0,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsx("div",{className:"text-gray-400",children:u?e.jsx(ga,{className:"w-4 h-4"}):e.jsx(Mn,{className:"w-4 h-4"})}),e.jsxs("h3",{className:`font-semibold text-base ${l?"text-gray-500":d?"text-blue-600":"text-gray-900"}`,children:[s.dayName,d&&" (Hoy)"]}),l&&!u&&e.jsxs("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded-md",children:[h,"/",x]})]}),e.jsx("span",{className:`text-sm px-2 py-1 rounded-md ${l?"text-gray-400 bg-gray-100":"text-gray-500 bg-gray-50"}`,children:s.fullDate.split("-").slice(1).join("/")})]}),u&&e.jsx("div",{className:"p-4 pt-0 space-y-3",children:Object.entries(js).sort(([,p],[,g])=>p.order-g.order).map(([p,g])=>{var N;const v=(N=r[s.fullDate])==null?void 0:N[p],{color:j,hoverColor:b}=g;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center w-12 shrink-0",children:[e.jsx(g.icon,{className:`w-5 h-5 mb-1 ${l?"text-gray-400":"text-gray-600"}`}),e.jsxs("span",{className:`text-xs text-center leading-tight ${l?"text-gray-400":"text-gray-500"}`,children:[Md[p],":00"]})]}),v?e.jsxs("div",{className:`flex-1 p-3 rounded-lg transition-all duration-200 cursor-pointer border active:scale-95 ${l?"bg-gray-100 border-gray-200 hover:bg-gray-150":`${j} ${b} border-gray-200`}`,onClick:()=>a(s.fullDate,p,v),children:[e.jsx("div",{className:`font-medium text-sm mb-1 line-clamp-1 ${l?"text-gray-500":"text-gray-900"}`,children:v.name}),v.notes&&e.jsx("div",{className:`text-xs line-clamp-2 mb-2 ${l?"text-gray-400":"text-gray-600"}`,children:v.notes}),v.recipe&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${l?"bg-gray-400":"bg-blue-500"}`}),e.jsx("span",{className:`text-xs ${l?"text-gray-400":"text-blue-600"}`,children:"Receta"})]})]}):e.jsxs(F,{variant:"outline",disabled:l,className:`flex-1 justify-start border-dashed h-auto py-3 text-sm transition-all ${l?"border-gray-200 text-gray-400 bg-gray-50 cursor-not-allowed":"border-gray-300 text-gray-600 hover:bg-gray-50 active:scale-95"}`,onClick:()=>!l&&a(s.fullDate,p),children:[e.jsx(ys,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"truncate",children:l?"No agregado":`Agregar ${g.title.toLowerCase()}`})]})]},p)})})]})},jA=({date:s,type:r,meal:a,disabled:o,onOpenModal:i})=>{const{color:d,hoverColor:l}=js[r],u=uA(s,r);return a?e.jsxs("div",{className:`h-full p-2 rounded ${d} relative group cursor-pointer transition-all duration-200 ease-in-out hover:shadow-md ${u?"opacity-50 grayscale":""}`,onClick:()=>i(s,r,a),children:[e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:a.name}),a.notes&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:a.notes}),a.recipe&&e.jsx("div",{className:"absolute bottom-1 right-1",children:e.jsx("div",{className:"w-2 h-2 bg-sky-500 rounded-full"})}),e.jsx("div",{className:`absolute inset-0 flex items-center justify-center 
        bg-background/75 opacity-0 group-hover:opacity-100 rounded transition-opacity ${l}`,children:e.jsx(Mi,{className:"h-4 w-4 text-gray-700"})})]}):e.jsx(F,{variant:"outline",className:`w-full h-full border-dashed ${u?"opacity-50":""}`,onClick:()=>i(s,r),disabled:o,children:e.jsx(ys,{className:"h-4 w-4"})})},bA=({day:s,mealPlan:r,disabled:a,onOpenModal:o})=>e.jsxs("div",{className:`px-2 ${s.isCurrentMonth?"":"bg-muted"}`,children:[e.jsxs("div",{className:"text-center py-2 border-b",children:[e.jsx("div",{className:"font-medium",children:s.dayName}),e.jsx("div",{className:"text-xs text-gray-500",children:s.fullDate.split("-").slice(1).join("/")})]}),Object.entries(js).sort(([,i],[,d])=>i.order-d.order).map(([i])=>{var d;return e.jsx("div",{className:"h-32 py-2",children:e.jsx(jA,{date:s.fullDate,type:i,meal:(d=r[s.fullDate])==null?void 0:d[i],disabled:a,onOpenModal:o})},i)})]}),og=()=>{const{user:s}=Se(),[r,a]=f.useState([]),[o,i]=f.useState("idle"),[d,l]=f.useState(null);f.useEffect(()=>{if(!s){a([]);return}i("loading");const p=ns(tt(ne,"shopping-list"),Ge("userId","==",s.uid)),g=ht(p,v=>{if(v.empty){a([]),i("idle");return}const j=v.docs.map(b=>{const N=b.data();return{id:b.id,name:N.name||"",quantity:N.quantity||0,status:N.status||"to-buy",...N.price!==void 0&&{price:N.price},...N.category&&{category:N.category},...N.place&&{place:N.place}}});a(j),i("idle")},v=>{(v==null?void 0:v.code)==="permission-denied"?(l("Error de permisos - Verificar reglas de Firestore"),i("error")):(l(v instanceof Error?v.message:"Error al cargar"),i("error"),a([]))});return()=>{g()}},[s]);const u=async p=>{if(!s){l("Usuario no autenticado");return}i("saving"),l(null);try{const g=r.find(j=>j.name.toLowerCase()===p.name.toLowerCase());if(g){const j=g.quantity+Number(p.quantity);g.status==="low-stock"?await m(g.id,{quantity:j}):g.status==="to-buy"?await m(g.id,{quantity:j,status:"in-stock"}):await m(g.id,{quantity:j}),i("idle");return}const v={userId:s.uid,name:p.name,quantity:Number(p.quantity),status:p.status,createdAt:Be(),updatedAt:Be()};p.price!==void 0&&p.price!==null&&!isNaN(Number(p.price))&&(v.price=Number(p.price)),p.category&&typeof p.category=="string"&&p.category.trim()!==""&&(v.category=p.category.trim()),p.place&&typeof p.place=="string"&&p.place.trim()!==""&&(v.place=p.place.trim()),await ji(tt(ne,"shopping-list"),v),i("idle")}catch(g){const v=g instanceof Error?g.message:"Error al guardar";l(v),i("error")}},m=async(p,g)=>{if(!s){l("Usuario no autenticado");return}i("saving"),l(null);try{const v=ue(ne,"shopping-list",p),j={updatedAt:Be()};g.name!==void 0&&(j.name=g.name),g.quantity!==void 0&&(j.quantity=Number(g.quantity)),g.status!==void 0&&(j.status=g.status),g.price!==void 0&&g.price!==null&&!isNaN(Number(g.price))&&(j.price=Number(g.price)),g.category!==void 0&&typeof g.category=="string"&&g.category.trim()!==""&&(j.category=g.category.trim()),g.place!==void 0&&typeof g.place=="string"&&g.place.trim()!==""&&(j.place=g.place.trim()),await Br(v,j),i("idle")}catch(v){const j=v instanceof Error?v.message:"Error al actualizar";l(j),i("error")}};return{items:r,status:o,error:d,addItem:u,updateItem:m,deleteItem:async p=>{if(!s){l("Usuario no autenticado");return}i("saving"),l(null);try{await fr(ue(ne,"shopping-list",p)),i("idle")}catch(g){const v=g instanceof Error?g.message:"Error al eliminar";l(v),i("error")}},moveItem:(p,g)=>{m(p,{status:g})}}},Js=Ls("meal"),Qf=Js?`https://generativelanguage.googleapis.com/v1beta/models/${Js.model}:generateContent`:"",NA=({selectedMeal:s,onFormChange:r,onOverwriteDay:a})=>{var W,I;const{items:o}=og(),[i,d]=f.useState(!1),[l,u]=f.useState(!1),[m,h]=f.useState(null),[x,p]=f.useState(""),[g,v]=f.useState(""),[j,b]=f.useState(0),N="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",C=((W=Js==null?void 0:Js.prompts)==null?void 0:W.meal)??"Genera una comida en formato JSON utilizando los ingredientes disponibles.",S=((I=Js==null?void 0:Js.prompts)==null?void 0:I.day)??"Genera todas las comidas del día en formato JSON.",_=Js==null?void 0:Js.params;f.useEffect(()=>{b(oa(x))},[x]);const A=()=>o.filter(H=>{if(H.category){const U=H.category.toLowerCase();if(["aseo","limpieza","cuidado personal","otro"].some(re=>U.includes(re)))return!1}return H.status==="in-stock"||H.status==="low-stock"}).map(H=>`${H.name} (${H.quantity})`).join(", "),k=B=>{const H=A(),U=g.trim();if(B==="meal"){let ee=`${C}
Dia: ${s.date}
Tipo: ${s.type}
Ingredientes: ${H}`;U&&(ee+=`
Preferencias: ${U}`),ee+=`
Devuelve JSON {"name":"","notes":"","recipe":""}`,p(ee)}else{let ee=`${S}
Dia completo: ${s.date}
Ingredientes: ${H}`;U&&(ee+=`
Preferencias: ${U}`),ee+=`
Devuelve JSON con llaves ${Object.keys(js).join(", ")}.`,p(ee)}h(B)},D=()=>{h(null),p(""),b(0)},P=async()=>{m==="meal"?await M(x):m==="day"&&await $(x),D()},M=async B=>{var H,U,ee,re,J;d(!0);try{const te=B,Ce=await(await fetch(`${Qf}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:te}]}],..._})})).json(),Ee=(((J=(re=(ee=(U=(H=Ce==null?void 0:Ce.candidates)==null?void 0:H[0])==null?void 0:U.content)==null?void 0:ee.parts)==null?void 0:re[0])==null?void 0:J.text)||"").match(/\{[\s\S]*\}/);if(Ee){const Ne=JSON.parse(Ee[0]);r("name",Ne.name||""),r("notes",Ne.notes||""),r("recipe",Ne.recipe||"")}}catch(te){console.error("AI meal error",te)}finally{d(!1)}},$=async B=>{var H,U,ee,re,J;u(!0);try{const te=B,Ce=await(await fetch(`${Qf}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:te}]}],..._})})).json(),Ee=(((J=(re=(ee=(U=(H=Ce==null?void 0:Ce.candidates)==null?void 0:H[0])==null?void 0:U.content)==null?void 0:ee.parts)==null?void 0:re[0])==null?void 0:J.text)||"").match(/\{[\s\S]*\}/);if(Ee){const Ne=JSON.parse(Ee[0]),V={};Object.keys(js).forEach(ie=>{Ne[ie]&&(V[ie]={type:ie,name:Ne[ie].name||"",notes:Ne[ie].notes||"",recipe:Ne[ie].recipe||""})}),await a(V)}}catch(te){console.error("AI day error",te)}finally{u(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Ue,{placeholder:"Preferencias (opcional)",value:g,onChange:B=>v(B.target.value),className:"h-20"}),e.jsxs(F,{type:"button",onClick:()=>k("meal"),disabled:i||!N,variant:"secondary",className:"w-full flex items-center gap-2",children:[i&&e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),e.jsx(eS,{className:"w-4 h-4"})," Generar comida"]}),e.jsxs(F,{type:"button",onClick:()=>k("day"),disabled:l||!N,variant:"ghost",className:"w-full flex items-center gap-2",children:[l&&e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),e.jsx(tS,{className:"w-4 h-4"})," Regenerar día"]}),(i||l)&&e.jsx(fn,{className:"mt-2"})]}),e.jsx(st,{open:m!==null,onOpenChange:B=>B?null:D(),children:e.jsxs(Ke,{className:"sm:max-w-xl",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Editar Prompt"})}),e.jsx(Ue,{value:x,onChange:B=>p(B.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",j," ",j>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsxs(os,{className:"flex justify-end gap-2",children:[e.jsx(F,{type:"button",variant:"outline",onClick:D,children:"Cancelar"}),e.jsx(F,{type:"button",onClick:P,children:"Generar"})]})]})})]})},wA=({show:s,onClose:r,selectedMealInfo:a,formData:o,onFormChange:i,onSubmit:d,onDelete:l,onOverwriteDay:u,weekDays:m})=>{if(!a)return null;const h=async g=>{g.preventDefault(),await d()},x=m.find(g=>g.fullDate===a.date),p=!!a.meal;return e.jsx(st,{open:s,onOpenChange:r,children:e.jsx(Ke,{className:"sm:max-w-[700px]",children:e.jsxs("form",{onSubmit:h,children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:p?"Editar Comida":"Agregar Comida"}),e.jsxs(na,{children:[x==null?void 0:x.dayName," - ",a.date.split("-").slice(1).join("/")]})]}),e.jsxs("div",{className:"space-y-4 py-4 sm:grid sm:grid-cols-2 sm:gap-4 sm:space-y-0",children:[e.jsxs("div",{className:"space-y-1 sm:col-span-2",children:[e.jsx(He,{htmlFor:"mealName",children:"Nombre de la Comida *"}),e.jsx(ke,{id:"mealName",type:"text",value:o.name,onChange:g=>i("name",g.target.value),placeholder:"Ej: Ensalada César",required:!0})]}),e.jsxs("div",{className:"space-y-1 sm:col-span-2",children:[e.jsx(He,{htmlFor:"mealNotes",children:"Notas Adicionales"}),e.jsx(ke,{id:"mealNotes",type:"text",value:o.notes,onChange:g=>i("notes",g.target.value),placeholder:"Ej: Sin crutones"})]}),e.jsxs("div",{className:"space-y-1 sm:col-span-2",children:[e.jsx(He,{htmlFor:"mealRecipe",children:"Receta"}),e.jsx(Ue,{id:"mealRecipe",value:o.recipe,onChange:g=>i("recipe",g.target.value),placeholder:"Ingredientes y preparación...",className:"h-40 resize-none"})]}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(NA,{selectedMeal:a,onFormChange:i,onOverwriteDay:g=>u(a.date,g)})})]}),e.jsxs(os,{className:"flex flex-col sm:flex-row sm:justify-between gap-2",children:[e.jsx("div",{className:"flex-grow sm:flex-grow-0",children:p&&e.jsxs(el,{children:[e.jsx(Fx,{asChild:!0,children:e.jsxs(F,{type:"button",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(oo,{className:"w-4 h-4 mr-2"}),"Eliminar"]})}),e.jsxs(mo,{children:[e.jsxs(fo,{children:[e.jsx(po,{children:"¿Estás seguro?"}),e.jsx(xo,{children:"Esta acción no se puede deshacer. Se eliminará permanentemente la comida."})]}),e.jsxs(ho,{children:[e.jsx(vo,{children:"Cancelar"}),e.jsx(go,{onClick:l,children:"Eliminar"})]})]})]})}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-end justify-end",children:[e.jsxs("div",{children:[e.jsx(He,{htmlFor:"mealType",className:"sr-only",children:"Tipo"}),e.jsxs(Le,{value:o.type,onValueChange:g=>i("type",g),name:"mealType",required:!0,children:[e.jsx(Re,{id:"mealType",className:"sm:w-40 w-full",children:e.jsx(ze,{placeholder:"Selecciona un tipo"})}),e.jsx(Ie,{children:Object.entries(js).sort(([,g],[,v])=>g.order-v.order).map(([g,{title:v}])=>e.jsx(le,{value:g,children:v},g))})]})]}),e.jsx(F,{type:"button",variant:"outline",onClick:r,children:"Cancelar"}),e.jsx(F,{type:"submit",disabled:!o.name,children:p?"Actualizar":"Agregar"})]})]})]})})})},SA=({mealPlan:s,onAddMeal:r,onRemoveMeal:a,disabled:o,selectedDate:i=new Date})=>{const{toast:d}=rl(),l=i,[u,m]=f.useState(!1),[h,x]=f.useState(null),[p,g]=f.useState({type:"breakfast",name:"",notes:"",recipe:""}),v=mA(l),j=(_,A,k)=>{x({date:_,type:A,meal:k}),g({type:(k==null?void 0:k.type)||A,name:(k==null?void 0:k.name)||"",notes:(k==null?void 0:k.notes)||"",recipe:(k==null?void 0:k.recipe)||""}),m(!0)},b=(_,A)=>{g(k=>({...k,[_]:A}))},N=async()=>{if(h)try{h.meal&&h.meal.type!==p.type&&await a(h.date,h.meal.type),await r(h.date,p.type,{type:p.type,name:p.name,notes:p.notes,recipe:p.recipe}),m(!1)}catch(_){console.error("Error al guardar:",_),d({title:"Error al Guardar",description:"No se pudo guardar la comida.",variant:"destructive"})}},C=async()=>{if(h!=null&&h.meal)try{await a(h.date,h.meal.type),m(!1)}catch(_){console.error("Error al eliminar:",_),d({title:"Error al Eliminar",description:"No se pudo eliminar la comida.",variant:"destructive"})}},S=async(_,A)=>{for(const[k,D]of Object.entries(A))await r(_,k,D);if(h){const k=A[h.type];k&&g({type:h.type,name:k.name,notes:k.notes||"",recipe:k.recipe||""})}};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("div",{className:"md:hidden flex-1 overflow-y-auto",children:e.jsxs("div",{className:"pb-20 px-2",children:[" ",v.map(_=>e.jsx(yA,{day:_,mealPlan:s,onOpenModal:j},_.fullDate))]})}),"      ",e.jsx("div",{className:"hidden md:block flex-1 overflow-auto",children:e.jsx("div",{className:"min-h-full p-4 lg:p-6 xl:p-8",children:e.jsxs("div",{className:"grid grid-cols-8 gap-2 lg:gap-4 xl:gap-6 min-w-[900px] lg:min-w-[1200px] xl:min-w-[1400px] h-full",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 lg:p-4 xl:p-6",children:Object.entries(js).sort(([,_],[,A])=>_.order-A.order).map(([_,A])=>e.jsx("div",{className:"h-32 lg:h-36 xl:h-40 flex items-center justify-center border-b border-gray-200 last:border-b-0",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx(A.icon,{className:"h-6 w-6 lg:h-7 lg:w-7 xl:h-8 xl:w-8 text-gray-600"}),e.jsx("span",{className:"font-medium text-sm lg:text-base",children:A.title}),e.jsxs("span",{className:"text-xs lg:text-sm text-gray-500",children:[Md[_],":00"]})]})},_))}),v.map(_=>e.jsx(bA,{day:_,mealPlan:s,disabled:o,onOpenModal:j},_.fullDate))]})})}),e.jsx(wA,{show:u,onClose:()=>m(!1),selectedMealInfo:h,formData:p,onFormChange:b,onSubmit:N,onDelete:C,onOverwriteDay:S,weekDays:v})]})},CA=({onImport:s,disabled:r})=>{const{toast:a}=rl(),o=d=>!d||typeof d!="object"?!1:Object.entries(d).every(([l,u])=>!/^\d{4}-\d{2}-\d{2}$/.test(l)||!u||typeof u!="object"?!1:Object.entries(u).every(([h,x])=>!(!Object.keys(js).includes(h)||!x||typeof x!="object"||typeof x.name!="string"||!x.name||x.notes&&typeof x.notes!="string"||x.recipe&&typeof x.recipe!="string"))),i=d=>{var m;const l=(m=d.target.files)==null?void 0:m[0];if(!l)return;const u=new FileReader;u.onload=async h=>{var x;try{const p=(x=h.target)==null?void 0:x.result,g=JSON.parse(p);if(!o(g))throw new Error("El formato del archivo no es válido. Revisa la documentación para ver el formato correcto.");await s(g)}catch(p){console.error("Error importing:",p),a({title:"Error de Importación",description:p instanceof Error?p.message:"Formato inválido",variant:"destructive"})}},u.readAsText(l)};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",title:"Importar Plan",accept:"application/json",onChange:i,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:r}),e.jsxs(F,{variant:"outline",size:"sm",className:"w-full",disabled:r,children:[e.jsx(Ri,{className:"h-4 w-4 mr-2"}),"Importar Plan"]})]})},EA=({onImport:s,disabled:r})=>{const[a,o]=f.useState(!1),[i,d]=f.useState(""),{toast:l}=rl(),u=h=>!h||typeof h!="object"?!1:Object.entries(h).every(([x,p])=>!/^\d{4}-\d{2}-\d{2}$/.test(x)||!p||typeof p!="object"?!1:Object.entries(p).every(([v,j])=>!(!Object.keys(js).includes(v)||!j||typeof j!="object"||typeof j.name!="string"||!j.name||j.notes&&typeof j.notes!="string"||j.recipe&&typeof j.recipe!="string"))),m=async()=>{try{const h=JSON.parse(i);if(!u(h))throw new Error("El formato del JSON no es válido. Revisa la documentación para ver el formato correcto.");await s(h),d(""),o(!1)}catch(h){console.error("Error importing from text:",h),l({title:"Error de Importación",description:h instanceof Error?h.message:"Formato inválido",variant:"destructive"})}};return e.jsxs(st,{open:a,onOpenChange:o,children:[e.jsxs(F,{variant:"outline",size:"sm",type:"button",onClick:()=>o(!0),disabled:r,children:[e.jsx(sS,{className:"h-4 w-4 mr-2"}),"Pegar JSON"]}),e.jsxs(Ke,{children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Pegar Plan de Comidas"})}),e.jsx(Ue,{value:i,onChange:h=>d(h.target.value),placeholder:"Pegue aquí el JSON del plan de comidas",className:"mt-4 min-h-[200px]"}),e.jsxs(os,{className:"gap-2 sm:gap-0",children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>o(!1),className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(F,{type:"button",onClick:m,className:"flex-1 sm:flex-none",disabled:!i.trim(),children:"Importar"})]})]})]})},DA=()=>{const[s,r]=f.useState({}),[a,o]=f.useState("idle"),[i,d]=f.useState(null),{user:l}=Se(),u=Object.values(s).reduce((p,g)=>({...p,...g}),{});return f.useEffect(()=>{if(!l)return;o("loading");const p=fA(),g=ue(ne,"meals",`${l.uid}_${p}`),v=ht(g,b=>{if(b.exists()){const N=b.data();r(C=>({...C,[p]:N.meals||{}})),o("saved")}else r(N=>({...N,[p]:{}})),o("saved")},b=>{console.error("Error loading meal plan:",b),d(b instanceof Error?b.message:"Error al cargar el plan"),o("error")});return(async()=>{const b=TA(),N=tt(ne,"meals");for(const C of b)if(C!==p)try{const S=ns(N,Ge("userId","==",l.uid),Ge("yearMonth","==",C)),_=await on(S);_.empty?r(A=>({...A,[C]:{}})):_.forEach(A=>{const k=A.data();r(D=>({...D,[C]:k.meals||{}}))})}catch(S){console.error(`Error fetching month ${C}:`,S)}})(),()=>v()},[l]),{mealPlan:u,status:a,error:i,addMeal:async(p,g,v)=>{if(!l)return;o("saving"),d(null);const[j,b]=p.split("-"),N=`${j}-${b}`,C=`${p}_${g}`;try{const S=s[N]||{},_={...S,[p]:{...S[p],[g]:{id:C,...v}}};r(k=>({...k,[N]:_}));const A=ue(ne,"meals",`${l.uid}_${N}`);await et(A,{userId:l.uid,yearMonth:N,meals:_,updatedAt:Be()},{merge:!0}),o("saved")}catch(S){throw console.error("Error adding meal:",S),d(S instanceof Error?S.message:"Error al guardar"),o("error"),S}},removeMeal:async(p,g)=>{if(!l)return;o("saving"),d(null);const[v,j]=p.split("-"),b=`${v}-${j}`;try{const N=JSON.parse(JSON.stringify(s[b]||{}));if(N[p]){const S={...N[p]};delete S[g],Object.keys(S).length===0?delete N[p]:N[p]=S}r(S=>({...S,[b]:N}));const C=ue(ne,"meals",`${l.uid}_${b}`);await et(C,{userId:l.uid,yearMonth:b,meals:N,updatedAt:Be()}),o("saved")}catch(N){throw console.error("Error removing meal:",N),d(N instanceof Error?N.message:"Error al eliminar"),o("error"),N}},importMealPlan:async p=>{if(l){o("saving"),d(null);try{const g=Object.entries(p).reduce((j,[b,N])=>{const[C,S]=b.split("-"),_=`${C}-${S}`;return j[_]||(j[_]={}),j[_][b]=Object.entries(N).reduce((A,[k,D])=>{const P=`${b}_${k}`;return A[k]={...D,id:P,type:k},A},{}),j},{});r(j=>({...j,...g}));const v=A1(ne);Object.entries(g).forEach(([j,b])=>{const N=ue(ne,"meals",`${l.uid}_${j}`);v.set(N,{userId:l.uid,yearMonth:j,meals:b,updatedAt:Be()},{merge:!0})}),await v.commit(),o("saved")}catch(g){throw console.error("Error importing meal plan:",g),d(g instanceof Error?g.message:"Error al importar"),o("error"),g}}}}},TA=()=>{const s=new Date,r=s.getFullYear(),a=s.getMonth()+1,o=s.getDate(),i=new Date(r,a,0).getDate(),d=String(a).padStart(2,"0"),l=[`${r}-${d}`];if(i-o<7){let u=a+1,m=r;u>12&&(u=1,m=r+1);const h=String(u).padStart(2,"0");l.push(`${m}-${h}`)}return l},_A=({selectedDate:s})=>{const{user:r}=Se(),{toast:a}=rl(),[o,i]=f.useState(!1),{mealPlan:d,status:l,error:u,addMeal:m,removeMeal:h,importMealPlan:x}=DA();if(!r)return e.jsx(se,{className:"w-full h-full",children:e.jsx(ae,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para planificar tus comidas"})})});const p=async(...j)=>{try{await m(...j)}catch(b){console.error("Error adding meal:",b),a({title:"Error al Agregar",description:"No se pudo agregar la comida.",variant:"destructive"})}},g=async(...j)=>{try{await h(...j)}catch(b){console.error("Error removing meal:",b),a({title:"Error al Eliminar",description:"No se pudo eliminar la comida.",variant:"destructive"})}},v=async(...j)=>{try{await x(...j),a({title:"Importación Exitosa",description:"El plan de comidas se ha importado correctamente."}),i(!1)}catch(b){console.error("Error importing meal plan:",b),a({title:"Error al Importar",description:"No se pudo importar el plan de comidas.",variant:"destructive"})}};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:["      ",e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border-b sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold",children:"Plan de Comidas"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pr,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-500",children:"Semanal"})]}),e.jsx(ff,{to:"/shopping-list",className:"text-sm text-blue-600 underline",children:"Lista de Compras"}),e.jsx(ff,{to:"/recipes",className:"text-sm text-blue-600 underline",children:"Recetas"})]}),e.jsxs(vr,{children:[e.jsx(yr,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[e.jsx(aS,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsx(Ln,{align:"end",children:e.jsxs($a,{onClick:()=>i(!0),children:[e.jsx(nS,{className:"mr-2 h-4 w-4"}),"Importar/Exportar"]})})]})]}),e.jsxs("div",{className:"flex-1 bg-gray-50 overflow-hidden",children:[e.jsx(SA,{mealPlan:d,onAddMeal:p,onRemoveMeal:g,disabled:l==="saving",selectedDate:s}),u&&e.jsxs(xr,{variant:"destructive",className:"m-4",children:[e.jsx(ki,{className:"h-4 w-4"}),e.jsx(gr,{className:"text-sm",children:u})]})]}),e.jsx(st,{open:o,onOpenChange:i,children:e.jsxs(Ke,{className:"sm:max-w-md",children:[e.jsx(Je,{children:e.jsx(Xe,{children:"Importar Plan de Comidas"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Puedes importar un plan de comidas desde un archivo JSON o pegando el contenido directamente."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(CA,{onImport:v,disabled:l==="saving"}),e.jsx(EA,{onImport:v,disabled:l==="saving"})]})]})]})})]})},AA=()=>e.jsx(Et,{noPadding:!0,className:"h-full",children:e.jsx(_A,{selectedDate:new Date})}),kA=["aseo","otro"],OA=({items:s})=>{const r=()=>{const a=s.filter(l=>{if(!l.category)return!0;const u=l.category.toLowerCase();return!kA.some(m=>u.includes(m))}),o={"in-stock":"en_stock","low-stock":"stock_bajo","to-buy":"pendiente_compra"},i=a.reduce((l,u)=>{const m=o[u.status]||u.status;return l[m]||(l[m]=[]),l[m].push({name:u.name,quantity:u.quantity}),l},{}),d=JSON.stringify(i,null,2);navigator.clipboard.writeText(d).then(()=>{At.success("Ingredientes copiados al portapapeles")})};return e.jsxs(F,{variant:"outline",size:"sm",onClick:r,className:"flex items-center gap-2",children:[e.jsx(hr,{className:"w-4 h-4"}),"Exportar ingredientes disponibles"]})},ig=[{value:"Aseo y Limpieza",emoji:"🧹"},{value:"Bebidas",emoji:"🥤"},{value:"Carnes y Pescados",emoji:"🥩"},{value:"Cereales y Granos",emoji:"🌾"},{value:"Condimentos y Especias",emoji:"🧂"},{value:"Congelados",emoji:"❄️"},{value:"Cuidado Personal",emoji:"🧴"},{value:"Enlatados y Conservas",emoji:"🥫"},{value:"Frutas y Verduras",emoji:"🍎"},{value:"Lácteos y Huevos",emoji:"🥛"},{value:"Panadería",emoji:"🍞"},{value:"Snacks y Dulces",emoji:"🍪"},{value:"Mascotas",emoji:"🐶"},{value:"Otro",emoji:"📦"}],PA=ig.reduce((s,r)=>(s[r.value]=r.emoji,s),{}),MA=ig.map(s=>s.value),Zr=s=>{if(!s)return"";const r=PA[s];return r?`${r} ${s}`:s},RA=["Éxito","D1","Ara","Dollarcity","Olimpica (SAO)","Jumbo","Plaza de mercado","Panadería","Droguería","Otro"],IA=({open:s,onOpenChange:r,onSave:a,onDelete:o,item:i})=>{const[d,l]=f.useState(""),[u,m]=f.useState(1),[h,x]=f.useState(""),[p,g]=f.useState(""),[v,j]=f.useState(""),[b,N]=f.useState("to-buy");f.useEffect(()=>{i?(l(i.name),m(i.quantity),x(i.price?String(i.price):""),g(i.category||""),j(i.place||""),N(i.status)):(l(""),m(1),x(""),g(""),j(""),N("to-buy"))},[i,s]);const C=()=>{const S={quantity:Number(u),status:b};h&&h.trim()!==""&&(S.price=Number(h)),p&&p.trim()!==""&&(S.category=p),v&&v.trim()!==""&&(S.place=v),i?a({...S,name:d},i.id):d.split(`
`).map(A=>A.trim()).filter(Boolean).forEach(A=>a({...S,name:A})),r(!1)};return e.jsx(st,{open:s,onOpenChange:r,children:e.jsxs(Ke,{className:"sm:max-w-md",children:[e.jsx(Je,{children:e.jsxs(Xe,{children:[i?"Editar":"Agregar"," Ítem"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(He,{htmlFor:"names",children:["Nombre",i?"":"s"]}),i?e.jsx(ke,{id:"names",value:d,onChange:S=>l(S.target.value)}):e.jsx(Ue,{id:"names",value:d,onChange:S=>l(S.target.value),placeholder:"Un producto por línea",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"quantity",children:"Cantidad"}),e.jsx(ke,{id:"quantity",type:"number",value:u,onChange:S=>m(Number(S.target.value))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"price",children:"Precio"}),e.jsx(ke,{id:"price",type:"number",value:h,onChange:S=>x(S.target.value)})]})]}),"          ",e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"category",children:"Categoría"}),e.jsxs(Le,{value:p,onValueChange:g,children:[e.jsx(Re,{id:"category",children:e.jsx(ze,{placeholder:"Seleccionar categoría"})}),e.jsx(Ie,{children:MA.map(S=>e.jsx(le,{value:S,children:Zr(S)},S))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"place",children:"Lugar de compra"}),e.jsxs(Le,{value:v,onValueChange:j,children:[e.jsx(Re,{id:"place",children:e.jsx(ze,{placeholder:"Seleccionar lugar"})}),e.jsx(Ie,{children:RA.map(S=>e.jsx(le,{value:S,children:S},S))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"status",children:"Estado"}),e.jsxs(Le,{value:b,onValueChange:S=>N(S),children:[e.jsx(Re,{id:"status",children:e.jsx(ze,{})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"in-stock",children:"En Stock"}),e.jsx(le,{value:"to-buy",children:"Por Comprar"}),e.jsx(le,{value:"low-stock",children:"Poco Stock"})]})]})]})]}),e.jsxs(os,{className:"flex justify-between",children:[i&&o?e.jsx(F,{variant:"destructive",onClick:()=>{o(i.id),r(!1)},children:"Eliminar"}):e.jsx("span",{}),e.jsx(F,{onClick:C,children:"Guardar"})]})]})})},eh=[{key:"to-buy",title:"Por Comprar"},{key:"low-stock",title:"Poco Stock"},{key:"in-stock",title:"En Stock"}],$A={"to-buy":rd,"low-stock":oS,"in-stock":Pi},LA=({items:s,onMove:r,onView:a})=>{const[o,i]=f.useState(""),[d,l]=f.useState("az"),[u,m]=f.useState(""),[h,x]=f.useState(""),[p,g]=f.useState(""),[v,j]=f.useState(!1),b=f.useMemo(()=>Array.from(new Set(s.map(S=>S.place).filter(Boolean))),[s]),N=f.useMemo(()=>Array.from(new Set(s.map(S=>S.category).filter(Boolean))),[s]),C=f.useMemo(()=>{let S=s.filter(A=>A.name.toLowerCase().includes(o.toLowerCase()));u&&(S=S.filter(A=>A.place===u)),h&&(S=S.filter(A=>A.status===h)),p&&(S=S.filter(A=>A.category===p)),v&&(S=S.filter(A=>A.status==="to-buy"));let _=[...S];switch(d){case"az":_.sort((A,k)=>A.name.localeCompare(k.name));break;case"za":_.sort((A,k)=>k.name.localeCompare(A.name));break;case"category":_.sort((A,k)=>(A.category||"").localeCompare(k.category||""));break}return _},[s,o,u,h,p,v,d]);return e.jsx(An,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[e.jsx(ke,{placeholder:"Buscar",value:o,onChange:S=>i(S.target.value),className:"sm:w-60"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(Le,{value:d,onValueChange:S=>l(S),children:[e.jsx(Re,{className:"w-36",children:e.jsx(ze,{placeholder:"Ordenar"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"az",children:"Nombre A-Z"}),e.jsx(le,{value:"za",children:"Nombre Z-A"}),e.jsx(le,{value:"category",children:"Categoría"})]})]}),e.jsxs(Le,{value:u||"all",onValueChange:S=>m(S==="all"?"":S),children:[e.jsx(Re,{className:"w-36",children:e.jsx(ze,{placeholder:"Lugar"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todos los lugares"}),b.map(S=>e.jsx(le,{value:S,children:S},S))]})]}),e.jsxs(Le,{value:h||"all",onValueChange:S=>x(S==="all"?"":S),children:[e.jsx(Re,{className:"w-36",children:e.jsx(ze,{placeholder:"Estado"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todos"}),e.jsx(le,{value:"to-buy",children:"Por Comprar"}),e.jsx(le,{value:"in-stock",children:"En Stock"}),e.jsx(le,{value:"low-stock",children:"Poco Stock"})]})]}),e.jsxs(Le,{value:p||"all",onValueChange:S=>g(S==="all"?"":S),children:[e.jsx(Re,{className:"w-44",children:e.jsx(ze,{placeholder:"Categoría"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todas"}),N.map(S=>e.jsx(le,{value:S,children:Zr(S)},S))]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ra,{checked:v,onCheckedChange:S=>j(!!S)}),e.jsx(rd,{className:"w-4 h-4"}),"Lista activa"]})]})]}),e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:eh.map(S=>e.jsxs("div",{className:"w-64 flex-shrink-0 space-y-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-500 uppercase tracking-wider",children:S.title}),C.filter(_=>_.status===S.key).map(_=>e.jsxs("div",{className:"bg-white shadow-sm border rounded-lg p-2 space-y-1 cursor-pointer",onClick:()=>a(_),children:[e.jsx("div",{className:"font-medium",children:_.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[_.quantity," - ",_.category&&Zr(_.category)]}),e.jsxs("div",{className:"flex justify-end gap-2 text-xs",children:[eh.filter(A=>A.key!==S.key).map(A=>{const k=$A[A.key];return e.jsxs(ln,{children:[e.jsx(cn,{asChild:!0,children:e.jsx(F,{variant:"ghost",size:"icon",onClick:D=>{D.stopPropagation(),r(_.id,A.key)},children:e.jsx(k,{className:"w-4 h-4"})})}),e.jsxs(Ma,{children:["Mover a ",A.title]})]},A.key)}),e.jsxs(ln,{children:[e.jsx(cn,{asChild:!0,children:e.jsx(F,{variant:"ghost",size:"icon",onClick:A=>{A.stopPropagation(),a(_)},children:e.jsx(rS,{className:"w-4 h-4"})})}),e.jsx(Ma,{children:"Ver detalles"})]})]})]},_.id))]},S.key))})]})})},zA=({items:s,onEdit:r,onDelete:a,onUpdate:o})=>{const[i,d]=f.useState(""),[l,u]=f.useState("az"),[m,h]=f.useState(""),[x,p]=f.useState(""),[g,v]=f.useState(""),[j,b]=f.useState(!1),[N,C]=f.useState(!1),S=f.useMemo(()=>Array.from(new Set(s.map(D=>D.place).filter(Boolean))),[s]),_=f.useMemo(()=>Array.from(new Set(s.map(D=>D.category).filter(Boolean))),[s]),A=f.useMemo(()=>{let D=s.filter(M=>M.name.toLowerCase().includes(i.toLowerCase()));m&&(D=D.filter(M=>M.place===m)),x&&(D=D.filter(M=>M.status===x)),g&&(g==="__empty"?D=D.filter(M=>!M.category):D=D.filter(M=>M.category===g)),N&&(D=D.filter(M=>M.price===void 0)),j&&(D=D.filter(M=>M.status==="to-buy"));let P=[...D];switch(l){case"az":P.sort((M,$)=>M.name.localeCompare($.name));break;case"za":P.sort((M,$)=>$.name.localeCompare(M.name));break;case"category":P.sort((M,$)=>(M.category||"").localeCompare($.category||""));break}return P},[s,i,m,x,g,N,j,l]),k=f.useMemo(()=>A.reduce((D,P)=>P.status==="to-buy"&&P.price!==void 0?D+P.price*P.quantity:D,0),[A]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[e.jsx(ke,{placeholder:"Buscar",value:i,onChange:D=>d(D.target.value),className:"sm:w-60"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(Le,{value:l,onValueChange:D=>u(D),children:[e.jsx(Re,{className:"w-36",children:e.jsx(ze,{placeholder:"Ordenar"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"az",children:"Nombre A-Z"}),e.jsx(le,{value:"za",children:"Nombre Z-A"}),e.jsx(le,{value:"category",children:"Categoría"})]})]}),e.jsxs(Le,{value:m||"all",onValueChange:D=>h(D==="all"?"":D),children:[e.jsx(Re,{className:"w-36",children:e.jsx(ze,{placeholder:"Lugar"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todos los lugares"}),S.map(D=>e.jsx(le,{value:D,children:D},D))]})]}),e.jsxs(Le,{value:x||"all",onValueChange:D=>p(D==="all"?"":D),children:[e.jsx(Re,{className:"w-36",children:e.jsx(ze,{placeholder:"Estado"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todos"}),e.jsx(le,{value:"to-buy",children:"Por Comprar"}),e.jsx(le,{value:"in-stock",children:"En Stock"}),e.jsx(le,{value:"low-stock",children:"Poco Stock"})]})]}),e.jsxs(Le,{value:g||"all",onValueChange:D=>v(D==="all"?"":D),children:[e.jsx(Re,{className:"w-44",children:e.jsx(ze,{placeholder:"Categoría"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todas"}),e.jsx(le,{value:"__empty",children:"Sin categoría"}),_.map(D=>e.jsx(le,{value:D,children:Zr(D)},D))]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ra,{checked:N,onCheckedChange:D=>C(!!D)}),"Sin precio"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ra,{checked:j,onCheckedChange:D=>b(!!D)}),e.jsx(rd,{className:"w-4 h-4"}),"Lista activa"]})]})]}),e.jsxs("div",{className:"text-right font-medium",children:["Total pendiente: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(k)]}),e.jsx("div",{className:"space-y-2",children:A.map(D=>e.jsxs("div",{className:"bg-white shadow-sm border rounded-lg p-3 flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:D.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Cantidad: ",D.quantity,D.category&&` • ${Zr(D.category)}`,D.place&&` • ${D.place}`]}),e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs ${D.status==="in-stock"?"bg-green-100 text-green-800":D.status==="low-stock"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:D.status==="in-stock"?"En Stock":D.status==="low-stock"?"Poco Stock":"Por Comprar"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>o(D.id,{quantity:D.quantity+1}),children:e.jsx(Oi,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>D.quantity>1&&o(D.id,{quantity:D.quantity-1}),children:e.jsx(ga,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>r(D),children:e.jsx(sd,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>a(D.id),children:e.jsx(oo,{className:"h-4 w-4"})})]})]},D.id))})]})},FA=()=>{const{items:s,addItem:r,updateItem:a,deleteItem:o,moveItem:i}=og(),[d,l]=f.useState(!1),[u,m]=f.useState(null),h=(x,p)=>{p?a(p,x):r(x)};return e.jsxs(se,{className:"w-full h-full flex flex-col",children:[e.jsxs(ae,{className:"p-4 space-y-4 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Lista de Compras"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(OA,{items:s}),e.jsx(F,{onClick:()=>l(!0),children:"Agregar"})]})]}),e.jsxs(ra,{defaultValue:"kanban",className:"w-full",children:[e.jsxs($s,{className:"mb-4",children:[e.jsx(nt,{value:"kanban",children:"Kanban"}),e.jsx(nt,{value:"list",children:"Lista"})]}),s.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-lg",children:"No hay elementos en tu lista"}),e.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar" para comenzar'})]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{value:"kanban",children:e.jsx(LA,{items:s,onMove:i,onView:m})}),e.jsx(rt,{value:"list",children:e.jsx(zA,{items:s,onEdit:m,onDelete:o,onUpdate:a})})]})]})]}),e.jsx(IA,{open:d||!!u,onOpenChange:()=>{l(!1),m(null)},onSave:h,onDelete:x=>o(x),item:u||void 0})]})},HA=()=>e.jsx(Et,{noPadding:!0,className:"h-full",children:e.jsx(FA,{})}),WA=()=>{const{user:s}=Se(),[r,a]=f.useState([]),[o,i]=f.useState("idle"),[d,l]=f.useState(null);return f.useEffect(()=>{if(!s){a([]);return}i("loading");const x=ns(tt(ne,"recipes"),Ge("userId","==",s.uid)),p=ht(x,g=>{const v=g.docs.map(j=>{const b=j.data();return{id:j.id,name:b.name,ingredients:b.ingredients||[],instructions:b.instructions||"",nutrition:b.nutrition||{calories:0,protein:0,carbs:0,fat:0},mealType:b.mealType,...b.description&&{description:b.description},...b.difficulty&&{difficulty:b.difficulty},...b.prepTime!==void 0&&{prepTime:b.prepTime}}});a(v),i("idle")},g=>{l(g instanceof Error?g.message:"Error al cargar"),i("error")});return()=>p()},[s]),{recipes:r,status:o,error:d,addRecipe:async x=>{if(!s){l("Usuario no autenticado");return}i("saving"),l(null);try{const p={name:x.name,ingredients:x.ingredients,instructions:x.instructions,nutrition:x.nutrition,mealType:x.mealType,userId:s.uid,createdAt:Be(),updatedAt:Be()};x.description&&(p.description=x.description),x.difficulty&&(p.difficulty=x.difficulty),x.prepTime!==void 0&&(p.prepTime=x.prepTime),await ji(tt(ne,"recipes"),p),i("idle")}catch(p){l(p instanceof Error?p.message:"Error al guardar"),i("error")}},updateRecipe:async(x,p)=>{if(!s){l("Usuario no autenticado");return}i("saving"),l(null);try{const g=ue(ne,"recipes",x),v={updatedAt:Be()};p.name!==void 0&&(v.name=p.name),p.ingredients!==void 0&&(v.ingredients=p.ingredients),p.instructions!==void 0&&(v.instructions=p.instructions),p.nutrition!==void 0&&(v.nutrition=p.nutrition),p.mealType!==void 0&&(v.mealType=p.mealType),p.description!==void 0&&(v.description=p.description),p.difficulty!==void 0&&(v.difficulty=p.difficulty),p.prepTime!==void 0&&(v.prepTime=p.prepTime),await Br(g,v),i("idle")}catch(g){l(g instanceof Error?g.message:"Error al actualizar"),i("error")}},deleteRecipe:async x=>{if(!s){l("Usuario no autenticado");return}i("saving"),l(null);try{await fr(ue(ne,"recipes",x)),i("idle")}catch(p){l(p instanceof Error?p.message:"Error al eliminar"),i("error")}}}},BA=({open:s,onOpenChange:r,onSave:a,recipe:o})=>{const[i,d]=f.useState(""),[l,u]=f.useState(""),[m,h]=f.useState(""),[x,p]=f.useState(""),[g,v]=f.useState("fácil"),[j,b]=f.useState(""),[N,C]=f.useState(""),[S,_]=f.useState(""),[A,k]=f.useState(""),[D,P]=f.useState(""),[M,$]=f.useState("breakfast");f.useEffect(()=>{o?(d(o.name),u(o.description||""),h(o.ingredients.map(I=>`${I.quantity} ${I.name}`).join(`
`)),p(o.instructions),v(o.difficulty||"fácil"),b(o.prepTime!==void 0?String(o.prepTime):""),C(String(o.nutrition.calories)),_(String(o.nutrition.protein)),k(String(o.nutrition.carbs)),P(String(o.nutrition.fat)),$(o.mealType)):(d(""),u(""),h(""),p(""),v("fácil"),b(""),C(""),_(""),k(""),P(""),$("breakfast"))},[o,s]);const W=()=>{const I=m.split(`
`).map(H=>H.trim()).filter(Boolean).map(H=>{const[U,...ee]=H.split(" ");return{quantity:U,name:ee.join(" ")}}),B={name:i,ingredients:I,description:l.trim()||void 0,difficulty:g,prepTime:j?Number(j):void 0,instructions:x,nutrition:{calories:Number(N)||0,protein:Number(S)||0,carbs:Number(A)||0,fat:Number(D)||0},mealType:M};o?a(B,o.id):a(B),r(!1)};return e.jsx(st,{open:s,onOpenChange:r,children:e.jsxs(Ke,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(Je,{children:e.jsxs(Xe,{children:[o?"Editar":"Agregar"," Receta"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"name",children:"Nombre"}),e.jsx(ke,{id:"name",value:i,onChange:I=>d(I.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"description",children:"Descripción (opcional)"}),e.jsx(Ue,{id:"description",value:l,onChange:I=>u(I.target.value),className:"min-h-[80px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"difficulty",children:"Dificultad"}),e.jsxs(Le,{value:g,onValueChange:I=>v(I),children:[e.jsx(Re,{id:"difficulty",children:e.jsx(ze,{})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"fácil",children:"Fácil"}),e.jsx(le,{value:"media",children:"Media"}),e.jsx(le,{value:"difícil",children:"Difícil"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"prepTime",children:"Tiempo (min)"}),e.jsx(ke,{id:"prepTime",type:"number",value:j,onChange:I=>b(I.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"ingredients",children:"Ingredientes (uno por línea)"}),e.jsx(Ue,{id:"ingredients",value:m,onChange:I=>h(I.target.value),className:"min-h-[120px]"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"instructions",children:"Instrucciones"}),e.jsx(Ue,{id:"instructions",value:x,onChange:I=>p(I.target.value),className:"min-h-[120px]"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"calories",children:"Calorías"}),e.jsx(ke,{id:"calories",type:"number",value:N,onChange:I=>C(I.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"protein",children:"Proteína (g)"}),e.jsx(ke,{id:"protein",type:"number",value:S,onChange:I=>_(I.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"carbs",children:"Carbs (g)"}),e.jsx(ke,{id:"carbs",type:"number",value:A,onChange:I=>k(I.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"fat",children:"Grasa (g)"}),e.jsx(ke,{id:"fat",type:"number",value:D,onChange:I=>P(I.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(He,{htmlFor:"mealType",children:"Tipo de comida"}),e.jsxs(Le,{value:M,onValueChange:I=>$(I),children:[e.jsx(Re,{id:"mealType",children:e.jsx(ze,{})}),e.jsx(Ie,{children:Object.entries(js).map(([I,B])=>e.jsx(le,{value:I,children:B.title},I))})]})]})]}),e.jsx(os,{children:e.jsx(F,{onClick:W,children:"Guardar"})})]})})},UA=({recipes:s})=>{const r=()=>{const a=s.reduce((u,m)=>{const h=m.mealType;return u[h]||(u[h]=[]),u[h].push(m),u},{}),o=JSON.stringify(a,null,2),i=new Blob([o],{type:"application/json"}),d=URL.createObjectURL(i),l=document.createElement("a");l.href=d,l.download="recipes.json",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(d)};return e.jsxs(F,{variant:"outline",size:"sm",onClick:r,className:"flex items-center gap-2",children:[e.jsx(hr,{className:"w-4 h-4"}),"Exportar recetas"]})},qA=()=>{const{recipes:s,addRecipe:r,updateRecipe:a}=WA(),[o,i]=f.useState(!1),[d,l]=f.useState(null),[u,m]=f.useState(""),[h,x]=f.useState(""),[p,g]=f.useState("az"),v=f.useMemo(()=>{let b=s.filter(C=>C.name.toLowerCase().includes(u.toLowerCase()));h&&(b=b.filter(C=>C.mealType===h));const N=[...b];return N.sort((C,S)=>p==="az"?C.name.localeCompare(S.name):S.name.localeCompare(C.name)),N},[s,u,h,p]),j=(b,N)=>{N?a(N,b):r(b)};return e.jsxs(se,{className:"w-full h-full flex flex-col",children:[e.jsxs(ae,{className:"p-4 space-y-4 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Recetas"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(UA,{recipes:s}),e.jsx(F,{onClick:()=>i(!0),children:"Agregar"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[e.jsx(ke,{placeholder:"Buscar",value:u,onChange:b=>m(b.target.value),className:"sm:w-60"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(Le,{value:p,onValueChange:b=>g(b),children:[e.jsx(Re,{className:"w-32",children:e.jsx(ze,{placeholder:"Ordenar"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"az",children:"Nombre A-Z"}),e.jsx(le,{value:"za",children:"Nombre Z-A"})]})]}),e.jsxs(Le,{value:h||"all",onValueChange:b=>x(b==="all"?"":b),children:[e.jsx(Re,{className:"w-40",children:e.jsx(ze,{placeholder:"Tipo"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todos"}),Object.entries(js).map(([b,N])=>e.jsx(le,{value:b,children:N.title},b))]})]})]})]}),v.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No hay recetas guardadas"}):e.jsx("div",{className:"space-y-4",children:v.map(b=>e.jsxs(se,{children:[e.jsxs(Oe,{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(Pe,{className:"text-base",children:b.name}),e.jsx(pp,{children:js[b.mealType].title})]}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>{l(b),i(!0)},children:"Editar"})]}),e.jsxs(ae,{className:"space-y-2",children:[b.description&&e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:b.description}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Dificultad:"})," ",b.difficulty||"N/A"," |"," ",e.jsx("span",{className:"font-medium",children:"Tiempo:"})," ",b.prepTime?`${b.prepTime} min`:"N/A"]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Ingredientes:"}),e.jsx("ul",{className:"list-disc pl-4 text-sm",children:b.ingredients.map((N,C)=>e.jsxs("li",{children:[N.quantity," ",N.name]},C))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Instrucciones:"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:b.instructions})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Información Nutricional:"}),e.jsxs("p",{className:"text-sm",children:[b.nutrition.calories," kcal |"," ",b.nutrition.protein,"g P |"," ",b.nutrition.carbs,"g C |"," ",b.nutrition.fat,"g G"]})]})]})]},b.id))})]}),e.jsx(BA,{open:o,onOpenChange:b=>{b||l(null),i(b)},onSave:j,recipe:d||void 0})]})},VA=()=>e.jsx(Et,{noPadding:!0,className:"h-full",children:e.jsx(qA,{})}),YA=()=>{const{user:s,signIn:r,signOut:a}=Se();return e.jsx("div",{className:"flex items-center gap-4",children:s?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm",children:s.email}),e.jsx(F,{variant:"outline",onClick:a,children:"Cerrar sesión"})]}):e.jsx(F,{onClick:r,children:"Iniciar sesión con Google"})})},Cn=f.forwardRef(({className:s,variant:r="default",...a},o)=>{const i={default:"bg-card text-card-foreground border shadow-sm",glass:"glass-card text-card-foreground",gradient:"gradient-bg-primary text-white border-0 shadow-lg",elevated:"bg-card text-card-foreground border-0 shadow-lg hover:shadow-xl transition-shadow duration-300"};return e.jsx("div",{ref:o,className:Z("rounded-xl transition-all duration-300",i[r],s),...a})});Cn.displayName="ModernCard";const GA=f.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:Z("flex flex-col space-y-1.5 p-6",s),...r}));GA.displayName="ModernCardHeader";const KA=f.forwardRef(({className:s,gradient:r,...a},o)=>e.jsx("h3",{ref:o,className:Z("text-2xl font-semibold leading-none tracking-tight",r&&"bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",s),...a}));KA.displayName="ModernCardTitle";const JA=f.forwardRef(({className:s,...r},a)=>e.jsx("p",{ref:a,className:Z("text-sm text-muted-foreground",s),...r}));JA.displayName="ModernCardDescription";const XA=f.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:Z("p-6 pt-0",s),...r}));XA.displayName="ModernCardContent";const ZA=f.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:Z("flex items-center p-6 pt-0",s),...r}));ZA.displayName="ModernCardFooter";const QA=()=>{const[s,r]=f.useState(new Date);return e.jsxs(Et,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 via-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:"Daily Life Tracker"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Organiza tu día, mejora tu vida"})]}),e.jsx(xa,{selectedDate:s,onChange:r}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:["        ",e.jsx("div",{className:"col-span-12 lg:col-span-8 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Cn,{variant:"elevated",className:"bg-card",children:e.jsx(Wx,{selectedDate:s})}),e.jsx(Cn,{variant:"elevated",className:"bg-card",children:e.jsx(Gp,{selectedDate:s})})]})}),e.jsx("div",{className:"col-span-12 lg:col-span-4 space-y-6",children:e.jsx(Cn,{variant:"glass",children:e.jsx(Od,{selectedDate:s})})}),e.jsx("div",{className:"col-span-12 space-y-8",children:e.jsx(Cn,{variant:"elevated",className:"bg-card",children:e.jsx(eg,{selectedDate:s})})}),e.jsx("div",{className:"col-span-12 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Cn,{variant:"elevated",className:"bg-card",children:e.jsx(rg,{selectedDate:s})}),e.jsx(Cn,{variant:"elevated",className:"bg-card",children:e.jsx(Qx,{selectedDate:s})})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(YA,{})})]})},Kc={cardio:{name:"Cardio",description:"Ejercicios cardiovasculares",icon:"❤️"},strength:{name:"Fuerza",description:"Ejercicios de fuerza y resistencia",icon:"💪"},flexibility:{name:"Flexibilidad",description:"Ejercicios de estiramiento",icon:"🤸"}},kn=[{id:1,name:"Pasos",icon:"👣",category:"cardio",targetMuscles:["piernas"],caloriesPerHour:200,description:"Registro de pasos diarios",stepsPerKm:1312},{id:2,name:"Trotar",icon:"🏃",category:"cardio",targetMuscles:["piernas","core"],defaultDuration:30,caloriesPerHour:500,description:"Trote suave a ritmo constante",stepsPerKm:1200},{id:3,name:"Bicicleta",icon:"🚲",category:"cardio",targetMuscles:["piernas","core"],defaultDuration:45,defaultDistance:1e4,caloriesPerHour:450,description:"Ciclismo recreativo"},{id:4,name:"Caminata",icon:"🚶",category:"cardio",targetMuscles:["piernas"],defaultDuration:30,caloriesPerHour:250,description:"Caminata a paso moderado",stepsPerKm:1400},{id:5,name:"Natación",icon:"🏊",category:"cardio",targetMuscles:["todo el cuerpo"],defaultDuration:30,caloriesPerHour:550,description:"Natación estilo libre"},{id:6,name:"Tenis",icon:"🎾",category:"cardio",targetMuscles:["todo el cuerpo"],defaultDuration:60,caloriesPerHour:500,description:"Partido recreativo de tenis"},{id:7,name:"Abdominales",icon:"💪",category:"strength",targetMuscles:["abdominales","core"],defaultSets:3,defaultReps:15,caloriesPerHour:300,description:"Series de abdominales básicos"},{id:8,name:"Pesas de mano",icon:"🏋️",category:"strength",targetMuscles:["brazos","hombros"],defaultSets:3,defaultReps:12,caloriesPerHour:250,description:"Ejercicios con mancuernas ligeras"},{id:9,name:"Flexiones",icon:"💪",category:"strength",targetMuscles:["pecho","tríceps","hombros"],defaultSets:3,defaultReps:10,caloriesPerHour:350,description:"Flexiones de pecho (pushups)"},{id:10,name:"Sentadillas",icon:"🏋️",category:"strength",targetMuscles:["cuádriceps","glúteos","core"],defaultSets:3,defaultReps:12,caloriesPerHour:400,description:"Sentadillas sin peso adicional"},{id:11,name:"Burpees",icon:"💥",category:"strength",targetMuscles:["todo el cuerpo"],defaultSets:3,defaultReps:15,caloriesPerHour:700,description:"Ejercicio completo de cardio y fuerza"},{id:12,name:"Yoga",icon:"🧘",category:"flexibility",targetMuscles:["todo el cuerpo"],defaultDuration:20,caloriesPerHour:250,description:"Rutina básica de yoga"},{id:13,name:"Estiramientos",icon:"🤸",category:"flexibility",targetMuscles:["todo el cuerpo"],defaultDuration:15,caloriesPerHour:150,description:"Rutina de estiramientos generales"}],e4={cardio:"bg-red-500",strength:"bg-blue-500",flexibility:"bg-green-500"},t4=s=>{const[r,a]=f.useState(null),[o,i]=f.useState("idle"),[d,l]=f.useState(null),{user:u}=Se(),m=g=>g.reduce((v,j)=>{const b=kn.find(C=>C.id===j.exerciseId);if(!b)return v;v.totalCalories+=j.calories||0,v.totalSteps+=j.steps||0,v.totalDuration+=j.duration||0,v.totalDistance+=j.distance||0;const N=v.categoryStats[b.category];return N.count+=1,N.duration+=j.duration||0,N.calories+=j.calories||0,v},{totalCalories:0,totalSteps:0,totalDuration:0,totalDistance:0,categoryStats:{cardio:{count:0,duration:0,calories:0},strength:{count:0,duration:0,calories:0},flexibility:{count:0,duration:0,calories:0}}});f.useEffect(()=>{if(!u)return;(async()=>{i("loading");const v=pe(s),j=ue(ne,"exercises",`${u.uid}_${v}`);try{const b=await Ot(j);b.exists()?a(b.data()):a(null),i("idle")}catch(b){l(b instanceof Error?b.message:"Error al cargar ejercicios"),i("error")}})()},[u,s]);const h=async g=>{if(!u)return;i("saving"),l(null);const v=pe(s),j=ue(ne,"exercises",`${u.uid}_${v}`);try{const b=(r==null?void 0:r.exercises)||[];b.push(g);const N=m(b),C={userId:u.uid,date:v,exercises:b,summary:N,createdAt:(r==null?void 0:r.createdAt)||Be(),updatedAt:Be()};await et(j,C),a(C),i("idle")}catch(b){l(b instanceof Error?b.message:"Error al guardar ejercicio"),i("error")}},x=async(g,v)=>{if(!(!u||!r)){i("saving"),l(null);try{const j=pe(s),b=ue(ne,"exercises",`${u.uid}_${j}`),N=[...r.exercises];N[g]={...N[g],...v};const C=m(N),S={...r,exercises:N,summary:C,updatedAt:Be()};await et(b,S),a(S),i("idle")}catch(j){l(j instanceof Error?j.message:"Error al actualizar ejercicio"),i("error")}}},p=async g=>{if(!(!u||!r)){i("saving"),l(null);try{const v=pe(s),j=ue(ne,"exercises",`${u.uid}_${v}`),b=r.exercises.filter((N,C)=>C!==g);if(b.length===0)await fr(j),a(null);else{const N=m(b),C={...r,exercises:b,summary:N,updatedAt:Be()};await et(j,C),a(C)}i("idle")}catch(v){l(v instanceof Error?v.message:"Error al eliminar ejercicio"),i("error")}}};return{exerciseLogs:(r==null?void 0:r.exercises)||[],summary:r==null?void 0:r.summary,status:o,error:d,logExercise:h,updateExerciseLog:x,deleteExerciseLog:p}},s4=({exerciseLogs:s,onUpdate:r,onDelete:a,isLoading:o})=>{if(o)return e.jsx("div",{className:"text-center py-8",children:"Cargando ejercicios..."});if(s.length===0)return e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay ejercicios registrados para este día"});const i=u=>{if(!kn.find(x=>x.id===u.exerciseId))return"";const h=[];return u.sets&&u.reps&&h.push(`${u.sets} series x ${u.reps} repeticiones`),u.duration&&h.push(`${u.duration} minutos`),u.distance&&h.push(`${(u.distance/1e3).toFixed(2)} km`),u.steps&&h.push(`${u.steps.toLocaleString()} pasos`),u.weight&&h.push(`${u.weight}kg`),h.join(" • ")},d=u=>{const m=kn.find(h=>h.id===u.exerciseId);return m?m.defaultDuration&&u.duration?u.duration/m.defaultDuration*100:m.defaultDistance&&u.distance?u.distance/m.defaultDistance*100:m.defaultSets&&m.defaultReps&&u.sets&&u.reps?u.sets*u.reps/(m.defaultSets*m.defaultReps)*100:100:0},l=()=>{const u=s.reduce((x,p)=>x+(p.calories||0),0),m=s.reduce((x,p)=>x+(p.steps||0),0),h=s.reduce((x,p)=>x+(p.duration||0),0);return u===0&&m===0?null:e.jsx(se,{className:"mb-6",children:e.jsxs(ae,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Resumen del día"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gr,{className:"w-4 h-4 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:u}),e.jsx("p",{className:"text-xs text-gray-500",children:"calorías"})]})]}),m>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gh,{className:"w-4 h-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:m.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"pasos"})]})]}),h>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:h}),e.jsx("p",{className:"text-xs text-gray-500",children:"minutos"})]})})]})]})})};return e.jsxs("div",{className:"space-y-4",children:[l(),s.map((u,m)=>{const h=kn.find(x=>x.id===u.exerciseId);return h?e.jsx(se,{children:e.jsxs(ae,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:h.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:h.name}),e.jsx("p",{className:"text-sm text-gray-500",children:i(u)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>r(m),children:e.jsx(iS,{className:"w-4 h-4"})}),e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>a(m),children:e.jsx(oo,{className:"w-4 h-4 text-red-500"})})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"flex justify-between text-sm",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded-full ${e4[h.category]} text-white`,children:h.category}),u.calories&&e.jsxs("span",{className:"flex items-center gap-1 text-orange-500",children:[e.jsx(Gr,{className:"w-4 h-4"}),u.calories," kcal"]})]})}),e.jsx(kt,{value:d(u),className:"h-2"}),u.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:u.notes})]})]})},m):null})]})},th=({isOpen:s,onClose:r,onSubmit:a,initialData:o})=>{var v,j,b,N,C,S,_;const[i,d]=Q.useState(o?kn.find(A=>A.id===o.exerciseId):null),[l,u]=Q.useState({sets:((v=o==null?void 0:o.sets)==null?void 0:v.toString())||"",reps:((j=o==null?void 0:o.reps)==null?void 0:j.toString())||"",weight:((b=o==null?void 0:o.weight)==null?void 0:b.toString())||"",duration:((N=o==null?void 0:o.duration)==null?void 0:N.toString())||"",distance:((C=o==null?void 0:o.distance)==null?void 0:C.toString())||"",steps:((S=o==null?void 0:o.steps)==null?void 0:S.toString())||"",calories:((_=o==null?void 0:o.calories)==null?void 0:_.toString())||"",notes:(o==null?void 0:o.notes)||""}),[m,h]=Q.useState(0);f.useEffect(()=>{if(x(),i!=null&&i.stepsPerKm&&l.distance){const A=parseFloat(l.distance),k=Math.round(A*i.stepsPerKm);u(D=>({...D,steps:k.toString()}))}},[l.distance,l.duration,l.weight,i]);const x=()=>{if(!(i!=null&&i.caloriesPerHour))return;let A=parseInt(l.duration)||0;!A&&l.sets&&l.reps&&(A=parseInt(l.sets)*parseInt(l.reps)*3/60);let k=i.caloriesPerHour*A/60;if(l.weight&&i.category==="strength"){const P=parseInt(l.weight)/5;k*=1+P*.1}const D=Math.round(k);h(D),u(P=>({...P,calories:D.toString()}))},p=A=>{var k,D,P;d(A),u({sets:((k=A.defaultSets)==null?void 0:k.toString())||"",reps:((D=A.defaultReps)==null?void 0:D.toString())||"",weight:"",duration:((P=A.defaultDuration)==null?void 0:P.toString())||"",distance:A.defaultDistance?(A.defaultDistance/1e3).toString():"",steps:"",calories:"",notes:""})},g=A=>{if(A.preventDefault(),!i)return;const k={exerciseId:i.id,calories:l.calories?parseInt(l.calories):m,...l.sets&&{sets:parseInt(l.sets)},...l.reps&&{reps:parseInt(l.reps)},...l.weight&&{weight:parseFloat(l.weight)},...l.duration&&{duration:parseInt(l.duration)},...l.distance&&{distance:parseFloat(l.distance)*1e3},...l.steps&&{steps:parseInt(l.steps)},...l.notes&&{notes:l.notes}};a(k),r()};return e.jsx(st,{open:s,onOpenChange:r,children:e.jsxs(Ke,{className:"sm:max-w-[700px] max-h-[90vh] sm:h-auto overflow-y-auto",children:[e.jsx(Je,{className:"sticky top-0 bg-background z-10 pb-4 mb-4 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(Xe,{className:"flex items-center gap-2 text-xl",children:[i&&!o&&e.jsx(F,{type:"button",variant:"ghost",size:"icon",onClick:()=>d(null),className:"h-8 w-8",children:e.jsx(lS,{className:"h-5 w-5"})}),o?"Editar ejercicio":"Agregar ejercicio"]})})}),e.jsx("form",{onSubmit:g,className:"space-y-6 pt-2",children:i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("span",{className:"text-3xl",children:i.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-lg",children:i.name}),e.jsx("p",{className:"text-sm text-gray-500",children:i.description})]})]}),i.category==="strength"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{htmlFor:"sets",children:"Series"}),e.jsx(ke,{id:"sets",type:"number",min:"1",value:l.sets,onChange:A=>u(k=>({...k,sets:A.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{htmlFor:"reps",children:"Repeticiones"}),e.jsx(ke,{id:"reps",type:"number",min:"1",value:l.reps,onChange:A=>u(k=>({...k,reps:A.target.value}))})]}),i.name==="Pesas de mano"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{htmlFor:"weight",children:"Peso (kg)"}),e.jsx(ke,{id:"weight",type:"number",min:"0",step:"0.5",value:l.weight,onChange:A=>u(k=>({...k,weight:A.target.value}))})]})]}),(i.category==="cardio"||i.category==="flexibility")&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{htmlFor:"duration",children:"Duración (min)"}),e.jsx(ke,{id:"duration",type:"number",min:"1",value:l.duration,onChange:A=>u(k=>({...k,duration:A.target.value}))})]}),i.category==="cardio"&&i.name!=="Natación"&&i.name!=="Tenis"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{htmlFor:"distance",children:"Distancia (km)"}),e.jsx(ke,{id:"distance",type:"number",min:"0",step:"0.1",value:l.distance,onChange:A=>u(k=>({...k,distance:A.target.value}))})]})]}),i.stepsPerKm&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(He,{htmlFor:"steps",children:["Pasos ",l.steps&&`(calculado: ${l.steps})`]}),e.jsx(ke,{id:"steps",type:"number",min:"0",value:l.steps,onChange:A=>u(k=>({...k,steps:A.target.value})),placeholder:"Número de pasos"})]}),m>0&&e.jsx("div",{className:"p-4 bg-muted rounded-md",children:e.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:["Calorías estimadas: ",m," kcal"]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{htmlFor:"calories",children:"Calorías"}),e.jsx(ke,{id:"calories",type:"number",min:"0",value:l.calories,onChange:A=>u(k=>({...k,calories:A.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(He,{htmlFor:"notes",children:"Notas"}),e.jsx(Ue,{id:"notes",value:l.notes,onChange:A=>u(k=>({...k,notes:A.target.value})),placeholder:"Añade notas sobre el ejercicio..."})]}),e.jsxs(os,{className:"gap-3 sm:gap-0",children:[e.jsx(F,{type:"button",variant:"outline",className:"flex-1 sm:flex-none",onClick:r,children:"Cancelar"}),e.jsx(F,{type:"submit",className:"flex-1 sm:flex-none",children:o?"Actualizar":"Guardar"})]})]}):e.jsxs(ra,{defaultValue:"cardio",className:"w-full",children:[e.jsx($s,{className:"w-full h-12 grid grid-cols-3 mb-4",children:Object.entries(Kc).map(([A,k])=>e.jsxs(nt,{value:A,className:"flex items-center gap-2 text-base p-3",children:[e.jsx("span",{className:"text-xl",children:k.icon}),e.jsx("span",{children:k.name})]},A))}),Object.entries(Kc).map(([A])=>e.jsx(rt,{value:A,className:"mt-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:kn.filter(k=>k.category===A).map(k=>e.jsxs(F,{type:"button",variant:"outline",className:"flex flex-col items-center p-6 h-auto gap-3",onClick:()=>p(k),children:[e.jsx("span",{className:"text-3xl",children:k.icon}),e.jsx("span",{className:"text-sm font-normal text-center",children:k.name})]},k.id))})},A))]})})]})})},a4=({exerciseLogs:s,summary:r})=>{const a=Q.useMemo(()=>r||{totalCalories:s.reduce((l,u)=>l+(u.calories||0),0),totalSteps:s.reduce((l,u)=>l+(u.steps||0),0),totalDuration:s.reduce((l,u)=>l+(u.duration||0),0),totalDistance:s.reduce((l,u)=>l+(u.distance||0),0),categoryStats:s.reduce((l,u)=>{const m=kn.find(h=>h.id===u.exerciseId);return m&&(l[m.category]||(l[m.category]={count:0,duration:0,calories:0}),l[m.category].count+=1,l[m.category].duration+=u.duration||0,l[m.category].calories+=u.calories||0),l},{})},[s,r]),o=l=>new Date(l).toLocaleDateString("es-ES",{month:"short",day:"numeric"}),i=(l,u)=>typeof l=="string"?new Date(l).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):[l.toLocaleString(),u],d=Q.useMemo(()=>{const l=new Date,u=[];for(let m=6;m>=0;m--){const h=new Date(l);h.setDate(h.getDate()-m);const x=pe(h);u.push({date:x,calories:0,steps:0,duration:0,distance:0})}return s.forEach(m=>{const h=u.find(x=>x.date===pe(new Date));h&&(h.calories+=m.calories||0,h.steps+=m.steps||0,h.duration+=m.duration||0,h.distance+=(m.distance||0)/1e3)}),u},[s]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(se,{children:e.jsxs(ae,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(Gr,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Calorías"}),e.jsx("h4",{className:"text-2xl font-bold",children:a.totalCalories})]})]})}),e.jsx(se,{children:e.jsxs(ae,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(Gh,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pasos"}),e.jsx("h4",{className:"text-2xl font-bold",children:a.totalSteps.toLocaleString()})]})]})}),e.jsx(se,{children:e.jsxs(ae,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(ro,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo"}),e.jsxs("h4",{className:"text-2xl font-bold",children:[a.totalDuration," min"]})]})]})}),e.jsx(se,{children:e.jsxs(ae,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(cS,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Distancia"}),e.jsxs("h4",{className:"text-2xl font-bold",children:[(a.totalDistance/1e3).toFixed(1)," km"]})]})]})})]}),e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Progreso"})}),e.jsx(ae,{children:e.jsxs(ra,{defaultValue:"calories",children:[e.jsxs($s,{className:"grid grid-cols-4 h-12",children:[e.jsx(nt,{value:"calories",className:"text-base",children:"Calorías"}),e.jsx(nt,{value:"steps",className:"text-base",children:"Pasos"}),e.jsx(nt,{value:"duration",className:"text-base",children:"Tiempo"}),e.jsx(nt,{value:"distance",className:"text-base",children:"Distancia"})]}),e.jsx(rt,{value:"calories",className:"h-[300px] pt-4",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Pa,{data:d,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"date",tickFormatter:o}),e.jsx(as,{}),e.jsx(bt,{formatter:i,labelFormatter:o}),e.jsx(ka,{}),e.jsx(Ms,{type:"monotone",dataKey:"calories",stroke:"#f97316",name:"Calorías",dot:!0})]})})}),e.jsx(rt,{value:"steps",className:"h-[300px] pt-4",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Pa,{data:d,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"date",tickFormatter:o}),e.jsx(as,{}),e.jsx(bt,{formatter:i,labelFormatter:o}),e.jsx(ka,{}),e.jsx(Ms,{type:"monotone",dataKey:"steps",stroke:"#3b82f6",name:"Pasos",dot:!0})]})})}),e.jsx(rt,{value:"duration",className:"h-[300px] pt-4",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Pa,{data:d,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"date",tickFormatter:o}),e.jsx(as,{}),e.jsx(bt,{formatter:i,labelFormatter:o}),e.jsx(ka,{}),e.jsx(Ms,{type:"monotone",dataKey:"duration",stroke:"#22c55e",name:"Minutos",dot:!0})]})})}),e.jsx(rt,{value:"distance",className:"h-[300px] pt-4",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Pa,{data:d,children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"date",tickFormatter:o}),e.jsx(as,{}),e.jsx(bt,{formatter:i,labelFormatter:o}),e.jsx(ka,{}),e.jsx(Ms,{type:"monotone",dataKey:"distance",stroke:"#a855f7",name:"Kilómetros",dot:!0})]})})})]})})]}),e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Resumen por categoría"})}),e.jsx(ae,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs($i,{data:Object.entries(Kc).map(([l,u])=>{const m=a.categoryStats[l]||{count:0,duration:0,calories:0};return{category:u.name,minutos:m.duration,calorias:m.calories}}),children:[e.jsx(ha,{strokeDasharray:"3 3"}),e.jsx(gs,{dataKey:"category"}),e.jsx(as,{yAxisId:"left",orientation:"left",stroke:"#f97316"}),e.jsx(as,{yAxisId:"right",orientation:"right",stroke:"#22c55e"}),e.jsx(bt,{}),e.jsx(ka,{}),e.jsx(Kr,{yAxisId:"left",dataKey:"calorias",fill:"#f97316",name:"Calorías"}),e.jsx(Kr,{yAxisId:"right",dataKey:"minutos",fill:"#22c55e",name:"Minutos"})]})})})})]})]})},n4=(s,r)=>{const[a,o]=f.useState(null),[i,d]=f.useState(!0),[l,u]=f.useState(null),{user:m}=Se();return f.useEffect(()=>{(async()=>{if(o(null),!!m){d(!0),u(null);try{const x=[],p=new Date(s);for(;p<=r;)x.push(pe(p)),p.setDate(p.getDate()+1);const v=(await Promise.all(x.map(j=>Ot(ue(ne,"exercises",`${m.uid}_${j}`))))).map((j,b)=>{var N;return{date:x[b],calories:j.exists()&&((N=j.data().summary)==null?void 0:N.totalCalories)||0}});o({dailyStats:v})}catch(x){console.error("Error al cargar estadísticas:",x),u(x instanceof Error?x.message:"Error al cargar estadísticas")}finally{d(!1)}}})()},[m,s,r]),{stats:a,loading:i,error:l}},r4=({selectedDate:s,goal:r=500})=>{const[a,o]=f.useState(Qe(s));f.useEffect(()=>{o(Qe(s))},[s]);const i=f.useMemo(()=>Qe(a),[a]),d=f.useMemo(()=>vs(a),[a]),{stats:l,loading:u}=n4(i,d),m=f.useMemo(()=>{const x={};return l==null||l.dailyStats.forEach(({date:p,calories:g})=>{x[p]=g}),x},[l]),h=x=>{const p=pe(x.date),g=m[p]||0,v=Math.min(g/r,1),j=28,b=3,N=(j-b)/2,C=2*Math.PI*N,S=C-v*C,_=g>=r;return e.jsxs("div",{className:"relative flex items-center justify-center w-7 h-7",children:[e.jsxs("svg",{width:j,height:j,className:"absolute",children:[e.jsx("circle",{cx:j/2,cy:j/2,r:N,stroke:_?"#fed7aa":"#e5e7eb",strokeWidth:b,fill:"none"}),e.jsx("circle",{cx:j/2,cy:j/2,r:N,stroke:_?"#f97316":"#9ca3af",strokeWidth:b,fill:"none",strokeDasharray:C,strokeDashoffset:S,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),e.jsx("span",{className:"text-[10px] font-medium z-10",children:x.date.getDate()})]})};return e.jsxs(se,{className:"w-full",children:[e.jsxs(Oe,{className:"flex flex-col items-center gap-2",children:[e.jsx(Gr,{className:"w-5 h-5 text-orange-600"}),e.jsx(Pe,{className:"text-center",children:"Historial Mensual"})]}),e.jsxs(ae,{className:"relative p-4",children:[u&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 z-10",children:e.jsx(Wt,{className:"w-6 h-6 animate-spin"})}),e.jsx(Gi,{month:a,onMonthChange:o,showOutsideDays:!0,components:{DayContent:h},className:"p-0 w-full"})]})]})},lg=f.forwardRef(({selectedDate:s},r)=>{const{user:a}=Se(),{exerciseLogs:o,summary:i,status:d,error:l,logExercise:u,updateExerciseLog:m,deleteExerciseLog:h}=t4(s),[x,p]=f.useState(!1),[g,v]=f.useState(null);return f.useImperativeHandle(r,()=>({openAddExercise:()=>p(!0)})),a?e.jsx(se,{className:"w-full",children:e.jsxs(ae,{className:"p-6",children:[e.jsxs(ra,{defaultValue:"list",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs($s,{children:[e.jsx(nt,{value:"list",children:"Lista"}),e.jsxs(nt,{value:"stats",className:"gap-2",children:[e.jsx(Ih,{className:"w-4 h-4"}),"Estadísticas"]})]}),e.jsxs(F,{onClick:()=>p(!0),className:"gap-2 hidden sm:flex",children:[e.jsx(ys,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Agregar"})]})]}),e.jsx(rt,{value:"list",className:"m-0",children:e.jsx(s4,{exerciseLogs:o,onUpdate:v,onDelete:h,isLoading:d==="loading"})}),e.jsx(rt,{value:"stats",className:"m-0",children:e.jsx(a4,{exerciseLogs:o,summary:i})})]}),l&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:l}),e.jsx(th,{isOpen:x,onClose:()=>p(!1),onSubmit:u,selectedDate:s}),g!==null&&e.jsx(th,{isOpen:!0,onClose:()=>v(null),onSubmit:j=>{m(g,j),v(null)},initialData:o[g],selectedDate:s})]})}):e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tus ejercicios"})})})});lg.displayName="Exercise";const o4=()=>{const[s,r]=f.useState(new Date),{user:a}=Se(),o=f.useRef(null),i=()=>{var d;(d=o.current)==null||d.openAddExercise()};return a?e.jsxs(Et,{showFloatingButton:!0,onFloatingButtonClick:i,floatingButtonLabel:"Agregar ejercicio",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Registro de Ejercicio"}),e.jsx("p",{className:"text-gray-500",children:"Registra y monitorea tus actividades físicas diarias"})]}),e.jsx(xa,{selectedDate:s,onChange:r}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[1fr_300px]",children:[e.jsx(lg,{ref:o,selectedDate:s}),e.jsx(r4,{selectedDate:s})]})]}):e.jsx("div",{className:"container max-w-4xl mx-auto py-6",children:e.jsx(se,{children:e.jsxs(ae,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Inicia sesión"}),e.jsx("p",{className:"text-gray-500",children:"Necesitas iniciar sesión para registrar y ver tus ejercicios"})]})})})},Rd=(s,r)=>ue(ne,"negative-habits",`${s}_${r}`),i4=async(s,r,a,o,i,d)=>{const l={habitId:o,timestamp:new Date().getTime(),...d?{note:d}:{}},m={...i[a]||{},[o]:l},h={userId:s,yearMonth:r,habits:{...i,[a]:m},updatedAt:Be()},x=Rd(s,r);await et(x,h,{merge:!0})},l4=async(s,r,a,o,i)=>{const d={...i[a]||{}};delete d[o];const l={userId:s,yearMonth:r,habits:{...i,[a]:d},updatedAt:Be()},u=Rd(s,r);await et(u,l,{merge:!0})},c4=async(s,r)=>{const a={},o=tt(ne,"negative-habits");for(const i of r)try{(await on(ns(o,Ge("userId","==",s),Ge("yearMonth","==",i)))).forEach(l=>{const u=l.data();a[i]=u.habits||{}})}catch(d){console.error(`Error fetching month ${i}:`,d)}return a},Id=s=>{const r={totalCount:0,byHabitId:{},byDate:{}};return Object.entries(s).forEach(([a])=>{const[o,i]=a.split("_"),d=parseInt(o);r.totalCount++,r.byHabitId[d]=(r.byHabitId[d]||0)+1,r.byDate[i]=(r.byDate[i]||0)+1}),r},d4=(s,r=5)=>{const a=Id(s);return Object.entries(a.byHabitId).sort(([,o],[,i])=>i-o).slice(0,r).map(([o,i])=>({habitId:parseInt(o),count:i}))},u4=(s,r=3)=>{const a=Id(s);return Object.entries(a.byDate).sort(([,o],[,i])=>i-o).slice(0,r).map(([o,i])=>({date:o,count:i}))},m4=s=>{const r=[],a=new Date(s),o=a.getDay(),i=o===0?-6:1-o;a.setDate(a.getDate()+i);for(let d=0;d<7;d++){const l=new Date(a);l.setDate(a.getDate()+d),r.push({dayName:l.toLocaleDateString("es-ES",{weekday:"short"}),fullDate:pe(l)})}return r},f4=s=>{const r=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0");return`${r}-${a}`},h4=s=>{const r=s.getFullYear(),a=s.getMonth()+1,o=[];for(let i=1;i<=a;i++){const d=String(i).padStart(2,"0");o.push(`${r}-${d}`)}return o},p4=()=>{const[s,r]=f.useState({}),[a,o]=f.useState("idle"),[i,d]=f.useState(null),{user:l}=Se(),u=f.useMemo(()=>{const p={};return Object.values(s).forEach(g=>{Object.entries(g).forEach(([v,j])=>{Object.entries(j).forEach(([b,N])=>{p[`${b}_${v}`]=N})})}),p},[s]),m=f.useMemo(()=>({...Id(u),topHabits:d4(u),frequentDays:u4(u)}),[u,s]);return f.useEffect(()=>{if(!l)return;const p=new Date,g=f4(p);o("loading");const v=ht(Rd(l.uid,g),b=>{if(b.exists()){const N=b.data();r(C=>({...C,[g]:N.habits||{}}))}o("idle")},b=>{d(b instanceof Error?b.message:"Error al cargar los datos"),o("error")});return(async()=>{const b=h4(p),N=await c4(l.uid,b);r(C=>({...C,...N}))})(),()=>v()},[l]),{habits:u,status:a,error:i,stats:m,logHabit:async(p,g,v)=>{if(l)try{o("saving"),d(null);const[j,b]=g.split("-"),N=`${j}-${b}`,C=s[N]||{};await i4(l.uid,N,g,p,C,v),o("idle")}catch(j){d(j instanceof Error?j.message:"Error al guardar"),o("error")}},removeLog:async(p,g)=>{if(l)try{o("saving"),d(null);const[v,j]=g.split("-"),b=`${v}-${j}`,N=s[b]||{};await l4(l.uid,b,g,p,N),o("idle")}catch(v){d(v instanceof Error?v.message:"Error al eliminar"),o("error")}}}},x4=({view:s,onViewChange:r})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:s==="weekly"?"default":"outline",size:"sm",onClick:()=>r("weekly"),className:"gap-2",children:[e.jsx(pr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Semanal"})]}),e.jsxs(F,{variant:s==="yearly"?"default":"outline",size:"sm",onClick:()=>r("yearly"),className:"gap-2",children:[e.jsx(qh,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Anual"})]})]}),sh=({habits:s,completedHabits:r,weekDays:a,onLogHabit:o,onRemoveLog:i,disabled:d})=>e.jsx(An,{children:e.jsxs("div",{className:"grid grid-cols-[minmax(100px,1fr)_repeat(7,minmax(32px,1fr))] gap-1",children:[e.jsx("div",{}),a.map(l=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:l.dayName}),e.jsx("div",{className:"text-[10px] text-gray-400",children:l.fullDate.split("-").slice(1).join("/")})]},l.fullDate)),s.map(l=>e.jsxs(Q.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:l.icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:l.name}),e.jsx("span",{className:"text-xs text-gray-500",children:l.category})]})]}),a.map(u=>{const m=`${l.id}_${u.fullDate}`,h=r[m];return e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs(ln,{children:[e.jsx(cn,{asChild:!0,children:e.jsx(F,{variant:h?"destructive":"outline",size:"icon",className:"w-8 h-8 p-0",onClick:()=>h?i(l.id,u.fullDate):o(l.id,u.fullDate),disabled:d,children:h?e.jsx(Rs,{className:"w-4 h-4 text-white"}):e.jsx(ki,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsx(Ma,{children:h?"Eliminar registro":"Registrar hábito"})]})},m)})]},l.id))]})}),ir={health:{icon:"🏥",label:"Salud",description:"Hábitos que afectan tu salud física"},productivity:{icon:"⏰",label:"Productividad",description:"Hábitos que reducen tu eficiencia"},social:{icon:"👥",label:"Social",description:"Hábitos que afectan tus relaciones"},emotional:{icon:"😔",label:"Emocional",description:"Hábitos que afectan tu bienestar emocional"},finance:{icon:"💰",label:"Finanzas",description:"Hábitos que impactan tus finanzas"},digital:{icon:"📱",label:"Digital",description:"Hábitos digitales nocivos"},environment:{icon:"🌍",label:"Ambiente",description:"Hábitos que impactan al medio ambiente"}},rn=[{id:1,name:"Saltarse comidas",icon:"🍽️",category:"health"},{id:2,name:"Dormir poco",icon:"😴",category:"health"},{id:3,name:"No hacer ejercicio",icon:"🏃",category:"health"},{id:4,name:"Comer en exceso",icon:"🫃🏻",category:"health"},{id:25,name:"Comida chatarra",icon:"🍔",category:"health"},{id:26,name:"Exceso de azúcar",icon:"🍭",category:"health"},{id:27,name:"Masturbación",icon:"🍆",category:"health"},{id:5,name:"Procrastinar",icon:"⏰",category:"productivity"},{id:6,name:"Distracciones",icon:"🎯",category:"productivity"},{id:7,name:"Multitarea",icon:"🔄",category:"productivity"},{id:8,name:"Desorganización",icon:"📋",category:"productivity"},{id:24,name:"Exceso de trabajo (Workaholic)",icon:"🍽️",category:"productivity"},{id:9,name:"Aislamiento",icon:"🚶",category:"social"},{id:10,name:"Conflictos",icon:"💢",category:"social"},{id:11,name:"No escuchar",icon:"👂",category:"social"},{id:29,name:"Dejar en visto",icon:"👀",category:"social"},{id:15,name:"Sobrepensar cosas",icon:"😰",category:"emotional"},{id:16,name:"Negatividad / Pesimismo",icon:"🌧️",category:"emotional"},{id:17,name:"Ser grosero/estresarme",icon:"🤬",category:"emotional"},{id:28,name:"Celos compulsivos",icon:"💁🏻‍♂️",category:"emotional"},{id:12,name:"Gastos impulsivos",icon:"💳",category:"finance"},{id:13,name:"No ahorrar",icon:"💰",category:"finance"},{id:14,name:"Más Deudas",icon:"📉",category:"finance"},{id:18,name:"Exceso de Redes sociales",icon:"📱",category:"digital"},{id:19,name:"Exceso de Videojuegos",icon:"🎮",category:"digital"},{id:20,name:"Exceso de Netflix",icon:"🎬",category:"digital"},{id:21,name:"Desperdiciar agua",icon:"💧",category:"environment"},{id:22,name:"No reciclar",icon:"♻️",category:"environment"},{id:23,name:"Consumo excesivo",icon:"🛍️",category:"environment"}],g4=({habits:s,onLogHabit:r,onRemoveLog:a,disabled:o})=>{const i=m4(new Date),[d,l]=f.useState(""),[u,m]=f.useState(["health"]),[h,x]=f.useState(!1),p=f.useMemo(()=>{const b={};return rn.forEach(N=>{b[N.category]||(b[N.category]=[]),!(d&&!N.name.toLowerCase().includes(d.toLowerCase()))&&b[N.category].push(N)}),b},[d]),g=f.useMemo(()=>{const b=rn.length,N=Object.values(p).reduce((_,A)=>_+A.length,0),C={},S=new Date().toISOString().split("T")[0];return Object.entries(s).forEach(([_])=>{const[A,k]=_.split("_");if(k===S){const D=rn.find(P=>P.id===Number(A));D&&(C[D.category]=(C[D.category]||0)+1)}}),{totalHabits:b,filteredHabits:N,loggedByCategory:C,isFiltered:d.length>0}},[p,s,d]),v=f.useMemo(()=>{const b=new Map;return Object.entries(s).forEach(([N])=>{const[C]=N.split("_"),S=b.get(Number(C))||0;b.set(Number(C),S+1)}),rn.filter(N=>b.has(N.id)).sort((N,C)=>(b.get(C.id)||0)-(b.get(N.id)||0)).slice(0,5)},[s]),j=b=>{m(N=>N.includes(b)?N.filter(C=>C!==b):[...N,b])};return e.jsxs("div",{className:"space-y-4",children:["      ",e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(Ii,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(ke,{placeholder:"Buscar hábito...",value:d,onChange:b=>l(b.target.value),className:"pl-8 pr-16"}),g.isFiltered&&e.jsxs("div",{className:"absolute right-2 top-2 bg-blue-100 text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium",children:[g.filteredHabits,"/",g.totalHabits]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(F,{variant:"outline",onClick:()=>x(!h),className:"flex-1 sm:flex-none",children:h?"Mostrar más frecuentes":"Mostrar todos"}),Object.keys(g.loggedByCategory).length>0&&e.jsxs("div",{className:"bg-green-100 text-green-800 px-3 py-1.5 rounded-md text-sm font-medium",children:[Object.values(g.loggedByCategory).reduce((b,N)=>b+N,0)," hoy"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"sm:min-w-[640px]",children:h?e.jsx("div",{className:"space-y-6",children:Object.entries(p).map(([b,N])=>{if(N.length===0)return null;const C=u.includes(b),S=ir[b];return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{variant:"ghost",onClick:()=>j(b),className:"w-full flex items-center justify-between p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:S.icon}),e.jsx("span",{className:"font-medium",children:S.label}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",N.length,")"]}),g.loggedByCategory[b]&&e.jsxs("span",{className:"bg-red-100 text-red-800 px-2 py-0.5 rounded-full text-xs font-medium ml-1",children:[g.loggedByCategory[b]," hoy"]})]}),C?e.jsx(ga,{size:20}):e.jsx(Mn,{size:20})]}),C&&e.jsx(sh,{habits:N,completedHabits:s,weekDays:i,onLogHabit:r,onRemoveLog:a,disabled:o})]},b)})}):e.jsx(sh,{habits:v,completedHabits:s,weekDays:i,onLogHabit:r,onRemoveLog:a,disabled:o})})}),"      ",e.jsxs(xr,{variant:"destructive",children:[" ",e.jsx(gr,{children:h?`Visualización completa de hábitos agrupados por categoría${g.isFiltered?` (${g.filteredHabits} de ${g.totalHabits} hábitos mostrados)`:""}. Usa el buscador para encontrar hábitos específicos.`:`Mostrando solo tus ${v.length} hábitos más frecuentes. Haz clic en "Mostrar todos" para ver la lista completa.`})]})]})},ah=({habits:s,completedHabits:r,onLogHabit:a,onRemoveLog:o})=>{const i=new Date().getFullYear();return e.jsx(An,{children:e.jsx("div",{className:"space-y-6",children:s.map(d=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sticky top-0 bg-white z-10 py-2",children:[e.jsx("span",{className:"text-xl",children:d.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:d.name}),e.jsx("p",{className:"text-sm text-gray-500",children:d.category})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(ng,{year:i,renderCell:l=>{const u=`${d.id}_${l}`,m=r[u],h=new Date().toISOString().split("T")[0]===l;return e.jsxs(ln,{children:[e.jsx(cn,{asChild:!0,children:e.jsx(F,{variant:m?"destructive":"ghost",onClick:()=>m?o(d.id,l):a(d.id,l),className:Z("w-1 h-1 p-0 rounded-full border transition-all duration-200 hover:scale-110",m?"bg-red-600 border-red-700 hover:bg-red-700":"bg-gray-100 border-gray-200 hover:bg-gray-200 hover:border-gray-300",h&&"ring-2 ring-blue-400 ring-offset-1"),"aria-label":m?"Eliminar registro":"Registrar hábito"})}),e.jsx(Ma,{children:e.jsx("p",{className:"text-sm",children:new Date(l).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})})]},l)}})})]},d.id))})})},v4=({habits:s,onLogHabit:r,onRemoveLog:a})=>{const[o,i]=f.useState(""),[d,l]=f.useState("all"),[u,m]=f.useState(["health"]),[h,x]=f.useState(!1),p=f.useMemo(()=>{const j=new Map;return Object.entries(s).forEach(([b])=>{const[N]=b.split("_"),C=j.get(Number(N))||0;j.set(Number(N),C+1)}),rn.filter(b=>j.has(b.id)).sort((b,N)=>(j.get(N.id)||0)-(j.get(b.id)||0)).slice(0,5)},[s]),g=f.useMemo(()=>{const j={};return rn.forEach(b=>{o&&!b.name.toLowerCase().includes(o.toLowerCase())||d!=="all"&&b.category!==d||(j[b.category]||(j[b.category]=[]),j[b.category].push(b))}),j},[o,d]),v=j=>{m(b=>b.includes(j)?b.filter(N=>N!==j):[...b,j])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ii,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(ke,{placeholder:"Buscar hábito...",value:o,onChange:j=>i(j.target.value),className:"pl-8"})]}),e.jsxs(Le,{value:d,onValueChange:l,children:[e.jsx(Re,{className:"w-full sm:w-[180px]",children:e.jsx(ze,{placeholder:"Categoría"})}),e.jsxs(Ie,{children:[e.jsx(le,{value:"all",children:"Todas las categorías"}),Object.keys(ir).map(j=>e.jsx(le,{value:j,children:ir[j].label},j))]})]}),e.jsx(F,{variant:"outline",onClick:()=>x(!h),className:"whitespace-nowrap",children:h?"Ver frecuentes":"Ver todos"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"sm:min-w-[800px] pb-4",children:h?e.jsx("div",{className:"space-y-8",children:Object.entries(g).map(([j,b])=>{if(b.length===0)return null;const N=u.includes(j),C=ir[j];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(F,{variant:"ghost",onClick:()=>v(j),className:"w-full flex items-center justify-between p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:C.icon}),e.jsx("span",{className:"font-medium",children:C.label}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",b.length,")"]})]}),N?e.jsx(ga,{size:20}):e.jsx(Mn,{size:20})]}),N&&e.jsx(ah,{habits:b,completedHabits:s,onLogHabit:r,onRemoveLog:a})]},j)})}):e.jsx(ah,{habits:p,completedHabits:s,onLogHabit:r,onRemoveLog:a})})}),e.jsxs(xr,{variant:"destructive",children:[" ",e.jsx(gr,{children:h?"Vista completa de hábitos por categoría. Usa los filtros para encontrar hábitos específicos.":'Mostrando tus hábitos más frecuentes. Cambia a "Ver todos" para la lista completa.'})]})]})},y4=({category:s,habits:r,onSelectHabit:a})=>{const o=ir[s];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:o.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:o.label}),e.jsx("p",{className:"text-sm text-gray-500",children:o.description})]})]}),e.jsx(hd,{className:"h-[300px] pr-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:r.map(i=>e.jsxs(F,{variant:"outline",className:"h-auto py-3 px-2 flex flex-col items-center gap-2 group",onClick:()=>a(i.id),children:[e.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:i.icon}),e.jsx("span",{className:"text-xs text-center line-clamp-2",children:i.name})]},i.id))})})]})},j4=({onSelectHabit:s})=>{const[r,a]=f.useState("health"),o=rn.reduce((i,d)=>(i[d.category]||(i[d.category]=[]),i[d.category].push(d),i),{});return e.jsx("div",{className:"w-full",children:e.jsxs(ra,{defaultValue:r,onValueChange:i=>a(i),className:"w-full",children:[e.jsx($s,{className:"grid grid-cols-4 gap-2 h-auto sm:grid-cols-7",children:Object.entries(ir).map(([i,{icon:d,label:l}])=>e.jsxs(nt,{value:i,className:"text-sm flex flex-col gap-1 py-2 h-auto",children:[e.jsx("span",{className:"text-xl",children:d}),e.jsx("span",{className:"hidden sm:inline text-xs",children:l})]},i))}),Object.entries(o).map(([i,d])=>e.jsx(rt,{value:i,className:"mt-4",children:e.jsx(y4,{category:i,habits:d,onSelectHabit:s})},i))]})})},b4=({isOpen:s,onClose:r,onLogHabit:a,selectedDate:o})=>e.jsx(st,{open:s,onOpenChange:r,children:e.jsxs(Ke,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Registrar Hábito Negativo"}),e.jsx("p",{className:"text-sm text-gray-500",children:id(o)})]}),e.jsx("div",{className:"flex-1 overflow-hidden py-4",children:e.jsx(j4,{onSelectHabit:a})})]})}),Xs=Ls("negativeHabit"),N4=Xs?`https://generativelanguage.googleapis.com/v1beta/models/${Xs.model}:generateContent`:"",w4=({habits:s,open:r,onOpenChange:a})=>{var D,P;const[o,i]=f.useState(!1),d=r!==void 0?r:o,l=a??i,[u,m]=f.useState(""),[h,x]=f.useState(""),[p,g]=f.useState(!1),[v,j]=f.useState(0),b="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",N=((D=Xs==null?void 0:Xs.prompts)==null?void 0:D.impact)??"Explica el impacto de mis hábitos negativos de acuerdo con mis registros.",C=((P=Xs==null?void 0:Xs.prompts)==null?void 0:P.action)??"Recomienda acciones para reducirlos cada vez que los registro.",S=Xs==null?void 0:Xs.params;f.useEffect(()=>{if(d){const M=_();x(`${N}
${C}
${M}`)}else x(""),m("")},[d,s]),f.useEffect(()=>{j(oa(h))},[h]);const _=()=>{const M={};let $=null,W=null;Object.keys(s).forEach(H=>{const[U,ee]=H.split("_"),re=parseInt(U,10);M[re]=(M[re]||0)+1,(!$||ee<$)&&($=ee),(!W||ee>W)&&(W=ee)});const I=$&&W?`Datos del ${$} al ${W}`:"Sin registros",B=rn.map(H=>`- ${H.name}: ${M[H.id]||0}`).join(`
`);return`${I}
${B}`},A=async()=>{var M,$,W,I,B;g(!0);try{const U=await(await fetch(`${N4}?key=${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:h}]}],...S})})).json(),ee=(B=(I=(W=($=(M=U==null?void 0:U.candidates)==null?void 0:M[0])==null?void 0:$.content)==null?void 0:W.parts)==null?void 0:I[0])==null?void 0:B.text;m(ee||"No se pudo obtener sugerencia")}catch{m("Error al consultar la API")}finally{g(!1)}},k=()=>{l(!1),m(""),x(""),j(0)};return e.jsxs(st,{open:d,onOpenChange:M=>M?l(!0):k(),children:[r===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>l(!0),className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4"}),"Analizar hábitos"]}),e.jsxs(Ke,{className:"w-full sm:max-w-5xl max-h-[90vh] overflow-auto",children:[e.jsxs(Je,{children:[e.jsx(Xe,{children:"Sugerencias sobre hábitos negativos"}),e.jsx(na,{children:"Impacto y acciones recomendadas."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ue,{value:h,onChange:M=>x(M.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",v," ",v>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:A,disabled:p||!b,className:"w-full flex items-center justify-center gap-2",children:[p&&e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),p?"Consultando...":"Obtener sugerencia"]}),u&&e.jsx("div",{className:"p-4 bg-muted rounded-md prose max-w-none",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:On.sanitize(u)}})})]})]})]})},S4=({habits:s})=>{const[r,a]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(vr,{children:[e.jsx(yr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(rs,{className:"w-4 h-4"}),"IA"]})}),e.jsx(Ln,{align:"end",children:e.jsx($a,{onSelect:()=>a(!0),children:"Analizar hábitos"})})]}),e.jsx(w4,{habits:s,open:r,onOpenChange:a})]})},C4=()=>{const[s,r]=f.useState("weekly"),[a,o]=f.useState(new Date),[i,d]=f.useState(!1),{user:l}=Se(),{habits:u,status:m,error:h,logHabit:x,removeLog:p}=p4(),g=async(v,j)=>{await x(v,pe(a),j),d(!1)};return l?e.jsxs(Et,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Hábitos Negativos"}),e.jsx("p",{className:"text-gray-500",children:"Identifica y reduce comportamientos que quieres cambiar"})]}),e.jsx(xa,{selectedDate:a,onChange:o}),e.jsx(se,{className:"w-full",children:e.jsxs(ae,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Registro de Hábitos"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Identifica y registra los hábitos que deseas cambiar"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S4,{habits:u}),e.jsx(x4,{view:s,onViewChange:r})]})]}),s==="weekly"?e.jsx(g4,{habits:u,onLogHabit:x,onRemoveLog:p,disabled:m==="saving"}):e.jsx(v4,{habits:u,onLogHabit:x,onRemoveLog:p}),h&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:h})]})}),e.jsx(b4,{isOpen:i,onClose:()=>d(!1),onLogHabit:g,selectedDate:a})]}):e.jsx(Et,{children:e.jsx(se,{className:"w-full",children:e.jsx(ae,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tus hábitos negativos"})})})})},$d=({data:s,className:r})=>e.jsx("div",{className:Z("h-24",r),children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Pa,{data:s,margin:{left:-20,right:10},children:[e.jsx(gs,{dataKey:"label",tick:{fontSize:10}}),e.jsx(as,{domain:[0,10],tick:{fontSize:10}}),e.jsx(bt,{}),e.jsx(Ms,{type:"monotone",dataKey:"value",stroke:"#f59e0b"})]})})}),E4=(s,r)=>{const a=un.length,o=s!=null&&s.habits?Object.entries(s.habits).filter(([u,m])=>u.endsWith(`_${r}`)&&m).map(([u])=>{const m=parseInt(u.split("_")[0]);return un.find(h=>h.id===m)}).filter(Boolean):[],i=o.length,d=un.filter(u=>!o.some(m=>(m==null?void 0:m.id)===u.id)),l=["morning","afternoon","night","anytime"].map(u=>{const m=d.filter(h=>h.timeOfDay===u);return{timeOfDay:u,habits:m.map(h=>({id:h.id,name:h.name,icon:h.icon,goal:h.goal}))}}).filter(u=>u.habits.length>0);return{completed:i,total:a,incompletedByTimeOfDay:l}},D4=s=>{if(!(s!=null&&s.drinks)||!Array.isArray(s.drinks))return[];const r=new Map;return s.drinks.forEach(a=>{const o=a.type,i=a.amount||0;if(r.has(o)){const d=r.get(o);r.set(o,{amount:d.amount+i,count:d.count+1})}else r.set(o,{amount:i,count:1})}),Array.from(r.entries()).map(([a,o])=>({type:a,amount:o.amount,count:o.count})).sort((a,o)=>o.amount-a.amount)},T4=s=>{if(!(s!=null&&s.moods)||!Array.isArray(s.moods))return{count:0,average:0,highest:0,lowest:0,details:[]};const r=s.moods,a=r.length;if(a===0)return{count:0,average:0,highest:0,lowest:0,details:[]};const o=DT(r),i=r.map(m=>m.value??Ti(m.text)),d=Math.max(...i),l=Math.min(...i),u=r.map(m=>({emoji:m.emoji,text:m.text,value:m.value??Ti(m.text),time:m.time}));return{count:a,average:o,highest:d,lowest:l,details:u}},_4=async(s,r)=>{const a=pe(r),[o,i]=a.split("-");console.log("🔧 Testing Firestore permissions for:",s,a);const d=[{name:"journal",id:`${s}_${a}`},{name:"moods",id:`${s}_${a}`},{name:"water",id:`${s}_${a}`},{name:"exercises",id:`${s}_${a}`},{name:"pomodoro",id:`${s}_${a}`},{name:"habits",id:`${s}_${o}-${i}`},{name:"negative-habits",id:`${s}_${o}-${i}`}];for(const l of d)try{console.log(`🔍 Testing collection: ${l.name} with ID: ${l.id}`);const u=await Ot(ue(ne,l.name,l.id));console.log(`✅ ${l.name}: Success - exists: ${u.exists()}`)}catch(u){console.error(`❌ ${l.name}: Error -`,u)}try{console.log("🔍 Testing tasks collection with query");const l=_n.fromDate(yt(r)),u=_n.fromDate(Zs(r)),m=ns(tt(ne,"tasks"),Ge("userId","==",s),Ge("completed","==",!0),Ge("updatedAt",">=",l),Ge("updatedAt","<=",u)),h=await on(m);console.log(`✅ tasks (completed today): Success - found ${h.size} documents`);const x=ns(tt(ne,"tasks"),Ge("userId","==",s),Ge("dueDate",">=",l),Ge("dueDate","<=",u)),p=await on(x);console.log(`✅ tasks (due today): Success - found ${p.size} documents`);const g=ns(tt(ne,"tasks"),Ge("userId","==",s),Ge("completed","==",!1)),v=await on(g);console.log(`✅ tasks (incomplete): Success - found ${v.size} documents`)}catch(l){console.error("❌ tasks: Error -",l)}},A4={journal:{words:0},mood:{count:0,average:0,highest:0,lowest:0,details:[]},habits:{completed:0,total:un.length,incompletedByTimeOfDay:[]},negativeHabits:{count:0},exercise:{minutes:0},tasks:{completed:0,todayPlanned:0,pending:0,overdue:0},pomodoro:{count:0,expectedMinutes:0,workMinutes:0,completionRate:0,averageSessionLength:0},water:{intake:0,drinkDetails:[]}},cg=(s,r,a)=>{const o=pe(r),[i,d]=o.split("-"),l=_n.fromDate(yt(r)),u=_n.fromDate(Zs(r));console.log("🔍 createDayListeners - uid:",s),console.log("🔍 createDayListeners - date:",r),console.log("🔍 createDayListeners - dateStr:",o);const m=ue(ne,"journal",`${s}_${o}`),h=ue(ne,"moods",`${s}_${o}`),x=ue(ne,"water",`${s}_${o}`),p=ue(ne,"exercises",`${s}_${o}`),g=ue(ne,"pomodoro",`${s}_${o}`),v=ue(ne,"habits",`${s}_${i}-${d}`),j=ue(ne,"negative-habits",`${s}_${i}-${d}`);console.log("🔍 Pomodoro document ID will be:",`${s}_${o}`);let b=null,N=null,C=null,S=null,_=null,A=null,k=null,D=[],P=[],M=[];const $=()=>{const U=k4(r,o,b,N,C,S,_,A,k,D,P,M);a(U)},W=[];W.push(ht(m,U=>{b=U.exists()?U.data():null,$()},U=>console.error("❌ Journal listener error:",U))),W.push(ht(h,U=>{N=U.exists()?U.data():null,$()},U=>console.error("❌ Mood listener error:",U))),W.push(ht(x,U=>{C=U.exists()?U.data():null,$()},U=>console.error("❌ Water listener error:",U))),W.push(ht(p,U=>{S=U.exists()?U.data():null,$()},U=>console.error("❌ Exercise listener error:",U))),W.push(ht(g,U=>{var ee;if(console.log("🔍 Pomodoro listener - Document ID:",U.id),console.log("🔍 Pomodoro listener - Document exists:",U.exists()),console.log("🔍 Pomodoro listener - Full document data:",U.data()),_=U.exists()?U.data():null,console.log("🍅 Pomodoro listener - processed data:",_),_){if(console.log("🍅 Pomodoro listener - keys:",Object.keys(_)),console.log("🍅 Pomodoro listener - count:",_.count),console.log("🍅 Pomodoro listener - sessions:",((ee=_.sessions)==null?void 0:ee.length)||0,"sessions"),console.log("🍅 Pomodoro listener - sessions data:",_.sessions),_.sessions){const re=_.sessions.reduce((J,te)=>J+(te.duration||0),0);console.log("🍅 Pomodoro listener - total duration (seconds):",re,"minutes:",Math.round(re/60))}}else console.log("❌ Pomodoro listener - No data found for document");$()},U=>console.error("❌ Pomodoro listener error:",U))),W.push(ht(v,U=>{A=U.exists()?U.data():null,$()},U=>console.error("❌ Habit listener error:",U))),W.push(ht(j,U=>{k=U.exists()?U.data():null,$()},U=>console.error("❌ Negative habit listener error:",U)));const I=ns(tt(ne,"tasks"),Ge("userId","==",s),Ge("completed","==",!0),Ge("updatedAt",">=",l),Ge("updatedAt","<=",u));W.push(ht(I,U=>{D=U.docs.map(ee=>({id:ee.id,...ee.data()})),$()},U=>console.error("❌ Task listener error (completed today):",U)));const B=ns(tt(ne,"tasks"),Ge("userId","==",s),Ge("dueDate",">=",l),Ge("dueDate","<=",u));W.push(ht(B,U=>{P=U.docs.map(ee=>({id:ee.id,...ee.data()})),$()},U=>console.error("❌ Task listener error (due today):",U)));const H=ns(tt(ne,"tasks"),Ge("userId","==",s),Ge("completed","==",!1));return W.push(ht(H,U=>{M=U.docs.map(ee=>({id:ee.id,...ee.data()})),$()},U=>console.error("❌ Task listener error (incomplete):",U))),W},k4=(s,r,a,o,i,d,l,u,m,h,x,p)=>{var b,N;const g=yt(s);let v=0,j=0;return p.forEach(C=>{C.dueDate&&typeof C.dueDate.toDate=="function"&&yt(C.dueDate.toDate())<g?j++:v++}),{journal:{words:a!=null&&a.text?a.text.split(/\s+/).filter(Boolean).length:0},mood:T4(o),water:{intake:(i==null?void 0:i.totalWater)||0,drinkDetails:D4(i)},exercise:{minutes:((b=d==null?void 0:d.summary)==null?void 0:b.totalDuration)||0},pomodoro:(()=>{var M;const C=l;console.log("🍅 Pomodoro data for",r,":",C);const S=(C==null?void 0:C.count)||0;let _=0;C!=null&&C.sessions&&Array.isArray(C.sessions)&&(_=C.sessions.reduce(($,W)=>{const I=W.duration?Math.round(W.duration/60):0;return console.log("🍅 Session duration:",W.duration,"seconds =",I,"minutes"),$+I},0)),console.log("🍅 Pomodoro extracted - count:",S,"workMinutes:",_),console.log("🍅 Sessions found:",((M=C==null?void 0:C.sessions)==null?void 0:M.length)||0),console.log("🍅 Available keys in data:",C?Object.keys(C):"no data");const A=300,k=Math.min(100,_/A*100),D=S>0?_/S:0,P={count:S,expectedMinutes:A,workMinutes:_,completionRate:parseFloat(k.toFixed(1)),averageSessionLength:parseFloat(D.toFixed(1))};return console.log("🍅 Final pomodoro result:",P),P})(),habits:E4(u,r),negativeHabits:{count:(N=m==null?void 0:m.habits)!=null&&N[r]?Object.keys(m.habits[r]).length:0},tasks:{completed:h.length,todayPlanned:x.length,pending:v,overdue:j}}},Ld=s=>{const{user:r}=Se(),[a,o]=f.useState(A4),[i,d]=f.useState(!0);return f.useEffect(()=>{if(!r){console.log("❌ useDailySummary - No user authenticated"),d(!1);return}console.log("🚀 useDailySummary - Setting up listeners for user:",r.uid,"date:",s),d(!0),_4(r.uid,s);const u=h=>{o(h),d(!1)},m=cg(r.uid,s,u);return()=>{console.log("🧹 Cleaning up listeners"),m.forEach(h=>h())}},[r,s]),{summary:a,loading:i,refetch:()=>{console.log("🔄 Refetch requested - listeners will automatically update")}}};function dg({className:s,...r}){return e.jsx("div",{className:Z("animate-pulse rounded-md bg-muted",s),...r})}const O4=({date:s})=>{const{summary:r,loading:a,refetch:o}=Ld(s),i=u=>{var m;return((m=Jt[u])==null?void 0:m.name)||u},d=r.mood.details?r.mood.details.map(u=>({label:u.time,value:u.value})):[],l=Object.values(r).some(u=>Object.values(u).some(m=>typeof m=="number"&&m>0));return e.jsxs(se,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between",children:[e.jsx(Pe,{children:"Resumen Diario"}),e.jsx(F,{size:"sm",variant:"outline",onClick:o,disabled:a,children:"Recalcular"})]}),e.jsxs(ae,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Palabras Diario"}),e.jsx("p",{className:"font-bold",children:r.journal.words})]}),"          ",e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hábitos"}),e.jsxs("p",{className:"font-bold",children:[r.habits.completed,"/",r.habits.total]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(r.habits.completed/r.habits.total*100).toFixed(0),"% completado"]})]}),"          ",e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Ánimos"}),e.jsx("p",{className:"font-bold",children:r.mood.count}),r.mood.count>0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("div",{children:["Promedio: ",r.mood.average,"/10"]}),e.jsxs("div",{children:["Rango: ",r.mood.lowest,"-",r.mood.highest]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Min Ejercicio"}),e.jsx("p",{className:"font-bold",children:r.exercise.minutes})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hidratación (ml)"}),e.jsx("p",{className:"font-bold",children:r.water.intake}),r.water.drinkDetails&&r.water.drinkDetails.length>0&&e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["                ",r.water.drinkDetails.slice(0,2).map(u=>e.jsxs("div",{children:[i(u.type),": ",u.amount,"ml (",u.count,"x)"]},u.type)),r.water.drinkDetails.length>2&&e.jsxs("div",{children:["+",r.water.drinkDetails.length-2," más"]})]})]})]}),e.jsx("div",{className:"h-32",children:a?e.jsx(dg,{className:"w-full h-full"}):d.length>0&&e.jsx($d,{data:d,className:"h-full"})}),!a&&r.water.drinkDetails&&r.water.drinkDetails.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2 text-muted-foreground",children:"Detalle de Bebidas"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:["              ",r.water.drinkDetails.map(u=>e.jsxs("div",{className:"flex justify-between p-2 rounded bg-muted/50",children:[e.jsx("span",{className:"font-medium",children:i(u.type)}),e.jsxs("span",{children:[u.amount,"ml (",u.count,"x)"]})]},u.type))]})]}),!a&&r.habits.incompletedByTimeOfDay&&r.habits.incompletedByTimeOfDay.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-2 text-muted-foreground",children:"Hábitos Pendientes por Momento"}),e.jsx("div",{className:"space-y-3",children:r.habits.incompletedByTimeOfDay.map(u=>e.jsxs("div",{className:"border rounded p-2",children:[e.jsx("h5",{className:"text-xs font-medium mb-1 capitalize text-gray-600",children:u.timeOfDay==="morning"?"Mañana":u.timeOfDay==="afternoon"?"Tarde":u.timeOfDay==="night"?"Noche":"Cualquier momento"}),e.jsx("div",{className:"grid grid-cols-1 gap-1",children:u.habits.map(m=>e.jsxs("div",{className:"flex items-center gap-2 text-xs bg-red-50 p-1 rounded",children:[e.jsx("span",{children:m.icon}),e.jsx("span",{className:"flex-1",children:m.name}),e.jsx("span",{className:"text-gray-500 text-[10px]",children:m.goal})]},m.id))})]},u.timeOfDay))})]}),!a&&!l&&e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"No hay datos registrados para este día."}),r.mood.details&&r.mood.details.length>0&&e.jsxs("div",{className:"border rounded p-3",children:[e.jsx("h4",{className:"text-sm font-medium mb-2 text-muted-foreground",children:"Estados de Ánimo del Día"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:r.mood.details.map((u,m)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs bg-blue-50 p-2 rounded",children:[e.jsx("span",{className:"text-lg",children:u.emoji}),e.jsx("span",{className:"flex-1",children:u.text}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[u.value,"/10"]}),e.jsx("span",{className:"text-gray-500 text-[10px]",children:u.time})]},m))}),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground text-center",children:["Promedio del día: ",r.mood.average,"/10"]})]})]})]})},Oc={journal:{words:0},mood:{count:0,average:0,highest:0,lowest:0},habits:{completed:0,total:18,incompletedByTimeOfDay:[]},negativeHabits:{count:0},exercise:{minutes:0},tasks:{completed:0,todayPlanned:0,pending:0,overdue:0},pomodoro:{count:0,expectedMinutes:0,workMinutes:0,completionRate:0,averageSessionLength:0},water:{intake:0,drinkDetails:[]}},zd=s=>{const{user:r}=Se(),[a,o]=f.useState({daily:[],totals:{...Oc}}),[i,d]=f.useState(!0);return f.useEffect(()=>{if(!r){console.log("❌ useWeeklySummary - No user authenticated"),d(!1);return}console.log("🚀 useWeeklySummary - Setting up listeners for user:",r.uid,"start date:",s),d(!0);const u=[];for(let p=0;p<7;p++){const g=new Date(s);g.setDate(s.getDate()+p),u.push(g)}const m={},h=()=>{const p=[],g={...Oc};u.forEach(j=>{const b=pe(j),N=m[b]||{...Oc};p.push({date:b,summary:N}),g.journal.words+=N.journal.words,g.mood.count+=N.mood.count,g.habits.completed+=N.habits.completed,g.negativeHabits.count+=N.negativeHabits.count,g.exercise.minutes+=N.exercise.minutes,g.water.intake+=N.water.intake,g.tasks.completed+=N.tasks.completed,g.tasks.todayPlanned+=N.tasks.todayPlanned,g.tasks.pending+=N.tasks.pending,g.tasks.overdue+=N.tasks.overdue,g.pomodoro.count+=N.pomodoro.count,g.pomodoro.workMinutes+=N.pomodoro.workMinutes});const v=300*7;g.pomodoro.expectedMinutes=v,g.pomodoro.completionRate=Math.min(100,g.pomodoro.workMinutes/v*100),g.pomodoro.averageSessionLength=g.pomodoro.count>0?g.pomodoro.workMinutes/g.pomodoro.count:0,g.pomodoro.completionRate=parseFloat(g.pomodoro.completionRate.toFixed(1)),g.pomodoro.averageSessionLength=parseFloat(g.pomodoro.averageSessionLength.toFixed(1)),console.log("📊 Updated weekly summary:",{daily:p.length,totals:g}),o({daily:p,totals:g}),d(!1)},x=[];return u.forEach(p=>{const g=pe(p),v=b=>{m[g]=b,h()},j=cg(r.uid,p,v);x.push(...j)}),()=>{console.log("🧹 Cleaning up weekly listeners"),x.forEach(p=>p())}},[r,s]),{summary:a,loading:i,refetch:()=>{console.log("🔄 Weekly refetch requested - listeners will automatically update")}}},P4=({startDate:s})=>{const{summary:r,loading:a,refetch:o}=zd(s),i=r.daily.map(l=>({date:l.date.slice(5),pomodoros:l.summary.pomodoro.count,tasks:l.summary.tasks.completed,habits:l.summary.habits.completed})),d=r.daily.some(l=>Object.values(l.summary).some(u=>Object.values(u).some(m=>typeof m=="number"&&m>0)));return e.jsxs(se,{children:[e.jsxs(Oe,{className:"flex flex-row items-center justify-between",children:[e.jsx(Pe,{children:"Resumen Semanal"}),e.jsx(F,{size:"sm",variant:"outline",onClick:o,disabled:a,children:"Recalcular"})]}),e.jsxs(ae,{className:"space-y-4",children:[e.jsx("div",{className:"h-64",children:a?e.jsx(dg,{className:"w-full h-full"}):e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Pa,{data:i,children:[e.jsx(gs,{dataKey:"date"}),e.jsx(as,{}),e.jsx(bt,{}),e.jsx(Ms,{dataKey:"pomodoros",stroke:"#3b82f6",name:"Pomodoros"}),e.jsx(Ms,{dataKey:"tasks",stroke:"#10b981",name:"Tareas"}),e.jsx(Ms,{dataKey:"habits",stroke:"#a855f7",name:"Hábitos"})]})})}),!a&&!d&&e.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"No hay datos registrados para esta semana."})]})]})},nh=s=>s&&"daily"in s&&"totals"in s,rh=({data:s,date:r})=>{const[a,o]=f.useState(!1),[i,d]=f.useState(""),[l,u]=f.useState(!1),m="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",h=Ls("statistics"),x=h!=null&&h.model?`https://generativelanguage.googleapis.com/v1beta/models/${h.model}:generateContent`:"",p=(h==null?void 0:h.prompt)??"Analiza mis registros y dame consejos.",g=h==null?void 0:h.params,v=s?nh(s)?`Fecha: ${r}
Datos semanales:
${JSON.stringify(s.totals,null,2)}

Detalle diario:
${JSON.stringify(s.daily,null,2)}`:`Fecha: ${r}
Datos diarios:
${JSON.stringify(s,null,2)}`:`Fecha: ${r}
No hay datos disponibles.`,j=!s,b=`${p}

${v}`,N=async()=>{var S,_,A,k,D;if(!x||!s)return;o(!0);const C={contents:[{parts:[{text:b}]}],...g};console.log("🤖 AI Analysis Request:",{date:r,dataType:nh(s)?"weekly":"daily",dataKeys:s?Object.keys(s):[],promptLength:b.length,requestBody:C});try{const M=await(await fetch(`${x}?key=${m}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)})).json();console.log("🤖 AI Response:",M);const $=((D=(k=(A=(_=(S=M==null?void 0:M.candidates)==null?void 0:S[0])==null?void 0:_.content)==null?void 0:A.parts)==null?void 0:k[0])==null?void 0:D.text)||"";$?(d($),console.log("🤖 Analysis generated successfully")):(console.warn("🤖 No text in AI response:",M),d("No se pudo generar análisis"))}catch(P){console.error("🤖 API Error:",P),d("Error al consultar la API")}finally{o(!1)}};return e.jsxs(se,{children:[e.jsx(Oe,{children:e.jsx(Pe,{children:"Asistente IA"})}),"      ",e.jsxs(ae,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(F,{onClick:N,disabled:a||!m||j,className:"flex items-center gap-2",children:[a&&e.jsx(Wt,{className:"w-4 h-4 animate-spin"}),a?"Analizando...":"Analizar"]}),e.jsx(F,{variant:"outline",size:"sm",onClick:()=>u(!l),children:l?"Ocultar Debug":"Mostrar Debug"})]}),l&&e.jsxs("div",{className:"bg-gray-100 p-3 rounded text-xs space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Config:"})," ",h?"Encontrado":"No encontrado"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Model:"})," ",(h==null?void 0:h.model)||"N/A"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"API Key:"})," ",`${m.substring(0,10)}...`]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Params:"})," ",JSON.stringify(g,null,2)]}),e.jsx("div",{children:e.jsx("strong",{children:"Prompt base:"})}),e.jsx("div",{className:"bg-white p-2 rounded max-h-32 overflow-y-auto",children:p}),e.jsx("div",{children:e.jsx("strong",{children:"Summary data:"})}),e.jsx("div",{className:"bg-white p-2 rounded max-h-32 overflow-y-auto",children:v||"Vacío"}),e.jsx("div",{children:e.jsx("strong",{children:"Prompt completo:"})}),e.jsx("div",{className:"bg-white p-2 rounded max-h-32 overflow-y-auto",children:b})]}),i&&e.jsx("div",{className:"text-sm whitespace-pre-wrap",children:i}),!i&&j&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Registra datos para generar un análisis."})]})]})},M4=({date:s})=>{const{summary:r}=Ld(s),a=r.habits.total?r.habits.completed/r.habits.total*100:0,o=r.water.intake/2e3*100,i=r.pomodoro.completionRate,d=(a+o+i)/3,l=[{name:"Completadas",value:r.tasks.completed},{name:"Pendientes",value:r.tasks.pending+r.tasks.overdue}],u=["#10b981","#f97316"],m=r.mood.details?r.mood.details.map(h=>({label:h.time,value:h.value})):[];return e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-6",children:[e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-purple-500 text-white",children:e.jsx(Kh,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Score General"})]}),e.jsxs(ae,{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-center",children:[d.toFixed(0),"%"]}),e.jsx(kt,{value:d,className:"h-2"})]})]}),e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-green-600 text-white",children:e.jsx(ad,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Hábitos"})]}),e.jsxs(ae,{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-center",children:[r.habits.completed,"/",r.habits.total]}),e.jsx(kt,{value:a,className:"h-2"})]})]}),e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-blue-600 text-white",children:e.jsx(no,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Hidratación"})]}),e.jsxs(ae,{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-center",children:[r.water.intake,"ml"]}),e.jsx(kt,{value:Math.min(o,100),className:"h-2"})]})]}),e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-red-600 text-white",children:e.jsx(ro,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Pomodoros"})]}),e.jsxs(ae,{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-center",children:[r.pomodoro.workMinutes," / ",r.pomodoro.expectedMinutes," min"]}),e.jsx(kt,{value:i,className:"h-2"})]})]}),e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-orange-500 text-white",children:e.jsx(Jh,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Tareas"})]}),e.jsx(ae,{className:"p-2",children:e.jsx("div",{className:"h-20",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Rn,{children:[e.jsx(In,{data:l,dataKey:"value",nameKey:"name",innerRadius:20,outerRadius:40,children:l.map((h,x)=>e.jsx($n,{fill:u[x%u.length]},`cell-${x}`))}),e.jsx(bt,{})]})})})})]}),m.length>0&&e.jsxs(se,{className:"p-2 col-span-full sm:col-auto",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-yellow-600 text-white",children:e.jsx(Ai,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Ánimo"})]}),e.jsx(ae,{className:"p-2",children:e.jsx($d,{data:m})})]})]})},R4=({startDate:s})=>{const{summary:r}=zd(s),a=r.daily.length||1,o=r.totals.habits.completed/(a*r.totals.habits.total)*100,i=r.totals.water.intake/(2e3*a)*100,d=r.totals.pomodoro.completionRate,l=(o+i+d)/3,u=[{name:"Completadas",value:r.totals.tasks.completed},{name:"Pendientes",value:r.totals.tasks.pending+r.totals.tasks.overdue}],m=["#10b981","#f97316"],h=r.daily.map(x=>({label:x.date.slice(5),value:x.summary.mood.average}));return e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-6",children:[e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-purple-500 text-white",children:e.jsx(Kh,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Score General"})]}),e.jsxs(ae,{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-center",children:[l.toFixed(0),"%"]}),e.jsx(kt,{value:l,className:"h-2"})]})]}),e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-green-600 text-white",children:e.jsx(ad,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Hábitos"})]}),e.jsxs(ae,{className:"p-2 space-y-1",children:[e.jsx("div",{className:"text-xl font-bold text-center",children:r.totals.habits.completed}),e.jsx(kt,{value:o,className:"h-2"})]})]}),e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-blue-600 text-white",children:e.jsx(no,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Hidratación"})]}),e.jsxs(ae,{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-center",children:[r.totals.water.intake,"ml"]}),e.jsx(kt,{value:Math.min(i,100),className:"h-2"})]})]}),e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-red-600 text-white",children:e.jsx(ro,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Pomodoros"})]}),e.jsxs(ae,{className:"p-2 space-y-1",children:[e.jsxs("div",{className:"text-xl font-bold text-center",children:[r.totals.pomodoro.workMinutes," / ",r.totals.pomodoro.expectedMinutes," min"]}),e.jsx(kt,{value:d,className:"h-2"})]})]}),e.jsxs(se,{className:"p-2",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-orange-500 text-white",children:e.jsx(Jh,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Tareas"})]}),e.jsx(ae,{className:"p-2",children:e.jsx("div",{className:"h-20",children:e.jsx(jt,{width:"100%",height:"100%",children:e.jsxs(Rn,{children:[e.jsx(In,{data:u,dataKey:"value",nameKey:"name",innerRadius:20,outerRadius:40,children:u.map((x,p)=>e.jsx($n,{fill:m[p%m.length]},`cell-${p}`))}),e.jsx(bt,{})]})})})})]}),h.length>0&&e.jsxs(se,{className:"p-2 col-span-full sm:col-auto",children:[e.jsxs(Oe,{className:"flex items-center gap-2 p-2 pb-1",children:[e.jsx("span",{className:"p-1 rounded bg-yellow-600 text-white",children:e.jsx(Ai,{className:"w-4 h-4"})}),e.jsx(Pe,{className:"text-sm",children:"Ánimo"})]}),e.jsx(ae,{className:"p-2",children:e.jsx($d,{data:h})})]})]})},oh=s=>vt(s,"PP",{locale:Qs}),I4=()=>{const[s,r]=f.useState(new Date),[a,o]=f.useState(()=>{const l=new Date;return l.setDate(l.getDate()-l.getDay()),l}),{summary:i}=Ld(s),{summary:d}=zd(a);return e.jsxs(Et,{children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Estadísticas"})}),e.jsxs(ra,{defaultValue:"daily",className:"space-y-4",children:[e.jsxs($s,{children:[e.jsx(nt,{value:"daily",children:"Diario"}),e.jsx(nt,{value:"weekly",children:"Semanal"})]}),e.jsxs(rt,{value:"daily",className:"space-y-4",children:[e.jsx(xa,{selectedDate:s,onChange:r}),e.jsx(M4,{date:s}),e.jsx(O4,{date:s}),e.jsx(rh,{data:i,date:oh(s)})]}),e.jsxs(rt,{value:"weekly",className:"space-y-4",children:[e.jsx(xa,{selectedDate:a,onChange:o}),e.jsx(R4,{startDate:a}),e.jsx(P4,{startDate:a}),e.jsx(rh,{data:d,date:`Semana del ${oh(a)}`})]})]})]})};function $4(){return e.jsx(r1,{children:e.jsxs(Gt,{path:"/",element:e.jsx(TC,{}),children:[e.jsx(Gt,{index:!0,element:e.jsx(QA,{})}),e.jsx(Gt,{path:"habit",element:e.jsx(dA,{})}),e.jsx(Gt,{path:"task",element:e.jsx(tg,{})}),e.jsx(Gt,{path:"kanban",element:e.jsx(Z_,{})}),e.jsx(Gt,{path:"journal",element:e.jsx(X_,{})}),e.jsx(Gt,{path:"mood",element:e.jsx(e_,{})}),e.jsx(Gt,{path:"water",element:e.jsx(SD,{})}),e.jsx(Gt,{path:"pomodoro",element:e.jsx(ET,{})}),e.jsx(Gt,{path:"exercise",element:e.jsx(o4,{})}),e.jsx(Gt,{path:"negative",element:e.jsx(C4,{})}),e.jsx(Gt,{path:"stats",element:e.jsx(I4,{})}),e.jsx(Gt,{path:"meal",element:e.jsx(AA,{})}),e.jsx(Gt,{path:"shopping-list",element:e.jsx(HA,{})}),e.jsx(Gt,{path:"recipes",element:e.jsx(VA,{})})]})})}fS({onNeedRefresh(){window.dispatchEvent(new CustomEvent("sw-update-available"))},onOfflineReady(){console.log("La aplicación está lista para usar sin conexión"),window.dispatchEvent(new CustomEvent("sw-offline-ready"))},immediate:!0});Ic.createRoot(document.getElementById("root")).render(e.jsx(Q.StrictMode,{children:e.jsx(o1,{basename:"/life-tracker",children:e.jsx($4,{})})}));
