const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["chunks/DailySummary-bhlymI5q.js","chunks/ui-vendor-DliCpqNh.js","chunks/react-vendor-B6CgFIIW.js","chunks/firebase-DmRfnWpg.js","chunks/MoodChart-Q_hRnnlM.js","chunks/chart-vendor-DMSqDA8Y.js","chunks/utils-vendor-BAnGpuWR.js","chunks/skeleton-C4FgHUbX.js","chunks/WeeklySummary-CWvrPaoL.js","chunks/AiInsightCard-CrXGL7tN.js","chunks/DailyDashboard-D7a56Wt7.js","chunks/WeeklyDashboard-COkvA9id.js"])))=>i.map(i=>d[i]);
var QT=Object.defineProperty;var ek=(t,n,s)=>n in t?QT(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var Nt=(t,n,s)=>ek(t,typeof n!="symbol"?n+"":n,s);import{j as e,c as of,P as It,a as za,b as id,u as is,A as Nv,d as ot,e as zi,D as Sv,C as Cv,f as Ev,g as Fi,h as aa,R as Tv,O as al,i as il,k as od,T as ol,l as ll,m as lf,n as cf,o as df,I as tk,H as sk,p as kv,q as _v,r as nk,s as rk,t as Dv,W as ak,v as ik,w as rr,x as ok,y as lk,z as ck,F as dk,B as Zr,E as uk,G as cl,S as Av,J as Rv,K as mk,L as Pv,M as Iv,N as Ov,Q as Mv,U as Lv,V as $v,X as zv,Y as fk,Z as pk,_ as hk,$ as Fv,a0 as xk,a1 as gk,a2 as vk,a3 as yk,a4 as bk}from"../chunks/ui-vendor-DliCpqNh.js";import{a as uf,r as f,R as jk,c as ne,b as wk,d as No}from"../chunks/react-vendor-B6CgFIIW.js";import{c as Nk,a as Bi,b as Zu,d as So,e as Sk,f as Co,g as Pt,s as ys,h as Vt,i as ar,j as Yo,k as wr,l as Fo,m as Lo,n as Ck,o as Bs,p as ea,q as _t,r as wn,t as Ko,u as mf,v as os,w as Cm,x as Ek,y as Tk,z as kk,A as _k,B as Qu,C as Fx,D as Em,E as Dk,F as Ak,G as Bv,H as $n,I as ff,J as Cr,K as Rk,L as Pk,M as Wv,N as Ik,O as Ok,P as ni,Q as Bx,R as Wx}from"../chunks/utils-vendor-BAnGpuWR.js";import{i as Mk,g as Lk,c as $k,e as zk,o as Fk,G as Bk,s as Wk,d as Hk,f as be,h as ns,j as ht,k as lt,l as Uk,w as Vk,m as ds,n as $t,p as Wi,q as _r,r as un,t as ci,T as Bo,u as Jo,v as jn,x as Gk,y as qk}from"../chunks/firebase-DmRfnWpg.js";import{C as ia,L as Yk,D as pf,a as Kk,S as hf,b as Hv,B as ld,T as xf,U as Uv,c as Jk,K as Vv,d as gf,e as Xk,f as Zk,X as Js,g as Dr,h as Fn,W as Hx,i as cd,P as Ns,j as dd,k as Qk,l as vf,m as dl,n as Qt,o as Xo,p as Gv,q as Hi,r as qv,s as e_,t as Sr,u as t_,v as s_,w as yf,x as ud,I as La,y as md,z as Nn,A as Yv,E as Kv,F as Tm,M as Jv,G as Zo,H as n_,J as as,N as Ar,O as r_,Q as a_,R as i_,V as o_,Y as l_,Z as Oi,_ as c_,$ as Xv,a0 as Zv,a1 as d_,a2 as Qv,a3 as u_,a4 as m_,a5 as f_,a6 as fd,a7 as bf,a8 as Ux,a9 as zs,aa as ri,ab as br,ac as tr,ad as Mn,ae as Fs,af as Aa,ag as ul,ah as ml,ai as fl,aj as pd,ak as Qo,al as Qr,am as pl,an as p_,ao as h_,ap as x_,aq as g_,ar as Cc,as as Vx,at as v_,au as y_,av as Fa,aw as Ui,ax as Vi,ay as b_,az as j_,aA as w_,aB as N_,aC as S_,aD as e0,aE as C_,aF as E_,aG as T_}from"../chunks/chart-vendor-DMSqDA8Y.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();var km={},Gx=uf;km.createRoot=Gx.createRoot,km.hydrateRoot=Gx.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function el(){return el=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},el.apply(this,arguments)}var Ra;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ra||(Ra={}));const qx="popstate";function k_(t){t===void 0&&(t={});function n(r,i){let{pathname:o,search:c,hash:d}=r.location;return _m("",{pathname:o,search:c,hash:d},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(r,i){return typeof i=="string"?i:Wc(i)}return D_(n,s,null,t)}function us(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function t0(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function __(){return Math.random().toString(36).substr(2,8)}function Yx(t,n){return{usr:t.state,key:t.key,idx:n}}function _m(t,n,s,r){return s===void 0&&(s=null),el({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof n=="string"?Gi(n):n,{state:s,key:n&&n.key||r||__()})}function Wc(t){let{pathname:n="/",search:s="",hash:r=""}=t;return s&&s!=="?"&&(n+=s.charAt(0)==="?"?s:"?"+s),r&&r!=="#"&&(n+=r.charAt(0)==="#"?r:"#"+r),n}function Gi(t){let n={};if(t){let s=t.indexOf("#");s>=0&&(n.hash=t.substr(s),t=t.substr(0,s));let r=t.indexOf("?");r>=0&&(n.search=t.substr(r),t=t.substr(0,r)),t&&(n.pathname=t)}return n}function D_(t,n,s,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:o=!1}=r,c=i.history,d=Ra.Pop,u=null,m=p();m==null&&(m=0,c.replaceState(el({},c.state,{idx:m}),""));function p(){return(c.state||{idx:null}).idx}function x(){d=Ra.Pop;let y=p(),N=y==null?null:y-m;m=y,u&&u({action:d,location:b.location,delta:N})}function g(y,N){d=Ra.Push;let S=_m(b.location,y,N);m=p()+1;let E=Yx(S,m),T=b.createHref(S);try{c.pushState(E,"",T)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(T)}o&&u&&u({action:d,location:b.location,delta:1})}function v(y,N){d=Ra.Replace;let S=_m(b.location,y,N);m=p();let E=Yx(S,m),T=b.createHref(S);c.replaceState(E,"",T),o&&u&&u({action:d,location:b.location,delta:0})}function j(y){let N=i.location.origin!=="null"?i.location.origin:i.location.href,S=typeof y=="string"?y:Wc(y);return S=S.replace(/ $/,"%20"),us(N,"No window.location.(origin|href) available to create URL for href: "+S),new URL(S,N)}let b={get action(){return d},get location(){return t(i,c)},listen(y){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(qx,x),u=y,()=>{i.removeEventListener(qx,x),u=null}},createHref(y){return n(i,y)},createURL:j,encodeLocation(y){let N=j(y);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:g,replace:v,go(y){return c.go(y)}};return b}var Kx;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Kx||(Kx={}));function A_(t,n,s){return s===void 0&&(s="/"),R_(t,n,s,!1)}function R_(t,n,s,r){let i=typeof n=="string"?Gi(n):n,o=jf(i.pathname||"/",s);if(o==null)return null;let c=s0(t);P_(c);let d=null;for(let u=0;d==null&&u<c.length;++u){let m=U_(o);d=W_(c[u],m,r)}return d}function s0(t,n,s,r){n===void 0&&(n=[]),s===void 0&&(s=[]),r===void 0&&(r="");let i=(o,c,d)=>{let u={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};u.relativePath.startsWith("/")&&(us(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let m=Ia([r,u.relativePath]),p=s.concat(u);o.children&&o.children.length>0&&(us(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),s0(o.children,n,p,m)),!(o.path==null&&!o.index)&&n.push({path:m,score:F_(m,o.index),routesMeta:p})};return t.forEach((o,c)=>{var d;if(o.path===""||!((d=o.path)!=null&&d.includes("?")))i(o,c);else for(let u of n0(o.path))i(o,c,u)}),n}function n0(t){let n=t.split("/");if(n.length===0)return[];let[s,...r]=n,i=s.endsWith("?"),o=s.replace(/\?$/,"");if(r.length===0)return i?[o,""]:[o];let c=n0(r.join("/")),d=[];return d.push(...c.map(u=>u===""?o:[o,u].join("/"))),i&&d.push(...c),d.map(u=>t.startsWith("/")&&u===""?"/":u)}function P_(t){t.sort((n,s)=>n.score!==s.score?s.score-n.score:B_(n.routesMeta.map(r=>r.childrenIndex),s.routesMeta.map(r=>r.childrenIndex)))}const I_=/^:[\w-]+$/,O_=3,M_=2,L_=1,$_=10,z_=-2,Jx=t=>t==="*";function F_(t,n){let s=t.split("/"),r=s.length;return s.some(Jx)&&(r+=z_),n&&(r+=M_),s.filter(i=>!Jx(i)).reduce((i,o)=>i+(I_.test(o)?O_:o===""?L_:$_),r)}function B_(t,n){return t.length===n.length&&t.slice(0,-1).every((r,i)=>r===n[i])?t[t.length-1]-n[n.length-1]:0}function W_(t,n,s){let{routesMeta:r}=t,i={},o="/",c=[];for(let d=0;d<r.length;++d){let u=r[d],m=d===r.length-1,p=o==="/"?n:n.slice(o.length)||"/",x=Xx({path:u.relativePath,caseSensitive:u.caseSensitive,end:m},p),g=u.route;if(!x&&m&&s&&!r[r.length-1].route.index&&(x=Xx({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},p)),!x)return null;Object.assign(i,x.params),c.push({params:i,pathname:Ia([o,x.pathname]),pathnameBase:Y_(Ia([o,x.pathnameBase])),route:g}),x.pathnameBase!=="/"&&(o=Ia([o,x.pathnameBase]))}return c}function Xx(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,r]=H_(t.path,t.caseSensitive,t.end),i=n.match(s);if(!i)return null;let o=i[0],c=o.replace(/(.)\/+$/,"$1"),d=i.slice(1);return{params:r.reduce((m,p,x)=>{let{paramName:g,isOptional:v}=p;if(g==="*"){let b=d[x]||"";c=o.slice(0,o.length-b.length).replace(/(.)\/+$/,"$1")}const j=d[x];return v&&!j?m[g]=void 0:m[g]=(j||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:c,pattern:t}}function H_(t,n,s){n===void 0&&(n=!1),s===void 0&&(s=!0),t0(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,u)=>(r.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,n?void 0:"i"),r]}function U_(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return t0(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+n+").")),t}}function jf(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let s=n.endsWith("/")?n.length-1:n.length,r=t.charAt(s);return r&&r!=="/"?null:t.slice(s)||"/"}function V_(t,n){n===void 0&&(n="/");let{pathname:s,search:r="",hash:i=""}=typeof t=="string"?Gi(t):t;return{pathname:s?s.startsWith("/")?s:G_(s,n):n,search:K_(r),hash:J_(i)}}function G_(t,n){let s=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?s.length>1&&s.pop():i!=="."&&s.push(i)}),s.length>1?s.join("/"):"/"}function em(t,n,s,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+n+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function q_(t){return t.filter((n,s)=>s===0||n.route.path&&n.route.path.length>0)}function r0(t,n){let s=q_(t);return n?s.map((r,i)=>i===s.length-1?r.pathname:r.pathnameBase):s.map(r=>r.pathnameBase)}function a0(t,n,s,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Gi(t):(i=el({},t),us(!i.pathname||!i.pathname.includes("?"),em("?","pathname","search",i)),us(!i.pathname||!i.pathname.includes("#"),em("#","pathname","hash",i)),us(!i.search||!i.search.includes("#"),em("#","search","hash",i)));let o=t===""||i.pathname==="",c=o?"/":i.pathname,d;if(c==null)d=s;else{let x=n.length-1;if(!r&&c.startsWith("..")){let g=c.split("/");for(;g[0]==="..";)g.shift(),x-=1;i.pathname=g.join("/")}d=x>=0?n[x]:"/"}let u=V_(i,d),m=c&&c!=="/"&&c.endsWith("/"),p=(o||c===".")&&s.endsWith("/");return!u.pathname.endsWith("/")&&(m||p)&&(u.pathname+="/"),u}const Ia=t=>t.join("/").replace(/\/\/+/g,"/"),Y_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),K_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,J_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function X_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const i0=["post","put","patch","delete"];new Set(i0);const Z_=["get",...i0];new Set(Z_);/**
 * React Router v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tl(){return tl=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},tl.apply(this,arguments)}const wf=f.createContext(null),Q_=f.createContext(null),di=f.createContext(null),hd=f.createContext(null),la=f.createContext({outlet:null,matches:[],isDataRoute:!1}),o0=f.createContext(null);function eD(t,n){let{relative:s}=n===void 0?{}:n;hl()||us(!1);let{basename:r,navigator:i}=f.useContext(di),{hash:o,pathname:c,search:d}=c0(t,{relative:s}),u=c;return r!=="/"&&(u=c==="/"?r:Ia([r,c])),i.createHref({pathname:u,search:d,hash:o})}function hl(){return f.useContext(hd)!=null}function lr(){return hl()||us(!1),f.useContext(hd).location}function l0(t){f.useContext(di).static||f.useLayoutEffect(t)}function qi(){let{isDataRoute:t}=f.useContext(la);return t?xD():tD()}function tD(){hl()||us(!1);let t=f.useContext(wf),{basename:n,future:s,navigator:r}=f.useContext(di),{matches:i}=f.useContext(la),{pathname:o}=lr(),c=JSON.stringify(r0(i,s.v7_relativeSplatPath)),d=f.useRef(!1);return l0(()=>{d.current=!0}),f.useCallback(function(m,p){if(p===void 0&&(p={}),!d.current)return;if(typeof m=="number"){r.go(m);return}let x=a0(m,JSON.parse(c),o,p.relative==="path");t==null&&n!=="/"&&(x.pathname=x.pathname==="/"?n:Ia([n,x.pathname])),(p.replace?r.replace:r.push)(x,p.state,p)},[n,r,c,o,t])}const sD=f.createContext(null);function nD(t){let n=f.useContext(la).outlet;return n&&f.createElement(sD.Provider,{value:t},n)}function rD(){let{matches:t}=f.useContext(la),n=t[t.length-1];return n?n.params:{}}function c0(t,n){let{relative:s}=n===void 0?{}:n,{future:r}=f.useContext(di),{matches:i}=f.useContext(la),{pathname:o}=lr(),c=JSON.stringify(r0(i,r.v7_relativeSplatPath));return f.useMemo(()=>a0(t,JSON.parse(c),o,s==="path"),[t,c,o,s])}function aD(t,n){return iD(t,n)}function iD(t,n,s,r){hl()||us(!1);let{navigator:i}=f.useContext(di),{matches:o}=f.useContext(la),c=o[o.length-1],d=c?c.params:{};c&&c.pathname;let u=c?c.pathnameBase:"/";c&&c.route;let m=lr(),p;if(n){var x;let y=typeof n=="string"?Gi(n):n;u==="/"||(x=y.pathname)!=null&&x.startsWith(u)||us(!1),p=y}else p=m;let g=p.pathname||"/",v=g;if(u!=="/"){let y=u.replace(/^\//,"").split("/");v="/"+g.replace(/^\//,"").split("/").slice(y.length).join("/")}let j=A_(t,{pathname:v}),b=uD(j&&j.map(y=>Object.assign({},y,{params:Object.assign({},d,y.params),pathname:Ia([u,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:Ia([u,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),o,s,r);return n&&b?f.createElement(hd.Provider,{value:{location:tl({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:Ra.Pop}},b):b}function oD(){let t=hD(),n=X_(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},n),s?f.createElement("pre",{style:i},s):null,null)}const lD=f.createElement(oD,null);class cD extends f.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,s){return s.location!==n.location||s.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:s.error,location:s.location,revalidation:n.revalidation||s.revalidation}}componentDidCatch(n,s){console.error("React Router caught the following error during render",n,s)}render(){return this.state.error!==void 0?f.createElement(la.Provider,{value:this.props.routeContext},f.createElement(o0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dD(t){let{routeContext:n,match:s,children:r}=t,i=f.useContext(wf);return i&&i.static&&i.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=s.route.id),f.createElement(la.Provider,{value:n},r)}function uD(t,n,s,r){var i;if(n===void 0&&(n=[]),s===void 0&&(s=null),r===void 0&&(r=null),t==null){var o;if(!s)return null;if(s.errors)t=s.matches;else if((o=r)!=null&&o.v7_partialHydration&&n.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let c=t,d=(i=s)==null?void 0:i.errors;if(d!=null){let p=c.findIndex(x=>x.route.id&&(d==null?void 0:d[x.route.id])!==void 0);p>=0||us(!1),c=c.slice(0,Math.min(c.length,p+1))}let u=!1,m=-1;if(s&&r&&r.v7_partialHydration)for(let p=0;p<c.length;p++){let x=c[p];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(m=p),x.route.id){let{loaderData:g,errors:v}=s,j=x.route.loader&&g[x.route.id]===void 0&&(!v||v[x.route.id]===void 0);if(x.route.lazy||j){u=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((p,x,g)=>{let v,j=!1,b=null,y=null;s&&(v=d&&x.route.id?d[x.route.id]:void 0,b=x.route.errorElement||lD,u&&(m<0&&g===0?(j=!0,y=null):m===g&&(j=!0,y=x.route.hydrateFallbackElement||null)));let N=n.concat(c.slice(0,g+1)),S=()=>{let E;return v?E=b:j?E=y:x.route.Component?E=f.createElement(x.route.Component,null):x.route.element?E=x.route.element:E=p,f.createElement(dD,{match:x,routeContext:{outlet:p,matches:N,isDataRoute:s!=null},children:E})};return s&&(x.route.ErrorBoundary||x.route.errorElement||g===0)?f.createElement(cD,{location:s.location,revalidation:s.revalidation,component:b,error:v,children:S(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):S()},null)}var d0=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(d0||{}),Hc=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Hc||{});function mD(t){let n=f.useContext(wf);return n||us(!1),n}function fD(t){let n=f.useContext(Q_);return n||us(!1),n}function pD(t){let n=f.useContext(la);return n||us(!1),n}function u0(t){let n=pD(),s=n.matches[n.matches.length-1];return s.route.id||us(!1),s.route.id}function hD(){var t;let n=f.useContext(o0),s=fD(Hc.UseRouteError),r=u0(Hc.UseRouteError);return n!==void 0?n:(t=s.errors)==null?void 0:t[r]}function xD(){let{router:t}=mD(d0.UseNavigateStable),n=u0(Hc.UseNavigateStable),s=f.useRef(!1);return l0(()=>{s.current=!0}),f.useCallback(function(i,o){o===void 0&&(o={}),s.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,tl({fromRouteId:n},o)))},[t,n])}const Zx={};function gD(t,n){Zx[n]||(Zx[n]=!0,console.warn(n))}const Qx=(t,n,s)=>gD(t,"⚠️ React Router Future Flag Warning: "+n+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+s+"."));function vD(t,n){(t==null?void 0:t.v7_startTransition)===void 0&&Qx("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(t==null?void 0:t.v7_relativeSplatPath)===void 0&&!n&&Qx("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function yD(t){return nD(t.context)}function gs(t){us(!1)}function bD(t){let{basename:n="/",children:s=null,location:r,navigationType:i=Ra.Pop,navigator:o,static:c=!1,future:d}=t;hl()&&us(!1);let u=n.replace(/^\/*/,"/"),m=f.useMemo(()=>({basename:u,navigator:o,static:c,future:tl({v7_relativeSplatPath:!1},d)}),[u,d,o,c]);typeof r=="string"&&(r=Gi(r));let{pathname:p="/",search:x="",hash:g="",state:v=null,key:j="default"}=r,b=f.useMemo(()=>{let y=jf(p,u);return y==null?null:{location:{pathname:y,search:x,hash:g,state:v,key:j},navigationType:i}},[u,p,x,g,v,j,i]);return b==null?null:f.createElement(di.Provider,{value:m},f.createElement(hd.Provider,{children:s,value:b}))}function jD(t){let{children:n,location:s}=t;return aD(Dm(n),s)}new Promise(()=>{});function Dm(t,n){n===void 0&&(n=[]);let s=[];return f.Children.forEach(t,(r,i)=>{if(!f.isValidElement(r))return;let o=[...n,i];if(r.type===f.Fragment){s.push.apply(s,Dm(r.props.children,o));return}r.type!==gs&&us(!1),!r.props.index||!r.props.children||us(!1);let c={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=Dm(r.props.children,o)),s.push(c)}),s}/**
 * React Router DOM v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Am(){return Am=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},Am.apply(this,arguments)}function wD(t,n){if(t==null)return{};var s={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(n.indexOf(i)>=0)&&(s[i]=t[i]);return s}function ND(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function SD(t,n){return t.button===0&&(!n||n==="_self")&&!ND(t)}const CD=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],ED="6";try{window.__reactRouterVersion=ED}catch{}const TD="startTransition",eg=jk[TD];function kD(t){let{basename:n,children:s,future:r,window:i}=t,o=f.useRef();o.current==null&&(o.current=k_({window:i,v5Compat:!0}));let c=o.current,[d,u]=f.useState({action:c.action,location:c.location}),{v7_startTransition:m}=r||{},p=f.useCallback(x=>{m&&eg?eg(()=>u(x)):u(x)},[u,m]);return f.useLayoutEffect(()=>c.listen(p),[c,p]),f.useEffect(()=>vD(r),[r]),f.createElement(bD,{basename:n,children:s,location:d.location,navigationType:d.action,navigator:c,future:r})}const _D=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",DD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ds=f.forwardRef(function(n,s){let{onClick:r,relative:i,reloadDocument:o,replace:c,state:d,target:u,to:m,preventScrollReset:p,viewTransition:x}=n,g=wD(n,CD),{basename:v}=f.useContext(di),j,b=!1;if(typeof m=="string"&&DD.test(m)&&(j=m,_D))try{let E=new URL(window.location.href),T=m.startsWith("//")?new URL(E.protocol+m):new URL(m),k=jf(T.pathname,v);T.origin===E.origin&&k!=null?m=k+T.search+T.hash:b=!0}catch{}let y=eD(m,{relative:i}),N=AD(m,{replace:c,state:d,target:u,preventScrollReset:p,relative:i,viewTransition:x});function S(E){r&&r(E),E.defaultPrevented||N(E)}return f.createElement("a",Am({},g,{href:j||y,onClick:b||o?r:S,ref:s,target:u}))});var tg;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(tg||(tg={}));var sg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(sg||(sg={}));function AD(t,n){let{target:s,replace:r,state:i,preventScrollReset:o,relative:c,viewTransition:d}=n===void 0?{}:n,u=qi(),m=lr(),p=c0(t,{relative:c});return f.useCallback(x=>{if(SD(x,s)){x.preventDefault();let g=r!==void 0?r:Wc(m)===Wc(p);u(t,{replace:g,state:i,preventScrollReset:o,relative:c,viewTransition:d})}},[m,u,p,r,i,s,t,o,c,d])}const RD="modulepreload",PD=function(t){return"/life-tracker/"+t},ng={},Yi=function(n,s,r){let i=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(s.map(u=>{if(u=PD(u),u in ng)return;ng[u]=!0;const m=u.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const x=document.createElement("link");if(x.rel=m?"stylesheet":RD,m||(x.as="script"),x.crossOrigin="",x.href=u,d&&x.setAttribute("nonce",d),document.head.appendChild(x),m)return new Promise((g,v)=>{x.addEventListener("load",g),x.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return i.then(c=>{for(const d of c||[])d.status==="rejected"&&o(d.reason);return n().catch(o)})};function ID(t={}){const{immediate:n=!1,onNeedRefresh:s,onOfflineReady:r,onRegistered:i,onRegisteredSW:o,onRegisterError:c}=t;let d,u;const m=async(x=!0)=>{await u};async function p(){if("serviceWorker"in navigator){if(d=await Yi(async()=>{const{Workbox:x}=await import("../chunks/workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:x}},[]).then(({Workbox:x})=>new x("/life-tracker/service-worker.js",{scope:"/life-tracker/",type:"classic"})).catch(x=>{c==null||c(x)}),!d)return;d.addEventListener("activated",x=>{(x.isUpdate||x.isExternal)&&window.location.reload()}),d.addEventListener("installed",x=>{x.isUpdate||r==null||r()}),d.register({immediate:n}).then(x=>{o?o("/life-tracker/service-worker.js",x):i==null||i(x)}).catch(x=>{c==null||c(x)})}}return u=p(),m}const xd=()=>{const[t,n]=f.useState(()=>{if(typeof window>"u")return{deviceType:"desktop",orientation:"landscape",isMobile:!1,isTablet:!1,isDesktop:!0,screenWidth:1920,screenHeight:1080};const s=window.innerWidth,r=window.innerHeight;return{deviceType:s<768?"mobile":s<1024?"tablet":"desktop",orientation:s<r?"portrait":"landscape",isMobile:s<768,isTablet:s>=768&&s<1024,isDesktop:s>=1024,screenWidth:s,screenHeight:r}});return f.useEffect(()=>{const s=()=>{const i=window.innerWidth,o=window.innerHeight;n({deviceType:i<768?"mobile":i<1024?"tablet":"desktop",orientation:i<o?"portrait":"landscape",isMobile:i<768,isTablet:i>=768&&i<1024,isDesktop:i>=1024,screenWidth:i,screenHeight:o})},r=()=>{setTimeout(s,100)};return window.addEventListener("resize",s),window.addEventListener("orientationchange",r),()=>{window.removeEventListener("resize",s),window.removeEventListener("orientationchange",r)}},[]),t},OD=()=>{const[t,n]=f.useState(!1),[s,r]=f.useState(!1),[i,o]=f.useState(null);return f.useEffect(()=>{const d=window.matchMedia("(display-mode: standalone)").matches,u=window.navigator.standalone===!0;n(d||u);const m=p=>{p.preventDefault(),o(p),r(!0)};return window.addEventListener("beforeinstallprompt",m),()=>{window.removeEventListener("beforeinstallprompt",m)}},[]),{isInstalled:t,canInstall:s,promptInstall:async()=>{if(!i)return!1;i.prompt();const{outcome:d}=await i.userChoice;return d==="accepted"?(r(!1),o(null),!0):!1}}};function rg(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function MD(...t){return n=>{let s=!1;const r=t.map(i=>{const o=rg(i,n);return!s&&typeof o=="function"&&(s=!0),o});if(s)return()=>{for(let i=0;i<r.length;i++){const o=r[i];typeof o=="function"?o():rg(t[i],null)}}}}var sl=f.forwardRef((t,n)=>{const{children:s,...r}=t,i=f.Children.toArray(s),o=i.find($D);if(o){const c=o.props.children,d=i.map(u=>u===o?f.Children.count(c)>1?f.Children.only(null):f.isValidElement(c)?c.props.children:null:u);return e.jsx(Rm,{...r,ref:n,children:f.isValidElement(c)?f.cloneElement(c,void 0,d):null})}return e.jsx(Rm,{...r,ref:n,children:s})});sl.displayName="Slot";var Rm=f.forwardRef((t,n)=>{const{children:s,...r}=t;if(f.isValidElement(s)){const i=FD(s);return f.cloneElement(s,{...zD(r,s.props),ref:n?MD(n,i):i})}return f.Children.count(s)>1?f.Children.only(null):null});Rm.displayName="SlotClone";var LD=({children:t})=>e.jsx(e.Fragment,{children:t});function $D(t){return f.isValidElement(t)&&t.type===LD}function zD(t,n){const s={...n};for(const r in n){const i=t[r],o=n[r];/^on[A-Z]/.test(r)?i&&o?s[r]=(...d)=>{o(...d),i(...d)}:i&&(s[r]=i):r==="style"?s[r]={...i,...o}:r==="className"&&(s[r]=[i,o].filter(Boolean).join(" "))}return{...t,...s}}function FD(t){var r,i;let n=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}const Nf="-",BD=t=>{const n=HD(t),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:c=>{const d=c.split(Nf);return d[0]===""&&d.length!==1&&d.shift(),m0(d,n)||WD(c)},getConflictingClassGroupIds:(c,d)=>{const u=s[c]||[];return d&&r[c]?[...u,...r[c]]:u}}},m0=(t,n)=>{var c;if(t.length===0)return n.classGroupId;const s=t[0],r=n.nextPart.get(s),i=r?m0(t.slice(1),r):void 0;if(i)return i;if(n.validators.length===0)return;const o=t.join(Nf);return(c=n.validators.find(({validator:d})=>d(o)))==null?void 0:c.classGroupId},ag=/^\[(.+)\]$/,WD=t=>{if(ag.test(t)){const n=ag.exec(t)[1],s=n==null?void 0:n.substring(0,n.indexOf(":"));if(s)return"arbitrary.."+s}},HD=t=>{const{theme:n,prefix:s}=t,r={nextPart:new Map,validators:[]};return VD(Object.entries(t.classGroups),s).forEach(([o,c])=>{Pm(c,r,o,n)}),r},Pm=(t,n,s,r)=>{t.forEach(i=>{if(typeof i=="string"){const o=i===""?n:ig(n,i);o.classGroupId=s;return}if(typeof i=="function"){if(UD(i)){Pm(i(r),n,s,r);return}n.validators.push({validator:i,classGroupId:s});return}Object.entries(i).forEach(([o,c])=>{Pm(c,ig(n,o),s,r)})})},ig=(t,n)=>{let s=t;return n.split(Nf).forEach(r=>{s.nextPart.has(r)||s.nextPart.set(r,{nextPart:new Map,validators:[]}),s=s.nextPart.get(r)}),s},UD=t=>t.isThemeGetter,VD=(t,n)=>n?t.map(([s,r])=>{const i=r.map(o=>typeof o=="string"?n+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([c,d])=>[n+c,d])):o);return[s,i]}):t,GD=t=>{if(t<1)return{get:()=>{},set:()=>{}};let n=0,s=new Map,r=new Map;const i=(o,c)=>{s.set(o,c),n++,n>t&&(n=0,r=s,s=new Map)};return{get(o){let c=s.get(o);if(c!==void 0)return c;if((c=r.get(o))!==void 0)return i(o,c),c},set(o,c){s.has(o)?s.set(o,c):i(o,c)}}},f0="!",qD=t=>{const{separator:n,experimentalParseClassName:s}=t,r=n.length===1,i=n[0],o=n.length,c=d=>{const u=[];let m=0,p=0,x;for(let y=0;y<d.length;y++){let N=d[y];if(m===0){if(N===i&&(r||d.slice(y,y+o)===n)){u.push(d.slice(p,y)),p=y+o;continue}if(N==="/"){x=y;continue}}N==="["?m++:N==="]"&&m--}const g=u.length===0?d:d.substring(p),v=g.startsWith(f0),j=v?g.substring(1):g,b=x&&x>p?x-p:void 0;return{modifiers:u,hasImportantModifier:v,baseClassName:j,maybePostfixModifierPosition:b}};return s?d=>s({className:d,parseClassName:c}):c},YD=t=>{if(t.length<=1)return t;const n=[];let s=[];return t.forEach(r=>{r[0]==="["?(n.push(...s.sort(),r),s=[]):s.push(r)}),n.push(...s.sort()),n},KD=t=>({cache:GD(t.cacheSize),parseClassName:qD(t),...BD(t)}),JD=/\s+/,XD=(t,n)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:i}=n,o=[],c=t.trim().split(JD);let d="";for(let u=c.length-1;u>=0;u-=1){const m=c[u],{modifiers:p,hasImportantModifier:x,baseClassName:g,maybePostfixModifierPosition:v}=s(m);let j=!!v,b=r(j?g.substring(0,v):g);if(!b){if(!j){d=m+(d.length>0?" "+d:d);continue}if(b=r(g),!b){d=m+(d.length>0?" "+d:d);continue}j=!1}const y=YD(p).join(":"),N=x?y+f0:y,S=N+b;if(o.includes(S))continue;o.push(S);const E=i(b,j);for(let T=0;T<E.length;++T){const k=E[T];o.push(N+k)}d=m+(d.length>0?" "+d:d)}return d};function ZD(){let t=0,n,s,r="";for(;t<arguments.length;)(n=arguments[t++])&&(s=p0(n))&&(r&&(r+=" "),r+=s);return r}const p0=t=>{if(typeof t=="string")return t;let n,s="";for(let r=0;r<t.length;r++)t[r]&&(n=p0(t[r]))&&(s&&(s+=" "),s+=n);return s};function QD(t,...n){let s,r,i,o=c;function c(u){const m=n.reduce((p,x)=>x(p),t());return s=KD(m),r=s.cache.get,i=s.cache.set,o=d,d(u)}function d(u){const m=r(u);if(m)return m;const p=XD(u,s);return i(u,p),p}return function(){return o(ZD.apply(null,arguments))}}const Bt=t=>{const n=s=>s[t]||[];return n.isThemeGetter=!0,n},h0=/^\[(?:([a-z-]+):)?(.+)\]$/i,eA=/^\d+\/\d+$/,tA=new Set(["px","full","screen"]),sA=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,nA=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,rA=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,aA=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,iA=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Gr=t=>Ri(t)||tA.has(t)||eA.test(t),ja=t=>Ki(t,"length",pA),Ri=t=>!!t&&!Number.isNaN(Number(t)),tm=t=>Ki(t,"number",Ri),Eo=t=>!!t&&Number.isInteger(Number(t)),oA=t=>t.endsWith("%")&&Ri(t.slice(0,-1)),Xe=t=>h0.test(t),wa=t=>sA.test(t),lA=new Set(["length","size","percentage"]),cA=t=>Ki(t,lA,x0),dA=t=>Ki(t,"position",x0),uA=new Set(["image","url"]),mA=t=>Ki(t,uA,xA),fA=t=>Ki(t,"",hA),To=()=>!0,Ki=(t,n,s)=>{const r=h0.exec(t);return r?r[1]?typeof n=="string"?r[1]===n:n.has(r[1]):s(r[2]):!1},pA=t=>nA.test(t)&&!rA.test(t),x0=()=>!1,hA=t=>aA.test(t),xA=t=>iA.test(t),gA=()=>{const t=Bt("colors"),n=Bt("spacing"),s=Bt("blur"),r=Bt("brightness"),i=Bt("borderColor"),o=Bt("borderRadius"),c=Bt("borderSpacing"),d=Bt("borderWidth"),u=Bt("contrast"),m=Bt("grayscale"),p=Bt("hueRotate"),x=Bt("invert"),g=Bt("gap"),v=Bt("gradientColorStops"),j=Bt("gradientColorStopPositions"),b=Bt("inset"),y=Bt("margin"),N=Bt("opacity"),S=Bt("padding"),E=Bt("saturate"),T=Bt("scale"),k=Bt("sepia"),M=Bt("skew"),R=Bt("space"),I=Bt("translate"),O=()=>["auto","contain","none"],H=()=>["auto","hidden","clip","visible","scroll"],$=()=>["auto",Xe,n],D=()=>[Xe,n],P=()=>["",Gr,ja],K=()=>["auto",Ri,Xe],X=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],G=()=>["solid","dashed","dotted","double","none"],U=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Y=()=>["start","end","center","between","around","evenly","stretch"],ae=()=>["","0",Xe],ye=()=>["auto","avoid","all","avoid-page","page","left","right","column"],oe=()=>[Ri,Xe];return{cacheSize:500,separator:":",theme:{colors:[To],spacing:[Gr,ja],blur:["none","",wa,Xe],brightness:oe(),borderColor:[t],borderRadius:["none","","full",wa,Xe],borderSpacing:D(),borderWidth:P(),contrast:oe(),grayscale:ae(),hueRotate:oe(),invert:ae(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[oA,ja],inset:$(),margin:$(),opacity:oe(),padding:D(),saturate:oe(),scale:oe(),sepia:ae(),skew:oe(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",Xe]}],container:["container"],columns:[{columns:[wa]}],"break-after":[{"break-after":ye()}],"break-before":[{"break-before":ye()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...X(),Xe]}],overflow:[{overflow:H()}],"overflow-x":[{"overflow-x":H()}],"overflow-y":[{"overflow-y":H()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Eo,Xe]}],basis:[{basis:$()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Xe]}],grow:[{grow:ae()}],shrink:[{shrink:ae()}],order:[{order:["first","last","none",Eo,Xe]}],"grid-cols":[{"grid-cols":[To]}],"col-start-end":[{col:["auto",{span:["full",Eo,Xe]},Xe]}],"col-start":[{"col-start":K()}],"col-end":[{"col-end":K()}],"grid-rows":[{"grid-rows":[To]}],"row-start-end":[{row:["auto",{span:[Eo,Xe]},Xe]}],"row-start":[{"row-start":K()}],"row-end":[{"row-end":K()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Xe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Xe]}],gap:[{gap:[g]}],"gap-x":[{"gap-x":[g]}],"gap-y":[{"gap-y":[g]}],"justify-content":[{justify:["normal",...Y()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Y(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Y(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[S]}],px:[{px:[S]}],py:[{py:[S]}],ps:[{ps:[S]}],pe:[{pe:[S]}],pt:[{pt:[S]}],pr:[{pr:[S]}],pb:[{pb:[S]}],pl:[{pl:[S]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[R]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[R]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Xe,n]}],"min-w":[{"min-w":[Xe,n,"min","max","fit"]}],"max-w":[{"max-w":[Xe,n,"none","full","min","max","fit","prose",{screen:[wa]},wa]}],h:[{h:[Xe,n,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Xe,n,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Xe,n,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Xe,n,"auto","min","max","fit"]}],"font-size":[{text:["base",wa,ja]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",tm]}],"font-family":[{font:[To]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Xe]}],"line-clamp":[{"line-clamp":["none",Ri,tm]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Gr,Xe]}],"list-image":[{"list-image":["none",Xe]}],"list-style-type":[{list:["none","disc","decimal",Xe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[N]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[N]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Gr,ja]}],"underline-offset":[{"underline-offset":["auto",Gr,Xe]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Xe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Xe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[N]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...X(),dA]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",cA]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},mA]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[j]}],"gradient-via-pos":[{via:[j]}],"gradient-to-pos":[{to:[j]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[d]}],"border-w-x":[{"border-x":[d]}],"border-w-y":[{"border-y":[d]}],"border-w-s":[{"border-s":[d]}],"border-w-e":[{"border-e":[d]}],"border-w-t":[{"border-t":[d]}],"border-w-r":[{"border-r":[d]}],"border-w-b":[{"border-b":[d]}],"border-w-l":[{"border-l":[d]}],"border-opacity":[{"border-opacity":[N]}],"border-style":[{border:[...G(),"hidden"]}],"divide-x":[{"divide-x":[d]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[d]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[N]}],"divide-style":[{divide:G()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...G()]}],"outline-offset":[{"outline-offset":[Gr,Xe]}],"outline-w":[{outline:[Gr,ja]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:P()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[N]}],"ring-offset-w":[{"ring-offset":[Gr,ja]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",wa,fA]}],"shadow-color":[{shadow:[To]}],opacity:[{opacity:[N]}],"mix-blend":[{"mix-blend":[...U(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":U()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",wa,Xe]}],grayscale:[{grayscale:[m]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[x]}],saturate:[{saturate:[E]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[m]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[x]}],"backdrop-opacity":[{"backdrop-opacity":[N]}],"backdrop-saturate":[{"backdrop-saturate":[E]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Xe]}],duration:[{duration:oe()}],ease:[{ease:["linear","in","out","in-out",Xe]}],delay:[{delay:oe()}],animate:[{animate:["none","spin","ping","pulse","bounce",Xe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[Eo,Xe]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[M]}],"skew-y":[{"skew-y":[M]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Xe]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Xe]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Xe]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Gr,ja,tm]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},vA=QD(gA);function ce(...t){return vA(Nk(t))}const nl=Bi("inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 touch-manipulation active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-md",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-md",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",gradient:"gradient-bg-primary text-white shadow-lg border-0 hover:opacity-90",glass:"glass-card text-gray-700 hover:bg-white/30 backdrop-blur-sm border border-white/20"},size:{default:"h-10 md:h-11 px-4 py-2",sm:"h-8 md:h-9 rounded-md px-3 text-xs md:text-sm",lg:"h-12 md:h-13 rounded-md px-8 text-sm md:text-base",icon:"h-10 w-10 md:h-11 md:w-11",touch:"h-11 md:h-12 px-6 py-3 text-base md:text-lg min-w-[44px]"}},defaultVariants:{variant:"default",size:"default"}}),F=f.forwardRef(({className:t,variant:n,size:s,asChild:r=!1,...i},o)=>{const c=r?sl:"button";return e.jsx(c,{className:ce(nl({variant:n,size:s,className:t})),ref:o,...i})});F.displayName="Button";var yA=f.forwardRef((t,n)=>{const{children:s,...r}=t,i=f.Children.toArray(s),o=i.find(bA);if(o){const c=o.props.children,d=i.map(u=>u===o?f.Children.count(c)>1?f.Children.only(null):f.isValidElement(c)?c.props.children:null:u);return e.jsx(Im,{...r,ref:n,children:f.isValidElement(c)?f.cloneElement(c,void 0,d):null})}return e.jsx(Im,{...r,ref:n,children:s})});yA.displayName="Slot";var Im=f.forwardRef((t,n)=>{const{children:s,...r}=t;if(f.isValidElement(s)){const i=wA(s);return f.cloneElement(s,{...jA(r,s.props),ref:n?of(n,i):i})}return f.Children.count(s)>1?f.Children.only(null):null});Im.displayName="SlotClone";var g0=({children:t})=>e.jsx(e.Fragment,{children:t});function bA(t){return f.isValidElement(t)&&t.type===g0}function jA(t,n){const s={...n};for(const r in n){const i=t[r],o=n[r];/^on[A-Z]/.test(r)?i&&o?s[r]=(...d)=>{o(...d),i(...d)}:i&&(s[r]=i):r==="style"?s[r]={...i,...o}:r==="className"&&(s[r]=[i,o].filter(Boolean).join(" "))}return{...t,...s}}function wA(t){var r,i;let n=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var NA="VisuallyHidden",Sf=f.forwardRef((t,n)=>e.jsx(It.span,{...t,ref:n,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));Sf.displayName=NA;var SA=Sf,[gd,y$]=za("Tooltip",[id]),vd=id(),v0="TooltipProvider",CA=700,Om="tooltip.open",[EA,Cf]=gd(v0),y0=t=>{const{__scopeTooltip:n,delayDuration:s=CA,skipDelayDuration:r=300,disableHoverableContent:i=!1,children:o}=t,[c,d]=f.useState(!0),u=f.useRef(!1),m=f.useRef(0);return f.useEffect(()=>{const p=m.current;return()=>window.clearTimeout(p)},[]),e.jsx(EA,{scope:n,isOpenDelayed:c,delayDuration:s,onOpen:f.useCallback(()=>{window.clearTimeout(m.current),d(!1)},[]),onClose:f.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>d(!0),r)},[r]),isPointerInTransitRef:u,onPointerInTransitChange:f.useCallback(p=>{u.current=p},[]),disableHoverableContent:i,children:o})};y0.displayName=v0;var yd="Tooltip",[TA,bd]=gd(yd),b0=t=>{const{__scopeTooltip:n,children:s,open:r,defaultOpen:i=!1,onOpenChange:o,disableHoverableContent:c,delayDuration:d}=t,u=Cf(yd,t.__scopeTooltip),m=vd(n),[p,x]=f.useState(null),g=Fi(),v=f.useRef(0),j=c??u.disableHoverableContent,b=d??u.delayDuration,y=f.useRef(!1),[N=!1,S]=aa({prop:r,defaultProp:i,onChange:R=>{R?(u.onOpen(),document.dispatchEvent(new CustomEvent(Om))):u.onClose(),o==null||o(R)}}),E=f.useMemo(()=>N?y.current?"delayed-open":"instant-open":"closed",[N]),T=f.useCallback(()=>{window.clearTimeout(v.current),y.current=!1,S(!0)},[S]),k=f.useCallback(()=>{window.clearTimeout(v.current),S(!1)},[S]),M=f.useCallback(()=>{window.clearTimeout(v.current),v.current=window.setTimeout(()=>{y.current=!0,S(!0)},b)},[b,S]);return f.useEffect(()=>()=>window.clearTimeout(v.current),[]),e.jsx(Tv,{...m,children:e.jsx(TA,{scope:n,contentId:g,open:N,stateAttribute:E,trigger:p,onTriggerChange:x,onTriggerEnter:f.useCallback(()=>{u.isOpenDelayed?M():T()},[u.isOpenDelayed,M,T]),onTriggerLeave:f.useCallback(()=>{j?k():window.clearTimeout(v.current)},[k,j]),onOpen:T,onClose:k,disableHoverableContent:j,children:s})})};b0.displayName=yd;var Mm="TooltipTrigger",j0=f.forwardRef((t,n)=>{const{__scopeTooltip:s,...r}=t,i=bd(Mm,s),o=Cf(Mm,s),c=vd(s),d=f.useRef(null),u=is(n,d,i.onTriggerChange),m=f.useRef(!1),p=f.useRef(!1),x=f.useCallback(()=>m.current=!1,[]);return f.useEffect(()=>()=>document.removeEventListener("pointerup",x),[x]),e.jsx(Nv,{asChild:!0,...c,children:e.jsx(It.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:u,onPointerMove:ot(t.onPointerMove,g=>{g.pointerType!=="touch"&&!p.current&&!o.isPointerInTransitRef.current&&(i.onTriggerEnter(),p.current=!0)}),onPointerLeave:ot(t.onPointerLeave,()=>{i.onTriggerLeave(),p.current=!1}),onPointerDown:ot(t.onPointerDown,()=>{m.current=!0,document.addEventListener("pointerup",x,{once:!0})}),onFocus:ot(t.onFocus,()=>{m.current||i.onOpen()}),onBlur:ot(t.onBlur,i.onClose),onClick:ot(t.onClick,i.onClose)})})});j0.displayName=Mm;var kA="TooltipPortal",[b$,_A]=gd(kA,{forceMount:void 0}),Mi="TooltipContent",w0=f.forwardRef((t,n)=>{const s=_A(Mi,t.__scopeTooltip),{forceMount:r=s.forceMount,side:i="top",...o}=t,c=bd(Mi,t.__scopeTooltip);return e.jsx(zi,{present:r||c.open,children:c.disableHoverableContent?e.jsx(N0,{side:i,...o,ref:n}):e.jsx(DA,{side:i,...o,ref:n})})}),DA=f.forwardRef((t,n)=>{const s=bd(Mi,t.__scopeTooltip),r=Cf(Mi,t.__scopeTooltip),i=f.useRef(null),o=is(n,i),[c,d]=f.useState(null),{trigger:u,onClose:m}=s,p=i.current,{onPointerInTransitChange:x}=r,g=f.useCallback(()=>{d(null),x(!1)},[x]),v=f.useCallback((j,b)=>{const y=j.currentTarget,N={x:j.clientX,y:j.clientY},S=IA(N,y.getBoundingClientRect()),E=OA(N,S),T=MA(b.getBoundingClientRect()),k=$A([...E,...T]);d(k),x(!0)},[x]);return f.useEffect(()=>()=>g(),[g]),f.useEffect(()=>{if(u&&p){const j=y=>v(y,p),b=y=>v(y,u);return u.addEventListener("pointerleave",j),p.addEventListener("pointerleave",b),()=>{u.removeEventListener("pointerleave",j),p.removeEventListener("pointerleave",b)}}},[u,p,v,g]),f.useEffect(()=>{if(c){const j=b=>{const y=b.target,N={x:b.clientX,y:b.clientY},S=(u==null?void 0:u.contains(y))||(p==null?void 0:p.contains(y)),E=!LA(N,c);S?g():E&&(g(),m())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[u,p,c,m,g]),e.jsx(N0,{...t,ref:o})}),[AA,RA]=gd(yd,{isInside:!1}),N0=f.forwardRef((t,n)=>{const{__scopeTooltip:s,children:r,"aria-label":i,onEscapeKeyDown:o,onPointerDownOutside:c,...d}=t,u=bd(Mi,s),m=vd(s),{onClose:p}=u;return f.useEffect(()=>(document.addEventListener(Om,p),()=>document.removeEventListener(Om,p)),[p]),f.useEffect(()=>{if(u.trigger){const x=g=>{const v=g.target;v!=null&&v.contains(u.trigger)&&p()};return window.addEventListener("scroll",x,{capture:!0}),()=>window.removeEventListener("scroll",x,{capture:!0})}},[u.trigger,p]),e.jsx(Sv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:x=>x.preventDefault(),onDismiss:p,children:e.jsxs(Cv,{"data-state":u.stateAttribute,...m,...d,ref:n,style:{...d.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(g0,{children:r}),e.jsx(AA,{scope:s,isInside:!0,children:e.jsx(SA,{id:u.contentId,role:"tooltip",children:i||r})})]})})});w0.displayName=Mi;var S0="TooltipArrow",PA=f.forwardRef((t,n)=>{const{__scopeTooltip:s,...r}=t,i=vd(s);return RA(S0,s).isInside?null:e.jsx(Ev,{...i,...r,ref:n})});PA.displayName=S0;function IA(t,n){const s=Math.abs(n.top-t.y),r=Math.abs(n.bottom-t.y),i=Math.abs(n.right-t.x),o=Math.abs(n.left-t.x);switch(Math.min(s,r,i,o)){case o:return"left";case i:return"right";case s:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function OA(t,n,s=5){const r=[];switch(n){case"top":r.push({x:t.x-s,y:t.y+s},{x:t.x+s,y:t.y+s});break;case"bottom":r.push({x:t.x-s,y:t.y-s},{x:t.x+s,y:t.y-s});break;case"left":r.push({x:t.x+s,y:t.y-s},{x:t.x+s,y:t.y+s});break;case"right":r.push({x:t.x-s,y:t.y-s},{x:t.x-s,y:t.y+s});break}return r}function MA(t){const{top:n,right:s,bottom:r,left:i}=t;return[{x:i,y:n},{x:s,y:n},{x:s,y:r},{x:i,y:r}]}function LA(t,n){const{x:s,y:r}=t;let i=!1;for(let o=0,c=n.length-1;o<n.length;c=o++){const d=n[o].x,u=n[o].y,m=n[c].x,p=n[c].y;u>r!=p>r&&s<(m-d)*(r-u)/(p-u)+d&&(i=!i)}return i}function $A(t){const n=t.slice();return n.sort((s,r)=>s.x<r.x?-1:s.x>r.x?1:s.y<r.y?-1:s.y>r.y?1:0),zA(n)}function zA(t){if(t.length<=1)return t.slice();const n=[];for(let r=0;r<t.length;r++){const i=t[r];for(;n.length>=2;){const o=n[n.length-1],c=n[n.length-2];if((o.x-c.x)*(i.y-c.y)>=(o.y-c.y)*(i.x-c.x))n.pop();else break}n.push(i)}n.pop();const s=[];for(let r=t.length-1;r>=0;r--){const i=t[r];for(;s.length>=2;){const o=s[s.length-1],c=s[s.length-2];if((o.x-c.x)*(i.y-c.y)>=(o.y-c.y)*(i.x-c.x))s.pop();else break}s.push(i)}return s.pop(),n.length===1&&s.length===1&&n[0].x===s[0].x&&n[0].y===s[0].y?n:n.concat(s)}var FA=y0,BA=b0,WA=j0,C0=w0;const zn=FA,ls=BA,cs=WA,rs=f.forwardRef(({className:t,sideOffset:n=4,...s},r)=>e.jsx(C0,{ref:r,sideOffset:n,className:ce("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));rs.displayName=C0.displayName;const HA={apiKey:"AIzaSyA1UeSwJ_gjygFI5SL4ZANSDHWTnuOxD_o",authDomain:"lifetracker-9e171.firebaseapp.com",projectId:"lifetracker-9e171",storageBucket:"lifetracker-9e171.firebasestorage.app",messagingSenderId:"160072327627",appId:"1:160072327627:web:664a48e910b6eedd59964e"},E0=Mk(HA),sm=Lk(E0),fe=$k(E0);let og=!1;typeof window<"u"&&!og&&(og=!0,zk(fe).catch(t=>{}));function He(){const[t,n]=f.useState(null),[s,r]=f.useState(!0);return f.useEffect(()=>Fk(sm,d=>{n(d),r(!1)}),[]),{user:t,loading:s,signIn:async()=>{const c=new Bk;try{await Wk(sm,c)}catch(d){console.error("Error al iniciar sesión:",d)}},signOut:async()=>{try{await Hk(sm)}catch(c){console.error("Error al cerrar sesión:",c)}}}}const Xr=[{icon:Yk,label:"Inicio",path:"/"},{icon:pf,label:"Hidratación",path:"/water"},{icon:Kk,label:"Ejercicio",path:"/exercise"},{icon:hf,label:"Hábitos",path:"/habit"},{icon:Hv,label:"Estado",path:"/mood"},{icon:ld,label:"Diario",path:"/journal"},{icon:xf,label:"Pomodoro",path:"/pomodoro"},{icon:Uv,label:"Comidas",path:"/meal"},{icon:Jk,label:"Tareas",path:"/task"},{icon:Vv,label:"Kanban",path:"/kanban"},{icon:gf,label:"Estadísticas",path:"/stats"},{icon:Xk,label:"Hábitos Negativos",path:"/negative"},{icon:Zk,label:"Salir",path:"/logout"}],UA=()=>{const t=lr(),n=qi(),{signOut:s}=He(),[r,i]=f.useState(()=>localStorage.getItem("desktop-nav-expanded")==="true");f.useEffect(()=>{localStorage.setItem("desktop-nav-expanded",JSON.stringify(r)),document.documentElement.style.setProperty("--desktop-nav-width",r?"256px":"64px")},[r]);const o=async()=>{try{await s(),n("/login")}catch(d){console.error("Error al cerrar sesión:",d)}},c=({icon:d,label:u,path:m,onClick:p})=>{const x=t.pathname===m,g=e.jsxs(e.Fragment,{children:[e.jsx(d,{className:`w-5 h-5 flex-shrink-0 ${x?"text-white":"text-gray-600"}`}),r&&e.jsx("span",{className:`ml-3 font-medium truncate ${x?"text-white":"text-gray-700"}`,children:u})]}),v=`
      w-full flex items-center justify-start rounded-xl transition-colors duration-150
      ${r?"px-4 py-3":"p-3"} 
      ${x?"gradient-bg-primary text-white shadow-lg":"hover:bg-white/20"}
    `;return r?e.jsx(F,{variant:"ghost",className:v,onClick:()=>p?p():n(m),children:g}):e.jsx(zn,{children:e.jsxs(ls,{delayDuration:0,children:[e.jsx(cs,{asChild:!0,children:e.jsx(F,{variant:"ghost",className:v,onClick:()=>p?p():n(m),children:g})}),e.jsx(rs,{side:"right",className:"bg-black text-white border-gray-700",children:e.jsx("p",{children:u})})]})})};return e.jsxs("aside",{className:`hidden md:flex flex-col h-screen fixed top-0 left-0 transition-all duration-300 glass-card z-50 border-r-0
      ${r?"w-64":"w-16"}`,children:[e.jsx("div",{className:"flex flex-col items-center space-y-3 p-4",children:e.jsx(F,{variant:"ghost",size:"icon",title:"Expand/Collapse Menu",onClick:()=>i(!r),className:"p-2 hover:bg-white/20 rounded-lg",children:e.jsx(ia,{className:`w-4 h-4 transform transition-transform duration-200 
            ${r?"rotate-180":""}`})})}),e.jsxs("nav",{className:"flex-1 p-3 overflow-y-auto space-y-2",children:[e.jsx("div",{className:"flex-1 space-y-1",children:Xr.slice(0,-1).map(d=>e.jsx(c,{icon:d.icon,label:d.label,path:d.path},d.path))}),e.jsx("div",{className:"border-t border-white/20 pt-3 mt-auto",children:e.jsx(c,{icon:Xr[Xr.length-1].icon,label:Xr[Xr.length-1].label,path:Xr[Xr.length-1].path,onClick:o})})]})]})},VA=cf,GA=df,qA=lf,T0=f.forwardRef(({className:t,...n},s)=>e.jsx(al,{className:ce("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:s}));T0.displayName=al.displayName;const YA=Bi("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),k0=f.forwardRef(({side:t="right",className:n,children:s,...r},i)=>e.jsxs(qA,{children:[e.jsx(T0,{}),e.jsxs(il,{ref:i,className:ce(YA({side:t}),n),...r,children:[s,e.jsxs(od,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Js,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));k0.displayName=il.displayName;const _0=({className:t,...n})=>e.jsx("div",{className:ce("flex flex-col space-y-2 text-center sm:text-left",t),...n});_0.displayName="SheetHeader";const D0=f.forwardRef(({className:t,...n},s)=>e.jsx(ol,{ref:s,className:ce("text-lg font-semibold text-foreground",t),...n}));D0.displayName=ol.displayName;const KA=f.forwardRef(({className:t,...n},s)=>e.jsx(ll,{ref:s,className:ce("text-sm text-muted-foreground",t),...n}));KA.displayName=ll.displayName;const JA=()=>{const t=lr(),n=qi(),{signOut:s}=He(),[r,i]=f.useState(!1),o=async()=>{try{i(!1),await s(),n("/login")}catch(m){console.error("Error al cerrar sesión:",m)}},c=Xr.slice(0,4),d=Xr.slice(4),u=({icon:m,label:p,path:x,onClick:g})=>{const v=t.pathname===x;return e.jsxs(F,{variant:"ghost",className:`flex flex-col items-center justify-center h-auto px-2 py-2 text-xs rounded-xl transition-all duration-300 active:scale-95 touch-manipulation
          ${v?"text-blue-600 bg-blue-50 shadow-sm scale-105":"text-gray-600 hover:text-blue-600 hover:bg-blue-50/50 hover:scale-105"}`,onClick:()=>{g?g():n(x),i(!1)},children:[e.jsx(m,{className:`w-5 h-5 sm:w-6 sm:h-6 ${v?"animate-pulse":""}`}),e.jsx("span",{className:"mt-1 font-medium leading-tight",children:p})]})};return e.jsx("div",{className:"md:hidden",children:e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-gray-200 z-30 shadow-lg",children:e.jsxs("nav",{className:"flex justify-around items-center px-1 py-1 max-w-screen-sm mx-auto",children:[c.map(m=>e.jsx(u,{icon:m.icon,label:m.label,path:m.path},m.path)),e.jsxs(VA,{open:r,onOpenChange:i,children:[e.jsx(GA,{asChild:!0,children:e.jsxs(F,{variant:"ghost",className:`flex flex-col items-center justify-center h-auto px-2 py-2 text-xs rounded-xl transition-all duration-300 active:scale-95 touch-manipulation
                  ${r?"text-blue-600 bg-blue-50 scale-105":"text-gray-600 hover:bg-blue-50/50 hover:scale-105"}`,children:[e.jsx(Dr,{className:`w-5 h-5 sm:w-6 sm:h-6 transform transition-transform duration-300
                  ${r?"rotate-180":""}`}),e.jsx("span",{className:"mt-1 font-medium leading-tight",children:"Más"})]})}),e.jsxs(k0,{side:"bottom",className:"rounded-t-2xl bg-white/95 backdrop-blur-md border-t border-gray-200 max-w-screen-sm mx-auto",children:[e.jsx(_0,{className:"mb-4",children:e.jsx(D0,{className:"text-center text-lg font-semibold text-gray-800",children:"Más opciones"})}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 p-2",children:d.map(m=>e.jsx(u,{icon:m.icon,label:m.label,path:m.path,onClick:m.path==="/logout"?o:void 0},m.path))})]})]})]})})})},XA=()=>{const{isMobile:t,isTablet:n}=xd(),s=t||n&&window.innerWidth<900;return e.jsx(e.Fragment,{children:s?e.jsx(JA,{}):e.jsx(UA,{})})},ZA=()=>{const{canInstall:t,promptInstall:n,isInstalled:s}=OD(),[r,i]=f.useState(!1),[o,c]=f.useState(!1);f.useEffect(()=>{if(t&&!s&&!o){const m=setTimeout(()=>{i(!0)},1e4);return()=>clearTimeout(m)}},[t,s,o]);const d=async()=>{await n()&&i(!1)},u=()=>{i(!1),c(!0),sessionStorage.setItem("pwa-install-dismissed","true")};return s||!t||!r||sessionStorage.getItem("pwa-install-dismissed")?null:e.jsx("div",{className:"fixed bottom-20 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-white rounded-lg shadow-lg border border-gray-200 p-4 z-50 animate-in slide-in-from-bottom-5",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Fn,{className:"w-5 h-5 text-blue-600"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:"Instalar Life Tracker"}),e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:"Instala la app para un acceso más rápido y funciones offline."}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx(F,{size:"sm",onClick:d,className:"text-xs px-3 py-1 h-auto",children:"Instalar"}),e.jsx(F,{variant:"ghost",size:"sm",onClick:u,className:"text-xs px-3 py-1 h-auto",children:"Ahora no"})]})]}),e.jsx(F,{variant:"ghost",size:"sm",onClick:u,className:"flex-shrink-0 p-1 h-auto w-auto",children:e.jsx(Js,{className:"w-4 h-4"})})]})})},QA=()=>{const[t,n]=f.useState(navigator.onLine),[s,r]=f.useState(!1),[i,o]=f.useState(!1);f.useEffect(()=>{const d=()=>{n(!0),r(!1)},u=()=>{n(!1),r(!0),setTimeout(()=>r(!1),5e3)},m=()=>{o(!0)};return window.addEventListener("online",d),window.addEventListener("offline",u),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",p=>{p.data&&p.data.type==="SKIP_WAITING"&&m()}),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",u)}},[]);const c=()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(d=>{d&&d.waiting&&(d.waiting.postMessage({type:"SKIP_WAITING"}),window.location.reload())})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed top-4 right-4 z-50",children:!t&&e.jsxs("div",{className:"flex items-center gap-1 bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs",children:[e.jsx(Hx,{className:"w-3 h-3"}),e.jsx("span",{children:"Offline"})]})}),s&&e.jsxs("div",{className:"fixed top-16 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-orange-50 border border-orange-200 rounded-lg p-3 z-50 animate-in slide-in-from-top-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hx,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"text-orange-800 text-sm font-medium",children:"Sin conexión"})]}),e.jsx("p",{className:"text-orange-700 text-xs mt-1",children:"Trabajando en modo offline. Los datos se sincronizarán cuando vuelvas a conectarte."})]}),i&&e.jsxs("div",{className:"fixed top-16 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-blue-50 border border-blue-200 rounded-lg p-3 z-50 animate-in slide-in-from-top-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(cd,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-blue-800 text-sm font-medium",children:"Actualización disponible"})]}),e.jsx("p",{className:"text-blue-700 text-xs mt-1",children:"Hay una nueva versión disponible."}),e.jsx(F,{size:"sm",onClick:c,className:"mt-2 text-xs px-3 py-1 h-auto",children:"Actualizar"})]})]})},e2=({children:t})=>{const{isMobile:n}=xd(),[s,r]=f.useState(0),[i,o]=f.useState(!1);return f.useEffect(()=>{if(!n)return;let c=0,d=0,u=!0;const m=g=>{c=g.touches[0].clientY,u=window.scrollY===0},p=g=>{if(!u)return;d=g.touches[0].clientY;const v=d-c;v>0&&v<150&&(o(!0),r(v),g.preventDefault())},x=()=>{i&&s>100&&window.location.reload(),o(!1),r(0)};return document.addEventListener("touchstart",m,{passive:!1}),document.addEventListener("touchmove",p,{passive:!1}),document.addEventListener("touchend",x),()=>{document.removeEventListener("touchstart",m),document.removeEventListener("touchmove",p),document.removeEventListener("touchend",x)}},[n,i,s]),n?e.jsxs("div",{className:"relative",children:[i&&e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-blue-500 text-white text-center py-2 text-sm transition-transform duration-200",style:{transform:`translateY(${Math.min(s-50,0)}px)`,opacity:s/100},children:s>100?"¡Suelta para actualizar!":"Tira hacia abajo para actualizar"}),t]}):e.jsx(e.Fragment,{children:t})};var lg=["light","dark"],t2="(prefers-color-scheme: dark)",s2=f.createContext(void 0),n2={setTheme:t=>{},themes:[]},r2=()=>{var t;return(t=f.useContext(s2))!=null?t:n2};f.memo(({forcedTheme:t,storageKey:n,attribute:s,enableSystem:r,enableColorScheme:i,defaultTheme:o,value:c,attrs:d,nonce:u})=>{let m=o==="system",p=s==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${d.map(j=>`'${j}'`).join(",")})`};`:`var d=document.documentElement,n='${s}',s='setAttribute';`,x=i?lg.includes(o)&&o?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${o}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",g=(j,b=!1,y=!0)=>{let N=c?c[j]:j,S=b?j+"|| ''":`'${N}'`,E="";return i&&y&&!b&&lg.includes(j)&&(E+=`d.style.colorScheme = '${j}';`),s==="class"?b||N?E+=`c.add(${S})`:E+="null":N&&(E+=`d[s](n,${S})`),E},v=t?`!function(){${p}${g(t)}}()`:r?`!function(){try{${p}var e=localStorage.getItem('${n}');if('system'===e||(!e&&${m})){var t='${t2}',m=window.matchMedia(t);if(m.media!==t||m.matches){${g("dark")}}else{${g("light")}}}else if(e){${c?`var x=${JSON.stringify(c)};`:""}${g(c?"x[e]":"e",!0)}}${m?"":"else{"+g(o,!1,!1)+"}"}${x}}catch(e){}}()`:`!function(){try{${p}var e=localStorage.getItem('${n}');if(e){${c?`var x=${JSON.stringify(c)};`:""}${g(c?"x[e]":"e",!0)}}else{${g(o,!1,!1)};}${x}}catch(t){}}();`;return f.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:v}})});var a2=t=>{switch(t){case"success":return l2;case"info":return d2;case"warning":return c2;case"error":return u2;default:return null}},i2=Array(12).fill(0),o2=({visible:t,className:n})=>ne.createElement("div",{className:["sonner-loading-wrapper",n].filter(Boolean).join(" "),"data-visible":t},ne.createElement("div",{className:"sonner-spinner"},i2.map((s,r)=>ne.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),l2=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ne.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),c2=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ne.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),d2=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ne.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),u2=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ne.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),m2=ne.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ne.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ne.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),f2=()=>{let[t,n]=ne.useState(document.hidden);return ne.useEffect(()=>{let s=()=>{n(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),t},Lm=1,p2=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;let{message:s,...r}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:Lm++,o=this.toasts.find(d=>d.id===i),c=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(d=>d.id===i?(this.publish({...d,...t,id:i,title:s}),{...d,...t,id:i,dismissible:c,title:s}):d):this.addToast({title:s,...r,dismissible:c,id:i}),i},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(n=>{this.subscribers.forEach(s=>s({id:n.id,dismiss:!0}))}),this.subscribers.forEach(n=>n({id:t,dismiss:!0})),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let s;n.loading!==void 0&&(s=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));let r=t instanceof Promise?t:t(),i=s!==void 0,o,c=r.then(async u=>{if(o=["resolve",u],ne.isValidElement(u))i=!1,this.create({id:s,type:"default",message:u});else if(x2(u)&&!u.ok){i=!1;let m=typeof n.error=="function"?await n.error(`HTTP error! status: ${u.status}`):n.error,p=typeof n.description=="function"?await n.description(`HTTP error! status: ${u.status}`):n.description;this.create({id:s,type:"error",message:m,description:p})}else if(n.success!==void 0){i=!1;let m=typeof n.success=="function"?await n.success(u):n.success,p=typeof n.description=="function"?await n.description(u):n.description;this.create({id:s,type:"success",message:m,description:p})}}).catch(async u=>{if(o=["reject",u],n.error!==void 0){i=!1;let m=typeof n.error=="function"?await n.error(u):n.error,p=typeof n.description=="function"?await n.description(u):n.description;this.create({id:s,type:"error",message:m,description:p})}}).finally(()=>{var u;i&&(this.dismiss(s),s=void 0),(u=n.finally)==null||u.call(n)}),d=()=>new Promise((u,m)=>c.then(()=>o[0]==="reject"?m(o[1]):u(o[1])).catch(m));return typeof s!="string"&&typeof s!="number"?{unwrap:d}:Object.assign(s,{unwrap:d})},this.custom=(t,n)=>{let s=(n==null?void 0:n.id)||Lm++;return this.create({jsx:t(s),id:s,...n}),s},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},cn=new p2,h2=(t,n)=>{let s=(n==null?void 0:n.id)||Lm++;return cn.addToast({title:t,...n,id:s}),s},x2=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",g2=h2,v2=()=>cn.toasts,y2=()=>cn.getActiveToasts(),kt=Object.assign(g2,{success:cn.success,info:cn.info,warning:cn.warning,error:cn.error,custom:cn.custom,message:cn.message,promise:cn.promise,dismiss:cn.dismiss,loading:cn.loading},{getHistory:v2,getToasts:y2});function b2(t,{insertAt:n}={}){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n==="top"&&s.firstChild?s.insertBefore(r,s.firstChild):s.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}b2(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Ec(t){return t.label!==void 0}var j2=3,w2="32px",N2="16px",cg=4e3,S2=356,C2=14,E2=20,T2=200;function Kn(...t){return t.filter(Boolean).join(" ")}function k2(t){let[n,s]=t.split("-"),r=[];return n&&r.push(n),s&&r.push(s),r}var _2=t=>{var n,s,r,i,o,c,d,u,m,p,x;let{invert:g,toast:v,unstyled:j,interacting:b,setHeights:y,visibleToasts:N,heights:S,index:E,toasts:T,expanded:k,removeToast:M,defaultRichColors:R,closeButton:I,style:O,cancelButtonStyle:H,actionButtonStyle:$,className:D="",descriptionClassName:P="",duration:K,position:X,gap:G,loadingIcon:U,expandByDefault:Y,classNames:ae,icons:ye,closeButtonAriaLabel:oe="Close toast",pauseWhenPageIsHidden:me}=t,[W,se]=ne.useState(null),[ge,Me]=ne.useState(null),[pe,_e]=ne.useState(!1),[We,Pe]=ne.useState(!1),[Le,le]=ne.useState(!1),[Re,Ke]=ne.useState(!1),[Yt,bs]=ne.useState(!1),[Dt,z]=ne.useState(0),[Z,ee]=ne.useState(0),he=ne.useRef(v.duration||K||cg),ve=ne.useRef(null),ue=ne.useRef(null),Ce=E===0,Ue=E+1<=N,Ze=v.type,it=v.dismissible!==!1,fs=v.className||"",pr=v.descriptionClassName||"",Rs=ne.useMemo(()=>S.findIndex(Ee=>Ee.toastId===v.id)||0,[S,v.id]),Sn=ne.useMemo(()=>{var Ee;return(Ee=v.closeButton)!=null?Ee:I},[v.closeButton,I]),fn=ne.useMemo(()=>v.duration||K||cg,[v.duration,K]),Ws=ne.useRef(0),Xt=ne.useRef(0),Ps=ne.useRef(0),tn=ne.useRef(null),[Ir,so]=X.split("-"),Or=ne.useMemo(()=>S.reduce((Ee,tt,Ct)=>Ct>=Rs?Ee:Ee+tt.height,0),[S,Rs]),Mr=f2(),mi=v.invert||g,Cn=Ze==="loading";Xt.current=ne.useMemo(()=>Rs*G+Or,[Rs,Or]),ne.useEffect(()=>{he.current=fn},[fn]),ne.useEffect(()=>{_e(!0)},[]),ne.useEffect(()=>{let Ee=ue.current;if(Ee){let tt=Ee.getBoundingClientRect().height;return ee(tt),y(Ct=>[{toastId:v.id,height:tt,position:v.position},...Ct]),()=>y(Ct=>Ct.filter(Is=>Is.toastId!==v.id))}},[y,v.id]),ne.useLayoutEffect(()=>{if(!pe)return;let Ee=ue.current,tt=Ee.style.height;Ee.style.height="auto";let Ct=Ee.getBoundingClientRect().height;Ee.style.height=tt,ee(Ct),y(Is=>Is.find(Cs=>Cs.toastId===v.id)?Is.map(Cs=>Cs.toastId===v.id?{...Cs,height:Ct}:Cs):[{toastId:v.id,height:Ct,position:v.position},...Is])},[pe,v.title,v.description,y,v.id]);let En=ne.useCallback(()=>{Pe(!0),z(Xt.current),y(Ee=>Ee.filter(tt=>tt.toastId!==v.id)),setTimeout(()=>{M(v)},T2)},[v,M,y,Xt]);ne.useEffect(()=>{if(v.promise&&Ze==="loading"||v.duration===1/0||v.type==="loading")return;let Ee;return k||b||me&&Mr?(()=>{if(Ps.current<Ws.current){let tt=new Date().getTime()-Ws.current;he.current=he.current-tt}Ps.current=new Date().getTime()})():he.current!==1/0&&(Ws.current=new Date().getTime(),Ee=setTimeout(()=>{var tt;(tt=v.onAutoClose)==null||tt.call(v,v),En()},he.current)),()=>clearTimeout(Ee)},[k,b,v,Ze,me,Mr,En]),ne.useEffect(()=>{v.delete&&En()},[En,v.delete]);function no(){var Ee,tt,Ct;return ye!=null&&ye.loading?ne.createElement("div",{className:Kn(ae==null?void 0:ae.loader,(Ee=v==null?void 0:v.classNames)==null?void 0:Ee.loader,"sonner-loader"),"data-visible":Ze==="loading"},ye.loading):U?ne.createElement("div",{className:Kn(ae==null?void 0:ae.loader,(tt=v==null?void 0:v.classNames)==null?void 0:tt.loader,"sonner-loader"),"data-visible":Ze==="loading"},U):ne.createElement(o2,{className:Kn(ae==null?void 0:ae.loader,(Ct=v==null?void 0:v.classNames)==null?void 0:Ct.loader),visible:Ze==="loading"})}return ne.createElement("li",{tabIndex:0,ref:ue,className:Kn(D,fs,ae==null?void 0:ae.toast,(n=v==null?void 0:v.classNames)==null?void 0:n.toast,ae==null?void 0:ae.default,ae==null?void 0:ae[Ze],(s=v==null?void 0:v.classNames)==null?void 0:s[Ze]),"data-sonner-toast":"","data-rich-colors":(r=v.richColors)!=null?r:R,"data-styled":!(v.jsx||v.unstyled||j),"data-mounted":pe,"data-promise":!!v.promise,"data-swiped":Yt,"data-removed":We,"data-visible":Ue,"data-y-position":Ir,"data-x-position":so,"data-index":E,"data-front":Ce,"data-swiping":Le,"data-dismissible":it,"data-type":Ze,"data-invert":mi,"data-swipe-out":Re,"data-swipe-direction":ge,"data-expanded":!!(k||Y&&pe),style:{"--index":E,"--toasts-before":E,"--z-index":T.length-E,"--offset":`${We?Dt:Xt.current}px`,"--initial-height":Y?"auto":`${Z}px`,...O,...v.style},onDragEnd:()=>{le(!1),se(null),tn.current=null},onPointerDown:Ee=>{Cn||!it||(ve.current=new Date,z(Xt.current),Ee.target.setPointerCapture(Ee.pointerId),Ee.target.tagName!=="BUTTON"&&(le(!0),tn.current={x:Ee.clientX,y:Ee.clientY}))},onPointerUp:()=>{var Ee,tt,Ct,Is;if(Re||!it)return;tn.current=null;let Cs=Number(((Ee=ue.current)==null?void 0:Ee.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),pn=Number(((tt=ue.current)==null?void 0:tt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),sn=new Date().getTime()-((Ct=ve.current)==null?void 0:Ct.getTime()),Hs=W==="x"?Cs:pn,Kt=Math.abs(Hs)/sn;if(Math.abs(Hs)>=E2||Kt>.11){z(Xt.current),(Is=v.onDismiss)==null||Is.call(v,v),Me(W==="x"?Cs>0?"right":"left":pn>0?"down":"up"),En(),Ke(!0),bs(!1);return}le(!1),se(null)},onPointerMove:Ee=>{var tt,Ct,Is,Cs;if(!tn.current||!it||((tt=window.getSelection())==null?void 0:tt.toString().length)>0)return;let pn=Ee.clientY-tn.current.y,sn=Ee.clientX-tn.current.x,Hs=(Ct=t.swipeDirections)!=null?Ct:k2(X);!W&&(Math.abs(sn)>1||Math.abs(pn)>1)&&se(Math.abs(sn)>Math.abs(pn)?"x":"y");let Kt={x:0,y:0};W==="y"?(Hs.includes("top")||Hs.includes("bottom"))&&(Hs.includes("top")&&pn<0||Hs.includes("bottom")&&pn>0)&&(Kt.y=pn):W==="x"&&(Hs.includes("left")||Hs.includes("right"))&&(Hs.includes("left")&&sn<0||Hs.includes("right")&&sn>0)&&(Kt.x=sn),(Math.abs(Kt.x)>0||Math.abs(Kt.y)>0)&&bs(!0),(Is=ue.current)==null||Is.style.setProperty("--swipe-amount-x",`${Kt.x}px`),(Cs=ue.current)==null||Cs.style.setProperty("--swipe-amount-y",`${Kt.y}px`)}},Sn&&!v.jsx?ne.createElement("button",{"aria-label":oe,"data-disabled":Cn,"data-close-button":!0,onClick:Cn||!it?()=>{}:()=>{var Ee;En(),(Ee=v.onDismiss)==null||Ee.call(v,v)},className:Kn(ae==null?void 0:ae.closeButton,(i=v==null?void 0:v.classNames)==null?void 0:i.closeButton)},(o=ye==null?void 0:ye.close)!=null?o:m2):null,v.jsx||f.isValidElement(v.title)?v.jsx?v.jsx:typeof v.title=="function"?v.title():v.title:ne.createElement(ne.Fragment,null,Ze||v.icon||v.promise?ne.createElement("div",{"data-icon":"",className:Kn(ae==null?void 0:ae.icon,(c=v==null?void 0:v.classNames)==null?void 0:c.icon)},v.promise||v.type==="loading"&&!v.icon?v.icon||no():null,v.type!=="loading"?v.icon||(ye==null?void 0:ye[Ze])||a2(Ze):null):null,ne.createElement("div",{"data-content":"",className:Kn(ae==null?void 0:ae.content,(d=v==null?void 0:v.classNames)==null?void 0:d.content)},ne.createElement("div",{"data-title":"",className:Kn(ae==null?void 0:ae.title,(u=v==null?void 0:v.classNames)==null?void 0:u.title)},typeof v.title=="function"?v.title():v.title),v.description?ne.createElement("div",{"data-description":"",className:Kn(P,pr,ae==null?void 0:ae.description,(m=v==null?void 0:v.classNames)==null?void 0:m.description)},typeof v.description=="function"?v.description():v.description):null),f.isValidElement(v.cancel)?v.cancel:v.cancel&&Ec(v.cancel)?ne.createElement("button",{"data-button":!0,"data-cancel":!0,style:v.cancelButtonStyle||H,onClick:Ee=>{var tt,Ct;Ec(v.cancel)&&it&&((Ct=(tt=v.cancel).onClick)==null||Ct.call(tt,Ee),En())},className:Kn(ae==null?void 0:ae.cancelButton,(p=v==null?void 0:v.classNames)==null?void 0:p.cancelButton)},v.cancel.label):null,f.isValidElement(v.action)?v.action:v.action&&Ec(v.action)?ne.createElement("button",{"data-button":!0,"data-action":!0,style:v.actionButtonStyle||$,onClick:Ee=>{var tt,Ct;Ec(v.action)&&((Ct=(tt=v.action).onClick)==null||Ct.call(tt,Ee),!Ee.defaultPrevented&&En())},className:Kn(ae==null?void 0:ae.actionButton,(x=v==null?void 0:v.classNames)==null?void 0:x.actionButton)},v.action.label):null))};function dg(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function D2(t,n){let s={};return[t,n].forEach((r,i)=>{let o=i===1,c=o?"--mobile-offset":"--offset",d=o?N2:w2;function u(m){["top","right","bottom","left"].forEach(p=>{s[`${c}-${p}`]=typeof m=="number"?`${m}px`:m})}typeof r=="number"||typeof r=="string"?u(r):typeof r=="object"?["top","right","bottom","left"].forEach(m=>{r[m]===void 0?s[`${c}-${m}`]=d:s[`${c}-${m}`]=typeof r[m]=="number"?`${r[m]}px`:r[m]}):u(d)}),s}var A2=f.forwardRef(function(t,n){let{invert:s,position:r="bottom-right",hotkey:i=["altKey","KeyT"],expand:o,closeButton:c,className:d,offset:u,mobileOffset:m,theme:p="light",richColors:x,duration:g,style:v,visibleToasts:j=j2,toastOptions:b,dir:y=dg(),gap:N=C2,loadingIcon:S,icons:E,containerAriaLabel:T="Notifications",pauseWhenPageIsHidden:k}=t,[M,R]=ne.useState([]),I=ne.useMemo(()=>Array.from(new Set([r].concat(M.filter(me=>me.position).map(me=>me.position)))),[M,r]),[O,H]=ne.useState([]),[$,D]=ne.useState(!1),[P,K]=ne.useState(!1),[X,G]=ne.useState(p!=="system"?p:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=ne.useRef(null),Y=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),ae=ne.useRef(null),ye=ne.useRef(!1),oe=ne.useCallback(me=>{R(W=>{var se;return(se=W.find(ge=>ge.id===me.id))!=null&&se.delete||cn.dismiss(me.id),W.filter(({id:ge})=>ge!==me.id)})},[]);return ne.useEffect(()=>cn.subscribe(me=>{if(me.dismiss){R(W=>W.map(se=>se.id===me.id?{...se,delete:!0}:se));return}setTimeout(()=>{wk.flushSync(()=>{R(W=>{let se=W.findIndex(ge=>ge.id===me.id);return se!==-1?[...W.slice(0,se),{...W[se],...me},...W.slice(se+1)]:[me,...W]})})})}),[]),ne.useEffect(()=>{if(p!=="system"){G(p);return}if(p==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?G("dark"):G("light")),typeof window>"u")return;let me=window.matchMedia("(prefers-color-scheme: dark)");try{me.addEventListener("change",({matches:W})=>{G(W?"dark":"light")})}catch{me.addListener(({matches:se})=>{try{G(se?"dark":"light")}catch(ge){console.error(ge)}})}},[p]),ne.useEffect(()=>{M.length<=1&&D(!1)},[M]),ne.useEffect(()=>{let me=W=>{var se,ge;i.every(Me=>W[Me]||W.code===Me)&&(D(!0),(se=U.current)==null||se.focus()),W.code==="Escape"&&(document.activeElement===U.current||(ge=U.current)!=null&&ge.contains(document.activeElement))&&D(!1)};return document.addEventListener("keydown",me),()=>document.removeEventListener("keydown",me)},[i]),ne.useEffect(()=>{if(U.current)return()=>{ae.current&&(ae.current.focus({preventScroll:!0}),ae.current=null,ye.current=!1)}},[U.current]),ne.createElement("section",{ref:n,"aria-label":`${T} ${Y}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},I.map((me,W)=>{var se;let[ge,Me]=me.split("-");return M.length?ne.createElement("ol",{key:me,dir:y==="auto"?dg():y,tabIndex:-1,ref:U,className:d,"data-sonner-toaster":!0,"data-theme":X,"data-y-position":ge,"data-lifted":$&&M.length>1&&!o,"data-x-position":Me,style:{"--front-toast-height":`${((se=O[0])==null?void 0:se.height)||0}px`,"--width":`${S2}px`,"--gap":`${N}px`,...v,...D2(u,m)},onBlur:pe=>{ye.current&&!pe.currentTarget.contains(pe.relatedTarget)&&(ye.current=!1,ae.current&&(ae.current.focus({preventScroll:!0}),ae.current=null))},onFocus:pe=>{pe.target instanceof HTMLElement&&pe.target.dataset.dismissible==="false"||ye.current||(ye.current=!0,ae.current=pe.relatedTarget)},onMouseEnter:()=>D(!0),onMouseMove:()=>D(!0),onMouseLeave:()=>{P||D(!1)},onDragEnd:()=>D(!1),onPointerDown:pe=>{pe.target instanceof HTMLElement&&pe.target.dataset.dismissible==="false"||K(!0)},onPointerUp:()=>K(!1)},M.filter(pe=>!pe.position&&W===0||pe.position===me).map((pe,_e)=>{var We,Pe;return ne.createElement(_2,{key:pe.id,icons:E,index:_e,toast:pe,defaultRichColors:x,duration:(We=b==null?void 0:b.duration)!=null?We:g,className:b==null?void 0:b.className,descriptionClassName:b==null?void 0:b.descriptionClassName,invert:s,visibleToasts:j,closeButton:(Pe=b==null?void 0:b.closeButton)!=null?Pe:c,interacting:P,position:me,style:b==null?void 0:b.style,unstyled:b==null?void 0:b.unstyled,classNames:b==null?void 0:b.classNames,cancelButtonStyle:b==null?void 0:b.cancelButtonStyle,actionButtonStyle:b==null?void 0:b.actionButtonStyle,removeToast:oe,toasts:M.filter(Le=>Le.position==pe.position),heights:O.filter(Le=>Le.position==pe.position),setHeights:H,expandByDefault:o,gap:N,loadingIcon:S,expanded:$,pauseWhenPageIsHidden:k,swipeDirections:t.swipeDirections})})):null}))});const R2=({...t})=>{const{theme:n="system"}=r2();return e.jsx(A2,{theme:n,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},P2=()=>e.jsx(e2,{children:e.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden",children:[e.jsx(XA,{}),e.jsxs("div",{className:"flex-1 flex flex-col main-content-adaptive overflow-hidden",children:[e.jsx("div",{className:"pt-0 flex-1 flex flex-col overflow-hidden",children:e.jsx("main",{className:"flex-1 overflow-auto scroll-container",children:e.jsx(yD,{})})}),e.jsx("div",{className:"pb-16 md:pb-0"})]}),e.jsx(QA,{}),e.jsx(ZA,{}),e.jsx(R2,{})]})}),je=f.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:ce("rounded-lg border bg-card text-card-foreground shadow-sm overflow-hidden",t),...n}));je.displayName="Card";const Mt=f.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:ce("flex flex-col space-y-1.5 p-4 md:p-6",t),...n}));Mt.displayName="CardHeader";const Lt=f.forwardRef(({className:t,...n},s)=>e.jsx("h3",{ref:s,className:ce("text-lg md:text-2xl font-semibold leading-none tracking-tight",t),...n}));Lt.displayName="CardTitle";const A0=f.forwardRef(({className:t,...n},s)=>e.jsx("p",{ref:s,className:ce("text-sm md:text-base text-muted-foreground",t),...n}));A0.displayName="CardDescription";const we=f.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:ce("p-4 md:p-6 pt-0",t),...n}));we.displayName="CardContent";const Xs=f.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:ce("flex items-center p-4 md:p-6 pt-0",t),...n}));Xs.displayName="CardFooter";const I2={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},O2=(t,n,s)=>{let r;const i=I2[t];return typeof i=="string"?r=i:n===1?r=i.one:r=i.other.replace("{{count}}",n.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"en "+r:"hace "+r:r},M2={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},L2={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},$2={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},z2={date:Zu({formats:M2,defaultWidth:"full"}),time:Zu({formats:L2,defaultWidth:"full"}),dateTime:Zu({formats:$2,defaultWidth:"full"})},F2={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},B2={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},W2=(t,n,s,r)=>n.getHours()!==1?B2[t]:F2[t],H2={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},U2={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},V2={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},G2={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},q2={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},Y2={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},K2=(t,n)=>Number(t)+"º",J2={ordinalNumber:K2,era:So({values:H2,defaultWidth:"wide"}),quarter:So({values:U2,defaultWidth:"wide",argumentCallback:t=>Number(t)-1}),month:So({values:V2,defaultWidth:"wide"}),day:So({values:G2,defaultWidth:"wide"}),dayPeriod:So({values:q2,defaultWidth:"wide",formattingValues:Y2,defaultFormattingWidth:"wide"})},X2=/^(\d+)(º)?/i,Z2=/\d+/i,Q2={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},eR={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},tR={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},sR={any:[/1/i,/2/i,/3/i,/4/i]},nR={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},rR={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},aR={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},iR={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},oR={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},lR={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},cR={ordinalNumber:Sk({matchPattern:X2,parsePattern:Z2,valueCallback:function(t){return parseInt(t,10)}}),era:Co({matchPatterns:Q2,defaultMatchWidth:"wide",parsePatterns:eR,defaultParseWidth:"any"}),quarter:Co({matchPatterns:tR,defaultMatchWidth:"wide",parsePatterns:sR,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Co({matchPatterns:nR,defaultMatchWidth:"wide",parsePatterns:rR,defaultParseWidth:"any"}),day:Co({matchPatterns:aR,defaultMatchWidth:"wide",parsePatterns:iR,defaultParseWidth:"any"}),dayPeriod:Co({matchPatterns:oR,defaultMatchWidth:"any",parsePatterns:lR,defaultParseWidth:"any"})},Ln={code:"es",formatDistance:O2,formatLong:z2,formatRelative:W2,localize:J2,match:cR,options:{weekStartsOn:1,firstWeekContainsDate:1}},Oe=(t=new Date)=>{const n=new Date(t.getTime());return n.setHours(0,0,0,0),n.toISOString().split("T")[0]},ti=t=>{const n=new Date(t);return n.setHours(12,0,0,0),n},Ef=t=>{const n=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],s=t.getDate(),r=n[t.getMonth()],i=t.getFullYear();let o=t.getHours();const c=t.getMinutes().toString().padStart(2,"0"),d=t.getSeconds().toString().padStart(2,"0"),u=o>=12?"p.m.":"a.m.";o=o%12,o=o||12;const m=-t.getTimezoneOffset(),p=Math.abs(Math.floor(m/60)),x=m>=0?"+":"-";return`${s} de ${r} de ${i}, ${o}:${c}:${d} ${u} UTC${x}${p}`},ks=(t,n,s)=>{const r=new Date(t);return r.setHours(n,s,0,0),{timestamp:r.getTime(),utcOffset:-r.getTimezoneOffset(),formatted:Ef(r)}},dR=(t=new Date,n="daily",s=1)=>{const r=ys(t);switch(n){case"daily":return Vt(r,1);case"weekly":return Yo(r,1);case"monthly":return ar(r,1);case"custom":return Vt(r,s);default:return r}},R0=(t,n,s)=>{const r=Pt(t,"'próximo' EEEE",{locale:Ln});switch(n){case"daily":return`Diariamente (${r})`;case"weekly":return`Semanalmente (${r})`;case"monthly":return`Mensualmente (${Pt(t,"'próximo' d 'de' MMMM",{locale:Ln})})`;case"custom":return`Cada ${s} día${s!==1?"s":""} (${r})`;default:return""}},$m=t=>{const n=t.getTimezoneOffset();return new Date(t.getTime()-n*60*1e3).toISOString().split("T")[0]},uR=t=>Pt(t,"EEEE, d 'de' MMMM 'de' yyyy",{locale:Ln}),mR=t=>Array.from({length:12},(n,s)=>({name:new Date(t,s).toLocaleString("es",{month:"short"}),days:new Date(t,s+1,0).getDate(),number:s+1})),Tc=crypto.randomUUID(),qr=30*60,fR=({onComplete:t,onCancel:n,selectedDate:s})=>{const{user:r}=He(),[i,o]=f.useState(qr),[c,d]=f.useState(!1),[u,m]=f.useState(null),[p,x]=f.useState(!1),g=f.useRef(),v=f.useRef(!1),j=Oe(s||new Date),b=f.useCallback(()=>{g.current&&(cancelAnimationFrame(g.current),g.current=void 0)},[]),y=f.useCallback(()=>{v.current||(v.current=!0,b(),o(qr),d(!1),m(null),x(!1),setTimeout(()=>{v.current=!1},100))},[b]),N=f.useCallback(k=>{const M=(Date.now()-k)/1e3;return Math.max(0,qr-M)},[]);f.useEffect(()=>{if(!c||!u||p){b();return}const k=u.startTime.timestamp,M=()=>{const R=(Date.now()-k)/1e3,I=Math.max(0,qr-R);if(I<=0){b(),u.deviceId===Tc&&t(qr),y();return}o(I),g.current=requestAnimationFrame(M)};return g.current=requestAnimationFrame(M),b},[c,u,p,b,y,t,N]),f.useEffect(()=>{if(!r)return;const k=be(fe,"pomodoro",`${r.uid}_${j}`),M=ns(k,R=>{if(!R.exists()){y();return}const O=R.data().activePomodoro;if(!O||p){y();return}if(O.deviceId!==Tc&&!c)return;const H=N(O.startTime.timestamp);if(H<=0){ht(k,{activePomodoro:null},{merge:!0}),O.deviceId===Tc&&t(qr),y();return}m(O),o(H),d(!0)});return()=>{M(),b()}},[r,j,c,p,N,b,y,t]);const S=f.useCallback(async()=>{if(!r||c)return;const k=new Date,R={startTime:ks(s||k,k.getHours(),k.getMinutes()),duration:qr,deviceId:Tc};m(R),o(qr),d(!0),x(!1);try{const I=be(fe,"pomodoro",`${r.uid}_${j}`);await ht(I,{userId:r.uid,date:j,activePomodoro:R,updatedAt:lt()},{merge:!0})}catch(I){console.error("Error starting timer:",I),y()}},[r,j,c,s,y]),E=f.useCallback(async()=>{if(!(!r||!u||p))try{x(!0);const k=be(fe,"pomodoro",`${r.uid}_${j}`);await ht(k,{activePomodoro:null,updatedAt:lt()},{merge:!0});const M=qr-i;M>0&&n(M),y()}catch(k){console.error("Error stopping timer:",k),x(!1)}},[r,j,u,p,i,n,y]);return{time:i,isActive:c,formattedTime:(k=>{const M=Math.floor(k/60),R=Math.floor(k%60);return`${M<10?"0":""}${M}:${R<10?"0":""}${R}`})(i),startTimer:S,stopTimer:E}},Rr=t=>f.useCallback(async()=>{await Uk(fe),await Vk(fe)},[t]),si=class si{constructor(){Nt(this,"operations",[]);Nt(this,"isEnabled");this.isEnabled=!1}static getInstance(){return si.instance||(si.instance=new si),si.instance}logRead(n,s,r){if(!this.isEnabled)return;const i={type:"read",collection:n,documentId:r,timestamp:new Date,source:s};this.operations.push(i),console.log(`🔍 [Firestore Read] ${n}${r?`/${r}`:""} from ${s}`,i)}logWrite(n,s,r){if(!this.isEnabled)return;const i={type:"write",collection:n,documentId:r,timestamp:new Date,source:s};this.operations.push(i),console.log(`✏️ [Firestore Write] ${n}${r?`/${r}`:""} from ${s}`,i)}logDelete(n,s,r){if(!this.isEnabled)return;const i={type:"delete",collection:n,documentId:r,timestamp:new Date,source:s};this.operations.push(i),console.log(`🗑️ [Firestore Delete] ${n}${r?`/${r}`:""} from ${s}`,i)}getOperations(){return[...this.operations]}getOperationsBySource(n){return this.operations.filter(s=>s.source===n)}getOperationsByCollection(n){return this.operations.filter(s=>s.collection===n)}getOperationsSummary(){const n={};return this.operations.forEach(s=>{const r=`${s.type}-${s.collection}`;n[r]=(n[r]||0)+1}),n}logSummary(){if(!this.isEnabled)return;const n=this.getOperationsSummary();console.group("📊 Firestore Operations Summary"),Object.entries(n).forEach(([s,r])=>{console.log(`${s}: ${r} operations`)}),console.groupEnd()}clear(){this.operations=[]}};Nt(si,"instance");let zm=si;const Gt=zm.getInstance(),pR=t=>{const[n,s]=f.useState(null),[r,i]=f.useState("idle"),[o,c]=f.useState(null),{user:d}=He(),u=Oe(t||new Date),m=async()=>{if(d)try{Gt.logRead("pomodoro","usePomodoroData.loadData",`${d.uid}_${u}`);const b=be(fe,"pomodoro",`${d.uid}_${u}`),y=await ds(b);if(y.exists()){const N=y.data(),S=Array.isArray(N.sessions)?N.sessions:[],E=S.filter(T=>T.completed).length;s({...N,sessions:S,count:E}),i("saved")}else s({userId:d.uid,date:u,count:0,sessions:[],updatedAt:null}),i("idle")}catch(b){console.error("Pomodoro - Error loading data:",b),c(b instanceof Error?b.message:"Error loading pomodoro data"),i("error")}};f.useEffect(()=>{m()},[d,u]);const p=async(b={})=>{var y;if(!(!d||!n)){i("saving"),c(null);try{const N=t||new Date,S=new Date,E=ks(N,S.getHours(),S.getMinutes()),T=new Date(S.getTime()-30*60*1e3),k=ks(N,T.getHours(),T.getMinutes()),M={startTime:{timestamp:k.timestamp,utcOffset:k.utcOffset,formatted:k.formatted},endTime:{timestamp:E.timestamp,utcOffset:E.utcOffset,formatted:E.formatted},duration:30*60,completed:!0};(y=b.description)!=null&&y.trim()&&(M.description=b.description.trim());const R=[...n.sessions,M].sort((D,P)=>P.startTime.timestamp-D.startTime.timestamp),{activePomodoro:I,...O}=n,H={...O,count:R.filter(D=>D.completed).length,sessions:R,updatedAt:lt()},$=be(fe,"pomodoro",`${d.uid}_${u}`);Gt.logWrite("pomodoro","usePomodoroData.addManualSession",`${d.uid}_${u}`),await ht($,H),await m()}catch(N){console.error("Pomodoro - Error al agregar sesión manual:",N),c(N instanceof Error?N.message:"Error al guardar"),i("error")}}},x=async(b,y,N={})=>{var S;if(!(!d||!n)){i("saving"),c(null);try{const E=t||new Date,T=new Date,k=ks(E,T.getHours(),T.getMinutes()),M=new Date(T.getTime()-b*1e3),R=ks(E,M.getHours(),M.getMinutes()),I={startTime:{timestamp:R.timestamp,utcOffset:R.utcOffset,formatted:R.formatted},endTime:{timestamp:k.timestamp,utcOffset:k.utcOffset,formatted:k.formatted},duration:b,completed:y};(S=N.description)!=null&&S.trim()&&(I.description=N.description.trim());const O=[...n.sessions,I],H=O.filter(X=>X.completed).length,{activePomodoro:$,...D}=n,P={...D,count:H,sessions:O,updatedAt:lt()},K=be(fe,"pomodoro",`${d.uid}_${u}`);Gt.logWrite("pomodoro","usePomodoroData.saveSession",`${d.uid}_${u}`),await ht(K,P),await m()}catch(E){console.error("Pomodoro - Error al guardar:",E),c(E instanceof Error?E.message:"Error al guardar"),i("error")}}},g=async b=>{if(!(!d||!n)){i("saving"),c(null);try{const y=n.sessions.filter(k=>k.startTime.timestamp!==b.startTime.timestamp),{activePomodoro:N,...S}=n,E={...S,count:y.filter(k=>k.completed).length,sessions:y,updatedAt:lt()},T=be(fe,"pomodoro",`${d.uid}_${u}`);await ht(T,E)}catch(y){console.error("Pomodoro - Error al eliminar sesión:",y),c(y instanceof Error?y.message:"Error al eliminar"),i("error")}}},v=async(b,y)=>{if(!(!d||!n)){i("saving"),c(null);try{const N=new Date(b.startTime.timestamp);let S=b.startTime,E=b.endTime;if(y.startTime){const I=new Date(y.startTime.timestamp),O=ks(N,I.getHours(),I.getMinutes());S={timestamp:O.timestamp,utcOffset:O.utcOffset,formatted:O.formatted}}if(y.endTime){const I=new Date(y.endTime.timestamp),O=ks(N,I.getHours(),I.getMinutes());E={timestamp:O.timestamp,utcOffset:O.utcOffset,formatted:O.formatted}}const T=(E.timestamp-S.timestamp)/1e3,k=n.sessions.map(I=>{var O;return I.startTime.timestamp===b.startTime.timestamp?{...I,startTime:S,endTime:E,duration:T,completed:y.completed??I.completed,...(O=y.description)!=null&&O.trim()?{description:y.description.trim()}:{}}:I}),M={...n,count:k.filter(I=>I.completed).length,sessions:k,updatedAt:lt()},R=be(fe,"pomodoro",`${d.uid}_${u}`);await ht(R,M)}catch(N){console.error("Pomodoro - Error al editar sesión:",N),c(N instanceof Error?N.message:"Error al editar"),i("error")}}},j=Rr("Pomodoro data");return{count:(n==null?void 0:n.count)??0,sessions:(n==null?void 0:n.sessions)??[],status:r,error:o,saveSession:x,deleteSession:g,editSession:v,addManualSession:p,loadPomodoroData:m,resync:j}},hR=(t="week")=>{const[n,s]=f.useState(null),[r,i]=f.useState(!0),[o,c]=f.useState(null),{user:d}=He();return f.useEffect(()=>{(async()=>{if(!d){i(!1);return}try{i(!0),c(null);const m=wr(new Date),p=ys(t==="week"?Fo(m,7):Lo(m,1)),x=Ck({start:p,end:m}),g=[],v={};if((await Promise.allSettled(x.map(async T=>{const k=Oe(T),M=be(fe,"pomodoro",`${d.uid}_${k}`);try{const R=await ds(M);if(R.exists()){const I=R.data();return{dateStr:k,data:I}}}catch(R){console.error("PomodoroStats - Error fetching doc:",R)}return null}))).forEach(T=>{if(T.status==="fulfilled"&&T.value){const{dateStr:k,data:M}=T.value;g.push(...M.sessions);const I=M.sessions.filter(O=>O.completed).reduce((O,H)=>O+H.duration,0)/60;v[k]=I}}),g.length===0){s({totalSessions:0,totalTime:0,averageSessionTime:0,completionRate:0,...t==="week"&&{averageWeekdayHours:0}}),i(!1);return}const b=Object.entries(v).reduce((T,[k,M])=>M>T[1]?[k,M]:T,["",0]),y=g.filter(T=>T.completed),N=g.reduce((T,k)=>T+k.duration,0);let S;if(t==="week"){const T=Object.entries(v).filter(([R])=>{const I=new Date(R).getDay();return I!==0&&I!==6}),k=T.reduce((R,[,I])=>R+I,0),M=T.length;S=M>0?k/60/M:0}const E={totalSessions:g.length,totalTime:N,averageSessionTime:N/g.length,completionRate:y.length/g.length*100,...S!==void 0&&{averageWeekdayHours:S},...b[1]>0&&{bestDay:{date:Pt(new Date(b[0]),"dd/MM/yyyy"),minutes:b[1]}}};s(E)}catch(m){console.error("Error fetching pomodoro stats:",m),c(m instanceof Error?m.message:"Error al cargar las estadísticas")}finally{i(!1)}})()},[d,t]),{stats:n,loading:r,error:o}},xR=(t,n)=>{const[s,r]=f.useState(null),[i,o]=f.useState(!0),[c,d]=f.useState(null),{user:u}=He();return f.useEffect(()=>{(async()=>{if(r(null),!!u){o(!0),d(null);try{const p=[],x=new Date(t);for(;x<=n;)p.push(Oe(x)),x.setDate(x.getDate()+1);const v=(await Promise.allSettled(p.map(j=>ds(be(fe,"pomodoro",`${u.uid}_${j}`))))).map((j,b)=>{if(j.status==="fulfilled"){const y=j.value,S=(y.exists()?y.data().sessions||[]:[]).filter(E=>E.completed).reduce((E,T)=>E+(T.duration||0),0)/60;return{date:p[b],minutes:S}}return console.error("PomodoroStatsRange - Error fetching doc:",j.reason),{date:p[b],minutes:0}});r({dailyStats:v})}catch(p){console.error("Error al cargar estadísticas:",p),d(p instanceof Error?p.message:"Error al cargar estadísticas")}finally{o(!1)}}})()},[u,t,n]),{stats:s,loading:i,error:c}},gR=()=>{const[t,n]=f.useState("default"),[s,r]=f.useState({enabled:!1,sound:!0,vibration:!0}),i=f.useRef(null),o=f.useRef(),c=f.useCallback(()=>"Notification"in window,[]),d=f.useCallback(async()=>{if(!c())return!1;try{const v=await Notification.requestPermission();return n(v),v==="granted"}catch(v){return console.error("Error requesting notification permission:",v),!1}},[]),u=f.useCallback(async(v,j)=>{if(!(!c()||t!=="granted"))try{if("serviceWorker"in navigator){const y=await navigator.serviceWorker.getRegistration();if(y){await y.showNotification(v,{icon:"/icon-192x192.png",silent:!s.sound,...j});return}}const b=new Notification(v,{icon:"/icon-192x192.png",silent:!s.sound,...j});b.onclick=()=>{window.focus(),b.close()}}catch(b){console.error("Error sending notification:",b)}},[t,s,c]),m=f.useCallback(async(v,j)=>{var b;if(!(!c()||t!=="granted"))try{if("serviceWorker"in navigator){const N=await navigator.serviceWorker.getRegistration();if(N){await N.showNotification(v,{body:j,icon:"/icon-192x192.png",silent:!s.sound,requireInteraction:!0,tag:"pomodoro-active"});return}}(b=i.current)==null||b.close();const y=new Notification(v,{body:j,icon:"/icon-192x192.png",silent:!s.sound,requireInteraction:!0,tag:"pomodoro-active"});y.onclick=()=>{window.focus(),y.close()},i.current=y}catch(y){console.error("Error sending persistent notification:",y)}},[t,s,c]),p=f.useCallback((v,j,b=6e4)=>{m(v,j()),o.current&&clearInterval(o.current),o.current=window.setInterval(()=>{m(v,j())},b)},[m]),x=f.useCallback(async()=>{if(o.current&&(clearInterval(o.current),o.current=void 0),i.current&&(i.current.close(),i.current=null),"serviceWorker"in navigator)try{const v=await navigator.serviceWorker.getRegistration();v&&(await v.getNotifications({tag:"pomodoro-active"})).forEach(b=>b.close())}catch(v){console.error("Error closing persistent notification:",v)}},[]);f.useEffect(()=>{const v=localStorage.getItem("pomodoroNotificationPrefs");if(v)try{r(JSON.parse(v))}catch{console.warn("Invalid pomodoro prefs in storage")}c()&&n(Notification.permission)},[]);const g=f.useCallback(v=>{r(j=>{const b={...j,...v};return localStorage.setItem("pomodoroNotificationPrefs",JSON.stringify(b)),b})},[]);return{supported:c(),permission:t,preferences:s,requestPermission:d,sendNotification:u,updatePreferences:g,startPersistentNotification:p,stopPersistentNotification:x}},vR=({count:t,onIncrement:n,disabled:s,status:r})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center min-w-[3rem]",children:[e.jsx("span",{className:"font-medium text-lg",children:t}),e.jsx("span",{className:"text-xs text-gray-500",children:"completados"})]}),e.jsx(F,{variant:"outline",size:"icon",onClick:n,disabled:s,className:"h-8 w-8",children:e.jsx(Ns,{className:"w-4 h-4"})}),r==="saving"&&e.jsx("span",{className:"text-xs text-blue-500 animate-pulse",children:"Guardando..."}),r==="error"&&e.jsx("span",{className:"text-xs text-red-500",children:"Error al guardar"})]}),Tf=nk,jd=f.forwardRef(({className:t,...n},s)=>e.jsx(tk,{ref:s,className:ce("border-b",t),...n}));jd.displayName="AccordionItem";const wd=f.forwardRef(({className:t,children:n,...s},r)=>e.jsx(sk,{className:"flex",children:e.jsxs(kv,{ref:r,className:ce("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...s,children:[n,e.jsx(Dr,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));wd.displayName=kv.displayName;const Nd=f.forwardRef(({className:t,children:n,...s},r)=>e.jsx(_v,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...s,children:e.jsx("div",{className:ce("pb-4 pt-0",t),children:n})}));Nd.displayName=_v.displayName;const ug=t=>new Date(t).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1}),yR=({sessions:t,onDeleteSession:n,onEditSession:s})=>{const[r,i]=f.useState(!1),o=[...t].sort((c,d)=>d.startTime.timestamp-c.startTime.timestamp);return e.jsx(Tf,{type:"single",collapsible:!0,onValueChange:c=>i(!!c),value:r?"history":"",children:e.jsxs(jd,{value:"history",className:"border-none",children:[e.jsx(wd,{className:"w-full h-11 flex items-center justify-center gap-2 border rounded-lg bg-background hover:bg-accent data-[state=open]:rounded-b-none",children:e.jsx("span",{className:"text-sm font-semibold",children:"Historial de hoy"})}),e.jsx(Nd,{className:"mt-2 space-y-2",children:o.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm py-2",children:"No hay sesiones registradas hoy"}):o.map((c,d)=>e.jsxs("div",{className:"flex flex-col p-2.5 bg-muted rounded-lg text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c.completed?e.jsx(dd,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):e.jsx(Qk,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-gray-400 w-4",children:d+1}),e.jsx("span",{children:ug(c.startTime.timestamp)}),e.jsx("span",{className:"text-gray-400",children:"→"}),e.jsx("span",{children:ug(c.endTime.timestamp)})]})}),e.jsxs("span",{className:"text-gray-500 whitespace-nowrap",children:[Math.floor(c.duration/60),"min"]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[s&&e.jsx(F,{variant:"ghost",size:"icon",className:"h-auto w-auto p-1",onClick:()=>s(c),children:e.jsx(vf,{className:"w-4 h-4 text-muted-foreground"})}),n&&e.jsx(F,{variant:"ghost",size:"icon",className:"h-auto w-auto p-1",onClick:()=>n(c),children:e.jsx(dl,{className:"w-4 h-4 text-destructive"})})]})]}),c.description&&e.jsx("div",{className:"ml-6 mt-1 text-xs text-gray-500",children:c.description})]},c.startTime.timestamp))})]})})},bR=({time:t,isActive:n,onStart:s,onStop:r,disabled:i})=>{const[o,c]=f.useState(!1),d=async m=>{if(m.preventDefault(),!o)try{c(!0),await r()}finally{c(!1)}},u=async m=>{if(m.preventDefault(),!o)try{c(!0),await s()}finally{c(!1)}};return e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsx("div",{className:"text-6xl font-mono tracking-wider",children:t}),e.jsx("div",{className:"flex gap-4",children:n?e.jsxs(F,{size:"lg",onClick:d,disabled:i||o,variant:"destructive",className:"w-40 text-lg",children:[o?e.jsx(Qt,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(Gv,{className:"w-5 h-5 mr-2"}),o?"Deteniendo...":"Detener"]}):e.jsxs(F,{size:"lg",onClick:u,disabled:i||o,className:"w-40 text-lg",children:[o?e.jsx(Qt,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(Xo,{className:"w-5 h-5 mr-2"}),o?"Iniciando...":"Iniciar"]})}),e.jsx("div",{className:"text-sm text-gray-500",children:n?e.jsx(e.Fragment,{children:o?e.jsx("span",{children:"Procesando cambio de estado..."}):e.jsx("span",{children:"Concentración en progreso..."})}):e.jsx("span",{children:"30 minutos de concentración"})})]})};function jR(t,n=[]){let s=[];function r(o,c){const d=f.createContext(c),u=s.length;s=[...s,c];function m(x){const{scope:g,children:v,...j}=x,b=(g==null?void 0:g[t][u])||d,y=f.useMemo(()=>j,Object.values(j));return e.jsx(b.Provider,{value:y,children:v})}function p(x,g){const v=(g==null?void 0:g[t][u])||d,j=f.useContext(v);if(j)return j;if(c!==void 0)return c;throw new Error(`\`${x}\` must be used within \`${o}\``)}return m.displayName=o+"Provider",[m,p]}const i=()=>{const o=s.map(c=>f.createContext(c));return function(d){const u=(d==null?void 0:d[t])||o;return f.useMemo(()=>({[`__scope${t}`]:{...d,[t]:u}}),[d,u])}};return i.scopeName=t,[r,wR(i,...n)]}function wR(...t){const n=t[0];if(t.length===1)return n;const s=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const c=r.reduce((d,{useScope:u,scopeName:m})=>{const x=u(o)[`__scope${m}`];return{...d,...x}},{});return f.useMemo(()=>({[`__scope${n.scopeName}`]:c}),[c])}};return s.scopeName=n.scopeName,s}var kf="Progress",_f=100,[NR,j$]=jR(kf),[SR,CR]=NR(kf),P0=f.forwardRef((t,n)=>{const{__scopeProgress:s,value:r=null,max:i,getValueLabel:o=ER,...c}=t;(i||i===0)&&!mg(i)&&console.error(TR(`${i}`,"Progress"));const d=mg(i)?i:_f;r!==null&&!fg(r,d)&&console.error(kR(`${r}`,"Progress"));const u=fg(r,d)?r:null,m=Uc(u)?o(u,d):void 0;return e.jsx(SR,{scope:s,value:u,max:d,children:e.jsx(It.div,{"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":Uc(u)?u:void 0,"aria-valuetext":m,role:"progressbar","data-state":M0(u,d),"data-value":u??void 0,"data-max":d,...c,ref:n})})});P0.displayName=kf;var I0="ProgressIndicator",O0=f.forwardRef((t,n)=>{const{__scopeProgress:s,...r}=t,i=CR(I0,s);return e.jsx(It.div,{"data-state":M0(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...r,ref:n})});O0.displayName=I0;function ER(t,n){return`${Math.round(t/n*100)}%`}function M0(t,n){return t==null?"indeterminate":t===n?"complete":"loading"}function Uc(t){return typeof t=="number"}function mg(t){return Uc(t)&&!isNaN(t)&&t>0}function fg(t,n){return Uc(t)&&!isNaN(t)&&t<=n&&t>=0}function TR(t,n){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${n}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${_f}\`.`}function kR(t,n){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${n}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${_f} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var L0=P0,_R=O0;const ca=f.forwardRef(({className:t,value:n,...s},r)=>e.jsx(L0,{ref:r,className:ce("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...s,children:e.jsx(_R,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(n||0)}%)`}})}));ca.displayName=L0.displayName;const DR=({progress:t,currentTime:n,totalTime:s,isActive:r})=>{const i=Math.min(Math.max(t,0),100);return e.jsxs("div",{className:"space-y-2",children:[e.jsx(ca,{value:i,className:`h-2 transition-all duration-300 ${r?"bg-gray-100":"bg-gray-50"}`}),e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:n}),e.jsx("span",{className:"text-gray-500",children:" restantes"})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("span",{children:"Total: "}),e.jsx("span",{className:"font-medium",children:s})]})]}),e.jsx("div",{className:"text-center text-sm text-gray-500",children:i>0&&e.jsxs("span",{children:[Math.round(i),"% completado"]})})]})},yt=cf,$0=df,AR=lf,z0=f.forwardRef(({className:t,...n},s)=>e.jsx(al,{ref:s,className:ce("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n}));z0.displayName=al.displayName;const xt=f.forwardRef(({className:t,children:n,...s},r)=>e.jsxs(AR,{children:[e.jsx(z0,{}),e.jsxs(il,{ref:r,className:ce("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...s,children:[n,e.jsxs(od,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Js,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));xt.displayName=il.displayName;const bt=({className:t,...n})=>e.jsx("div",{className:ce("flex flex-col space-y-1.5 text-center sm:text-left",t),...n});bt.displayName="DialogHeader";const en=({className:t,...n})=>e.jsx("div",{className:ce("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});en.displayName="DialogFooter";const jt=f.forwardRef(({className:t,...n},s)=>e.jsx(ol,{ref:s,className:ce("text-lg font-semibold leading-none tracking-tight",t),...n}));jt.displayName=ol.displayName;const mn=f.forwardRef(({className:t,...n},s)=>e.jsx(ll,{ref:s,className:ce("text-sm text-muted-foreground",t),...n}));mn.displayName=ll.displayName;const Ve=f.forwardRef(({className:t,type:n,...s},r)=>e.jsx("input",{type:n,className:ce("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s}));Ve.displayName="Input";function F0(t){const n=f.useRef({value:t,previous:t});return f.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var Df="Checkbox",[RR,w$]=za(Df),[PR,IR]=RR(Df),B0=f.forwardRef((t,n)=>{const{__scopeCheckbox:s,name:r,checked:i,defaultChecked:o,required:c,disabled:d,value:u="on",onCheckedChange:m,form:p,...x}=t,[g,v]=f.useState(null),j=is(n,T=>v(T)),b=f.useRef(!1),y=g?p||!!g.closest("form"):!0,[N=!1,S]=aa({prop:i,defaultProp:o,onChange:m}),E=f.useRef(N);return f.useEffect(()=>{const T=g==null?void 0:g.form;if(T){const k=()=>S(E.current);return T.addEventListener("reset",k),()=>T.removeEventListener("reset",k)}},[g,S]),e.jsxs(PR,{scope:s,state:N,disabled:d,children:[e.jsx(It.button,{type:"button",role:"checkbox","aria-checked":Oa(N)?"mixed":N,"aria-required":c,"data-state":U0(N),"data-disabled":d?"":void 0,disabled:d,value:u,...x,ref:j,onKeyDown:ot(t.onKeyDown,T=>{T.key==="Enter"&&T.preventDefault()}),onClick:ot(t.onClick,T=>{S(k=>Oa(k)?!0:!k),y&&(b.current=T.isPropagationStopped(),b.current||T.stopPropagation())})}),y&&e.jsx(OR,{control:g,bubbles:!b.current,name:r,value:u,checked:N,required:c,disabled:d,form:p,style:{transform:"translateX(-100%)"},defaultChecked:Oa(o)?!1:o})]})});B0.displayName=Df;var W0="CheckboxIndicator",H0=f.forwardRef((t,n)=>{const{__scopeCheckbox:s,forceMount:r,...i}=t,o=IR(W0,s);return e.jsx(zi,{present:r||Oa(o.state)||o.state===!0,children:e.jsx(It.span,{"data-state":U0(o.state),"data-disabled":o.disabled?"":void 0,...i,ref:n,style:{pointerEvents:"none",...t.style}})})});H0.displayName=W0;var OR=t=>{const{control:n,checked:s,bubbles:r=!0,defaultChecked:i,...o}=t,c=f.useRef(null),d=F0(s),u=rk(n);f.useEffect(()=>{const p=c.current,x=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(x,"checked").set;if(d!==s&&v){const j=new Event("click",{bubbles:r});p.indeterminate=Oa(s),v.call(p,Oa(s)?!1:s),p.dispatchEvent(j)}},[d,s,r]);const m=f.useRef(Oa(s)?!1:s);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??m.current,...o,tabIndex:-1,ref:c,style:{...t.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Oa(t){return t==="indeterminate"}function U0(t){return Oa(t)?"indeterminate":t?"checked":"unchecked"}var V0=B0,MR=H0;const As=f.forwardRef(({className:t,...n},s)=>e.jsx(V0,{ref:s,className:ce("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...n,children:e.jsx(MR,{className:ce("flex items-center justify-center text-current"),children:e.jsx(Hi,{className:"h-4 w-4"})})}));As.displayName=V0.displayName;var LR="Label",G0=f.forwardRef((t,n)=>e.jsx(It.label,{...t,ref:n,onMouseDown:s=>{var i;s.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));G0.displayName=LR;var q0=G0;const $R=Bi("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ye=f.forwardRef(({className:t,...n},s)=>e.jsx(q0,{ref:s,className:ce($R(),t),...n}));Ye.displayName=q0.displayName;const zR=({session:t,onClose:n,onSave:s})=>{const[r,i]=f.useState(""),[o,c]=f.useState(""),[d,u]=f.useState(!1),[m,p]=f.useState("");if(f.useEffect(()=>{if(t){const g=new Date(t.startTime.timestamp),v=new Date(t.endTime.timestamp);i(`${String(g.getHours()).padStart(2,"0")}:${String(g.getMinutes()).padStart(2,"0")}`),c(`${String(v.getHours()).padStart(2,"0")}:${String(v.getMinutes()).padStart(2,"0")}`),u(t.completed),p(t.description||"")}},[t]),!t)return null;const x=()=>{const g=new Date(t.startTime.timestamp),[v,j]=r.split(":").map(Number),[b,y]=o.split(":").map(Number),N=new Date(g);N.setHours(v,j,0,0);const S=new Date(g);S.setHours(b,y,0,0),S<N&&S.setDate(S.getDate()+1);const E={startTime:{timestamp:N.getTime(),utcOffset:-N.getTimezoneOffset(),formatted:new Date(N).toLocaleString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})+` UTC${-N.getTimezoneOffset()>=0?"+":"-"}${Math.abs(Math.floor(-N.getTimezoneOffset()/60))}`},endTime:{timestamp:S.getTime(),utcOffset:-S.getTimezoneOffset(),formatted:new Date(S).toLocaleString("es-ES",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!0})+` UTC${-S.getTimezoneOffset()>=0?"+":"-"}${Math.abs(Math.floor(-S.getTimezoneOffset()/60))}`},duration:(S.getTime()-N.getTime())/1e3,completed:d,description:m.trim()||void 0};s(t,E),n()};return e.jsx(yt,{open:!!t,onOpenChange:g=>{g||n()},children:e.jsxs(xt,{className:"sm:max-w-md",children:[e.jsx(bt,{children:e.jsx(jt,{children:"Editar Sesión Pomodoro"})}),e.jsxs("div",{className:"py-4 space-y-4",children:[" ",e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[" ",e.jsx(Ye,{htmlFor:"startTime",children:"Hora inicio"}),e.jsx(Ve,{id:"startTime",type:"time",value:r,onChange:g=>i(g.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"endTime",children:"Hora fin"}),e.jsx(Ve,{id:"endTime",type:"time",value:o,onChange:g=>c(g.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"description",children:"Descripción (opcional)"}),e.jsx(Ve,{id:"description",type:"text",value:m,onChange:g=>p(g.target.value),placeholder:"¿Qué hiciste en esta sesión?"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[" ",e.jsx(As,{id:"completed",checked:d,onCheckedChange:g=>u(!!g)}),e.jsx(Ye,{htmlFor:"completed",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Sesión completada"})]})]}),e.jsxs(en,{children:[e.jsx(F,{variant:"outline",onClick:n,children:"Cancelar"}),e.jsx(F,{onClick:x,children:"Guardar cambios"})]})]})})},kc=t=>{const n=Math.floor(t/60),s=t%60;return n>0?`${n}h ${s}min`:`${s}min`},FR=t=>t===100?{icon:qv,message:"¡Meta diaria alcanzada! 🎉",description:"Has completado tu objetivo del día ¡Excelente trabajo!",color:"text-green-600"}:t>=75?{icon:e_,message:"¡Casi ahí! 💪",description:"Estás muy cerca de alcanzar tu meta diaria",color:"text-blue-600"}:t>=50?{icon:Sr,message:"¡Buen progreso! 👍",description:"Mantén el ritmo, vas por buen camino",color:"text-indigo-600"}:t>=25?{icon:Sr,message:"¡Sigue adelante! 🎯",description:"Has comenzado bien, mantén el enfoque",color:"text-blue-600"}:{icon:Sr,message:"¡Comencemos! 🚀",description:"Es un buen momento para enfocarse en tus objetivos",color:"text-gray-600"},BR=t=>t>=100?{background:"bg-green-500",text:"text-green-700",icon:"bg-green-100"}:t>=75?{background:"bg-blue-500",text:"text-blue-700",icon:"bg-blue-100"}:t>=50?{background:"bg-indigo-500",text:"text-indigo-700",icon:"bg-indigo-100"}:t>=25?{background:"bg-blue-500",text:"text-blue-700",icon:"bg-blue-100"}:{background:"bg-gray-500",text:"text-gray-700",icon:"bg-gray-100"},WR=({sessions:t,dailyGoal:n=300})=>{const s=t.filter(x=>x.completed).reduce((x,g)=>x+g.duration,0),r=Math.floor(s/60),i=Math.min(Math.round(r/n*100),100),o=Math.max(n-r,0),{icon:c,message:d,description:u,color:m}=FR(i),p=BR(i);return e.jsx(je,{className:"p-6 bg-gradient-to-br from-white to-gray-50",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${p.icon} mt-1`,children:e.jsx(c,{className:`w-5 h-5 ${m}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold text-lg ${m}`,children:d}),e.jsx("p",{className:"text-sm text-gray-600",children:u})]})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex justify-between items-center",children:[e.jsxs("span",{children:["Meta diaria: ",kc(n)]}),e.jsxs("span",{className:`font-medium ${m}`,children:[i,"% completado"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ca,{value:i,className:"h-3"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Tiempo efectivo"}),e.jsx("p",{className:`text-lg font-semibold ${p.text}`,children:kc(r)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Tiempo restante"}),e.jsx("p",{className:"text-lg font-semibold text-gray-700",children:kc(o)})]})]})]}),e.jsx("div",{className:"text-center",children:i<100?e.jsxs("p",{className:"text-sm text-gray-600",children:["Te faltan ",e.jsx("span",{className:"font-medium",children:kc(o)})," para alcanzar tu meta diaria"]}):e.jsx("p",{className:"text-sm font-medium text-green-600",children:"¡Felicitaciones! Has superado tu meta diaria de productividad 🎉"})})]})})},cr=()=>{const[t,n]=f.useState(typeof navigator<"u"?navigator.onLine:!0);return f.useEffect(()=>{const s=()=>n(!0),r=()=>n(!1);return window.addEventListener("online",s),window.addEventListener("offline",r),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}},[]),{isOnline:t}},pg=t=>{const n=Math.floor(t/60),s=t%60;return`${n<10?"0":""}${n}:${s<10?"0":""}${s}`},Wo=t=>{if(t<60)return`${t} min`;const n=Math.floor(t/60),s=t%60;return`${n}h ${s}min`};var HR=f.forwardRef((t,n)=>{const{children:s,...r}=t,i=f.Children.toArray(s),o=i.find(UR);if(o){const c=o.props.children,d=i.map(u=>u===o?f.Children.count(c)>1?f.Children.only(null):f.isValidElement(c)?c.props.children:null:u);return e.jsx(Fm,{...r,ref:n,children:f.isValidElement(c)?f.cloneElement(c,void 0,d):null})}return e.jsx(Fm,{...r,ref:n,children:s})});HR.displayName="Slot";var Fm=f.forwardRef((t,n)=>{const{children:s,...r}=t;if(f.isValidElement(s)){const i=GR(s);return f.cloneElement(s,{...VR(r,s.props),ref:n?of(n,i):i})}return f.Children.count(s)>1?f.Children.only(null):null});Fm.displayName="SlotClone";var Y0=({children:t})=>e.jsx(e.Fragment,{children:t});function UR(t){return f.isValidElement(t)&&t.type===Y0}function VR(t,n){const s={...n};for(const r in n){const i=t[r],o=n[r];/^on[A-Z]/.test(r)?i&&o?s[r]=(...d)=>{o(...d),i(...d)}:i&&(s[r]=i):r==="style"?s[r]={...i,...o}:r==="className"&&(s[r]=[i,o].filter(Boolean).join(" "))}return{...t,...s}}function GR(t){var r,i;let n=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var K0="AlertDialog",[qR,N$]=za(K0,[Dv]),da=Dv(),J0=t=>{const{__scopeAlertDialog:n,...s}=t,r=da(n);return e.jsx(cf,{...r,...s,modal:!0})};J0.displayName=K0;var YR="AlertDialogTrigger",X0=f.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...r}=t,i=da(s);return e.jsx(df,{...i,...r,ref:n})});X0.displayName=YR;var KR="AlertDialogPortal",Z0=t=>{const{__scopeAlertDialog:n,...s}=t,r=da(n);return e.jsx(lf,{...r,...s})};Z0.displayName=KR;var JR="AlertDialogOverlay",Q0=f.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...r}=t,i=da(s);return e.jsx(al,{...i,...r,ref:n})});Q0.displayName=JR;var Pi="AlertDialogContent",[XR,ZR]=qR(Pi),ey=f.forwardRef((t,n)=>{const{__scopeAlertDialog:s,children:r,...i}=t,o=da(s),c=f.useRef(null),d=is(n,c),u=f.useRef(null);return e.jsx(ak,{contentName:Pi,titleName:ty,docsSlug:"alert-dialog",children:e.jsx(XR,{scope:s,cancelRef:u,children:e.jsxs(il,{role:"alertdialog",...o,...i,ref:d,onOpenAutoFocus:ot(i.onOpenAutoFocus,m=>{var p;m.preventDefault(),(p=u.current)==null||p.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(Y0,{children:r}),e.jsx(eP,{contentRef:c})]})})})});ey.displayName=Pi;var ty="AlertDialogTitle",sy=f.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...r}=t,i=da(s);return e.jsx(ol,{...i,...r,ref:n})});sy.displayName=ty;var ny="AlertDialogDescription",ry=f.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...r}=t,i=da(s);return e.jsx(ll,{...i,...r,ref:n})});ry.displayName=ny;var QR="AlertDialogAction",ay=f.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...r}=t,i=da(s);return e.jsx(od,{...i,...r,ref:n})});ay.displayName=QR;var iy="AlertDialogCancel",oy=f.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...r}=t,{cancelRef:i}=ZR(iy,s),o=da(s),c=is(n,i);return e.jsx(od,{...o,...r,ref:c})});oy.displayName=iy;var eP=({contentRef:t})=>{const n=`\`${Pi}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Pi}\` by passing a \`${ny}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Pi}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return f.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(n)},[n,t]),null},tP=J0,sP=X0,nP=Z0,ly=Q0,cy=ey,dy=ay,uy=oy,my=sy,fy=ry;const Sd=tP,Af=sP,rP=nP,py=f.forwardRef(({className:t,...n},s)=>e.jsx(ly,{className:ce("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:s}));py.displayName=ly.displayName;const xl=f.forwardRef(({className:t,...n},s)=>e.jsxs(rP,{children:[e.jsx(py,{}),e.jsx(cy,{ref:s,className:ce("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n})]}));xl.displayName=cy.displayName;const gl=({className:t,...n})=>e.jsx("div",{className:ce("flex flex-col space-y-2 text-center sm:text-left",t),...n});gl.displayName="AlertDialogHeader";const vl=({className:t,...n})=>e.jsx("div",{className:ce("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...n});vl.displayName="AlertDialogFooter";const yl=f.forwardRef(({className:t,...n},s)=>e.jsx(my,{ref:s,className:ce("text-lg font-semibold",t),...n}));yl.displayName=my.displayName;const bl=f.forwardRef(({className:t,...n},s)=>e.jsx(fy,{ref:s,className:ce("text-sm text-muted-foreground",t),...n}));bl.displayName=fy.displayName;const jl=f.forwardRef(({className:t,...n},s)=>e.jsx(dy,{ref:s,className:ce(nl(),t),...n}));jl.displayName=dy.displayName;const wl=f.forwardRef(({className:t,...n},s)=>e.jsx(uy,{ref:s,className:ce(nl({variant:"outline"}),"mt-2 sm:mt-0",t),...n}));wl.displayName=uy.displayName;const nm=30*60,hy=({selectedDate:t})=>{const{user:n}=He(),s=300,[r,i]=f.useState(!1),[o,c]=f.useState(null),{supported:d,permission:u,preferences:m,requestPermission:p,sendNotification:x,updatePreferences:g,startPersistentNotification:v,stopPersistentNotification:j}=gR(),{count:b,sessions:y,status:N,error:S,saveSession:E,deleteSession:T,editSession:k,addManualSession:M,resync:R}=pR(t),{isOnline:I}=cr(),O=f.useCallback(async W=>{await E(W,!0),m.enabled&&u==="granted"&&x("¡Pomodoro completado! 🎉",{body:"Has completado exitosamente tu sesión de concentración",requireInteraction:!0})},[E,m,u,x]),H=f.useCallback(async W=>{await E(W,!1,{description:"Sesión interrumpida manualmente"})},[E]),{time:$,isActive:D,formattedTime:P,startTimer:K,stopTimer:X}=fR({onComplete:O,onCancel:H,selectedDate:t}),G=(nm-$)/nm*100,U=async()=>{d&&(m.enabled?g({enabled:!1}):u==="default"?i(!0):u==="granted"&&g({enabled:!0}))},Y=async()=>{await p()&&g({enabled:!0}),i(!1)},ae=async()=>{N==="saving"||!I||await M()},ye=W=>{c(W)},oe=async(W,se)=>{await k(W,se),c(null)},me=f.useRef($);return f.useEffect(()=>{me.current=$},[$]),f.useEffect(()=>{!d||!m.enabled||u!=="granted"||(D?v("Pomodoro en progreso",()=>`Tiempo restante: ${pg(Math.ceil(me.current))}`):j())},[D,d,m.enabled,u,v,j]),f.useEffect(()=>()=>{j()},[j]),n?e.jsxs("div",{className:"space-y-6",children:[e.jsx(WR,{sessions:y,dailyGoal:s}),e.jsx(je,{className:"w-full",children:e.jsxs(we,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Sr,{className:"w-5 h-5"}),e.jsx("h2",{className:"text-lg font-medium",children:"Pomodoro Timer"})]}),d&&e.jsx(F,{variant:"outline",size:"sm",onClick:U,className:"flex items-center gap-2","aria-label":m.enabled?"Desactivar notificaciones":"Activar notificaciones",children:m.enabled?e.jsxs(e.Fragment,{children:[e.jsx(t_,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline"})]}):e.jsxs(e.Fragment,{children:[e.jsx(s_,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline"})]})})]}),e.jsx(vR,{count:b,onIncrement:ae,disabled:N==="saving"||!I,status:N})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(bR,{time:P,isActive:D,onStart:K,onStop:X,disabled:N==="saving"||!I}),e.jsx(DR,{progress:G,currentTime:P,totalTime:pg(nm),isActive:D})]}),e.jsx("div",{className:"mt-6",children:e.jsx(yR,{sessions:y,onEditSession:ye,onDeleteSession:T})})]})}),o&&e.jsx(zR,{session:o,onClose:()=>c(null),onSave:oe}),e.jsx(Sd,{open:r,onOpenChange:i,children:e.jsxs(xl,{children:[e.jsxs(gl,{children:[e.jsx(yl,{children:"Activar notificaciones"}),e.jsx(bl,{children:"¿Te gustaría recibir notificaciones cuando se complete un Pomodoro? Esto te ayudará a mantenerte informado incluso cuando el navegador esté en segundo plano."})]}),e.jsxs(vl,{children:[e.jsx(wl,{children:"No, gracias"}),e.jsx(jl,{onClick:Y,children:"Activar notificaciones"})]})]})}),S&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:S}),e.jsxs("div",{className:"flex justify-center items-center gap-2 text-xs p-2",children:[N==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),N==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),N==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),N==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!I&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:R,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]}):e.jsxs(je,{className:"w-full",children:[e.jsx(we,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para usar el temporizador Pomodoro"})}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[N==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),N==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),N==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),N==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!I&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:R,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]})},hg=({dateRange:t})=>{var o;const{user:n}=He(),{stats:s,loading:r,error:i}=hR(t);return n?r?e.jsxs(je,{children:[e.jsx(Mt,{children:e.jsxs(Lt,{children:["Estadísticas (",t==="week"?"Semana":"Mes",")"]})}),e.jsx(we,{children:e.jsx("div",{className:"flex items-center justify-center py-6",children:e.jsx("p",{className:"text-gray-500",children:"Cargando estadísticas..."})})})]}):i?e.jsxs(je,{children:[e.jsx(Mt,{children:e.jsxs(Lt,{children:["Estadísticas (",t==="week"?"Semana":"Mes",")"]})}),e.jsx(we,{children:e.jsx("div",{className:"text-red-500",children:"Error al cargar las estadísticas. Por favor, intenta de nuevo."})})]}):s?e.jsxs(je,{children:[e.jsx(Mt,{children:e.jsxs(Lt,{children:["Estadísticas ",t==="week"?"de la Semana":"del Mes"]})}),e.jsx(we,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 text-center text-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Sesiones"}),e.jsx("p",{className:"text-lg font-semibold",children:s.totalSessions})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Tiempo Total"}),e.jsx("p",{className:"text-lg font-semibold",children:Wo(Math.floor(s.totalTime/60))})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Promedio/Sesión"}),e.jsx("p",{className:"text-lg font-semibold",children:Wo(Math.floor(s.averageSessionTime/60))})]}),t==="week"?e.jsxs("div",{className:"space-y-0.5 col-span-2",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Promedio diario"}),e.jsxs("p",{className:"text-lg font-semibold",children:[(o=s.averageWeekdayHours)==null?void 0:o.toFixed(1),"h/día"]})]}):e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Completitud"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.completionRate.toFixed(1),"%"]})]}),s.bestDay&&e.jsxs("div",{className:"space-y-0.5 col-span-2",children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Mejor Día"}),e.jsx("p",{className:"text-lg font-semibold",children:Wo(Math.floor(s.bestDay.minutes))}),e.jsx("p",{className:"text-xs text-gray-400",children:s.bestDay.date})]})]})})]}):e.jsxs(je,{children:[e.jsx(Mt,{children:e.jsxs(Lt,{children:["Estadísticas (",t==="week"?"Semana":"Mes",")"]})}),e.jsx(we,{children:e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500",children:"No hay datos disponibles"})})})]}):null};var Be=function(){return Be=Object.assign||function(n){for(var s,r=1,i=arguments.length;r<i;r++){s=arguments[r];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(n[o]=s[o])}return n},Be.apply(this,arguments)};function aP(t,n){var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(s[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)n.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(s[r[i]]=t[r[i]]);return s}function xy(t,n,s){for(var r=0,i=n.length,o;r<i;r++)(o||!(r in n))&&(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}function Nl(t){return t.mode==="multiple"}function Sl(t){return t.mode==="range"}function Cd(t){return t.mode==="single"}var iP={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function oP(t,n){return Pt(t,"LLLL y",n)}function lP(t,n){return Pt(t,"d",n)}function cP(t,n){return Pt(t,"LLLL",n)}function dP(t){return"".concat(t)}function uP(t,n){return Pt(t,"cccccc",n)}function mP(t,n){return Pt(t,"yyyy",n)}var fP=Object.freeze({__proto__:null,formatCaption:oP,formatDay:lP,formatMonthCaption:cP,formatWeekNumber:dP,formatWeekdayName:uP,formatYearCaption:mP}),pP=function(t,n,s){return Pt(t,"do MMMM (EEEE)",s)},hP=function(){return"Month: "},xP=function(){return"Go to next month"},gP=function(){return"Go to previous month"},vP=function(t,n){return Pt(t,"cccc",n)},yP=function(t){return"Week n. ".concat(t)},bP=function(){return"Year: "},jP=Object.freeze({__proto__:null,labelDay:pP,labelMonthDropdown:hP,labelNext:xP,labelPrevious:gP,labelWeekNumber:yP,labelWeekday:vP,labelYearDropdown:bP});function wP(){var t="buttons",n=iP,s=kk,r={},i={},o=1,c={},d=new Date;return{captionLayout:t,classNames:n,formatters:fP,labels:jP,locale:s,modifiersClassNames:r,modifiers:i,numberOfMonths:o,styles:c,today:d,mode:"default"}}function NP(t){var n=t.fromYear,s=t.toYear,r=t.fromMonth,i=t.toMonth,o=t.fromDate,c=t.toDate;return r?o=_t(r):n&&(o=new Date(n,0,1)),i?c=wn(i):s&&(c=new Date(s,11,31)),{fromDate:o?ys(o):void 0,toDate:c?ys(c):void 0}}var gy=f.createContext(void 0);function SP(t){var n,s=t.initialProps,r=wP(),i=NP(s),o=i.fromDate,c=i.toDate,d=(n=s.captionLayout)!==null&&n!==void 0?n:r.captionLayout;d!=="buttons"&&(!o||!c)&&(d="buttons");var u;(Cd(s)||Nl(s)||Sl(s))&&(u=s.onSelect);var m=Be(Be(Be({},r),s),{captionLayout:d,classNames:Be(Be({},r.classNames),s.classNames),components:Be({},s.components),formatters:Be(Be({},r.formatters),s.formatters),fromDate:o,labels:Be(Be({},r.labels),s.labels),mode:s.mode||r.mode,modifiers:Be(Be({},r.modifiers),s.modifiers),modifiersClassNames:Be(Be({},r.modifiersClassNames),s.modifiersClassNames),onSelect:u,styles:Be(Be({},r.styles),s.styles),toDate:c});return e.jsx(gy.Provider,{value:m,children:t.children})}function zt(){var t=f.useContext(gy);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function vy(t){var n=zt(),s=n.locale,r=n.classNames,i=n.styles,o=n.formatters.formatCaption;return e.jsx("div",{className:r.caption_label,style:i.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:o(t.displayMonth,{locale:s})})}function CP(t){return e.jsx("svg",Be({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function yy(t){var n,s,r=t.onChange,i=t.value,o=t.children,c=t.caption,d=t.className,u=t.style,m=zt(),p=(s=(n=m.components)===null||n===void 0?void 0:n.IconDropdown)!==null&&s!==void 0?s:CP;return e.jsxs("div",{className:d,style:u,children:[e.jsx("span",{className:m.classNames.vhidden,children:t["aria-label"]}),e.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:m.classNames.dropdown,style:m.styles.dropdown,value:i,onChange:r,children:o}),e.jsxs("div",{className:m.classNames.caption_label,style:m.styles.caption_label,"aria-hidden":"true",children:[c,e.jsx(p,{className:m.classNames.dropdown_icon,style:m.styles.dropdown_icon})]})]})}function EP(t){var n,s=zt(),r=s.fromDate,i=s.toDate,o=s.styles,c=s.locale,d=s.formatters.formatMonthCaption,u=s.classNames,m=s.components,p=s.labels.labelMonthDropdown;if(!r)return e.jsx(e.Fragment,{});if(!i)return e.jsx(e.Fragment,{});var x=[];if(_k(r,i))for(var g=_t(r),v=r.getMonth();v<=i.getMonth();v++)x.push(Qu(g,v));else for(var g=_t(new Date),v=0;v<=11;v++)x.push(Qu(g,v));var j=function(y){var N=Number(y.target.value),S=Qu(_t(t.displayMonth),N);t.onChange(S)},b=(n=m==null?void 0:m.Dropdown)!==null&&n!==void 0?n:yy;return e.jsx(b,{name:"months","aria-label":p(),className:u.dropdown_month,style:o.dropdown_month,onChange:j,value:t.displayMonth.getMonth(),caption:d(t.displayMonth,{locale:c}),children:x.map(function(y){return e.jsx("option",{value:y.getMonth(),children:d(y,{locale:c})},y.getMonth())})})}function TP(t){var n,s=t.displayMonth,r=zt(),i=r.fromDate,o=r.toDate,c=r.locale,d=r.styles,u=r.classNames,m=r.components,p=r.formatters.formatYearCaption,x=r.labels.labelYearDropdown,g=[];if(!i)return e.jsx(e.Fragment,{});if(!o)return e.jsx(e.Fragment,{});for(var v=i.getFullYear(),j=o.getFullYear(),b=v;b<=j;b++)g.push(Fx(Em(new Date),b));var y=function(S){var E=Fx(_t(s),Number(S.target.value));t.onChange(E)},N=(n=m==null?void 0:m.Dropdown)!==null&&n!==void 0?n:yy;return e.jsx(N,{name:"years","aria-label":x(),className:u.dropdown_year,style:d.dropdown_year,onChange:y,value:s.getFullYear(),caption:p(s,{locale:c}),children:g.map(function(S){return e.jsx("option",{value:S.getFullYear(),children:p(S,{locale:c})},S.getFullYear())})})}function kP(t,n){var s=f.useState(t),r=s[0],i=s[1],o=n===void 0?r:n;return[o,i]}function _P(t){var n=t.month,s=t.defaultMonth,r=t.today,i=n||s||r||new Date,o=t.toDate,c=t.fromDate,d=t.numberOfMonths,u=d===void 0?1:d;if(o&&Ko(o,i)<0){var m=-1*(u-1);i=ar(o,m)}return c&&Ko(i,c)<0&&(i=c),_t(i)}function DP(){var t=zt(),n=_P(t),s=kP(n,t.month),r=s[0],i=s[1],o=function(c){var d;if(!t.disableNavigation){var u=_t(c);i(u),(d=t.onMonthChange)===null||d===void 0||d.call(t,u)}};return[r,o]}function AP(t,n){for(var s=n.reverseMonths,r=n.numberOfMonths,i=_t(t),o=_t(ar(i,r)),c=Ko(o,i),d=[],u=0;u<c;u++){var m=ar(i,u);d.push(m)}return s&&(d=d.reverse()),d}function RP(t,n){if(!n.disableNavigation){var s=n.toDate,r=n.pagedNavigation,i=n.numberOfMonths,o=i===void 0?1:i,c=r?o:1,d=_t(t);if(!s)return ar(d,c);var u=Ko(s,t);if(!(u<o))return ar(d,c)}}function PP(t,n){if(!n.disableNavigation){var s=n.fromDate,r=n.pagedNavigation,i=n.numberOfMonths,o=i===void 0?1:i,c=r?o:1,d=_t(t);if(!s)return ar(d,-c);var u=Ko(d,s);if(!(u<=0))return ar(d,-c)}}var by=f.createContext(void 0);function IP(t){var n=zt(),s=DP(),r=s[0],i=s[1],o=AP(r,n),c=RP(r,n),d=PP(r,n),u=function(x){return o.some(function(g){return mf(x,g)})},m=function(x,g){u(x)||(g&&os(x,g)?i(ar(x,1+n.numberOfMonths*-1)):i(x))},p={currentMonth:r,displayMonths:o,goToMonth:i,goToDate:m,previousMonth:d,nextMonth:c,isDateDisplayed:u};return e.jsx(by.Provider,{value:p,children:t.children})}function Cl(){var t=f.useContext(by);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function xg(t){var n,s=zt(),r=s.classNames,i=s.styles,o=s.components,c=Cl().goToMonth,d=function(p){c(ar(p,t.displayIndex?-t.displayIndex:0))},u=(n=o==null?void 0:o.CaptionLabel)!==null&&n!==void 0?n:vy,m=e.jsx(u,{id:t.id,displayMonth:t.displayMonth});return e.jsxs("div",{className:r.caption_dropdowns,style:i.caption_dropdowns,children:[e.jsx("div",{className:r.vhidden,children:m}),e.jsx(EP,{onChange:d,displayMonth:t.displayMonth}),e.jsx(TP,{onChange:d,displayMonth:t.displayMonth})]})}function OP(t){return e.jsx("svg",Be({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function MP(t){return e.jsx("svg",Be({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Vc=f.forwardRef(function(t,n){var s=zt(),r=s.classNames,i=s.styles,o=[r.button_reset,r.button];t.className&&o.push(t.className);var c=o.join(" "),d=Be(Be({},i.button_reset),i.button);return t.style&&Object.assign(d,t.style),e.jsx("button",Be({},t,{ref:n,type:"button",className:c,style:d}))});function LP(t){var n,s,r=zt(),i=r.dir,o=r.locale,c=r.classNames,d=r.styles,u=r.labels,m=u.labelPrevious,p=u.labelNext,x=r.components;if(!t.nextMonth&&!t.previousMonth)return e.jsx(e.Fragment,{});var g=m(t.previousMonth,{locale:o}),v=[c.nav_button,c.nav_button_previous].join(" "),j=p(t.nextMonth,{locale:o}),b=[c.nav_button,c.nav_button_next].join(" "),y=(n=x==null?void 0:x.IconRight)!==null&&n!==void 0?n:MP,N=(s=x==null?void 0:x.IconLeft)!==null&&s!==void 0?s:OP;return e.jsxs("div",{className:c.nav,style:d.nav,children:[!t.hidePrevious&&e.jsx(Vc,{name:"previous-month","aria-label":g,className:v,style:d.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:i==="rtl"?e.jsx(y,{className:c.nav_icon,style:d.nav_icon}):e.jsx(N,{className:c.nav_icon,style:d.nav_icon})}),!t.hideNext&&e.jsx(Vc,{name:"next-month","aria-label":j,className:b,style:d.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:i==="rtl"?e.jsx(N,{className:c.nav_icon,style:d.nav_icon}):e.jsx(y,{className:c.nav_icon,style:d.nav_icon})})]})}function gg(t){var n=zt().numberOfMonths,s=Cl(),r=s.previousMonth,i=s.nextMonth,o=s.goToMonth,c=s.displayMonths,d=c.findIndex(function(j){return mf(t.displayMonth,j)}),u=d===0,m=d===c.length-1,p=n>1&&(u||!m),x=n>1&&(m||!u),g=function(){r&&o(r)},v=function(){i&&o(i)};return e.jsx(LP,{displayMonth:t.displayMonth,hideNext:p,hidePrevious:x,nextMonth:i,previousMonth:r,onPreviousClick:g,onNextClick:v})}function $P(t){var n,s=zt(),r=s.classNames,i=s.disableNavigation,o=s.styles,c=s.captionLayout,d=s.components,u=(n=d==null?void 0:d.CaptionLabel)!==null&&n!==void 0?n:vy,m;return i?m=e.jsx(u,{id:t.id,displayMonth:t.displayMonth}):c==="dropdown"?m=e.jsx(xg,{displayMonth:t.displayMonth,id:t.id}):c==="dropdown-buttons"?m=e.jsxs(e.Fragment,{children:[e.jsx(xg,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),e.jsx(gg,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):m=e.jsxs(e.Fragment,{children:[e.jsx(u,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(gg,{displayMonth:t.displayMonth,id:t.id})]}),e.jsx("div",{className:r.caption,style:o.caption,children:m})}function zP(t){var n=zt(),s=n.footer,r=n.styles,i=n.classNames.tfoot;return s?e.jsx("tfoot",{className:i,style:r.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:s})})}):e.jsx(e.Fragment,{})}function FP(t,n,s){for(var r=s?ff(new Date):Cr(new Date,{locale:t,weekStartsOn:n}),i=[],o=0;o<7;o++){var c=Vt(r,o);i.push(c)}return i}function BP(){var t=zt(),n=t.classNames,s=t.styles,r=t.showWeekNumber,i=t.locale,o=t.weekStartsOn,c=t.ISOWeek,d=t.formatters.formatWeekdayName,u=t.labels.labelWeekday,m=FP(i,o,c);return e.jsxs("tr",{style:s.head_row,className:n.head_row,children:[r&&e.jsx("td",{style:s.head_cell,className:n.head_cell}),m.map(function(p,x){return e.jsx("th",{scope:"col",className:n.head_cell,style:s.head_cell,"aria-label":u(p,{locale:i}),children:d(p,{locale:i})},x)})]})}function WP(){var t,n=zt(),s=n.classNames,r=n.styles,i=n.components,o=(t=i==null?void 0:i.HeadRow)!==null&&t!==void 0?t:BP;return e.jsx("thead",{style:r.head,className:s.head,children:e.jsx(o,{})})}function HP(t){var n=zt(),s=n.locale,r=n.formatters.formatDay;return e.jsx(e.Fragment,{children:r(t.date,{locale:s})})}var Rf=f.createContext(void 0);function UP(t){if(!Nl(t.initialProps)){var n={selected:void 0,modifiers:{disabled:[]}};return e.jsx(Rf.Provider,{value:n,children:t.children})}return e.jsx(VP,{initialProps:t.initialProps,children:t.children})}function VP(t){var n=t.initialProps,s=t.children,r=n.selected,i=n.min,o=n.max,c=function(m,p,x){var g,v;(g=n.onDayClick)===null||g===void 0||g.call(n,m,p,x);var j=!!(p.selected&&i&&(r==null?void 0:r.length)===i);if(!j){var b=!!(!p.selected&&o&&(r==null?void 0:r.length)===o);if(!b){var y=r?xy([],r):[];if(p.selected){var N=y.findIndex(function(S){return Bs(m,S)});y.splice(N,1)}else y.push(m);(v=n.onSelect)===null||v===void 0||v.call(n,y,m,p,x)}}},d={disabled:[]};r&&d.disabled.push(function(m){var p=o&&r.length>o-1,x=r.some(function(g){return Bs(g,m)});return!!(p&&!x)});var u={selected:r,onDayClick:c,modifiers:d};return e.jsx(Rf.Provider,{value:u,children:s})}function Pf(){var t=f.useContext(Rf);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function GP(t,n){var s=n||{},r=s.from,i=s.to;return r&&i?Bs(i,t)&&Bs(r,t)?void 0:Bs(i,t)?{from:i,to:void 0}:Bs(r,t)?void 0:Cm(r,t)?{from:t,to:i}:{from:r,to:t}:i?Cm(t,i)?{from:i,to:t}:{from:t,to:i}:r?os(t,r)?{from:t,to:r}:{from:r,to:t}:{from:t,to:void 0}}var If=f.createContext(void 0);function qP(t){if(!Sl(t.initialProps)){var n={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(If.Provider,{value:n,children:t.children})}return e.jsx(YP,{initialProps:t.initialProps,children:t.children})}function YP(t){var n=t.initialProps,s=t.children,r=n.selected,i=r||{},o=i.from,c=i.to,d=n.min,u=n.max,m=function(v,j,b){var y,N;(y=n.onDayClick)===null||y===void 0||y.call(n,v,j,b);var S=GP(v,r);(N=n.onSelect)===null||N===void 0||N.call(n,S,v,j,b)},p={range_start:[],range_end:[],range_middle:[],disabled:[]};if(o?(p.range_start=[o],c?(p.range_end=[c],Bs(o,c)||(p.range_middle=[{after:o,before:c}])):p.range_end=[o]):c&&(p.range_start=[c],p.range_end=[c]),d&&(o&&!c&&p.disabled.push({after:Fo(o,d-1),before:Vt(o,d-1)}),o&&c&&p.disabled.push({after:o,before:Vt(o,d-1)}),!o&&c&&p.disabled.push({after:Fo(c,d-1),before:Vt(c,d-1)})),u){if(o&&!c&&(p.disabled.push({before:Vt(o,-u+1)}),p.disabled.push({after:Vt(o,u-1)})),o&&c){var x=ea(c,o)+1,g=u-x;p.disabled.push({before:Fo(o,g)}),p.disabled.push({after:Vt(c,g)})}!o&&c&&(p.disabled.push({before:Vt(c,-u+1)}),p.disabled.push({after:Vt(c,u-1)}))}return e.jsx(If.Provider,{value:{selected:r,onDayClick:m,modifiers:p},children:s})}function Of(){var t=f.useContext(If);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function Oc(t){return Array.isArray(t)?xy([],t):t!==void 0?[t]:[]}function KP(t){var n={};return Object.entries(t).forEach(function(s){var r=s[0],i=s[1];n[r]=Oc(i)}),n}var ir;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(ir||(ir={}));var JP=ir.Selected,Yr=ir.Disabled,XP=ir.Hidden,ZP=ir.Today,rm=ir.RangeEnd,am=ir.RangeMiddle,im=ir.RangeStart,QP=ir.Outside;function eI(t,n,s){var r,i=(r={},r[JP]=Oc(t.selected),r[Yr]=Oc(t.disabled),r[XP]=Oc(t.hidden),r[ZP]=[t.today],r[rm]=[],r[am]=[],r[im]=[],r[QP]=[],r);return t.fromDate&&i[Yr].push({before:t.fromDate}),t.toDate&&i[Yr].push({after:t.toDate}),Nl(t)?i[Yr]=i[Yr].concat(n.modifiers[Yr]):Sl(t)&&(i[Yr]=i[Yr].concat(s.modifiers[Yr]),i[im]=s.modifiers[im],i[am]=s.modifiers[am],i[rm]=s.modifiers[rm]),i}var jy=f.createContext(void 0);function tI(t){var n=zt(),s=Pf(),r=Of(),i=eI(n,s,r),o=KP(n.modifiers),c=Be(Be({},i),o);return e.jsx(jy.Provider,{value:c,children:t.children})}function wy(){var t=f.useContext(jy);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function sI(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function nI(t){return!!(t&&typeof t=="object"&&"from"in t)}function rI(t){return!!(t&&typeof t=="object"&&"after"in t)}function aI(t){return!!(t&&typeof t=="object"&&"before"in t)}function iI(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function oI(t,n){var s,r=n.from,i=n.to;if(r&&i){var o=ea(i,r)<0;o&&(s=[i,r],r=s[0],i=s[1]);var c=ea(t,r)>=0&&ea(i,t)>=0;return c}return i?Bs(i,t):r?Bs(r,t):!1}function lI(t){return Wv(t)}function cI(t){return Array.isArray(t)&&t.every(Wv)}function dI(t,n){return n.some(function(s){if(typeof s=="boolean")return s;if(lI(s))return Bs(t,s);if(cI(s))return s.includes(t);if(nI(s))return oI(t,s);if(iI(s))return s.dayOfWeek.includes(t.getDay());if(sI(s)){var r=ea(s.before,t),i=ea(s.after,t),o=r>0,c=i<0,d=Cm(s.before,s.after);return d?c&&o:o||c}return rI(s)?ea(t,s.after)>0:aI(s)?ea(s.before,t)>0:typeof s=="function"?s(t):!1})}function Mf(t,n,s){var r=Object.keys(n).reduce(function(o,c){var d=n[c];return dI(t,d)&&o.push(c),o},[]),i={};return r.forEach(function(o){return i[o]=!0}),s&&!mf(t,s)&&(i.outside=!0),i}function uI(t,n){for(var s=_t(t[0]),r=wn(t[t.length-1]),i,o,c=s;c<=r;){var d=Mf(c,n),u=!d.disabled&&!d.hidden;if(!u){c=Vt(c,1);continue}if(d.selected)return c;d.today&&!o&&(o=c),i||(i=c),c=Vt(c,1)}return o||i}var mI=365;function Ny(t,n){var s=n.moveBy,r=n.direction,i=n.context,o=n.modifiers,c=n.retry,d=c===void 0?{count:0,lastFocused:t}:c,u=i.weekStartsOn,m=i.fromDate,p=i.toDate,x=i.locale,g={day:Vt,week:Yo,month:ar,year:Ik,startOfWeek:function(y){return i.ISOWeek?ff(y):Cr(y,{locale:x,weekStartsOn:u})},endOfWeek:function(y){return i.ISOWeek?Bv(y):$n(y,{locale:x,weekStartsOn:u})}},v=g[s](t,r==="after"?1:-1);r==="before"&&m?v=Dk([m,v]):r==="after"&&p&&(v=Ak([p,v]));var j=!0;if(o){var b=Mf(v,o);j=!b.disabled&&!b.hidden}return j?v:d.count>mI?d.lastFocused:Ny(v,{moveBy:s,direction:r,context:i,modifiers:o,retry:Be(Be({},d),{count:d.count+1})})}var Sy=f.createContext(void 0);function fI(t){var n=Cl(),s=wy(),r=f.useState(),i=r[0],o=r[1],c=f.useState(),d=c[0],u=c[1],m=uI(n.displayMonths,s),p=i??(d&&n.isDateDisplayed(d))?d:m,x=function(){u(i),o(void 0)},g=function(y){o(y)},v=zt(),j=function(y,N){if(i){var S=Ny(i,{moveBy:y,direction:N,context:v,modifiers:s});Bs(i,S)||(n.goToDate(S,i),g(S))}},b={focusedDay:i,focusTarget:p,blur:x,focus:g,focusDayAfter:function(){return j("day","after")},focusDayBefore:function(){return j("day","before")},focusWeekAfter:function(){return j("week","after")},focusWeekBefore:function(){return j("week","before")},focusMonthBefore:function(){return j("month","before")},focusMonthAfter:function(){return j("month","after")},focusYearBefore:function(){return j("year","before")},focusYearAfter:function(){return j("year","after")},focusStartOfWeek:function(){return j("startOfWeek","before")},focusEndOfWeek:function(){return j("endOfWeek","after")}};return e.jsx(Sy.Provider,{value:b,children:t.children})}function Lf(){var t=f.useContext(Sy);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function pI(t,n){var s=wy(),r=Mf(t,s,n);return r}var $f=f.createContext(void 0);function hI(t){if(!Cd(t.initialProps)){var n={selected:void 0};return e.jsx($f.Provider,{value:n,children:t.children})}return e.jsx(xI,{initialProps:t.initialProps,children:t.children})}function xI(t){var n=t.initialProps,s=t.children,r=function(o,c,d){var u,m,p;if((u=n.onDayClick)===null||u===void 0||u.call(n,o,c,d),c.selected&&!n.required){(m=n.onSelect)===null||m===void 0||m.call(n,void 0,o,c,d);return}(p=n.onSelect)===null||p===void 0||p.call(n,o,o,c,d)},i={selected:n.selected,onDayClick:r};return e.jsx($f.Provider,{value:i,children:s})}function Cy(){var t=f.useContext($f);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function gI(t,n){var s=zt(),r=Cy(),i=Pf(),o=Of(),c=Lf(),d=c.focusDayAfter,u=c.focusDayBefore,m=c.focusWeekAfter,p=c.focusWeekBefore,x=c.blur,g=c.focus,v=c.focusMonthBefore,j=c.focusMonthAfter,b=c.focusYearBefore,y=c.focusYearAfter,N=c.focusStartOfWeek,S=c.focusEndOfWeek,E=function(U){var Y,ae,ye,oe;Cd(s)?(Y=r.onDayClick)===null||Y===void 0||Y.call(r,t,n,U):Nl(s)?(ae=i.onDayClick)===null||ae===void 0||ae.call(i,t,n,U):Sl(s)?(ye=o.onDayClick)===null||ye===void 0||ye.call(o,t,n,U):(oe=s.onDayClick)===null||oe===void 0||oe.call(s,t,n,U)},T=function(U){var Y;g(t),(Y=s.onDayFocus)===null||Y===void 0||Y.call(s,t,n,U)},k=function(U){var Y;x(),(Y=s.onDayBlur)===null||Y===void 0||Y.call(s,t,n,U)},M=function(U){var Y;(Y=s.onDayMouseEnter)===null||Y===void 0||Y.call(s,t,n,U)},R=function(U){var Y;(Y=s.onDayMouseLeave)===null||Y===void 0||Y.call(s,t,n,U)},I=function(U){var Y;(Y=s.onDayPointerEnter)===null||Y===void 0||Y.call(s,t,n,U)},O=function(U){var Y;(Y=s.onDayPointerLeave)===null||Y===void 0||Y.call(s,t,n,U)},H=function(U){var Y;(Y=s.onDayTouchCancel)===null||Y===void 0||Y.call(s,t,n,U)},$=function(U){var Y;(Y=s.onDayTouchEnd)===null||Y===void 0||Y.call(s,t,n,U)},D=function(U){var Y;(Y=s.onDayTouchMove)===null||Y===void 0||Y.call(s,t,n,U)},P=function(U){var Y;(Y=s.onDayTouchStart)===null||Y===void 0||Y.call(s,t,n,U)},K=function(U){var Y;(Y=s.onDayKeyUp)===null||Y===void 0||Y.call(s,t,n,U)},X=function(U){var Y;switch(U.key){case"ArrowLeft":U.preventDefault(),U.stopPropagation(),s.dir==="rtl"?d():u();break;case"ArrowRight":U.preventDefault(),U.stopPropagation(),s.dir==="rtl"?u():d();break;case"ArrowDown":U.preventDefault(),U.stopPropagation(),m();break;case"ArrowUp":U.preventDefault(),U.stopPropagation(),p();break;case"PageUp":U.preventDefault(),U.stopPropagation(),U.shiftKey?b():v();break;case"PageDown":U.preventDefault(),U.stopPropagation(),U.shiftKey?y():j();break;case"Home":U.preventDefault(),U.stopPropagation(),N();break;case"End":U.preventDefault(),U.stopPropagation(),S();break}(Y=s.onDayKeyDown)===null||Y===void 0||Y.call(s,t,n,U)},G={onClick:E,onFocus:T,onBlur:k,onKeyDown:X,onKeyUp:K,onMouseEnter:M,onMouseLeave:R,onPointerEnter:I,onPointerLeave:O,onTouchCancel:H,onTouchEnd:$,onTouchMove:D,onTouchStart:P};return G}function vI(){var t=zt(),n=Cy(),s=Pf(),r=Of(),i=Cd(t)?n.selected:Nl(t)?s.selected:Sl(t)?r.selected:void 0;return i}function yI(t){return Object.values(ir).includes(t)}function bI(t,n){var s=[t.classNames.day];return Object.keys(n).forEach(function(r){var i=t.modifiersClassNames[r];if(i)s.push(i);else if(yI(r)){var o=t.classNames["day_".concat(r)];o&&s.push(o)}}),s}function jI(t,n){var s=Be({},t.styles.day);return Object.keys(n).forEach(function(r){var i;s=Be(Be({},s),(i=t.modifiersStyles)===null||i===void 0?void 0:i[r])}),s}function wI(t,n,s){var r,i,o,c=zt(),d=Lf(),u=pI(t,n),m=gI(t,u),p=vI(),x=!!(c.onDayClick||c.mode!=="default");f.useEffect(function(){var M;u.outside||d.focusedDay&&x&&Bs(d.focusedDay,t)&&((M=s.current)===null||M===void 0||M.focus())},[d.focusedDay,t,s,x,u.outside]);var g=bI(c,u).join(" "),v=jI(c,u),j=!!(u.outside&&!c.showOutsideDays||u.hidden),b=(o=(i=c.components)===null||i===void 0?void 0:i.DayContent)!==null&&o!==void 0?o:HP,y=e.jsx(b,{date:t,displayMonth:n,activeModifiers:u}),N={style:v,className:g,children:y,role:"gridcell"},S=d.focusTarget&&Bs(d.focusTarget,t)&&!u.outside,E=d.focusedDay&&Bs(d.focusedDay,t),T=Be(Be(Be({},N),(r={disabled:u.disabled,role:"gridcell"},r["aria-selected"]=u.selected,r.tabIndex=E||S?0:-1,r)),m),k={isButton:x,isHidden:j,activeModifiers:u,selectedDays:p,buttonProps:T,divProps:N};return k}function NI(t){var n=f.useRef(null),s=wI(t.date,t.displayMonth,n);return s.isHidden?e.jsx("div",{role:"gridcell"}):s.isButton?e.jsx(Vc,Be({name:"day",ref:n},s.buttonProps)):e.jsx("div",Be({},s.divProps))}function SI(t){var n=t.number,s=t.dates,r=zt(),i=r.onWeekNumberClick,o=r.styles,c=r.classNames,d=r.locale,u=r.labels.labelWeekNumber,m=r.formatters.formatWeekNumber,p=m(Number(n),{locale:d});if(!i)return e.jsx("span",{className:c.weeknumber,style:o.weeknumber,children:p});var x=u(Number(n),{locale:d}),g=function(v){i(n,s,v)};return e.jsx(Vc,{name:"week-number","aria-label":x,className:c.weeknumber,style:o.weeknumber,onClick:g,children:p})}function CI(t){var n,s,r=zt(),i=r.styles,o=r.classNames,c=r.showWeekNumber,d=r.components,u=(n=d==null?void 0:d.Day)!==null&&n!==void 0?n:NI,m=(s=d==null?void 0:d.WeekNumber)!==null&&s!==void 0?s:SI,p;return c&&(p=e.jsx("td",{className:o.cell,style:i.cell,children:e.jsx(m,{number:t.weekNumber,dates:t.dates})})),e.jsxs("tr",{className:o.row,style:i.row,children:[p,t.dates.map(function(x){return e.jsx("td",{className:o.cell,style:i.cell,role:"presentation",children:e.jsx(u,{displayMonth:t.displayMonth,date:x})},Ek(x))})]})}function vg(t,n,s){for(var r=s!=null&&s.ISOWeek?Bv(n):$n(n,s),i=s!=null&&s.ISOWeek?ff(t):Cr(t,s),o=ea(r,i),c=[],d=0;d<=o;d++)c.push(Vt(i,d));var u=c.reduce(function(m,p){var x=s!=null&&s.ISOWeek?Rk(p):Pk(p,s),g=m.find(function(v){return v.weekNumber===x});return g?(g.dates.push(p),m):(m.push({weekNumber:x,dates:[p]}),m)},[]);return u}function EI(t,n){var s=vg(_t(t),wn(t),n);if(n!=null&&n.useFixedWeeks){var r=Tk(t,n);if(r<6){var i=s[s.length-1],o=i.dates[i.dates.length-1],c=Yo(o,6-r),d=vg(Yo(o,1),c,n);s.push.apply(s,d)}}return s}function TI(t){var n,s,r,i=zt(),o=i.locale,c=i.classNames,d=i.styles,u=i.hideHead,m=i.fixedWeeks,p=i.components,x=i.weekStartsOn,g=i.firstWeekContainsDate,v=i.ISOWeek,j=EI(t.displayMonth,{useFixedWeeks:!!m,ISOWeek:v,locale:o,weekStartsOn:x,firstWeekContainsDate:g}),b=(n=p==null?void 0:p.Head)!==null&&n!==void 0?n:WP,y=(s=p==null?void 0:p.Row)!==null&&s!==void 0?s:CI,N=(r=p==null?void 0:p.Footer)!==null&&r!==void 0?r:zP;return e.jsxs("table",{id:t.id,className:c.table,style:d.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!u&&e.jsx(b,{}),e.jsx("tbody",{className:c.tbody,style:d.tbody,children:j.map(function(S){return e.jsx(y,{displayMonth:t.displayMonth,dates:S.dates,weekNumber:S.weekNumber},S.weekNumber)})}),e.jsx(N,{displayMonth:t.displayMonth})]})}function kI(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var _I=kI()?f.useLayoutEffect:f.useEffect,om=!1,DI=0;function yg(){return"react-day-picker-".concat(++DI)}function AI(t){var n,s=t??(om?yg():null),r=f.useState(s),i=r[0],o=r[1];return _I(function(){i===null&&o(yg())},[]),f.useEffect(function(){om===!1&&(om=!0)},[]),(n=t??i)!==null&&n!==void 0?n:void 0}function RI(t){var n,s,r=zt(),i=r.dir,o=r.classNames,c=r.styles,d=r.components,u=Cl().displayMonths,m=AI(r.id?"".concat(r.id,"-").concat(t.displayIndex):void 0),p=r.id?"".concat(r.id,"-grid-").concat(t.displayIndex):void 0,x=[o.month],g=c.month,v=t.displayIndex===0,j=t.displayIndex===u.length-1,b=!v&&!j;i==="rtl"&&(n=[v,j],j=n[0],v=n[1]),v&&(x.push(o.caption_start),g=Be(Be({},g),c.caption_start)),j&&(x.push(o.caption_end),g=Be(Be({},g),c.caption_end)),b&&(x.push(o.caption_between),g=Be(Be({},g),c.caption_between));var y=(s=d==null?void 0:d.Caption)!==null&&s!==void 0?s:$P;return e.jsxs("div",{className:x.join(" "),style:g,children:[e.jsx(y,{id:m,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(TI,{id:p,"aria-labelledby":m,displayMonth:t.displayMonth})]},t.displayIndex)}function PI(t){var n=zt(),s=n.classNames,r=n.styles;return e.jsx("div",{className:s.months,style:r.months,children:t.children})}function II(t){var n,s,r=t.initialProps,i=zt(),o=Lf(),c=Cl(),d=f.useState(!1),u=d[0],m=d[1];f.useEffect(function(){i.initialFocus&&o.focusTarget&&(u||(o.focus(o.focusTarget),m(!0)))},[i.initialFocus,u,o.focus,o.focusTarget,o]);var p=[i.classNames.root,i.className];i.numberOfMonths>1&&p.push(i.classNames.multiple_months),i.showWeekNumber&&p.push(i.classNames.with_weeknumber);var x=Be(Be({},i.styles.root),i.style),g=Object.keys(r).filter(function(j){return j.startsWith("data-")}).reduce(function(j,b){var y;return Be(Be({},j),(y={},y[b]=r[b],y))},{}),v=(s=(n=r.components)===null||n===void 0?void 0:n.Months)!==null&&s!==void 0?s:PI;return e.jsx("div",Be({className:p.join(" "),style:x,dir:i.dir,id:i.id,nonce:r.nonce,title:r.title,lang:r.lang},g,{children:e.jsx(v,{children:c.displayMonths.map(function(j,b){return e.jsx(RI,{displayIndex:b,displayMonth:j},b)})})}))}function OI(t){var n=t.children,s=aP(t,["children"]);return e.jsx(SP,{initialProps:s,children:e.jsx(IP,{children:e.jsx(hI,{initialProps:s,children:e.jsx(UP,{initialProps:s,children:e.jsx(qP,{initialProps:s,children:e.jsx(tI,{children:e.jsx(fI,{children:n})})})})})})})}function MI(t){return e.jsx(OI,Be({},t,{children:e.jsx(II,{initialProps:t})}))}function Ed({className:t,classNames:n,showOutsideDays:s=!0,components:r,...i}){return e.jsx(MI,{showOutsideDays:s,className:ce("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:ce(nl({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:ce(nl({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...n},components:{IconLeft:()=>e.jsx(yf,{className:"h-4 w-4"}),IconRight:()=>e.jsx(ia,{className:"h-4 w-4"}),...r},...i})}Ed.displayName="Calendar";const LI=({selectedDate:t,goal:n=300})=>{const[s,r]=f.useState(_t(t));f.useEffect(()=>{r(_t(t))},[t]);const i=f.useMemo(()=>_t(s),[s]),o=f.useMemo(()=>wn(s),[s]),{stats:c,loading:d}=xR(i,o),u=f.useMemo(()=>{const p={};return c==null||c.dailyStats.forEach(({date:x,minutes:g})=>{p[x]=g}),p},[c]),m=p=>{const x=Oe(p.date),g=u[x]||0,v=Math.min(g/n,1),j=28,b=3,y=(j-b)/2,N=2*Math.PI*y,S=N-v*N,E=g>=n;return e.jsxs("div",{className:"relative flex items-center justify-center w-7 h-7",children:[e.jsxs("svg",{width:j,height:j,className:"absolute",children:[e.jsx("circle",{cx:j/2,cy:j/2,r:y,stroke:E?"#fecaca":"#e5e7eb",strokeWidth:b,fill:"none"}),e.jsx("circle",{cx:j/2,cy:j/2,r:y,stroke:E?"#f87171":"#9ca3af",strokeWidth:b,fill:"none",strokeDasharray:N,strokeDashoffset:S,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),e.jsx("span",{className:"text-[10px] font-medium z-10",children:p.date.getDate()})]})};return e.jsxs(je,{className:"w-full",children:[e.jsxs(Mt,{className:"flex flex-col items-center gap-2",children:[e.jsx(xf,{className:"w-5 h-5 text-red-600"}),e.jsx(Lt,{className:"text-center",children:"Historial Mensual"})]}),e.jsxs(we,{className:"relative p-4",children:[d&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 z-10",children:e.jsx(Qt,{className:"w-6 h-6 animate-spin"})}),e.jsx(Ed,{month:s,onMonthChange:r,showOutsideDays:!0,components:{DayContent:m},className:"p-0 w-full"})]})]})},$I=({intake:t,goal:n})=>{const s=()=>{const r=t/n*100;return r>=100?"¡Excelente! Has alcanzado tu meta diaria 🎉":r>=75?"¡Vas muy bien! Ya casi llegas a tu meta 💪":r>=50?"¡A mitad de camino! Sigue así 🌊":r>=25?"¡Buen comienzo! Mantén el ritmo 💧":"¡Comienza tu día con buena hidratación! 🚰"};return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-medium text-lg flex items-center gap-2",children:[e.jsx(pf,{className:"w-5 h-5"}),"Hidratación"]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:t>n?"text-blue-500 font-medium":"",children:[t,"ml / ",n,"ml"]}),e.jsx("div",{className:"text-xs text-gray-500",children:t>n?`+${t-n}ml extra`:""})]})]}),e.jsx(ca,{value:Math.min(t/n*100,100),className:"h-3"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 text-center",children:s()})]})},rl={water:"Agua",dairy:"Lácteos",caffeine:"Cafeína",hydration:"Hidratación",soda:"Gaseosas",alcohol:"Alcohol",other:"Otros"},dn={water:{name:"Agua",icon:"Droplet",hydrationFactor:1,color:"text-blue-500",amounts:[100,200,300],category:"water"},sparklingWater:{name:"Agua con gas",icon:"Waves",hydrationFactor:1,color:"text-blue-400",amounts:[100,200,300],category:"water"},flavoredWater:{name:"Agua saborizada",icon:"Droplets",hydrationFactor:.95,color:"text-blue-300",amounts:[100,200,300],category:"water"},milk:{name:"Leche",icon:"Milk",hydrationFactor:.9,color:"text-blue-500",amounts:[100,200,300],category:"dairy"},chocolate:{name:"Chocolate",icon:"Milk",hydrationFactor:.8,color:"text-brown-500",amounts:[100,200,300],category:"dairy"},colagranulada:{name:"Cola Granulada",icon:"Milk",hydrationFactor:.9,color:"text-red-500",amounts:[100,200,300],category:"dairy"},ensure:{name:"Ensure / Pediasure",icon:"Milk",hydrationFactor:.9,color:"text-red-500",amounts:[100,200,300],category:"dairy"},yogurt:{name:"Yogurt",icon:"Milk",hydrationFactor:.6,color:"text-amber-600",amounts:[100,200,300],category:"dairy"},coffee:{name:"Café",icon:"Coffee",hydrationFactor:.8,color:"text-amber-800",amounts:[100,200,300],category:"caffeine"},energyDrink:{name:"Energizante",icon:"Zap",hydrationFactor:.6,color:"text-yellow-500",amounts:[100,250,500],category:"caffeine"},juice:{name:"Jugo",icon:"Cherry",hydrationFactor:.85,color:"text-orange-500",amounts:[100,200,300],category:"hydration"},sportsdrink:{name:"Bebida deportiva",icon:"Dumbbell",hydrationFactor:.9,color:"text-green-500",amounts:[250,500,750],category:"hydration"},soup:{name:"Sopa",icon:"Soup",hydrationFactor:.6,color:"text-orange-500",amounts:[200,400,600],category:"other"},soda:{name:"Gaseosa",icon:"CircleDot",hydrationFactor:.6,color:"text-purple-500",amounts:[200,350,500],category:"soda"},beer:{name:"Cerveza",icon:"Beer",hydrationFactor:.8,color:"text-yellow-600",amounts:[330,500,750],category:"alcohol"},aguardiente:{name:"Aguardiente",icon:"Beer",hydrationFactor:.2,color:"text-yellow-600",amounts:[50,100,200],category:"alcohol"},wine:{name:"Vino",icon:"Wine",hydrationFactor:.1,color:"text-red-600",amounts:[150,250,750],category:"alcohol"},aromatica:{name:"Aromática",icon:"Coffee",hydrationFactor:.95,color:"text-green-600",amounts:[100,200,300],category:"other"},iceCream:{name:"Helado",icon:"Cookie",hydrationFactor:.4,color:"text-cyan-400",amounts:[50,100,150],category:"other"},granizado:{name:"Granizado",icon:"Cookie",hydrationFactor:.8,color:"text-blue-300",amounts:[150,250,350],category:"hydration"},tea:{name:"Té",icon:"Coffee",hydrationFactor:.9,color:"text-green-500",amounts:[100,200,300],category:"caffeine"}};function Bm(t,[n,s]){return Math.min(s,Math.max(n,t))}var Ey=f.forwardRef((t,n)=>{const{children:s,...r}=t,i=f.Children.toArray(s),o=i.find(FI);if(o){const c=o.props.children,d=i.map(u=>u===o?f.Children.count(c)>1?f.Children.only(null):f.isValidElement(c)?c.props.children:null:u);return e.jsx(Wm,{...r,ref:n,children:f.isValidElement(c)?f.cloneElement(c,void 0,d):null})}return e.jsx(Wm,{...r,ref:n,children:s})});Ey.displayName="Slot";var Wm=f.forwardRef((t,n)=>{const{children:s,...r}=t;if(f.isValidElement(s)){const i=WI(s);return f.cloneElement(s,{...BI(r,s.props),ref:n?of(n,i):i})}return f.Children.count(s)>1?f.Children.only(null):null});Wm.displayName="SlotClone";var zI=({children:t})=>e.jsx(e.Fragment,{children:t});function FI(t){return f.isValidElement(t)&&t.type===zI}function BI(t,n){const s={...n};for(const r in n){const i=t[r],o=n[r];/^on[A-Z]/.test(r)?i&&o?s[r]=(...d)=>{o(...d),i(...d)}:i&&(s[r]=i):r==="style"?s[r]={...i,...o}:r==="className"&&(s[r]=[i,o].filter(Boolean).join(" "))}return{...t,...s}}function WI(t){var r,i;let n=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var HI=[" ","Enter","ArrowUp","ArrowDown"],UI=[" ","Enter"],El="Select",[Td,kd,VI]=ik(El),[Ji,S$]=za(El,[VI,id]),_d=id(),[GI,Ba]=Ji(El),[qI,YI]=Ji(El),Ty=t=>{const{__scopeSelect:n,children:s,open:r,defaultOpen:i,onOpenChange:o,value:c,defaultValue:d,onValueChange:u,dir:m,name:p,autoComplete:x,disabled:g,required:v,form:j}=t,b=_d(n),[y,N]=f.useState(null),[S,E]=f.useState(null),[T,k]=f.useState(!1),M=cl(m),[R=!1,I]=aa({prop:r,defaultProp:i,onChange:o}),[O,H]=aa({prop:c,defaultProp:d,onChange:u}),$=f.useRef(null),D=y?j||!!y.closest("form"):!0,[P,K]=f.useState(new Set),X=Array.from(P).map(G=>G.props.value).join(";");return e.jsx(Tv,{...b,children:e.jsxs(GI,{required:v,scope:n,trigger:y,onTriggerChange:N,valueNode:S,onValueNodeChange:E,valueNodeHasChildren:T,onValueNodeHasChildrenChange:k,contentId:Fi(),value:O,onValueChange:H,open:R,onOpenChange:I,dir:M,triggerPointerDownPosRef:$,disabled:g,children:[e.jsx(Td.Provider,{scope:n,children:e.jsx(qI,{scope:t.__scopeSelect,onNativeOptionAdd:f.useCallback(G=>{K(U=>new Set(U).add(G))},[]),onNativeOptionRemove:f.useCallback(G=>{K(U=>{const Y=new Set(U);return Y.delete(G),Y})},[]),children:s})}),D?e.jsxs(Zy,{"aria-hidden":!0,required:v,tabIndex:-1,name:p,autoComplete:x,value:O,onChange:G=>H(G.target.value),disabled:g,form:j,children:[O===void 0?e.jsx("option",{value:""}):null,Array.from(P)]},X):null]})})};Ty.displayName=El;var ky="SelectTrigger",_y=f.forwardRef((t,n)=>{const{__scopeSelect:s,disabled:r=!1,...i}=t,o=_d(s),c=Ba(ky,s),d=c.disabled||r,u=is(n,c.onTriggerChange),m=kd(s),p=f.useRef("touch"),[x,g,v]=Qy(b=>{const y=m().filter(E=>!E.disabled),N=y.find(E=>E.value===c.value),S=eb(y,b,N);S!==void 0&&c.onValueChange(S.value)}),j=b=>{d||(c.onOpenChange(!0),v()),b&&(c.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return e.jsx(Nv,{asChild:!0,...o,children:e.jsx(It.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:d,"data-disabled":d?"":void 0,"data-placeholder":Xy(c.value)?"":void 0,...i,ref:u,onClick:ot(i.onClick,b=>{b.currentTarget.focus(),p.current!=="mouse"&&j(b)}),onPointerDown:ot(i.onPointerDown,b=>{p.current=b.pointerType;const y=b.target;y.hasPointerCapture(b.pointerId)&&y.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(j(b),b.preventDefault())}),onKeyDown:ot(i.onKeyDown,b=>{const y=x.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&g(b.key),!(y&&b.key===" ")&&HI.includes(b.key)&&(j(),b.preventDefault())})})})});_y.displayName=ky;var Dy="SelectValue",Ay=f.forwardRef((t,n)=>{const{__scopeSelect:s,className:r,style:i,children:o,placeholder:c="",...d}=t,u=Ba(Dy,s),{onValueNodeHasChildrenChange:m}=u,p=o!==void 0,x=is(n,u.onValueNodeChange);return rr(()=>{m(p)},[m,p]),e.jsx(It.span,{...d,ref:x,style:{pointerEvents:"none"},children:Xy(u.value)?e.jsx(e.Fragment,{children:c}):o})});Ay.displayName=Dy;var KI="SelectIcon",Ry=f.forwardRef((t,n)=>{const{__scopeSelect:s,children:r,...i}=t;return e.jsx(It.span,{"aria-hidden":!0,...i,ref:n,children:r||"▼"})});Ry.displayName=KI;var JI="SelectPortal",Py=t=>e.jsx(uk,{asChild:!0,...t});Py.displayName=JI;var oi="SelectContent",Iy=f.forwardRef((t,n)=>{const s=Ba(oi,t.__scopeSelect),[r,i]=f.useState();if(rr(()=>{i(new DocumentFragment)},[]),!s.open){const o=r;return o?uf.createPortal(e.jsx(Oy,{scope:t.__scopeSelect,children:e.jsx(Td.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),o):null}return e.jsx(My,{...t,ref:n})});Iy.displayName=oi;var Jn=10,[Oy,Wa]=Ji(oi),XI="SelectContentImpl",My=f.forwardRef((t,n)=>{const{__scopeSelect:s,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:c,side:d,sideOffset:u,align:m,alignOffset:p,arrowPadding:x,collisionBoundary:g,collisionPadding:v,sticky:j,hideWhenDetached:b,avoidCollisions:y,...N}=t,S=Ba(oi,s),[E,T]=f.useState(null),[k,M]=f.useState(null),R=is(n,pe=>T(pe)),[I,O]=f.useState(null),[H,$]=f.useState(null),D=kd(s),[P,K]=f.useState(!1),X=f.useRef(!1);f.useEffect(()=>{if(E)return ok(E)},[E]),lk();const G=f.useCallback(pe=>{const[_e,...We]=D().map(le=>le.ref.current),[Pe]=We.slice(-1),Le=document.activeElement;for(const le of pe)if(le===Le||(le==null||le.scrollIntoView({block:"nearest"}),le===_e&&k&&(k.scrollTop=0),le===Pe&&k&&(k.scrollTop=k.scrollHeight),le==null||le.focus(),document.activeElement!==Le))return},[D,k]),U=f.useCallback(()=>G([I,E]),[G,I,E]);f.useEffect(()=>{P&&U()},[P,U]);const{onOpenChange:Y,triggerPointerDownPosRef:ae}=S;f.useEffect(()=>{if(E){let pe={x:0,y:0};const _e=Pe=>{var Le,le;pe={x:Math.abs(Math.round(Pe.pageX)-(((Le=ae.current)==null?void 0:Le.x)??0)),y:Math.abs(Math.round(Pe.pageY)-(((le=ae.current)==null?void 0:le.y)??0))}},We=Pe=>{pe.x<=10&&pe.y<=10?Pe.preventDefault():E.contains(Pe.target)||Y(!1),document.removeEventListener("pointermove",_e),ae.current=null};return ae.current!==null&&(document.addEventListener("pointermove",_e),document.addEventListener("pointerup",We,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",_e),document.removeEventListener("pointerup",We,{capture:!0})}}},[E,Y,ae]),f.useEffect(()=>{const pe=()=>Y(!1);return window.addEventListener("blur",pe),window.addEventListener("resize",pe),()=>{window.removeEventListener("blur",pe),window.removeEventListener("resize",pe)}},[Y]);const[ye,oe]=Qy(pe=>{const _e=D().filter(Le=>!Le.disabled),We=_e.find(Le=>Le.ref.current===document.activeElement),Pe=eb(_e,pe,We);Pe&&setTimeout(()=>Pe.ref.current.focus())}),me=f.useCallback((pe,_e,We)=>{const Pe=!X.current&&!We;(S.value!==void 0&&S.value===_e||Pe)&&(O(pe),Pe&&(X.current=!0))},[S.value]),W=f.useCallback(()=>E==null?void 0:E.focus(),[E]),se=f.useCallback((pe,_e,We)=>{const Pe=!X.current&&!We;(S.value!==void 0&&S.value===_e||Pe)&&$(pe)},[S.value]),ge=r==="popper"?Hm:Ly,Me=ge===Hm?{side:d,sideOffset:u,align:m,alignOffset:p,arrowPadding:x,collisionBoundary:g,collisionPadding:v,sticky:j,hideWhenDetached:b,avoidCollisions:y}:{};return e.jsx(Oy,{scope:s,content:E,viewport:k,onViewportChange:M,itemRefCallback:me,selectedItem:I,onItemLeave:W,itemTextRefCallback:se,focusSelectedItem:U,selectedItemText:H,position:r,isPositioned:P,searchRef:ye,children:e.jsx(ck,{as:Ey,allowPinchZoom:!0,children:e.jsx(dk,{asChild:!0,trapped:S.open,onMountAutoFocus:pe=>{pe.preventDefault()},onUnmountAutoFocus:ot(i,pe=>{var _e;(_e=S.trigger)==null||_e.focus({preventScroll:!0}),pe.preventDefault()}),children:e.jsx(Sv,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:pe=>pe.preventDefault(),onDismiss:()=>S.onOpenChange(!1),children:e.jsx(ge,{role:"listbox",id:S.contentId,"data-state":S.open?"open":"closed",dir:S.dir,onContextMenu:pe=>pe.preventDefault(),...N,...Me,onPlaced:()=>K(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...N.style},onKeyDown:ot(N.onKeyDown,pe=>{const _e=pe.ctrlKey||pe.altKey||pe.metaKey;if(pe.key==="Tab"&&pe.preventDefault(),!_e&&pe.key.length===1&&oe(pe.key),["ArrowUp","ArrowDown","Home","End"].includes(pe.key)){let Pe=D().filter(Le=>!Le.disabled).map(Le=>Le.ref.current);if(["ArrowUp","End"].includes(pe.key)&&(Pe=Pe.slice().reverse()),["ArrowUp","ArrowDown"].includes(pe.key)){const Le=pe.target,le=Pe.indexOf(Le);Pe=Pe.slice(le+1)}setTimeout(()=>G(Pe)),pe.preventDefault()}})})})})})})});My.displayName=XI;var ZI="SelectItemAlignedPosition",Ly=f.forwardRef((t,n)=>{const{__scopeSelect:s,onPlaced:r,...i}=t,o=Ba(oi,s),c=Wa(oi,s),[d,u]=f.useState(null),[m,p]=f.useState(null),x=is(n,R=>p(R)),g=kd(s),v=f.useRef(!1),j=f.useRef(!0),{viewport:b,selectedItem:y,selectedItemText:N,focusSelectedItem:S}=c,E=f.useCallback(()=>{if(o.trigger&&o.valueNode&&d&&m&&b&&y&&N){const R=o.trigger.getBoundingClientRect(),I=m.getBoundingClientRect(),O=o.valueNode.getBoundingClientRect(),H=N.getBoundingClientRect();if(o.dir!=="rtl"){const Le=H.left-I.left,le=O.left-Le,Re=R.left-le,Ke=R.width+Re,Yt=Math.max(Ke,I.width),bs=window.innerWidth-Jn,Dt=Bm(le,[Jn,Math.max(Jn,bs-Yt)]);d.style.minWidth=Ke+"px",d.style.left=Dt+"px"}else{const Le=I.right-H.right,le=window.innerWidth-O.right-Le,Re=window.innerWidth-R.right-le,Ke=R.width+Re,Yt=Math.max(Ke,I.width),bs=window.innerWidth-Jn,Dt=Bm(le,[Jn,Math.max(Jn,bs-Yt)]);d.style.minWidth=Ke+"px",d.style.right=Dt+"px"}const $=g(),D=window.innerHeight-Jn*2,P=b.scrollHeight,K=window.getComputedStyle(m),X=parseInt(K.borderTopWidth,10),G=parseInt(K.paddingTop,10),U=parseInt(K.borderBottomWidth,10),Y=parseInt(K.paddingBottom,10),ae=X+G+P+Y+U,ye=Math.min(y.offsetHeight*5,ae),oe=window.getComputedStyle(b),me=parseInt(oe.paddingTop,10),W=parseInt(oe.paddingBottom,10),se=R.top+R.height/2-Jn,ge=D-se,Me=y.offsetHeight/2,pe=y.offsetTop+Me,_e=X+G+pe,We=ae-_e;if(_e<=se){const Le=$.length>0&&y===$[$.length-1].ref.current;d.style.bottom="0px";const le=m.clientHeight-b.offsetTop-b.offsetHeight,Re=Math.max(ge,Me+(Le?W:0)+le+U),Ke=_e+Re;d.style.height=Ke+"px"}else{const Le=$.length>0&&y===$[0].ref.current;d.style.top="0px";const Re=Math.max(se,X+b.offsetTop+(Le?me:0)+Me)+We;d.style.height=Re+"px",b.scrollTop=_e-se+b.offsetTop}d.style.margin=`${Jn}px 0`,d.style.minHeight=ye+"px",d.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>v.current=!0)}},[g,o.trigger,o.valueNode,d,m,b,y,N,o.dir,r]);rr(()=>E(),[E]);const[T,k]=f.useState();rr(()=>{m&&k(window.getComputedStyle(m).zIndex)},[m]);const M=f.useCallback(R=>{R&&j.current===!0&&(E(),S==null||S(),j.current=!1)},[E,S]);return e.jsx(eO,{scope:s,contentWrapper:d,shouldExpandOnScrollRef:v,onScrollButtonChange:M,children:e.jsx("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T},children:e.jsx(It.div,{...i,ref:x,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});Ly.displayName=ZI;var QI="SelectPopperPosition",Hm=f.forwardRef((t,n)=>{const{__scopeSelect:s,align:r="start",collisionPadding:i=Jn,...o}=t,c=_d(s);return e.jsx(Cv,{...c,...o,ref:n,align:r,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Hm.displayName=QI;var[eO,zf]=Ji(oi,{}),Um="SelectViewport",$y=f.forwardRef((t,n)=>{const{__scopeSelect:s,nonce:r,...i}=t,o=Wa(Um,s),c=zf(Um,s),d=is(n,o.onViewportChange),u=f.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),e.jsx(Td.Slot,{scope:s,children:e.jsx(It.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:d,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:ot(i.onScroll,m=>{const p=m.currentTarget,{contentWrapper:x,shouldExpandOnScrollRef:g}=c;if(g!=null&&g.current&&x){const v=Math.abs(u.current-p.scrollTop);if(v>0){const j=window.innerHeight-Jn*2,b=parseFloat(x.style.minHeight),y=parseFloat(x.style.height),N=Math.max(b,y);if(N<j){const S=N+v,E=Math.min(j,S),T=S-E;x.style.height=E+"px",x.style.bottom==="0px"&&(p.scrollTop=T>0?T:0,x.style.justifyContent="flex-end")}}}u.current=p.scrollTop})})})]})});$y.displayName=Um;var zy="SelectGroup",[tO,sO]=Ji(zy),nO=f.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t,i=Fi();return e.jsx(tO,{scope:s,id:i,children:e.jsx(It.div,{role:"group","aria-labelledby":i,...r,ref:n})})});nO.displayName=zy;var Fy="SelectLabel",By=f.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t,i=sO(Fy,s);return e.jsx(It.div,{id:i.id,...r,ref:n})});By.displayName=Fy;var Gc="SelectItem",[rO,Wy]=Ji(Gc),Hy=f.forwardRef((t,n)=>{const{__scopeSelect:s,value:r,disabled:i=!1,textValue:o,...c}=t,d=Ba(Gc,s),u=Wa(Gc,s),m=d.value===r,[p,x]=f.useState(o??""),[g,v]=f.useState(!1),j=is(n,S=>{var E;return(E=u.itemRefCallback)==null?void 0:E.call(u,S,r,i)}),b=Fi(),y=f.useRef("touch"),N=()=>{i||(d.onValueChange(r),d.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(rO,{scope:s,value:r,disabled:i,textId:b,isSelected:m,onItemTextChange:f.useCallback(S=>{x(E=>E||((S==null?void 0:S.textContent)??"").trim())},[]),children:e.jsx(Td.ItemSlot,{scope:s,value:r,disabled:i,textValue:p,children:e.jsx(It.div,{role:"option","aria-labelledby":b,"data-highlighted":g?"":void 0,"aria-selected":m&&g,"data-state":m?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...c,ref:j,onFocus:ot(c.onFocus,()=>v(!0)),onBlur:ot(c.onBlur,()=>v(!1)),onClick:ot(c.onClick,()=>{y.current!=="mouse"&&N()}),onPointerUp:ot(c.onPointerUp,()=>{y.current==="mouse"&&N()}),onPointerDown:ot(c.onPointerDown,S=>{y.current=S.pointerType}),onPointerMove:ot(c.onPointerMove,S=>{var E;y.current=S.pointerType,i?(E=u.onItemLeave)==null||E.call(u):y.current==="mouse"&&S.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ot(c.onPointerLeave,S=>{var E;S.currentTarget===document.activeElement&&((E=u.onItemLeave)==null||E.call(u))}),onKeyDown:ot(c.onKeyDown,S=>{var T;((T=u.searchRef)==null?void 0:T.current)!==""&&S.key===" "||(UI.includes(S.key)&&N(),S.key===" "&&S.preventDefault())})})})})});Hy.displayName=Gc;var $o="SelectItemText",Uy=f.forwardRef((t,n)=>{const{__scopeSelect:s,className:r,style:i,...o}=t,c=Ba($o,s),d=Wa($o,s),u=Wy($o,s),m=YI($o,s),[p,x]=f.useState(null),g=is(n,N=>x(N),u.onItemTextChange,N=>{var S;return(S=d.itemTextRefCallback)==null?void 0:S.call(d,N,u.value,u.disabled)}),v=p==null?void 0:p.textContent,j=f.useMemo(()=>e.jsx("option",{value:u.value,disabled:u.disabled,children:v},u.value),[u.disabled,u.value,v]),{onNativeOptionAdd:b,onNativeOptionRemove:y}=m;return rr(()=>(b(j),()=>y(j)),[b,y,j]),e.jsxs(e.Fragment,{children:[e.jsx(It.span,{id:u.textId,...o,ref:g}),u.isSelected&&c.valueNode&&!c.valueNodeHasChildren?uf.createPortal(o.children,c.valueNode):null]})});Uy.displayName=$o;var Vy="SelectItemIndicator",Gy=f.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t;return Wy(Vy,s).isSelected?e.jsx(It.span,{"aria-hidden":!0,...r,ref:n}):null});Gy.displayName=Vy;var Vm="SelectScrollUpButton",qy=f.forwardRef((t,n)=>{const s=Wa(Vm,t.__scopeSelect),r=zf(Vm,t.__scopeSelect),[i,o]=f.useState(!1),c=is(n,r.onScrollButtonChange);return rr(()=>{if(s.viewport&&s.isPositioned){let d=function(){const m=u.scrollTop>0;o(m)};const u=s.viewport;return d(),u.addEventListener("scroll",d),()=>u.removeEventListener("scroll",d)}},[s.viewport,s.isPositioned]),i?e.jsx(Ky,{...t,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:u}=s;d&&u&&(d.scrollTop=d.scrollTop-u.offsetHeight)}}):null});qy.displayName=Vm;var Gm="SelectScrollDownButton",Yy=f.forwardRef((t,n)=>{const s=Wa(Gm,t.__scopeSelect),r=zf(Gm,t.__scopeSelect),[i,o]=f.useState(!1),c=is(n,r.onScrollButtonChange);return rr(()=>{if(s.viewport&&s.isPositioned){let d=function(){const m=u.scrollHeight-u.clientHeight,p=Math.ceil(u.scrollTop)<m;o(p)};const u=s.viewport;return d(),u.addEventListener("scroll",d),()=>u.removeEventListener("scroll",d)}},[s.viewport,s.isPositioned]),i?e.jsx(Ky,{...t,ref:c,onAutoScroll:()=>{const{viewport:d,selectedItem:u}=s;d&&u&&(d.scrollTop=d.scrollTop+u.offsetHeight)}}):null});Yy.displayName=Gm;var Ky=f.forwardRef((t,n)=>{const{__scopeSelect:s,onAutoScroll:r,...i}=t,o=Wa("SelectScrollButton",s),c=f.useRef(null),d=kd(s),u=f.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return f.useEffect(()=>()=>u(),[u]),rr(()=>{var p;const m=d().find(x=>x.ref.current===document.activeElement);(p=m==null?void 0:m.ref.current)==null||p.scrollIntoView({block:"nearest"})},[d]),e.jsx(It.div,{"aria-hidden":!0,...i,ref:n,style:{flexShrink:0,...i.style},onPointerDown:ot(i.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(r,50))}),onPointerMove:ot(i.onPointerMove,()=>{var m;(m=o.onItemLeave)==null||m.call(o),c.current===null&&(c.current=window.setInterval(r,50))}),onPointerLeave:ot(i.onPointerLeave,()=>{u()})})}),aO="SelectSeparator",Jy=f.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t;return e.jsx(It.div,{"aria-hidden":!0,...r,ref:n})});Jy.displayName=aO;var qm="SelectArrow",iO=f.forwardRef((t,n)=>{const{__scopeSelect:s,...r}=t,i=_d(s),o=Ba(qm,s),c=Wa(qm,s);return o.open&&c.position==="popper"?e.jsx(Ev,{...i,...r,ref:n}):null});iO.displayName=qm;function Xy(t){return t===""||t===void 0}var Zy=f.forwardRef((t,n)=>{const{value:s,...r}=t,i=f.useRef(null),o=is(n,i),c=F0(s);return f.useEffect(()=>{const d=i.current,u=window.HTMLSelectElement.prototype,p=Object.getOwnPropertyDescriptor(u,"value").set;if(c!==s&&p){const x=new Event("change",{bubbles:!0});p.call(d,s),d.dispatchEvent(x)}},[c,s]),e.jsx(Sf,{asChild:!0,children:e.jsx("select",{...r,ref:o,defaultValue:s})})});Zy.displayName="BubbleSelect";function Qy(t){const n=Zr(t),s=f.useRef(""),r=f.useRef(0),i=f.useCallback(c=>{const d=s.current+c;n(d),function u(m){s.current=m,window.clearTimeout(r.current),m!==""&&(r.current=window.setTimeout(()=>u(""),1e3))}(d)},[n]),o=f.useCallback(()=>{s.current="",window.clearTimeout(r.current)},[]);return f.useEffect(()=>()=>window.clearTimeout(r.current),[]),[s,i,o]}function eb(t,n,s){const i=n.length>1&&Array.from(n).every(m=>m===n[0])?n[0]:n,o=s?t.indexOf(s):-1;let c=oO(t,Math.max(o,0));i.length===1&&(c=c.filter(m=>m!==s));const u=c.find(m=>m.textValue.toLowerCase().startsWith(i.toLowerCase()));return u!==s?u:void 0}function oO(t,n){return t.map((s,r)=>t[(n+r)%t.length])}var lO=Ty,tb=_y,cO=Ay,dO=Ry,uO=Py,sb=Iy,mO=$y,nb=By,rb=Hy,fO=Uy,pO=Gy,ab=qy,ib=Yy,ob=Jy;const ft=lO,pt=cO,ct=f.forwardRef(({className:t,children:n,...s},r)=>e.jsxs(tb,{ref:r,className:ce("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...s,children:[n,e.jsx(dO,{asChild:!0,children:e.jsx(Dr,{className:"h-4 w-4 opacity-50"})})]}));ct.displayName=tb.displayName;const lb=f.forwardRef(({className:t,...n},s)=>e.jsx(ab,{ref:s,className:ce("flex cursor-default items-center justify-center py-1",t),...n,children:e.jsx(ud,{className:"h-4 w-4"})}));lb.displayName=ab.displayName;const cb=f.forwardRef(({className:t,...n},s)=>e.jsx(ib,{ref:s,className:ce("flex cursor-default items-center justify-center py-1",t),...n,children:e.jsx(Dr,{className:"h-4 w-4"})}));cb.displayName=ib.displayName;const dt=f.forwardRef(({className:t,children:n,position:s="popper",...r},i)=>e.jsx(uO,{children:e.jsxs(sb,{ref:i,className:ce("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...r,children:[e.jsx(lb,{}),e.jsx(mO,{className:ce("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),e.jsx(cb,{})]})}));dt.displayName=sb.displayName;const hO=f.forwardRef(({className:t,...n},s)=>e.jsx(nb,{ref:s,className:ce("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n}));hO.displayName=nb.displayName;const De=f.forwardRef(({className:t,children:n,...s},r)=>e.jsxs(rb,{ref:r,className:ce("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(pO,{children:e.jsx(Hi,{className:"h-4 w-4"})})}),e.jsx(fO,{children:n})]}));De.displayName=rb.displayName;const xO=f.forwardRef(({className:t,...n},s)=>e.jsx(ob,{ref:s,className:ce("-mx-1 my-1 h-px bg-muted",t),...n}));xO.displayName=ob.displayName;function gO(t,n){return f.useReducer((s,r)=>n[s][r]??s,t)}var Ff="ScrollArea",[db,C$]=za(Ff),[vO,Wn]=db(Ff),ub=f.forwardRef((t,n)=>{const{__scopeScrollArea:s,type:r="hover",dir:i,scrollHideDelay:o=600,...c}=t,[d,u]=f.useState(null),[m,p]=f.useState(null),[x,g]=f.useState(null),[v,j]=f.useState(null),[b,y]=f.useState(null),[N,S]=f.useState(0),[E,T]=f.useState(0),[k,M]=f.useState(!1),[R,I]=f.useState(!1),O=is(n,$=>u($)),H=cl(i);return e.jsx(vO,{scope:s,type:r,dir:H,scrollHideDelay:o,scrollArea:d,viewport:m,onViewportChange:p,content:x,onContentChange:g,scrollbarX:v,onScrollbarXChange:j,scrollbarXEnabled:k,onScrollbarXEnabledChange:M,scrollbarY:b,onScrollbarYChange:y,scrollbarYEnabled:R,onScrollbarYEnabledChange:I,onCornerWidthChange:S,onCornerHeightChange:T,children:e.jsx(It.div,{dir:H,...c,ref:O,style:{position:"relative","--radix-scroll-area-corner-width":N+"px","--radix-scroll-area-corner-height":E+"px",...t.style}})})});ub.displayName=Ff;var mb="ScrollAreaViewport",fb=f.forwardRef((t,n)=>{const{__scopeScrollArea:s,children:r,asChild:i,nonce:o,...c}=t,d=Wn(mb,s),u=f.useRef(null),m=is(n,u,d.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:o}),e.jsx(It.div,{"data-radix-scroll-area-viewport":"",...c,asChild:i,ref:m,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...t.style},children:kO({asChild:i,children:r},p=>e.jsx("div",{"data-radix-scroll-area-content":"",ref:d.onContentChange,style:{minWidth:d.scrollbarXEnabled?"fit-content":void 0},children:p}))})]})});fb.displayName=mb;var Pr="ScrollAreaScrollbar",Bf=f.forwardRef((t,n)=>{const{forceMount:s,...r}=t,i=Wn(Pr,t.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:c}=i,d=t.orientation==="horizontal";return f.useEffect(()=>(d?o(!0):c(!0),()=>{d?o(!1):c(!1)}),[d,o,c]),i.type==="hover"?e.jsx(yO,{...r,ref:n,forceMount:s}):i.type==="scroll"?e.jsx(bO,{...r,ref:n,forceMount:s}):i.type==="auto"?e.jsx(pb,{...r,ref:n,forceMount:s}):i.type==="always"?e.jsx(Wf,{...r,ref:n}):null});Bf.displayName=Pr;var yO=f.forwardRef((t,n)=>{const{forceMount:s,...r}=t,i=Wn(Pr,t.__scopeScrollArea),[o,c]=f.useState(!1);return f.useEffect(()=>{const d=i.scrollArea;let u=0;if(d){const m=()=>{window.clearTimeout(u),c(!0)},p=()=>{u=window.setTimeout(()=>c(!1),i.scrollHideDelay)};return d.addEventListener("pointerenter",m),d.addEventListener("pointerleave",p),()=>{window.clearTimeout(u),d.removeEventListener("pointerenter",m),d.removeEventListener("pointerleave",p)}}},[i.scrollArea,i.scrollHideDelay]),e.jsx(zi,{present:s||o,children:e.jsx(pb,{"data-state":o?"visible":"hidden",...r,ref:n})})}),bO=f.forwardRef((t,n)=>{const{forceMount:s,...r}=t,i=Wn(Pr,t.__scopeScrollArea),o=t.orientation==="horizontal",c=Ad(()=>u("SCROLL_END"),100),[d,u]=gO("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return f.useEffect(()=>{if(d==="idle"){const m=window.setTimeout(()=>u("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(m)}},[d,i.scrollHideDelay,u]),f.useEffect(()=>{const m=i.viewport,p=o?"scrollLeft":"scrollTop";if(m){let x=m[p];const g=()=>{const v=m[p];x!==v&&(u("SCROLL"),c()),x=v};return m.addEventListener("scroll",g),()=>m.removeEventListener("scroll",g)}},[i.viewport,o,u,c]),e.jsx(zi,{present:s||d!=="hidden",children:e.jsx(Wf,{"data-state":d==="hidden"?"hidden":"visible",...r,ref:n,onPointerEnter:ot(t.onPointerEnter,()=>u("POINTER_ENTER")),onPointerLeave:ot(t.onPointerLeave,()=>u("POINTER_LEAVE"))})})}),pb=f.forwardRef((t,n)=>{const s=Wn(Pr,t.__scopeScrollArea),{forceMount:r,...i}=t,[o,c]=f.useState(!1),d=t.orientation==="horizontal",u=Ad(()=>{if(s.viewport){const m=s.viewport.offsetWidth<s.viewport.scrollWidth,p=s.viewport.offsetHeight<s.viewport.scrollHeight;c(d?m:p)}},10);return Li(s.viewport,u),Li(s.content,u),e.jsx(zi,{present:r||o,children:e.jsx(Wf,{"data-state":o?"visible":"hidden",...i,ref:n})})}),Wf=f.forwardRef((t,n)=>{const{orientation:s="vertical",...r}=t,i=Wn(Pr,t.__scopeScrollArea),o=f.useRef(null),c=f.useRef(0),[d,u]=f.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),m=yb(d.viewport,d.content),p={...r,sizes:d,onSizesChange:u,hasThumb:m>0&&m<1,onThumbChange:g=>o.current=g,onThumbPointerUp:()=>c.current=0,onThumbPointerDown:g=>c.current=g};function x(g,v){return EO(g,c.current,d,v)}return s==="horizontal"?e.jsx(jO,{...p,ref:n,onThumbPositionChange:()=>{if(i.viewport&&o.current){const g=i.viewport.scrollLeft,v=bg(g,d,i.dir);o.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:g=>{i.viewport&&(i.viewport.scrollLeft=g)},onDragScroll:g=>{i.viewport&&(i.viewport.scrollLeft=x(g,i.dir))}}):s==="vertical"?e.jsx(wO,{...p,ref:n,onThumbPositionChange:()=>{if(i.viewport&&o.current){const g=i.viewport.scrollTop,v=bg(g,d);o.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:g=>{i.viewport&&(i.viewport.scrollTop=g)},onDragScroll:g=>{i.viewport&&(i.viewport.scrollTop=x(g))}}):null}),jO=f.forwardRef((t,n)=>{const{sizes:s,onSizesChange:r,...i}=t,o=Wn(Pr,t.__scopeScrollArea),[c,d]=f.useState(),u=f.useRef(null),m=is(n,u,o.onScrollbarXChange);return f.useEffect(()=>{u.current&&d(getComputedStyle(u.current))},[u]),e.jsx(xb,{"data-orientation":"horizontal",...i,ref:m,sizes:s,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Dd(s)+"px",...t.style},onThumbPointerDown:p=>t.onThumbPointerDown(p.x),onDragScroll:p=>t.onDragScroll(p.x),onWheelScroll:(p,x)=>{if(o.viewport){const g=o.viewport.scrollLeft+p.deltaX;t.onWheelScroll(g),jb(g,x)&&p.preventDefault()}},onResize:()=>{u.current&&o.viewport&&c&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:Yc(c.paddingLeft),paddingEnd:Yc(c.paddingRight)}})}})}),wO=f.forwardRef((t,n)=>{const{sizes:s,onSizesChange:r,...i}=t,o=Wn(Pr,t.__scopeScrollArea),[c,d]=f.useState(),u=f.useRef(null),m=is(n,u,o.onScrollbarYChange);return f.useEffect(()=>{u.current&&d(getComputedStyle(u.current))},[u]),e.jsx(xb,{"data-orientation":"vertical",...i,ref:m,sizes:s,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Dd(s)+"px",...t.style},onThumbPointerDown:p=>t.onThumbPointerDown(p.y),onDragScroll:p=>t.onDragScroll(p.y),onWheelScroll:(p,x)=>{if(o.viewport){const g=o.viewport.scrollTop+p.deltaY;t.onWheelScroll(g),jb(g,x)&&p.preventDefault()}},onResize:()=>{u.current&&o.viewport&&c&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:Yc(c.paddingTop),paddingEnd:Yc(c.paddingBottom)}})}})}),[NO,hb]=db(Pr),xb=f.forwardRef((t,n)=>{const{__scopeScrollArea:s,sizes:r,hasThumb:i,onThumbChange:o,onThumbPointerUp:c,onThumbPointerDown:d,onThumbPositionChange:u,onDragScroll:m,onWheelScroll:p,onResize:x,...g}=t,v=Wn(Pr,s),[j,b]=f.useState(null),y=is(n,O=>b(O)),N=f.useRef(null),S=f.useRef(""),E=v.viewport,T=r.content-r.viewport,k=Zr(p),M=Zr(u),R=Ad(x,10);function I(O){if(N.current){const H=O.clientX-N.current.left,$=O.clientY-N.current.top;m({x:H,y:$})}}return f.useEffect(()=>{const O=H=>{const $=H.target;(j==null?void 0:j.contains($))&&k(H,T)};return document.addEventListener("wheel",O,{passive:!1}),()=>document.removeEventListener("wheel",O,{passive:!1})},[E,j,T,k]),f.useEffect(M,[r,M]),Li(j,R),Li(v.content,R),e.jsx(NO,{scope:s,scrollbar:j,hasThumb:i,onThumbChange:Zr(o),onThumbPointerUp:Zr(c),onThumbPositionChange:M,onThumbPointerDown:Zr(d),children:e.jsx(It.div,{...g,ref:y,style:{position:"absolute",...g.style},onPointerDown:ot(t.onPointerDown,O=>{O.button===0&&(O.target.setPointerCapture(O.pointerId),N.current=j.getBoundingClientRect(),S.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),I(O))}),onPointerMove:ot(t.onPointerMove,I),onPointerUp:ot(t.onPointerUp,O=>{const H=O.target;H.hasPointerCapture(O.pointerId)&&H.releasePointerCapture(O.pointerId),document.body.style.webkitUserSelect=S.current,v.viewport&&(v.viewport.style.scrollBehavior=""),N.current=null})})})}),qc="ScrollAreaThumb",gb=f.forwardRef((t,n)=>{const{forceMount:s,...r}=t,i=hb(qc,t.__scopeScrollArea);return e.jsx(zi,{present:s||i.hasThumb,children:e.jsx(SO,{ref:n,...r})})}),SO=f.forwardRef((t,n)=>{const{__scopeScrollArea:s,style:r,...i}=t,o=Wn(qc,s),c=hb(qc,s),{onThumbPositionChange:d}=c,u=is(n,x=>c.onThumbChange(x)),m=f.useRef(),p=Ad(()=>{m.current&&(m.current(),m.current=void 0)},100);return f.useEffect(()=>{const x=o.viewport;if(x){const g=()=>{if(p(),!m.current){const v=TO(x,d);m.current=v,d()}};return d(),x.addEventListener("scroll",g),()=>x.removeEventListener("scroll",g)}},[o.viewport,p,d]),e.jsx(It.div,{"data-state":c.hasThumb?"visible":"hidden",...i,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:ot(t.onPointerDownCapture,x=>{const v=x.target.getBoundingClientRect(),j=x.clientX-v.left,b=x.clientY-v.top;c.onThumbPointerDown({x:j,y:b})}),onPointerUp:ot(t.onPointerUp,c.onThumbPointerUp)})});gb.displayName=qc;var Hf="ScrollAreaCorner",vb=f.forwardRef((t,n)=>{const s=Wn(Hf,t.__scopeScrollArea),r=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&r?e.jsx(CO,{...t,ref:n}):null});vb.displayName=Hf;var CO=f.forwardRef((t,n)=>{const{__scopeScrollArea:s,...r}=t,i=Wn(Hf,s),[o,c]=f.useState(0),[d,u]=f.useState(0),m=!!(o&&d);return Li(i.scrollbarX,()=>{var x;const p=((x=i.scrollbarX)==null?void 0:x.offsetHeight)||0;i.onCornerHeightChange(p),u(p)}),Li(i.scrollbarY,()=>{var x;const p=((x=i.scrollbarY)==null?void 0:x.offsetWidth)||0;i.onCornerWidthChange(p),c(p)}),m?e.jsx(It.div,{...r,ref:n,style:{width:o,height:d,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Yc(t){return t?parseInt(t,10):0}function yb(t,n){const s=t/n;return isNaN(s)?0:s}function Dd(t){const n=yb(t.viewport,t.content),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-s)*n;return Math.max(r,18)}function EO(t,n,s,r="ltr"){const i=Dd(s),o=i/2,c=n||o,d=i-c,u=s.scrollbar.paddingStart+c,m=s.scrollbar.size-s.scrollbar.paddingEnd-d,p=s.content-s.viewport,x=r==="ltr"?[0,p]:[p*-1,0];return bb([u,m],x)(t)}function bg(t,n,s="ltr"){const r=Dd(n),i=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,o=n.scrollbar.size-i,c=n.content-n.viewport,d=o-r,u=s==="ltr"?[0,c]:[c*-1,0],m=Bm(t,u);return bb([0,c],[0,d])(m)}function bb(t,n){return s=>{if(t[0]===t[1]||n[0]===n[1])return n[0];const r=(n[1]-n[0])/(t[1]-t[0]);return n[0]+r*(s-t[0])}}function jb(t,n){return t>0&&t<n}var TO=(t,n=()=>{})=>{let s={left:t.scrollLeft,top:t.scrollTop},r=0;return function i(){const o={left:t.scrollLeft,top:t.scrollTop},c=s.left!==o.left,d=s.top!==o.top;(c||d)&&n(),s=o,r=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(r)};function Ad(t,n){const s=Zr(t),r=f.useRef(0);return f.useEffect(()=>()=>window.clearTimeout(r.current),[]),f.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(s,n)},[s,n])}function Li(t,n){const s=Zr(n);rr(()=>{let r=0;if(t){const i=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(s)});return i.observe(t),()=>{window.cancelAnimationFrame(r),i.unobserve(t)}}},[t,s])}function kO(t,n){const{asChild:s,children:r}=t;if(!s)return typeof n=="function"?n(r):n;const i=f.Children.only(r);return f.cloneElement(i,{children:typeof n=="function"?n(i.props.children):n})}var wb=ub,_O=fb,DO=vb;const Uf=f.forwardRef(({className:t,children:n,...s},r)=>e.jsxs(wb,{ref:r,className:ce("relative overflow-hidden",t),...s,children:[e.jsx(_O,{className:"h-full w-full rounded-[inherit]",children:n}),e.jsx(Nb,{}),e.jsx(DO,{})]}));Uf.displayName=wb.displayName;const Nb=f.forwardRef(({className:t,orientation:n="vertical",...s},r)=>e.jsx(Bf,{ref:r,orientation:n,className:ce("flex touch-none select-none transition-colors",n==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",n==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...s,children:e.jsx(gb,{className:"relative flex-1 rounded-full bg-border"})}));Nb.displayName=Bf.displayName;const AO=({isOpen:t,onClose:n,onSelect:s})=>{var p;const[r,i]=f.useState(null),[o,c]=f.useState("water"),d=Object.entries(dn).reduce((x,[g,v])=>{const j=v.category;return x[j]||(x[j]=[]),x[j].push({key:g,...v}),x},{}),u=x=>{i(r===x?null:x)},m=x=>{r&&(s(r,x),i(null),n())};return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"sm:max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsx(bt,{children:e.jsx(jt,{className:"text-xl",children:"Seleccionar bebida"})}),e.jsxs("div",{className:"flex flex-col gap-4 flex-1",children:[e.jsxs(ft,{value:o,onValueChange:c,children:[e.jsx(ct,{className:"w-full md:w-64",children:e.jsx(pt,{placeholder:"Selecciona una categoría"})}),e.jsx(dt,{children:Object.entries(rl).map(([x,g])=>e.jsx(De,{value:x,children:g},x))})]}),e.jsx(Uf,{className:"flex-1",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 p-1",children:(p=d[o])==null?void 0:p.map(x=>{const g=La[x.icon],v=r===x.key;return e.jsx("div",{className:"relative",children:e.jsxs(F,{variant:v?"default":"outline",className:"w-full h-20 flex flex-col items-center justify-center gap-2 p-3 text-center transition-all hover:scale-105 transform",onClick:()=>u(x.key),children:[e.jsx(g,{className:`w-6 h-6 ${v?"text-white":x.color} flex-shrink-0`}),e.jsx("span",{className:"text-xs leading-tight break-words font-medium",children:x.name})]})},x.key)})})}),r&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-3 sm:flex-shrink-0",children:(()=>{const x=dn[r],g=La[x.icon];return e.jsxs(e.Fragment,{children:[e.jsx(g,{className:`w-6 h-6 ${x.color}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:x.name}),e.jsx("p",{className:"text-sm text-gray-600",children:"Selecciona la cantidad"})]})]})})()}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2",children:dn[r].amounts.map(x=>e.jsxs(F,{variant:"outline",size:"sm",className:"bg-white hover:bg-blue-50 border-blue-200 text-blue-700 font-medium transition-all hover:scale-105 transform",onClick:()=>m(x),children:[x,"ml"]},x))})}),e.jsx(F,{variant:"ghost",size:"sm",className:"text-gray-500 hover:text-gray-700 sm:flex-shrink-0",onClick:()=>i(null),children:"✕"})]})})]})]})})},RO=["water","sparklingWater","flavoredWater","coffee","tea","aromatica","milk","juice","sportsdrink","soda","energyDrink"],PO=({selectedDrink:t,onDrinkSelect:n,onAmountSelect:s,disabled:r})=>{const[i,o]=f.useState(!1),c=(u,m)=>{s(u,m),o(!1)},d=u=>{n(t===u?null:u)};return e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Agregar bebida"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Selecciona una bebida para registrar"})]}),"      ",e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:[RO.map(u=>{const m=dn[u],p=La[m.icon],x=t===u;return e.jsxs(F,{variant:x?"default":"outline",className:ce("h-20 w-full flex flex-col items-center justify-center gap-1 p-2","transition-all duration-200 hover:scale-105",x&&"ring-2 ring-blue-500 ring-offset-1"),onClick:()=>d(u),disabled:r,children:[e.jsx(p,{className:ce("w-5 h-5 flex-shrink-0",x?"text-white":m.color)}),e.jsx("span",{className:"text-xs font-medium leading-tight text-center",children:m.name})]},u)}),e.jsxs(F,{variant:"outline",className:"h-20 w-full flex flex-col items-center justify-center gap-1 p-2 border-dashed border-2 hover:border-blue-300 hover:bg-blue-50",onClick:()=>o(!0),disabled:r,children:[e.jsx(Ns,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Más"})]})]}),t&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:(()=>{const u=dn[t],m=La[u.icon];return e.jsxs(e.Fragment,{children:[e.jsx(m,{className:ce("w-5 h-5",u.color)}),e.jsx("span",{className:"font-medium text-gray-900",children:u.name})]})})()}),e.jsx(F,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-gray-600 h-8 w-8 p-0",onClick:()=>n(null),children:e.jsx(Js,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:dn[t].amounts.map(u=>e.jsx(F,{variant:"outline",className:"h-10 bg-white hover:bg-blue-50 hover:border-blue-300",onClick:()=>{s(t,u),n(null)},children:e.jsxs("span",{className:"font-medium",children:[u,"ml"]})},u))})]}),e.jsx(AO,{isOpen:i,onClose:()=>o(!1),onSelect:c})]})},IO=({drink:t,isOpen:n,onClose:s,onSave:r})=>{const[i,o]=f.useState(""),[c,d]=f.useState("");if(f.useEffect(()=>{t&&(o(t.amount.toString()),d(t.time))},[t]),!t)return null;const u=dn[t.type],m=La[u.icon],p=()=>{const x={...t,amount:parseInt(i),time:c,hydration:parseInt(i)*u.hydrationFactor};r(x),s()};return e.jsx(yt,{open:n,onOpenChange:s,children:e.jsxs(xt,{className:"sm:max-w-md",children:[e.jsx(bt,{children:e.jsxs(jt,{className:"flex items-center gap-2",children:[e.jsx(m,{className:`w-5 h-5 ${u.color}`}),"Editar ",u.name]})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"amount",className:"text-sm font-medium",children:"Cantidad (ml)"}),e.jsx(Ve,{id:"amount",type:"number",value:i,onChange:x=>o(x.target.value),min:"0",step:"50"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("label",{htmlFor:"time",className:"text-sm font-medium",children:"Hora"}),e.jsx(Ve,{id:"time",type:"time",value:c,onChange:x=>d(x.target.value)})]})]}),e.jsxs(en,{className:"sm:justify-start",children:[e.jsx(F,{type:"button",variant:"secondary",onClick:s,children:"Cancelar"}),e.jsx(F,{type:"button",onClick:p,disabled:!i||!c,children:"Guardar cambios"})]})]})})},OO=({drinks:t,showHistory:n,onToggleHistory:s,onDeleteDrink:r,onEditDrink:i,isCurrentDate:o})=>{const[c,d]=f.useState(null),u=(p,x)=>{d({index:p,drink:x})},m=p=>{c&&(i(c.index,p),d(null))};return e.jsxs("div",{children:[e.jsxs(F,{variant:"outline",className:"w-full",onClick:s,children:[n?e.jsx(ud,{className:"w-4 h-4 mr-2"}):e.jsx(Dr,{className:"w-4 h-4 mr-2"}),"Historial de hoy"]}),n&&t.length>0&&e.jsx("div",{className:"mt-4 space-y-2",children:t.map((p,x)=>{const g=dn[p.type],v=La[g.icon];return e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[e.jsx(v,{className:`w-5 h-5 ${g.color} flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:g.name}),e.jsxs("span",{className:"text-muted-foreground text-sm font-medium",children:[p.amount,"ml"]})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:p.time})]}),o&&e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(F,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-accent-foreground/10 touch-manipulation",onClick:()=>u(x,p),title:"Editar",children:e.jsx(md,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(F,{variant:"ghost",size:"icon",className:"h-8 w-8 hover:bg-destructive/10 touch-manipulation",onClick:()=>r(x),title:"Eliminar",children:e.jsx(dl,{className:"h-4 w-4 text-destructive"})})]})]},p.timestamp)})}),n&&t.length===0&&e.jsxs("div",{className:"mt-4 text-center text-muted-foreground text-sm py-4",children:[" ","No hay registros para este día"]}),e.jsx(IO,{drink:(c==null?void 0:c.drink)||null,isOpen:!!c,onClose:()=>d(null),onSave:m})]})},MO=t=>{const[n,s]=f.useState(0),[r,i]=f.useState([]),[o,c]=f.useState("idle"),[d,u]=f.useState(null),{user:m}=He(),p=b=>b.reduce((y,N)=>y+N.hydration,0);f.useEffect(()=>{if(!m)return;const b=Oe(t),y=be(fe,"water",`${m.uid}_${b}`),N=ns(y,S=>{if(S.exists()){const T=S.data().drinks||[],k=p(T);s(k),i(T),S.metadata.hasPendingWrites?c("pending"):c("saved")}else s(0),i([]),c("idle")},S=>{console.error("Error en snapshot:",S),u(S.message),c("error")});return()=>N()},[m,t]);const x=async(b,y)=>{if(m){c("saving"),u(null);try{const N=Oe(t),S=be(fe,"water",`${m.uid}_${N}`),E=new Date,T=ks(t,E.getHours(),E.getMinutes()),k=y*dn[b].hydrationFactor,M={type:b,amount:y,hydration:k,timestamp:T.timestamp.toString(),time:E.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1})},R=[...r,M],I=p(R);await ht(S,{userId:m.uid,date:N,drinks:R,totalWater:I,updatedAt:lt()},{merge:!0})}catch(N){u(N instanceof Error?N.message:"Error al guardar"),c("error")}}},g=async(b,y)=>{if(m){c("saving"),u(null);try{const N=Oe(t),S=be(fe,"water",`${m.uid}_${N}`),[E,T]=y.time.split(":").map(Number),k=ks(t,E,T),M={...y,timestamp:k.timestamp.toString(),hydration:y.amount*dn[y.type].hydrationFactor},R=[...r];R[b]=M;const I=p(R);await ht(S,{userId:m.uid,date:N,drinks:R,totalWater:I,updatedAt:lt()},{merge:!0})}catch(N){u(N instanceof Error?N.message:"Error al editar"),c("error")}}},v=async b=>{if(m){c("saving"),u(null);try{const y=Oe(t),N=be(fe,"water",`${m.uid}_${y}`),S=r.filter((T,k)=>k!==b),E=p(S);await ht(N,{userId:m.uid,date:y,drinks:S,totalWater:E,updatedAt:lt()},{merge:!0})}catch(y){u(y instanceof Error?y.message:"Error al eliminar"),c("error")}}},j=Rr("Water data");return{intake:n,drinks:r,status:o,error:d,addDrink:x,editDrink:g,deleteDrink:v,resync:j}};var Kc={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */Kc.exports;(function(t,n){(function(){var s,r="4.17.21",i=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",d="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",m=500,p="__lodash_placeholder__",x=1,g=2,v=4,j=1,b=2,y=1,N=2,S=4,E=8,T=16,k=32,M=64,R=128,I=256,O=512,H=30,$="...",D=800,P=16,K=1,X=2,G=3,U=1/0,Y=9007199254740991,ae=17976931348623157e292,ye=NaN,oe=4294967295,me=oe-1,W=oe>>>1,se=[["ary",R],["bind",y],["bindKey",N],["curry",E],["curryRight",T],["flip",O],["partial",k],["partialRight",M],["rearg",I]],ge="[object Arguments]",Me="[object Array]",pe="[object AsyncFunction]",_e="[object Boolean]",We="[object Date]",Pe="[object DOMException]",Le="[object Error]",le="[object Function]",Re="[object GeneratorFunction]",Ke="[object Map]",Yt="[object Number]",bs="[object Null]",Dt="[object Object]",z="[object Promise]",Z="[object Proxy]",ee="[object RegExp]",he="[object Set]",ve="[object String]",ue="[object Symbol]",Ce="[object Undefined]",Ue="[object WeakMap]",Ze="[object WeakSet]",it="[object ArrayBuffer]",fs="[object DataView]",pr="[object Float32Array]",Rs="[object Float64Array]",Sn="[object Int8Array]",fn="[object Int16Array]",Ws="[object Int32Array]",Xt="[object Uint8Array]",Ps="[object Uint8ClampedArray]",tn="[object Uint16Array]",Ir="[object Uint32Array]",so=/\b__p \+= '';/g,Or=/\b(__p \+=) '' \+/g,Mr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mi=/&(?:amp|lt|gt|quot|#39);/g,Cn=/[&<>"']/g,En=RegExp(mi.source),no=RegExp(Cn.source),Ee=/<%-([\s\S]+?)%>/g,tt=/<%([\s\S]+?)%>/g,Ct=/<%=([\s\S]+?)%>/g,Is=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Cs=/^\w*$/,pn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,sn=/[\\^$.*+?()[\]{}|]/g,Hs=RegExp(sn.source),Kt=/^\s+/,ua=/\s/,Rl=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Pl=/\{\n\/\* \[wrapped with (.+)\] \*/,ro=/,? & /,Il=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Hn=/[()=,{}\[\]\/\s]/,Ol=/\\(\\)?/g,Ml=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ao=/\w*$/,Ll=/^[-+]0x[0-9a-f]+$/i,Bd=/^0b[01]+$/i,Ie=/^\[object .+?Constructor\]$/,V=/^0o[0-7]+$/i,xe=/^(?:0|[1-9]\d*)$/,ke=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Et=/($^)/,js=/['\n\r\u2028\u2029\\]/g,Ht="\\ud800-\\udfff",Os="\\u0300-\\u036f",Un="\\ufe20-\\ufe2f",Ha="\\u20d0-\\u20ff",fi=Os+Un+Ha,ps="\\u2700-\\u27bf",io="a-z\\xdf-\\xf6\\xf8-\\xff",$l="\\xac\\xb1\\xd7\\xf7",Jj="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xj="\\u2000-\\u206f",Zj=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",vp="A-Z\\xc0-\\xd6\\xd8-\\xde",yp="\\ufe0e\\ufe0f",bp=$l+Jj+Xj+Zj,Wd="['’]",Qj="["+Ht+"]",jp="["+bp+"]",zl="["+fi+"]",wp="\\d+",ew="["+ps+"]",Np="["+io+"]",Sp="[^"+Ht+bp+wp+ps+io+vp+"]",Hd="\\ud83c[\\udffb-\\udfff]",tw="(?:"+zl+"|"+Hd+")",Cp="[^"+Ht+"]",Ud="(?:\\ud83c[\\udde6-\\uddff]){2}",Vd="[\\ud800-\\udbff][\\udc00-\\udfff]",pi="["+vp+"]",Ep="\\u200d",Tp="(?:"+Np+"|"+Sp+")",sw="(?:"+pi+"|"+Sp+")",kp="(?:"+Wd+"(?:d|ll|m|re|s|t|ve))?",_p="(?:"+Wd+"(?:D|LL|M|RE|S|T|VE))?",Dp=tw+"?",Ap="["+yp+"]?",nw="(?:"+Ep+"(?:"+[Cp,Ud,Vd].join("|")+")"+Ap+Dp+")*",rw="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",aw="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Rp=Ap+Dp+nw,iw="(?:"+[ew,Ud,Vd].join("|")+")"+Rp,ow="(?:"+[Cp+zl+"?",zl,Ud,Vd,Qj].join("|")+")",lw=RegExp(Wd,"g"),cw=RegExp(zl,"g"),Gd=RegExp(Hd+"(?="+Hd+")|"+ow+Rp,"g"),dw=RegExp([pi+"?"+Np+"+"+kp+"(?="+[jp,pi,"$"].join("|")+")",sw+"+"+_p+"(?="+[jp,pi+Tp,"$"].join("|")+")",pi+"?"+Tp+"+"+kp,pi+"+"+_p,aw,rw,wp,iw].join("|"),"g"),uw=RegExp("["+Ep+Ht+fi+yp+"]"),mw=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,fw=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],pw=-1,Ft={};Ft[pr]=Ft[Rs]=Ft[Sn]=Ft[fn]=Ft[Ws]=Ft[Xt]=Ft[Ps]=Ft[tn]=Ft[Ir]=!0,Ft[ge]=Ft[Me]=Ft[it]=Ft[_e]=Ft[fs]=Ft[We]=Ft[Le]=Ft[le]=Ft[Ke]=Ft[Yt]=Ft[Dt]=Ft[ee]=Ft[he]=Ft[ve]=Ft[Ue]=!1;var Ot={};Ot[ge]=Ot[Me]=Ot[it]=Ot[fs]=Ot[_e]=Ot[We]=Ot[pr]=Ot[Rs]=Ot[Sn]=Ot[fn]=Ot[Ws]=Ot[Ke]=Ot[Yt]=Ot[Dt]=Ot[ee]=Ot[he]=Ot[ve]=Ot[ue]=Ot[Xt]=Ot[Ps]=Ot[tn]=Ot[Ir]=!0,Ot[Le]=Ot[le]=Ot[Ue]=!1;var hw={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},xw={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},gw={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},vw={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},yw=parseFloat,bw=parseInt,Pp=typeof No=="object"&&No&&No.Object===Object&&No,jw=typeof self=="object"&&self&&self.Object===Object&&self,Es=Pp||jw||Function("return this")(),qd=n&&!n.nodeType&&n,Ua=qd&&!0&&t&&!t.nodeType&&t,Ip=Ua&&Ua.exports===qd,Yd=Ip&&Pp.process,Tn=function(){try{var q=Ua&&Ua.require&&Ua.require("util").types;return q||Yd&&Yd.binding&&Yd.binding("util")}catch{}}(),Op=Tn&&Tn.isArrayBuffer,Mp=Tn&&Tn.isDate,Lp=Tn&&Tn.isMap,$p=Tn&&Tn.isRegExp,zp=Tn&&Tn.isSet,Fp=Tn&&Tn.isTypedArray;function hn(q,te,Q){switch(Q.length){case 0:return q.call(te);case 1:return q.call(te,Q[0]);case 2:return q.call(te,Q[0],Q[1]);case 3:return q.call(te,Q[0],Q[1],Q[2])}return q.apply(te,Q)}function ww(q,te,Q,Se){for(var Ge=-1,gt=q==null?0:q.length;++Ge<gt;){var hs=q[Ge];te(Se,hs,Q(hs),q)}return Se}function kn(q,te){for(var Q=-1,Se=q==null?0:q.length;++Q<Se&&te(q[Q],Q,q)!==!1;);return q}function Nw(q,te){for(var Q=q==null?0:q.length;Q--&&te(q[Q],Q,q)!==!1;);return q}function Bp(q,te){for(var Q=-1,Se=q==null?0:q.length;++Q<Se;)if(!te(q[Q],Q,q))return!1;return!0}function ma(q,te){for(var Q=-1,Se=q==null?0:q.length,Ge=0,gt=[];++Q<Se;){var hs=q[Q];te(hs,Q,q)&&(gt[Ge++]=hs)}return gt}function Fl(q,te){var Q=q==null?0:q.length;return!!Q&&hi(q,te,0)>-1}function Kd(q,te,Q){for(var Se=-1,Ge=q==null?0:q.length;++Se<Ge;)if(Q(te,q[Se]))return!0;return!1}function Ut(q,te){for(var Q=-1,Se=q==null?0:q.length,Ge=Array(Se);++Q<Se;)Ge[Q]=te(q[Q],Q,q);return Ge}function fa(q,te){for(var Q=-1,Se=te.length,Ge=q.length;++Q<Se;)q[Ge+Q]=te[Q];return q}function Jd(q,te,Q,Se){var Ge=-1,gt=q==null?0:q.length;for(Se&&gt&&(Q=q[++Ge]);++Ge<gt;)Q=te(Q,q[Ge],Ge,q);return Q}function Sw(q,te,Q,Se){var Ge=q==null?0:q.length;for(Se&&Ge&&(Q=q[--Ge]);Ge--;)Q=te(Q,q[Ge],Ge,q);return Q}function Xd(q,te){for(var Q=-1,Se=q==null?0:q.length;++Q<Se;)if(te(q[Q],Q,q))return!0;return!1}var Cw=Zd("length");function Ew(q){return q.split("")}function Tw(q){return q.match(Il)||[]}function Wp(q,te,Q){var Se;return Q(q,function(Ge,gt,hs){if(te(Ge,gt,hs))return Se=gt,!1}),Se}function Bl(q,te,Q,Se){for(var Ge=q.length,gt=Q+(Se?1:-1);Se?gt--:++gt<Ge;)if(te(q[gt],gt,q))return gt;return-1}function hi(q,te,Q){return te===te?zw(q,te,Q):Bl(q,Hp,Q)}function kw(q,te,Q,Se){for(var Ge=Q-1,gt=q.length;++Ge<gt;)if(Se(q[Ge],te))return Ge;return-1}function Hp(q){return q!==q}function Up(q,te){var Q=q==null?0:q.length;return Q?eu(q,te)/Q:ye}function Zd(q){return function(te){return te==null?s:te[q]}}function Qd(q){return function(te){return q==null?s:q[te]}}function Vp(q,te,Q,Se,Ge){return Ge(q,function(gt,hs,Rt){Q=Se?(Se=!1,gt):te(Q,gt,hs,Rt)}),Q}function _w(q,te){var Q=q.length;for(q.sort(te);Q--;)q[Q]=q[Q].value;return q}function eu(q,te){for(var Q,Se=-1,Ge=q.length;++Se<Ge;){var gt=te(q[Se]);gt!==s&&(Q=Q===s?gt:Q+gt)}return Q}function tu(q,te){for(var Q=-1,Se=Array(q);++Q<q;)Se[Q]=te(Q);return Se}function Dw(q,te){return Ut(te,function(Q){return[Q,q[Q]]})}function Gp(q){return q&&q.slice(0,Jp(q)+1).replace(Kt,"")}function xn(q){return function(te){return q(te)}}function su(q,te){return Ut(te,function(Q){return q[Q]})}function oo(q,te){return q.has(te)}function qp(q,te){for(var Q=-1,Se=q.length;++Q<Se&&hi(te,q[Q],0)>-1;);return Q}function Yp(q,te){for(var Q=q.length;Q--&&hi(te,q[Q],0)>-1;);return Q}function Aw(q,te){for(var Q=q.length,Se=0;Q--;)q[Q]===te&&++Se;return Se}var Rw=Qd(hw),Pw=Qd(xw);function Iw(q){return"\\"+vw[q]}function Ow(q,te){return q==null?s:q[te]}function xi(q){return uw.test(q)}function Mw(q){return mw.test(q)}function Lw(q){for(var te,Q=[];!(te=q.next()).done;)Q.push(te.value);return Q}function nu(q){var te=-1,Q=Array(q.size);return q.forEach(function(Se,Ge){Q[++te]=[Ge,Se]}),Q}function Kp(q,te){return function(Q){return q(te(Q))}}function pa(q,te){for(var Q=-1,Se=q.length,Ge=0,gt=[];++Q<Se;){var hs=q[Q];(hs===te||hs===p)&&(q[Q]=p,gt[Ge++]=Q)}return gt}function Wl(q){var te=-1,Q=Array(q.size);return q.forEach(function(Se){Q[++te]=Se}),Q}function $w(q){var te=-1,Q=Array(q.size);return q.forEach(function(Se){Q[++te]=[Se,Se]}),Q}function zw(q,te,Q){for(var Se=Q-1,Ge=q.length;++Se<Ge;)if(q[Se]===te)return Se;return-1}function Fw(q,te,Q){for(var Se=Q+1;Se--;)if(q[Se]===te)return Se;return Se}function gi(q){return xi(q)?Ww(q):Cw(q)}function Vn(q){return xi(q)?Hw(q):Ew(q)}function Jp(q){for(var te=q.length;te--&&ua.test(q.charAt(te)););return te}var Bw=Qd(gw);function Ww(q){for(var te=Gd.lastIndex=0;Gd.test(q);)++te;return te}function Hw(q){return q.match(Gd)||[]}function Uw(q){return q.match(dw)||[]}var Vw=function q(te){te=te==null?Es:vi.defaults(Es.Object(),te,vi.pick(Es,fw));var Q=te.Array,Se=te.Date,Ge=te.Error,gt=te.Function,hs=te.Math,Rt=te.Object,ru=te.RegExp,Gw=te.String,_n=te.TypeError,Hl=Q.prototype,qw=gt.prototype,yi=Rt.prototype,Ul=te["__core-js_shared__"],Vl=qw.toString,Tt=yi.hasOwnProperty,Yw=0,Xp=function(){var a=/[^.]+$/.exec(Ul&&Ul.keys&&Ul.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Gl=yi.toString,Kw=Vl.call(Rt),Jw=Es._,Xw=ru("^"+Vl.call(Tt).replace(sn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ql=Ip?te.Buffer:s,ha=te.Symbol,Yl=te.Uint8Array,Zp=ql?ql.allocUnsafe:s,Kl=Kp(Rt.getPrototypeOf,Rt),Qp=Rt.create,eh=yi.propertyIsEnumerable,Jl=Hl.splice,th=ha?ha.isConcatSpreadable:s,lo=ha?ha.iterator:s,Va=ha?ha.toStringTag:s,Xl=function(){try{var a=Ja(Rt,"defineProperty");return a({},"",{}),a}catch{}}(),Zw=te.clearTimeout!==Es.clearTimeout&&te.clearTimeout,Qw=Se&&Se.now!==Es.Date.now&&Se.now,eN=te.setTimeout!==Es.setTimeout&&te.setTimeout,Zl=hs.ceil,Ql=hs.floor,au=Rt.getOwnPropertySymbols,tN=ql?ql.isBuffer:s,sh=te.isFinite,sN=Hl.join,nN=Kp(Rt.keys,Rt),xs=hs.max,Ms=hs.min,rN=Se.now,aN=te.parseInt,nh=hs.random,iN=Hl.reverse,iu=Ja(te,"DataView"),co=Ja(te,"Map"),ou=Ja(te,"Promise"),bi=Ja(te,"Set"),uo=Ja(te,"WeakMap"),mo=Ja(Rt,"create"),ec=uo&&new uo,ji={},oN=Xa(iu),lN=Xa(co),cN=Xa(ou),dN=Xa(bi),uN=Xa(uo),tc=ha?ha.prototype:s,fo=tc?tc.valueOf:s,rh=tc?tc.toString:s;function _(a){if(Zt(a)&&!qe(a)&&!(a instanceof rt)){if(a instanceof Dn)return a;if(Tt.call(a,"__wrapped__"))return ax(a)}return new Dn(a)}var wi=function(){function a(){}return function(l){if(!Jt(l))return{};if(Qp)return Qp(l);a.prototype=l;var h=new a;return a.prototype=s,h}}();function sc(){}function Dn(a,l){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!l,this.__index__=0,this.__values__=s}_.templateSettings={escape:Ee,evaluate:tt,interpolate:Ct,variable:"",imports:{_}},_.prototype=sc.prototype,_.prototype.constructor=_,Dn.prototype=wi(sc.prototype),Dn.prototype.constructor=Dn;function rt(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=oe,this.__views__=[]}function mN(){var a=new rt(this.__wrapped__);return a.__actions__=nn(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=nn(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=nn(this.__views__),a}function fN(){if(this.__filtered__){var a=new rt(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function pN(){var a=this.__wrapped__.value(),l=this.__dir__,h=qe(a),w=l<0,C=h?a.length:0,A=ES(0,C,this.__views__),L=A.start,B=A.end,J=B-L,re=w?B:L-1,ie=this.__iteratees__,de=ie.length,Ne=0,Ae=Ms(J,this.__takeCount__);if(!h||!w&&C==J&&Ae==J)return kh(a,this.__actions__);var ze=[];e:for(;J--&&Ne<Ae;){re+=l;for(var Qe=-1,Fe=a[re];++Qe<de;){var st=ie[Qe],at=st.iteratee,yn=st.type,Gs=at(Fe);if(yn==X)Fe=Gs;else if(!Gs){if(yn==K)continue e;break e}}ze[Ne++]=Fe}return ze}rt.prototype=wi(sc.prototype),rt.prototype.constructor=rt;function Ga(a){var l=-1,h=a==null?0:a.length;for(this.clear();++l<h;){var w=a[l];this.set(w[0],w[1])}}function hN(){this.__data__=mo?mo(null):{},this.size=0}function xN(a){var l=this.has(a)&&delete this.__data__[a];return this.size-=l?1:0,l}function gN(a){var l=this.__data__;if(mo){var h=l[a];return h===u?s:h}return Tt.call(l,a)?l[a]:s}function vN(a){var l=this.__data__;return mo?l[a]!==s:Tt.call(l,a)}function yN(a,l){var h=this.__data__;return this.size+=this.has(a)?0:1,h[a]=mo&&l===s?u:l,this}Ga.prototype.clear=hN,Ga.prototype.delete=xN,Ga.prototype.get=gN,Ga.prototype.has=vN,Ga.prototype.set=yN;function Lr(a){var l=-1,h=a==null?0:a.length;for(this.clear();++l<h;){var w=a[l];this.set(w[0],w[1])}}function bN(){this.__data__=[],this.size=0}function jN(a){var l=this.__data__,h=nc(l,a);if(h<0)return!1;var w=l.length-1;return h==w?l.pop():Jl.call(l,h,1),--this.size,!0}function wN(a){var l=this.__data__,h=nc(l,a);return h<0?s:l[h][1]}function NN(a){return nc(this.__data__,a)>-1}function SN(a,l){var h=this.__data__,w=nc(h,a);return w<0?(++this.size,h.push([a,l])):h[w][1]=l,this}Lr.prototype.clear=bN,Lr.prototype.delete=jN,Lr.prototype.get=wN,Lr.prototype.has=NN,Lr.prototype.set=SN;function $r(a){var l=-1,h=a==null?0:a.length;for(this.clear();++l<h;){var w=a[l];this.set(w[0],w[1])}}function CN(){this.size=0,this.__data__={hash:new Ga,map:new(co||Lr),string:new Ga}}function EN(a){var l=hc(this,a).delete(a);return this.size-=l?1:0,l}function TN(a){return hc(this,a).get(a)}function kN(a){return hc(this,a).has(a)}function _N(a,l){var h=hc(this,a),w=h.size;return h.set(a,l),this.size+=h.size==w?0:1,this}$r.prototype.clear=CN,$r.prototype.delete=EN,$r.prototype.get=TN,$r.prototype.has=kN,$r.prototype.set=_N;function qa(a){var l=-1,h=a==null?0:a.length;for(this.__data__=new $r;++l<h;)this.add(a[l])}function DN(a){return this.__data__.set(a,u),this}function AN(a){return this.__data__.has(a)}qa.prototype.add=qa.prototype.push=DN,qa.prototype.has=AN;function Gn(a){var l=this.__data__=new Lr(a);this.size=l.size}function RN(){this.__data__=new Lr,this.size=0}function PN(a){var l=this.__data__,h=l.delete(a);return this.size=l.size,h}function IN(a){return this.__data__.get(a)}function ON(a){return this.__data__.has(a)}function MN(a,l){var h=this.__data__;if(h instanceof Lr){var w=h.__data__;if(!co||w.length<i-1)return w.push([a,l]),this.size=++h.size,this;h=this.__data__=new $r(w)}return h.set(a,l),this.size=h.size,this}Gn.prototype.clear=RN,Gn.prototype.delete=PN,Gn.prototype.get=IN,Gn.prototype.has=ON,Gn.prototype.set=MN;function ah(a,l){var h=qe(a),w=!h&&Za(a),C=!h&&!w&&ba(a),A=!h&&!w&&!C&&Ei(a),L=h||w||C||A,B=L?tu(a.length,Gw):[],J=B.length;for(var re in a)(l||Tt.call(a,re))&&!(L&&(re=="length"||C&&(re=="offset"||re=="parent")||A&&(re=="buffer"||re=="byteLength"||re=="byteOffset")||Wr(re,J)))&&B.push(re);return B}function ih(a){var l=a.length;return l?a[vu(0,l-1)]:s}function LN(a,l){return xc(nn(a),Ya(l,0,a.length))}function $N(a){return xc(nn(a))}function lu(a,l,h){(h!==s&&!qn(a[l],h)||h===s&&!(l in a))&&zr(a,l,h)}function po(a,l,h){var w=a[l];(!(Tt.call(a,l)&&qn(w,h))||h===s&&!(l in a))&&zr(a,l,h)}function nc(a,l){for(var h=a.length;h--;)if(qn(a[h][0],l))return h;return-1}function zN(a,l,h,w){return xa(a,function(C,A,L){l(w,C,h(C),L)}),w}function oh(a,l){return a&&xr(l,ws(l),a)}function FN(a,l){return a&&xr(l,an(l),a)}function zr(a,l,h){l=="__proto__"&&Xl?Xl(a,l,{configurable:!0,enumerable:!0,value:h,writable:!0}):a[l]=h}function cu(a,l){for(var h=-1,w=l.length,C=Q(w),A=a==null;++h<w;)C[h]=A?s:Hu(a,l[h]);return C}function Ya(a,l,h){return a===a&&(h!==s&&(a=a<=h?a:h),l!==s&&(a=a>=l?a:l)),a}function An(a,l,h,w,C,A){var L,B=l&x,J=l&g,re=l&v;if(h&&(L=C?h(a,w,C,A):h(a)),L!==s)return L;if(!Jt(a))return a;var ie=qe(a);if(ie){if(L=kS(a),!B)return nn(a,L)}else{var de=Ls(a),Ne=de==le||de==Re;if(ba(a))return Ah(a,B);if(de==Dt||de==ge||Ne&&!C){if(L=J||Ne?{}:Jh(a),!B)return J?gS(a,FN(L,a)):xS(a,oh(L,a))}else{if(!Ot[de])return C?a:{};L=_S(a,de,B)}}A||(A=new Gn);var Ae=A.get(a);if(Ae)return Ae;A.set(a,L),Cx(a)?a.forEach(function(Fe){L.add(An(Fe,l,h,Fe,a,A))}):Nx(a)&&a.forEach(function(Fe,st){L.set(st,An(Fe,l,h,st,a,A))});var ze=re?J?_u:ku:J?an:ws,Qe=ie?s:ze(a);return kn(Qe||a,function(Fe,st){Qe&&(st=Fe,Fe=a[st]),po(L,st,An(Fe,l,h,st,a,A))}),L}function BN(a){var l=ws(a);return function(h){return lh(h,a,l)}}function lh(a,l,h){var w=h.length;if(a==null)return!w;for(a=Rt(a);w--;){var C=h[w],A=l[C],L=a[C];if(L===s&&!(C in a)||!A(L))return!1}return!0}function ch(a,l,h){if(typeof a!="function")throw new _n(c);return jo(function(){a.apply(s,h)},l)}function ho(a,l,h,w){var C=-1,A=Fl,L=!0,B=a.length,J=[],re=l.length;if(!B)return J;h&&(l=Ut(l,xn(h))),w?(A=Kd,L=!1):l.length>=i&&(A=oo,L=!1,l=new qa(l));e:for(;++C<B;){var ie=a[C],de=h==null?ie:h(ie);if(ie=w||ie!==0?ie:0,L&&de===de){for(var Ne=re;Ne--;)if(l[Ne]===de)continue e;J.push(ie)}else A(l,de,w)||J.push(ie)}return J}var xa=Mh(hr),dh=Mh(uu,!0);function WN(a,l){var h=!0;return xa(a,function(w,C,A){return h=!!l(w,C,A),h}),h}function rc(a,l,h){for(var w=-1,C=a.length;++w<C;){var A=a[w],L=l(A);if(L!=null&&(B===s?L===L&&!vn(L):h(L,B)))var B=L,J=A}return J}function HN(a,l,h,w){var C=a.length;for(h=Je(h),h<0&&(h=-h>C?0:C+h),w=w===s||w>C?C:Je(w),w<0&&(w+=C),w=h>w?0:Tx(w);h<w;)a[h++]=l;return a}function uh(a,l){var h=[];return xa(a,function(w,C,A){l(w,C,A)&&h.push(w)}),h}function Ts(a,l,h,w,C){var A=-1,L=a.length;for(h||(h=AS),C||(C=[]);++A<L;){var B=a[A];l>0&&h(B)?l>1?Ts(B,l-1,h,w,C):fa(C,B):w||(C[C.length]=B)}return C}var du=Lh(),mh=Lh(!0);function hr(a,l){return a&&du(a,l,ws)}function uu(a,l){return a&&mh(a,l,ws)}function ac(a,l){return ma(l,function(h){return Hr(a[h])})}function Ka(a,l){l=va(l,a);for(var h=0,w=l.length;a!=null&&h<w;)a=a[gr(l[h++])];return h&&h==w?a:s}function fh(a,l,h){var w=l(a);return qe(a)?w:fa(w,h(a))}function Us(a){return a==null?a===s?Ce:bs:Va&&Va in Rt(a)?CS(a):$S(a)}function mu(a,l){return a>l}function UN(a,l){return a!=null&&Tt.call(a,l)}function VN(a,l){return a!=null&&l in Rt(a)}function GN(a,l,h){return a>=Ms(l,h)&&a<xs(l,h)}function fu(a,l,h){for(var w=h?Kd:Fl,C=a[0].length,A=a.length,L=A,B=Q(A),J=1/0,re=[];L--;){var ie=a[L];L&&l&&(ie=Ut(ie,xn(l))),J=Ms(ie.length,J),B[L]=!h&&(l||C>=120&&ie.length>=120)?new qa(L&&ie):s}ie=a[0];var de=-1,Ne=B[0];e:for(;++de<C&&re.length<J;){var Ae=ie[de],ze=l?l(Ae):Ae;if(Ae=h||Ae!==0?Ae:0,!(Ne?oo(Ne,ze):w(re,ze,h))){for(L=A;--L;){var Qe=B[L];if(!(Qe?oo(Qe,ze):w(a[L],ze,h)))continue e}Ne&&Ne.push(ze),re.push(Ae)}}return re}function qN(a,l,h,w){return hr(a,function(C,A,L){l(w,h(C),A,L)}),w}function xo(a,l,h){l=va(l,a),a=ex(a,l);var w=a==null?a:a[gr(Pn(l))];return w==null?s:hn(w,a,h)}function ph(a){return Zt(a)&&Us(a)==ge}function YN(a){return Zt(a)&&Us(a)==it}function KN(a){return Zt(a)&&Us(a)==We}function go(a,l,h,w,C){return a===l?!0:a==null||l==null||!Zt(a)&&!Zt(l)?a!==a&&l!==l:JN(a,l,h,w,go,C)}function JN(a,l,h,w,C,A){var L=qe(a),B=qe(l),J=L?Me:Ls(a),re=B?Me:Ls(l);J=J==ge?Dt:J,re=re==ge?Dt:re;var ie=J==Dt,de=re==Dt,Ne=J==re;if(Ne&&ba(a)){if(!ba(l))return!1;L=!0,ie=!1}if(Ne&&!ie)return A||(A=new Gn),L||Ei(a)?qh(a,l,h,w,C,A):NS(a,l,J,h,w,C,A);if(!(h&j)){var Ae=ie&&Tt.call(a,"__wrapped__"),ze=de&&Tt.call(l,"__wrapped__");if(Ae||ze){var Qe=Ae?a.value():a,Fe=ze?l.value():l;return A||(A=new Gn),C(Qe,Fe,h,w,A)}}return Ne?(A||(A=new Gn),SS(a,l,h,w,C,A)):!1}function XN(a){return Zt(a)&&Ls(a)==Ke}function pu(a,l,h,w){var C=h.length,A=C,L=!w;if(a==null)return!A;for(a=Rt(a);C--;){var B=h[C];if(L&&B[2]?B[1]!==a[B[0]]:!(B[0]in a))return!1}for(;++C<A;){B=h[C];var J=B[0],re=a[J],ie=B[1];if(L&&B[2]){if(re===s&&!(J in a))return!1}else{var de=new Gn;if(w)var Ne=w(re,ie,J,a,l,de);if(!(Ne===s?go(ie,re,j|b,w,de):Ne))return!1}}return!0}function hh(a){if(!Jt(a)||PS(a))return!1;var l=Hr(a)?Xw:Ie;return l.test(Xa(a))}function ZN(a){return Zt(a)&&Us(a)==ee}function QN(a){return Zt(a)&&Ls(a)==he}function eS(a){return Zt(a)&&wc(a.length)&&!!Ft[Us(a)]}function xh(a){return typeof a=="function"?a:a==null?on:typeof a=="object"?qe(a)?yh(a[0],a[1]):vh(a):$x(a)}function hu(a){if(!bo(a))return nN(a);var l=[];for(var h in Rt(a))Tt.call(a,h)&&h!="constructor"&&l.push(h);return l}function tS(a){if(!Jt(a))return LS(a);var l=bo(a),h=[];for(var w in a)w=="constructor"&&(l||!Tt.call(a,w))||h.push(w);return h}function xu(a,l){return a<l}function gh(a,l){var h=-1,w=rn(a)?Q(a.length):[];return xa(a,function(C,A,L){w[++h]=l(C,A,L)}),w}function vh(a){var l=Au(a);return l.length==1&&l[0][2]?Zh(l[0][0],l[0][1]):function(h){return h===a||pu(h,a,l)}}function yh(a,l){return Pu(a)&&Xh(l)?Zh(gr(a),l):function(h){var w=Hu(h,a);return w===s&&w===l?Uu(h,a):go(l,w,j|b)}}function ic(a,l,h,w,C){a!==l&&du(l,function(A,L){if(C||(C=new Gn),Jt(A))sS(a,l,L,h,ic,w,C);else{var B=w?w(Ou(a,L),A,L+"",a,l,C):s;B===s&&(B=A),lu(a,L,B)}},an)}function sS(a,l,h,w,C,A,L){var B=Ou(a,h),J=Ou(l,h),re=L.get(J);if(re){lu(a,h,re);return}var ie=A?A(B,J,h+"",a,l,L):s,de=ie===s;if(de){var Ne=qe(J),Ae=!Ne&&ba(J),ze=!Ne&&!Ae&&Ei(J);ie=J,Ne||Ae||ze?qe(B)?ie=B:es(B)?ie=nn(B):Ae?(de=!1,ie=Ah(J,!0)):ze?(de=!1,ie=Rh(J,!0)):ie=[]:wo(J)||Za(J)?(ie=B,Za(B)?ie=kx(B):(!Jt(B)||Hr(B))&&(ie=Jh(J))):de=!1}de&&(L.set(J,ie),C(ie,J,w,A,L),L.delete(J)),lu(a,h,ie)}function bh(a,l){var h=a.length;if(h)return l+=l<0?h:0,Wr(l,h)?a[l]:s}function jh(a,l,h){l.length?l=Ut(l,function(A){return qe(A)?function(L){return Ka(L,A.length===1?A[0]:A)}:A}):l=[on];var w=-1;l=Ut(l,xn($e()));var C=gh(a,function(A,L,B){var J=Ut(l,function(re){return re(A)});return{criteria:J,index:++w,value:A}});return _w(C,function(A,L){return hS(A,L,h)})}function nS(a,l){return wh(a,l,function(h,w){return Uu(a,w)})}function wh(a,l,h){for(var w=-1,C=l.length,A={};++w<C;){var L=l[w],B=Ka(a,L);h(B,L)&&vo(A,va(L,a),B)}return A}function rS(a){return function(l){return Ka(l,a)}}function gu(a,l,h,w){var C=w?kw:hi,A=-1,L=l.length,B=a;for(a===l&&(l=nn(l)),h&&(B=Ut(a,xn(h)));++A<L;)for(var J=0,re=l[A],ie=h?h(re):re;(J=C(B,ie,J,w))>-1;)B!==a&&Jl.call(B,J,1),Jl.call(a,J,1);return a}function Nh(a,l){for(var h=a?l.length:0,w=h-1;h--;){var C=l[h];if(h==w||C!==A){var A=C;Wr(C)?Jl.call(a,C,1):ju(a,C)}}return a}function vu(a,l){return a+Ql(nh()*(l-a+1))}function aS(a,l,h,w){for(var C=-1,A=xs(Zl((l-a)/(h||1)),0),L=Q(A);A--;)L[w?A:++C]=a,a+=h;return L}function yu(a,l){var h="";if(!a||l<1||l>Y)return h;do l%2&&(h+=a),l=Ql(l/2),l&&(a+=a);while(l);return h}function et(a,l){return Mu(Qh(a,l,on),a+"")}function iS(a){return ih(Ti(a))}function oS(a,l){var h=Ti(a);return xc(h,Ya(l,0,h.length))}function vo(a,l,h,w){if(!Jt(a))return a;l=va(l,a);for(var C=-1,A=l.length,L=A-1,B=a;B!=null&&++C<A;){var J=gr(l[C]),re=h;if(J==="__proto__"||J==="constructor"||J==="prototype")return a;if(C!=L){var ie=B[J];re=w?w(ie,J,B):s,re===s&&(re=Jt(ie)?ie:Wr(l[C+1])?[]:{})}po(B,J,re),B=B[J]}return a}var Sh=ec?function(a,l){return ec.set(a,l),a}:on,lS=Xl?function(a,l){return Xl(a,"toString",{configurable:!0,enumerable:!1,value:Gu(l),writable:!0})}:on;function cS(a){return xc(Ti(a))}function Rn(a,l,h){var w=-1,C=a.length;l<0&&(l=-l>C?0:C+l),h=h>C?C:h,h<0&&(h+=C),C=l>h?0:h-l>>>0,l>>>=0;for(var A=Q(C);++w<C;)A[w]=a[w+l];return A}function dS(a,l){var h;return xa(a,function(w,C,A){return h=l(w,C,A),!h}),!!h}function oc(a,l,h){var w=0,C=a==null?w:a.length;if(typeof l=="number"&&l===l&&C<=W){for(;w<C;){var A=w+C>>>1,L=a[A];L!==null&&!vn(L)&&(h?L<=l:L<l)?w=A+1:C=A}return C}return bu(a,l,on,h)}function bu(a,l,h,w){var C=0,A=a==null?0:a.length;if(A===0)return 0;l=h(l);for(var L=l!==l,B=l===null,J=vn(l),re=l===s;C<A;){var ie=Ql((C+A)/2),de=h(a[ie]),Ne=de!==s,Ae=de===null,ze=de===de,Qe=vn(de);if(L)var Fe=w||ze;else re?Fe=ze&&(w||Ne):B?Fe=ze&&Ne&&(w||!Ae):J?Fe=ze&&Ne&&!Ae&&(w||!Qe):Ae||Qe?Fe=!1:Fe=w?de<=l:de<l;Fe?C=ie+1:A=ie}return Ms(A,me)}function Ch(a,l){for(var h=-1,w=a.length,C=0,A=[];++h<w;){var L=a[h],B=l?l(L):L;if(!h||!qn(B,J)){var J=B;A[C++]=L===0?0:L}}return A}function Eh(a){return typeof a=="number"?a:vn(a)?ye:+a}function gn(a){if(typeof a=="string")return a;if(qe(a))return Ut(a,gn)+"";if(vn(a))return rh?rh.call(a):"";var l=a+"";return l=="0"&&1/a==-U?"-0":l}function ga(a,l,h){var w=-1,C=Fl,A=a.length,L=!0,B=[],J=B;if(h)L=!1,C=Kd;else if(A>=i){var re=l?null:jS(a);if(re)return Wl(re);L=!1,C=oo,J=new qa}else J=l?[]:B;e:for(;++w<A;){var ie=a[w],de=l?l(ie):ie;if(ie=h||ie!==0?ie:0,L&&de===de){for(var Ne=J.length;Ne--;)if(J[Ne]===de)continue e;l&&J.push(de),B.push(ie)}else C(J,de,h)||(J!==B&&J.push(de),B.push(ie))}return B}function ju(a,l){return l=va(l,a),a=ex(a,l),a==null||delete a[gr(Pn(l))]}function Th(a,l,h,w){return vo(a,l,h(Ka(a,l)),w)}function lc(a,l,h,w){for(var C=a.length,A=w?C:-1;(w?A--:++A<C)&&l(a[A],A,a););return h?Rn(a,w?0:A,w?A+1:C):Rn(a,w?A+1:0,w?C:A)}function kh(a,l){var h=a;return h instanceof rt&&(h=h.value()),Jd(l,function(w,C){return C.func.apply(C.thisArg,fa([w],C.args))},h)}function wu(a,l,h){var w=a.length;if(w<2)return w?ga(a[0]):[];for(var C=-1,A=Q(w);++C<w;)for(var L=a[C],B=-1;++B<w;)B!=C&&(A[C]=ho(A[C]||L,a[B],l,h));return ga(Ts(A,1),l,h)}function _h(a,l,h){for(var w=-1,C=a.length,A=l.length,L={};++w<C;){var B=w<A?l[w]:s;h(L,a[w],B)}return L}function Nu(a){return es(a)?a:[]}function Su(a){return typeof a=="function"?a:on}function va(a,l){return qe(a)?a:Pu(a,l)?[a]:rx(wt(a))}var uS=et;function ya(a,l,h){var w=a.length;return h=h===s?w:h,!l&&h>=w?a:Rn(a,l,h)}var Dh=Zw||function(a){return Es.clearTimeout(a)};function Ah(a,l){if(l)return a.slice();var h=a.length,w=Zp?Zp(h):new a.constructor(h);return a.copy(w),w}function Cu(a){var l=new a.constructor(a.byteLength);return new Yl(l).set(new Yl(a)),l}function mS(a,l){var h=l?Cu(a.buffer):a.buffer;return new a.constructor(h,a.byteOffset,a.byteLength)}function fS(a){var l=new a.constructor(a.source,ao.exec(a));return l.lastIndex=a.lastIndex,l}function pS(a){return fo?Rt(fo.call(a)):{}}function Rh(a,l){var h=l?Cu(a.buffer):a.buffer;return new a.constructor(h,a.byteOffset,a.length)}function Ph(a,l){if(a!==l){var h=a!==s,w=a===null,C=a===a,A=vn(a),L=l!==s,B=l===null,J=l===l,re=vn(l);if(!B&&!re&&!A&&a>l||A&&L&&J&&!B&&!re||w&&L&&J||!h&&J||!C)return 1;if(!w&&!A&&!re&&a<l||re&&h&&C&&!w&&!A||B&&h&&C||!L&&C||!J)return-1}return 0}function hS(a,l,h){for(var w=-1,C=a.criteria,A=l.criteria,L=C.length,B=h.length;++w<L;){var J=Ph(C[w],A[w]);if(J){if(w>=B)return J;var re=h[w];return J*(re=="desc"?-1:1)}}return a.index-l.index}function Ih(a,l,h,w){for(var C=-1,A=a.length,L=h.length,B=-1,J=l.length,re=xs(A-L,0),ie=Q(J+re),de=!w;++B<J;)ie[B]=l[B];for(;++C<L;)(de||C<A)&&(ie[h[C]]=a[C]);for(;re--;)ie[B++]=a[C++];return ie}function Oh(a,l,h,w){for(var C=-1,A=a.length,L=-1,B=h.length,J=-1,re=l.length,ie=xs(A-B,0),de=Q(ie+re),Ne=!w;++C<ie;)de[C]=a[C];for(var Ae=C;++J<re;)de[Ae+J]=l[J];for(;++L<B;)(Ne||C<A)&&(de[Ae+h[L]]=a[C++]);return de}function nn(a,l){var h=-1,w=a.length;for(l||(l=Q(w));++h<w;)l[h]=a[h];return l}function xr(a,l,h,w){var C=!h;h||(h={});for(var A=-1,L=l.length;++A<L;){var B=l[A],J=w?w(h[B],a[B],B,h,a):s;J===s&&(J=a[B]),C?zr(h,B,J):po(h,B,J)}return h}function xS(a,l){return xr(a,Ru(a),l)}function gS(a,l){return xr(a,Yh(a),l)}function cc(a,l){return function(h,w){var C=qe(h)?ww:zN,A=l?l():{};return C(h,a,$e(w,2),A)}}function Ni(a){return et(function(l,h){var w=-1,C=h.length,A=C>1?h[C-1]:s,L=C>2?h[2]:s;for(A=a.length>3&&typeof A=="function"?(C--,A):s,L&&Vs(h[0],h[1],L)&&(A=C<3?s:A,C=1),l=Rt(l);++w<C;){var B=h[w];B&&a(l,B,w,A)}return l})}function Mh(a,l){return function(h,w){if(h==null)return h;if(!rn(h))return a(h,w);for(var C=h.length,A=l?C:-1,L=Rt(h);(l?A--:++A<C)&&w(L[A],A,L)!==!1;);return h}}function Lh(a){return function(l,h,w){for(var C=-1,A=Rt(l),L=w(l),B=L.length;B--;){var J=L[a?B:++C];if(h(A[J],J,A)===!1)break}return l}}function vS(a,l,h){var w=l&y,C=yo(a);function A(){var L=this&&this!==Es&&this instanceof A?C:a;return L.apply(w?h:this,arguments)}return A}function $h(a){return function(l){l=wt(l);var h=xi(l)?Vn(l):s,w=h?h[0]:l.charAt(0),C=h?ya(h,1).join(""):l.slice(1);return w[a]()+C}}function Si(a){return function(l){return Jd(Mx(Ox(l).replace(lw,"")),a,"")}}function yo(a){return function(){var l=arguments;switch(l.length){case 0:return new a;case 1:return new a(l[0]);case 2:return new a(l[0],l[1]);case 3:return new a(l[0],l[1],l[2]);case 4:return new a(l[0],l[1],l[2],l[3]);case 5:return new a(l[0],l[1],l[2],l[3],l[4]);case 6:return new a(l[0],l[1],l[2],l[3],l[4],l[5]);case 7:return new a(l[0],l[1],l[2],l[3],l[4],l[5],l[6])}var h=wi(a.prototype),w=a.apply(h,l);return Jt(w)?w:h}}function yS(a,l,h){var w=yo(a);function C(){for(var A=arguments.length,L=Q(A),B=A,J=Ci(C);B--;)L[B]=arguments[B];var re=A<3&&L[0]!==J&&L[A-1]!==J?[]:pa(L,J);if(A-=re.length,A<h)return Hh(a,l,dc,C.placeholder,s,L,re,s,s,h-A);var ie=this&&this!==Es&&this instanceof C?w:a;return hn(ie,this,L)}return C}function zh(a){return function(l,h,w){var C=Rt(l);if(!rn(l)){var A=$e(h,3);l=ws(l),h=function(B){return A(C[B],B,C)}}var L=a(l,h,w);return L>-1?C[A?l[L]:L]:s}}function Fh(a){return Br(function(l){var h=l.length,w=h,C=Dn.prototype.thru;for(a&&l.reverse();w--;){var A=l[w];if(typeof A!="function")throw new _n(c);if(C&&!L&&pc(A)=="wrapper")var L=new Dn([],!0)}for(w=L?w:h;++w<h;){A=l[w];var B=pc(A),J=B=="wrapper"?Du(A):s;J&&Iu(J[0])&&J[1]==(R|E|k|I)&&!J[4].length&&J[9]==1?L=L[pc(J[0])].apply(L,J[3]):L=A.length==1&&Iu(A)?L[B]():L.thru(A)}return function(){var re=arguments,ie=re[0];if(L&&re.length==1&&qe(ie))return L.plant(ie).value();for(var de=0,Ne=h?l[de].apply(this,re):ie;++de<h;)Ne=l[de].call(this,Ne);return Ne}})}function dc(a,l,h,w,C,A,L,B,J,re){var ie=l&R,de=l&y,Ne=l&N,Ae=l&(E|T),ze=l&O,Qe=Ne?s:yo(a);function Fe(){for(var st=arguments.length,at=Q(st),yn=st;yn--;)at[yn]=arguments[yn];if(Ae)var Gs=Ci(Fe),bn=Aw(at,Gs);if(w&&(at=Ih(at,w,C,Ae)),A&&(at=Oh(at,A,L,Ae)),st-=bn,Ae&&st<re){var ts=pa(at,Gs);return Hh(a,l,dc,Fe.placeholder,h,at,ts,B,J,re-st)}var Yn=de?h:this,Vr=Ne?Yn[a]:a;return st=at.length,B?at=zS(at,B):ze&&st>1&&at.reverse(),ie&&J<st&&(at.length=J),this&&this!==Es&&this instanceof Fe&&(Vr=Qe||yo(Vr)),Vr.apply(Yn,at)}return Fe}function Bh(a,l){return function(h,w){return qN(h,a,l(w),{})}}function uc(a,l){return function(h,w){var C;if(h===s&&w===s)return l;if(h!==s&&(C=h),w!==s){if(C===s)return w;typeof h=="string"||typeof w=="string"?(h=gn(h),w=gn(w)):(h=Eh(h),w=Eh(w)),C=a(h,w)}return C}}function Eu(a){return Br(function(l){return l=Ut(l,xn($e())),et(function(h){var w=this;return a(l,function(C){return hn(C,w,h)})})})}function mc(a,l){l=l===s?" ":gn(l);var h=l.length;if(h<2)return h?yu(l,a):l;var w=yu(l,Zl(a/gi(l)));return xi(l)?ya(Vn(w),0,a).join(""):w.slice(0,a)}function bS(a,l,h,w){var C=l&y,A=yo(a);function L(){for(var B=-1,J=arguments.length,re=-1,ie=w.length,de=Q(ie+J),Ne=this&&this!==Es&&this instanceof L?A:a;++re<ie;)de[re]=w[re];for(;J--;)de[re++]=arguments[++B];return hn(Ne,C?h:this,de)}return L}function Wh(a){return function(l,h,w){return w&&typeof w!="number"&&Vs(l,h,w)&&(h=w=s),l=Ur(l),h===s?(h=l,l=0):h=Ur(h),w=w===s?l<h?1:-1:Ur(w),aS(l,h,w,a)}}function fc(a){return function(l,h){return typeof l=="string"&&typeof h=="string"||(l=In(l),h=In(h)),a(l,h)}}function Hh(a,l,h,w,C,A,L,B,J,re){var ie=l&E,de=ie?L:s,Ne=ie?s:L,Ae=ie?A:s,ze=ie?s:A;l|=ie?k:M,l&=~(ie?M:k),l&S||(l&=~(y|N));var Qe=[a,l,C,Ae,de,ze,Ne,B,J,re],Fe=h.apply(s,Qe);return Iu(a)&&tx(Fe,Qe),Fe.placeholder=w,sx(Fe,a,l)}function Tu(a){var l=hs[a];return function(h,w){if(h=In(h),w=w==null?0:Ms(Je(w),292),w&&sh(h)){var C=(wt(h)+"e").split("e"),A=l(C[0]+"e"+(+C[1]+w));return C=(wt(A)+"e").split("e"),+(C[0]+"e"+(+C[1]-w))}return l(h)}}var jS=bi&&1/Wl(new bi([,-0]))[1]==U?function(a){return new bi(a)}:Ku;function Uh(a){return function(l){var h=Ls(l);return h==Ke?nu(l):h==he?$w(l):Dw(l,a(l))}}function Fr(a,l,h,w,C,A,L,B){var J=l&N;if(!J&&typeof a!="function")throw new _n(c);var re=w?w.length:0;if(re||(l&=~(k|M),w=C=s),L=L===s?L:xs(Je(L),0),B=B===s?B:Je(B),re-=C?C.length:0,l&M){var ie=w,de=C;w=C=s}var Ne=J?s:Du(a),Ae=[a,l,h,w,C,ie,de,A,L,B];if(Ne&&MS(Ae,Ne),a=Ae[0],l=Ae[1],h=Ae[2],w=Ae[3],C=Ae[4],B=Ae[9]=Ae[9]===s?J?0:a.length:xs(Ae[9]-re,0),!B&&l&(E|T)&&(l&=~(E|T)),!l||l==y)var ze=vS(a,l,h);else l==E||l==T?ze=yS(a,l,B):(l==k||l==(y|k))&&!C.length?ze=bS(a,l,h,w):ze=dc.apply(s,Ae);var Qe=Ne?Sh:tx;return sx(Qe(ze,Ae),a,l)}function Vh(a,l,h,w){return a===s||qn(a,yi[h])&&!Tt.call(w,h)?l:a}function Gh(a,l,h,w,C,A){return Jt(a)&&Jt(l)&&(A.set(l,a),ic(a,l,s,Gh,A),A.delete(l)),a}function wS(a){return wo(a)?s:a}function qh(a,l,h,w,C,A){var L=h&j,B=a.length,J=l.length;if(B!=J&&!(L&&J>B))return!1;var re=A.get(a),ie=A.get(l);if(re&&ie)return re==l&&ie==a;var de=-1,Ne=!0,Ae=h&b?new qa:s;for(A.set(a,l),A.set(l,a);++de<B;){var ze=a[de],Qe=l[de];if(w)var Fe=L?w(Qe,ze,de,l,a,A):w(ze,Qe,de,a,l,A);if(Fe!==s){if(Fe)continue;Ne=!1;break}if(Ae){if(!Xd(l,function(st,at){if(!oo(Ae,at)&&(ze===st||C(ze,st,h,w,A)))return Ae.push(at)})){Ne=!1;break}}else if(!(ze===Qe||C(ze,Qe,h,w,A))){Ne=!1;break}}return A.delete(a),A.delete(l),Ne}function NS(a,l,h,w,C,A,L){switch(h){case fs:if(a.byteLength!=l.byteLength||a.byteOffset!=l.byteOffset)return!1;a=a.buffer,l=l.buffer;case it:return!(a.byteLength!=l.byteLength||!A(new Yl(a),new Yl(l)));case _e:case We:case Yt:return qn(+a,+l);case Le:return a.name==l.name&&a.message==l.message;case ee:case ve:return a==l+"";case Ke:var B=nu;case he:var J=w&j;if(B||(B=Wl),a.size!=l.size&&!J)return!1;var re=L.get(a);if(re)return re==l;w|=b,L.set(a,l);var ie=qh(B(a),B(l),w,C,A,L);return L.delete(a),ie;case ue:if(fo)return fo.call(a)==fo.call(l)}return!1}function SS(a,l,h,w,C,A){var L=h&j,B=ku(a),J=B.length,re=ku(l),ie=re.length;if(J!=ie&&!L)return!1;for(var de=J;de--;){var Ne=B[de];if(!(L?Ne in l:Tt.call(l,Ne)))return!1}var Ae=A.get(a),ze=A.get(l);if(Ae&&ze)return Ae==l&&ze==a;var Qe=!0;A.set(a,l),A.set(l,a);for(var Fe=L;++de<J;){Ne=B[de];var st=a[Ne],at=l[Ne];if(w)var yn=L?w(at,st,Ne,l,a,A):w(st,at,Ne,a,l,A);if(!(yn===s?st===at||C(st,at,h,w,A):yn)){Qe=!1;break}Fe||(Fe=Ne=="constructor")}if(Qe&&!Fe){var Gs=a.constructor,bn=l.constructor;Gs!=bn&&"constructor"in a&&"constructor"in l&&!(typeof Gs=="function"&&Gs instanceof Gs&&typeof bn=="function"&&bn instanceof bn)&&(Qe=!1)}return A.delete(a),A.delete(l),Qe}function Br(a){return Mu(Qh(a,s,lx),a+"")}function ku(a){return fh(a,ws,Ru)}function _u(a){return fh(a,an,Yh)}var Du=ec?function(a){return ec.get(a)}:Ku;function pc(a){for(var l=a.name+"",h=ji[l],w=Tt.call(ji,l)?h.length:0;w--;){var C=h[w],A=C.func;if(A==null||A==a)return C.name}return l}function Ci(a){var l=Tt.call(_,"placeholder")?_:a;return l.placeholder}function $e(){var a=_.iteratee||qu;return a=a===qu?xh:a,arguments.length?a(arguments[0],arguments[1]):a}function hc(a,l){var h=a.__data__;return RS(l)?h[typeof l=="string"?"string":"hash"]:h.map}function Au(a){for(var l=ws(a),h=l.length;h--;){var w=l[h],C=a[w];l[h]=[w,C,Xh(C)]}return l}function Ja(a,l){var h=Ow(a,l);return hh(h)?h:s}function CS(a){var l=Tt.call(a,Va),h=a[Va];try{a[Va]=s;var w=!0}catch{}var C=Gl.call(a);return w&&(l?a[Va]=h:delete a[Va]),C}var Ru=au?function(a){return a==null?[]:(a=Rt(a),ma(au(a),function(l){return eh.call(a,l)}))}:Ju,Yh=au?function(a){for(var l=[];a;)fa(l,Ru(a)),a=Kl(a);return l}:Ju,Ls=Us;(iu&&Ls(new iu(new ArrayBuffer(1)))!=fs||co&&Ls(new co)!=Ke||ou&&Ls(ou.resolve())!=z||bi&&Ls(new bi)!=he||uo&&Ls(new uo)!=Ue)&&(Ls=function(a){var l=Us(a),h=l==Dt?a.constructor:s,w=h?Xa(h):"";if(w)switch(w){case oN:return fs;case lN:return Ke;case cN:return z;case dN:return he;case uN:return Ue}return l});function ES(a,l,h){for(var w=-1,C=h.length;++w<C;){var A=h[w],L=A.size;switch(A.type){case"drop":a+=L;break;case"dropRight":l-=L;break;case"take":l=Ms(l,a+L);break;case"takeRight":a=xs(a,l-L);break}}return{start:a,end:l}}function TS(a){var l=a.match(Pl);return l?l[1].split(ro):[]}function Kh(a,l,h){l=va(l,a);for(var w=-1,C=l.length,A=!1;++w<C;){var L=gr(l[w]);if(!(A=a!=null&&h(a,L)))break;a=a[L]}return A||++w!=C?A:(C=a==null?0:a.length,!!C&&wc(C)&&Wr(L,C)&&(qe(a)||Za(a)))}function kS(a){var l=a.length,h=new a.constructor(l);return l&&typeof a[0]=="string"&&Tt.call(a,"index")&&(h.index=a.index,h.input=a.input),h}function Jh(a){return typeof a.constructor=="function"&&!bo(a)?wi(Kl(a)):{}}function _S(a,l,h){var w=a.constructor;switch(l){case it:return Cu(a);case _e:case We:return new w(+a);case fs:return mS(a,h);case pr:case Rs:case Sn:case fn:case Ws:case Xt:case Ps:case tn:case Ir:return Rh(a,h);case Ke:return new w;case Yt:case ve:return new w(a);case ee:return fS(a);case he:return new w;case ue:return pS(a)}}function DS(a,l){var h=l.length;if(!h)return a;var w=h-1;return l[w]=(h>1?"& ":"")+l[w],l=l.join(h>2?", ":" "),a.replace(Rl,`{
/* [wrapped with `+l+`] */
`)}function AS(a){return qe(a)||Za(a)||!!(th&&a&&a[th])}function Wr(a,l){var h=typeof a;return l=l??Y,!!l&&(h=="number"||h!="symbol"&&xe.test(a))&&a>-1&&a%1==0&&a<l}function Vs(a,l,h){if(!Jt(h))return!1;var w=typeof l;return(w=="number"?rn(h)&&Wr(l,h.length):w=="string"&&l in h)?qn(h[l],a):!1}function Pu(a,l){if(qe(a))return!1;var h=typeof a;return h=="number"||h=="symbol"||h=="boolean"||a==null||vn(a)?!0:Cs.test(a)||!Is.test(a)||l!=null&&a in Rt(l)}function RS(a){var l=typeof a;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?a!=="__proto__":a===null}function Iu(a){var l=pc(a),h=_[l];if(typeof h!="function"||!(l in rt.prototype))return!1;if(a===h)return!0;var w=Du(h);return!!w&&a===w[0]}function PS(a){return!!Xp&&Xp in a}var IS=Ul?Hr:Xu;function bo(a){var l=a&&a.constructor,h=typeof l=="function"&&l.prototype||yi;return a===h}function Xh(a){return a===a&&!Jt(a)}function Zh(a,l){return function(h){return h==null?!1:h[a]===l&&(l!==s||a in Rt(h))}}function OS(a){var l=bc(a,function(w){return h.size===m&&h.clear(),w}),h=l.cache;return l}function MS(a,l){var h=a[1],w=l[1],C=h|w,A=C<(y|N|R),L=w==R&&h==E||w==R&&h==I&&a[7].length<=l[8]||w==(R|I)&&l[7].length<=l[8]&&h==E;if(!(A||L))return a;w&y&&(a[2]=l[2],C|=h&y?0:S);var B=l[3];if(B){var J=a[3];a[3]=J?Ih(J,B,l[4]):B,a[4]=J?pa(a[3],p):l[4]}return B=l[5],B&&(J=a[5],a[5]=J?Oh(J,B,l[6]):B,a[6]=J?pa(a[5],p):l[6]),B=l[7],B&&(a[7]=B),w&R&&(a[8]=a[8]==null?l[8]:Ms(a[8],l[8])),a[9]==null&&(a[9]=l[9]),a[0]=l[0],a[1]=C,a}function LS(a){var l=[];if(a!=null)for(var h in Rt(a))l.push(h);return l}function $S(a){return Gl.call(a)}function Qh(a,l,h){return l=xs(l===s?a.length-1:l,0),function(){for(var w=arguments,C=-1,A=xs(w.length-l,0),L=Q(A);++C<A;)L[C]=w[l+C];C=-1;for(var B=Q(l+1);++C<l;)B[C]=w[C];return B[l]=h(L),hn(a,this,B)}}function ex(a,l){return l.length<2?a:Ka(a,Rn(l,0,-1))}function zS(a,l){for(var h=a.length,w=Ms(l.length,h),C=nn(a);w--;){var A=l[w];a[w]=Wr(A,h)?C[A]:s}return a}function Ou(a,l){if(!(l==="constructor"&&typeof a[l]=="function")&&l!="__proto__")return a[l]}var tx=nx(Sh),jo=eN||function(a,l){return Es.setTimeout(a,l)},Mu=nx(lS);function sx(a,l,h){var w=l+"";return Mu(a,DS(w,FS(TS(w),h)))}function nx(a){var l=0,h=0;return function(){var w=rN(),C=P-(w-h);if(h=w,C>0){if(++l>=D)return arguments[0]}else l=0;return a.apply(s,arguments)}}function xc(a,l){var h=-1,w=a.length,C=w-1;for(l=l===s?w:l;++h<l;){var A=vu(h,C),L=a[A];a[A]=a[h],a[h]=L}return a.length=l,a}var rx=OS(function(a){var l=[];return a.charCodeAt(0)===46&&l.push(""),a.replace(pn,function(h,w,C,A){l.push(C?A.replace(Ol,"$1"):w||h)}),l});function gr(a){if(typeof a=="string"||vn(a))return a;var l=a+"";return l=="0"&&1/a==-U?"-0":l}function Xa(a){if(a!=null){try{return Vl.call(a)}catch{}try{return a+""}catch{}}return""}function FS(a,l){return kn(se,function(h){var w="_."+h[0];l&h[1]&&!Fl(a,w)&&a.push(w)}),a.sort()}function ax(a){if(a instanceof rt)return a.clone();var l=new Dn(a.__wrapped__,a.__chain__);return l.__actions__=nn(a.__actions__),l.__index__=a.__index__,l.__values__=a.__values__,l}function BS(a,l,h){(h?Vs(a,l,h):l===s)?l=1:l=xs(Je(l),0);var w=a==null?0:a.length;if(!w||l<1)return[];for(var C=0,A=0,L=Q(Zl(w/l));C<w;)L[A++]=Rn(a,C,C+=l);return L}function WS(a){for(var l=-1,h=a==null?0:a.length,w=0,C=[];++l<h;){var A=a[l];A&&(C[w++]=A)}return C}function HS(){var a=arguments.length;if(!a)return[];for(var l=Q(a-1),h=arguments[0],w=a;w--;)l[w-1]=arguments[w];return fa(qe(h)?nn(h):[h],Ts(l,1))}var US=et(function(a,l){return es(a)?ho(a,Ts(l,1,es,!0)):[]}),VS=et(function(a,l){var h=Pn(l);return es(h)&&(h=s),es(a)?ho(a,Ts(l,1,es,!0),$e(h,2)):[]}),GS=et(function(a,l){var h=Pn(l);return es(h)&&(h=s),es(a)?ho(a,Ts(l,1,es,!0),s,h):[]});function qS(a,l,h){var w=a==null?0:a.length;return w?(l=h||l===s?1:Je(l),Rn(a,l<0?0:l,w)):[]}function YS(a,l,h){var w=a==null?0:a.length;return w?(l=h||l===s?1:Je(l),l=w-l,Rn(a,0,l<0?0:l)):[]}function KS(a,l){return a&&a.length?lc(a,$e(l,3),!0,!0):[]}function JS(a,l){return a&&a.length?lc(a,$e(l,3),!0):[]}function XS(a,l,h,w){var C=a==null?0:a.length;return C?(h&&typeof h!="number"&&Vs(a,l,h)&&(h=0,w=C),HN(a,l,h,w)):[]}function ix(a,l,h){var w=a==null?0:a.length;if(!w)return-1;var C=h==null?0:Je(h);return C<0&&(C=xs(w+C,0)),Bl(a,$e(l,3),C)}function ox(a,l,h){var w=a==null?0:a.length;if(!w)return-1;var C=w-1;return h!==s&&(C=Je(h),C=h<0?xs(w+C,0):Ms(C,w-1)),Bl(a,$e(l,3),C,!0)}function lx(a){var l=a==null?0:a.length;return l?Ts(a,1):[]}function ZS(a){var l=a==null?0:a.length;return l?Ts(a,U):[]}function QS(a,l){var h=a==null?0:a.length;return h?(l=l===s?1:Je(l),Ts(a,l)):[]}function e1(a){for(var l=-1,h=a==null?0:a.length,w={};++l<h;){var C=a[l];w[C[0]]=C[1]}return w}function cx(a){return a&&a.length?a[0]:s}function t1(a,l,h){var w=a==null?0:a.length;if(!w)return-1;var C=h==null?0:Je(h);return C<0&&(C=xs(w+C,0)),hi(a,l,C)}function s1(a){var l=a==null?0:a.length;return l?Rn(a,0,-1):[]}var n1=et(function(a){var l=Ut(a,Nu);return l.length&&l[0]===a[0]?fu(l):[]}),r1=et(function(a){var l=Pn(a),h=Ut(a,Nu);return l===Pn(h)?l=s:h.pop(),h.length&&h[0]===a[0]?fu(h,$e(l,2)):[]}),a1=et(function(a){var l=Pn(a),h=Ut(a,Nu);return l=typeof l=="function"?l:s,l&&h.pop(),h.length&&h[0]===a[0]?fu(h,s,l):[]});function i1(a,l){return a==null?"":sN.call(a,l)}function Pn(a){var l=a==null?0:a.length;return l?a[l-1]:s}function o1(a,l,h){var w=a==null?0:a.length;if(!w)return-1;var C=w;return h!==s&&(C=Je(h),C=C<0?xs(w+C,0):Ms(C,w-1)),l===l?Fw(a,l,C):Bl(a,Hp,C,!0)}function l1(a,l){return a&&a.length?bh(a,Je(l)):s}var c1=et(dx);function dx(a,l){return a&&a.length&&l&&l.length?gu(a,l):a}function d1(a,l,h){return a&&a.length&&l&&l.length?gu(a,l,$e(h,2)):a}function u1(a,l,h){return a&&a.length&&l&&l.length?gu(a,l,s,h):a}var m1=Br(function(a,l){var h=a==null?0:a.length,w=cu(a,l);return Nh(a,Ut(l,function(C){return Wr(C,h)?+C:C}).sort(Ph)),w});function f1(a,l){var h=[];if(!(a&&a.length))return h;var w=-1,C=[],A=a.length;for(l=$e(l,3);++w<A;){var L=a[w];l(L,w,a)&&(h.push(L),C.push(w))}return Nh(a,C),h}function Lu(a){return a==null?a:iN.call(a)}function p1(a,l,h){var w=a==null?0:a.length;return w?(h&&typeof h!="number"&&Vs(a,l,h)?(l=0,h=w):(l=l==null?0:Je(l),h=h===s?w:Je(h)),Rn(a,l,h)):[]}function h1(a,l){return oc(a,l)}function x1(a,l,h){return bu(a,l,$e(h,2))}function g1(a,l){var h=a==null?0:a.length;if(h){var w=oc(a,l);if(w<h&&qn(a[w],l))return w}return-1}function v1(a,l){return oc(a,l,!0)}function y1(a,l,h){return bu(a,l,$e(h,2),!0)}function b1(a,l){var h=a==null?0:a.length;if(h){var w=oc(a,l,!0)-1;if(qn(a[w],l))return w}return-1}function j1(a){return a&&a.length?Ch(a):[]}function w1(a,l){return a&&a.length?Ch(a,$e(l,2)):[]}function N1(a){var l=a==null?0:a.length;return l?Rn(a,1,l):[]}function S1(a,l,h){return a&&a.length?(l=h||l===s?1:Je(l),Rn(a,0,l<0?0:l)):[]}function C1(a,l,h){var w=a==null?0:a.length;return w?(l=h||l===s?1:Je(l),l=w-l,Rn(a,l<0?0:l,w)):[]}function E1(a,l){return a&&a.length?lc(a,$e(l,3),!1,!0):[]}function T1(a,l){return a&&a.length?lc(a,$e(l,3)):[]}var k1=et(function(a){return ga(Ts(a,1,es,!0))}),_1=et(function(a){var l=Pn(a);return es(l)&&(l=s),ga(Ts(a,1,es,!0),$e(l,2))}),D1=et(function(a){var l=Pn(a);return l=typeof l=="function"?l:s,ga(Ts(a,1,es,!0),s,l)});function A1(a){return a&&a.length?ga(a):[]}function R1(a,l){return a&&a.length?ga(a,$e(l,2)):[]}function P1(a,l){return l=typeof l=="function"?l:s,a&&a.length?ga(a,s,l):[]}function $u(a){if(!(a&&a.length))return[];var l=0;return a=ma(a,function(h){if(es(h))return l=xs(h.length,l),!0}),tu(l,function(h){return Ut(a,Zd(h))})}function ux(a,l){if(!(a&&a.length))return[];var h=$u(a);return l==null?h:Ut(h,function(w){return hn(l,s,w)})}var I1=et(function(a,l){return es(a)?ho(a,l):[]}),O1=et(function(a){return wu(ma(a,es))}),M1=et(function(a){var l=Pn(a);return es(l)&&(l=s),wu(ma(a,es),$e(l,2))}),L1=et(function(a){var l=Pn(a);return l=typeof l=="function"?l:s,wu(ma(a,es),s,l)}),$1=et($u);function z1(a,l){return _h(a||[],l||[],po)}function F1(a,l){return _h(a||[],l||[],vo)}var B1=et(function(a){var l=a.length,h=l>1?a[l-1]:s;return h=typeof h=="function"?(a.pop(),h):s,ux(a,h)});function mx(a){var l=_(a);return l.__chain__=!0,l}function W1(a,l){return l(a),a}function gc(a,l){return l(a)}var H1=Br(function(a){var l=a.length,h=l?a[0]:0,w=this.__wrapped__,C=function(A){return cu(A,a)};return l>1||this.__actions__.length||!(w instanceof rt)||!Wr(h)?this.thru(C):(w=w.slice(h,+h+(l?1:0)),w.__actions__.push({func:gc,args:[C],thisArg:s}),new Dn(w,this.__chain__).thru(function(A){return l&&!A.length&&A.push(s),A}))});function U1(){return mx(this)}function V1(){return new Dn(this.value(),this.__chain__)}function G1(){this.__values__===s&&(this.__values__=Ex(this.value()));var a=this.__index__>=this.__values__.length,l=a?s:this.__values__[this.__index__++];return{done:a,value:l}}function q1(){return this}function Y1(a){for(var l,h=this;h instanceof sc;){var w=ax(h);w.__index__=0,w.__values__=s,l?C.__wrapped__=w:l=w;var C=w;h=h.__wrapped__}return C.__wrapped__=a,l}function K1(){var a=this.__wrapped__;if(a instanceof rt){var l=a;return this.__actions__.length&&(l=new rt(this)),l=l.reverse(),l.__actions__.push({func:gc,args:[Lu],thisArg:s}),new Dn(l,this.__chain__)}return this.thru(Lu)}function J1(){return kh(this.__wrapped__,this.__actions__)}var X1=cc(function(a,l,h){Tt.call(a,h)?++a[h]:zr(a,h,1)});function Z1(a,l,h){var w=qe(a)?Bp:WN;return h&&Vs(a,l,h)&&(l=s),w(a,$e(l,3))}function Q1(a,l){var h=qe(a)?ma:uh;return h(a,$e(l,3))}var eC=zh(ix),tC=zh(ox);function sC(a,l){return Ts(vc(a,l),1)}function nC(a,l){return Ts(vc(a,l),U)}function rC(a,l,h){return h=h===s?1:Je(h),Ts(vc(a,l),h)}function fx(a,l){var h=qe(a)?kn:xa;return h(a,$e(l,3))}function px(a,l){var h=qe(a)?Nw:dh;return h(a,$e(l,3))}var aC=cc(function(a,l,h){Tt.call(a,h)?a[h].push(l):zr(a,h,[l])});function iC(a,l,h,w){a=rn(a)?a:Ti(a),h=h&&!w?Je(h):0;var C=a.length;return h<0&&(h=xs(C+h,0)),Nc(a)?h<=C&&a.indexOf(l,h)>-1:!!C&&hi(a,l,h)>-1}var oC=et(function(a,l,h){var w=-1,C=typeof l=="function",A=rn(a)?Q(a.length):[];return xa(a,function(L){A[++w]=C?hn(l,L,h):xo(L,l,h)}),A}),lC=cc(function(a,l,h){zr(a,h,l)});function vc(a,l){var h=qe(a)?Ut:gh;return h(a,$e(l,3))}function cC(a,l,h,w){return a==null?[]:(qe(l)||(l=l==null?[]:[l]),h=w?s:h,qe(h)||(h=h==null?[]:[h]),jh(a,l,h))}var dC=cc(function(a,l,h){a[h?0:1].push(l)},function(){return[[],[]]});function uC(a,l,h){var w=qe(a)?Jd:Vp,C=arguments.length<3;return w(a,$e(l,4),h,C,xa)}function mC(a,l,h){var w=qe(a)?Sw:Vp,C=arguments.length<3;return w(a,$e(l,4),h,C,dh)}function fC(a,l){var h=qe(a)?ma:uh;return h(a,jc($e(l,3)))}function pC(a){var l=qe(a)?ih:iS;return l(a)}function hC(a,l,h){(h?Vs(a,l,h):l===s)?l=1:l=Je(l);var w=qe(a)?LN:oS;return w(a,l)}function xC(a){var l=qe(a)?$N:cS;return l(a)}function gC(a){if(a==null)return 0;if(rn(a))return Nc(a)?gi(a):a.length;var l=Ls(a);return l==Ke||l==he?a.size:hu(a).length}function vC(a,l,h){var w=qe(a)?Xd:dS;return h&&Vs(a,l,h)&&(l=s),w(a,$e(l,3))}var yC=et(function(a,l){if(a==null)return[];var h=l.length;return h>1&&Vs(a,l[0],l[1])?l=[]:h>2&&Vs(l[0],l[1],l[2])&&(l=[l[0]]),jh(a,Ts(l,1),[])}),yc=Qw||function(){return Es.Date.now()};function bC(a,l){if(typeof l!="function")throw new _n(c);return a=Je(a),function(){if(--a<1)return l.apply(this,arguments)}}function hx(a,l,h){return l=h?s:l,l=a&&l==null?a.length:l,Fr(a,R,s,s,s,s,l)}function xx(a,l){var h;if(typeof l!="function")throw new _n(c);return a=Je(a),function(){return--a>0&&(h=l.apply(this,arguments)),a<=1&&(l=s),h}}var zu=et(function(a,l,h){var w=y;if(h.length){var C=pa(h,Ci(zu));w|=k}return Fr(a,w,l,h,C)}),gx=et(function(a,l,h){var w=y|N;if(h.length){var C=pa(h,Ci(gx));w|=k}return Fr(l,w,a,h,C)});function vx(a,l,h){l=h?s:l;var w=Fr(a,E,s,s,s,s,s,l);return w.placeholder=vx.placeholder,w}function yx(a,l,h){l=h?s:l;var w=Fr(a,T,s,s,s,s,s,l);return w.placeholder=yx.placeholder,w}function bx(a,l,h){var w,C,A,L,B,J,re=0,ie=!1,de=!1,Ne=!0;if(typeof a!="function")throw new _n(c);l=In(l)||0,Jt(h)&&(ie=!!h.leading,de="maxWait"in h,A=de?xs(In(h.maxWait)||0,l):A,Ne="trailing"in h?!!h.trailing:Ne);function Ae(ts){var Yn=w,Vr=C;return w=C=s,re=ts,L=a.apply(Vr,Yn),L}function ze(ts){return re=ts,B=jo(st,l),ie?Ae(ts):L}function Qe(ts){var Yn=ts-J,Vr=ts-re,zx=l-Yn;return de?Ms(zx,A-Vr):zx}function Fe(ts){var Yn=ts-J,Vr=ts-re;return J===s||Yn>=l||Yn<0||de&&Vr>=A}function st(){var ts=yc();if(Fe(ts))return at(ts);B=jo(st,Qe(ts))}function at(ts){return B=s,Ne&&w?Ae(ts):(w=C=s,L)}function yn(){B!==s&&Dh(B),re=0,w=J=C=B=s}function Gs(){return B===s?L:at(yc())}function bn(){var ts=yc(),Yn=Fe(ts);if(w=arguments,C=this,J=ts,Yn){if(B===s)return ze(J);if(de)return Dh(B),B=jo(st,l),Ae(J)}return B===s&&(B=jo(st,l)),L}return bn.cancel=yn,bn.flush=Gs,bn}var jC=et(function(a,l){return ch(a,1,l)}),wC=et(function(a,l,h){return ch(a,In(l)||0,h)});function NC(a){return Fr(a,O)}function bc(a,l){if(typeof a!="function"||l!=null&&typeof l!="function")throw new _n(c);var h=function(){var w=arguments,C=l?l.apply(this,w):w[0],A=h.cache;if(A.has(C))return A.get(C);var L=a.apply(this,w);return h.cache=A.set(C,L)||A,L};return h.cache=new(bc.Cache||$r),h}bc.Cache=$r;function jc(a){if(typeof a!="function")throw new _n(c);return function(){var l=arguments;switch(l.length){case 0:return!a.call(this);case 1:return!a.call(this,l[0]);case 2:return!a.call(this,l[0],l[1]);case 3:return!a.call(this,l[0],l[1],l[2])}return!a.apply(this,l)}}function SC(a){return xx(2,a)}var CC=uS(function(a,l){l=l.length==1&&qe(l[0])?Ut(l[0],xn($e())):Ut(Ts(l,1),xn($e()));var h=l.length;return et(function(w){for(var C=-1,A=Ms(w.length,h);++C<A;)w[C]=l[C].call(this,w[C]);return hn(a,this,w)})}),Fu=et(function(a,l){var h=pa(l,Ci(Fu));return Fr(a,k,s,l,h)}),jx=et(function(a,l){var h=pa(l,Ci(jx));return Fr(a,M,s,l,h)}),EC=Br(function(a,l){return Fr(a,I,s,s,s,l)});function TC(a,l){if(typeof a!="function")throw new _n(c);return l=l===s?l:Je(l),et(a,l)}function kC(a,l){if(typeof a!="function")throw new _n(c);return l=l==null?0:xs(Je(l),0),et(function(h){var w=h[l],C=ya(h,0,l);return w&&fa(C,w),hn(a,this,C)})}function _C(a,l,h){var w=!0,C=!0;if(typeof a!="function")throw new _n(c);return Jt(h)&&(w="leading"in h?!!h.leading:w,C="trailing"in h?!!h.trailing:C),bx(a,l,{leading:w,maxWait:l,trailing:C})}function DC(a){return hx(a,1)}function AC(a,l){return Fu(Su(l),a)}function RC(){if(!arguments.length)return[];var a=arguments[0];return qe(a)?a:[a]}function PC(a){return An(a,v)}function IC(a,l){return l=typeof l=="function"?l:s,An(a,v,l)}function OC(a){return An(a,x|v)}function MC(a,l){return l=typeof l=="function"?l:s,An(a,x|v,l)}function LC(a,l){return l==null||lh(a,l,ws(l))}function qn(a,l){return a===l||a!==a&&l!==l}var $C=fc(mu),zC=fc(function(a,l){return a>=l}),Za=ph(function(){return arguments}())?ph:function(a){return Zt(a)&&Tt.call(a,"callee")&&!eh.call(a,"callee")},qe=Q.isArray,FC=Op?xn(Op):YN;function rn(a){return a!=null&&wc(a.length)&&!Hr(a)}function es(a){return Zt(a)&&rn(a)}function BC(a){return a===!0||a===!1||Zt(a)&&Us(a)==_e}var ba=tN||Xu,WC=Mp?xn(Mp):KN;function HC(a){return Zt(a)&&a.nodeType===1&&!wo(a)}function UC(a){if(a==null)return!0;if(rn(a)&&(qe(a)||typeof a=="string"||typeof a.splice=="function"||ba(a)||Ei(a)||Za(a)))return!a.length;var l=Ls(a);if(l==Ke||l==he)return!a.size;if(bo(a))return!hu(a).length;for(var h in a)if(Tt.call(a,h))return!1;return!0}function VC(a,l){return go(a,l)}function GC(a,l,h){h=typeof h=="function"?h:s;var w=h?h(a,l):s;return w===s?go(a,l,s,h):!!w}function Bu(a){if(!Zt(a))return!1;var l=Us(a);return l==Le||l==Pe||typeof a.message=="string"&&typeof a.name=="string"&&!wo(a)}function qC(a){return typeof a=="number"&&sh(a)}function Hr(a){if(!Jt(a))return!1;var l=Us(a);return l==le||l==Re||l==pe||l==Z}function wx(a){return typeof a=="number"&&a==Je(a)}function wc(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=Y}function Jt(a){var l=typeof a;return a!=null&&(l=="object"||l=="function")}function Zt(a){return a!=null&&typeof a=="object"}var Nx=Lp?xn(Lp):XN;function YC(a,l){return a===l||pu(a,l,Au(l))}function KC(a,l,h){return h=typeof h=="function"?h:s,pu(a,l,Au(l),h)}function JC(a){return Sx(a)&&a!=+a}function XC(a){if(IS(a))throw new Ge(o);return hh(a)}function ZC(a){return a===null}function QC(a){return a==null}function Sx(a){return typeof a=="number"||Zt(a)&&Us(a)==Yt}function wo(a){if(!Zt(a)||Us(a)!=Dt)return!1;var l=Kl(a);if(l===null)return!0;var h=Tt.call(l,"constructor")&&l.constructor;return typeof h=="function"&&h instanceof h&&Vl.call(h)==Kw}var Wu=$p?xn($p):ZN;function eE(a){return wx(a)&&a>=-Y&&a<=Y}var Cx=zp?xn(zp):QN;function Nc(a){return typeof a=="string"||!qe(a)&&Zt(a)&&Us(a)==ve}function vn(a){return typeof a=="symbol"||Zt(a)&&Us(a)==ue}var Ei=Fp?xn(Fp):eS;function tE(a){return a===s}function sE(a){return Zt(a)&&Ls(a)==Ue}function nE(a){return Zt(a)&&Us(a)==Ze}var rE=fc(xu),aE=fc(function(a,l){return a<=l});function Ex(a){if(!a)return[];if(rn(a))return Nc(a)?Vn(a):nn(a);if(lo&&a[lo])return Lw(a[lo]());var l=Ls(a),h=l==Ke?nu:l==he?Wl:Ti;return h(a)}function Ur(a){if(!a)return a===0?a:0;if(a=In(a),a===U||a===-U){var l=a<0?-1:1;return l*ae}return a===a?a:0}function Je(a){var l=Ur(a),h=l%1;return l===l?h?l-h:l:0}function Tx(a){return a?Ya(Je(a),0,oe):0}function In(a){if(typeof a=="number")return a;if(vn(a))return ye;if(Jt(a)){var l=typeof a.valueOf=="function"?a.valueOf():a;a=Jt(l)?l+"":l}if(typeof a!="string")return a===0?a:+a;a=Gp(a);var h=Bd.test(a);return h||V.test(a)?bw(a.slice(2),h?2:8):Ll.test(a)?ye:+a}function kx(a){return xr(a,an(a))}function iE(a){return a?Ya(Je(a),-Y,Y):a===0?a:0}function wt(a){return a==null?"":gn(a)}var oE=Ni(function(a,l){if(bo(l)||rn(l)){xr(l,ws(l),a);return}for(var h in l)Tt.call(l,h)&&po(a,h,l[h])}),_x=Ni(function(a,l){xr(l,an(l),a)}),Sc=Ni(function(a,l,h,w){xr(l,an(l),a,w)}),lE=Ni(function(a,l,h,w){xr(l,ws(l),a,w)}),cE=Br(cu);function dE(a,l){var h=wi(a);return l==null?h:oh(h,l)}var uE=et(function(a,l){a=Rt(a);var h=-1,w=l.length,C=w>2?l[2]:s;for(C&&Vs(l[0],l[1],C)&&(w=1);++h<w;)for(var A=l[h],L=an(A),B=-1,J=L.length;++B<J;){var re=L[B],ie=a[re];(ie===s||qn(ie,yi[re])&&!Tt.call(a,re))&&(a[re]=A[re])}return a}),mE=et(function(a){return a.push(s,Gh),hn(Dx,s,a)});function fE(a,l){return Wp(a,$e(l,3),hr)}function pE(a,l){return Wp(a,$e(l,3),uu)}function hE(a,l){return a==null?a:du(a,$e(l,3),an)}function xE(a,l){return a==null?a:mh(a,$e(l,3),an)}function gE(a,l){return a&&hr(a,$e(l,3))}function vE(a,l){return a&&uu(a,$e(l,3))}function yE(a){return a==null?[]:ac(a,ws(a))}function bE(a){return a==null?[]:ac(a,an(a))}function Hu(a,l,h){var w=a==null?s:Ka(a,l);return w===s?h:w}function jE(a,l){return a!=null&&Kh(a,l,UN)}function Uu(a,l){return a!=null&&Kh(a,l,VN)}var wE=Bh(function(a,l,h){l!=null&&typeof l.toString!="function"&&(l=Gl.call(l)),a[l]=h},Gu(on)),NE=Bh(function(a,l,h){l!=null&&typeof l.toString!="function"&&(l=Gl.call(l)),Tt.call(a,l)?a[l].push(h):a[l]=[h]},$e),SE=et(xo);function ws(a){return rn(a)?ah(a):hu(a)}function an(a){return rn(a)?ah(a,!0):tS(a)}function CE(a,l){var h={};return l=$e(l,3),hr(a,function(w,C,A){zr(h,l(w,C,A),w)}),h}function EE(a,l){var h={};return l=$e(l,3),hr(a,function(w,C,A){zr(h,C,l(w,C,A))}),h}var TE=Ni(function(a,l,h){ic(a,l,h)}),Dx=Ni(function(a,l,h,w){ic(a,l,h,w)}),kE=Br(function(a,l){var h={};if(a==null)return h;var w=!1;l=Ut(l,function(A){return A=va(A,a),w||(w=A.length>1),A}),xr(a,_u(a),h),w&&(h=An(h,x|g|v,wS));for(var C=l.length;C--;)ju(h,l[C]);return h});function _E(a,l){return Ax(a,jc($e(l)))}var DE=Br(function(a,l){return a==null?{}:nS(a,l)});function Ax(a,l){if(a==null)return{};var h=Ut(_u(a),function(w){return[w]});return l=$e(l),wh(a,h,function(w,C){return l(w,C[0])})}function AE(a,l,h){l=va(l,a);var w=-1,C=l.length;for(C||(C=1,a=s);++w<C;){var A=a==null?s:a[gr(l[w])];A===s&&(w=C,A=h),a=Hr(A)?A.call(a):A}return a}function RE(a,l,h){return a==null?a:vo(a,l,h)}function PE(a,l,h,w){return w=typeof w=="function"?w:s,a==null?a:vo(a,l,h,w)}var Rx=Uh(ws),Px=Uh(an);function IE(a,l,h){var w=qe(a),C=w||ba(a)||Ei(a);if(l=$e(l,4),h==null){var A=a&&a.constructor;C?h=w?new A:[]:Jt(a)?h=Hr(A)?wi(Kl(a)):{}:h={}}return(C?kn:hr)(a,function(L,B,J){return l(h,L,B,J)}),h}function OE(a,l){return a==null?!0:ju(a,l)}function ME(a,l,h){return a==null?a:Th(a,l,Su(h))}function LE(a,l,h,w){return w=typeof w=="function"?w:s,a==null?a:Th(a,l,Su(h),w)}function Ti(a){return a==null?[]:su(a,ws(a))}function $E(a){return a==null?[]:su(a,an(a))}function zE(a,l,h){return h===s&&(h=l,l=s),h!==s&&(h=In(h),h=h===h?h:0),l!==s&&(l=In(l),l=l===l?l:0),Ya(In(a),l,h)}function FE(a,l,h){return l=Ur(l),h===s?(h=l,l=0):h=Ur(h),a=In(a),GN(a,l,h)}function BE(a,l,h){if(h&&typeof h!="boolean"&&Vs(a,l,h)&&(l=h=s),h===s&&(typeof l=="boolean"?(h=l,l=s):typeof a=="boolean"&&(h=a,a=s)),a===s&&l===s?(a=0,l=1):(a=Ur(a),l===s?(l=a,a=0):l=Ur(l)),a>l){var w=a;a=l,l=w}if(h||a%1||l%1){var C=nh();return Ms(a+C*(l-a+yw("1e-"+((C+"").length-1))),l)}return vu(a,l)}var WE=Si(function(a,l,h){return l=l.toLowerCase(),a+(h?Ix(l):l)});function Ix(a){return Vu(wt(a).toLowerCase())}function Ox(a){return a=wt(a),a&&a.replace(ke,Rw).replace(cw,"")}function HE(a,l,h){a=wt(a),l=gn(l);var w=a.length;h=h===s?w:Ya(Je(h),0,w);var C=h;return h-=l.length,h>=0&&a.slice(h,C)==l}function UE(a){return a=wt(a),a&&no.test(a)?a.replace(Cn,Pw):a}function VE(a){return a=wt(a),a&&Hs.test(a)?a.replace(sn,"\\$&"):a}var GE=Si(function(a,l,h){return a+(h?"-":"")+l.toLowerCase()}),qE=Si(function(a,l,h){return a+(h?" ":"")+l.toLowerCase()}),YE=$h("toLowerCase");function KE(a,l,h){a=wt(a),l=Je(l);var w=l?gi(a):0;if(!l||w>=l)return a;var C=(l-w)/2;return mc(Ql(C),h)+a+mc(Zl(C),h)}function JE(a,l,h){a=wt(a),l=Je(l);var w=l?gi(a):0;return l&&w<l?a+mc(l-w,h):a}function XE(a,l,h){a=wt(a),l=Je(l);var w=l?gi(a):0;return l&&w<l?mc(l-w,h)+a:a}function ZE(a,l,h){return h||l==null?l=0:l&&(l=+l),aN(wt(a).replace(Kt,""),l||0)}function QE(a,l,h){return(h?Vs(a,l,h):l===s)?l=1:l=Je(l),yu(wt(a),l)}function eT(){var a=arguments,l=wt(a[0]);return a.length<3?l:l.replace(a[1],a[2])}var tT=Si(function(a,l,h){return a+(h?"_":"")+l.toLowerCase()});function sT(a,l,h){return h&&typeof h!="number"&&Vs(a,l,h)&&(l=h=s),h=h===s?oe:h>>>0,h?(a=wt(a),a&&(typeof l=="string"||l!=null&&!Wu(l))&&(l=gn(l),!l&&xi(a))?ya(Vn(a),0,h):a.split(l,h)):[]}var nT=Si(function(a,l,h){return a+(h?" ":"")+Vu(l)});function rT(a,l,h){return a=wt(a),h=h==null?0:Ya(Je(h),0,a.length),l=gn(l),a.slice(h,h+l.length)==l}function aT(a,l,h){var w=_.templateSettings;h&&Vs(a,l,h)&&(l=s),a=wt(a),l=Sc({},l,w,Vh);var C=Sc({},l.imports,w.imports,Vh),A=ws(C),L=su(C,A),B,J,re=0,ie=l.interpolate||Et,de="__p += '",Ne=ru((l.escape||Et).source+"|"+ie.source+"|"+(ie===Ct?Ml:Et).source+"|"+(l.evaluate||Et).source+"|$","g"),Ae="//# sourceURL="+(Tt.call(l,"sourceURL")?(l.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++pw+"]")+`
`;a.replace(Ne,function(Fe,st,at,yn,Gs,bn){return at||(at=yn),de+=a.slice(re,bn).replace(js,Iw),st&&(B=!0,de+=`' +
__e(`+st+`) +
'`),Gs&&(J=!0,de+=`';
`+Gs+`;
__p += '`),at&&(de+=`' +
((__t = (`+at+`)) == null ? '' : __t) +
'`),re=bn+Fe.length,Fe}),de+=`';
`;var ze=Tt.call(l,"variable")&&l.variable;if(!ze)de=`with (obj) {
`+de+`
}
`;else if(Hn.test(ze))throw new Ge(d);de=(J?de.replace(so,""):de).replace(Or,"$1").replace(Mr,"$1;"),de="function("+(ze||"obj")+`) {
`+(ze?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(B?", __e = _.escape":"")+(J?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+de+`return __p
}`;var Qe=Lx(function(){return gt(A,Ae+"return "+de).apply(s,L)});if(Qe.source=de,Bu(Qe))throw Qe;return Qe}function iT(a){return wt(a).toLowerCase()}function oT(a){return wt(a).toUpperCase()}function lT(a,l,h){if(a=wt(a),a&&(h||l===s))return Gp(a);if(!a||!(l=gn(l)))return a;var w=Vn(a),C=Vn(l),A=qp(w,C),L=Yp(w,C)+1;return ya(w,A,L).join("")}function cT(a,l,h){if(a=wt(a),a&&(h||l===s))return a.slice(0,Jp(a)+1);if(!a||!(l=gn(l)))return a;var w=Vn(a),C=Yp(w,Vn(l))+1;return ya(w,0,C).join("")}function dT(a,l,h){if(a=wt(a),a&&(h||l===s))return a.replace(Kt,"");if(!a||!(l=gn(l)))return a;var w=Vn(a),C=qp(w,Vn(l));return ya(w,C).join("")}function uT(a,l){var h=H,w=$;if(Jt(l)){var C="separator"in l?l.separator:C;h="length"in l?Je(l.length):h,w="omission"in l?gn(l.omission):w}a=wt(a);var A=a.length;if(xi(a)){var L=Vn(a);A=L.length}if(h>=A)return a;var B=h-gi(w);if(B<1)return w;var J=L?ya(L,0,B).join(""):a.slice(0,B);if(C===s)return J+w;if(L&&(B+=J.length-B),Wu(C)){if(a.slice(B).search(C)){var re,ie=J;for(C.global||(C=ru(C.source,wt(ao.exec(C))+"g")),C.lastIndex=0;re=C.exec(ie);)var de=re.index;J=J.slice(0,de===s?B:de)}}else if(a.indexOf(gn(C),B)!=B){var Ne=J.lastIndexOf(C);Ne>-1&&(J=J.slice(0,Ne))}return J+w}function mT(a){return a=wt(a),a&&En.test(a)?a.replace(mi,Bw):a}var fT=Si(function(a,l,h){return a+(h?" ":"")+l.toUpperCase()}),Vu=$h("toUpperCase");function Mx(a,l,h){return a=wt(a),l=h?s:l,l===s?Mw(a)?Uw(a):Tw(a):a.match(l)||[]}var Lx=et(function(a,l){try{return hn(a,s,l)}catch(h){return Bu(h)?h:new Ge(h)}}),pT=Br(function(a,l){return kn(l,function(h){h=gr(h),zr(a,h,zu(a[h],a))}),a});function hT(a){var l=a==null?0:a.length,h=$e();return a=l?Ut(a,function(w){if(typeof w[1]!="function")throw new _n(c);return[h(w[0]),w[1]]}):[],et(function(w){for(var C=-1;++C<l;){var A=a[C];if(hn(A[0],this,w))return hn(A[1],this,w)}})}function xT(a){return BN(An(a,x))}function Gu(a){return function(){return a}}function gT(a,l){return a==null||a!==a?l:a}var vT=Fh(),yT=Fh(!0);function on(a){return a}function qu(a){return xh(typeof a=="function"?a:An(a,x))}function bT(a){return vh(An(a,x))}function jT(a,l){return yh(a,An(l,x))}var wT=et(function(a,l){return function(h){return xo(h,a,l)}}),NT=et(function(a,l){return function(h){return xo(a,h,l)}});function Yu(a,l,h){var w=ws(l),C=ac(l,w);h==null&&!(Jt(l)&&(C.length||!w.length))&&(h=l,l=a,a=this,C=ac(l,ws(l)));var A=!(Jt(h)&&"chain"in h)||!!h.chain,L=Hr(a);return kn(C,function(B){var J=l[B];a[B]=J,L&&(a.prototype[B]=function(){var re=this.__chain__;if(A||re){var ie=a(this.__wrapped__),de=ie.__actions__=nn(this.__actions__);return de.push({func:J,args:arguments,thisArg:a}),ie.__chain__=re,ie}return J.apply(a,fa([this.value()],arguments))})}),a}function ST(){return Es._===this&&(Es._=Jw),this}function Ku(){}function CT(a){return a=Je(a),et(function(l){return bh(l,a)})}var ET=Eu(Ut),TT=Eu(Bp),kT=Eu(Xd);function $x(a){return Pu(a)?Zd(gr(a)):rS(a)}function _T(a){return function(l){return a==null?s:Ka(a,l)}}var DT=Wh(),AT=Wh(!0);function Ju(){return[]}function Xu(){return!1}function RT(){return{}}function PT(){return""}function IT(){return!0}function OT(a,l){if(a=Je(a),a<1||a>Y)return[];var h=oe,w=Ms(a,oe);l=$e(l),a-=oe;for(var C=tu(w,l);++h<a;)l(h);return C}function MT(a){return qe(a)?Ut(a,gr):vn(a)?[a]:nn(rx(wt(a)))}function LT(a){var l=++Yw;return wt(a)+l}var $T=uc(function(a,l){return a+l},0),zT=Tu("ceil"),FT=uc(function(a,l){return a/l},1),BT=Tu("floor");function WT(a){return a&&a.length?rc(a,on,mu):s}function HT(a,l){return a&&a.length?rc(a,$e(l,2),mu):s}function UT(a){return Up(a,on)}function VT(a,l){return Up(a,$e(l,2))}function GT(a){return a&&a.length?rc(a,on,xu):s}function qT(a,l){return a&&a.length?rc(a,$e(l,2),xu):s}var YT=uc(function(a,l){return a*l},1),KT=Tu("round"),JT=uc(function(a,l){return a-l},0);function XT(a){return a&&a.length?eu(a,on):0}function ZT(a,l){return a&&a.length?eu(a,$e(l,2)):0}return _.after=bC,_.ary=hx,_.assign=oE,_.assignIn=_x,_.assignInWith=Sc,_.assignWith=lE,_.at=cE,_.before=xx,_.bind=zu,_.bindAll=pT,_.bindKey=gx,_.castArray=RC,_.chain=mx,_.chunk=BS,_.compact=WS,_.concat=HS,_.cond=hT,_.conforms=xT,_.constant=Gu,_.countBy=X1,_.create=dE,_.curry=vx,_.curryRight=yx,_.debounce=bx,_.defaults=uE,_.defaultsDeep=mE,_.defer=jC,_.delay=wC,_.difference=US,_.differenceBy=VS,_.differenceWith=GS,_.drop=qS,_.dropRight=YS,_.dropRightWhile=KS,_.dropWhile=JS,_.fill=XS,_.filter=Q1,_.flatMap=sC,_.flatMapDeep=nC,_.flatMapDepth=rC,_.flatten=lx,_.flattenDeep=ZS,_.flattenDepth=QS,_.flip=NC,_.flow=vT,_.flowRight=yT,_.fromPairs=e1,_.functions=yE,_.functionsIn=bE,_.groupBy=aC,_.initial=s1,_.intersection=n1,_.intersectionBy=r1,_.intersectionWith=a1,_.invert=wE,_.invertBy=NE,_.invokeMap=oC,_.iteratee=qu,_.keyBy=lC,_.keys=ws,_.keysIn=an,_.map=vc,_.mapKeys=CE,_.mapValues=EE,_.matches=bT,_.matchesProperty=jT,_.memoize=bc,_.merge=TE,_.mergeWith=Dx,_.method=wT,_.methodOf=NT,_.mixin=Yu,_.negate=jc,_.nthArg=CT,_.omit=kE,_.omitBy=_E,_.once=SC,_.orderBy=cC,_.over=ET,_.overArgs=CC,_.overEvery=TT,_.overSome=kT,_.partial=Fu,_.partialRight=jx,_.partition=dC,_.pick=DE,_.pickBy=Ax,_.property=$x,_.propertyOf=_T,_.pull=c1,_.pullAll=dx,_.pullAllBy=d1,_.pullAllWith=u1,_.pullAt=m1,_.range=DT,_.rangeRight=AT,_.rearg=EC,_.reject=fC,_.remove=f1,_.rest=TC,_.reverse=Lu,_.sampleSize=hC,_.set=RE,_.setWith=PE,_.shuffle=xC,_.slice=p1,_.sortBy=yC,_.sortedUniq=j1,_.sortedUniqBy=w1,_.split=sT,_.spread=kC,_.tail=N1,_.take=S1,_.takeRight=C1,_.takeRightWhile=E1,_.takeWhile=T1,_.tap=W1,_.throttle=_C,_.thru=gc,_.toArray=Ex,_.toPairs=Rx,_.toPairsIn=Px,_.toPath=MT,_.toPlainObject=kx,_.transform=IE,_.unary=DC,_.union=k1,_.unionBy=_1,_.unionWith=D1,_.uniq=A1,_.uniqBy=R1,_.uniqWith=P1,_.unset=OE,_.unzip=$u,_.unzipWith=ux,_.update=ME,_.updateWith=LE,_.values=Ti,_.valuesIn=$E,_.without=I1,_.words=Mx,_.wrap=AC,_.xor=O1,_.xorBy=M1,_.xorWith=L1,_.zip=$1,_.zipObject=z1,_.zipObjectDeep=F1,_.zipWith=B1,_.entries=Rx,_.entriesIn=Px,_.extend=_x,_.extendWith=Sc,Yu(_,_),_.add=$T,_.attempt=Lx,_.camelCase=WE,_.capitalize=Ix,_.ceil=zT,_.clamp=zE,_.clone=PC,_.cloneDeep=OC,_.cloneDeepWith=MC,_.cloneWith=IC,_.conformsTo=LC,_.deburr=Ox,_.defaultTo=gT,_.divide=FT,_.endsWith=HE,_.eq=qn,_.escape=UE,_.escapeRegExp=VE,_.every=Z1,_.find=eC,_.findIndex=ix,_.findKey=fE,_.findLast=tC,_.findLastIndex=ox,_.findLastKey=pE,_.floor=BT,_.forEach=fx,_.forEachRight=px,_.forIn=hE,_.forInRight=xE,_.forOwn=gE,_.forOwnRight=vE,_.get=Hu,_.gt=$C,_.gte=zC,_.has=jE,_.hasIn=Uu,_.head=cx,_.identity=on,_.includes=iC,_.indexOf=t1,_.inRange=FE,_.invoke=SE,_.isArguments=Za,_.isArray=qe,_.isArrayBuffer=FC,_.isArrayLike=rn,_.isArrayLikeObject=es,_.isBoolean=BC,_.isBuffer=ba,_.isDate=WC,_.isElement=HC,_.isEmpty=UC,_.isEqual=VC,_.isEqualWith=GC,_.isError=Bu,_.isFinite=qC,_.isFunction=Hr,_.isInteger=wx,_.isLength=wc,_.isMap=Nx,_.isMatch=YC,_.isMatchWith=KC,_.isNaN=JC,_.isNative=XC,_.isNil=QC,_.isNull=ZC,_.isNumber=Sx,_.isObject=Jt,_.isObjectLike=Zt,_.isPlainObject=wo,_.isRegExp=Wu,_.isSafeInteger=eE,_.isSet=Cx,_.isString=Nc,_.isSymbol=vn,_.isTypedArray=Ei,_.isUndefined=tE,_.isWeakMap=sE,_.isWeakSet=nE,_.join=i1,_.kebabCase=GE,_.last=Pn,_.lastIndexOf=o1,_.lowerCase=qE,_.lowerFirst=YE,_.lt=rE,_.lte=aE,_.max=WT,_.maxBy=HT,_.mean=UT,_.meanBy=VT,_.min=GT,_.minBy=qT,_.stubArray=Ju,_.stubFalse=Xu,_.stubObject=RT,_.stubString=PT,_.stubTrue=IT,_.multiply=YT,_.nth=l1,_.noConflict=ST,_.noop=Ku,_.now=yc,_.pad=KE,_.padEnd=JE,_.padStart=XE,_.parseInt=ZE,_.random=BE,_.reduce=uC,_.reduceRight=mC,_.repeat=QE,_.replace=eT,_.result=AE,_.round=KT,_.runInContext=q,_.sample=pC,_.size=gC,_.snakeCase=tT,_.some=vC,_.sortedIndex=h1,_.sortedIndexBy=x1,_.sortedIndexOf=g1,_.sortedLastIndex=v1,_.sortedLastIndexBy=y1,_.sortedLastIndexOf=b1,_.startCase=nT,_.startsWith=rT,_.subtract=JT,_.sum=XT,_.sumBy=ZT,_.template=aT,_.times=OT,_.toFinite=Ur,_.toInteger=Je,_.toLength=Tx,_.toLower=iT,_.toNumber=In,_.toSafeInteger=iE,_.toString=wt,_.toUpper=oT,_.trim=lT,_.trimEnd=cT,_.trimStart=dT,_.truncate=uT,_.unescape=mT,_.uniqueId=LT,_.upperCase=fT,_.upperFirst=Vu,_.each=fx,_.eachRight=px,_.first=cx,Yu(_,function(){var a={};return hr(_,function(l,h){Tt.call(_.prototype,h)||(a[h]=l)}),a}(),{chain:!1}),_.VERSION=r,kn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){_[a].placeholder=_}),kn(["drop","take"],function(a,l){rt.prototype[a]=function(h){h=h===s?1:xs(Je(h),0);var w=this.__filtered__&&!l?new rt(this):this.clone();return w.__filtered__?w.__takeCount__=Ms(h,w.__takeCount__):w.__views__.push({size:Ms(h,oe),type:a+(w.__dir__<0?"Right":"")}),w},rt.prototype[a+"Right"]=function(h){return this.reverse()[a](h).reverse()}}),kn(["filter","map","takeWhile"],function(a,l){var h=l+1,w=h==K||h==G;rt.prototype[a]=function(C){var A=this.clone();return A.__iteratees__.push({iteratee:$e(C,3),type:h}),A.__filtered__=A.__filtered__||w,A}}),kn(["head","last"],function(a,l){var h="take"+(l?"Right":"");rt.prototype[a]=function(){return this[h](1).value()[0]}}),kn(["initial","tail"],function(a,l){var h="drop"+(l?"":"Right");rt.prototype[a]=function(){return this.__filtered__?new rt(this):this[h](1)}}),rt.prototype.compact=function(){return this.filter(on)},rt.prototype.find=function(a){return this.filter(a).head()},rt.prototype.findLast=function(a){return this.reverse().find(a)},rt.prototype.invokeMap=et(function(a,l){return typeof a=="function"?new rt(this):this.map(function(h){return xo(h,a,l)})}),rt.prototype.reject=function(a){return this.filter(jc($e(a)))},rt.prototype.slice=function(a,l){a=Je(a);var h=this;return h.__filtered__&&(a>0||l<0)?new rt(h):(a<0?h=h.takeRight(-a):a&&(h=h.drop(a)),l!==s&&(l=Je(l),h=l<0?h.dropRight(-l):h.take(l-a)),h)},rt.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},rt.prototype.toArray=function(){return this.take(oe)},hr(rt.prototype,function(a,l){var h=/^(?:filter|find|map|reject)|While$/.test(l),w=/^(?:head|last)$/.test(l),C=_[w?"take"+(l=="last"?"Right":""):l],A=w||/^find/.test(l);C&&(_.prototype[l]=function(){var L=this.__wrapped__,B=w?[1]:arguments,J=L instanceof rt,re=B[0],ie=J||qe(L),de=function(st){var at=C.apply(_,fa([st],B));return w&&Ne?at[0]:at};ie&&h&&typeof re=="function"&&re.length!=1&&(J=ie=!1);var Ne=this.__chain__,Ae=!!this.__actions__.length,ze=A&&!Ne,Qe=J&&!Ae;if(!A&&ie){L=Qe?L:new rt(this);var Fe=a.apply(L,B);return Fe.__actions__.push({func:gc,args:[de],thisArg:s}),new Dn(Fe,Ne)}return ze&&Qe?a.apply(this,B):(Fe=this.thru(de),ze?w?Fe.value()[0]:Fe.value():Fe)})}),kn(["pop","push","shift","sort","splice","unshift"],function(a){var l=Hl[a],h=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",w=/^(?:pop|shift)$/.test(a);_.prototype[a]=function(){var C=arguments;if(w&&!this.__chain__){var A=this.value();return l.apply(qe(A)?A:[],C)}return this[h](function(L){return l.apply(qe(L)?L:[],C)})}}),hr(rt.prototype,function(a,l){var h=_[l];if(h){var w=h.name+"";Tt.call(ji,w)||(ji[w]=[]),ji[w].push({name:l,func:h})}}),ji[dc(s,N).name]=[{name:"wrapper",func:s}],rt.prototype.clone=mN,rt.prototype.reverse=fN,rt.prototype.value=pN,_.prototype.at=H1,_.prototype.chain=U1,_.prototype.commit=V1,_.prototype.next=G1,_.prototype.plant=Y1,_.prototype.reverse=K1,_.prototype.toJSON=_.prototype.valueOf=_.prototype.value=J1,_.prototype.first=_.prototype.head,lo&&(_.prototype[lo]=q1),_},vi=Vw();Ua?((Ua.exports=vi)._=vi,qd._=vi):Es._=vi}).call(No)})(Kc,Kc.exports);var $s=Kc.exports;const Sb=(t,n)=>{const[s,r]=f.useState(null),[i,o]=f.useState(!0),[c,d]=f.useState(null),{user:u}=He();return f.useEffect(()=>{(async()=>{if(r(null),!!u){o(!0),d(null);try{const p=[],x=new Date(t),g=new Date(n);for(;x<=g;)p.push(Oe(x)),x.setDate(x.getDate()+1);const v=new Map(p.map(D=>[D,{date:D,drinks:[],totalWater:0}])),j=p.map(D=>{const P=be(fe,"water",`${u.uid}_${D}`);return ds(P)});(await Promise.all(j)).forEach(D=>{if(D.exists()){const P=D.data();v.set(P.date,{date:P.date,drinks:P.drinks||[],totalWater:P.totalWater||0})}});const y=Array.from(v.values()),N=$s.sumBy(y,"totalWater"),S=y.filter(D=>D.totalWater>0).length,E=y.filter(D=>D.totalWater>=2e3).length,T=S>0?N/S:0,k=y.flatMap(D=>D.drinks),M=$s.groupBy(k,"type"),R=Object.entries(M).map(([D,P])=>({type:D,count:P.length,totalAmount:$s.sumBy(P,"amount"),percentage:$s.sumBy(P,"amount")/N*100||0})).sort((D,P)=>P.totalAmount-D.totalAmount),I=$s.groupBy(k,D=>dn[D.type].category),O=Object.entries(I).map(([D,P])=>({category:D,totalAmount:$s.sumBy(P,"amount"),percentage:$s.sumBy(P,"amount")/N*100||0})).sort((D,P)=>P.totalAmount-D.totalAmount);let H;n.getTime()-t.getTime()>2592e6&&(H=Object.entries($s.groupBy(y,D=>D.date.substring(0,7))).map(([D,P])=>({month:`${D}-01`,average:$s.sumBy(P,"totalWater")/P.length})).sort((D,P)=>new Date(D.month).getTime()-new Date(P.month).getTime()));const $=y.map(D=>({date:D.date,intake:D.totalWater}));r({dailyStats:$,summary:{totalIntake:N,avgDailyIntake:T,daysTracked:S,daysWithGoal:E},drinkStats:R,categoryStats:O,...H&&{monthlyAverages:H}})}catch(p){console.error("Error al cargar estadísticas:",p),d(p instanceof Error?p.message:"Error al cargar estadísticas")}finally{o(!1)}}})()},[u,t,n]),{stats:s,loading:i,error:c}},LO=({selectedDate:t,goal:n=2500})=>{const[s,r]=f.useState(_t(t));f.useEffect(()=>{r(_t(t))},[t]);const i=f.useMemo(()=>_t(s),[s]),o=f.useMemo(()=>wn(s),[s]),{stats:c,loading:d}=Sb(i,o),u=f.useMemo(()=>{const p={};return c==null||c.dailyStats.forEach(({date:x,intake:g})=>{p[x]=g}),p},[c]),m=p=>{const x=Oe(p.date),g=u[x]||0,v=Math.min(g/n,1),j=28,b=3,y=(j-b)/2,N=2*Math.PI*y,S=N-v*N,E=g>=n;return e.jsxs("div",{className:"relative flex items-center justify-center w-7 h-7",children:[e.jsxs("svg",{width:j,height:j,className:"absolute",children:[e.jsx("circle",{cx:j/2,cy:j/2,r:y,stroke:E?"#bfdbfe":"#e5e7eb",strokeWidth:b,fill:"none"}),e.jsx("circle",{cx:j/2,cy:j/2,r:y,stroke:E?"#3b82f6":"#9ca3af",strokeWidth:b,fill:"none",strokeDasharray:N,strokeDashoffset:S,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),e.jsx("span",{className:"text-[10px] font-medium z-10",children:p.date.getDate()})]})};return e.jsxs(je,{className:"w-full",children:[e.jsxs(Mt,{className:"flex flex-col items-center gap-2",children:[e.jsx(pf,{className:"w-5 h-5 text-blue-600"}),e.jsx(Lt,{className:"text-center",children:"Historial Mensual"})]}),e.jsxs(we,{className:"relative p-4",children:[d&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 z-10",children:e.jsx(Qt,{className:"w-6 h-6 animate-spin"})}),e.jsx(Ed,{month:s,onMonthChange:r,showOutsideDays:!0,components:{DayContent:m},className:"p-0 w-full"})]})]})},Cb=({selectedDate:t,goal:n})=>{const[s,r]=f.useState(null),[i,o]=f.useState(!1),{user:c}=He(),{intake:d,drinks:u,status:m,error:p,addDrink:x,editDrink:g,deleteDrink:v,resync:j}=MO(t),{isOnline:b}=cr();if(!c)return e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tu hidratación"})})});const y=Oe(t)===Oe(new Date);return e.jsxs(je,{className:"w-full shadow-sm border-0 bg-gradient-to-br from-white to-blue-50/30",children:[e.jsx(we,{className:"p-6 md:p-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx($I,{intake:d,goal:n}),y&&e.jsx("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:e.jsx(PO,{selectedDrink:s,onDrinkSelect:r,onAmountSelect:(N,S)=>{x(N,S),r(null)},disabled:m==="saving"||!b})}),e.jsx(OO,{drinks:u,showHistory:i,onToggleHistory:()=>o(!i),onDeleteDrink:v,onEditDrink:g,isCurrentDate:y}),p&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 shadow-sm",children:e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full flex-shrink-0"}),p]})}),m==="saving"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 shadow-sm",children:e.jsxs("p",{className:"text-sm text-blue-600 flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin flex-shrink-0"}),"Guardando tu progreso..."]})})]})}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[m==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),m==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),m==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),m==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!b&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:j,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]})},$O=({view:t,onViewChange:n})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:t==="weekly"?"default":"outline",size:"sm",onClick:()=>n("weekly"),className:"gap-2",children:[e.jsx(Nn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Semanal"})]}),e.jsxs(F,{variant:t==="graph"?"default":"outline",size:"sm",onClick:()=>n("graph"),className:"gap-2",children:[e.jsx(Yv,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Anual"})]})]}),Ma=[{id:1,name:"Tomar Agua",icon:"💧",timeOfDay:"morning",goal:"5 min"},{id:2,name:"Ejercicio",icon:"🎾",timeOfDay:"morning",goal:"40 min"},{id:3,name:"Ducha fria",icon:"🚿",timeOfDay:"morning",goal:"10 min"},{id:4,name:"Desayuno",icon:"🍳",timeOfDay:"morning",goal:"30 min"},{id:5,name:"Lavarme los dientes",icon:"🪥",timeOfDay:"morning",goal:"2 min"},{id:6,name:"Seda Dental",icon:"🦷",timeOfDay:"morning",goal:"2 min"},{id:7,name:"Tender la cama",icon:"🛏️",timeOfDay:"morning",goal:"3 min"},{id:8,name:"Almuerzo",icon:"🍽️",timeOfDay:"afternoon",goal:"60 min"},{id:9,name:"Siesta",icon:"🛌",timeOfDay:"afternoon",goal:"15 min"},{id:10,name:"Lavarme los dientes",icon:"🪥",timeOfDay:"afternoon",goal:"2 min"},{id:11,name:"Seda Dental",icon:"🦷",timeOfDay:"afternoon",goal:"2 min"},{id:12,name:"Cena",icon:"🍽️",timeOfDay:"night",goal:"30 min"},{id:13,name:"Lavarme los dientes",icon:"🪥",timeOfDay:"night",goal:"2 min"},{id:14,name:"Seda Dental",icon:"🦷",timeOfDay:"night",goal:"2 min"},{id:15,name:"Llevar el diario",icon:"📓",timeOfDay:"anytime",goal:"10 min"},{id:16,name:"Botar algo que no sirva",icon:"🗑️",timeOfDay:"night",goal:"10 min"},{id:17,name:"Organizar la cocina",icon:"🍴",timeOfDay:"night",goal:"15 min"},{id:18,name:"Lectura",icon:"📚",timeOfDay:"night",goal:"5 min"}],zO={1:"bg-blue-500",2:"bg-green-500",3:"bg-yellow-500",4:"bg-orange-500",5:"bg-purple-500",6:"bg-pink-500",7:"bg-red-500",8:"bg-teal-500",9:"bg-indigo-500",10:"bg-gray-500",11:"bg-lime-500",12:"bg-amber-500",13:"bg-cyan-500",14:"bg-fuchsia-500",15:"bg-rose-500",16:"bg-violet-500",17:"bg-sky-500",18:"bg-emerald-500",19:"bg-indigo-500"},Eb=(t=new Date)=>{const n=new Date(t);let s=n.getDay();s=s===0?6:s-1;const r=[];for(let i=0;i<7;i++){const o=new Date(n);o.setDate(n.getDate()-s+i),r.push({dayName:["L","M","X","J","V","S","D"][i],fullDate:Oe(o)})}return r},jg={morning:{icon:Kv,title:"Mañana",defaultOpen:()=>{const t=new Date().getHours();return t>=5&&t<12}},afternoon:{icon:Tm,title:"Tarde",defaultOpen:()=>{const t=new Date().getHours();return t>=12&&t<18}},night:{icon:Jv,title:"Noche",defaultOpen:()=>{const t=new Date().getHours();return t>=18||t<5}},anytime:{icon:Tm,title:"Cualquier momento",defaultOpen:()=>!1}},FO=t=>t>=.9?"¡Increíble! ¡Sigue así! 🌟":t>=.7?"¡Vas muy bien! ¡No pares! 💪":t>=.5?"¡Buen progreso! ¡Sigue adelante! 🎯":t>=.3?"¡Cada pequeño paso cuenta! 🌱":"¡Hoy es un buen día para empezar! 🚀",BO=(t,n)=>{const s=new Date;let r=0;for(let i=0;i<30;i++){const o=new Date(s);o.setDate(o.getDate()-i);const c=Oe(o);if(t.every(u=>n[`${u.id}_${c}`]))r++;else if(i<7)break}return r},Tb=({children:t,completedHabits:n})=>{const[s,r]=f.useState(()=>Object.entries(jg).filter(([c,d])=>d.defaultOpen()).map(([c])=>c)),i=ne.useMemo(()=>Ma.reduce((c,d)=>(c[d.timeOfDay]||(c[d.timeOfDay]=[]),c[d.timeOfDay].push(d),c),{}),[]),o=c=>{const d=Eb(),u=Oe(),m=c.filter(g=>n[`${g.id}_${u}`]).length;let p=0;const x=c.length*d.length;return d.forEach(g=>{c.forEach(v=>{n[`${v.id}_${g.fullDate}`]&&p++})}),{daily:{completed:m,total:c.length},weekly:{completed:p,total:x}}};return e.jsx(Tf,{type:"multiple",value:s,onValueChange:r,className:"w-full space-y-4",children:Object.entries(i).map(([c,d])=>{const u=jg[c],m=u.icon,p=o(d),x=BO(d,n),g=p.daily.completed/p.daily.total;return e.jsxs(jd,{value:c,className:"rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx(wd,{className:"w-full px-6 py-4 flex items-center justify-between text-left hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring data-[state=closed]:rounded-b-lg data-[state=open]:border-b",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:u.title}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Hoy: ",p.daily.completed,"/",p.daily.total]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Semana: ",p.weekly.completed,"/",p.weekly.total]}),x>0&&e.jsxs("div",{className:"flex items-center gap-1 text-amber-500",children:[e.jsx(Zo,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:x})]})]})]})}),e.jsx(Nd,{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-6",children:[t(d),e.jsxs("div",{className:"pt-2 space-y-3 border-t border-gray-100",children:[e.jsx(ca,{value:p.daily.completed/p.daily.total*100,className:"h-2"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:FO(g)}),p.daily.completed===p.daily.total&&e.jsxs("div",{className:"flex items-center gap-1 text-green-500",children:[e.jsx(qv,{className:"w-4 h-4"}),e.jsx("span",{children:"¡Completado!"})]})]})]})]})})]},c)})})},WO=({completedHabits:t,onToggle:n,disabled:s})=>{const r=Eb(new Date),i=o=>e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-[480px] sm:min-w-[600px]",children:e.jsxs("div",{className:"grid grid-cols-[minmax(80px,140px)_repeat(7,minmax(32px,1fr))] sm:grid-cols-[minmax(120px,180px)_repeat(7,minmax(40px,1fr))] gap-1 sm:gap-2",children:[e.jsx("div",{}),r.map(c=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-xs sm:text-sm",children:c.dayName}),e.jsx("div",{className:"text-[9px] sm:text-[10px] text-gray-400",children:c.fullDate.split("-").slice(1).join("/")})]},c.fullDate)),o.map(c=>e.jsxs(ne.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 pr-1",children:[e.jsx("span",{className:"text-sm sm:text-base shrink-0",children:c.icon}),e.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs sm:text-sm font-medium truncate leading-tight",children:c.name}),e.jsx("span",{className:"text-[10px] sm:text-xs text-gray-500 truncate leading-tight",children:c.goal})]})]}),r.map(d=>{const u=t[`${c.id}_${d.fullDate}`];return e.jsx(F,{variant:u?"default":"outline",className:`h-8 w-8 sm:h-10 sm:w-10 p-0 aspect-square rounded-lg flex items-center justify-center transition-colors mx-auto my-0.5 sm:my-1
                      ${u?zO[c.id]:"border-gray-300"}`,onClick:()=>n(c.id,d.fullDate),disabled:s,children:u?e.jsx(dd,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}):null},`${c.id}_${d.fullDate}`)})]},c.id))]})})});return e.jsx("div",{className:"w-full",children:e.jsx(Tb,{completedHabits:t,children:i})})},kb=({year:t,renderCell:n})=>{const s=mR(t);return e.jsxs("div",{className:"inline-block min-w-full",children:[e.jsx("div",{className:"flex gap-1 mb-2 ml-8",children:s.map((r,i)=>e.jsx("div",{className:ce("text-xs text-gray-500 text-center",i===0?"w-8":"w-14"),style:{minWidth:i===0?"32px":`${Math.ceil(r.days/7)*12}px`},children:r.name.slice(0,3)},r.name))}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("div",{className:"flex flex-col gap-1 text-xs text-gray-500 pr-2",children:[e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"L"}),e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"M"}),e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3 flex items-center",children:"V"}),e.jsx("div",{className:"h-3"})]}),e.jsx("div",{className:"flex gap-1",children:s.map(r=>{const i=String(r.number).padStart(2,"0"),o=new Date(t,r.number-1,1).getDay(),c=o===0?6:o-1,d=c+r.days,u=Math.ceil(d/7);return e.jsx("div",{className:"flex gap-1",children:Array.from({length:u},(m,p)=>e.jsx("div",{className:"flex flex-col gap-1",children:Array.from({length:7},(x,g)=>{const v=p*7+g-c+1;if(v<1||v>r.days)return e.jsx("div",{className:"w-3 h-3"},g);const j=String(v).padStart(2,"0"),b=`${t}-${i}-${j}`;return e.jsx(ne.Fragment,{children:n(b)},b)})},p))},r.name)})})]})]})},HO=({completedHabits:t,onToggle:n})=>{const s=new Date().getFullYear(),r=i=>e.jsx("div",{className:"space-y-8",children:i.map(o=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-xl",children:o.icon}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-base",children:o.name}),e.jsxs("span",{className:"text-sm text-gray-600 ml-2",children:["(",o.goal,")"]})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx(kb,{year:s,renderCell:c=>{const d=t[`${o.id}_${c}`],u=new Date().toISOString().split("T")[0]===c;return e.jsx(F,{variant:"ghost",onClick:()=>n(o.id,c),className:ce("w-3 h-3 p-0 rounded-full border transition-all duration-200 hover:scale-110",d?"bg-green-600 border-green-700 hover:bg-green-700":"bg-gray-100 border-gray-200 hover:bg-gray-200 hover:border-gray-300",u&&"ring-2 ring-blue-400 ring-offset-1"),title:`${o.name} - ${new Date(c).toLocaleDateString("es-ES")}${d?" (Completado)":""}`})}}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 text-xs text-gray-600",children:[e.jsx("span",{children:"Menos"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-100 border border-gray-200 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-200 border border-green-300 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-400 border border-green-500 rounded-full"}),e.jsx("div",{className:"w-3 h-3 bg-green-600 border border-green-700 rounded-full"})]}),e.jsx("span",{children:"Más"})]})]})]},o.id))});return e.jsx("div",{className:"w-full",children:e.jsx(Tb,{completedHabits:t,children:r})})},UO=()=>{const[t,n]=f.useState({}),[s,r]=f.useState("idle"),[i,o]=f.useState(null),{user:c}=He(),d=f.useMemo(()=>Object.values(t).reduce((p,x)=>({...p,...x}),{}),[t]);f.useEffect(()=>{if(!c)return;const p=new Date,x=p.getFullYear(),g=p.getMonth()+1,v=`${x}-${String(g).padStart(2,"0")}`;(async()=>{try{Gt.logRead("habits","useHabitData.loadCurrentMonth",`${c.uid}_${v}`);const y=be(fe,"habits",`${c.uid}_${v}`),N=await ds(y);if(N.exists()){const S=N.data();n(E=>({...E,[v]:S.habits||{}})),r("saved")}else n(S=>({...S,[v]:{}})),r("idle")}catch(y){console.error("Error loading current month habits:",y),o(y instanceof Error?y.message:"Error loading habits"),r("error")}})(),(async()=>{const y=VO(p),N=$t(fe,"habits");for(const S of y)if(S!==v)try{(await Wi(_r(N,un("userId","==",c.uid),un("yearMonth","==",S)))).forEach(T=>{const k=T.data();n(M=>({...M,[S]:k.habits||{}}))})}catch(E){console.error(`Error fetching month ${S}:`,E)}})()},[c]);const u=async(p,x)=>{if(!c)return;r("saving"),o(null);const[g,v]=x.split("-"),j=`${g}-${v}`,b=`${p}_${x}`,y=t[j]||{},N={...y,[b]:!y[b]},S=be(fe,"habits",`${c.uid}_${j}`);try{Gt.logWrite("habits","useHabitData.toggleHabit",`${c.uid}_${j}`),await ht(S,{userId:c.uid,yearMonth:j,habits:N,updatedAt:lt()},{merge:!0}),n(E=>({...E,[j]:N})),r("saved")}catch(E){o(E instanceof Error?E.message:"Error al guardar"),r("error")}},m=Rr("Habit data");return{completedHabits:d,status:s,error:i,toggleHabit:u,resync:m}},VO=t=>{const n=[],s=t.getFullYear();for(let r=1;r<=12;r++)n.push(`${s}-${String(r).padStart(2,"0")}`);return n},Er=fk,Tr=pk,GO=hk,_b=f.forwardRef(({className:t,inset:n,children:s,...r},i)=>e.jsxs(Av,{ref:i,className:ce("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",t),...r,children:[s,e.jsx(ia,{className:"ml-auto h-4 w-4"})]}));_b.displayName=Av.displayName;const Db=f.forwardRef(({className:t,...n},s)=>e.jsx(Rv,{ref:s,className:ce("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));Db.displayName=Rv.displayName;const or=f.forwardRef(({className:t,sideOffset:n=4,...s},r)=>e.jsx(mk,{children:e.jsx(Pv,{ref:r,sideOffset:n,className:ce("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));or.displayName=Pv.displayName;const ut=f.forwardRef(({className:t,inset:n,...s},r)=>e.jsx(Iv,{ref:r,className:ce("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",t),...s}));ut.displayName=Iv.displayName;const qO=f.forwardRef(({className:t,children:n,checked:s,...r},i)=>e.jsxs(Ov,{ref:i,className:ce("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:s,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Mv,{children:e.jsx(Hi,{className:"h-4 w-4"})})}),n]}));qO.displayName=Ov.displayName;const YO=f.forwardRef(({className:t,children:n,...s},r)=>e.jsxs(Lv,{ref:r,className:ce("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Mv,{children:e.jsx(n_,{className:"h-2 w-2 fill-current"})})}),n]}));YO.displayName=Lv.displayName;const KO=f.forwardRef(({className:t,inset:n,...s},r)=>e.jsx($v,{ref:r,className:ce("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",t),...s}));KO.displayName=$v.displayName;const Xi=f.forwardRef(({className:t,...n},s)=>e.jsx(zv,{ref:s,className:ce("-mx-1 my-1 h-px bg-muted",t),...n}));Xi.displayName=zv.displayName;/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Ab,setPrototypeOf:wg,isFrozen:JO,getPrototypeOf:XO,getOwnPropertyDescriptor:ZO}=Object;let{freeze:Zs,seal:Bn,create:Rb}=Object,{apply:Ym,construct:Km}=typeof Reflect<"u"&&Reflect;Zs||(Zs=function(n){return n});Bn||(Bn=function(n){return n});Ym||(Ym=function(n,s,r){return n.apply(s,r)});Km||(Km=function(n,s){return new n(...s)});const _c=Qs(Array.prototype.forEach),QO=Qs(Array.prototype.lastIndexOf),Ng=Qs(Array.prototype.pop),ko=Qs(Array.prototype.push),eM=Qs(Array.prototype.splice),Mc=Qs(String.prototype.toLowerCase),lm=Qs(String.prototype.toString),Sg=Qs(String.prototype.match),_o=Qs(String.prototype.replace),tM=Qs(String.prototype.indexOf),sM=Qs(String.prototype.trim),Xn=Qs(Object.prototype.hasOwnProperty),qs=Qs(RegExp.prototype.test),Do=nM(TypeError);function Qs(t){return function(n){n instanceof RegExp&&(n.lastIndex=0);for(var s=arguments.length,r=new Array(s>1?s-1:0),i=1;i<s;i++)r[i-1]=arguments[i];return Ym(t,n,r)}}function nM(t){return function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return Km(t,s)}}function nt(t,n){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Mc;wg&&wg(t,null);let r=n.length;for(;r--;){let i=n[r];if(typeof i=="string"){const o=s(i);o!==i&&(JO(n)||(n[r]=o),i=o)}t[i]=!0}return t}function rM(t){for(let n=0;n<t.length;n++)Xn(t,n)||(t[n]=null);return t}function Jr(t){const n=Rb(null);for(const[s,r]of Ab(t))Xn(t,s)&&(Array.isArray(r)?n[s]=rM(r):r&&typeof r=="object"&&r.constructor===Object?n[s]=Jr(r):n[s]=r);return n}function Ao(t,n){for(;t!==null;){const r=ZO(t,n);if(r){if(r.get)return Qs(r.get);if(typeof r.value=="function")return Qs(r.value)}t=XO(t)}function s(){return null}return s}const Cg=Zs(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),cm=Zs(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),dm=Zs(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),aM=Zs(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),um=Zs(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),iM=Zs(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Eg=Zs(["#text"]),Tg=Zs(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),mm=Zs(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),kg=Zs(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Dc=Zs(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),oM=Bn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),lM=Bn(/<%[\w\W]*|[\w\W]*%>/gm),cM=Bn(/\$\{[\w\W]*/gm),dM=Bn(/^data-[\-\w.\u00B7-\uFFFF]+$/),uM=Bn(/^aria-[\-\w]+$/),Pb=Bn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mM=Bn(/^(?:\w+script|data):/i),fM=Bn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ib=Bn(/^html$/i),pM=Bn(/^[a-z][.\w]*(-[.\w]+)+$/i);var _g=Object.freeze({__proto__:null,ARIA_ATTR:uM,ATTR_WHITESPACE:fM,CUSTOM_ELEMENT:pM,DATA_ATTR:dM,DOCTYPE_NAME:Ib,ERB_EXPR:lM,IS_ALLOWED_URI:Pb,IS_SCRIPT_OR_DATA:mM,MUSTACHE_EXPR:oM,TMPLIT_EXPR:cM});const Ro={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},hM=function(){return typeof window>"u"?null:window},xM=function(n,s){if(typeof n!="object"||typeof n.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";s&&s.hasAttribute(i)&&(r=s.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return n.createPolicy(o,{createHTML(c){return c},createScriptURL(c){return c}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Dg=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ob(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hM();const n=Ie=>Ob(Ie);if(n.version="3.2.6",n.removed=[],!t||!t.document||t.document.nodeType!==Ro.document||!t.Element)return n.isSupported=!1,n;let{document:s}=t;const r=s,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:d,Element:u,NodeFilter:m,NamedNodeMap:p=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:x,DOMParser:g,trustedTypes:v}=t,j=u.prototype,b=Ao(j,"cloneNode"),y=Ao(j,"remove"),N=Ao(j,"nextSibling"),S=Ao(j,"childNodes"),E=Ao(j,"parentNode");if(typeof c=="function"){const Ie=s.createElement("template");Ie.content&&Ie.content.ownerDocument&&(s=Ie.content.ownerDocument)}let T,k="";const{implementation:M,createNodeIterator:R,createDocumentFragment:I,getElementsByTagName:O}=s,{importNode:H}=r;let $=Dg();n.isSupported=typeof Ab=="function"&&typeof E=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:P,TMPLIT_EXPR:K,DATA_ATTR:X,ARIA_ATTR:G,IS_SCRIPT_OR_DATA:U,ATTR_WHITESPACE:Y,CUSTOM_ELEMENT:ae}=_g;let{IS_ALLOWED_URI:ye}=_g,oe=null;const me=nt({},[...Cg,...cm,...dm,...um,...Eg]);let W=null;const se=nt({},[...Tg,...mm,...kg,...Dc]);let ge=Object.seal(Rb(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Me=null,pe=null,_e=!0,We=!0,Pe=!1,Le=!0,le=!1,Re=!0,Ke=!1,Yt=!1,bs=!1,Dt=!1,z=!1,Z=!1,ee=!0,he=!1;const ve="user-content-";let ue=!0,Ce=!1,Ue={},Ze=null;const it=nt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let fs=null;const pr=nt({},["audio","video","img","source","image","track"]);let Rs=null;const Sn=nt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fn="http://www.w3.org/1998/Math/MathML",Ws="http://www.w3.org/2000/svg",Xt="http://www.w3.org/1999/xhtml";let Ps=Xt,tn=!1,Ir=null;const so=nt({},[fn,Ws,Xt],lm);let Or=nt({},["mi","mo","mn","ms","mtext"]),Mr=nt({},["annotation-xml"]);const mi=nt({},["title","style","font","a","script"]);let Cn=null;const En=["application/xhtml+xml","text/html"],no="text/html";let Ee=null,tt=null;const Ct=s.createElement("form"),Is=function(V){return V instanceof RegExp||V instanceof Function},Cs=function(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(tt&&tt===V)){if((!V||typeof V!="object")&&(V={}),V=Jr(V),Cn=En.indexOf(V.PARSER_MEDIA_TYPE)===-1?no:V.PARSER_MEDIA_TYPE,Ee=Cn==="application/xhtml+xml"?lm:Mc,oe=Xn(V,"ALLOWED_TAGS")?nt({},V.ALLOWED_TAGS,Ee):me,W=Xn(V,"ALLOWED_ATTR")?nt({},V.ALLOWED_ATTR,Ee):se,Ir=Xn(V,"ALLOWED_NAMESPACES")?nt({},V.ALLOWED_NAMESPACES,lm):so,Rs=Xn(V,"ADD_URI_SAFE_ATTR")?nt(Jr(Sn),V.ADD_URI_SAFE_ATTR,Ee):Sn,fs=Xn(V,"ADD_DATA_URI_TAGS")?nt(Jr(pr),V.ADD_DATA_URI_TAGS,Ee):pr,Ze=Xn(V,"FORBID_CONTENTS")?nt({},V.FORBID_CONTENTS,Ee):it,Me=Xn(V,"FORBID_TAGS")?nt({},V.FORBID_TAGS,Ee):Jr({}),pe=Xn(V,"FORBID_ATTR")?nt({},V.FORBID_ATTR,Ee):Jr({}),Ue=Xn(V,"USE_PROFILES")?V.USE_PROFILES:!1,_e=V.ALLOW_ARIA_ATTR!==!1,We=V.ALLOW_DATA_ATTR!==!1,Pe=V.ALLOW_UNKNOWN_PROTOCOLS||!1,Le=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,le=V.SAFE_FOR_TEMPLATES||!1,Re=V.SAFE_FOR_XML!==!1,Ke=V.WHOLE_DOCUMENT||!1,Dt=V.RETURN_DOM||!1,z=V.RETURN_DOM_FRAGMENT||!1,Z=V.RETURN_TRUSTED_TYPE||!1,bs=V.FORCE_BODY||!1,ee=V.SANITIZE_DOM!==!1,he=V.SANITIZE_NAMED_PROPS||!1,ue=V.KEEP_CONTENT!==!1,Ce=V.IN_PLACE||!1,ye=V.ALLOWED_URI_REGEXP||Pb,Ps=V.NAMESPACE||Xt,Or=V.MATHML_TEXT_INTEGRATION_POINTS||Or,Mr=V.HTML_INTEGRATION_POINTS||Mr,ge=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&Is(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ge.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&Is(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ge.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ge.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),le&&(We=!1),z&&(Dt=!0),Ue&&(oe=nt({},Eg),W=[],Ue.html===!0&&(nt(oe,Cg),nt(W,Tg)),Ue.svg===!0&&(nt(oe,cm),nt(W,mm),nt(W,Dc)),Ue.svgFilters===!0&&(nt(oe,dm),nt(W,mm),nt(W,Dc)),Ue.mathMl===!0&&(nt(oe,um),nt(W,kg),nt(W,Dc))),V.ADD_TAGS&&(oe===me&&(oe=Jr(oe)),nt(oe,V.ADD_TAGS,Ee)),V.ADD_ATTR&&(W===se&&(W=Jr(W)),nt(W,V.ADD_ATTR,Ee)),V.ADD_URI_SAFE_ATTR&&nt(Rs,V.ADD_URI_SAFE_ATTR,Ee),V.FORBID_CONTENTS&&(Ze===it&&(Ze=Jr(Ze)),nt(Ze,V.FORBID_CONTENTS,Ee)),ue&&(oe["#text"]=!0),Ke&&nt(oe,["html","head","body"]),oe.table&&(nt(oe,["tbody"]),delete Me.tbody),V.TRUSTED_TYPES_POLICY){if(typeof V.TRUSTED_TYPES_POLICY.createHTML!="function")throw Do('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof V.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Do('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');T=V.TRUSTED_TYPES_POLICY,k=T.createHTML("")}else T===void 0&&(T=xM(v,i)),T!==null&&typeof k=="string"&&(k=T.createHTML(""));Zs&&Zs(V),tt=V}},pn=nt({},[...cm,...dm,...aM]),sn=nt({},[...um,...iM]),Hs=function(V){let xe=E(V);(!xe||!xe.tagName)&&(xe={namespaceURI:Ps,tagName:"template"});const ke=Mc(V.tagName),Et=Mc(xe.tagName);return Ir[V.namespaceURI]?V.namespaceURI===Ws?xe.namespaceURI===Xt?ke==="svg":xe.namespaceURI===fn?ke==="svg"&&(Et==="annotation-xml"||Or[Et]):!!pn[ke]:V.namespaceURI===fn?xe.namespaceURI===Xt?ke==="math":xe.namespaceURI===Ws?ke==="math"&&Mr[Et]:!!sn[ke]:V.namespaceURI===Xt?xe.namespaceURI===Ws&&!Mr[Et]||xe.namespaceURI===fn&&!Or[Et]?!1:!sn[ke]&&(mi[ke]||!pn[ke]):!!(Cn==="application/xhtml+xml"&&Ir[V.namespaceURI]):!1},Kt=function(V){ko(n.removed,{element:V});try{E(V).removeChild(V)}catch{y(V)}},ua=function(V,xe){try{ko(n.removed,{attribute:xe.getAttributeNode(V),from:xe})}catch{ko(n.removed,{attribute:null,from:xe})}if(xe.removeAttribute(V),V==="is")if(Dt||z)try{Kt(xe)}catch{}else try{xe.setAttribute(V,"")}catch{}},Rl=function(V){let xe=null,ke=null;if(bs)V="<remove></remove>"+V;else{const Ht=Sg(V,/^[\r\n\t ]+/);ke=Ht&&Ht[0]}Cn==="application/xhtml+xml"&&Ps===Xt&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");const Et=T?T.createHTML(V):V;if(Ps===Xt)try{xe=new g().parseFromString(Et,Cn)}catch{}if(!xe||!xe.documentElement){xe=M.createDocument(Ps,"template",null);try{xe.documentElement.innerHTML=tn?k:Et}catch{}}const js=xe.body||xe.documentElement;return V&&ke&&js.insertBefore(s.createTextNode(ke),js.childNodes[0]||null),Ps===Xt?O.call(xe,Ke?"html":"body")[0]:Ke?xe.documentElement:js},Pl=function(V){return R.call(V.ownerDocument||V,V,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},ro=function(V){return V instanceof x&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof p)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},Il=function(V){return typeof d=="function"&&V instanceof d};function Hn(Ie,V,xe){_c(Ie,ke=>{ke.call(n,V,xe,tt)})}const Ol=function(V){let xe=null;if(Hn($.beforeSanitizeElements,V,null),ro(V))return Kt(V),!0;const ke=Ee(V.nodeName);if(Hn($.uponSanitizeElement,V,{tagName:ke,allowedTags:oe}),Re&&V.hasChildNodes()&&!Il(V.firstElementChild)&&qs(/<[/\w!]/g,V.innerHTML)&&qs(/<[/\w!]/g,V.textContent)||V.nodeType===Ro.progressingInstruction||Re&&V.nodeType===Ro.comment&&qs(/<[/\w]/g,V.data))return Kt(V),!0;if(!oe[ke]||Me[ke]){if(!Me[ke]&&ao(ke)&&(ge.tagNameCheck instanceof RegExp&&qs(ge.tagNameCheck,ke)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(ke)))return!1;if(ue&&!Ze[ke]){const Et=E(V)||V.parentNode,js=S(V)||V.childNodes;if(js&&Et){const Ht=js.length;for(let Os=Ht-1;Os>=0;--Os){const Un=b(js[Os],!0);Un.__removalCount=(V.__removalCount||0)+1,Et.insertBefore(Un,N(V))}}}return Kt(V),!0}return V instanceof u&&!Hs(V)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&qs(/<\/no(script|embed|frames)/i,V.innerHTML)?(Kt(V),!0):(le&&V.nodeType===Ro.text&&(xe=V.textContent,_c([D,P,K],Et=>{xe=_o(xe,Et," ")}),V.textContent!==xe&&(ko(n.removed,{element:V.cloneNode()}),V.textContent=xe)),Hn($.afterSanitizeElements,V,null),!1)},Ml=function(V,xe,ke){if(ee&&(xe==="id"||xe==="name")&&(ke in s||ke in Ct))return!1;if(!(We&&!pe[xe]&&qs(X,xe))){if(!(_e&&qs(G,xe))){if(!W[xe]||pe[xe]){if(!(ao(V)&&(ge.tagNameCheck instanceof RegExp&&qs(ge.tagNameCheck,V)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(V))&&(ge.attributeNameCheck instanceof RegExp&&qs(ge.attributeNameCheck,xe)||ge.attributeNameCheck instanceof Function&&ge.attributeNameCheck(xe))||xe==="is"&&ge.allowCustomizedBuiltInElements&&(ge.tagNameCheck instanceof RegExp&&qs(ge.tagNameCheck,ke)||ge.tagNameCheck instanceof Function&&ge.tagNameCheck(ke))))return!1}else if(!Rs[xe]){if(!qs(ye,_o(ke,Y,""))){if(!((xe==="src"||xe==="xlink:href"||xe==="href")&&V!=="script"&&tM(ke,"data:")===0&&fs[V])){if(!(Pe&&!qs(U,_o(ke,Y,"")))){if(ke)return!1}}}}}}return!0},ao=function(V){return V!=="annotation-xml"&&Sg(V,ae)},Ll=function(V){Hn($.beforeSanitizeAttributes,V,null);const{attributes:xe}=V;if(!xe||ro(V))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:W,forceKeepAttr:void 0};let Et=xe.length;for(;Et--;){const js=xe[Et],{name:Ht,namespaceURI:Os,value:Un}=js,Ha=Ee(Ht),fi=Un;let ps=Ht==="value"?fi:sM(fi);if(ke.attrName=Ha,ke.attrValue=ps,ke.keepAttr=!0,ke.forceKeepAttr=void 0,Hn($.uponSanitizeAttribute,V,ke),ps=ke.attrValue,he&&(Ha==="id"||Ha==="name")&&(ua(Ht,V),ps=ve+ps),Re&&qs(/((--!?|])>)|<\/(style|title)/i,ps)){ua(Ht,V);continue}if(ke.forceKeepAttr)continue;if(!ke.keepAttr){ua(Ht,V);continue}if(!Le&&qs(/\/>/i,ps)){ua(Ht,V);continue}le&&_c([D,P,K],$l=>{ps=_o(ps,$l," ")});const io=Ee(V.nodeName);if(!Ml(io,Ha,ps)){ua(Ht,V);continue}if(T&&typeof v=="object"&&typeof v.getAttributeType=="function"&&!Os)switch(v.getAttributeType(io,Ha)){case"TrustedHTML":{ps=T.createHTML(ps);break}case"TrustedScriptURL":{ps=T.createScriptURL(ps);break}}if(ps!==fi)try{Os?V.setAttributeNS(Os,Ht,ps):V.setAttribute(Ht,ps),ro(V)?Kt(V):Ng(n.removed)}catch{ua(Ht,V)}}Hn($.afterSanitizeAttributes,V,null)},Bd=function Ie(V){let xe=null;const ke=Pl(V);for(Hn($.beforeSanitizeShadowDOM,V,null);xe=ke.nextNode();)Hn($.uponSanitizeShadowNode,xe,null),Ol(xe),Ll(xe),xe.content instanceof o&&Ie(xe.content);Hn($.afterSanitizeShadowDOM,V,null)};return n.sanitize=function(Ie){let V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},xe=null,ke=null,Et=null,js=null;if(tn=!Ie,tn&&(Ie="<!-->"),typeof Ie!="string"&&!Il(Ie))if(typeof Ie.toString=="function"){if(Ie=Ie.toString(),typeof Ie!="string")throw Do("dirty is not a string, aborting")}else throw Do("toString is not a function");if(!n.isSupported)return Ie;if(Yt||Cs(V),n.removed=[],typeof Ie=="string"&&(Ce=!1),Ce){if(Ie.nodeName){const Un=Ee(Ie.nodeName);if(!oe[Un]||Me[Un])throw Do("root node is forbidden and cannot be sanitized in-place")}}else if(Ie instanceof d)xe=Rl("<!---->"),ke=xe.ownerDocument.importNode(Ie,!0),ke.nodeType===Ro.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?xe=ke:xe.appendChild(ke);else{if(!Dt&&!le&&!Ke&&Ie.indexOf("<")===-1)return T&&Z?T.createHTML(Ie):Ie;if(xe=Rl(Ie),!xe)return Dt?null:Z?k:""}xe&&bs&&Kt(xe.firstChild);const Ht=Pl(Ce?Ie:xe);for(;Et=Ht.nextNode();)Ol(Et),Ll(Et),Et.content instanceof o&&Bd(Et.content);if(Ce)return Ie;if(Dt){if(z)for(js=I.call(xe.ownerDocument);xe.firstChild;)js.appendChild(xe.firstChild);else js=xe;return(W.shadowroot||W.shadowrootmode)&&(js=H.call(r,js,!0)),js}let Os=Ke?xe.outerHTML:xe.innerHTML;return Ke&&oe["!doctype"]&&xe.ownerDocument&&xe.ownerDocument.doctype&&xe.ownerDocument.doctype.name&&qs(Ib,xe.ownerDocument.doctype.name)&&(Os="<!DOCTYPE "+xe.ownerDocument.doctype.name+`>
`+Os),le&&_c([D,P,K],Un=>{Os=_o(Os,Un," ")}),T&&Z?T.createHTML(Os):Os},n.setConfig=function(){let Ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Cs(Ie),Yt=!0},n.clearConfig=function(){tt=null,Yt=!1},n.isValidAttribute=function(Ie,V,xe){tt||Cs({});const ke=Ee(Ie),Et=Ee(V);return Ml(ke,Et,xe)},n.addHook=function(Ie,V){typeof V=="function"&&ko($[Ie],V)},n.removeHook=function(Ie,V){if(V!==void 0){const xe=QO($[Ie],V);return xe===-1?void 0:eM($[Ie],xe,1)[0]}return Ng($[Ie])},n.removeHooks=function(Ie){$[Ie]=[]},n.removeAllHooks=function(){$=Dg()},n}var $a=Ob();function Vf(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ui=Vf();function Mb(t){ui=t}var Ho={exec:()=>null};function St(t,n=""){let s=typeof t=="string"?t:t.source;const r={replace:(i,o)=>{let c=typeof o=="string"?o:o.source;return c=c.replace(Ks.caret,"$1"),s=s.replace(i,c),r},getRegex:()=>new RegExp(s,n)};return r}var Ks={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},gM=/^(?:[ \t]*(?:\n|$))+/,vM=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,yM=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Tl=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,bM=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Gf=/(?:[*+-]|\d{1,9}[.)])/,Lb=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,$b=St(Lb).replace(/bull/g,Gf).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),jM=St(Lb).replace(/bull/g,Gf).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),qf=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,wM=/^[^\n]+/,Yf=/(?!\s*\])(?:\\.|[^\[\]\\])+/,NM=St(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Yf).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),SM=St(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Gf).getRegex(),Rd="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Kf=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,CM=St("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Kf).replace("tag",Rd).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),zb=St(qf).replace("hr",Tl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rd).getRegex(),EM=St(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",zb).getRegex(),Jf={blockquote:EM,code:vM,def:NM,fences:yM,heading:bM,hr:Tl,html:CM,lheading:$b,list:SM,newline:gM,paragraph:zb,table:Ho,text:wM},Ag=St("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Tl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rd).getRegex(),TM={...Jf,lheading:jM,table:Ag,paragraph:St(qf).replace("hr",Tl).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ag).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Rd).getRegex()},kM={...Jf,html:St(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Kf).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ho,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:St(qf).replace("hr",Tl).replace("heading",` *#{1,6} *[^
]`).replace("lheading",$b).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},_M=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,DM=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Fb=/^( {2,}|\\)\n(?!\s*$)/,AM=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Pd=/[\p{P}\p{S}]/u,Xf=/[\s\p{P}\p{S}]/u,Bb=/[^\s\p{P}\p{S}]/u,RM=St(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Xf).getRegex(),Wb=/(?!~)[\p{P}\p{S}]/u,PM=/(?!~)[\s\p{P}\p{S}]/u,IM=/(?:[^\s\p{P}\p{S}]|~)/u,OM=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Hb=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,MM=St(Hb,"u").replace(/punct/g,Pd).getRegex(),LM=St(Hb,"u").replace(/punct/g,Wb).getRegex(),Ub="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",$M=St(Ub,"gu").replace(/notPunctSpace/g,Bb).replace(/punctSpace/g,Xf).replace(/punct/g,Pd).getRegex(),zM=St(Ub,"gu").replace(/notPunctSpace/g,IM).replace(/punctSpace/g,PM).replace(/punct/g,Wb).getRegex(),FM=St("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Bb).replace(/punctSpace/g,Xf).replace(/punct/g,Pd).getRegex(),BM=St(/\\(punct)/,"gu").replace(/punct/g,Pd).getRegex(),WM=St(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),HM=St(Kf).replace("(?:-->|$)","-->").getRegex(),UM=St("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",HM).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Jc=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,VM=St(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",Jc).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Vb=St(/^!?\[(label)\]\[(ref)\]/).replace("label",Jc).replace("ref",Yf).getRegex(),Gb=St(/^!?\[(ref)\](?:\[\])?/).replace("ref",Yf).getRegex(),GM=St("reflink|nolink(?!\\()","g").replace("reflink",Vb).replace("nolink",Gb).getRegex(),Zf={_backpedal:Ho,anyPunctuation:BM,autolink:WM,blockSkip:OM,br:Fb,code:DM,del:Ho,emStrongLDelim:MM,emStrongRDelimAst:$M,emStrongRDelimUnd:FM,escape:_M,link:VM,nolink:Gb,punctuation:RM,reflink:Vb,reflinkSearch:GM,tag:UM,text:AM,url:Ho},qM={...Zf,link:St(/^!?\[(label)\]\((.*?)\)/).replace("label",Jc).getRegex(),reflink:St(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Jc).getRegex()},Jm={...Zf,emStrongRDelimAst:zM,emStrongLDelim:LM,url:St(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},YM={...Jm,br:St(Fb).replace("{2,}","*").getRegex(),text:St(Jm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ac={normal:Jf,gfm:TM,pedantic:kM},Po={normal:Zf,gfm:Jm,breaks:YM,pedantic:qM},KM={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Rg=t=>KM[t];function vr(t,n){if(n){if(Ks.escapeTest.test(t))return t.replace(Ks.escapeReplace,Rg)}else if(Ks.escapeTestNoEncode.test(t))return t.replace(Ks.escapeReplaceNoEncode,Rg);return t}function Pg(t){try{t=encodeURI(t).replace(Ks.percentDecode,"%")}catch{return null}return t}function Ig(t,n){var o;const s=t.replace(Ks.findPipe,(c,d,u)=>{let m=!1,p=d;for(;--p>=0&&u[p]==="\\";)m=!m;return m?"|":" |"}),r=s.split(Ks.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((o=r.at(-1))!=null&&o.trim())&&r.pop(),n)if(r.length>n)r.splice(n);else for(;r.length<n;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(Ks.slashPipe,"|");return r}function Io(t,n,s){const r=t.length;if(r===0)return"";let i=0;for(;i<r;){const o=t.charAt(r-i-1);if(o===n&&!s)i++;else if(o!==n&&s)i++;else break}return t.slice(0,r-i)}function JM(t,n){if(t.indexOf(n[1])===-1)return-1;let s=0;for(let r=0;r<t.length;r++)if(t[r]==="\\")r++;else if(t[r]===n[0])s++;else if(t[r]===n[1]&&(s--,s<0))return r;return s>0?-2:-1}function Og(t,n,s,r,i){const o=n.href,c=n.title||null,d=t[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;const u={type:t[0].charAt(0)==="!"?"image":"link",raw:s,href:o,title:c,text:d,tokens:r.inlineTokens(d)};return r.state.inLink=!1,u}function XM(t,n,s){const r=t.match(s.other.indentCodeCompensation);if(r===null)return n;const i=r[1];return n.split(`
`).map(o=>{const c=o.match(s.other.beginningSpace);if(c===null)return o;const[d]=c;return d.length>=i.length?o.slice(i.length):o}).join(`
`)}var Xc=class{constructor(t){Nt(this,"options");Nt(this,"rules");Nt(this,"lexer");this.options=t||ui}space(t){const n=this.rules.block.newline.exec(t);if(n&&n[0].length>0)return{type:"space",raw:n[0]}}code(t){const n=this.rules.block.code.exec(t);if(n){const s=n[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:n[0],codeBlockStyle:"indented",text:this.options.pedantic?s:Io(s,`
`)}}}fences(t){const n=this.rules.block.fences.exec(t);if(n){const s=n[0],r=XM(s,n[3]||"",this.rules);return{type:"code",raw:s,lang:n[2]?n[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):n[2],text:r}}}heading(t){const n=this.rules.block.heading.exec(t);if(n){let s=n[2].trim();if(this.rules.other.endingHash.test(s)){const r=Io(s,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(s=r.trim())}return{type:"heading",raw:n[0],depth:n[1].length,text:s,tokens:this.lexer.inline(s)}}}hr(t){const n=this.rules.block.hr.exec(t);if(n)return{type:"hr",raw:Io(n[0],`
`)}}blockquote(t){const n=this.rules.block.blockquote.exec(t);if(n){let s=Io(n[0],`
`).split(`
`),r="",i="";const o=[];for(;s.length>0;){let c=!1;const d=[];let u;for(u=0;u<s.length;u++)if(this.rules.other.blockquoteStart.test(s[u]))d.push(s[u]),c=!0;else if(!c)d.push(s[u]);else break;s=s.slice(u);const m=d.join(`
`),p=m.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${m}`:m,i=i?`${i}
${p}`:p;const x=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,o,!0),this.lexer.state.top=x,s.length===0)break;const g=o.at(-1);if((g==null?void 0:g.type)==="code")break;if((g==null?void 0:g.type)==="blockquote"){const v=g,j=v.raw+`
`+s.join(`
`),b=this.blockquote(j);o[o.length-1]=b,r=r.substring(0,r.length-v.raw.length)+b.raw,i=i.substring(0,i.length-v.text.length)+b.text;break}else if((g==null?void 0:g.type)==="list"){const v=g,j=v.raw+`
`+s.join(`
`),b=this.list(j);o[o.length-1]=b,r=r.substring(0,r.length-g.raw.length)+b.raw,i=i.substring(0,i.length-v.raw.length)+b.raw,s=j.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:o,text:i}}}list(t){let n=this.rules.block.list.exec(t);if(n){let s=n[1].trim();const r=s.length>1,i={type:"list",raw:"",ordered:r,start:r?+s.slice(0,-1):"",loose:!1,items:[]};s=r?`\\d{1,9}\\${s.slice(-1)}`:`\\${s}`,this.options.pedantic&&(s=r?s:"[*+-]");const o=this.rules.other.listItemRegex(s);let c=!1;for(;t;){let u=!1,m="",p="";if(!(n=o.exec(t))||this.rules.block.hr.test(t))break;m=n[0],t=t.substring(m.length);let x=n[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,N=>" ".repeat(3*N.length)),g=t.split(`
`,1)[0],v=!x.trim(),j=0;if(this.options.pedantic?(j=2,p=x.trimStart()):v?j=n[1].length+1:(j=n[2].search(this.rules.other.nonSpaceChar),j=j>4?1:j,p=x.slice(j),j+=n[1].length),v&&this.rules.other.blankLine.test(g)&&(m+=g+`
`,t=t.substring(g.length+1),u=!0),!u){const N=this.rules.other.nextBulletRegex(j),S=this.rules.other.hrRegex(j),E=this.rules.other.fencesBeginRegex(j),T=this.rules.other.headingBeginRegex(j),k=this.rules.other.htmlBeginRegex(j);for(;t;){const M=t.split(`
`,1)[0];let R;if(g=M,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),R=g):R=g.replace(this.rules.other.tabCharGlobal,"    "),E.test(g)||T.test(g)||k.test(g)||N.test(g)||S.test(g))break;if(R.search(this.rules.other.nonSpaceChar)>=j||!g.trim())p+=`
`+R.slice(j);else{if(v||x.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(x)||T.test(x)||S.test(x))break;p+=`
`+g}!v&&!g.trim()&&(v=!0),m+=M+`
`,t=t.substring(M.length+1),x=R.slice(j)}}i.loose||(c?i.loose=!0:this.rules.other.doubleBlankLine.test(m)&&(c=!0));let b=null,y;this.options.gfm&&(b=this.rules.other.listIsTask.exec(p),b&&(y=b[0]!=="[ ] ",p=p.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:m,task:!!b,checked:y,loose:!1,text:p,tokens:[]}),i.raw+=m}const d=i.items.at(-1);if(d)d.raw=d.raw.trimEnd(),d.text=d.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let u=0;u<i.items.length;u++)if(this.lexer.state.top=!1,i.items[u].tokens=this.lexer.blockTokens(i.items[u].text,[]),!i.loose){const m=i.items[u].tokens.filter(x=>x.type==="space"),p=m.length>0&&m.some(x=>this.rules.other.anyLine.test(x.raw));i.loose=p}if(i.loose)for(let u=0;u<i.items.length;u++)i.items[u].loose=!0;return i}}html(t){const n=this.rules.block.html.exec(t);if(n)return{type:"html",block:!0,raw:n[0],pre:n[1]==="pre"||n[1]==="script"||n[1]==="style",text:n[0]}}def(t){const n=this.rules.block.def.exec(t);if(n){const s=n[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=n[2]?n[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=n[3]?n[3].substring(1,n[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):n[3];return{type:"def",tag:s,raw:n[0],href:r,title:i}}}table(t){var c;const n=this.rules.block.table.exec(t);if(!n||!this.rules.other.tableDelimiter.test(n[2]))return;const s=Ig(n[1]),r=n[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(c=n[3])!=null&&c.trim()?n[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:n[0],header:[],align:[],rows:[]};if(s.length===r.length){for(const d of r)this.rules.other.tableAlignRight.test(d)?o.align.push("right"):this.rules.other.tableAlignCenter.test(d)?o.align.push("center"):this.rules.other.tableAlignLeft.test(d)?o.align.push("left"):o.align.push(null);for(let d=0;d<s.length;d++)o.header.push({text:s[d],tokens:this.lexer.inline(s[d]),header:!0,align:o.align[d]});for(const d of i)o.rows.push(Ig(d,o.header.length).map((u,m)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:o.align[m]})));return o}}lheading(t){const n=this.rules.block.lheading.exec(t);if(n)return{type:"heading",raw:n[0],depth:n[2].charAt(0)==="="?1:2,text:n[1],tokens:this.lexer.inline(n[1])}}paragraph(t){const n=this.rules.block.paragraph.exec(t);if(n){const s=n[1].charAt(n[1].length-1)===`
`?n[1].slice(0,-1):n[1];return{type:"paragraph",raw:n[0],text:s,tokens:this.lexer.inline(s)}}}text(t){const n=this.rules.block.text.exec(t);if(n)return{type:"text",raw:n[0],text:n[0],tokens:this.lexer.inline(n[0])}}escape(t){const n=this.rules.inline.escape.exec(t);if(n)return{type:"escape",raw:n[0],text:n[1]}}tag(t){const n=this.rules.inline.tag.exec(t);if(n)return!this.lexer.state.inLink&&this.rules.other.startATag.test(n[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(n[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(n[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(n[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:n[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:n[0]}}link(t){const n=this.rules.inline.link.exec(t);if(n){const s=n[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(s)){if(!this.rules.other.endAngleBracket.test(s))return;const o=Io(s.slice(0,-1),"\\");if((s.length-o.length)%2===0)return}else{const o=JM(n[2],"()");if(o===-2)return;if(o>-1){const d=(n[0].indexOf("!")===0?5:4)+n[1].length+o;n[2]=n[2].substring(0,o),n[0]=n[0].substring(0,d).trim(),n[3]=""}}let r=n[2],i="";if(this.options.pedantic){const o=this.rules.other.pedanticHrefTitle.exec(r);o&&(r=o[1],i=o[3])}else i=n[3]?n[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(s)?r=r.slice(1):r=r.slice(1,-1)),Og(n,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},n[0],this.lexer,this.rules)}}reflink(t,n){let s;if((s=this.rules.inline.reflink.exec(t))||(s=this.rules.inline.nolink.exec(t))){const r=(s[2]||s[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=n[r.toLowerCase()];if(!i){const o=s[0].charAt(0);return{type:"text",raw:o,text:o}}return Og(s,i,s[0],this.lexer,this.rules)}}emStrong(t,n,s=""){let r=this.rules.inline.emStrongLDelim.exec(t);if(!r||r[3]&&s.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!s||this.rules.inline.punctuation.exec(s)){const o=[...r[0]].length-1;let c,d,u=o,m=0;const p=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,n=n.slice(-1*t.length+o);(r=p.exec(n))!=null;){if(c=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!c)continue;if(d=[...c].length,r[3]||r[4]){u+=d;continue}else if((r[5]||r[6])&&o%3&&!((o+d)%3)){m+=d;continue}if(u-=d,u>0)continue;d=Math.min(d,d+u+m);const x=[...r[0]][0].length,g=t.slice(0,o+r.index+x+d);if(Math.min(o,d)%2){const j=g.slice(1,-1);return{type:"em",raw:g,text:j,tokens:this.lexer.inlineTokens(j)}}const v=g.slice(2,-2);return{type:"strong",raw:g,text:v,tokens:this.lexer.inlineTokens(v)}}}}codespan(t){const n=this.rules.inline.code.exec(t);if(n){let s=n[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(s),i=this.rules.other.startingSpaceChar.test(s)&&this.rules.other.endingSpaceChar.test(s);return r&&i&&(s=s.substring(1,s.length-1)),{type:"codespan",raw:n[0],text:s}}}br(t){const n=this.rules.inline.br.exec(t);if(n)return{type:"br",raw:n[0]}}del(t){const n=this.rules.inline.del.exec(t);if(n)return{type:"del",raw:n[0],text:n[2],tokens:this.lexer.inlineTokens(n[2])}}autolink(t){const n=this.rules.inline.autolink.exec(t);if(n){let s,r;return n[2]==="@"?(s=n[1],r="mailto:"+s):(s=n[1],r=s),{type:"link",raw:n[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}url(t){var s;let n;if(n=this.rules.inline.url.exec(t)){let r,i;if(n[2]==="@")r=n[0],i="mailto:"+r;else{let o;do o=n[0],n[0]=((s=this.rules.inline._backpedal.exec(n[0]))==null?void 0:s[0])??"";while(o!==n[0]);r=n[0],n[1]==="www."?i="http://"+n[0]:i=n[0]}return{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(t){const n=this.rules.inline.text.exec(t);if(n){const s=this.lexer.state.inRawBlock;return{type:"text",raw:n[0],text:n[0],escaped:s}}}},ta=class Xm{constructor(n){Nt(this,"tokens");Nt(this,"options");Nt(this,"state");Nt(this,"tokenizer");Nt(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=n||ui,this.options.tokenizer=this.options.tokenizer||new Xc,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const s={other:Ks,block:Ac.normal,inline:Po.normal};this.options.pedantic?(s.block=Ac.pedantic,s.inline=Po.pedantic):this.options.gfm&&(s.block=Ac.gfm,this.options.breaks?s.inline=Po.breaks:s.inline=Po.gfm),this.tokenizer.rules=s}static get rules(){return{block:Ac,inline:Po}}static lex(n,s){return new Xm(s).lex(n)}static lexInline(n,s){return new Xm(s).inlineTokens(n)}lex(n){n=n.replace(Ks.carriageReturn,`
`),this.blockTokens(n,this.tokens);for(let s=0;s<this.inlineQueue.length;s++){const r=this.inlineQueue[s];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(n,s=[],r=!1){var i,o,c;for(this.options.pedantic&&(n=n.replace(Ks.tabCharGlobal,"    ").replace(Ks.spaceLine,""));n;){let d;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(m=>(d=m.call({lexer:this},n,s))?(n=n.substring(d.raw.length),s.push(d),!0):!1))continue;if(d=this.tokenizer.space(n)){n=n.substring(d.raw.length);const m=s.at(-1);d.raw.length===1&&m!==void 0?m.raw+=`
`:s.push(d);continue}if(d=this.tokenizer.code(n)){n=n.substring(d.raw.length);const m=s.at(-1);(m==null?void 0:m.type)==="paragraph"||(m==null?void 0:m.type)==="text"?(m.raw+=`
`+d.raw,m.text+=`
`+d.text,this.inlineQueue.at(-1).src=m.text):s.push(d);continue}if(d=this.tokenizer.fences(n)){n=n.substring(d.raw.length),s.push(d);continue}if(d=this.tokenizer.heading(n)){n=n.substring(d.raw.length),s.push(d);continue}if(d=this.tokenizer.hr(n)){n=n.substring(d.raw.length),s.push(d);continue}if(d=this.tokenizer.blockquote(n)){n=n.substring(d.raw.length),s.push(d);continue}if(d=this.tokenizer.list(n)){n=n.substring(d.raw.length),s.push(d);continue}if(d=this.tokenizer.html(n)){n=n.substring(d.raw.length),s.push(d);continue}if(d=this.tokenizer.def(n)){n=n.substring(d.raw.length);const m=s.at(-1);(m==null?void 0:m.type)==="paragraph"||(m==null?void 0:m.type)==="text"?(m.raw+=`
`+d.raw,m.text+=`
`+d.raw,this.inlineQueue.at(-1).src=m.text):this.tokens.links[d.tag]||(this.tokens.links[d.tag]={href:d.href,title:d.title});continue}if(d=this.tokenizer.table(n)){n=n.substring(d.raw.length),s.push(d);continue}if(d=this.tokenizer.lheading(n)){n=n.substring(d.raw.length),s.push(d);continue}let u=n;if((c=this.options.extensions)!=null&&c.startBlock){let m=1/0;const p=n.slice(1);let x;this.options.extensions.startBlock.forEach(g=>{x=g.call({lexer:this},p),typeof x=="number"&&x>=0&&(m=Math.min(m,x))}),m<1/0&&m>=0&&(u=n.substring(0,m+1))}if(this.state.top&&(d=this.tokenizer.paragraph(u))){const m=s.at(-1);r&&(m==null?void 0:m.type)==="paragraph"?(m.raw+=`
`+d.raw,m.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=m.text):s.push(d),r=u.length!==n.length,n=n.substring(d.raw.length);continue}if(d=this.tokenizer.text(n)){n=n.substring(d.raw.length);const m=s.at(-1);(m==null?void 0:m.type)==="text"?(m.raw+=`
`+d.raw,m.text+=`
`+d.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=m.text):s.push(d);continue}if(n){const m="Infinite loop on byte: "+n.charCodeAt(0);if(this.options.silent){console.error(m);break}else throw new Error(m)}}return this.state.top=!0,s}inline(n,s=[]){return this.inlineQueue.push({src:n,tokens:s}),s}inlineTokens(n,s=[]){var d,u,m;let r=n,i=null;if(this.tokens.links){const p=Object.keys(this.tokens.links);if(p.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)p.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let o=!1,c="";for(;n;){o||(c=""),o=!1;let p;if((u=(d=this.options.extensions)==null?void 0:d.inline)!=null&&u.some(g=>(p=g.call({lexer:this},n,s))?(n=n.substring(p.raw.length),s.push(p),!0):!1))continue;if(p=this.tokenizer.escape(n)){n=n.substring(p.raw.length),s.push(p);continue}if(p=this.tokenizer.tag(n)){n=n.substring(p.raw.length),s.push(p);continue}if(p=this.tokenizer.link(n)){n=n.substring(p.raw.length),s.push(p);continue}if(p=this.tokenizer.reflink(n,this.tokens.links)){n=n.substring(p.raw.length);const g=s.at(-1);p.type==="text"&&(g==null?void 0:g.type)==="text"?(g.raw+=p.raw,g.text+=p.text):s.push(p);continue}if(p=this.tokenizer.emStrong(n,r,c)){n=n.substring(p.raw.length),s.push(p);continue}if(p=this.tokenizer.codespan(n)){n=n.substring(p.raw.length),s.push(p);continue}if(p=this.tokenizer.br(n)){n=n.substring(p.raw.length),s.push(p);continue}if(p=this.tokenizer.del(n)){n=n.substring(p.raw.length),s.push(p);continue}if(p=this.tokenizer.autolink(n)){n=n.substring(p.raw.length),s.push(p);continue}if(!this.state.inLink&&(p=this.tokenizer.url(n))){n=n.substring(p.raw.length),s.push(p);continue}let x=n;if((m=this.options.extensions)!=null&&m.startInline){let g=1/0;const v=n.slice(1);let j;this.options.extensions.startInline.forEach(b=>{j=b.call({lexer:this},v),typeof j=="number"&&j>=0&&(g=Math.min(g,j))}),g<1/0&&g>=0&&(x=n.substring(0,g+1))}if(p=this.tokenizer.inlineText(x)){n=n.substring(p.raw.length),p.raw.slice(-1)!=="_"&&(c=p.raw.slice(-1)),o=!0;const g=s.at(-1);(g==null?void 0:g.type)==="text"?(g.raw+=p.raw,g.text+=p.text):s.push(p);continue}if(n){const g="Infinite loop on byte: "+n.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return s}},Zc=class{constructor(t){Nt(this,"options");Nt(this,"parser");this.options=t||ui}space(t){return""}code({text:t,lang:n,escaped:s}){var o;const r=(o=(n||"").match(Ks.notSpaceStart))==null?void 0:o[0],i=t.replace(Ks.endingNewline,"")+`
`;return r?'<pre><code class="language-'+vr(r)+'">'+(s?i:vr(i,!0))+`</code></pre>
`:"<pre><code>"+(s?i:vr(i,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:n}){return`<h${n}>${this.parser.parseInline(t)}</h${n}>
`}hr(t){return`<hr>
`}list(t){const n=t.ordered,s=t.start;let r="";for(let c=0;c<t.items.length;c++){const d=t.items[c];r+=this.listitem(d)}const i=n?"ol":"ul",o=n&&s!==1?' start="'+s+'"':"";return"<"+i+o+`>
`+r+"</"+i+`>
`}listitem(t){var s;let n="";if(t.task){const r=this.checkbox({checked:!!t.checked});t.loose?((s=t.tokens[0])==null?void 0:s.type)==="paragraph"?(t.tokens[0].text=r+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=r+" "+vr(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):n+=r+" "}return n+=this.parser.parse(t.tokens,!!t.loose),`<li>${n}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let n="",s="";for(let i=0;i<t.header.length;i++)s+=this.tablecell(t.header[i]);n+=this.tablerow({text:s});let r="";for(let i=0;i<t.rows.length;i++){const o=t.rows[i];s="";for(let c=0;c<o.length;c++)s+=this.tablecell(o[c]);r+=this.tablerow({text:s})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+n+`</thead>
`+r+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){const n=this.parser.parseInline(t.tokens),s=t.header?"th":"td";return(t.align?`<${s} align="${t.align}">`:`<${s}>`)+n+`</${s}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${vr(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:n,tokens:s}){const r=this.parser.parseInline(s),i=Pg(t);if(i===null)return r;t=i;let o='<a href="'+t+'"';return n&&(o+=' title="'+vr(n)+'"'),o+=">"+r+"</a>",o}image({href:t,title:n,text:s,tokens:r}){r&&(s=this.parser.parseInline(r,this.parser.textRenderer));const i=Pg(t);if(i===null)return vr(s);t=i;let o=`<img src="${t}" alt="${s}"`;return n&&(o+=` title="${vr(n)}"`),o+=">",o}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:vr(t.text)}},Qf=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},sa=class Zm{constructor(n){Nt(this,"options");Nt(this,"renderer");Nt(this,"textRenderer");this.options=n||ui,this.options.renderer=this.options.renderer||new Zc,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Qf}static parse(n,s){return new Zm(s).parse(n)}static parseInline(n,s){return new Zm(s).parseInline(n)}parse(n,s=!0){var i,o;let r="";for(let c=0;c<n.length;c++){const d=n[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){const m=d,p=this.options.extensions.renderers[m.type].call({parser:this},m);if(p!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(m.type)){r+=p||"";continue}}const u=d;switch(u.type){case"space":{r+=this.renderer.space(u);continue}case"hr":{r+=this.renderer.hr(u);continue}case"heading":{r+=this.renderer.heading(u);continue}case"code":{r+=this.renderer.code(u);continue}case"table":{r+=this.renderer.table(u);continue}case"blockquote":{r+=this.renderer.blockquote(u);continue}case"list":{r+=this.renderer.list(u);continue}case"html":{r+=this.renderer.html(u);continue}case"paragraph":{r+=this.renderer.paragraph(u);continue}case"text":{let m=u,p=this.renderer.text(m);for(;c+1<n.length&&n[c+1].type==="text";)m=n[++c],p+=`
`+this.renderer.text(m);s?r+=this.renderer.paragraph({type:"paragraph",raw:p,text:p,tokens:[{type:"text",raw:p,text:p,escaped:!0}]}):r+=p;continue}default:{const m='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(m),"";throw new Error(m)}}}return r}parseInline(n,s=this.renderer){var i,o;let r="";for(let c=0;c<n.length;c++){const d=n[c];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[d.type]){const m=this.options.extensions.renderers[d.type].call({parser:this},d);if(m!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(d.type)){r+=m||"";continue}}const u=d;switch(u.type){case"escape":{r+=s.text(u);break}case"html":{r+=s.html(u);break}case"link":{r+=s.link(u);break}case"image":{r+=s.image(u);break}case"strong":{r+=s.strong(u);break}case"em":{r+=s.em(u);break}case"codespan":{r+=s.codespan(u);break}case"br":{r+=s.br(u);break}case"del":{r+=s.del(u);break}case"text":{r+=s.text(u);break}default:{const m='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(m),"";throw new Error(m)}}}return r}},Sm,Lc=(Sm=class{constructor(t){Nt(this,"options");Nt(this,"block");this.options=t||ui}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?ta.lex:ta.lexInline}provideParser(){return this.block?sa.parse:sa.parseInline}},Nt(Sm,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Sm),ZM=class{constructor(...t){Nt(this,"defaults",Vf());Nt(this,"options",this.setOptions);Nt(this,"parse",this.parseMarkdown(!0));Nt(this,"parseInline",this.parseMarkdown(!1));Nt(this,"Parser",sa);Nt(this,"Renderer",Zc);Nt(this,"TextRenderer",Qf);Nt(this,"Lexer",ta);Nt(this,"Tokenizer",Xc);Nt(this,"Hooks",Lc);this.use(...t)}walkTokens(t,n){var r,i;let s=[];for(const o of t)switch(s=s.concat(n.call(this,o)),o.type){case"table":{const c=o;for(const d of c.header)s=s.concat(this.walkTokens(d.tokens,n));for(const d of c.rows)for(const u of d)s=s.concat(this.walkTokens(u.tokens,n));break}case"list":{const c=o;s=s.concat(this.walkTokens(c.items,n));break}default:{const c=o;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{const u=c[d].flat(1/0);s=s.concat(this.walkTokens(u,n))}):c.tokens&&(s=s.concat(this.walkTokens(c.tokens,n)))}}return s}use(...t){const n=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(s=>{const r={...s};if(r.async=this.defaults.async||r.async||!1,s.extensions&&(s.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const o=n.renderers[i.name];o?n.renderers[i.name]=function(...c){let d=i.renderer.apply(this,c);return d===!1&&(d=o.apply(this,c)),d}:n.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=n[i.level];o?o.unshift(i.tokenizer):n[i.level]=[i.tokenizer],i.start&&(i.level==="block"?n.startBlock?n.startBlock.push(i.start):n.startBlock=[i.start]:i.level==="inline"&&(n.startInline?n.startInline.push(i.start):n.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(n.childTokens[i.name]=i.childTokens)}),r.extensions=n),s.renderer){const i=this.defaults.renderer||new Zc(this.defaults);for(const o in s.renderer){if(!(o in i))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;const c=o,d=s.renderer[c],u=i[c];i[c]=(...m)=>{let p=d.apply(i,m);return p===!1&&(p=u.apply(i,m)),p||""}}r.renderer=i}if(s.tokenizer){const i=this.defaults.tokenizer||new Xc(this.defaults);for(const o in s.tokenizer){if(!(o in i))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const c=o,d=s.tokenizer[c],u=i[c];i[c]=(...m)=>{let p=d.apply(i,m);return p===!1&&(p=u.apply(i,m)),p}}r.tokenizer=i}if(s.hooks){const i=this.defaults.hooks||new Lc;for(const o in s.hooks){if(!(o in i))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;const c=o,d=s.hooks[c],u=i[c];Lc.passThroughHooks.has(o)?i[c]=m=>{if(this.defaults.async)return Promise.resolve(d.call(i,m)).then(x=>u.call(i,x));const p=d.call(i,m);return u.call(i,p)}:i[c]=(...m)=>{let p=d.apply(i,m);return p===!1&&(p=u.apply(i,m)),p}}r.hooks=i}if(s.walkTokens){const i=this.defaults.walkTokens,o=s.walkTokens;r.walkTokens=function(c){let d=[];return d.push(o.call(this,c)),i&&(d=d.concat(i.call(this,c))),d}}this.defaults={...this.defaults,...r}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,n){return ta.lex(t,n??this.defaults)}parser(t,n){return sa.parse(t,n??this.defaults)}parseMarkdown(t){return(s,r)=>{const i={...r},o={...this.defaults,...i},c=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&i.async===!1)return c(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof s>"u"||s===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof s!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=t);const d=o.hooks?o.hooks.provideLexer():t?ta.lex:ta.lexInline,u=o.hooks?o.hooks.provideParser():t?sa.parse:sa.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(s):s).then(m=>d(m,o)).then(m=>o.hooks?o.hooks.processAllTokens(m):m).then(m=>o.walkTokens?Promise.all(this.walkTokens(m,o.walkTokens)).then(()=>m):m).then(m=>u(m,o)).then(m=>o.hooks?o.hooks.postprocess(m):m).catch(c);try{o.hooks&&(s=o.hooks.preprocess(s));let m=d(s,o);o.hooks&&(m=o.hooks.processAllTokens(m)),o.walkTokens&&this.walkTokens(m,o.walkTokens);let p=u(m,o);return o.hooks&&(p=o.hooks.postprocess(p)),p}catch(m){return c(m)}}}onError(t,n){return s=>{if(s.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const r="<p>An error occurred:</p><pre>"+vr(s.message+"",!0)+"</pre>";return n?Promise.resolve(r):r}if(n)return Promise.reject(s);throw s}}},li=new ZM;function mt(t,n){return li.parse(t,n)}mt.options=mt.setOptions=function(t){return li.setOptions(t),mt.defaults=li.defaults,Mb(mt.defaults),mt};mt.getDefaults=Vf;mt.defaults=ui;mt.use=function(...t){return li.use(...t),mt.defaults=li.defaults,Mb(mt.defaults),mt};mt.walkTokens=function(t,n){return li.walkTokens(t,n)};mt.parseInline=li.parseInline;mt.Parser=sa;mt.parser=sa.parse;mt.Renderer=Zc;mt.TextRenderer=Qf;mt.Lexer=ta;mt.lexer=ta.lex;mt.Tokenizer=Xc;mt.Hooks=Lc;mt.parse=mt;mt.options;mt.setOptions;mt.use;mt.walkTokens;mt.parseInline;sa.parse;ta.lex;const ki="Puedes usar etiquetas HTML básicas como <b>, <i> o <br> para dar formato a la respuesta.",QM={task:{model:"gemini-2.5-flash",prompt:`Asistente Inteligente de Productividad y Gestión de Estado de Ánimo
Eres un experto en productividad personal que entiende cómo el estado emocional afecta el rendimiento y la motivación para completar tareas.

Contexto
Soy Alexander, ingeniero de sistemas, y necesito ayuda para elegir qué tareas abordar basándome en mi estado de ánimo actual y mis tareas pendientes.

Tu función principal:
Analizar la correlación entre mi estado emocional actual y mis tareas pendientes para sugerir la secuencia óptima de trabajo que maximice mi productividad y bienestar.

Instrucciones:
1. Evalúa mi estado de ánimo actual y su impacto en diferentes tipos de tareas
2. Considera factores como:
   • Nivel de energía mental requerido para cada tarea
   • Complejidad técnica vs emocional
   • Urgencia e importancia
   • Potencial de la tarea para mejorar o empeorar mi estado de ánimo
   • Mi perfil profesional como ingeniero de sistemas
3. Prioriza tareas que:
   • Sean apropiadas para mi estado emocional actual
   • Puedan generar momentum positivo
   • Balanceen productividad con bienestar mental

Formato de respuesta:
🎯 **Análisis de tu estado actual:**
[Muy breve evaluación del estado de ánimo y su impacto en la productividad]

📋 **Secuencia recomendada:**
1. 🟢 [Tarea] - [Razón muy breve específica basada en tu estado]
2. 🟡 [Tarea] - [Razón muy breve específica basada en tu estado]
3. 🔴 [Tarea] - [Razón muy breve específica basada en tu estado]

💡 **Estrategia adicional:**
[Consejo muy breve específico para mantener la motivación y productividad]

Usa colores: 🟢 (ideal ahora), 🟡 (después de ganar momentum), 🔴 (cuando tengas más energía).
`+ki,prompts:{breakdown:`Asistente para Desglosar Tareas y Combatir la Procrastinación
Eres un experto en productividad y gestión del tiempo. Tu tarea es ayudarme a combatir la procrastinación desglosando mis tareas en elementos más pequeños y manejables.

Contexto
Soy Alexander, ingeniero de sistemas, y necesito ayuda para estructurar mis tareas de manera efectiva para evitar la procrastinación.

Instrucciones:
Realiza las siguientes acciones:
   • Analiza la tarea principal y desglósala en máximo 5 subtareas específicas
   • Si te doy pasos iniciales, respeta hasta donde más se pueda su redacción (verifica si son completos, si hay pasos faltantes antes, durante o después)
   • Verifica la coherencia lógica entre los pasos y ordénalos de forma secuencial
   • Considera mi profesión y nivel de experiencia al estimar el tiempo para cada subtarea
   • Usa emojis relevantes al inicio de cada subtarea para hacerlas más atractivas

Formato de respuesta:
- [ ] [Emoji] [Descripción clara de la subtarea] (X min)
- [ ] [Emoji] [Descripción clara de la subtarea] (X min)
- [ ] [Emoji] [Descripción clara de la subtarea] (X min)
⏱️ Total de tiempo estimado: [X] minutos

...

Reglas importantes:
• NO incluyas explicaciones tuyas, solo las subtareas y sus tiempos
• Cada subtarea debe estar en una sola línea con emoji, descripción y tiempo
• Mantén las respuestas breves y claras, evitando explicaciones innecesarias
• Las estimaciones de tiempo deben ser realistas basadas en mi perfil profesional`,improveDescription:`Eres un asistente experto en redacción de tareas. Basándote en el título y la descripción actual, mejora el texto sin cambiar su intención. Si la descripción está vacía, genera una de máximo 100 palabras que defina claramente el objetivo de la tarea.Reglas importantes:
• NO incluyas explicaciones tuyas, solo la descripción solicitada
• Mantén las respuestas breves y claras, evitando explicaciones innecesarias
`,ideas:"Sugiere ideas o ejemplos concretos para abordar la tarea. Entrega consejos breves, prácticos ayuden a iniciarla o completarla.Las ideas deben ser breves (máximo 50 palabras cada una) y enfocadas en superar la inercia inicial o desbloquear el progreso.\\n\\n### **{FORMATO DE RESPUESTA}**\\nEntrega las ideas como una lista simple, sin explicaciones adicionales. No excedas las 150 palabras en total.\\nEjemplo:\\n- Idea 1: [Descripción breve y accionable]\\n- Idea 2: [Descripción breve y accionable]\\n",reprioritize:'Eres un sistema experto en priorización de tareas diseñado para ser ESTRICTO y evitar que todo parezca prioritario.\\n\\n### **{PERFIL DE USUARIO}**\\nAlexander: ingeniero de sistemas, 31 años, trabaja desde casa, busca optimizar productividad y bienestar.\\n\\n### **{CRITERIOS ESTRICTOS DE PRIORIZACIÓN}**\\n**URGENTE = `true` SOLO SI:**\\n- Tiene fecha límite en las próximas 24-48 horas\\n- Su retraso causa consecuencias inmediatas graves\\n- Bloquea el trabajo de otras personas\\n- Es requerido para funciones críticas del día\\n**⚠️ MÁXIMO 20-30% de tareas pueden ser urgentes**\\n\\n**IMPORTANTE = `true` SOLO SI:**\\n- Contribuye directamente a objetivos principales (salud, productividad, ingresos)\\n- Su no realización afecta metas a largo plazo\\n- Es fundamental para el crecimiento profesional/personal\\n**⚠️ MÁXIMO 40-50% de tareas pueden ser importantes**\\n\\n### **{DISTRIBUCIÓN OBJETIVO}**\\n- **Urgente + Importante**: 10-15% (hacer YA)\\n- **Importante (no urgente)**: 25-35% (planificar)\\n- **Urgente (no importante)**: 10-15% (delegar/minimizar)\\n- **Ni urgente ni importante**: 35-55% (eliminar/posponer)\\n\\n### **{INSTRUCCIONES}**\\n1. **urgent**: `true` solo si cumple criterios estrictos de urgencia\\n2. **important**: `true` solo si impacta objetivos clave de Alexander\\n3. **size**: "pequeña" (<1h), "mediana" (1-3h), "grande" (>3h)\\n4. **estimatedTime**: Minutos realistas considerando el perfil técnico\\n\\n**REGLA CRÍTICA**: Si más del 50% resultan urgent/important, REVISA y sé más estricto.\\n\\n### **{FORMATO DE RESPUESTA OBLIGATORIO}**\\nDevuelve únicamente un JSON con un array de objetos {"id":"1","urgent":false,"important":true,"size":"mediana","estimatedTime":90}'}},journal:{model:"gemini-2.5-flash",prompt:`### **{ROL}**
Eres un experto en redacción y comunicación clara. Tu especialidad es mejorar textos manteniendo su esencia.

### **{CONTEXTO}**
Recibirás entradas de diario que necesitan una mejor redacción para ser más entendibles. Estos mensajes pueden contener ideas mezcladas, estructuras confusas o lenguaje poco claro.

### **{RESULTADO ESPERADO}**
Necesito que mejores la redacción de las entradas de diario que te envío, para que sean:
- Más directas y naturales
- Con términos coloquiales en lugar de formalismos
- Fáciles de entender

Lo más importante: tu **ÚNICA** labor es mejorar cómo está escrito el mensaje. **NO** debes:
- Cambiar el sentido o significado del texto original
- Añadir información nueva o inventar contexto
- Responder al contenido del mensaje
- Interpretarlo o dar opiniones sobre él
- Reaccionar al mensaje de ninguna forma
- Aunque el mensaje inicie con la palabra "Necesito", no debes actuar, solo mejorar la redacción tal cual como se te pide.

### **{FORMATO_SOLICITADO}**
Entrega únicamente el texto mejorado, sin explicaciones adicionales ni comentarios.

### **{RESTRICCIONES O CONDICIONES}**
- Mantén todos los detalles importantes del mensaje original
- Si el mensaje contiene términos técnicos, mantenlos
- Simplifica cuando sea posible, pero sin perder información relevante
- No añadas saludos ni despedidas si no estaban en el mensaje original

### **{CONSEJOS}**
Los siguientes consejos pueden ser útiles para tu tarea (no es obligatorio seguirlos todos):
- Palabras simples: Escribe como si hablaras con un amigo, evita vocabulario complejo
- Frases cortas: Divide ideas complejas en partes fáciles de entender
- Sin frases de IA: Nunca uses "profundicemos," "libera tu potencial," "solución revolucionaria," "enfoque transformador," "aprovecha esta estrategia," "optimiza tu flujo de trabajo," etc.
- Sé directo: Di lo que quieres decir sin rodeos
- Flujo natural: Está bien empezar frases con "y," "pero" o "entonces"
- Voz real: No fuerces simpatía ni emoción falsa
- Gramática conversacional: Estructuras simples, no escritura académica
- Corta lo innecesario: Elimina adjetivos y adverbios que no aportan
- Usa ejemplos: Explica con casos concretos en lugar de ideas abstractas
- Sé honesto: Reconoce límites, no exageres ni vendas humo
- Escribe como si chatearas: Casual, directo, como hablas en la vida real
- Transiciones naturales: Usa conectores simples como "la cosa es," "y," "pero"

Antes de terminar, asegúrate de que el texto:
- Suena como algo que dirías en voz alta
- Usa palabras que usaría una persona normal
- No suena a texto publicitario
- Se siente auténtico y honesto
- Va al grano rápido

### **{ESTILO}**
El estilo de escritura debe parecer hablado, como si lo estuviera contando en voz alta. Uso palabras comunes, no me complico con adornos o tecnicismos. Prefiero frases naturales, incluso si son largas, pero que fluyan como un pensamiento. No me gusta sonar falso ni muy estructurado. A veces repito conectores como "pues", "entonces" o "como que" y palabras como "básicamente" porque así hablo yo. Cuando explico algo, voy directo al punto, pero sin sonar cortante. Si escribo sobre algo emocional, no filtro mucho: lo digo tal cual lo sentí. Quiero que suene auténtico, claro y sin vueltas raras.

### {PALABRAS QUE NO USO}
A continuación, te doy algunas palabras que no uso. Te encuentro como escribiría un colombiano para que no vayas a usar términos españoles o mexicanos, por ejemplo: bronca, chamba, chido, buena onda,
### {PALABRAS QUE SI USO}
Sin exagerar su uso digo palabras como: ratito, pues, entonces, como que, básicamente, osea, creo, obviamente, etc. No me gusta sonar muy formal o técnico, prefiero un tono más relajado y cercano.Pero si las repito excesivamente puedes cambiarlo para que el texto no quede lleno de muletillas


{MENSAJE-ORIGINAL}

`},meal:{model:"gemini-2.5-flash",prompts:{meal:`## {ROL}
Asume el rol de un **experto nutricionista especializado en composición corporal y chef profesional** con amplia experiencia en:
- Reducción de grasa visceral y mejora de la composición corporal
- Planificación de menús balanceados para personas con condiciones médicas específicas
- Optimización nutricional para trabajo sedentario y niveles de energía constante
- Creación de planes alimentarios personalizados que maximizan el uso de ingredientes disponibles

## {CONTEXTO PERSONAL DETALLADO}
**Perfil del Usuario: Alexander**
- **Edad**: 31 años
- **Peso actual**: 84.70 kg
- **IMC**: 26.7 (sobrepeso leve)
- **Condición médica**: Un riñón y medio (post-cirugía infantil)
- **Actividad física**: Moderada, algunas veces por semana
- **Estilo de vida**: Trabajo sedentario desde casa
- **Objetivos prioritarios**:
  4. Energía constante durante jornada laboral sedentaria
  5. Pérdida de peso gradual y sostenible

## {INSTRUCCIONES}
Genera una comida usando ÚNICAMENTE los ingredientes proporcionados
- Sea meal prep friendly cuando posible

- **name**: Incluir bebidas recomendadas
- **notes**: Max 50 palabras; Beneficios anti-grasa visceral, hidratación, tiempo prep, almacenamiento
- **recipe**: Max 50 palabras; Método saludable, tips sabor, opciones meal prep`,day:`## {ROL}
Asume el rol de un **experto nutricionista especializado en composición corporal y chef profesional** con amplia experiencia en:
- Reducción de grasa visceral y mejora de la composición corporal
- Planificación de menús balanceados para personas con condiciones médicas específicas
- Optimización nutricional para trabajo sedentario y niveles de energía constante
- Creación de planes alimentarios personalizados que maximizan el uso de ingredientes disponibles

## {CONTEXTO PERSONAL DETALLADO}
**Perfil del Usuario: Alexander**
- **Edad**: 31 años, **Peso**: 84.70 kg, **IMC**: 26.7
- **CRÍTICO**: Grasa visceral nivel 11 (Alta)
- **CRÍTICO**: Hidratación 50.6% (insuficiente)
- **Condición médica**: Un riñón y medio
- **Estilo de vida**: Trabajo sedentario desde casa
## {DISTRIBUCIÓN DIARIA}
**5 comidas específicas:**
1. **Desayuno** - Energético sin picos de azúcar, pero saciante
2. **Snack mañana** - Ligero, hidratante
3. **Almuerzo** - Comida principal, anti-inflamatoria
4. **Snack tarde** - Saciante
5. **Cena** - Ligera, recuperación nocturna

### Practicidad (ESENCIAL):
- **Recetas populares y probadas** disponibles en internet (siempre busca en internet para cumplir la tarea)
- **Preparaciones fáciles**
- **Meal prep friendly**: que se puedan preparar en lotes
- **Sabores atractivos**: especias, hierbas, combinaciones apetitosas
## {INSTRUCCIONES FINALES}
Genera plan completo usando ÚNICAMENTE ingredientes:
- **Recetas conocidas por ser sabrosas**
Formato JSON con llaves: breakfast, morningSnack, lunch, afternoonSnack, dinner
Cada comida: {"name":"","notes":"","recipe":""}
- **name**: Incluir bebidas recomendadas
- **notes**: Beneficios anti-grasa visceral, hidratación, tiempo prep, almacenamiento
- **recipe**: Método saludable, tips sabor, opciones meal prep`}},mood:{model:"gemini-2.5-flash",prompt:`### **{ROL}**
Eres un psicólogo especializado en análisis emocional y bienestar mental con experiencia en:
- Interpretación de patrones emocionales a partir de texto escrito
- Identificación de estados de ánimo complejos y matices emocionales
- Correlación entre eventos diarios y respuestas emocionales
- Análisis del lenguaje emocional en entradas de diario personal

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Personalidad analítica y reflexiva
- Busca mejorar su bienestar físico y emocional
- Tiende a procesar las emociones de forma racional
- Usa el diario como herramienta de autoconocimiento

### **{RESULTADO ESPERADO}**
Analiza la entrada del diario y sugiere estados de ánimo específicos que:
- Reflejen con precisión las emociones expresadas en el texto
- Capturen matices emocionales (no solo estados básicos)
- Consideren el contexto y las circunstancias mencionadas
- Sean relevantes para el momento específico del día
- Ayuden al usuario a entender mejor sus patrones emocionales

### **{INSTRUCCIONES ESPECÍFICAS}**
1. **Lee cuidadosamente** la entrada del diario completa
2. **Identifica emociones explícitas** (lo que dice directamente)
3. **Detecta emociones implícitas** (lo que se puede inferir del tono, contexto)
4. **Considera la progresión temporal** si menciona eventos a lo largo del día
5. **Usa ÚNICAMENTE** los estados de ánimo de la lista proporcionada
6. **Asigna horarios lógicos** basándote en:
   - Eventos mencionados (trabajo, comidas, ejercicio)
   - Momento probable del día para cada emoción
   - Secuencia cronológica natural
7. **Proporciona razones específicas** que conecten el texto con el estado de ánimo

### **{CRITERIOS DE CALIDAD}**
- **Precisión emocional**: El estado de ánimo debe coincidir con lo expresado
- **Contexto relevante**: La razón debe citar elementos específicos del texto
- **Horarios realistas**: Que tengan sentido con las actividades mencionadas
- **Diversidad emocional**: Capturar diferentes matices si existen
- **Granularidad apropiada**: Ni muy genérico ni demasiado específico

### **{RESTRICCIONES CRÍTICAS}**
- **SOLO** usar estados de ánimo de la lista proporcionada
- **NO** inventar emociones que no estén en la lista
- **NO** asumir contexto no mencionado en el texto
- **NO** agregar interpretaciones psicológicas profundas
- **NO** incluir consejos o recomendaciones

### **{FORMATO REQUERIDO}**
Devuelve el resultado ÚNICAMENTE en formato JSON válido:
[{"emoji":"🌟","text":"optimista","time":"09:30","reason":"Menciona sentirse motivado para empezar el día con energía"}]

- **emoji**: El emoji asociado al estado de ánimo de la lista
- **text**: El nombre exacto del estado de ánimo de la lista
- **time**: Hora en formato HH:mm (24 horas)
- **reason**: Explicación breve y específica basada en el texto del diario

### **{ESTILO DE ANÁLISIS}**
Analiza de forma natural y humana, como si fueras un psicólogo empático que entiende los matices emocionales. No te quedes solo en lo obvio: busca las emociones que están entre líneas, pero siempre respaldándote en lo que realmente dice el texto. Si hay emociones mixtas o que cambian durante el día, refléjalo con múltiples entradas en horarios diferentes.`},habit:{model:"gemini-2.5-flash",prompts:{predict:`### **{ROL}**
Eres un especialista en ciencias del comportamiento y formación de hábitos con experiencia en:
- Análisis de patrones de comportamiento a partir de datos históricos
- Identificación de factores que influyen en el éxito o fallo de hábitos
- Psicología de la motivación y adherencia a rutinas
- Estrategias prácticas para mejorar la consistencia en hábitos

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Personalidad analítica que aprecia datos y patrones
- Busca optimizar su rutina diaria y bienestar
- Tiende a ser autoexigente con sus metas
- Valora la eficiencia y estrategias basadas en evidencia

### **{RESULTADO ESPERADO}**
Analiza el historial de hábitos y proporciona:
1. **Identificación de hábitos en riesgo** - Cuáles tienden a fallarse
2. **Análisis de patrones** - Por qué fallan (días, circunstancias, factores)
3. **Predicciones precisas** - Probabilidad de fallo futuro
4. **Consejos actionables** - Estrategias específicas y prácticas

### **{INSTRUCCIONES DE ANÁLISIS}**
1. **Examina los datos históricos**:
   - Frecuencia de éxitos vs fallos por hábito
   - Patrones temporales (días de la semana, fechas específicas)
   - Rachas de éxito y periodos de fallo
   - Tendencias recientes vs históricas

2. **Identifica factores de riesgo**:
   - Hábitos con tasa de fallo >30%
   - Patrones estacionales o cíclicos
   - Correlaciones entre fallos de diferentes hábitos
   - Momentos críticos de abandono

3. **Proporciona consejos específicos**:
   - Basados en el perfil de Alexander (trabajo desde casa, analítico)
   - Estrategias probadas científicamente
   - Ajustes prácticos e implementables
   - Enfoque en sistemas, no solo motivación

### **{FORMATO DE RESPUESTA}**
Estructura tu análisis así:

🔍 **Análisis de Patrones**
[Resumen de los patrones más importantes encontrados]

⚠️ **Hábitos en Riesgo**
• **[Nombre del hábito]** - [% de fallo] - [Patrón identificado]
• **[Nombre del hábito]** - [% de fallo] - [Patrón identificado]

💡 **Estrategias Específicas**
**Para [Hábito X]:**
- [Consejo específico y actionable]
- [Ajuste práctico basado en el patrón]

**Para [Hábito Y]:**
- [Consejo específico y actionable]
- [Ajuste práctico basado en el patrón]

🎯 **Recomendación Principal**
[Consejo principal para mejorar la adherencia general]

### **{ESTILO DE COMUNICACIÓN}**
Habla de forma directa y práctica, como un coach experto que entiende los retos reales. Usa datos concretos cuando los tengas, pero explica de manera simple. No uses frases motivacionales vacías: enfócate en estrategias actionables que Alexander pueda implementar mañana mismo. Reconoce los éxitos antes de señalar áreas de mejora.`+ki,suggest:`### **{ROL}**
Eres un especialista en desarrollo personal y optimización de rutinas con experiencia en:
- Diseño de sistemas de hábitos personalizados
- Integración de hábitos con metas de salud y productividad
- Análisis holístico de estilo de vida para identificar oportunidades
- Creación de rutinas sostenibles para profesionales del conocimiento

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Objetivos de salud: reducir grasa visceral, mejorar hidratación
- Busca optimizar productividad y bienestar
- Personalidad analítica, aprecia sistemas eficientes
- Valora hábitos que se integren naturalmente a su rutina

### **{RESULTADO ESPERADO}**
Basándote en las metas y actividades de otros módulos, sugiere nuevos hábitos que:
- **Se alineen** con objetivos específicos de salud y productividad
- **Se integren** naturalmente con rutinas existentes
- **Sean sostenibles** para un estilo de vida sedentario
- **Generen impacto** medible en bienestar y rendimiento

### **{CRITERIOS DE SUGERENCIAS}**
1. **Relevancia**: Conectados directamente con metas existentes
2. **Viabilidad**: Realistas para trabajo desde casa
3. **Especificidad**: Claros, medibles y accionables
4. **Progresividad**: Que se puedan implementar gradualmente
5. **Sinergia**: Que potencien otros hábitos o actividades

### **{CATEGORÍAS DE HÁBITOS}**
Considera estas áreas prioritarias:

**🏃‍♂️ Salud Física**
- Hábitos anti-grasa visceral
- Hidratación y nutrición
- Movimiento durante trabajo sedentario
- Calidad del sueño

**🧠 Productividad**
- Técnicas de enfoque y concentración
- Gestión de energía mental
- Rutinas de inicio y cierre de jornada
- Descansos activos

**😌 Bienestar Mental**
- Manejo del estrés
- Mindfulness y reflexión
- Conexión social
- Desarrollo personal

### **{FORMATO DE SUGERENCIAS}**
Presenta cada hábito así:

## 🎯 **Hábitos Sugeridos**

### **[Categoría] - [Nombre del Hábito]**
**🎯 Objetivo:** [A qué meta específica contribuye]
**⏰ Frecuencia:** [Cuándo y qué tan seguido]
**📋 Acción específica:** [Qué hacer exactamente]
**🔗 Integración:** [Cómo conecta con rutina actual]
**📊 Métrica:** [Cómo medir el progreso]
**💡 Por qué funciona:** [Razón científica o práctica]

### **{INSTRUCCIONES ESPECÍFICAS}**
- **Analiza primero** las actividades y metas de otros módulos
- **Prioriza 3-5 hábitos** máximo (no abrumar)
- **Enfócate en gaps** que no estén cubiertos actualmente
- **Considera el timing** - cuándo encajan mejor en el día
- **Incluye micro-hábitos** que se puedan stackear con rutinas existentes

### **{ESTILO DE COMUNICACIÓN}**
Explica de forma práctica y directa, como un consultor que entiende las limitaciones reales del trabajo desde casa. Justifica cada sugerencia con el beneficio específico que tendrá. No propongas hábitos genéricos: personalízalos para el contexto de Alexander. Enfócate en la implementación práctica, no solo en los beneficios.`+ki}},negativeHabit:{model:"gemini-2.5-flash",prompts:{impact:`### **{ROL}**
Eres un psicólogo especializado en modificación de conducta y análisis de patrones comportamentales con experiencia en:
- Identificación de patrones en hábitos destructivos
- Análisis del impacto de comportamientos negativos en bienestar general
- Correlación entre hábitos negativos y factores desencadenantes
- Evaluación de riesgos para la salud física y mental

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Objetivos de salud: reducir grasa visceral (nivel 11), mejorar hidratación
- Personalidad analítica, responde bien a datos concretos
- Busca optimizar su bienestar y productividad
- Tiende a ser autoexigente y reflexivo sobre sus comportamientos

### **{RESULTADO ESPERADO}**
Analiza el historial de hábitos negativos y proporciona:
1. **Impacto específico** de cada hábito en su salud y metas
2. **Patrones temporales** y factores desencadenantes
3. **Correlaciones** entre diferentes hábitos negativos
4. **Evaluación de riesgo** para objetivos de salud específicos
5. **Insights actionables** para la toma de conciencia

### **{INSTRUCCIONES DE ANÁLISIS}**
1. **Examina la frecuencia y patrones**:
   - Días de la semana con mayor incidencia
   - Horarios más comunes para cada hábito
   - Rachas o clusters de comportamientos
   - Tendencias temporales (mejorando, empeorando, estable)

2. **Identifica correlaciones**:
   - Hábitos que tienden a ocurrir juntos
   - Efectos dominó entre comportamientos
   - Relación con estados emocionales o situaciones

3. **Evalúa impacto específico**:
   - Efecto directo en grasa visceral y hidratación
   - Impacto en productividad y energía
   - Consecuencias para trabajo sedentario
   - Interferencia con hábitos positivos

### **{FORMATO DE ANÁLISIS}**
Estructura tu respuesta así:

📊 **Resumen de Patrones**
[Visión general de los patrones más significativos]

⚠️ **Impacto por Hábito**
**[Nombre del hábito]** - [Frecuencia]
• **Impacto directo:** [Cómo afecta objetivos específicos]
• **Patrón detectado:** [Cuándo/por qué ocurre]
• **Riesgo:** [Nivel de prioridad para abordar]

🔗 **Correlaciones Críticas**
• [Hábito A] + [Hábito B]: [Relación y impacto combinado]
• [Trigger común]: [Situaciones que desencadenan múltiples hábitos]

🎯 **Prioridades de Intervención**
1. **[Hábito más crítico]** - [Razón por la cual es prioritario]
2. **[Segundo hábito]** - [Razón por la cual es importante]

### **{ESTILO DE COMUNICACIÓN}**
Sé directo pero empático. Como Alexander es analítico, usa datos específicos y evita sermones. Enfócate en el impacto real y medible, no en juicios morales. Reconoce que entender los patrones es el primer paso para cambiarlos.`+ki,action:`### **{ROL}**
Eres un especialista en intervención conductual inmediata con experiencia en:
- Estrategias de interrupción de patrones de hábitos negativos
- Técnicas de reemplazo de comportamientos en tiempo real
- Motivación y redirección de impulsos destructivos
- Creación de alternativas saludables e inmediatamente disponibles

### **{CONTEXTO PERSONAL}**
**Perfil del Usuario: Alexander**
- Ingeniero de sistemas de 31 años
- Trabajo sedentario desde casa
- Objetivos críticos: reducir grasa visceral, mejorar hidratación
- Personalidad analítica, responde a lógica y sistemas
- Ambiente de trabajo desde casa (acceso limitado a ciertas alternativas)
- Valora eficiencia y estrategias que funcionen inmediatamente

### **{RESULTADO ESPERADO}**
Cuando Alexander registre un hábito negativo, proporciona:
1. **Alternativas inmediatas** que pueda hacer en ese momento
2. **Estrategias de redirección** específicas para su entorno
3. **Acciones de "damage control"** para minimizar el impacto
4. **Técnicas de prevención** para la próxima vez
5. **Recordatorios motivacionales** conectados con sus metas específicas

### **{ESTRATEGIAS POR CONTEXTO}**
**🏠 Trabajo desde Casa:**
- Alternativas que no requieran salir
- Uso de elementos disponibles en casa
- Técnicas que funcionen durante breaks laborales
- Actividades que mejoren energía para el trabajo

**🎯 Anti-Grasa Visceral:**
- Actividades que aceleren metabolismo
- Comportamientos que reduzcan cortisol
- Alternativas que promuevan hidratación
- Acciones que no saboteena nutrición

**⚡ Disponibilidad Inmediata:**
- Acciones de 2-5 minutos máximo
- Sin preparación especial requerida
- Que funcionen en cualquier momento del día
- Compatibles con horario de trabajo

### **{FORMATO DE RESPUESTA}**
Estructura tu intervención así:

🛑 **Alternativa Inmediata**
[Acción específica que puede hacer AHORA mismo en lugar del hábito negativo]

💡 **Redirección Inteligente**
[Estrategia para canalizar el impulso hacia algo productivo]

🔧 **Damage Control**
[Qué hacer para minimizar el impacto si ya ocurrió el hábito]

🎯 **Conexión con Metas**
[Recordatorio específico de cómo evitar este hábito lo acerca a sus objetivos]

🛡️ **Prevención Futura**
[Estrategia específica basada en su patrón histórico para evitar repetición]

### **{CRITERIOS DE CALIDAD}**
- **Inmediatez**: Ejecutable en <5 minutos
- **Disponibilidad**: Sin recursos especiales
- **Especificidad**: Adaptado al hábito específico registrado
- **Realismo**: Factible en su entorno de trabajo desde casa
- **Impacto**: Que contribuya positivamente a sus metas de salud

### **{CONSIDERACIONES ESPECIALES}**
Considera las tendencias previas del usuario para:
- Personalizar alternativas basadas en patrones históricos
- Sugerir estrategias que han funcionado antes
- Evitar recomendaciones que ya ha intentado sin éxito
- Adaptar el nivel de intensidad de la intervención

### **{ESTILO DE COMUNICACIÓN}**
Sé empático pero orientado a la acción. No juzgues el comportamiento, enfócate en la solución inmediata. Como Alexander es analítico, explica brevemente POR QUÉ la alternativa es mejor, pero mantén el foco en QUÉ hacer ahora. Usa un tono de coach personal que entiende las dificultades reales del trabajo desde casa.`+ki}},statistics:{model:"gemini-2.5-flash",prompt:"Eres un coach personal experto en análisis de comportamiento y bienestar, con conocimientos en Terapia Cognitivo-Conductual (TCC) y Terapia de Aceptación y Compromiso (ACT). Analiza el siguiente resumen de actividad diaria. \\nTu objetivo es: \\n1. Identificar patrones de comportamiento significativos (positivos y negativos). \\n2. Analizar la conexión entre diferentes actividades (ej. cómo el ejercicio afecta el estado de ánimo o la productividad). \\n3. Ofrecer recomendaciones accionables y personalizadas basadas en los principios de TCC y ACT para: \\n    a. Reforzar comportamientos positivos. \\n    b. Abordar comportamientos problemáticos, sugiriendo alternativas y estrategias de manejo. \\n    c. Fomentar la aceptación de pensamientos y emociones difíciles, y el compromiso con acciones valiosas. \\n    d. Ayudar a identificar y reestructurar pensamientos negativos o poco útiles (TCC). \\n    e. Promover la flexibilidad psicológica (ACT). \\n4. Proveer ideas para mejorar la descripción de tareas, priorización y efectividad general, considerando el contexto del usuario (Alexander, ingeniero de sistemas, 31 años, trabaja desde casa, busca reducir grasa visceral, mejorar hidratación y optimizar productividad y bienestar). \\n5. Mantén un tono empático, analítico y motivador. Utiliza un lenguaje claro y directo. \\n\\nFormato de respuesta sugerido: \\n**🌟 Análisis General y Patrones:** \\n[Breve resumen de los patrones más destacados del día, conexiones entre actividades y estado de ánimo/productividad.] \\n\\n**💡 Recomendaciones (TCC/ACT):** \\n   **Para [Comportamiento/Patrón Específico]:** \\n   • **Observación:** [Descripción del patrón] \\n   • **Insight (TCC/ACT):** [Aplicación de un principio de TCC/ACT, ej. identificación de pensamiento automático, defusión cognitiva, clarificación de valores] \\n   • **Acción Sugerida:** [Consejo práctico y accionable] \\n\\n**🚀 Mejoras para Tasks y Productividad:** \\n   • **Para mejorar descripciones:** [Sugerencia específica] \\n   • **Para optimizar prioridades:** [Idea basada en el análisis] \\n   • **Para aumentar efectividad:** [Consejo adicional] \\n\\nRecuerda usar el contexto personal de Alexander para que las recomendaciones sean relevantes y efectivas. \\n"+ki}},dr=t=>QM[t],vt=f.forwardRef(({className:t,...n},s)=>e.jsx("textarea",{className:ce("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...n}));vt.displayName="Textarea";const ur=t=>t.trim().split(/\s+/).filter(Boolean).length,Zn=dr("habit"),e4=Zn?`https://generativelanguage.googleapis.com/v1beta/models/${Zn.model}:generateContent`:"";mt.setOptions({breaks:!0,gfm:!0});const t4=({completedHabits:t,open:n,onOpenChange:s})=>{var R,I;const[r,i]=f.useState(!1),o=n!==void 0?n:r,c=s??i,[d,u]=f.useState(""),[m,p]=f.useState(""),[x,g]=f.useState(!1),[v,j]=f.useState(0),b="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",y=((R=Zn==null?void 0:Zn.prompts)==null?void 0:R.predict)??"Analiza mis hábitos recientes y predice cuáles pueden fallar. Dame consejos para cumplirlos.",N=((I=Zn==null?void 0:Zn.prompts)==null?void 0:I.suggest)??"Sugiere nuevos hábitos basados en mis intereses y actividades.",S=Zn==null?void 0:Zn.params;f.useEffect(()=>{if(o){const O=T();p(`${y}
${N}
${O}`)}else p(""),u("")},[o,t]),f.useEffect(()=>{j(ur(m))},[m]);const E=O=>{try{const H=mt.parse(O);return $a.sanitize(H)}catch(H){return console.error("Error procesando Markdown:",H),$a.sanitize(O.replace(/\n/g,"<br>"))}},T=()=>{const O={};let H=null,$=null;const D=new Set;Object.entries(t).forEach(([G,U])=>{const[Y,ae]=G.split("_"),ye=parseInt(Y,10);if(D.add(ae),(!H||ae<H)&&(H=ae),(!$||ae>$)&&($=ae),U){const oe=O[ye]||{success:0,fail:0};oe.success+=1,O[ye]=oe}});const P=Array.from(D).sort();Ma.forEach(G=>{const U=O[G.id]||{success:0,fail:0};P.forEach(Y=>{const ae=`${G.id}_${Y}`;t[ae]||(U.fail+=1)}),O[G.id]=U});const K=H&&$?`Datos del ${H} al ${$}`:"Sin registros",X=Ma.map(G=>{const U=O[G.id]||{success:0,fail:0};return`- ${G.name}: completado ${U.success} veces, no ejecutado ${U.fail} veces`}).join(`
`);return`${K}
${X}`},k=async()=>{var O,H,$,D,P;g(!0);try{const X=await(await fetch(`${e4}?key=${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:m}]}],...S})})).json(),G=(P=(D=($=(H=(O=X==null?void 0:X.candidates)==null?void 0:O[0])==null?void 0:H.content)==null?void 0:$.parts)==null?void 0:D[0])==null?void 0:P.text;u(G||"No se pudo obtener sugerencia")}catch{u("Error al consultar la API")}finally{g(!1)}},M=()=>{c(!1),u(""),p(""),j(0)};return e.jsxs(yt,{open:o,onOpenChange:O=>O?c(!0):M(),children:[n===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>c(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"}),"Analizar hábitos"]}),e.jsxs(xt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(bt,{className:"flex-shrink-0",children:[e.jsx(jt,{className:"text-xl",children:"Análisis de Hábitos con IA"}),e.jsx(mn,{children:"La IA analizará tus hábitos recientes, predecirá cuáles pueden fallar y te dará consejos personalizados. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(vt,{value:m,onChange:O=>p(O.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Datos de hábitos para analizar..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",v]}),v>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:k,disabled:x||!b||v>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[x&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(as,{className:"w-4 h-4"}),x?"Consultando IA...":"Obtener análisis"]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Análisis y sugerencias"}),d&&e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(d),kt.success("Análisis copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Ar,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-md p-4 overflow-auto",children:d?e.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert
                      prose-headings:text-foreground prose-p:text-foreground 
                      prose-strong:text-foreground prose-ul:text-foreground 
                      prose-ol:text-foreground prose-li:text-foreground
                      prose-code:bg-accent prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-foreground
                      prose-pre:bg-accent prose-pre:border prose-pre:text-foreground
                      prose-blockquote:border-l-accent prose-blockquote:text-foreground`,dangerouslySetInnerHTML:{__html:E(d)}}):x?e.jsx("div",{className:"text-sm text-gray-500",children:"Analizando tus hábitos..."}):e.jsx("div",{className:"text-sm text-gray-500",children:"El análisis de tus hábitos aparecerá aquí. La IA te dará predicciones sobre qué hábitos pueden fallar y consejos para cumplirlos mejor."})})})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"💡 Tip: Mientras más datos tengas registrados, mejores serán las predicciones"}),!b]})})]})]})},s4=({completedHabits:t})=>{const[n,s]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(as,{className:"w-4 h-4"}),"IA"]})}),e.jsx(or,{align:"end",children:e.jsx(ut,{onSelect:()=>s(!0),children:"Analizar hábitos"})})]}),e.jsx(t4,{completedHabits:t,open:n,onOpenChange:s})]})},qb=()=>{const[t,n]=f.useState("weekly"),{user:s}=He(),{completedHabits:r,status:i,error:o,toggleHabit:c,resync:d}=UO(),{isOnline:u}=cr();return s?e.jsxs(je,{className:"w-full",children:[e.jsxs(we,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Hábitos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(s4,{completedHabits:r}),e.jsx($O,{view:t,onViewChange:n})]})]}),e.jsx("div",{className:"mb-4"}),t==="weekly"?e.jsx(WO,{completedHabits:r,onToggle:c,disabled:i==="saving"||!u}):e.jsx(HO,{completedHabits:r,onToggle:c}),o&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:o})]}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[i==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),i==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),i==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),i==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!u&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:d,variant:"link",className:"p-0 h-auto text-xs",children:"Reintentar"})]})]}):e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tus hábitos"})})})},Qc=t=>{const n=ai.find(s=>s.text===t);return(n==null?void 0:n.value)??5},n4=t=>{if(t.length===0)return 0;const n=t.reduce((s,r)=>s+(r.value??Qc(r.text)),0);return Math.round(n/t.length*10)/10},ai=[{emoji:"😍",text:"Enamorado",value:10},{emoji:"😊",text:"Feliz",value:10},{emoji:"🌟",text:"Energético",value:10},{emoji:"🧠",text:"Productivo",value:10},{emoji:"😎",text:"Confiado",value:9},{emoji:"😌",text:"Tranquilo",value:8},{emoji:"🤔",text:"Pensativo",value:6},{emoji:"🥱",text:"Aburrido",value:5},{emoji:"😴",text:"Pereza",value:4},{emoji:"😕",text:"Confundido",value:5},{emoji:"😬",text:"Nervioso",value:3},{emoji:"🤯",text:"Abrumado",value:3},{emoji:"😤",text:"Frustración",value:3},{emoji:"😰",text:"Ansioso",value:2},{emoji:"😪",text:"Cansado",value:2},{emoji:"😢",text:"Triste",value:1},{emoji:"😡",text:"Enojado",value:1},{emoji:"🤒",text:"Enfermo",value:1}],r4=({onSelect:t,disabled:n})=>e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:ai.map(s=>e.jsx("div",{className:"relative",children:e.jsxs(F,{variant:"outline",onClick:()=>t(s),className:"h-12 text-lg w-full relative",disabled:n,children:[e.jsx("span",{children:s.emoji}),e.jsx("span",{className:"w-full text-center text-xs text-gray-500 mt-1",children:s.text})]})},s.emoji))}),a4=({isOpen:t,onClose:n,moodEntry:s,onSave:r,onDelete:i})=>{const[o,c]=f.useState(""),[d,u]=f.useState(!1);f.useEffect(()=>{s!=null&&s.time&&c(s.time)},[s]);const m=async()=>{if(s){u(!0);try{const[x,g]=o.split(":").map(Number),v=new Date(s.timestamp),j=ks(v,x,g);await r({...s,time:o,timestamp:j.timestamp}),n()}catch(x){console.error("Error al guardar:",x)}finally{u(!1)}}},p=async()=>{if(i){u(!0);try{await i(),n()}catch(x){console.error("Error al eliminar:",x)}finally{u(!1)}}};return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"sm:max-w-md",children:[e.jsx(bt,{children:e.jsx(jt,{children:"Editar registro"})}),e.jsxs("div",{className:"flex items-center gap-4 py-4",children:[e.jsx("span",{className:"text-2xl",children:s==null?void 0:s.emoji}),e.jsx("span",{children:s==null?void 0:s.text})]}),e.jsx("div",{className:"grid gap-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"time",className:"text-sm",children:"Hora:"}),e.jsx(Ve,{id:"time",type:"time",value:o,onChange:x=>c(x.target.value)})]})}),e.jsxs(en,{className:"gap-2 sm:gap-0",children:[i&&e.jsx(F,{variant:"destructive",onClick:p,disabled:d,className:"w-full sm:w-auto",children:"Eliminar"}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(F,{variant:"outline",onClick:n,disabled:d,className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(F,{onClick:m,disabled:d,className:"flex-1 sm:flex-none",children:"Guardar"})]})]})]})})},i4=({moods:t,onUpdateMood:n,onDeleteMood:s})=>{const[r,i]=f.useState(!1),[o,c]=f.useState(null),d=[...t].sort((v,j)=>v.timestamp-j.timestamp),u=r?d:d.slice(0,3),m=t.length>3,p=v=>{c(v)},x=async v=>{o&&await n(o.timestamp,v)},g=async()=>{o&&await s(o.timestamp)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4 space-y-2",children:[u.map((v,j)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded hover:bg-accent transition-colors",children:[e.jsx("span",{className:"text-xl",children:v.emoji}),e.jsx("span",{children:v.text}),e.jsx("span",{className:"text-gray-500 ml-auto",children:v.time}),e.jsx(F,{variant:"ghost",size:"sm",className:"ml-2 h-8 w-8 p-0",onClick:()=>p(v),children:e.jsx(md,{className:"h-4 w-4"})})]},`${v.timestamp}_${j}`)),m&&e.jsx(F,{variant:"ghost",className:"w-full h-8 text-sm text-gray-500 hover:text-gray-900",onClick:()=>i(!r),children:r?e.jsxs("span",{className:"flex items-center gap-1",children:["Ver menos ",e.jsx(ud,{className:"h-4 w-4"})]}):e.jsxs("span",{className:"flex items-center gap-1",children:["Ver más (",t.length-3,") ",e.jsx(Dr,{className:"h-4 w-4"})]})}),t.length===0&&e.jsx("div",{className:"text-center text-gray-500 py-4",children:"No hay registros para este día"})]}),e.jsx(a4,{isOpen:o!==null,onClose:()=>c(null),moodEntry:o,onSave:x,onDelete:g})]})},o4=["bg-red-500 text-white","bg-orange-500 text-white","bg-yellow-400 text-black","bg-lime-500 text-black","bg-green-600 text-white"],l4=[r_,a_,i_,o_,l_],Yb=({onSelect:t,disabled:n})=>{const[s,r]=f.useState(""),i=o=>{t(o,s||void 0),r("")};return e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Comentario opcional",value:s,onChange:o=>r(o.target.value),className:"w-full border rounded p-2 text-sm"}),e.jsx("div",{className:"grid grid-cols-5 gap-2 mb-2",children:[1,2,3,4,5].map(o=>{const c=l4[o-1];return e.jsx(F,{variant:"default",className:`h-12 w-full ${o4[o-1]} flex items-center justify-center`,onClick:()=>i(o),disabled:n,children:e.jsx(c,{className:"h-5 w-5"})},o)})})]})},c4=({isOpen:t,onClose:n,energyEntry:s,onSave:r,onDelete:i})=>{const[o,c]=f.useState(""),[d,u]=f.useState(3),[m,p]=f.useState(""),[x,g]=f.useState(!1);f.useEffect(()=>{s&&(c(s.time),u(s.level),p(s.comment||""))},[s]);const v=async()=>{if(s){g(!0);try{const[b,y]=o.split(":").map(Number),N=new Date(s.timestamp),S=ks(N,b,y);await r({level:d,comment:m||void 0,time:o,timestamp:S.timestamp}),n()}finally{g(!1)}}},j=async()=>{if(!(!i||!s)){g(!0);try{await i(),n()}finally{g(!1)}}};return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"sm:max-w-md",children:[e.jsx(bt,{children:e.jsx(jt,{children:"Editar registro"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"time",className:"text-sm",children:"Hora:"}),e.jsx(Ve,{id:"time",type:"time",value:o,onChange:b=>c(b.target.value)})]}),e.jsx(Ve,{type:"text",placeholder:"Comentario opcional",value:m,onChange:b=>p(b.target.value)}),e.jsx(Yb,{onSelect:b=>u(b),disabled:!1})]}),e.jsxs(en,{className:"gap-2 sm:gap-0",children:[i&&e.jsx(F,{variant:"destructive",onClick:j,disabled:x,className:"w-full sm:w-auto",children:"Eliminar"}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsx(F,{variant:"outline",onClick:n,disabled:x,className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(F,{onClick:v,disabled:x,className:"flex-1 sm:flex-none",children:"Guardar"})]})]})]})})},d4=["bg-red-500","bg-orange-500","bg-yellow-400","bg-lime-500","bg-green-600"],u4=({entries:t,onUpdate:n,onDelete:s})=>{const[r,i]=f.useState(!1),[o,c]=f.useState(null),d=[...t].sort((x,g)=>x.timestamp-g.timestamp),u=t.length>0?Math.round(t.reduce((x,g)=>x+g.level,0)/t.length*10)/10:0,m=async x=>{o&&(await n(o.timestamp,x),c(null))},p=async()=>{o&&(await s(o.timestamp),c(null))};return e.jsxs(e.Fragment,{children:[e.jsx(Tf,{type:"single",collapsible:!0,value:r?"history":"",onValueChange:x=>i(!!x),children:e.jsxs(jd,{value:"history",className:"border-none",children:[e.jsx(wd,{className:"w-full h-11 flex items-center justify-between gap-2 border rounded-lg bg-background hover:bg-accent data-[state=open]:rounded-b-none",children:e.jsx("span",{className:"text-sm font-semibold",children:"Historial de hoy"})}),e.jsxs(Nd,{className:"mt-2 space-y-2",children:[d.length===0?e.jsx("div",{className:"text-center text-gray-500 text-sm py-2",children:"No hay registros para este día"}):d.map((x,g)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded",children:[e.jsx("span",{className:`w-3 h-3 rounded-full ${d4[x.level-1]}`}),e.jsxs("span",{className:"text-sm",children:["Nivel ",x.level]}),x.comment&&e.jsx("span",{className:"text-sm flex-1",children:x.comment}),e.jsx("span",{className:"text-gray-500 ml-auto text-sm",children:x.time}),e.jsx(F,{variant:"ghost",size:"sm",className:"ml-2 h-8 w-8 p-0",onClick:()=>c(x),children:e.jsx(md,{className:"h-4 w-4"})})]},`${x.timestamp}_${g}`)),d.length>0&&e.jsxs("div",{className:"text-center text-xs text-muted-foreground",children:["Promedio del día: ",u]})]})]})}),e.jsx(c4,{isOpen:o!==null,onClose:()=>c(null),energyEntry:o,onSave:m,onDelete:p})]})},m4=Bi("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Zi=f.forwardRef(({className:t,variant:n,...s},r)=>e.jsx("div",{ref:r,role:"alert",className:ce(m4({variant:n}),t),...s}));Zi.displayName="Alert";const f4=f.forwardRef(({className:t,...n},s)=>e.jsx("h5",{ref:s,className:ce("mb-1 font-medium leading-none tracking-tight",t),...n}));f4.displayName="AlertTitle";const Qi=f.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:ce("text-sm [&_p]:leading-relaxed",t),...n}));Qi.displayName="AlertDescription";const p4=()=>{const[t,n]=f.useState(!1),[s,r]=f.useState(""),[i,o]=f.useState(null),[c,d]=f.useState(!1),{user:u}=He(),m=async()=>{var x;if(!(!u||!s.trim())){d(!0),o(null);try{const g=JSON.parse(s);if(!Array.isArray(g))throw new Error("El JSON debe ser un array de objetos");let v=0;for(const j of g){if(!j.date||!Array.isArray(j.moods)){console.warn("Datos inválidos para un día:",j);continue}const b=`${u.uid}_${j.date}`,y=be($t(fe,"moods"),b),N=await ds(y),S=N.exists()?((x=N.data())==null?void 0:x.moods)||[]:[],E=j.moods.map((M,R)=>{let I,O;if(M.time){I=M.time;const[H,$]=M.time.split(":").map(Number),D=new Date(j.date);D.setHours(H,$,0,0),O=D.getTime()}else if(M.hour!==void 0&&M.minute!==void 0){I=`${M.hour.toString().padStart(2,"0")}:${M.minute.toString().padStart(2,"0")}`;const H=new Date(j.date);H.setHours(M.hour,M.minute,0,0),O=H.getTime()}else{const H=new Date,$=H.getHours(),D=H.getMinutes()+R;I=`${$.toString().padStart(2,"0")}:${(D%60).toString().padStart(2,"0")}`;const P=new Date(j.date);O=ks(P,$,D%60).timestamp}return{emoji:M.emoji,text:M.text,time:I,timestamp:O}}),T=[...S,...E],k={id:b,userId:u.uid,date:j.date,moods:T};await ht(y,k),v+=E.length}kt.success(`Se importaron ${v} estados de ánimo correctamente`),r(""),n(!1)}catch(g){const v=g instanceof Error?g.message:"Error al importar estados de ánimo";o(v),kt.error(v)}finally{d(!1)}}};return e.jsxs(yt,{open:t,onOpenChange:n,children:[e.jsx($0,{asChild:!0,children:e.jsxs(F,{variant:"outline",size:"sm",children:[e.jsx(Oi,{className:"h-4 w-4 mr-2"}),"Importar Estados"]})}),e.jsxs(xt,{className:"max-w-2xl",children:[e.jsx(bt,{children:e.jsx(jt,{children:"Importar Estados de Ánimo desde JSON"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:'Pegue el JSON con los estados de ánimo a importar. El campo "time" es opcional.'}),e.jsxs("details",{className:"text-xs text-gray-500",children:[e.jsx("summary",{className:"cursor-pointer hover:text-gray-700",children:"Ver ejemplo de formato"}),e.jsx("pre",{className:"mt-2 p-2 bg-gray-50 rounded text-xs overflow-x-auto",children:`[
  {
    "date": "2024-01-15",
    "moods": [
      {
        "emoji": "😊",
        "text": "Feliz",
        "time": "09:30"
      },
      {
        "emoji": "😌",
        "text": "Tranquilo",
        "hour": 14,
        "minute": 15
      },
      {
        "emoji": "🤔",
        "text": "Pensativo"
      }
    ]
  }
]`})]})]}),e.jsx(vt,{value:s,onChange:x=>r(x.target.value),placeholder:"Pegue aquí el JSON con los estados de ánimo...",className:"min-h-[200px] font-mono text-sm"}),i&&e.jsxs(Zi,{variant:"destructive",children:[e.jsx(cd,{className:"h-4 w-4"}),e.jsx(Qi,{children:i})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(F,{variant:"outline",onClick:()=>n(!1),children:"Cancelar"}),e.jsx(F,{onClick:m,disabled:!s.trim()||c,children:c?"Importando...":"Importar"})]})]})]})]})},h4={entry:"",setEntry:()=>{}},Kb=f.createContext(h4),x4=({children:t})=>{const[n,s]=f.useState("");return e.jsx(Kb.Provider,{value:{entry:n,setEntry:s},children:t})},Jb=()=>f.useContext(Kb),g4={isUnlocked:!1,setUnlocked:()=>{}},Xb=f.createContext(g4),v4=({children:t})=>{const[n,s]=f.useState(!1);return e.jsx(Xb.Provider,{value:{isUnlocked:n,setUnlocked:s},children:t})},ep=()=>f.useContext(Xb),Na=dr("mood"),y4=Na?`https://generativelanguage.googleapis.com/v1beta/models/${Na.model}:generateContent`:"",b4=({selectedDate:t,open:n,onOpenChange:s})=>{const{user:r}=He(),{entry:i}=Jb(),{isUnlocked:o}=ep(),[c,d]=f.useState(!1),u=n!==void 0?n:c,m=s??d,[p,x]=f.useState(!1),[g,v]=f.useState([]),[j,b]=f.useState(""),[y,N]=f.useState(0),S="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",E=ai.map($=>$.text).join(", "),T=(Na==null?void 0:Na.prompt)??'Analiza la siguiente entrada del diario y sugiere estados de ánimo en formato JSON: [{"emoji":"","text":"","time":"HH:mm","reason":""}]',k=Na==null?void 0:Na.params;if(f.useEffect(()=>{u&&o&&(async()=>{const $=i||await M();b(`${T}
Moods disponibles: ${E}. Solo usa estos valores.
${$}`)})()},[u,i,o]),f.useEffect(()=>{N(ur(j))},[j]),!o)return null;const M=async()=>{if(!r)return"";const $=Oe(t),D=be(fe,"journal",`${r.uid}_${$}`),P=await ds(D);return P.exists()&&P.data().text||""},R=$=>{try{const D=$.match(/\[[\s\S]*\]/);if(!D)return[];const P=JSON.parse(D[0]);if(!Array.isArray(P))return[];const K=new Set(ai.map(U=>U.text)),X={mañana:"09:00",tarde:"15:00",noche:"21:00"},G=new Map(ai.map(U=>[U.text,U.emoji]));return P.filter(U=>K.has(U.text)).map(U=>({...U,emoji:U.emoji||G.get(U.text)||"",time:U.time||X[U.timeOfDay??""]||"12:00"}))}catch{return[]}},I=async $=>{var D,P,K,X,G;x(!0);try{if(!$.trim()){v([]);return}const Y=await(await fetch(`${y4}?key=${S}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:$}]}],...k})})).json(),ae=((G=(X=(K=(P=(D=Y==null?void 0:Y.candidates)==null?void 0:D[0])==null?void 0:P.content)==null?void 0:K.parts)==null?void 0:X[0])==null?void 0:G.text)||"",ye=R(ae);v(ye)}catch{v([])}finally{x(!1)}},O=async $=>{if(!r)return;const D=Oe(t),P=`${r.uid}_${D}`,K=be($t(fe,"moods"),P);let X=12,G=0;if($.time){const[W,se]=$.time.split(":").map(Number);X=W??12,G=se??0}else $.timeOfDay&&(X={mañana:9,tarde:15,noche:21}[$.timeOfDay]??12);const U=`${X.toString().padStart(2,"0")}:${G.toString().padStart(2,"0")}`,Y=ks(t,X,G),ae=await ds(K),ye=ae.exists()&&Array.isArray(ae.data().moods)?ae.data().moods:[],oe=ai.find(W=>W.text===$.text),me={emoji:$.emoji||(oe==null?void 0:oe.emoji)||"",text:$.text,time:U,timestamp:Y.timestamp};await ht(K,{id:P,userId:r.uid,date:D,moods:[...ye,me]})},H=()=>{m(!1),v([]),b(""),N(0)};return e.jsxs(yt,{open:u,onOpenChange:$=>$?m(!0):H(),children:[n===void 0&&e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>m(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"h-4 w-4"}),"Analizar Diario"]}),e.jsxs(xt,{className:"max-w-2xl",children:[e.jsx(bt,{children:e.jsx(jt,{children:"Sugerencias de estados de ánimo"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(vt,{value:j,onChange:$=>b($.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",y," ",y>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:()=>I(j),disabled:p||!S,className:"w-full flex items-center justify-center gap-2",children:[p&&e.jsx(Qt,{className:"h-4 w-4 animate-spin"}),p?"Consultando...":"Analizar"]}),p&&e.jsxs("p",{className:"flex items-center justify-center gap-2 text-sm",children:[e.jsx(Qt,{className:"h-4 w-4 animate-spin"})," Consultando..."]}),!p&&g.map(($,D)=>e.jsxs("div",{className:"border rounded p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:$.emoji}),e.jsx("span",{children:$.text}),e.jsx("span",{className:"ml-auto text-sm text-gray-500",children:$.time})]}),$.reason&&e.jsx("p",{className:"text-sm text-gray-500",dangerouslySetInnerHTML:{__html:$a.sanitize($.reason)}}),e.jsx(F,{size:"sm",className:"ml-auto",onClick:()=>O($),children:"Registrar"})]},D)),!p&&g.length===0&&e.jsx("p",{className:"text-sm text-center text-gray-500",children:"No se encontraron sugerencias"})]})]})]})},j4=({selectedDate:t})=>{const[n,s]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(as,{className:"w-4 h-4"}),"IA"]})}),e.jsx(or,{align:"end",children:e.jsx(ut,{onSelect:()=>s(!0),children:"Sugerir moods"})})]}),e.jsx(b4,{selectedDate:t,open:n,onOpenChange:s})]})},w4=t=>{const[n,s]=f.useState(null),[r,i]=f.useState("idle"),[o,c]=f.useState(null),{user:d}=He(),u=async()=>{if(d)try{const v=Oe(t);Gt.logRead("moods","useMoodData.loadData",`${d.uid}_${v}`);const j=be($t(fe,"moods"),`${d.uid}_${v}`),b=await ds(j);if(b.exists()){const y=b.data();y&&Array.isArray(y.moods)?s(y):s({id:`${d.uid}_${v}`,userId:d.uid,date:v,moods:[]})}else s(null);i("saved")}catch(v){console.error("Error loading mood data:",v),c(v instanceof Error?v.message:"Error al cargar estado de ánimo"),i("error")}};f.useEffect(()=>{u()},[d,t]);const m=async v=>{if(!d)return;i("saving"),c(null);const j=Oe(t),b=`${d.uid}_${j}`,y=be($t(fe,"moods"),b);try{const N=new Date,S=ks(t,N.getHours(),N.getMinutes()),E={emoji:v.emoji,text:v.text,timestamp:S.timestamp,time:N.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),value:Qc(v.text)},T=await ds(y);if(T.exists()){const k=T.data(),M=Array.isArray(k==null?void 0:k.moods)?k.moods:[];Gt.logWrite("moods","useMoodData.addMood.update",b),await ht(y,{id:b,userId:d.uid,date:j,moods:[...M,E]})}else Gt.logWrite("moods","useMoodData.addMood.create",b),await ht(y,{id:b,userId:d.uid,date:j,moods:[E]});await u()}catch(N){console.error("Mood - Error al guardar:",N),c(N instanceof Error?N.message:"Error al guardar"),i("error")}},p=async(v,j)=>{if(!d||!n)return;i("saving"),c(null);const b=be($t(fe,"moods"),n.id);try{const y=n.moods.map(N=>N.timestamp===v?j:N);await ht(b,{...n,moods:y})}catch(y){console.error("Mood - Error al actualizar:",y),c(y instanceof Error?y.message:"Error al actualizar"),i("error")}},x=async v=>{if(!d||!n)return;i("saving"),c(null);const j=be($t(fe,"moods"),n.id);try{const b=n.moods.filter(y=>y.timestamp!==v);b.length===0?(Gt.logDelete("moods","useMoodData.deleteMood.deleteDoc",n.id),await ci(j),s(null)):(Gt.logWrite("moods","useMoodData.deleteMood.update",n.id),await ht(j,{...n,moods:b})),await u()}catch(b){console.error("Mood - Error al eliminar:",b),c(b instanceof Error?b.message:"Error al eliminar"),i("error")}},g=Rr("Mood data");return{moodHistory:(n==null?void 0:n.moods)||[],status:r,error:o,addMood:m,updateMood:p,deleteMood:x,loadMoodData:u,resync:g}},N4=t=>{const[n,s]=f.useState(null),[r,i]=f.useState("idle"),[o,c]=f.useState(null),{user:d}=He();f.useEffect(()=>{if(!d)return;const g=Oe(t),v=be($t(fe,"energy"),`${d.uid}_${g}`),j=ns(v,b=>{if(b.exists()){const y=b.data();y&&Array.isArray(y.entries)?s(y):s({id:`${d.uid}_${g}`,userId:d.uid,date:g,entries:[]})}else s(null);b.metadata.hasPendingWrites?i("pending"):i("saved")},b=>{console.error("Energy - Error en snapshot:",b),c(b.message),i("error")});return()=>j()},[d,t]);const u=async(g,v)=>{if(!d)return;i("saving"),c(null);const j=Oe(t),b=`${d.uid}_${j}`,y=be($t(fe,"energy"),b);try{const N=new Date,S=ks(t,N.getHours(),N.getMinutes()),E={level:g,comment:v,timestamp:S.timestamp,time:N.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})},T=await ds(y);if(T.exists()){const k=T.data(),M=Array.isArray(k==null?void 0:k.entries)?k.entries:[];await ht(y,{id:b,userId:d.uid,date:j,entries:[...M,E]})}else await ht(y,{id:b,userId:d.uid,date:j,entries:[E]})}catch(N){console.error("Energy - Error al guardar:",N),c(N instanceof Error?N.message:"Error al guardar"),i("error")}},m=async(g,v)=>{if(!d||!n)return;i("saving"),c(null);const j=be($t(fe,"energy"),n.id);try{const b=n.entries.map(y=>y.timestamp===g?v:y);await ht(j,{...n,entries:b})}catch(b){console.error("Energy - Error al actualizar:",b),c(b instanceof Error?b.message:"Error al actualizar"),i("error")}},p=async g=>{if(!d||!n)return;i("saving"),c(null);const v=be($t(fe,"energy"),n.id);try{const j=n.entries.filter(b=>b.timestamp!==g);j.length===0?(await ci(v),s(null)):await ht(v,{...n,entries:j})}catch(j){console.error("Energy - Error al eliminar:",j),c(j instanceof Error?j.message:"Error al eliminar"),i("error")}},x=Rr("Energy data");return{energyHistory:(n==null?void 0:n.entries)||[],status:r,error:o,addEntry:u,updateEntry:m,deleteEntry:p,resync:x}},tp=({selectedDate:t,energyFirst:n=!1})=>{const{user:s}=He(),{isUnlocked:r}=ep(),{moodHistory:i,status:o,error:c,addMood:d,updateMood:u,deleteMood:m,resync:p}=w4(t),{energyHistory:x,status:g,error:v,addEntry:j,updateEntry:b,deleteEntry:y,resync:N}=N4(t),{isOnline:S}=cr(),E=x.slice().sort((I,O)=>O.timestamp-I.timestamp)[0],T=["text-red-500","text-orange-500","text-yellow-500","text-lime-600","text-green-600"];if(!s)return e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tu estado de ánimo"})})});const k=Oe(t)===Oe(new Date),M=e.jsxs(je,{className:"w-full",children:[e.jsxs(we,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"font-medium",children:"Estado de ánimo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p4,{}),r&&e.jsx(j4,{selectedDate:t})]})]}),k&&e.jsx(r4,{onSelect:d,disabled:o==="saving"||!S}),e.jsx(i4,{moods:i,onUpdateMood:u,onDeleteMood:m}),c&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:c})]}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[o==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),o==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),o==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),o==="error"&&e.jsx("span",{className:"text-red-500",children:"Error al guardar"}),!S&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:p,variant:"link",className:"p-0 h-auto text-xs",children:"Reintentar"})]})]}),R=e.jsxs(je,{className:"w-full",children:[e.jsxs(we,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h3",{className:"font-medium",children:["Nivel de energía",E&&e.jsxs("span",{className:`ml-2 ${T[E.level-1]}`,children:["(",E.level,")"]})]}),e.jsx("div",{className:"flex items-center gap-2"})]}),k&&e.jsx("div",{className:"mb-4",children:e.jsx(Yb,{onSelect:j,disabled:g==="saving"||!S})}),e.jsx(u4,{entries:x,onUpdate:b,onDelete:y}),v&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:v})]}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[g==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),g==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),g==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),g==="error"&&e.jsx("span",{className:"text-red-500",children:"Error al guardar"}),!S&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:N,variant:"link",className:"p-0 h-auto text-xs",children:"Reintentar"})]})]});return e.jsxs("div",{className:"space-y-4",children:[n?R:M,n?M:R]})},S4=({onLock:t})=>e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c_,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Mi Diario"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"long"})})}),e.jsx(F,{variant:"ghost",size:"icon",onClick:t,title:"Bloquear diario",children:e.jsx(Xv,{className:"w-4 h-4"})})]})]}),C4=({value:t,onChange:n})=>e.jsx(vt,{value:t,onChange:s=>n(s.target.value),placeholder:"¿Cómo ha sido tu día?",className:"w-full h-64 resize-none"}),Zb=({lastUpdated:t,className:n=""})=>t?e.jsxs("div",{className:`flex items-center gap-2 text-sm text-gray-500 ${n}`,children:[e.jsx(Sr,{className:"w-4 h-4"}),e.jsxs("span",{children:["Última actualización: ",t]})]}):null,E4=({onUnlock:t,lastUpdated:n})=>{const[s,r]=f.useState(""),[i,o]=f.useState(!1),c=d=>{d.preventDefault(),s==="1234"?(t(),o(!1)):o(!0)};return e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-4",children:e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx(Xv,{className:"w-12 h-12 text-blue-500"})}),e.jsx("h3",{className:"text-center text-lg font-medium",children:"Diario Protegido"}),e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Ingresa la contraseña para acceder a tu diario"}),e.jsx(Ve,{type:"password",value:s,onChange:d=>r(d.target.value),placeholder:"Contraseña",className:i?"border-destructive focus-visible:ring-destructive":""}),i&&e.jsx("p",{className:"text-sm text-red-500 text-center",children:"Contraseña incorrecta"}),e.jsx(F,{type:"submit",className:"w-full",children:"Desbloquear"}),e.jsx(Zb,{lastUpdated:n,className:"justify-center"})]})})})},T4=Bi("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),jr=f.forwardRef(({className:t,variant:n,...s},r)=>e.jsx("div",{ref:r,className:ce(T4({variant:n}),t),...s}));jr.displayName="Badge";const sp={PERSONAL:"personal",WORK:"work",HOME:"home",HEALTH:"health",SHOPPING:"shopping",STUDY:"study",SOCIAL:"social",OTHER:"other"},nr={personal:"Personal",work:"Trabajo",home:"Casa",health:"Salud",shopping:"Compras",study:"Estudio",social:"Social",other:"Otro"},Qm={personal:{bg:"bg-purple-100",text:"text-purple-700"},work:{bg:"bg-blue-100",text:"text-blue-700"},home:{bg:"bg-green-100",text:"text-green-700"},health:{bg:"bg-red-100",text:"text-red-700"},shopping:{bg:"bg-yellow-100",text:"text-yellow-700"},study:{bg:"bg-indigo-100",text:"text-indigo-700"},social:{bg:"bg-pink-100",text:"text-pink-700"},other:{bg:"bg-gray-100",text:"text-gray-700"}},k4={MORNING:"morning",AFTERNOON:"afternoon",EVENING:"evening"},ef={morning:"Mañana",afternoon:"Tarde",evening:"Noche"};mt.setOptions({breaks:!0,gfm:!0});const Qb=t=>{try{const n=mt.parse(t);return $a.sanitize(n)}catch{return $a.sanitize(t.replace(/\n/g,"<br>"))}},np=t=>{const n=t.match(/^\s*- \[(?: |x|X)\]/gm);if(!n||n.length===0)return{total:0,checked:0};const s=n.filter(r=>r.toLowerCase().startsWith("- [x]")).length;return{total:n.length,checked:s}},zo=t=>{const{total:n,checked:s}=np(t);return n?s/n*100:0},Uo={small:"w-3 h-3",medium:"w-3.5 h-3.5",large:"w-5 h-5"},_4={small:"h-5 w-5",medium:"h-6 w-6"},D4={daily:"Diario",weekly:"Semanal",monthly:"Mensual"},Mg={do:{label:"HACER",color:"bg-red-500",text:"Urgente e importante"},decide:{label:"DECIDIR",color:"bg-orange-500",text:"Importante, no urgente"},delegate:{label:"DELEGAR",color:"bg-blue-500",text:"Urgente, no importante"},delete:{label:"ELIMINAR",color:"bg-gray-500",text:"Ni urgente ni importante"},none:{label:"",color:"",text:""}},fm={do:{icon:"🔥",num:1,style:"bg-red-600 text-white"},decide:{icon:"🤔",num:2,style:"bg-orange-500 text-white"},delegate:{icon:"📬",num:3,style:"bg-blue-500 text-white"},delete:{icon:"🗑️",num:4,style:"bg-gray-500 text-white"},none:{icon:"🗑️",num:4,style:"bg-gray-500 text-white"}},A4=t=>Pt(t,"dd/MM"),R4=t=>t!=null&&t.type&&D4[t.type]||"",P4=(t="none")=>Mg[t]||Mg.none,I4=t=>t?os(ys(t),ys(new Date)):!1,pm=jr,tf=f.memo(({task:t,showCategoryLabel:n,overdue:s,variant:r})=>{var m,p;const i={bg:((m=Qm[t.category])==null?void 0:m.bg)||"bg-purple-100",text:((p=Qm[t.category])==null?void 0:p.text)||"text-purple-800"},o=P4(t.priority),c=R4(t.recurrence),d=r==="list"?"text-xs px-1 py-0.5 h-auto":"text-xs px-1.5 py-0.5",u=Uo.small;return e.jsxs("div",{className:"flex flex-wrap gap-1",children:[n&&e.jsxs(jr,{className:ce(d,i.bg,i.text),children:[e.jsx(Zv,{className:ce(u,"mr-1")}),nr[t.category]]}),r==="list"&&!n&&o.label&&e.jsx(zn,{children:e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(pm,{className:ce(d,"text-white",o.color),children:o.label})}),e.jsx(rs,{children:o.text})]})}),!n&&t.size&&e.jsx(jr,{variant:"outline",className:d,children:t.size}),t.dueDate&&e.jsxs(jr,{variant:s?"destructive":"secondary",className:d,children:[e.jsx(Nn,{className:ce(u,"mr-1")}),A4(t.dueDate),s&&" (vencida)"]}),r==="kanban"&&e.jsx(zn,{children:e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsxs(pm,{className:ce(d,"gap-0.5",fm[t.priority||"none"].style),children:[e.jsx("span",{className:"mr-0.5",children:fm[t.priority||"none"].icon}),fm[t.priority||"none"].num]})}),e.jsx(rs,{children:o.text})]})}),r==="kanban"&&t.estimatedTime!==void 0&&e.jsxs(jr,{variant:"outline",className:d,children:[e.jsx(Sr,{className:ce(u,"mr-1")}),t.estimatedTime,"m"]}),t.isRecurrent&&c&&e.jsxs(jr,{variant:"outline",className:d,children:[e.jsx(d_,{className:ce(u,"mr-1")}),c]}),r==="list"&&!t.isRecurrent&&o.label&&e.jsx(zn,{children:e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(pm,{className:ce(d,"text-white cursor-help",o.color),children:o.label})}),e.jsx(rs,{children:o.text})]})})]})});tf.displayName="TaskBadges";const Qa=f.forwardRef(({children:t,...n},s)=>e.jsx(F,{ref:s,...n,children:t}));Qa.displayName="ActionButton";const sf=f.memo(({task:t,onEdit:n,onDelete:s,onMove:r,variant:i})=>{const o=qi(),c=f.useCallback(j=>{j.stopPropagation(),r==null||r(t.id,ti(new Date))},[r,t.id]),d=f.useCallback(j=>{j.stopPropagation(),r==null||r(t.id,ti(Vt(new Date,1)))},[r,t.id]),u=f.useCallback(j=>{j.stopPropagation(),r==null||r(t.id,null)},[r,t.id]),m=f.useCallback(j=>{j.stopPropagation(),n(t)},[n,t]),p=f.useCallback(()=>{s(t.id)},[s,t.id]),x=f.useCallback(j=>{j.stopPropagation(),o(`/task/${t.id}/run`)},[o,t.id]),g=ce(_4.medium,"md:h-5 md:w-5 p-0 rounded-full hover:bg-muted"),v=i==="kanban"&&r&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(Qa,{variant:"ghost",size:"icon",className:g,title:"Asignar para hoy",onClick:c,children:e.jsx("span",{role:"img","aria-label":"hoy",className:"text-sm md:text-xs",children:"📅"})}),e.jsx(Qa,{variant:"ghost",size:"icon",className:g,title:"Asignar para mañana",onClick:d,children:e.jsx("span",{role:"img","aria-label":"mañana",className:"text-sm md:text-xs",children:"🌅"})}),e.jsx(Qa,{variant:"ghost",size:"icon",className:g,title:"Quitar fecha",onClick:u,children:e.jsx("span",{role:"img","aria-label":"sin fecha",className:"text-sm md:text-xs",children:"❌"})})]});return e.jsxs("div",{className:ce("flex gap-1",i==="kanban"?"justify-between w-full":"shrink-0 opacity-60 hover:opacity-100 transition-opacity"),children:[v,e.jsxs("div",{className:"flex gap-1",children:[e.jsx(Qa,{variant:"ghost",size:"icon",className:g,title:"Ejecutar",onClick:x,children:e.jsx(Xo,{className:ce(Uo.medium,"md:w-3 md:h-3 text-green-600")})}),e.jsx(Qa,{variant:"ghost",size:"icon",className:g,title:"Editar tarea",onClick:m,children:e.jsx(vf,{className:ce(Uo.medium,"md:w-3 md:h-3 text-muted-foreground")})}),e.jsxs(Sd,{children:[e.jsx(Af,{asChild:!0,children:e.jsx(Qa,{variant:"ghost",size:"icon",className:ce(g,"hover:bg-red-50"),title:"Eliminar tarea",onClick:j=>j.stopPropagation(),children:e.jsx(Js,{className:ce(Uo.medium,"md:w-3 md:h-3 text-red-500")})})}),e.jsxs(xl,{children:[e.jsxs(gl,{children:[e.jsx(yl,{children:"¿Eliminar tarea?"}),e.jsxs(bl,{children:['Esta acción no se puede deshacer. La tarea "',t.title,'" será eliminada permanentemente.']})]}),e.jsxs(vl,{children:[e.jsx(wl,{children:"Cancelar"}),e.jsx(jl,{onClick:p,className:"bg-red-600 hover:bg-red-700",children:"Eliminar"})]})]})]})]})]})});sf.displayName="TaskActions";const $i=f.memo(({task:t,onDelete:n,onEdit:s,onView:r,onMove:i,variant:o="list",showCategoryLabel:c=!0})=>{const d=I4(t.dueDate??null),{total:u,checked:m}=np(t.description||""),p=u?t.progress??m/u*100:0,x=f.useCallback(()=>{r==null||r(t)},[r,t]),g=ce("cursor-pointer relative hover:shadow-md transition-all duration-200 border-0 shadow-sm",o==="kanban"&&"text-sm w-full max-w-none lg:max-w-[18rem]",o==="list"&&"mb-2",t.completed?o==="kanban"?"bg-muted/30":"opacity-70 bg-gray-50":"bg-white",!t.completed&&d&&"border-l-4 border-l-red-500 bg-red-50",o==="list"&&"hover:bg-gray-50");return o==="kanban"?e.jsx(e.Fragment,{children:e.jsxs(je,{onClick:x,className:g,children:[e.jsx(we,{className:"p-2 md:p-2 flex flex-col gap-1.5",children:e.jsx("div",{className:"flex items-start gap-2",children:e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.isPrivate&&e.jsx("span",{className:"text-xs",children:"🔒"}),e.jsx("span",{className:ce("text-sm break-words line-clamp-2 font-medium",t.completed?"line-through text-muted-foreground":"text-foreground"),children:t.title})]}),t.description&&e.jsx("p",{className:ce("text-xs text-muted-foreground line-clamp-2 break-words leading-relaxed",t.completed&&"line-through"),children:t.description}),e.jsx("div",{className:"flex flex-wrap gap-1 pt-0.5",children:e.jsx(tf,{task:t,showCategoryLabel:c,overdue:d,variant:"kanban"})}),u>0&&e.jsxs("div",{className:"pt-1 space-y-0.5",children:[e.jsx(ca,{value:p,className:"h-1"}),e.jsxs("p",{className:"text-[10px] text-right text-muted-foreground",children:[m," de ",u]})]})]})})}),e.jsx(Xs,{className:"px-2 py-1.5 bg-gray-50/50 border-t border-gray-100 p-0 md:p-0",children:e.jsx("div",{className:"px-2 py-1.5 w-full",children:e.jsx(sf,{task:t,onEdit:s,onDelete:n,onMove:i,variant:"kanban"})})})]})}):e.jsx(je,{onClick:x,className:g,children:e.jsxs(we,{className:"flex items-center gap-2.5 py-2 px-3 md:py-2 md:px-3",children:[e.jsxs("div",{className:"flex-1 min-w-0 space-y-0.5",children:[e.jsxs("div",{className:"space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[t.isPrivate&&e.jsx("span",{className:"text-xs opacity-70",children:"🔒"}),e.jsx("span",{className:ce("text-sm break-words line-clamp-1 leading-tight font-medium",t.completed?"line-through text-muted-foreground":"text-foreground"),children:t.title}),t.description&&e.jsx(Qv,{className:"w-3 h-3 text-muted-foreground shrink-0 opacity-50"})]}),t.description&&e.jsx("p",{className:ce("text-xs text-muted-foreground line-clamp-1 break-words leading-tight",t.completed&&"line-through"),children:t.description})]}),e.jsx(tf,{task:t,showCategoryLabel:c,overdue:d,variant:"list"})]}),e.jsx(sf,{task:t,onEdit:s,onDelete:n,variant:"list"})]})})});$i.displayName="TaskItem";const O4=t=>{const n={do:{label:"HACER",color:"bg-red-500",text:"Urgente e importante",urgent:!0,important:!0},decide:{label:"DECIDIR",color:"bg-yellow-500",text:"Importante pero no urgente",urgent:!1,important:!0},delegate:{label:"DELEGAR",color:"bg-blue-500",text:"Urgente pero no importante",urgent:!0,important:!1},delete:{label:"ELIMINAR",color:"bg-gray-500",text:"Ni urgente ni importante",urgent:!1,important:!1},none:{label:"",color:"",text:"",urgent:!1,important:!1}};return n[t]||n.none},M4=t=>{if(!t)return"";if(t<60)return`${t} min`;{const n=Math.floor(t/60),s=t%60;return s===0?`${n}h`:`${n}h ${s}min`}},Id=({task:t,isOpen:n,onClose:s,onEdit:r,onToggle:i})=>{if(!t)return null;const o=qi(),c=Qm[t.category],d=O4(t.priority),u=t.isRecurrent&&t.recurrence?R0(t.dueDate||new Date,t.recurrence.pattern,t.recurrence.customDays):"",m=t.dueDate&&os(ys(t.dueDate),ys(new Date)),{total:p,checked:x}=np(t.description||""),g=p>0,v=g?t.progress??x/p*100:0,j=Qb(t.description||"");return e.jsx(yt,{open:n,onOpenChange:b=>{b||s()},children:e.jsxs(xt,{className:"max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-12 md:col-span-8 space-y-6",children:[e.jsx(bt,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[t.isPrivate&&e.jsx("span",{className:"text-lg mt-1",children:"🔒"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(jt,{className:"text-2xl font-semibold leading-tight break-words text-gray-900",children:t.title}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["en lista ",e.jsx("span",{className:"font-medium",children:nr[t.category]})]})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.dueDate&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium ${m?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:[e.jsx("span",{children:"📅"}),uR(t.dueDate),m&&" (Vencida)"]}),t.timeOfDay&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-orange-100 text-orange-800",children:[e.jsx("span",{children:"🕐"}),t.timeOfDay==="morning"&&"Mañana",t.timeOfDay==="afternoon"&&"Tarde",t.timeOfDay==="evening"&&"Noche"]})]}),t.description&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{children:"📝"}),"Descripción"]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:j}}),g&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Progreso de elementos"}),e.jsxs("span",{className:"text-gray-600",children:[x," de ",p," completados"]})]}),e.jsx(ca,{value:v,className:"h-2"})]})]})]}),t.priority&&d.text||t.isRecurrent&&u?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx("span",{children:"�"}),"Detalles adicionales"]}),t.priority&&d.text&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Matriz de Eisenhower"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:d.text}),e.jsxs("div",{className:"flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Urgente:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${d.urgent?"bg-red-100 text-red-800":"bg-gray-100 text-gray-600"}`,children:d.urgent?"Sí":"No"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Importante:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${d.important?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"}`,children:d.important?"Sí":"No"})]}),d.label&&e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium text-white ${d.color}`,children:[e.jsx("span",{children:"⚡"}),d.label]})]})]})]}):null]}),e.jsxs("div",{className:"col-span-12 md:col-span-4 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Acciones"}),e.jsxs("div",{className:"space-y-2",children:[i&&e.jsx(F,{onClick:()=>i(t.id,!t.completed),variant:t.completed?"outline":"default",className:"w-full justify-start gap-2",children:t.completed?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"↩️"}),"Marcar pendiente"]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"✅"}),"Marcar completada"]})}),e.jsxs(F,{onClick:()=>o(`/task/${t.id}/run`),variant:"outline",className:"w-full justify-start gap-2",children:[e.jsx(Xo,{className:"w-4 h-4"}),"Ejecutar"]}),e.jsxs(F,{onClick:()=>r(t),variant:"outline",className:"w-full justify-start gap-2",children:[e.jsx("span",{children:"✏️"}),"Editar"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 uppercase tracking-wide",children:"Organización"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Lista"}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium ${c.bg} ${c.text}`,children:[e.jsx("span",{children:"📋"}),nr[t.category]]})]}),t.size&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tamaño"}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-gray-100 text-gray-800",children:[e.jsx("span",{children:"📏"}),t.size]})]}),t.estimatedTime&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tiempo estimado"}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-emerald-100 text-emerald-800",children:[e.jsx("span",{children:"⏱️"}),M4(t.estimatedTime)]})]}),t.isRecurrent&&u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Recurrencia"}),e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-purple-100 text-purple-800",children:[e.jsx("span",{children:"🔄"}),u]})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"text-sm text-gray-500 pt-2 border-t",children:[e.jsx("p",{className:"font-medium text-gray-600 mb-1",children:"Creada"}),t.createdAt?new Date(t.createdAt.seconds*1e3).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"Recientemente"]})})]})]}),e.jsx(en,{className:"mt-6 border-t pt-4",children:e.jsx(F,{variant:"outline",onClick:s,children:"Cerrar"})})]})})},L4=({value:t,onChange:n,multiline:s})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(u_,{className:"w-4 h-4"}),"Título"]}),s?e.jsx(vt,{value:t,onChange:r=>n(r.target.value),placeholder:"Una tarea por línea",className:"min-h-[120px]"}):e.jsx(Ve,{value:t,onChange:r=>n(r.target.value),placeholder:"Título de la tarea..."})]}),$4=({value:t,onChange:n})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Qv,{className:"w-4 h-4"}),"Descripción de la tarea"]}),e.jsx(vt,{value:t,onChange:s=>n(s.target.value),placeholder:"Agrega más detalles sobre la tarea...",className:"min-h-[250px] resize-y"})]}),oa=({className:t})=>{const[n,s]=f.useState(0);return f.useEffect(()=>{const r=setInterval(()=>{s(i=>{const o=i+5;return o>=100?(clearInterval(r),100):o})},500);return()=>clearInterval(r)},[]),e.jsxs("div",{className:`flex items-center gap-2 ${t??""}`,children:[e.jsx(ca,{value:n,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-8 text-right",children:[n,"%"]})]})},Sa=dr("task"),z4=Sa?`https://generativelanguage.googleapis.com/v1beta/models/${Sa.model}:generateContent`:"",F4=({title:t,description:n,onInsert:s})=>{var N;const[r,i]=f.useState(!1),[o,c]=f.useState(""),[d,u]=f.useState(""),[m,p]=f.useState(!1),[x,g]=f.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",j=((N=Sa==null?void 0:Sa.prompts)==null?void 0:N.breakdown)??"Desglosa la siguiente tarea en subtareas concretas y accionables:",b=Sa==null?void 0:Sa.params;f.useEffect(()=>{r&&c(`${j}
Tarea: ${t}
Descripcion: ${n}`)},[r,t,n]),f.useEffect(()=>{g(ur(o))},[o]);const y=async()=>{var S,E,T,k,M;if(t){p(!0);try{const I=await(await fetch(`${z4}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:o}]}],...b})})).json(),O=(M=(k=(T=(E=(S=I==null?void 0:I.candidates)==null?void 0:S[0])==null?void 0:E.content)==null?void 0:T.parts)==null?void 0:k[0])==null?void 0:M.text;u(O||"No se pudo obtener sugerencia")}catch{u("Error al consultar la API")}finally{p(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"})," Subtareas IA"]}),e.jsx(yt,{open:r,onOpenChange:i,children:e.jsxs(xt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(bt,{className:"flex-shrink-0",children:[e.jsx(jt,{className:"text-xl",children:"Desglose de Tarea con IA"}),e.jsx(mn,{children:"La IA descompondrá tu tarea en subtareas concretas y accionables. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(vt,{value:o,onChange:S=>c(S.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Escribe o modifica el prompt para la IA..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",x]}),x>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:y,disabled:m||!v||x>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[m&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(as,{className:"w-4 h-4"}),m?"Consultando IA...":"Obtener subtareas"]}),m&&e.jsx(oa,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado"}),d&&e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(d),kt.success("Texto copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Ar,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx(vt,{readOnly:!0,value:d||(m?"Generando subtareas...":"Las subtareas aparecerán aquí después de generar"),className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0",placeholder:"Las subtareas aparecerán aquí..."}),d&&e.jsx("div",{className:"mt-3 flex-shrink-0",children:e.jsx(F,{type:"button",className:"w-full",onClick:()=>{s(d),kt.success("Subtareas insertadas en descripción"),i(!1),u("")},variant:"default",children:"📝 Insertar en descripción"})})]})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"💡 Tip: Describe tu tarea con detalle para obtener mejores subtareas"}),!v]})})]})})]})},Ca=dr("task"),B4=Ca?`https://generativelanguage.googleapis.com/v1beta/models/${Ca.model}:generateContent`:"",W4=({title:t,description:n,onInsert:s})=>{var N;const[r,i]=f.useState(!1),[o,c]=f.useState(""),[d,u]=f.useState(""),[m,p]=f.useState(!1),[x,g]=f.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",j=((N=Ca==null?void 0:Ca.prompts)==null?void 0:N.improveDescription)??"Mejora la descripción de la tarea sin cambiar su esencia. Si no hay descripción, genera una basada en el título (máx. 150 palabras).",b=Ca==null?void 0:Ca.params;f.useEffect(()=>{r&&c(`${j}
Título: ${t}
Descripción actual: ${n||"N/A"}`)},[r,t,n]),f.useEffect(()=>{g(ur(o))},[o]);const y=async()=>{var S,E,T,k,M;if(t){p(!0);try{const I=await(await fetch(`${B4}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:o}]}],...b})})).json(),O=(M=(k=(T=(E=(S=I==null?void 0:I.candidates)==null?void 0:S[0])==null?void 0:E.content)==null?void 0:T.parts)==null?void 0:k[0])==null?void 0:M.text;u(O||"No se pudo obtener sugerencia")}catch{u("Error al consultar la API")}finally{p(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"})," Mejorar descripción"]}),e.jsx(yt,{open:r,onOpenChange:i,children:e.jsxs(xt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(bt,{className:"flex-shrink-0",children:[e.jsx(jt,{className:"text-xl",children:"Mejorar Descripción con IA"}),e.jsx(mn,{children:"La IA mejorará la descripción de tu tarea sin cambiar su esencia. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(vt,{value:o,onChange:S=>c(S.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Escribe o modifica el prompt para la IA..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",x]}),x>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:y,disabled:m||!v||x>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[m&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(as,{className:"w-4 h-4"}),m?"Consultando IA...":"Obtener descripción"]}),m&&e.jsx(oa,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado"}),d&&e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(d),kt.success("Texto copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Ar,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx(vt,{readOnly:!0,value:d||(m?"Generando descripción mejorada...":"La descripción mejorada aparecerá aquí después de generar"),className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0",placeholder:"La descripción mejorada aparecerá aquí..."}),d&&e.jsx("div",{className:"mt-3 flex-shrink-0",children:e.jsx(F,{type:"button",className:"w-full",onClick:()=>{s(d),kt.success("Descripción insertada"),i(!1),u("")},variant:"default",children:"📝 Insertar en descripción"})})]})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"💡 Tip: La IA mantendrá la esencia de tu tarea mientras mejora la claridad"}),!v]})})]})})]})},Ea=dr("task"),H4=Ea?`https://generativelanguage.googleapis.com/v1beta/models/${Ea.model}:generateContent`:"",U4=({title:t,description:n,onInsert:s})=>{var N;const[r,i]=f.useState(!1),[o,c]=f.useState(""),[d,u]=f.useState(""),[m,p]=f.useState(!1),[x,g]=f.useState(0),v="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",j=((N=Ea==null?void 0:Ea.prompts)==null?void 0:N.ideas)??"Sugiere ejemplos o estrategias breves para abordar la tarea. Máximo 150 palabras.",b=Ea==null?void 0:Ea.params;f.useEffect(()=>{r&&c(`${j}
Título: ${t}
Descripción: ${n}`)},[r,t,n]),f.useEffect(()=>{g(ur(o))},[o]);const y=async()=>{var S,E,T,k,M;if(t){p(!0);try{const I=await(await fetch(`${H4}?key=${v}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:o}]}],...b})})).json(),O=(M=(k=(T=(E=(S=I==null?void 0:I.candidates)==null?void 0:S[0])==null?void 0:E.content)==null?void 0:T.parts)==null?void 0:k[0])==null?void 0:M.text;u(O||"No se pudo obtener sugerencia")}catch{u("Error al consultar la API")}finally{p(!1)}}};return e.jsxs(e.Fragment,{children:[e.jsxs(F,{type:"button",variant:"outline",size:"sm",onClick:()=>i(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"})," Ideas"]}),e.jsx(yt,{open:r,onOpenChange:i,children:e.jsxs(xt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(bt,{className:"flex-shrink-0",children:[e.jsx(jt,{className:"text-xl",children:"Ideas para la Tarea con IA"}),e.jsx(mn,{children:"La IA te sugerirá ejemplos y estrategias para abordar tu tarea. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(vt,{value:o,onChange:S=>c(S.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Escribe o modifica el prompt para la IA..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",x]}),x>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:y,disabled:m||!v||x>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[m&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(as,{className:"w-4 h-4"}),m?"Consultando IA...":"Obtener ideas"]}),m&&e.jsx(oa,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado"}),d&&e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(d),kt.success("Texto copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Ar,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx(vt,{readOnly:!0,value:d||(m?"Generando ideas...":"Las ideas aparecerán aquí después de generar"),className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0",placeholder:"Las ideas aparecerán aquí..."}),d&&e.jsx("div",{className:"mt-3 flex-shrink-0",children:e.jsx(F,{type:"button",className:"w-full",onClick:()=>{s(d),kt.success("Ideas insertadas en descripción"),i(!1),u("")},variant:"default",children:"📝 Insertar en descripción"})})]})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"💡 Tip: Sé específico sobre el contexto de tu tarea para mejores ideas"}),!v]})})]})})]})},hm=({value:t,onChange:n,showClearButton:s=!1,label:r="Fecha límite"})=>{const i=c=>Oe(c),o=c=>{const[d,u,m]=c.split("-").map(Number),p=new Date;return p.setFullYear(d,u-1,m),p.setHours(12,0,0,0),p};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Nn,{className:"w-4 h-4"}),r]}),s&&t&&e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>n(void 0),children:"Quitar fecha"})]}),e.jsx(Ve,{type:"date",value:t?i(t):"",onChange:c=>{if(!c.target.value){n(void 0);return}const d=o(c.target.value);n(d)}})]})},V4=({value:t,onChange:n})=>{const s=Object.values(sp);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Zv,{className:"w-4 h-4"}),"Categoría"]}),e.jsxs(ft,{value:t,onValueChange:r=>n(r),children:[e.jsx(ct,{children:e.jsx(pt,{placeholder:"Selecciona una categoría",children:nr[t]})}),e.jsx(dt,{children:s.map(r=>e.jsx(De,{value:r,children:nr[r]},r))})]})]})},G4=({value:t,onChange:n})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Sr,{className:"w-4 h-4"}),"Tiempo estimado (min)"]}),e.jsx(Ve,{type:"number",min:"0",placeholder:"Ej. 30",value:t??"",onChange:s=>{const r=s.target.value;n(r===""?void 0:Number(r))}})]}),xm="none",q4=({value:t,onChange:n})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(Sr,{className:"w-4 h-4"}),"Momento del día"]}),e.jsxs(ft,{value:t||xm,onValueChange:s=>n(s===xm?void 0:s),children:[e.jsx(ct,{children:e.jsx(pt,{placeholder:"Sin asignar",children:t?ef[t]:"Sin asignar"})}),e.jsxs(dt,{children:[Object.values(k4).map(s=>e.jsx(De,{value:s,children:ef[s]},s)),e.jsx(De,{value:xm,children:"Sin asignar"})]})]})]}),ej=({initialDate:t,initialConfig:n}={})=>{const[s,r]=f.useState(t||new Date),[i,o]=f.useState(n),c=(m,p)=>p?dR(m,p.pattern,p.customDays):m;return{date:s,setDate:r,config:i,setConfig:o,calculateNextDate:c,getRecurrenceText:(m,p)=>p?R0(m,p.pattern,p.customDays):"",updateRecurrenceConfig:(m,p)=>{const x={pattern:m,frequency:1,...m==="custom"&&{customDays:p||1}};o(x),r(c(new Date,x))},formatDateForInput:$m}},Y4=({isRecurrent:t,onRecurrentChange:n,config:s,onConfigChange:r})=>{const{getRecurrenceText:i}=ej({initialConfig:s}),o=c=>{const d={...s||{},frequency:1,pattern:c,...c==="custom"&&{customDays:(s==null?void 0:s.customDays)||1}};r(d)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(As,{id:"isRecurrent",checked:t,onCheckedChange:c=>{n(c)}}),e.jsx("label",{htmlFor:"isRecurrent",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Tarea recurrente"})]}),t&&s&&e.jsxs("div",{className:"pl-6 space-y-4",children:[e.jsxs(ft,{value:s.pattern,onValueChange:c=>o(c),children:[e.jsx(ct,{className:"w-full",children:e.jsx(pt,{placeholder:"Selecciona frecuencia"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"daily",children:"Diariamente"}),e.jsx(De,{value:"weekly",children:"Semanalmente"}),e.jsx(De,{value:"monthly",children:"Mensualmente"}),e.jsx(De,{value:"custom",children:"Personalizado"})]})]}),s.pattern==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{type:"number",min:"1",value:s.customDays,onChange:c=>{const d=parseInt(c.target.value);d>0&&r({...s,customDays:d})},className:"w-24"}),e.jsx("span",{className:"text-sm text-gray-500",children:"días"})]}),s&&e.jsx("div",{className:"text-sm text-blue-600",children:i(new Date,s)})]})]})},kl=({isOpen:t,onClose:n,onConfirm:s,task:r,mode:i})=>{const{calculateNextDate:o}=ej({initialConfig:r.recurrence,initialDate:r.dueDate}),[c,d]=f.useState(()=>i==="create"?{title:"",description:"",category:"personal",isRecurrent:!1,isPrivate:r.isPrivate||!1,priority:"delete",size:"pequeña",estimatedTime:void 0,timeOfDay:void 0}:{title:r.title||"",description:r.description||"",dueDate:i==="complete"?o(new Date,r.recurrence):r.dueDate||void 0,isRecurrent:r.isRecurrent??!1,isPrivate:r.isPrivate??!1,category:r.category||"personal",recurrence:r.recurrence,priority:r.priority||"delete",size:r.size||"pequeña",estimatedTime:r.estimatedTime,timeOfDay:r.timeOfDay}),[u,m]=f.useState(()=>r.priority==="do"||r.priority==="delegate"),[p,x]=f.useState(()=>r.priority==="do"||r.priority==="decide"),[g,v]=f.useState(r.size||"pequeña");f.useEffect(()=>{t&&(i==="create"?(d({title:"",description:"",category:"personal",isRecurrent:!1,isPrivate:r.isPrivate||!1,priority:"delete",size:"pequeña",estimatedTime:void 0,timeOfDay:void 0}),m(!1),x(!1),v("pequeña")):(d({title:r.title||"",description:r.description||"",dueDate:i==="complete"?o(new Date,r.recurrence):r.dueDate||void 0,isRecurrent:r.isRecurrent||!1,isPrivate:r.isPrivate||!1,category:r.category||"personal",recurrence:r.recurrence,priority:r.priority||"delete",size:r.size||"pequeña",estimatedTime:r.estimatedTime,timeOfDay:r.timeOfDay}),m(r.priority==="do"||r.priority==="delegate"),x(r.priority==="do"||r.priority==="decide"),v(r.size||"pequeña")))},[r,i,t]);const j=()=>{if(!c.title.trim())return;const y=u&&p?"do":p?"decide":u?"delegate":"delete";i==="create"?(c.title.split(`
`).map(S=>S.trim()).filter(Boolean).forEach(S=>{s({...c,title:S,priority:y,size:g})}),n()):s({...c,priority:y,size:g})},b=()=>{switch(i){case"create":return"Nueva Tarea";case"edit":return"Editar Tarea";case"complete":return"Completar Tarea";default:return""}};return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"max-w-[95vw] w-[95vw] max-h-[90vh] h-[80vh] overflow-y-auto sm:max-w-[90vw] sm:w-[90vw] lg:max-w-[85vw] lg:w-[85vw]",children:[e.jsxs(bt,{children:[e.jsx(jt,{children:b()}),i==="complete"&&e.jsx(mn,{children:r.title})]}),e.jsxs("div",{className:"grid gap-6 py-4 lg:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[i!=="complete"&&e.jsx(L4,{multiline:i==="create",value:c.title,onChange:y=>d({...c,title:y})}),e.jsx($4,{value:c.description||"",onChange:y=>d({...c,description:y})}),i==="edit"&&e.jsxs(e.Fragment,{children:[e.jsx(F4,{title:c.title,description:c.description||"",onInsert:y=>d({...c,description:(c.description?c.description+`
`:"")+y})}),e.jsx(W4,{title:c.title,description:c.description||"",onInsert:y=>d({...c,description:(c.description?c.description+`
`:"")+y})}),e.jsx(U4,{title:c.title,description:c.description||"",onInsert:y=>d({...c,description:(c.description?c.description+`
`:"")+y})})]})]}),e.jsxs("div",{className:"space-y-6",children:[i!=="complete"&&e.jsx(V4,{value:c.category,onChange:y=>d({...c,category:y})}),i==="edit"?e.jsx(hm,{value:c.dueDate,onChange:y=>d({...c,dueDate:y}),showClearButton:!0}):i==="create"?e.jsx(hm,{value:c.dueDate,onChange:y=>d({...c,dueDate:y}),showClearButton:!0}):r.isRecurrent&&e.jsx(hm,{value:c.dueDate,onChange:y=>d({...c,dueDate:y}),label:"Próxima fecha"}),i!=="complete"&&e.jsx(q4,{value:c.timeOfDay,onChange:y=>d({...c,timeOfDay:y})}),i!=="complete"&&e.jsx(Y4,{isRecurrent:c.isRecurrent??!1,onRecurrentChange:y=>d({...c,isRecurrent:y,recurrence:y?{pattern:"daily",frequency:1}:void 0}),config:c.recurrence,onConfigChange:y=>d({...c,recurrence:y})}),i!=="complete"&&e.jsx(G4,{value:c.estimatedTime,onChange:y=>d({...c,estimatedTime:y})}),i!=="complete"&&e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(As,{checked:u,onCheckedChange:y=>m(!!y)}),"Urgente"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(As,{checked:p,onCheckedChange:y=>x(!!y)}),"Importante"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(As,{checked:c.isPrivate??!1,onCheckedChange:y=>d({...c,isPrivate:!!y})}),"🔒 Privada (solo en Journal)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Tamaño"}),e.jsxs(ft,{value:g,onValueChange:y=>v(y),children:[e.jsx(ct,{className:"h-8 w-28",children:e.jsx(pt,{placeholder:"Tamaño"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"pequeña",children:"pequeña"}),e.jsx(De,{value:"mediana",children:"mediana"}),e.jsx(De,{value:"grande",children:"grande"})]})]})]})]})]})]}),e.jsxs(en,{children:[e.jsx(F,{variant:"outline",onClick:n,children:"Cancelar"}),e.jsx(F,{onClick:j,disabled:!c.title.trim(),children:i==="complete"?"Completar":i==="create"?"Crear":"Guardar cambios"})]})]})})},_l=()=>{const[t,n]=f.useState([]),[s,r]=f.useState("idle"),[i,o]=f.useState(null),[c,d]=f.useState(!1),[u,m]=f.useState(null),[p,x]=f.useState("create"),{user:g}=He(),v=()=>t.filter(I=>!I.isPrivate),j=f.useCallback(()=>{d(!1),m(null),r("idle"),o(null),x("create")},[]),b=f.useCallback(async()=>{if(g){r("loading"),o(null);try{Gt.logRead("tasks","useTaskData.loadTasks");const I=_r($t(fe,"tasks"),un("userId","==",g.uid)),H=(await Wi(I)).docs.map($=>{var P,K;const D=$.data();return{id:$.id,title:D.title,description:D.description||"",completed:D.completed,createdAt:D.createdAt,dueDate:(P=D.dueDate)==null?void 0:P.toDate(),isRecurrent:D.isRecurrent||!1,isPrivate:D.isPrivate||!1,category:D.category||"other",priority:D.priority||"delete",size:D.size||"pequeña",estimatedTime:D.estimatedTime,timeOfDay:D.timeOfDay,elapsedSeconds:D.elapsedSeconds||0,progress:typeof D.progress=="number"?D.progress:zo(D.description||""),recurrence:D.recurrence?{frequency:D.recurrence.frequency,pattern:D.recurrence.pattern,customDays:D.recurrence.customDays,nextDate:(K=D.recurrence.nextDate)==null?void 0:K.toDate()}:void 0}}).filter($=>!$.completed).sort(($,D)=>{var P,K;return $.dueDate&&D.dueDate?$.dueDate.getTime()-D.dueDate.getTime():$.dueDate?-1:D.dueDate?1:(((P=D.createdAt)==null?void 0:P.seconds)||0)-(((K=$.createdAt)==null?void 0:K.seconds)||0)});n(H),r("saved")}catch(I){console.error("Error loading tasks:",I),o(I instanceof Error?I.message:"Error loading tasks"),r("error")}}},[g]);f.useEffect(()=>{b()},[b]);const y=async I=>{var O;if(!(!I.title.trim()||!g)){r("saving"),o(null);try{const H={userId:g.uid,title:I.title.trim(),completed:!1,createdAt:lt(),category:I.category||"other",priority:I.priority||"delete",size:I.size||"pequeña",elapsedSeconds:0,...I.timeOfDay&&{timeOfDay:I.timeOfDay},...I.estimatedTime!==void 0&&{estimatedTime:I.estimatedTime}};H.progress=zo(I.description||""),(O=I.description)!=null&&O.trim()&&(H.description=I.description.trim()),I.dueDate&&(H.dueDate=Bo.fromDate(I.dueDate)),I.isPrivate&&(H.isPrivate=!0),I.isRecurrent&&I.recurrence&&(H.isRecurrent=!0,H.recurrence={frequency:I.recurrence.frequency,pattern:I.recurrence.pattern},I.recurrence.pattern==="custom"&&I.recurrence.customDays&&(H.recurrence.customDays=I.recurrence.customDays)),Gt.logWrite("tasks","useTaskData.addTask"),await Jo($t(fe,"tasks"),H),await b()}catch(H){console.error("Error al guardar:",H),o(H instanceof Error?H.message:"Error al guardar"),r("error")}}},N=async(I,O)=>{var H;if(g){r("saving");try{const $=be(fe,"tasks",I),D={updatedAt:lt()};(H=O.title)!=null&&H.trim()&&(D.title=O.title.trim()),typeof O.description=="string"&&(D.description=O.description.trim()||null),O.dueDate!==void 0&&(D.dueDate=O.dueDate?Bo.fromDate(O.dueDate):null),O.category&&(D.category=O.category),O.priority&&(D.priority=O.priority),O.size&&(D.size=O.size),O.estimatedTime!==void 0&&(D.estimatedTime=O.estimatedTime),O.timeOfDay&&(D.timeOfDay=O.timeOfDay),O.isPrivate!==void 0&&(D.isPrivate=O.isPrivate),O.isRecurrent!==void 0&&(D.isRecurrent=O.isRecurrent,O.isRecurrent||(D.recurrence=null)),O.recurrence&&(D.recurrence={frequency:O.recurrence.frequency,pattern:O.recurrence.pattern},O.recurrence.pattern==="custom"&&O.recurrence.customDays&&(D.recurrence.customDays=O.recurrence.customDays));const P=t.find(K=>K.id===I);D.progress=zo(typeof O.description=="string"?O.description:(P==null?void 0:P.description)||""),Gt.logWrite("tasks","useTaskData.editTask",I),await jn($,D),await b(),j()}catch($){console.error("Error al actualizar:",$),o($ instanceof Error?$.message:"Error al actualizar"),r("error")}}},S=async(I,O)=>{if(g){r("saving");try{const H=t.find($=>$.id===I);if(!H)throw new Error("Tarea no encontrada");if(!H.isRecurrent){const $=be(fe,"tasks",I);Gt.logWrite("tasks","useTaskData.toggleTask",I),await jn($,{completed:O,updatedAt:lt()}),await b();return}m(H),x("complete"),d(!0)}catch(H){console.error("Error al actualizar estado:",H),o(H instanceof Error?H.message:"Error al actualizar"),r("error")}}},E=async I=>{if(g){r("saving");try{Gt.logDelete("tasks","useTaskData.deleteTask",I),await ci(be(fe,"tasks",I)),await b()}catch(O){console.error("Error al eliminar:",O),o(O instanceof Error?O.message:"Error al eliminar"),r("error")}}},T=async I=>{var O,H,$,D,P;if(!(!u||!g)){r("saving");try{const K=be(fe,"tasks",u.id);Gt.logWrite("tasks","useTaskData.completeRecurrentTask",u.id),await jn(K,{completed:!0,updatedAt:lt()});const X={userId:g.uid,title:u.title,completed:!1,createdAt:lt(),elapsedSeconds:0,dueDate:I.dueDate?Bo.fromDate(I.dueDate):null,isRecurrent:!0,category:u.category,priority:u.priority||"delete",size:u.size||"pequeña",...I.timeOfDay&&{timeOfDay:I.timeOfDay},recurrence:{pattern:((O=u.recurrence)==null?void 0:O.pattern)||"daily",frequency:((H=u.recurrence)==null?void 0:H.frequency)||1,...(($=u.recurrence)==null?void 0:$.pattern)==="custom"&&{customDays:u.recurrence.customDays}}};((D=I.description)!=null&&D.trim()||u.description)&&(X.description=((P=I.description)==null?void 0:P.trim())||u.description),X.progress=zo(X.description||""),Gt.logWrite("tasks","useTaskData.completeRecurrentTask.next"),await Jo($t(fe,"tasks"),X),await b(),j()}catch(K){console.error("Error al procesar tarea recurrente:",K),o(K instanceof Error?K.message:"Error al actualizar tarea recurrente"),r("error")}}},k=f.useCallback((I,O)=>{x("create"),m({id:"",title:"",completed:!1,category:"personal",priority:"delete",size:"pequeña",createdAt:{seconds:Date.now()/1e3},...I?{dueDate:I}:{},...O?{isPrivate:!0}:{},timeOfDay:void 0,progress:0}),d(!0)},[]),M=I=>{m(I),x("edit"),d(!0),r("idle")},R=Rr("Task data");return{tasks:v(),allTasks:t,status:s,error:i,showRecurrenceModal:c,currentTask:u,modalMode:p,addTask:y,editTask:N,toggleTask:S,deleteTask:E,completeRecurrentTask:T,setShowRecurrenceModal:j,openEditModal:M,openCreateModal:k,getPublicTasks:v,loadTasks:b,resync:R}},K4=({selectedDate:t})=>{const{allTasks:n,status:s,error:r,showRecurrenceModal:i,currentTask:o,modalMode:c,addTask:d,editTask:u,toggleTask:m,deleteTask:p,completeRecurrentTask:x,setShowRecurrenceModal:g,openEditModal:v,openCreateModal:j}=_l(),[b,y]=f.useState(null),[N,S]=f.useState(!1),[E,T]=f.useState(""),[k,M]=f.useState(!1),R=n.filter(P=>P.isPrivate),I=R.filter(P=>P.dueDate&&Bs(P.dueDate,t)),O=R.filter(P=>!P.completed&&(!P.dueDate||!Bs(P.dueDate,t))),H=()=>{j(t,!0)},$=()=>{try{const P=JSON.parse(E);if(!Array.isArray(P)){kt.error("El JSON debe contener un array de tareas");return}let K=0,X=0;P.forEach(G=>{if(G.title){let U;if(G.dueDate){const Y=new Date(G.dueDate);isNaN(Y.getTime())?(X++,console.warn(`Fecha inválida para tarea "${G.title}": ${G.dueDate}`)):U=Y}d({title:G.title,description:G.description||"",dueDate:U,category:G.category||"personal",priority:G.priority||void 0,isPrivate:!0,isRecurrent:G.isRecurrent||!1,size:G.size||void 0}),K++}}),X>0?kt.warning(`${K} tareas importadas. ${X} fechas inválidas fueron omitidas.`):kt.success(`${K} tareas privadas importadas correctamente`),T(""),M(!1)}catch(P){kt.error("Error al importar las tareas. Verifica el formato JSON."),console.error("Error de importación:",P)}},D=()=>{const P=R.map(X=>{var G,U;return{title:X.title,description:X.description||"",dueDate:(G=X.dueDate)==null?void 0:G.toISOString(),category:X.category,priority:X.priority,size:X.size,completed:X.completed,isRecurrent:X.isRecurrent||!1,...X.recurrence&&{recurrence:{frequency:X.recurrence.frequency,pattern:X.recurrence.pattern,customDays:X.recurrence.customDays,nextDate:(U=X.recurrence.nextDate)==null?void 0:U.toISOString()}}}}),K=JSON.stringify(P,null,2);navigator.clipboard.writeText(K).then(()=>{kt.success("Tareas privadas copiadas al portapapeles con fechas incluidas")})};return e.jsxs(je,{className:"w-full mt-4",children:[e.jsx(Mt,{children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Lt,{className:"text-lg",children:"🔒 Tareas Privadas"}),e.jsxs(jr,{variant:"secondary",className:"text-xs",children:[R.length," total"]})]})})}),e.jsxs(we,{className:"space-y-4",children:[I.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-gray-600 mb-2",children:["Para hoy (",I.length,")"]}),e.jsx("div",{className:"space-y-2",children:I.map(P=>e.jsx($i,{task:P,onDelete:p,onEdit:v,onView:K=>{y(K),S(!0)},variant:"list"},P.id))})]}),O.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-gray-600 mb-2",children:["Pendientes (",O.length,")"]}),e.jsx("div",{className:"space-y-2",children:O.map(P=>e.jsx($i,{task:P,onDelete:p,onEdit:v,onView:K=>{y(K),S(!0)},variant:"list"},P.id))})]}),R.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No tienes tareas privadas"}),e.jsx("p",{className:"text-sm",children:"Crea una nueva o importa desde JSON"})]}),s==="saving"&&e.jsx(jr,{variant:"secondary",className:"text-xs",children:"Guardando..."}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r})]}),e.jsxs(Xs,{className:"justify-end flex-wrap gap-2",children:[e.jsxs(yt,{open:k,onOpenChange:M,children:[e.jsx($0,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",children:[e.jsx(Oi,{className:"w-4 h-4 mr-2"}),"Importar"]})}),e.jsxs(xt,{children:[e.jsxs(bt,{children:[e.jsx(jt,{children:"Importar Tareas Privadas"}),e.jsx(mn,{children:"Pega el JSON con las tareas a importar. Todas se marcar\\u00e1n como privadas."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(vt,{placeholder:`Ejemplo - Puedes incluir fechas en formato ISO (YYYY-MM-DD) o dejarlas sin fecha:
[
  {
    "title": "Reflexión personal importante",
    "description": "Pensar sobre mis metas de vida",
    "dueDate": "2024-12-31",
    "category": "personal",
    "priority": "do",
    "size": "mediana"
  },
  {
    "title": "Tarea sensible del trabajo",
    "description": "Revisar tema confidencial",
    "dueDate": "2024-06-15T14:30:00Z",
    "category": "work",
    "priority": "decide"
  },
  {
    "title": "Tarea sin fecha específica",
    "description": "Esta tarea no tiene fecha límite",
    "category": "personal"
  }
]

Formatos de fecha soportados:
- "2024-12-31" (solo fecha)
- "2024-06-15T14:30:00Z" (fecha y hora ISO)
- "2024-06-15T14:30:00" (fecha y hora local)
- Sin campo "dueDate" = sin fecha asignada`,value:E,onChange:P=>T(P.target.value),rows:15,className:"font-mono text-sm"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(F,{variant:"outline",onClick:()=>M(!1),children:"Cancelar"}),e.jsx(F,{onClick:$,disabled:!E.trim(),children:"Importar Tareas"})]})]})]})]}),e.jsxs(F,{size:"sm",variant:"outline",onClick:D,children:[e.jsx(Fn,{className:"w-4 h-4 mr-2"}),"Exportar"]}),e.jsxs(F,{size:"sm",onClick:H,children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Nueva Privada"]})]}),e.jsx(kl,{isOpen:i,onClose:()=>g(),onConfirm:P=>{const K={...P,isPrivate:!0};c==="complete"?x(K):c==="edit"?u(o.id,K):d(K)},task:o||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:c}),e.jsx(Id,{task:b,isOpen:N,onClose:()=>S(!1),onEdit:P=>{S(!1),v(P)},onToggle:m})]})},J4=t=>t.charAt(0).toUpperCase()+t.slice(1),X4=({open:t,onOpenChange:n})=>{const{user:s}=He(),[r,i]=f.useState("config"),[o,c]=f.useState("thisWeek"),[d,u]=f.useState(new Date),[m,p]=f.useState(new Date),[x,g]=f.useState({includeJournal:!0,includeMoods:!0,includeEnergy:!0,includePrivateTasks:!0}),[v,j]=f.useState(!1),b=(R,I)=>{g(O=>({...O,[R]:I}))},y=()=>{const R=new Date;if(o==="thisWeek")return{start:Cr(R,{weekStartsOn:1}),end:$n(R,{weekStartsOn:1})};if(o==="lastWeek"){const I=Ok(R,1);return{start:Cr(I,{weekStartsOn:1}),end:$n(I,{weekStartsOn:1})}}else return{start:d,end:m}},N=async(R,I)=>{if(!s)return{journals:[],moods:[],energy:[],privateTasks:[]};const O=[],H=[],$=[];for(let P=new Date(R);P<=I;P.setDate(P.getDate()+1)){const K=Oe(P);if(x.includeJournal){const X=be(fe,"journal",`${s.uid}_${K}`),G=await ds(X);G.exists()&&O.push({userId:s.uid,text:G.data().text||"",date:K,lastUpdated:G.data().lastUpdated||new Date,displayTime:G.data().displayTime||""})}if(x.includeMoods){const X=be(fe,"moods",`${s.uid}_${K}`),G=await ds(X);G.exists()&&H.push(G.data())}if(x.includeEnergy){const X=be(fe,"energy",`${s.uid}_${K}`),G=await ds(X);G.exists()&&$.push(G.data())}}let D=[];if(x.includePrivateTasks){const P=_r($t(fe,"tasks"),un("userId","==",s.uid),un("isPrivate","==",!0));D=(await Wi(P)).docs.map(X=>({id:X.id,...X.data()})).filter(X=>{var ye;if(!((ye=X.createdAt)!=null&&ye.seconds))return!1;const G=new Date(X.createdAt.seconds*1e3),U=Oe(G),Y=Oe(R),ae=Oe(I);return U>=Y&&U<=ae})}return{journals:O,moods:H,energy:$,privateTasks:D}},S=async()=>{if(!s)return;const{start:R,end:I}=y(),{journals:O,moods:H,energy:$,privateTasks:D}=await N(R,I);let P=`# Diario del ${Pt(R,"dd MMMM yyyy",{locale:Ln})} al ${Pt(I,"dd MMMM yyyy",{locale:Ln})}

`;for(let U=new Date(R);U<=I;U.setDate(U.getDate()+1)){const Y=Oe(U),ae=Pt(U,"EEEE, d 'de' MMMM 'de' yyyy",{locale:Ln});P+=`### ${J4(ae)}

`;let ye=!1;if(x.includeMoods){const oe=H.find(me=>me.date===Y);oe!=null&&oe.moods&&oe.moods.length>0&&(P+=`**Estados de ánimo:**
`,oe.moods.forEach(me=>{P+=`- ${me.time}: ${me.emoji} ${me.text}
`}),P+=`
`,ye=!0)}if(x.includeEnergy){const oe=$.find(me=>me.date===Y);oe!=null&&oe.entries&&oe.entries.length>0&&(P+=`**Niveles de energía:**
`,oe.entries.forEach(me=>{const W=me.comment?` - ${me.comment}`:"";P+=`- ${me.time}: Nivel ${me.level}/5${W}
`}),P+=`
`,ye=!0)}if(x.includePrivateTasks){const oe=D.filter(me=>{var se;if(!((se=me.createdAt)!=null&&se.seconds))return!1;const W=new Date(me.createdAt.seconds*1e3);return Oe(W)===Y});oe.length>0&&(P+=`**Tareas privadas:**
`,oe.forEach(me=>{const W=me.completed?"✅":"◯",se=me.description?` - ${me.description}`:"";P+=`- ${W} ${me.title}${se}
`}),P+=`
`,ye=!0)}if(x.includeJournal){const oe=O.find(me=>me.date===Y);oe!=null&&oe.text&&oe.text.trim()&&(P+=`**Diario:**
${oe.text}

`,ye=!0)}ye||(P+=`_Sin entradas para este día_

`)}const K=new Blob([P],{type:"text/markdown;charset=utf-8"}),X=URL.createObjectURL(K),G=document.createElement("a");G.href=X,G.download=`${Oe(R)}_a_${Oe(I)}.md`,document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(X)},E=async()=>{j(!0),i("processing");try{await S(),setTimeout(()=>{T()},1e3)}catch(R){console.error("Error exporting:",R)}finally{j(!1)}},T=()=>{i("config"),j(!1),n(!1)},k=()=>Object.values(x).some(Boolean),M=()=>{const{start:R,end:I}=y();return`${Pt(R,"dd/MM/yyyy")} - ${Pt(I,"dd/MM/yyyy")}`};return e.jsx(yt,{open:t,onOpenChange:T,children:e.jsxs(xt,{className:"max-w-lg",children:[e.jsx(bt,{children:e.jsxs(jt,{className:"flex items-center gap-2",children:[e.jsx(Fn,{className:"w-5 h-5"}),"Exportar Diario"]})}),r==="config"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(je,{children:[e.jsx(Mt,{className:"pb-3",children:e.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[e.jsx(Nn,{className:"w-4 h-4"}),"Rango de fechas"]})}),e.jsxs(we,{className:"space-y-3",children:[e.jsxs(ft,{value:o,onValueChange:R=>c(R),children:[e.jsx(ct,{className:"w-full",children:e.jsx(pt,{placeholder:"Seleccionar rango"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"thisWeek",children:"Esta semana"}),e.jsx(De,{value:"lastWeek",children:"Semana pasada"}),e.jsx(De,{value:"custom",children:"Rango personalizado"})]})]}),o==="custom"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",className:"border rounded-md px-2 py-1 flex-1 text-sm",value:$m(d),onChange:R=>u(new Date(R.target.value)),placeholder:"Fecha de inicio",title:"Fecha de inicio"}),e.jsx("input",{type:"date",className:"border rounded-md px-2 py-1 flex-1 text-sm",value:$m(m),onChange:R=>p(new Date(R.target.value)),placeholder:"Fecha de fin",title:"Fecha de fin"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Exportando: ",M()]})]})]}),e.jsxs(je,{children:[e.jsx(Mt,{className:"pb-3",children:e.jsx(Lt,{className:"text-sm",children:"Contenido a incluir"})}),e.jsx(we,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(As,{id:"journal",checked:x.includeJournal,onCheckedChange:R=>b("includeJournal",!!R),className:"mt-1"}),e.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[e.jsx(ld,{className:"w-4 h-4 mt-1 text-gray-600"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"journal",className:"text-sm font-medium cursor-pointer block",children:"Entradas del diario"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Contenido textual del diario personal"})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(As,{id:"moods",checked:x.includeMoods,onCheckedChange:R=>b("includeMoods",!!R),className:"mt-1"}),e.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[e.jsx(m_,{className:"w-4 h-4 mt-1 text-gray-600"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"moods",className:"text-sm font-medium cursor-pointer block",children:"Estados de ánimo"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Emociones registradas con hora y emoji"})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(As,{id:"energy",checked:x.includeEnergy,onCheckedChange:R=>b("includeEnergy",!!R),className:"mt-1"}),e.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[e.jsx(f_,{className:"w-4 h-4 mt-1 text-gray-600"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"energy",className:"text-sm font-medium cursor-pointer block",children:"Niveles de energía"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Registros de energía del 1-5 con comentarios"})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(As,{id:"tasks",checked:x.includePrivateTasks,onCheckedChange:R=>b("includePrivateTasks",!!R),className:"mt-1"}),e.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[e.jsx(hf,{className:"w-4 h-4 mt-1 text-gray-600"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"tasks",className:"text-sm font-medium cursor-pointer block",children:"Tareas privadas"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Tareas marcadas como privadas"})]})]})]})]})})]})]}),r==="processing"&&e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generando archivo markdown..."})]}),e.jsx(en,{className:"gap-2",children:r==="config"&&e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"outline",onClick:T,children:"Cancelar"}),e.jsxs(F,{onClick:E,disabled:!k()||v,className:"flex items-center gap-2",children:[e.jsx(Fn,{className:"w-4 h-4"}),"Exportar"]})]})})]})})},Oo=({title:t,tasks:n,onDelete:s,onEdit:r,onView:i})=>{if(n.length===0)return null;const o={do:0,decide:1,delegate:2,delete:3},c=n.sort((d,u)=>{var x,g;const m=o[d.priority||"none"]??4,p=o[u.priority||"none"]??4;return m!==p?m-p:d.dueDate&&u.dueDate?d.dueDate.getTime()-u.dueDate.getTime():!d.dueDate&&!u.dueDate?(((x=u.createdAt)==null?void 0:x.seconds)||0)-(((g=d.createdAt)==null?void 0:g.seconds)||0):d.dueDate?-1:1});return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-500 uppercase tracking-wider pt-4",children:t}),c.map(d=>e.jsx($i,{task:d,onDelete:s,onEdit:r,onView:i,variant:"list"},d.id))]})},Lg={all:"Todas las fechas",today:"Hoy",week:"Esta semana",month:"Este mes",overdue:"Vencidas",noDate:"Sin fecha"},Z4=({tasks:t,onDelete:n,onEdit:s,onView:r})=>{const[i,o]=f.useState("all"),[c,d]=f.useState("all"),[u,m]=f.useState(!1),[p,x]=f.useState(""),g=f.useMemo(()=>{let y=i==="all"?t:t.filter(R=>R.category===i);if(p.trim()){const R=p.toLowerCase().trim();y=y.filter(I=>I.title.toLowerCase().includes(R)||I.description&&I.description.toLowerCase().includes(R))}const N=new Date,S=ys(N),E=Cr(N),T=$n(N),k=_t(N),M=wn(N);switch(c){case"today":return y.filter(R=>R.dueDate&&ni(R.dueDate,{start:S,end:wr(N)}));case"week":return y.filter(R=>R.dueDate&&ni(R.dueDate,{start:E,end:T}));case"month":return y.filter(R=>R.dueDate&&ni(R.dueDate,{start:k,end:M}));case"overdue":return y.filter(R=>R.dueDate&&os(R.dueDate,S));case"noDate":return y.filter(R=>!R.dueDate);default:return y}},[t,i,c,p]),v=f.useMemo(()=>p.trim()!==""||i!=="all"||c!=="all",[p,i,c]),j=()=>{x(""),o("all"),d("all")},b=f.useMemo(()=>{const y=new Date,N=ys(y),S=wr(y),E=$n(y);return g.reduce((T,k)=>(k.dueDate&&os(k.dueDate,N)?T.overdue.push(k):k.dueDate?os(k.dueDate,S)?T.today.push(k):os(k.dueDate,E)?T.thisWeek.push(k):T.future.push(k):T.noDate.push(k),T),{overdue:[],today:[],thisWeek:[],future:[],noDate:[]})},[g]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 items-stretch sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(fd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(Ve,{placeholder:"Buscar tareas por nombre...",value:p,onChange:y=>x(y.target.value),className:"pl-10 pr-10"}),p&&e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>x(""),className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Js,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"md:hidden flex gap-2",children:[e.jsxs(F,{variant:v?"default":"outline",onClick:()=>m(!u),className:`flex items-center gap-2 ${v?"bg-blue-600 hover:bg-blue-700":""}`,children:[e.jsx(bf,{className:"w-4 h-4"}),"Filtros",v&&e.jsx("span",{className:"bg-white text-blue-600 rounded-full px-2 py-0.5 text-xs font-medium",children:"Activos"})]}),v&&e.jsx(F,{variant:"ghost",onClick:j,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Js,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"hidden md:flex",children:v&&e.jsxs(F,{variant:"ghost",onClick:j,className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(Js,{className:"w-4 h-4"}),"Limpiar filtros"]})})]}),"      ",e.jsxs("div",{className:`space-y-4 md:space-y-0 md:flex md:items-center md:gap-4 ${u?"block":"hidden md:flex"}`,children:[e.jsxs("div",{className:"flex-1 space-y-2 md:space-y-0",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium block md:inline md:mr-2",children:"Categoría:"}),e.jsxs(ft,{value:i,onValueChange:y=>o(y),children:[e.jsx(ct,{className:`w-full md:w-[180px] ${i!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:i==="all"?"Todas las categorías":nr[i]})}),e.jsxs(dt,{children:[e.jsx(De,{value:"all",children:"Todas las categorías"}),Object.entries(sp).map(([y,N])=>e.jsx(De,{value:N,children:nr[N]},y))]})]})]}),e.jsxs("div",{className:"flex-1 space-y-2 md:space-y-0",children:[e.jsx("span",{className:"text-sm text-gray-500 font-medium block md:inline md:mr-2",children:"Fecha:"}),e.jsxs(ft,{value:c,onValueChange:y=>d(y),children:[e.jsx(ct,{className:`w-full md:w-[180px] ${c!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:Lg[c]})}),e.jsx(dt,{children:Object.entries(Lg).map(([y,N])=>e.jsx(De,{value:y,children:N},y))})]})]})]}),e.jsxs("div",{children:[e.jsx(Oo,{title:"Tareas Vencidas",tasks:b.overdue,onDelete:n,onEdit:s,onView:r}),e.jsx(Oo,{title:"Para Hoy",tasks:b.today,onDelete:n,onEdit:s,onView:r}),e.jsx(Oo,{title:"Esta Semana",tasks:b.thisWeek,onDelete:n,onEdit:s,onView:r}),e.jsx(Oo,{title:"Próximamente",tasks:b.future,onDelete:n,onEdit:s,onView:r}),e.jsx(Oo,{title:"Sin Fecha",tasks:b.noDate,onDelete:n,onEdit:s,onView:r}),g.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:i==="all"&&c==="all"?"No hay tareas pendientes":"No hay tareas pendientes con los filtros seleccionados"})]})]})},$g={all:"Todas las fechas",today:"Hoy",tomorrow:"Mañana",week:"Esta semana",month:"Este mes",overdue:"Vencidas",noDate:"Sin fecha"},zg={all:"Todas",do:"do",decide:"decide",delegate:"delegate",delete:"delete"},Fg={all:"Todas",none:"Sin tamaño",pequeña:"pequeña",mediana:"mediana",grande:"grande"},Rc={all:"Todas",yes:"Sí",no:"No"},Bg={all:"Todas",t60:"≤1h",t120:"≤2h",t180:"≤3h",none:"Sin estimación"},Wg={default:"Predeterminado",priorityAsc:"Prioridad ↓",priorityDesc:"Prioridad ↑",durationAsc:"Duración ↓",durationDesc:"Duración ↑"},Q4=({tasks:t,onDelete:n,onEdit:s,onView:r,onMove:i,onAdd:o,onFilteredTasksChange:c})=>{const[d,u]=f.useState(null),[m,p]=f.useState("all"),[x,g]=f.useState("today"),[v,j]=f.useState("all"),[b,y]=f.useState("all"),[N,S]=f.useState("all"),[E,T]=f.useState("all"),[k,M]=f.useState("all"),[R,I]=f.useState("default"),[O,H]=f.useState(!1),[$,D]=f.useState(""),P=f.useMemo(()=>{let W=t.filter(le=>!le.isRecurrent&&!le.isPrivate);if($.trim()){const le=$.toLowerCase().trim();W=W.filter(Re=>Re.title.toLowerCase().includes(le)||Re.description&&Re.description.toLowerCase().includes(le))}if(m!=="all"&&(W=W.filter(le=>le.category===m)),v!=="all"&&(W=W.filter(le=>le.priority===v)),b!=="all"&&(b==="none"?W=W.filter(le=>!le.size):W=W.filter(le=>le.size===b)),k!=="all")if(k==="none")W=W.filter(le=>le.estimatedTime===void 0);else{const Re={t60:60,t120:120,t180:180,all:1/0,none:0}[k];W=W.filter(Ke=>(Ke.estimatedTime??1/0)<=Re)}N!=="all"&&(W=W.filter(le=>{const Re=le.priority==="do"||le.priority==="delegate";return N==="yes"?Re:!Re})),E!=="all"&&(W=W.filter(le=>{const Re=le.priority==="do"||le.priority==="decide";return E==="yes"?Re:!Re}));const se=new Date,ge=ys(se),Me=Cr(se),pe=$n(se),_e=_t(se),We=wn(se),Pe=Vt(ge,1),Le=wr(Pe);switch(x){case"today":return W.filter(le=>le.dueDate&&ni(le.dueDate,{start:ge,end:wr(se)}));case"tomorrow":return W.filter(le=>le.dueDate&&ni(le.dueDate,{start:Pe,end:Le}));case"week":return W.filter(le=>le.dueDate&&ni(le.dueDate,{start:Me,end:pe}));case"month":return W.filter(le=>le.dueDate&&ni(le.dueDate,{start:_e,end:We}));case"overdue":return W.filter(le=>le.dueDate&&os(le.dueDate,ge));case"noDate":return W.filter(le=>!le.dueDate);default:return W}},[t,m,v,b,N,E,k,x,$]);f.useEffect(()=>{c==null||c(P)},[P,c]);const K=f.useMemo(()=>$.trim()!==""||m!=="all"||x!=="today"||v!=="all"||b!=="all"||N!=="all"||E!=="all"||k!=="all",[$,m,x,v,b,N,E,k]),X=()=>{D(""),p("all"),g("today"),j("all"),y("all"),S("all"),T("all"),M("all"),I("default")},G=f.useMemo(()=>{const W=new Date,se=ys(W),ge=wr(W),Me=Vt(ys(W),1),pe=wr(Me),_e=$n(W),We={do:0,decide:1,delegate:2,delete:3},Pe=P.reduce((le,Re)=>(Re.dueDate&&os(Re.dueDate,se)?le.overdue.push(Re):Re.dueDate?os(Re.dueDate,ge)?le.today.push(Re):os(Re.dueDate,pe)?le.tomorrow.push(Re):os(Re.dueDate,_e)?le.thisWeek.push(Re):le.future.push(Re):le.noDate.push(Re),le),{overdue:[],today:[],tomorrow:[],thisWeek:[],future:[],noDate:[]}),Le=(le,Re)=>{var z,Z;const Ke=We[le.priority||"none"]??4,Yt=We[Re.priority||"none"]??4,bs=le.estimatedTime??1/0,Dt=Re.estimatedTime??1/0;switch(R){case"priorityAsc":if(Ke!==Yt)return Yt-Ke;break;case"priorityDesc":if(Ke!==Yt)return Ke-Yt;break;case"durationAsc":if(bs!==Dt)return bs-Dt;break;case"durationDesc":if(bs!==Dt)return Dt-bs;break;default:if(Ke!==Yt)return Ke-Yt}return le.dueDate&&Re.dueDate?le.dueDate.getTime()-Re.dueDate.getTime():!le.dueDate&&!Re.dueDate?(((z=Re.createdAt)==null?void 0:z.seconds)||0)-(((Z=le.createdAt)==null?void 0:Z.seconds)||0):le.dueDate?-1:1};return Object.values(Pe).forEach(le=>{le.sort(Le)}),Pe},[P,R]),U=f.useMemo(()=>{const W={overdue:0,today:0,tomorrow:0,thisWeek:0,future:0,noDate:0};return Object.keys(G).forEach(se=>{W[se]=G[se].reduce((ge,Me)=>ge+(Me.estimatedTime||0),0)}),W},[G]),Y=f.useMemo(()=>Object.values(U).reduce((W,se)=>W+se,0),[U]),ae=[{key:"overdue",title:"Vencidas"},{key:"today",title:"Para Hoy"},{key:"tomorrow",title:"Mañana"},{key:"thisWeek",title:"Esta Semana"},{key:"future",title:"Próximamente"},{key:"noDate",title:"Sin Fecha"}],ye=W=>{const se=new Date;switch(W){case"overdue":return ti(Vt(ys(se),-1));case"today":return ti(se);case"tomorrow":return ti(Vt(ys(se),1));case"thisWeek":return ti($n(se));case"future":return ti(Yo(se,1));case"noDate":default:return null}},oe=W=>{d&&(i(d.id,ye(W)),u(null))},me=()=>{const W=P.map(ge=>({nombre:ge.title,descripción:ge.description||"",categoria:nr[ge.category],prioridad:ge.priority||"sin prioridad",tamaño:ge.size||"sin tamaño",fecha:ge.dueDate?new Date(ge.dueDate).toLocaleDateString("es-ES"):"sin fecha",completada:ge.completed?"Sí":"No"})),se=JSON.stringify(W,null,2);navigator.clipboard.writeText(se).then(()=>{kt.success(`${W.length} tareas filtradas copiadas al portapapeles`)}).catch(()=>{kt.error("Error al copiar las tareas")})};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-end items-center text-xs text-gray-500 gap-1",children:[e.jsx(Sr,{className:"w-3 h-3"}),Wo(Y)]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-4 items-stretch sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(fd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(Ve,{placeholder:"Buscar tareas por nombre...",value:$,onChange:W=>D(W.target.value),className:"pl-10 pr-10"}),$&&e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>D(""),className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Js,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"md:hidden flex gap-2",children:[e.jsxs(F,{variant:K?"default":"outline",onClick:()=>H(!O),className:`flex items-center gap-2 ${K?"bg-blue-600 hover:bg-blue-700":""}`,children:[e.jsx(bf,{className:"w-4 h-4"}),"Filtros",K&&e.jsx("span",{className:"bg-white text-blue-600 rounded-full px-2 py-0.5 text-xs font-medium",children:"Activos"})]}),K&&e.jsx(F,{variant:"ghost",onClick:X,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Js,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"hidden md:flex",children:K&&e.jsxs(F,{variant:"ghost",onClick:X,className:"text-red-600 hover:text-red-700 hover:bg-red-50 flex items-center gap-2",children:[e.jsx(Js,{className:"w-4 h-4"}),"Limpiar filtros"]})})]}),e.jsx("div",{className:`${O?"block":"hidden md:block"}`,children:e.jsxs("div",{className:"flex flex-wrap items-end gap-3 md:gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Categoría"}),e.jsxs(ft,{value:m,onValueChange:W=>p(W),children:[e.jsx(ct,{className:`w-32 ${m!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:m==="all"?"Todas":nr[m]})}),e.jsxs(dt,{children:[e.jsx(De,{value:"all",children:"Todas"}),Object.values(sp).map(W=>e.jsx(De,{value:W,children:nr[W]},W))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Fecha"}),e.jsxs(ft,{value:x,onValueChange:W=>g(W),children:[e.jsx(ct,{className:`w-32 ${x!=="today"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:$g[x]})}),e.jsx(dt,{children:Object.entries($g).map(([W,se])=>e.jsx(De,{value:W,children:se},W))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Prioridad"}),e.jsxs(ft,{value:v,onValueChange:W=>j(W),children:[e.jsx(ct,{className:`w-24 ${v!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:zg[v]})}),e.jsx(dt,{children:Object.entries(zg).map(([W,se])=>e.jsx(De,{value:W,children:se},W))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Tamaño"}),e.jsxs(ft,{value:b,onValueChange:W=>y(W),children:[e.jsx(ct,{className:`w-24 ${b!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:Fg[b]})}),e.jsx(dt,{children:Object.entries(Fg).map(([W,se])=>e.jsx(De,{value:W,children:se},W))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Urgente"}),e.jsxs(ft,{value:N,onValueChange:W=>S(W),children:[e.jsx(ct,{className:`w-20 ${N!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:Rc[N]})}),e.jsx(dt,{children:Object.entries(Rc).map(([W,se])=>e.jsx(De,{value:W,children:se},W))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Importante"}),e.jsxs(ft,{value:E,onValueChange:W=>T(W),children:[e.jsx(ct,{className:`w-20 ${E!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:Rc[E]})}),e.jsx(dt,{children:Object.entries(Rc).map(([W,se])=>e.jsx(De,{value:W,children:se},W))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Estimado"}),e.jsxs(ft,{value:k,onValueChange:W=>M(W),children:[e.jsx(ct,{className:`w-24 ${k!=="all"?"border-blue-500 bg-blue-50":""}`,children:e.jsx(pt,{children:Bg[k]})}),e.jsx(dt,{children:Object.entries(Bg).map(([W,se])=>e.jsx(De,{value:W,children:se},W))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Ordenar"}),e.jsxs(ft,{value:R,onValueChange:W=>I(W),children:[e.jsx(ct,{className:"w-28",children:e.jsx(pt,{children:Wg[R]})}),e.jsx(dt,{children:Object.entries(Wg).map(([W,se])=>e.jsx(De,{value:W,children:se},W))})]})]}),e.jsx("div",{className:"flex items-end gap-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Exportar filtradas"}),e.jsxs(F,{variant:"outline",size:"sm",onClick:me,className:"flex items-center gap-1 min-w-fit",disabled:P.length===0,title:`Copia al portapapeles las ${P.length} tareas que se muestran actualmente con todos los filtros aplicados`,children:[e.jsx(Ar,{className:"w-3 h-3"}),e.jsxs("span",{className:"whitespace-nowrap",children:["Copiar visibles (",P.length,")"]})]})]})})]})}),e.jsx("div",{className:"flex flex-col lg:flex-row items-start gap-2 lg:gap-4 overflow-x-auto pb-2 p-2 lg:p-3 rounded bg-gradient-to-br from-blue-50 via-indigo-50 to-indigo-100",children:ae.map(W=>e.jsxs("div",{className:"w-full lg:w-[16rem] xl:w-[18rem] lg:flex-shrink-0 space-y-2",onDragOver:se=>se.preventDefault(),onDrop:()=>oe(W.key),children:[e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("h3",{className:"font-medium text-xs lg:text-sm text-gray-500 uppercase tracking-wider flex items-center gap-1",children:[W.title,U[W.key]>0&&e.jsxs("span",{className:"text-[10px] text-gray-400 flex items-center gap-1",children:[e.jsx(Sr,{className:"w-3 h-3"}),Wo(U[W.key])]})]}),e.jsx("div",{className:"flex gap-1",children:e.jsx(F,{size:"icon",variant:"ghost",onClick:()=>o(ye(W.key)),className:"h-6 w-6 lg:h-8 lg:w-8",children:e.jsx(Ns,{className:"w-3 h-3 lg:w-4 lg:h-4"})})})]}),G[W.key].map(se=>e.jsx("div",{draggable:!0,onDragStart:()=>u(se),onDragEnd:()=>u(null),children:e.jsx($i,{task:se,onDelete:n,onEdit:s,onView:r,onMove:i,variant:"kanban",showCategoryLabel:m==="all"})},se.id))]},W.key))})]})},e5={do:{color:"bg-red-500",text:"Hacer (urgente + importante)",label:"🔥 do"},decide:{color:"bg-orange-500",text:"Decidir (importante)",label:"🤔 decide"},delegate:{color:"bg-blue-500",text:"Delegar (urgente)",label:"📤 delegate"},delete:{color:"bg-gray-400",text:"Eliminar (sin prioridad)",label:"🗑️ delete"}},t5=()=>e.jsxs("div",{className:"mt-6 text-sm",children:[e.jsx("h2",{className:"font-medium mb-2",children:"Convenciones de prioridad"}),e.jsx("ul",{className:"space-y-1",children:Object.entries(e5).map(([t,n])=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(jr,{className:`text-xs font-normal px-2 py-0.5 text-white ${n.color}`,children:n.label}),e.jsx("span",{children:n.text})]},t))})]}),Ta=dr("task"),s5=Ta?`https://generativelanguage.googleapis.com/v1beta/models/${Ta.model}:generateContent`:"",n5=({tasks:t,open:n,onOpenChange:s})=>{const[r,i]=f.useState(!1),o=n!==void 0?n:r,c=s??i,[d,u]=f.useState(null),[m,p]=f.useState(""),[x,g]=f.useState(!1),[v,j]=f.useState(""),[b,y]=f.useState(0),N="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",S=(Ta==null?void 0:Ta.prompt)??"Eres un asistente de productividad. Basándote en el estado de ánimo y las tareas pendientes sugiere cuál debería abordar primero.",E=Ta==null?void 0:Ta.params;f.useEffect(()=>{if(d){const R=t.sort((I,O)=>{var H,$;return(((H=I.dueDate)==null?void 0:H.getTime())||1/0)-((($=O.dueDate)==null?void 0:$.getTime())||1/0)}).slice(0,15).map(I=>`- ${I.title}${I.dueDate?` (vence ${Pt(I.dueDate,"yyyy-MM-dd")})`:""} - ${nr[I.category]}`).join(`
`);j(`${S}
Estado de ánimo: ${d.text}
Tareas pendientes:
${R}`)}else j("")},[d,t]),f.useEffect(()=>{y(ur(v))},[v]);const T=R=>{try{const I=mt.parse(R);return $a.sanitize(I)}catch(I){return console.error("Error procesando Markdown:",I),$a.sanitize(R.replace(/\n/g,"<br>"))}},k=async()=>{var R,I,O,H,$;if(d){g(!0);try{const P=await(await fetch(`${s5}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:v}]}],...E})})).json(),K=($=(H=(O=(I=(R=P==null?void 0:P.candidates)==null?void 0:R[0])==null?void 0:I.content)==null?void 0:O.parts)==null?void 0:H[0])==null?void 0:$.text;p(K||"No se pudo obtener sugerencia")}catch{p("Error al consultar la API")}finally{g(!1)}}},M=()=>{c(!1),p(""),u(null)};return e.jsxs(yt,{open:o,onOpenChange:R=>R?c(!0):M(),children:[n===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>c(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"}),"Sugerir tarea"]}),e.jsx(xt,{className:"max-w-6xl h-[80vh]",children:e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col space-y-4 mb-3",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("h2",{className:"text-lg font-medium mb-1",children:"Sugerencia de tarea con IA"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Selecciona tu estado de ánimo para recibir recomendaciones personalizadas"})]}),!d&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"¿Cómo te sientes?"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ai.map(R=>e.jsx("div",{className:"relative",children:e.jsxs(F,{variant:"outline",onClick:()=>u(R),className:"h-12 text-lg w-full relative",children:[e.jsx("span",{children:R.emoji}),e.jsx("span",{className:"w-full text-center text-xs text-gray-500 mt-1",children:R.text})]})},R.emoji))})]}),d&&e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-3 p-2 bg-gray-50 rounded-md",children:e.jsxs("span",{children:["Estado de ánimo: ",e.jsxs("strong",{children:[d.emoji," ",d.text]})]})}),e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Prompt para IA:"}),e.jsx(vt,{value:v,onChange:R=>j(R.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Modifica el prompt para personalizar la sugerencia..."})]})]}),d&&e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",b]}),b>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:k,disabled:x||!N||b>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[x&&e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx(as,{className:"w-4 h-4"}),x?"Consultando IA...":"Generar sugerencia"]}),x&&e.jsx(oa,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Resultado"}),m?e.jsx("div",{className:"flex-1 p-4 bg-muted rounded-md overflow-auto",children:e.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert
                    prose-headings:text-foreground prose-p:text-foreground 
                    prose-strong:text-foreground prose-ul:text-foreground 
                    prose-ol:text-foreground prose-li:text-foreground
                    prose-code:bg-accent prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-foreground
                    prose-pre:bg-accent prose-pre:border prose-pre:text-foreground
                    prose-blockquote:border-l-accent prose-blockquote:text-foreground`,dangerouslySetInnerHTML:{__html:T(m)}})}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500 text-sm",children:d?"Haz clic en 'Generar sugerencia' para obtener recomendaciones":"Selecciona tu estado de ánimo para comenzar"})]})]})})]})},ka=dr("task"),r5=ka?`https://generativelanguage.googleapis.com/v1beta/models/${ka.model}:generateContent`:"",a5=({tasks:t,onUpdate:n,open:s,onOpenChange:r})=>{var T;const[i,o]=f.useState(!1),c=s!==void 0?s:i,d=r??o,[u,m]=f.useState(!1),[p,x]=f.useState(""),[g,v]=f.useState(""),[j,b]=f.useState(0),y="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",N=((T=ka==null?void 0:ka.prompts)==null?void 0:T.reprioritize)??"Analiza la lista de tareas y devuelve un JSON con id, urgent, important, size y estimatedTime (minutos).",S=ka==null?void 0:ka.params;f.useEffect(()=>{if(c){const k=t.map(M=>`- id:${M.id} title:${M.title} desc:${M.description||""} priority:${M.priority||""} size:${M.size||""} time:${M.estimatedTime||""}`).join(`
`);v(`${N}
${k}`)}},[c,t]),f.useEffect(()=>{b(ur(g))},[g]);const E=async()=>{var k,M,R,I,O;if(t.length!==0){m(!0);try{const $=await(await fetch(`${r5}?key=${y}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:g}]}],...S})})).json(),D=((O=(I=(R=(M=(k=$==null?void 0:$.candidates)==null?void 0:k[0])==null?void 0:M.content)==null?void 0:R.parts)==null?void 0:I[0])==null?void 0:O.text)||"";x(D);const P=D.match(/```json([\s\S]*?)```/),K=P?P[1]:D;JSON.parse(K).forEach(G=>{const U=G.urgent&&G.important?"do":G.important?"decide":G.urgent?"delegate":"delete";n(G.id,{priority:U,size:G.size,estimatedTime:G.estimatedTime})})}catch{x("Error al consultar la API")}finally{m(!1)}}};return e.jsxs(e.Fragment,{children:[s===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>d(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"}),"Repriorizar"]}),e.jsx(yt,{open:c,onOpenChange:d,children:e.jsxs(xt,{className:"max-w-6xl h-[80vh]",children:[e.jsxs(bt,{className:"flex-shrink-0 pb-1 space-y-0",children:[e.jsx(jt,{className:"text-lg font-medium",children:"Repriorizar Tareas con IA"}),e.jsx(mn,{className:"text-sm mt-1",children:"La IA analizará tus tareas y ajustará automáticamente prioridad, tamaño y tiempo estimado."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(vt,{value:g,onChange:k=>v(k.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Lista de tareas a analizar..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",j]}),j>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:E,disabled:u||!y||j>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[u&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(as,{className:"w-4 h-4"}),u?"Analizando...":"Repriorizar tareas"]}),u&&e.jsx(oa,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado del análisis"}),p&&e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(p),kt.success("Análisis copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Ar,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-md p-3 overflow-auto",children:p?e.jsx("pre",{className:"text-xs whitespace-pre-wrap font-mono text-gray-700",children:p}):u?e.jsx("div",{className:"text-sm text-gray-500",children:"Analizando tareas..."}):e.jsx("div",{className:"text-sm text-gray-500",children:"El análisis y repriorizacion aparecerá aquí. Las tareas se actualizarán automáticamente una vez completado el análisis."})})})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"💡 Tip: Las tareas se actualizarán automáticamente según la matriz de Eisenhower"}),!y]})})]})})]})},Hg={morning:"🌅",afternoon:"🏙️",evening:"🌙"},i5=({task:t,onAssign:n,onView:s})=>{const r=(i,o)=>{i.stopPropagation(),n(t.id,o)};return e.jsx(je,{onClick:()=>s==null?void 0:s(t),className:"bg-white hover:shadow p-2 cursor-pointer space-y-2",children:e.jsxs(we,{className:"p-0 space-y-2",children:[e.jsx("span",{className:"text-sm font-medium break-words line-clamp-2 block",children:t.title}),e.jsx("div",{className:"flex gap-1",children:Object.keys(Hg).map(i=>e.jsx(F,{size:"icon",variant:"ghost",className:"h-6 w-6 p-0 hover:bg-muted",title:`Asignar a ${i}`,onClick:o=>r(o,i),children:Hg[i]},i))})]})})},o5=["morning","afternoon","evening"],l5=({tasks:t,onDelete:n,onEdit:s,onView:r,onAssignTimeOfDay:i})=>{const o=ys(new Date),c=wr(o),d=Vt(o,1),u=wr(d),m={overdue:{morning:[],afternoon:[],evening:[]},today:{morning:[],afternoon:[],evening:[]},tomorrow:{morning:[],afternoon:[],evening:[]}},p=[];return t.forEach(x=>{if(!x.dueDate||!x.timeOfDay){p.push(x);return}os(x.dueDate,o)?m.overdue[x.timeOfDay].push(x):os(x.dueDate,c)?m.today[x.timeOfDay].push(x):os(x.dueDate,u)?m.tomorrow[x.timeOfDay].push(x):p.push(x)}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsx("div",{className:"min-w-[700px] grid grid-cols-3 gap-2",children:[{key:"overdue",label:"Vencidas"},{key:"today",label:"Hoy"},{key:"tomorrow",label:"Mañana"}].map(({key:x,label:g})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-center text-sm font-medium",children:g}),o5.map(v=>e.jsxs("div",{className:"min-h-[6rem] border rounded p-1 space-y-1",children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500",children:ef[v]}),m[x][v].map(j=>e.jsx($i,{task:j,onDelete:n,onEdit:s,onView:r,variant:"list"},j.id))]},v))]},x))})}),p.length>0&&e.jsxs("div",{className:"w-56 space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Sin asignar"}),p.map(x=>e.jsx(i5,{task:x,onView:r,onAssign:i},x.id))]})]})},c5=()=>{const{tasks:t,status:n,error:s,showRecurrenceModal:r,currentTask:i,modalMode:o,addTask:c,editTask:d,toggleTask:u,deleteTask:m,completeRecurrentTask:p,setShowRecurrenceModal:x,openEditModal:g,openCreateModal:v,resync:j}=_l(),{isOnline:b}=cr(),[y,N]=f.useState(null),[S,E]=f.useState(!1);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(je,{children:[e.jsx(Mt,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Lt,{children:"Calendario"}),e.jsx("div",{className:"flex items-center gap-4 text-xs",children:e.jsxs(F,{onClick:()=>v(),size:"sm",disabled:n==="saving"||!b,children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Nueva Tarea"]})})]})}),e.jsxs(we,{children:[e.jsx(l5,{tasks:t,onDelete:m,onEdit:g,onAssignTimeOfDay:(T,k)=>d(T,{timeOfDay:k}),onView:T=>{N(T),E(!0)}}),s&&e.jsx("p",{className:"text-sm text-red-500 mt-4",children:s})]}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[n==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),n==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),n==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),n==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!b&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:j,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]}),e.jsx(kl,{isOpen:r,onClose:()=>x(),onConfirm:T=>{o==="complete"?p(T):o==="edit"?d(i.id,T):c(T)},task:i||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:o}),e.jsx(Id,{task:y,isOpen:S,onClose:()=>E(!1),onEdit:T=>{E(!1),g(T)},onToggle:u})]})},d5=()=>{const{tasks:t,status:n,error:s,showRecurrenceModal:r,currentTask:i,modalMode:o,addTask:c,editTask:d,toggleTask:u,deleteTask:m,completeRecurrentTask:p,setShowRecurrenceModal:x,openEditModal:g,openCreateModal:v,resync:j}=_l(),{isOnline:b}=cr(),[y,N]=f.useState(null),[S,E]=f.useState(!1);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(je,{className:"w-full",children:[e.jsxs(we,{className:"pt-6 overflow-x-auto",children:[e.jsx(Q4,{tasks:t,onDelete:m,onEdit:g,onView:T=>{N(T),E(!0)},onMove:(T,k)=>d(T,{dueDate:k??void 0}),onAdd:T=>v(T??void 0),onFilteredTasksChange:()=>{}}),s&&e.jsx("p",{className:"text-sm text-red-500 mt-4",children:s})]}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[n==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),n==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),n==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),n==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!b&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:j,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]}),e.jsx(kl,{isOpen:r,onClose:()=>x(),onConfirm:T=>{o==="complete"?p(T):o==="edit"?d(i.id,T):c(T)},task:i||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:o}),e.jsx(Id,{task:y,isOpen:S,onClose:()=>E(!1),onEdit:T=>{E(!1),g(T)},onToggle:u}),e.jsx(t5,{})]})},tj=({showFloatingButton:t=!1})=>{const{user:n}=He(),s=_l(),{tasks:r,status:i,error:o,showRecurrenceModal:c,currentTask:d,modalMode:u,addTask:m,editTask:p,toggleTask:x,deleteTask:g,completeRecurrentTask:v,setShowRecurrenceModal:j,openEditModal:b,openCreateModal:y,resync:N}=s,{isOnline:S}=cr(),[E,T]=f.useState(null),[k,M]=f.useState(!1);return n?e.jsxs("div",{className:"space-y-8 relative",children:[e.jsx(je,{children:e.jsx(we,{className:"pt-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z4,{tasks:r,onDelete:g,onEdit:b,onView:R=>{T(R),M(!0)}}),o&&e.jsx("p",{className:"text-sm text-red-500",children:o})]})})}),t&&e.jsx("div",{className:"md:hidden fixed bottom-20 right-4 z-50",children:e.jsx(F,{onClick:()=>y(),size:"lg",className:"w-14 h-14 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 bg-blue-600 hover:bg-blue-700 active:scale-95 border-0 flex items-center justify-center text-white",children:e.jsx(Ns,{className:"w-6 h-6 text-white"})})}),e.jsx(kl,{isOpen:c,onClose:()=>j(),onConfirm:R=>{u==="complete"?v(R):u==="edit"?p(d.id,R):m(R)},task:d||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:u}),e.jsx(Id,{task:E,isOpen:k,onClose:()=>M(!1),onEdit:R=>{M(!1),b(R)},onToggle:x})]}):e.jsxs(je,{children:[e.jsx(we,{className:"p-8 text-center",children:e.jsx("p",{children:"Inicia sesión para gestionar tus tareas"})}),e.jsxs(Xs,{className:"gap-2 text-xs p-2",children:[i==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),i==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),i==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),i==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!S&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:N,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]})},_a=dr("journal"),u5=_a?`https://generativelanguage.googleapis.com/v1beta/models/${_a.model}:generateContent`:"",m5=({entry:t,open:n,onOpenChange:s,onInsert:r,onReplace:i})=>{const[o,c]=f.useState(!1),d=n!==void 0?n:o,u=s??c,[m,p]=f.useState(""),[x,g]=f.useState(!1),[v,j]=f.useState(""),[b,y]=f.useState(0),N="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",S=(_a==null?void 0:_a.prompt)??"Reescribe el siguiente texto del diario de forma clara y natural:",E=_a==null?void 0:_a.params;f.useEffect(()=>{d&&j(`${S}
${t}`)},[d,t]),f.useEffect(()=>{y(ur(v))},[v]);const T=async()=>{var M,R,I,O,H;if(t){g(!0);try{const D=await(await fetch(`${u5}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:v}]}],...E})})).json(),P=(H=(O=(I=(R=(M=D==null?void 0:D.candidates)==null?void 0:M[0])==null?void 0:R.content)==null?void 0:I.parts)==null?void 0:O[0])==null?void 0:H.text;p(P||"No se pudo obtener respuesta")}catch{p("Error al consultar la API")}finally{g(!1)}}},k=()=>{u(!1),p(""),j(""),y(0)};return e.jsxs(yt,{open:d,onOpenChange:M=>M?u(!0):k(),children:[n===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>u(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"}),"Mejorar entrada"]}),e.jsxs(xt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(bt,{className:"flex-shrink-0",children:[e.jsx(jt,{className:"text-xl",children:"Reescribir Diario con IA"}),e.jsx(mn,{children:"Gemini transformará tu texto en un estilo más natural. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(vt,{value:v,onChange:M=>j(M.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Escribe o modifica el prompt para la IA..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",b]}),b>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:T,disabled:x||!N||b>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[x&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(as,{className:"w-4 h-4"}),x?"Consultando IA...":"Generar versión mejorada"]}),x&&e.jsx(oa,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Resultado"}),m&&e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(m),kt.success("Texto copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Ar,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[e.jsx(vt,{readOnly:!0,value:m||(x?"Generando respuesta...":"El resultado aparecerá aquí después de generar"),className:"flex-1 resize-none bg-gray-50 border-gray-200 min-h-0",placeholder:"El resultado aparecerá aquí..."}),m&&(r||i)&&e.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[r&&e.jsx(F,{type:"button",className:"flex-1",onClick:()=>{r(m),kt.success("Texto insertado")},variant:"default",children:"📝 Insertar en entrada"}),i&&e.jsx(F,{type:"button",className:"flex-1",onClick:()=>{i(m),kt.success("Texto reemplazado")},variant:"secondary",children:"🔄 Reemplazar entrada"})]})]})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"💡 Tip: Puedes editar el prompt para obtener diferentes estilos de reescritura"}),!N]})})]})]})},Vo=dr("journal"),f5=Vo?`https://generativelanguage.googleapis.com/v1beta/models/${Vo.model}:generateContent`:"",p5=({entry:t,selectedDate:n,open:s,onOpenChange:r})=>{const{user:i}=He(),[o,c]=f.useState(!1),d=s!==void 0?s:o,u=r??c,[m,p]=f.useState(""),[x,g]=f.useState(""),[v,j]=f.useState(!1),[b,y]=f.useState(0),N="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",S="Analiza la siguiente entrada del diario y los estados de ánimo del día. Da una breve opinión sobre cómo fue y sugiere mejoras para mañana.",E=Vo==null?void 0:Vo.params;f.useEffect(()=>{d?(async()=>{let M="";if(i){const R=Oe(n),I=be($t(fe,"moods"),`${i.uid}_${R}`),O=await ds(I);M=(O.exists()&&Array.isArray(O.data().moods)?O.data().moods:[]).map($=>`${$.emoji} ${$.text}`).join(", ")}g(`${S}
Moods: ${M}
Diario:
${t}`)})():(g(""),p(""))},[d,t,i,n]),f.useEffect(()=>{y(ur(x))},[x]);const T=async()=>{var M,R,I,O,H;if(x){j(!0);try{const D=await(await fetch(`${f5}?key=${N}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:x}]}],...E})})).json(),P=(H=(O=(I=(R=(M=D==null?void 0:D.candidates)==null?void 0:M[0])==null?void 0:R.content)==null?void 0:I.parts)==null?void 0:O[0])==null?void 0:H.text;p(P||"No se pudo obtener respuesta")}catch{p("Error al consultar la API")}finally{j(!1)}}},k=()=>{u(!1),p(""),g(""),y(0)};return e.jsx(yt,{open:d,onOpenChange:M=>M?u(!0):k(),children:e.jsxs(xt,{className:"w-full sm:max-w-5xl max-h-[90vh] overflow-auto",children:[e.jsxs(bt,{children:[e.jsx(jt,{children:"Opinión del día"}),e.jsx(mn,{children:"Resumen y sugerencias para mañana."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(vt,{value:x,onChange:M=>g(M.target.value),className:"max-h-[500px] overflow-y-auto"}),e.jsxs("p",{className:"text-xs text-right",children:["Tokens: ",b," ",b>3500&&e.jsx("span",{className:"text-red-500",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:T,disabled:v||!N,className:"w-full flex items-center justify-center gap-2",children:[v&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),v?"Consultando...":"Analizar día"]}),v&&e.jsx(oa,{className:"mt-2"}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx(F,{type:"button",size:"icon",variant:"ghost",onClick:()=>{navigator.clipboard.writeText(m),kt.success("Texto copiado")},children:e.jsx(Ar,{className:"w-4 h-4"})})}),e.jsx(vt,{readOnly:!0,value:m,className:"max-h-[300px]"})]})]})]})})},h5=({entry:t,selectedDate:n,onInsert:s,onReplace:r})=>{const[i,o]=f.useState(!1),[c,d]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(as,{className:"w-4 h-4"}),"IA"]})}),e.jsxs(or,{align:"end",children:[e.jsx(ut,{onSelect:()=>o(!0),children:"Reescribir entrada"}),e.jsx(ut,{onSelect:()=>d(!0),children:"Opinión y consejos"})]})]}),e.jsx(m5,{entry:t,open:i,onOpenChange:o,onInsert:s,onReplace:r}),e.jsx(p5,{entry:t,selectedDate:n,open:c,onOpenChange:d})]})},x5=t=>{const[n,s]=f.useState(""),[r,i]=f.useState("idle"),[o,c]=f.useState(null),[d,u]=f.useState(void 0),{user:m}=He();f.useEffect(()=>{if(!m)return;const g=Oe(t),v=be(fe,"journal",`${m.uid}_${g}`),j=ns(v,b=>{if(b.exists()){if(s(b.data().text||""),b.data().lastUpdated){const y=b.data().lastUpdated.toDate();u(Ef(y))}b.metadata.hasPendingWrites?i("pending"):i("saved")}else s(""),i("idle"),u(void 0)},b=>{c(b.message),i("error")});return()=>j()},[m,t]);const p=async g=>{if(!m)return;i("saving"),c(null);const v=Oe(t),j=be(fe,"journal",`${m.uid}_${v}`);try{await ht(j,{userId:m.uid,text:g,date:v,lastUpdated:lt(),displayTime:new Date().toLocaleString("es-ES",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"})},{merge:!0})}catch(b){c(b instanceof Error?b.message:"Error al guardar"),i("error")}},x=Rr("Journal data");return{entry:n,setEntry:s,status:r,error:o,saveEntry:p,lastUpdated:d,resync:x}},sj=({selectedDate:t})=>{const{user:n}=He(),{isUnlocked:s,setUnlocked:r}=ep(),[i,o]=f.useState(!1),{entry:c,setEntry:d,status:u,error:m,saveEntry:p,lastUpdated:x,resync:g}=x5(t),{isOnline:v}=cr(),{entry:j,setEntry:b}=Jb();f.useEffect(()=>{b(c)},[c,b]);const y=()=>{r(!1)};return n?s?e.jsxs(e.Fragment,{children:[e.jsxs(je,{className:"w-full",children:[e.jsxs(we,{className:"p-4",children:[e.jsx(S4,{onLock:y}),e.jsx(C4,{value:j,onChange:N=>{b(N),d(N)}}),m&&e.jsx("p",{className:"mt-2 text-sm text-red-500",children:m})]}),e.jsxs(Xs,{className:"flex flex-col gap-4 p-2",children:[e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsx(Zb,{lastUpdated:x}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{onClick:()=>p(j),disabled:u==="saving"||!v,children:u==="saving"?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ux,{className:"w-4 h-4 animate-spin"}),"Guardando..."]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ux,{className:"w-4 h-4"}),"Guardar"]})}),e.jsx(h5,{entry:j,selectedDate:t,onInsert:N=>{b(S=>S+(S?`
`:"")+N),d(S=>S+(S?`
`:"")+N)},onReplace:N=>{b(N),d(N)}}),e.jsx(F,{variant:"outline",size:"sm",onClick:()=>o(!0),children:e.jsx(Fn,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex justify-center items-center gap-2 text-xs",children:[u==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),u==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),u==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),u==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!v&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:g,variant:"link",className:"p-0 h-auto text-xs",children:"Reintentar"})]})]})]}),e.jsx(K4,{selectedDate:t}),e.jsx(X4,{open:i,onOpenChange:o})]}):e.jsx(E4,{onUnlock:()=>r(!0),lastUpdated:x}):e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para usar el diario"})})})},g5=()=>{const{user:t,signIn:n,signOut:s}=He();return e.jsx("div",{className:"flex items-center gap-4",children:t?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm",children:t.email}),e.jsx(F,{variant:"outline",onClick:s,children:"Cerrar sesión"})]}):e.jsx(F,{onClick:n,children:"Iniciar sesión con Google"})})},kr=({selectedDate:t,onChange:n})=>{const[s,r]=f.useState(!1);f.useEffect(()=>{const m=()=>{r(window.innerWidth<768)};return m(),window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const i=()=>{const m=new Date(t);m.setDate(m.getDate()-1),n(m)},o=()=>{const m=new Date(t);m.setDate(m.getDate()+1),n(m)},c=()=>{n(new Date)},d=m=>s?m.toLocaleDateString("es-ES",{weekday:"short",month:"short",day:"numeric"}):m.toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),u=m=>{const p=new Date;return m.toDateString()===p.toDateString()};return e.jsx("div",{className:"bg-white/95 backdrop-blur-sm border border-gray-200 rounded-2xl p-4 mb-6 shadow-sm md:p-6 md:mb-8",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 md:gap-4",children:[e.jsx(F,{variant:"outline",size:"icon",onClick:i,className:"rounded-full border-2 bg-white/80 w-8 h-8 md:w-10 md:h-10 touch-manipulation active:scale-95 transition-transform",children:e.jsx(yf,{className:"w-3 h-3 md:w-4 md:h-4"})}),e.jsxs("div",{className:"flex-1 text-center",children:[e.jsx("h2",{className:"text-sm md:text-xl font-semibold bg-gradient-to-r from-gray-700 to-gray-900 bg-clip-text text-transparent capitalize",children:d(t)}),!u(t)&&e.jsxs(F,{variant:"ghost",className:"text-xs md:text-sm mt-1 md:mt-2 rounded-full h-6 md:h-auto px-2 md:px-4 touch-manipulation active:scale-95 transition-transform",onClick:c,children:[e.jsx(Nn,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Ir a hoy"}),e.jsx("span",{className:"md:hidden",children:"Hoy"})]}),u(t)&&e.jsx("div",{className:"inline-flex items-center px-2 md:px-3 py-1 mt-1 md:mt-2 rounded-full bg-green-100 text-green-800 text-xs font-medium",children:"Hoy"})]}),e.jsx(F,{variant:"outline",size:"icon",onClick:o,className:"rounded-full border-2 bg-white/80 w-8 h-8 md:w-10 md:h-10 touch-manipulation active:scale-95 transition-transform",children:e.jsx(ia,{className:"w-3 h-3 md:w-4 md:h-4"})})]})})},Ss=({children:t,className:n,fullHeight:s=!1,noPadding:r=!1,showFloatingButton:i=!1,onFloatingButtonClick:o,floatingButtonLabel:c="Agregar"})=>r?e.jsxs("div",{className:ce("h-full",n),children:[t,i&&e.jsx(F,{onClick:o,className:"fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow z-50 md:hidden",size:"icon",title:c,children:e.jsx(Ns,{className:"h-6 w-6"})})]}):e.jsxs("div",{className:ce(s?"h-full flex flex-col":"min-h-full","px-3 sm:px-4 md:px-6 lg:px-8 xl:px-12 2xl:px-16","pt-4 md:pt-6 lg:pt-8","pb-4 md:pb-6 lg:pb-8",n),children:[e.jsx("div",{className:ce(s?"flex-1 flex flex-col":"","space-y-4 sm:space-y-6 md:space-y-8 lg:space-y-10","max-w-screen-2xl mx-auto w-full","container-wide"),children:t}),i&&e.jsx(F,{onClick:o,className:"fixed bottom-20 right-6 h-14 w-14 rounded-full shadow-lg hover:shadow-xl transition-shadow z-50 md:hidden",size:"icon",title:c,children:e.jsx(Ns,{className:"h-6 w-6"})})]}),ei=f.forwardRef(({className:t,variant:n="default",...s},r)=>{const i={default:"bg-card text-card-foreground border shadow-sm",glass:"glass-card text-card-foreground",gradient:"gradient-bg-primary text-white border-0 shadow-lg",elevated:"bg-card text-card-foreground border-0 shadow-lg hover:shadow-xl transition-shadow duration-300"};return e.jsx("div",{ref:r,className:ce("rounded-xl transition-all duration-300",i[n],t),...s})});ei.displayName="ModernCard";const v5=f.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:ce("flex flex-col space-y-1.5 p-6",t),...n}));v5.displayName="ModernCardHeader";const y5=f.forwardRef(({className:t,gradient:n,...s},r)=>e.jsx("h3",{ref:r,className:ce("text-2xl font-semibold leading-none tracking-tight",n&&"bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",t),...s}));y5.displayName="ModernCardTitle";const b5=f.forwardRef(({className:t,...n},s)=>e.jsx("p",{ref:s,className:ce("text-sm text-muted-foreground",t),...n}));b5.displayName="ModernCardDescription";const j5=f.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:ce("p-6 pt-0",t),...n}));j5.displayName="ModernCardContent";const w5=f.forwardRef(({className:t,...n},s)=>e.jsx("div",{ref:s,className:ce("flex items-center p-6 pt-0",t),...n}));w5.displayName="ModernCardFooter";function rp(t,n){const{user:s}=He(),[r,i]=f.useState(n),[o,c]=f.useState("idle"),[d,u]=f.useState(null);return f.useEffect(()=>{if(!s)return;c("loading");const p=be(fe,"settings",`${s.uid}_${t}`),x=ns(p,g=>{g.exists()?i({...n,...g.data()}):i(n),c("idle")},g=>{u(g.message),c("error")});return()=>x()},[s,t]),{settings:r,status:o,error:d,saveSettings:async p=>{if(s){c("saving"),u(null);try{const x=be(fe,"settings",`${s.uid}_${t}`),g=Object.fromEntries(Object.entries(p).filter(([,v])=>v!==void 0&&!(typeof v=="number"&&isNaN(v))));await ht(x,{userId:s.uid,...g},{merge:!0}),c("saved")}catch(x){u(x.message),c("error")}}}}}const N5=()=>{const[t,n]=f.useState(new Date),{settings:s}=rp("water",{dailyGoal:2e3});return e.jsxs(Ss,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-purple-600 via-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:"Daily Life Tracker"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Organiza tu día, mejora tu vida"})]}),e.jsx(kr,{selectedDate:t,onChange:n}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:["        ",e.jsx("div",{className:"col-span-12 lg:col-span-8 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(ei,{variant:"elevated",className:"bg-card",children:e.jsx(hy,{selectedDate:t})}),e.jsx(ei,{variant:"elevated",className:"bg-card",children:e.jsx(Cb,{selectedDate:t,goal:s.dailyGoal})})]})}),e.jsx("div",{className:"col-span-12 lg:col-span-4 space-y-6",children:e.jsx(ei,{variant:"glass",children:e.jsx(tp,{selectedDate:t})})}),e.jsx("div",{className:"col-span-12 space-y-8",children:e.jsx(ei,{variant:"elevated",className:"bg-card",children:e.jsx(sj,{selectedDate:t})})}),e.jsx("div",{className:"col-span-12 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(ei,{variant:"elevated",className:"bg-card",children:e.jsx(qb,{selectedDate:t})}),e.jsx(ei,{variant:"elevated",className:"bg-card",children:e.jsx(tj,{selectedDate:t})})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsx(g5,{})})]})},Ug={lastMonth:{label:"Último mes",getValue:t=>({start:_t(Lo(t,1)),end:wn(Lo(t,1))})},currentMonth:{label:"Mes actual",getValue:t=>({start:_t(t),end:wn(t)})},last3Months:{label:"Últimos 3 meses",getValue:t=>({start:_t(Lo(t,2)),end:wn(t)})},last6Months:{label:"Últimos 6 meses",getValue:t=>({start:_t(Lo(t,5)),end:wn(t)})},lastYear:{label:"Último año",getValue:t=>({start:Em(Bx(t,1)),end:Wx(Bx(t,1))})},currentYear:{label:"Año actual",getValue:t=>({start:Em(t),end:Wx(t)})}},S5=({onPeriodChange:t})=>{const n=s=>{const r=new Date,i=Ug[s];if(i){const{start:o,end:c}=i.getValue(r);t(o,c)}};return e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("span",{className:"text-sm font-medium",children:"Mostrar período:"}),e.jsxs(ft,{onValueChange:n,defaultValue:"currentMonth",children:[e.jsx(ct,{className:"w-[180px]",children:e.jsx(pt,{placeholder:"Seleccionar período"})}),e.jsx(dt,{children:Object.entries(Ug).map(([s,{label:r}])=>e.jsx(De,{value:s,children:r},s))})]})]})},Vg=["#60A5FA","#34D399","#A78BFA","#F87171","#FBBF24","#A3E635"],C5=({startDate:t,endDate:n})=>{const{stats:s,loading:r,error:i}=Sb(t,n);if(r)return e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"flex items-center justify-center p-6",children:e.jsx(Qt,{className:"w-6 h-6 animate-spin"})})});if(i||!s)return e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-6",children:e.jsx("p",{className:"text-red-500",children:"Error al cargar estadísticas"})})});const o=c=>Pt(new Date(c),"dd MMM",{locale:Ln});return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(je,{className:"w-full md:col-span-2",children:[e.jsx(Mt,{className:"pb-2",children:e.jsx(Lt,{children:"Resumen del Período"})}),e.jsx(we,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[" ",e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(s.summary.avgDailyIntake),"ml"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Promedio diario"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[" ",e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.summary.daysTracked}),e.jsx("div",{className:"text-sm text-gray-600",children:"Días registrados"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[" ",e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:s.summary.daysWithGoal}),e.jsx("div",{className:"text-sm text-gray-600",children:"Días meta alcanzada"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted",children:[" ",e.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[Math.round(s.summary.totalIntake/1e3),"L"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total consumido"})]})]})})]}),e.jsxs(je,{className:"w-full md:col-span-2",children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Tendencia de Consumo"})}),e.jsx(we,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ri,{data:s.dailyStats,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"date",tickFormatter:o,interval:"preserveStartEnd"}),e.jsx(Mn,{tickFormatter:c=>`${c}ml`}),e.jsx(Fs,{formatter:c=>[`${c}ml`,"Consumo"],labelFormatter:c=>Pt(new Date(c),"dd MMMM yyyy",{locale:Ln})}),e.jsx(Aa,{type:"monotone",dataKey:"intake",stroke:"#60A5FA",strokeWidth:2,dot:!1})]})})})})]}),e.jsxs(je,{className:"w-full",children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Distribución por Categoría"})}),e.jsx(we,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ul,{children:[e.jsx(ml,{data:s.categoryStats,dataKey:"totalAmount",nameKey:"category",cx:"50%",cy:"50%",outerRadius:100,label:({category:c})=>rl[c],children:s.categoryStats.map((c,d)=>e.jsx(fl,{fill:Vg[d%Vg.length]},c.category))}),e.jsx(Fs,{formatter:c=>[`${c}ml`,"Cantidad"],labelFormatter:c=>rl[c]})]})})})})]}),e.jsxs(je,{className:"w-full",children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Top Bebidas"})}),"        ",e.jsx(we,{children:e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[" ",s.drinkStats.slice(0,6).map(c=>{const d=dn[c.type],u=La[d.icon];return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted hover:bg-accent transition-colors",children:[e.jsx(u,{className:`w-8 h-8 ${d.color} flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[" ",e.jsx("div",{className:"font-medium text-base",children:d.name})," ",e.jsxs("div",{className:"text-sm text-muted-foreground",children:[" ",Math.round(c.totalAmount),"ml"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[" ",c.count," veces (",Math.round(c.percentage),"%)"]})]})]},c.type)})]})})]}),s.monthlyAverages&&e.jsxs(je,{className:"w-full md:col-span-2",children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Promedios Mensuales"})}),e.jsx(we,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(pd,{data:s.monthlyAverages,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"month",tickFormatter:c=>{const d=new Date(c);return Pt(d,"MMM yyyy",{locale:Ln})}}),e.jsx(Mn,{tickFormatter:c=>`${Math.round(c)}ml`}),e.jsx(Fs,{formatter:c=>[`${Math.round(c)}ml`,"Promedio"],labelFormatter:c=>{const d=new Date(c);return Pt(d,"MMMM yyyy",{locale:Ln})}}),e.jsx(Qo,{dataKey:"average",fill:"#60A5FA"})]})})})})]})]})},E5=t=>{const[n,s]=f.useState(null),[r,i]=f.useState(!0),[o,c]=f.useState(null),{user:d}=He();return f.useEffect(()=>{(async()=>{if(d){i(!0),c(null);try{const m=[];for(let E=6;E>=0;E--){const T=new Date(t);T.setDate(T.getDate()-E),m.push(Oe(T))}const p=await Promise.all(m.map(async E=>{const T=be(fe,"water",`${d.uid}_${E}`),k=await ds(T);return k.exists()?{date:E,drinks:k.data().drinks||[],totalWater:k.data().totalWater||0}:{date:E,drinks:[],totalWater:0}})),x=$s.sumBy(p,"totalWater"),g=x/7,v=p.flatMap(E=>E.drinks),j=$s.groupBy(v,"type"),b=Object.entries(j).map(([E,T])=>({type:E,count:T.length,totalAmount:$s.sumBy(T,"amount"),percentage:$s.sumBy(T,"amount")/x*100||0})).sort((E,T)=>T.count-E.count),y=$s.groupBy(v,E=>dn[E.type].category),N=Object.entries(y).map(([E,T])=>({category:E,totalAmount:$s.sumBy(T,"amount"),percentage:$s.sumBy(T,"amount")/x*100||0})).sort((E,T)=>T.totalAmount-E.totalAmount),S=p.map(E=>({date:E.date,intake:E.totalWater}));s({totalIntake:x,avgDailyIntake:g,commonDrinks:b,dailyIntake:S,categoryStats:N})}catch(m){console.error("Error al cargar estadísticas:",m),c(m instanceof Error?m.message:"Error al cargar estadísticas")}finally{i(!1)}}})()},[d,t]),{stats:n,loading:r,error:o}},Gg=["#60A5FA","#34D399","#A78BFA","#F87171","#FBBF24","#A3E635"],T5=({selectedDate:t})=>{const{stats:n,loading:s,error:r}=E5(t);return s?e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"flex items-center justify-center p-6",children:e.jsx(Qt,{className:"w-6 h-6 animate-spin"})})}):r||!n?e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-6",children:e.jsx("p",{className:"text-red-500",children:"Error al cargar estadísticas"})})}):e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(je,{className:"w-full",children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Consumo Diario"})}),e.jsxs(we,{children:[e.jsx("div",{className:"h-64",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(pd,{data:n.dailyIntake,children:[e.jsx(tr,{dataKey:"date",tickFormatter:i=>new Date(i).toLocaleDateString("es-ES",{weekday:"short"})}),e.jsx(Mn,{tickFormatter:i=>`${i}ml`}),e.jsx(Fs,{formatter:i=>[`${i}ml`,"Consumo"],labelFormatter:i=>new Date(i).toLocaleDateString("es-ES",{weekday:"long",day:"numeric",month:"short"})}),e.jsx(Qo,{dataKey:"intake",fill:"#60A5FA"})]})})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-500 text-center",children:["Promedio diario: ",Math.round(n.avgDailyIntake),"ml"]})]})]}),e.jsxs(je,{className:"w-full",children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Distribución por Categoría"})}),e.jsx(we,{children:e.jsx("div",{className:"h-64",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ul,{children:[e.jsx(ml,{data:n.categoryStats,dataKey:"totalAmount",nameKey:"category",cx:"50%",cy:"50%",outerRadius:80,label:({category:i})=>rl[i],children:n.categoryStats.map((i,o)=>e.jsx(fl,{fill:Gg[o%Gg.length]},i.category))}),e.jsx(Fs,{formatter:i=>[`${i}ml`,"Cantidad"],labelFormatter:i=>rl[i]})]})})})})]}),e.jsxs(je,{className:"w-full md:col-span-2",children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Bebidas Más Consumidas"})}),e.jsxs(we,{children:["          ",e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:[" ",n.commonDrinks.slice(0,6).map(i=>{const o=dn[i.type],c=La[o.icon];return e.jsxs("div",{className:"flex flex-col items-center p-4 rounded-lg bg-muted text-center",children:[e.jsx(c,{className:`w-6 h-6 ${o.color} mb-2 flex-shrink-0`}),e.jsx("span",{className:"font-medium text-sm leading-tight",children:o.name})," ",e.jsxs("span",{className:"text-sm text-muted-foreground mt-1",children:[" ",i.totalAmount,"ml"]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[" ",i.count," veces"]})]},i.type)})]})]})]})]})};function ra(t,n,{checkForDefaultPrevented:s=!0}={}){return function(i){if(t==null||t(i),s===!1||!i.defaultPrevented)return n==null?void 0:n(i)}}function qg(t,n){if(typeof t=="function")return t(n);t!=null&&(t.current=n)}function k5(...t){return n=>{let s=!1;const r=t.map(i=>{const o=qg(i,n);return!s&&typeof o=="function"&&(s=!0),o});if(s)return()=>{for(let i=0;i<r.length;i++){const o=r[i];typeof o=="function"?o():qg(t[i],null)}}}}function ed(...t){return f.useCallback(k5(...t),t)}function _5(t){const n=t+"CollectionProvider",[s,r]=za(n),[i,o]=s(n,{collectionRef:{current:null},itemMap:new Map}),c=v=>{const{scope:j,children:b}=v,y=ne.useRef(null),N=ne.useRef(new Map).current;return e.jsx(i,{scope:j,itemMap:N,collectionRef:y,children:b})};c.displayName=n;const d=t+"CollectionSlot",u=ne.forwardRef((v,j)=>{const{scope:b,children:y}=v,N=o(d,b),S=ed(j,N.collectionRef);return e.jsx(sl,{ref:S,children:y})});u.displayName=d;const m=t+"CollectionItemSlot",p="data-radix-collection-item",x=ne.forwardRef((v,j)=>{const{scope:b,children:y,...N}=v,S=ne.useRef(null),E=ed(j,S),T=o(m,b);return ne.useEffect(()=>(T.itemMap.set(S,{ref:S,...N}),()=>void T.itemMap.delete(S))),e.jsx(sl,{[p]:"",ref:E,children:y})});x.displayName=m;function g(v){const j=o(t+"CollectionConsumer",v);return ne.useCallback(()=>{const y=j.collectionRef.current;if(!y)return[];const N=Array.from(y.querySelectorAll(`[${p}]`));return Array.from(j.itemMap.values()).sort((T,k)=>N.indexOf(T.ref.current)-N.indexOf(k.ref.current))},[j.collectionRef,j.itemMap])}return[{Provider:c,Slot:u,ItemSlot:x},g,r]}var D5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],eo=D5.reduce((t,n)=>{const s=f.forwardRef((r,i)=>{const{asChild:o,...c}=r,d=o?sl:n;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(d,{...c,ref:i})});return s.displayName=`Primitive.${n}`,{...t,[n]:s}},{}),gm="rovingFocusGroup.onEntryFocus",A5={bubbles:!1,cancelable:!0},Od="RovingFocusGroup",[nf,nj,R5]=_5(Od),[P5,rj]=za(Od,[R5]),[I5,O5]=P5(Od),aj=f.forwardRef((t,n)=>e.jsx(nf.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(nf.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(M5,{...t,ref:n})})}));aj.displayName=Od;var M5=f.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:s,orientation:r,loop:i=!1,dir:o,currentTabStopId:c,defaultCurrentTabStopId:d,onCurrentTabStopIdChange:u,onEntryFocus:m,preventScrollOnEntryFocus:p=!1,...x}=t,g=f.useRef(null),v=ed(n,g),j=cl(o),[b=null,y]=aa({prop:c,defaultProp:d,onChange:u}),[N,S]=f.useState(!1),E=Zr(m),T=nj(s),k=f.useRef(!1),[M,R]=f.useState(0);return f.useEffect(()=>{const I=g.current;if(I)return I.addEventListener(gm,E),()=>I.removeEventListener(gm,E)},[E]),e.jsx(I5,{scope:s,orientation:r,dir:j,loop:i,currentTabStopId:b,onItemFocus:f.useCallback(I=>y(I),[y]),onItemShiftTab:f.useCallback(()=>S(!0),[]),onFocusableItemAdd:f.useCallback(()=>R(I=>I+1),[]),onFocusableItemRemove:f.useCallback(()=>R(I=>I-1),[]),children:e.jsx(eo.div,{tabIndex:N||M===0?-1:0,"data-orientation":r,...x,ref:v,style:{outline:"none",...t.style},onMouseDown:ra(t.onMouseDown,()=>{k.current=!0}),onFocus:ra(t.onFocus,I=>{const O=!k.current;if(I.target===I.currentTarget&&O&&!N){const H=new CustomEvent(gm,A5);if(I.currentTarget.dispatchEvent(H),!H.defaultPrevented){const $=T().filter(G=>G.focusable),D=$.find(G=>G.active),P=$.find(G=>G.id===b),X=[D,P,...$].filter(Boolean).map(G=>G.ref.current);lj(X,p)}}k.current=!1}),onBlur:ra(t.onBlur,()=>S(!1))})})}),ij="RovingFocusGroupItem",oj=f.forwardRef((t,n)=>{const{__scopeRovingFocusGroup:s,focusable:r=!0,active:i=!1,tabStopId:o,...c}=t,d=Fi(),u=o||d,m=O5(ij,s),p=m.currentTabStopId===u,x=nj(s),{onFocusableItemAdd:g,onFocusableItemRemove:v}=m;return f.useEffect(()=>{if(r)return g(),()=>v()},[r,g,v]),e.jsx(nf.ItemSlot,{scope:s,id:u,focusable:r,active:i,children:e.jsx(eo.span,{tabIndex:p?0:-1,"data-orientation":m.orientation,...c,ref:n,onMouseDown:ra(t.onMouseDown,j=>{r?m.onItemFocus(u):j.preventDefault()}),onFocus:ra(t.onFocus,()=>m.onItemFocus(u)),onKeyDown:ra(t.onKeyDown,j=>{if(j.key==="Tab"&&j.shiftKey){m.onItemShiftTab();return}if(j.target!==j.currentTarget)return;const b=z5(j,m.orientation,m.dir);if(b!==void 0){if(j.metaKey||j.ctrlKey||j.altKey||j.shiftKey)return;j.preventDefault();let N=x().filter(S=>S.focusable).map(S=>S.ref.current);if(b==="last")N.reverse();else if(b==="prev"||b==="next"){b==="prev"&&N.reverse();const S=N.indexOf(j.currentTarget);N=m.loop?F5(N,S+1):N.slice(S+1)}setTimeout(()=>lj(N))}})})})});oj.displayName=ij;var L5={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $5(t,n){return n!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function z5(t,n,s){const r=$5(t.key,s);if(!(n==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(n==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return L5[r]}function lj(t,n=!1){const s=document.activeElement;for(const r of t)if(r===s||(r.focus({preventScroll:n}),document.activeElement!==s))return}function F5(t,n){return t.map((s,r)=>t[(n+r)%t.length])}var B5=aj,W5=oj;function H5(t,n){return f.useReducer((s,r)=>n[s][r]??s,t)}var cj=t=>{const{present:n,children:s}=t,r=U5(n),i=typeof s=="function"?s({present:r.isPresent}):f.Children.only(s),o=ed(r.ref,V5(i));return typeof s=="function"||r.isPresent?f.cloneElement(i,{ref:o}):null};cj.displayName="Presence";function U5(t){const[n,s]=f.useState(),r=f.useRef({}),i=f.useRef(t),o=f.useRef("none"),c=t?"mounted":"unmounted",[d,u]=H5(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return f.useEffect(()=>{const m=Pc(r.current);o.current=d==="mounted"?m:"none"},[d]),rr(()=>{const m=r.current,p=i.current;if(p!==t){const g=o.current,v=Pc(m);t?u("MOUNT"):v==="none"||(m==null?void 0:m.display)==="none"?u("UNMOUNT"):u(p&&g!==v?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,u]),rr(()=>{if(n){let m;const p=n.ownerDocument.defaultView??window,x=v=>{const b=Pc(r.current).includes(v.animationName);if(v.target===n&&b&&(u("ANIMATION_END"),!i.current)){const y=n.style.animationFillMode;n.style.animationFillMode="forwards",m=p.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=y)})}},g=v=>{v.target===n&&(o.current=Pc(r.current))};return n.addEventListener("animationstart",g),n.addEventListener("animationcancel",x),n.addEventListener("animationend",x),()=>{p.clearTimeout(m),n.removeEventListener("animationstart",g),n.removeEventListener("animationcancel",x),n.removeEventListener("animationend",x)}}else u("ANIMATION_END")},[n,u]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:f.useCallback(m=>{m&&(r.current=getComputedStyle(m)),s(m)},[])}}function Pc(t){return(t==null?void 0:t.animationName)||"none"}function V5(t){var r,i;let n=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,s=n&&"isReactWarning"in n&&n.isReactWarning;return s?t.ref:(n=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,s=n&&"isReactWarning"in n&&n.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var ap="Tabs",[G5,E$]=za(ap,[rj]),dj=rj(),[q5,ip]=G5(ap),uj=f.forwardRef((t,n)=>{const{__scopeTabs:s,value:r,onValueChange:i,defaultValue:o,orientation:c="horizontal",dir:d,activationMode:u="automatic",...m}=t,p=cl(d),[x,g]=aa({prop:r,onChange:i,defaultProp:o});return e.jsx(q5,{scope:s,baseId:Fi(),value:x,onValueChange:g,orientation:c,dir:p,activationMode:u,children:e.jsx(eo.div,{dir:p,"data-orientation":c,...m,ref:n})})});uj.displayName=ap;var mj="TabsList",fj=f.forwardRef((t,n)=>{const{__scopeTabs:s,loop:r=!0,...i}=t,o=ip(mj,s),c=dj(s);return e.jsx(B5,{asChild:!0,...c,orientation:o.orientation,dir:o.dir,loop:r,children:e.jsx(eo.div,{role:"tablist","aria-orientation":o.orientation,...i,ref:n})})});fj.displayName=mj;var pj="TabsTrigger",hj=f.forwardRef((t,n)=>{const{__scopeTabs:s,value:r,disabled:i=!1,...o}=t,c=ip(pj,s),d=dj(s),u=vj(c.baseId,r),m=yj(c.baseId,r),p=r===c.value;return e.jsx(W5,{asChild:!0,...d,focusable:!i,active:p,children:e.jsx(eo.button,{type:"button",role:"tab","aria-selected":p,"aria-controls":m,"data-state":p?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:u,...o,ref:n,onMouseDown:ra(t.onMouseDown,x=>{!i&&x.button===0&&x.ctrlKey===!1?c.onValueChange(r):x.preventDefault()}),onKeyDown:ra(t.onKeyDown,x=>{[" ","Enter"].includes(x.key)&&c.onValueChange(r)}),onFocus:ra(t.onFocus,()=>{const x=c.activationMode!=="manual";!p&&!i&&x&&c.onValueChange(r)})})})});hj.displayName=pj;var xj="TabsContent",gj=f.forwardRef((t,n)=>{const{__scopeTabs:s,value:r,forceMount:i,children:o,...c}=t,d=ip(xj,s),u=vj(d.baseId,r),m=yj(d.baseId,r),p=r===d.value,x=f.useRef(p);return f.useEffect(()=>{const g=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(g)},[]),e.jsx(cj,{present:i||p,children:({present:g})=>e.jsx(eo.div,{"data-state":p?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":u,hidden:!g,id:m,tabIndex:0,...c,ref:n,style:{...t.style,animationDuration:x.current?"0s":void 0},children:g&&o})})});gj.displayName=xj;function vj(t,n){return`${t}-trigger-${n}`}function yj(t,n){return`${t}-content-${n}`}var Y5=uj,bj=fj,jj=hj,wj=gj;const mr=Y5,fr=f.forwardRef(({className:t,...n},s)=>e.jsx(bj,{ref:s,className:ce("inline-flex h-10 md:h-12 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground w-full md:w-auto overflow-x-auto",t),...n}));fr.displayName=bj.displayName;const qt=f.forwardRef(({className:t,...n},s)=>e.jsx(jj,{ref:s,className:ce("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 md:px-4 md:py-2 text-sm md:text-base font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm touch-manipulation active:scale-95 min-w-0 flex-1 md:flex-initial",t),...n}));qt.displayName=jj.displayName;const At=f.forwardRef(({className:t,...n},s)=>e.jsx(wj,{ref:s,className:ce("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...n}));At.displayName=wj.displayName;const K5=()=>{const[t,n]=f.useState(new Date),[s,r]=f.useState(new Date),[i,o]=f.useState(new Date),{user:c}=He(),{settings:d,saveSettings:u}=rp("water",{dailyGoal:2e3}),[m,p]=f.useState(d.dailyGoal);f.useEffect(()=>{p(d.dailyGoal)},[d.dailyGoal]);const x=(g,v)=>{r(g),o(v)};return c?e.jsxs(Ss,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Control de Hidratación"}),e.jsx("p",{className:"text-gray-500",children:"Registra y monitorea tu consumo diario de agua"})]}),e.jsxs(mr,{defaultValue:"daily",className:"w-full",children:[e.jsxs(fr,{className:"mb-6",children:[e.jsx(qt,{value:"daily",children:"Registro Diario"}),e.jsx(qt,{value:"stats",children:"Estadísticas"}),e.jsx(qt,{value:"settings",children:"Configuración"})]}),e.jsxs(At,{value:"daily",children:[e.jsx(kr,{selectedDate:t,onChange:n}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[1fr_300px]",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(Cb,{selectedDate:t,goal:d.dailyGoal}),e.jsx(T5,{selectedDate:t})]}),e.jsx("div",{children:e.jsx(LO,{selectedDate:t,goal:d.dailyGoal})})]})]}),e.jsxs(At,{value:"stats",children:[e.jsx(S5,{onPeriodChange:x}),e.jsx(C5,{startDate:s,endDate:i})]}),e.jsx(At,{value:"settings",className:"space-y-4",children:e.jsx(je,{children:e.jsxs(we,{className:"pt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ye,{htmlFor:"goal",children:"Meta diaria (ml)"}),e.jsx(Ve,{id:"goal",type:"number",value:m,onChange:g=>p(Number(g.target.value))})]}),e.jsx(F,{onClick:()=>u({dailyGoal:m}),children:"Guardar"})]})})})]})]}):e.jsx(Ss,{children:e.jsx(je,{children:e.jsx(we,{className:"p-6",children:e.jsx("p",{className:"text-center",children:"Inicia sesión para ver tus estadísticas de hidratación"})})})})};function J5(){const[t,n]=f.useState(new Date),{user:s}=He();return s?e.jsxs(Ss,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Pomodoro Timer"}),e.jsx("p",{className:"text-gray-500",children:"Gestiona tus sesiones de trabajo y productividad"})]}),e.jsx(kr,{selectedDate:t,onChange:n}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[1fr_300px]",children:[e.jsx("div",{className:"space-y-6",children:e.jsx(hy,{selectedDate:t})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(LI,{selectedDate:t}),e.jsx(hg,{dateRange:"week"}),e.jsx(hg,{dateRange:"month"})]})]})]}):e.jsx(Ss,{children:e.jsx("div",{className:"text-center py-8",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesión para ver tus estadísticas"})})})}const Yg=["#FF8042","#00C49F","#FFBB28","#FF8042","#0088FE","#FF0000"],X5=()=>{const[t,n]=f.useState(new Date),[s]=f.useState([]);return e.jsxs(Ss,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Estado de Ánimo"}),e.jsx("p",{className:"text-gray-500",children:"Registra y analiza tu estado emocional para mejorar tu bienestar"})]}),e.jsx(kr,{selectedDate:t,onChange:n}),e.jsxs(mr,{defaultValue:"tracker",className:"space-y-4",children:[e.jsxs(fr,{children:[e.jsx(qt,{value:"tracker",children:"Registro Diario"}),e.jsx(qt,{value:"analytics",children:"Análisis"}),e.jsx(qt,{value:"settings",children:"Configuración"})]}),e.jsx(At,{value:"tracker",className:"space-y-4",children:e.jsx(tp,{selectedDate:t})}),e.jsx(At,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(je,{children:e.jsxs(we,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Distribución de Estados de Ánimo"}),e.jsx("div",{className:"h-64",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ul,{children:[e.jsx(ml,{data:s,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({cx:r,cy:i,midAngle:o,innerRadius:c,outerRadius:d,value:u,index:m})=>{const p=Math.PI/180,x=25+c+(d-c),g=r+x*Math.cos(-o*p),v=i+x*Math.sin(-o*p);return e.jsx("text",{x:g,y:v,fill:"#888",textAnchor:g>r?"start":"end",dominantBaseline:"central",children:`${s[m].name} (${u})`})},children:s.map(r=>e.jsx(fl,{fill:Yg[r%Yg.length]},`cell-${r}`))}),e.jsx(Fs,{})]})})})]})}),e.jsx(je,{children:e.jsx(we,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Patrones y Tendencias"})})})]})}),e.jsxs(At,{value:"settings",className:"space-y-4",children:[e.jsx(je,{children:e.jsx(we,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Configuración de Estados de Ánimo"})})}),"        "]})]})]})},Z5=({selectedDate:t})=>e.jsx(x4,{children:e.jsx(v4,{children:e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(sj,{selectedDate:t})}),e.jsxs("div",{className:"md:col-span-1 space-y-4",children:[e.jsx(tp,{selectedDate:t,energyFirst:!0}),e.jsxs(Zi,{children:[e.jsx(Hv,{className:"h-4 w-4"}),e.jsx(Qi,{children:"Registrar tu estado de ánimo junto con tus entradas del diario te ayuda a mantener un mejor seguimiento de tus emociones y experiencias."})]})]})]})})})}),Kg={currentWeek:{label:"Semana actual",getValue:t=>({start:Cr(t),end:$n(t)})},currentMonth:{label:"Mes actual",getValue:t=>({start:_t(t),end:wn(t)})}},Q5=({onPeriodChange:t})=>{const n=s=>{const r=new Date,i=Kg[s];if(i){const{start:o,end:c}=i.getValue(r);t(o,c)}};return e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("span",{className:"text-sm font-medium",children:"Mostrar período:"}),e.jsxs(ft,{onValueChange:n,defaultValue:"currentWeek",children:[e.jsx(ct,{className:"w-[180px]",children:e.jsx(pt,{placeholder:"Seleccionar período"})}),e.jsx(dt,{children:Object.entries(Kg).map(([s,{label:r}])=>e.jsx(De,{value:s,children:r},s))})]})]})},eL=(t,n)=>{const[s,r]=f.useState(null),[i,o]=f.useState(!0),[c,d]=f.useState(null),{user:u}=He();return f.useEffect(()=>{(async()=>{if(u){o(!0),d(null);try{const p=[],x=new Date(t),g=new Date(n);for(;x<=g;)p.push(Oe(x)),x.setDate(x.getDate()+1);const v=p.map(R=>{const I=be(fe,"journal",`${u.uid}_${R}`);return ds(I)}),j=p.map(R=>{const I=be(fe,"moods",`${u.uid}_${R}`);return ds(I)}),b=await Promise.all(v),y=await Promise.all(j),N=new Map(p.map(R=>[R,{date:R,words:0,characters:0}]));b.forEach(R=>{var I,O;if(R.exists()){const H=R.data();N.set(H.date,{date:H.date,words:((I=H.text)==null?void 0:I.split(/\s+/).filter(Boolean).length)||0,characters:((O=H.text)==null?void 0:O.length)||0})}});const S=Array.from(N.values()).sort((R,I)=>R.date<I.date?1:-1),E={};y.forEach(R=>{if(R.exists()){const I=R.data();Array.isArray(I.moods)&&I.moods.forEach(O=>{E[O.text]=(E[O.text]||0)+1})}});const T=Object.entries(E).map(([R,I])=>({name:R,value:I})).sort((R,I)=>I.value-R.value).slice(0,5),k=S.filter(R=>R.words>0).length,M=k>0?Math.round(S.reduce((R,I)=>R+I.words,0)/k):0;r({entries:S,moodStats:T,totalEntries:k,averageWords:M})}catch(p){console.error("Error al cargar estadísticas del diario:",p),d(p instanceof Error?p.message:"Error al cargar estadísticas")}finally{o(!1)}}})()},[u,t,n]),{stats:s,loading:i,error:c}},Jg=["#8884d8","#82ca9d","#ffc658","#ff8042","#a4de6c"],tL=()=>{const[t,n]=f.useState(new Date),[s,r]=f.useState(Cr(new Date)),[i,o]=f.useState($n(new Date)),{user:c}=He(),{stats:d,loading:u,error:m}=eL(s,i),p=(x,g)=>{r(x),o(g)};return c?e.jsxs(Ss,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Diario Personal"}),e.jsx("p",{className:"text-gray-500",children:"Escribe y reflexiona sobre tus experiencias diarias"})]}),e.jsx(kr,{selectedDate:t,onChange:n}),e.jsxs(mr,{defaultValue:"entry",className:"space-y-4",children:[e.jsxs(fr,{children:[e.jsx(qt,{value:"entry",children:"Entrada Diaria"}),e.jsx(qt,{value:"analytics",children:"Análisis"}),e.jsx(qt,{value:"settings",children:"Configuración"})]}),e.jsx(At,{value:"entry",className:"space-y-4",children:e.jsx(Z5,{selectedDate:t})}),e.jsxs(At,{value:"analytics",className:"space-y-4",children:[e.jsx(Q5,{onPeriodChange:p}),u||!d?e.jsx("div",{className:"p-4",children:"Cargando estadísticas..."}):m?e.jsx("div",{className:"p-4 text-red-500",children:"Error al cargar estadísticas"}):e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(je,{children:e.jsxs(we,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Actividad de Escritura"}),e.jsx("div",{className:"h-64",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(pd,{data:d.entries,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"date"}),e.jsx(Mn,{}),e.jsx(Fs,{}),e.jsx(Qr,{}),e.jsx(Qo,{dataKey:"words",name:"Palabras",fill:"#8884d8"})]})})})]})}),e.jsx(je,{children:e.jsxs(we,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Estados de Ánimo Frecuentes"}),e.jsx("div",{className:"h-64",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ul,{children:[e.jsx(ml,{data:d.moodStats,nameKey:"name",dataKey:"value",cx:"50%",cy:"50%",outerRadius:80,label:!0,children:d.moodStats.map((x,g)=>e.jsx(fl,{fill:Jg[g%Jg.length]},x.name))}),e.jsx(Fs,{}),e.jsx(Qr,{})]})})})]})}),e.jsx(je,{children:e.jsxs(we,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Estadísticas Generales"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total de entradas"}),e.jsx("p",{className:"text-2xl font-bold",children:d.totalEntries})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Promedio de palabras"}),e.jsx("p",{className:"text-2xl font-bold",children:d.averageWords})]})]})]})}),e.jsx(je,{children:e.jsxs(we,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Sugerencias"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("p",{children:"• Escribe regularmente para mantener un mejor seguimiento de tus emociones"}),e.jsx("p",{children:"• Registra tu estado de ánimo junto con tus entradas del diario"}),e.jsx("p",{children:"• Revisa tus entradas anteriores para identificar patrones"}),e.jsx("p",{children:"• Usa las estadísticas para entender mejor tus hábitos de escritura"})]})]})})]})]}),e.jsx(At,{value:"settings",className:"space-y-4",children:e.jsxs(je,{children:[e.jsx(we,{className:"pt-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Configuración del Diario"})}),"          "]})})]})]}):e.jsx(Ss,{children:e.jsx("div",{className:"text-center py-8",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesión para acceder a tu diario"})})})},Xg=[{tab:"list",label:"Lista",icon:e.jsx(p_,{className:"h-4 w-4"})},{tab:"kanban",label:"Kanban",icon:e.jsx(h_,{className:"h-4 w-4"})},{tab:"week",label:"Calendario",icon:e.jsx(Nn,{className:"h-4 w-4"})},{tab:"analytics",label:"Análisis",icon:e.jsx(gf,{className:"h-4 w-4"})}],Zg=({title:t,actions:n=[],className:s,currentTab:r="list",onTabChange:i})=>e.jsx("div",{className:ce("",s),children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"bg-background/50 flex items-center justify-between gap-2 py-4 backdrop-blur-md lg:mt-4 lg:rounded-2xl lg:border lg:px-4",children:[e.jsx("div",{className:"flex items-center gap-5",children:e.jsxs("div",{className:"flex items-center gap-12",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-sm",children:e.jsx(hf,{className:"h-4 w-4 text-white"})}),e.jsx("h2",{className:"text-lg font-bold text-foreground",children:t})]}),e.jsx("nav",{className:"hidden md:flex gap-2 lg:gap-4",children:Xg.map(o=>{const c=r===o.tab;return e.jsxs("button",{onClick:()=>i==null?void 0:i(o.tab),className:ce("flex items-center space-x-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 group","hover:bg-white/90 hover:shadow-lg",c?"bg-white text-blue-700 shadow-lg border border-blue-200":"text-gray-700 hover:text-gray-900"),children:[e.jsx("span",{className:ce("p-1.5 rounded-lg transition-colors",c?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600 group-hover:bg-gray-200"),children:o.icon}),e.jsx("span",{className:"whitespace-nowrap",children:o.label})]},o.tab)})})]})}),n.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(zn,{children:e.jsx("div",{className:"hidden md:flex items-center gap-2",children:n.map(o=>o.dropdown?e.jsxs(Er,{children:[e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[o.icon,e.jsx("span",{className:"sr-only",children:o.label})]})})}),e.jsx(rs,{children:e.jsx("p",{children:o.tooltip})})]}),e.jsx(or,{align:"end",children:o.dropdown.map((c,d)=>e.jsx(ut,{onClick:c.onClick,children:c.label},d))})]},o.id):e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:o.onClick,children:[o.icon,e.jsx("span",{className:"sr-only",children:o.label})]})}),e.jsx(rs,{children:e.jsx("p",{children:o.tooltip})})]},o.id))})}),e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(pl,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(or,{align:"end",children:[n.map(o=>o.dropdown?e.jsxs(GO,{children:[e.jsxs(_b,{children:[o.icon,e.jsx("span",{className:"ml-2",children:o.label})]}),e.jsx(Db,{children:o.dropdown.map((c,d)=>e.jsx(ut,{onClick:c.onClick,children:c.label},d))})]},o.id):e.jsxs(ut,{onClick:o.onClick,children:[o.icon,e.jsx("span",{className:"ml-2",children:o.label})]},o.id)),e.jsx(Xi,{}),Xg.filter(o=>o.tab!==r).map(o=>e.jsxs(ut,{onClick:()=>i==null?void 0:i(o.tab),children:[e.jsx("span",{className:"mr-2",children:o.icon}),o.label]},o.tab))]})]})]})]})})}),Qg=["#0088FE","#00C49F","#FFBB28","#FF8042"],Nj=({defaultTab:t="list"})=>{const[n,s]=f.useState([]),[r,i]=f.useState([]),[o,c]=f.useState(!1),[d,u]=f.useState(""),[m,p]=f.useState(!1),[x,g]=f.useState(!1),[v,j]=f.useState(t),b=Y=>{j(Y)},{user:y}=He(),N=_l(),{tasks:S,showRecurrenceModal:E,currentTask:T,modalMode:k,addTask:M,editTask:R,completeRecurrentTask:I,setShowRecurrenceModal:O,openCreateModal:H}=N;f.useEffect(()=>{y&&$()},[y]);const $=async()=>{if(!y)return;const Y=_r($t(fe,"tasks"),un("userId","==",y.uid),Gk(100)),ye=(await Wi(Y)).docs.map(se=>se.data()).sort((se,ge)=>{var _e,We,Pe,Le;const Me=((We=(_e=se.createdAt)==null?void 0:_e.toDate)==null?void 0:We.call(_e))||new Date(0);return(((Le=(Pe=ge.createdAt)==null?void 0:Pe.toDate)==null?void 0:Le.call(Pe))||new Date(0)).getTime()-Me.getTime()}),oe=ye.reduce((se,ge)=>{var pe,_e,We,Pe;const Me=((Pe=(We=(_e=(pe=ge.createdAt)==null?void 0:pe.toDate)==null?void 0:_e.call(pe))==null?void 0:We.toISOString)==null?void 0:Pe.call(We).split("T")[0])||"unknown";return se[Me]||(se[Me]={date:Me,completed:0,pending:0}),se[Me][ge.completed?"completed":"pending"]++,se},{});s(Object.values(oe));const me=ye.filter(se=>se.completed).length,W=ye.filter(se=>!se.completed).length;i([{name:"Completadas",value:me},{name:"Pendientes",value:W}])};if(!y)return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(Zg,{title:"Tareas",actions:[],currentTab:v,onTabChange:b}),e.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:e.jsx("div",{className:"text-center py-8",children:e.jsx("h2",{className:"text-xl font-semibold",children:"Inicia sesión para ver tus tareas"})})})]});const D=()=>{H()},P=()=>{c(!0)},K=()=>{try{const Y=JSON.parse(d);if(!Array.isArray(Y)){kt.error("El JSON debe contener un array de tareas");return}let ae=0,ye=0;Y.forEach(oe=>{if(oe.title){let me;if(oe.dueDate){const W=new Date(oe.dueDate);isNaN(W.getTime())?(ye++,console.warn(`Fecha inválida para tarea "${oe.title}": ${oe.dueDate}`)):me=W}console.log("Would import task:",{title:oe.title,description:oe.description||"",dueDate:me,category:oe.category||"personal",priority:oe.priority||void 0,isPrivate:!1,isRecurrent:oe.isRecurrent||!1,size:oe.size||void 0}),ae++}}),ye>0?kt.warning(`${ae} tareas procesadas. ${ye} fechas inválidas fueron omitidas.`):kt.success(`${ae} tareas procesadas correctamente`),u(""),c(!1)}catch(Y){kt.error("Error al importar las tareas. Verifica el formato JSON."),console.error("Error de importación:",Y)}},X=()=>{kt.success("Funcionalidad de exportar - será implementada")},G=()=>{},U=[{id:"new",label:"Nueva Tarea",icon:e.jsx(Ns,{className:"h-4 w-4"}),onClick:D,tooltip:"Crear nueva tarea"},{id:"import",label:"Importar",icon:e.jsx(Oi,{className:"h-4 w-4"}),onClick:P,tooltip:"Importar tareas"},{id:"export",label:"Exportar",icon:e.jsx(Fn,{className:"h-4 w-4"}),onClick:X,tooltip:"Exportar tareas"},{id:"ai",label:"AI Assistant",icon:e.jsx(x_,{className:"h-4 w-4"}),onClick:G,tooltip:"Asistente IA",dropdown:[{label:"Sugerir tareas",onClick:()=>p(!0)},{label:"Repriorizar visibles",onClick:()=>g(!0)}]}];return e.jsxs("div",{className:"min-h-screen",children:[e.jsx(Zg,{title:"Tareas",actions:U,currentTab:v,onTabChange:b}),e.jsx("div",{className:"p-4",children:e.jsxs(mr,{value:v,onValueChange:b,className:"space-y-4",children:[e.jsx(At,{value:"list",className:"space-y-4",children:e.jsx(tj,{})}),e.jsx(At,{value:"kanban",className:"space-y-4",children:e.jsx(d5,{})}),e.jsx(At,{value:"week",className:"space-y-4",children:e.jsx(c5,{})}),e.jsx(At,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 xl:grid-cols-2 gap-4 lg:gap-6 xl:gap-8 desktop-grid-responsive",children:[e.jsx(je,{className:"desktop-card-enhanced",children:e.jsxs(we,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Progreso de Tareas"}),e.jsx("div",{className:"h-64 lg:h-80",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ri,{data:n,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"date"}),e.jsx(Mn,{}),e.jsx(Fs,{}),e.jsx(Qr,{}),e.jsx(Aa,{type:"monotone",dataKey:"completed",name:"Completadas",stroke:"#8884d8"}),e.jsx(Aa,{type:"monotone",dataKey:"pending",name:"Pendientes",stroke:"#82ca9d"})]})})})]})}),e.jsx(je,{className:"desktop-card-enhanced",children:e.jsxs(we,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Estado General"}),e.jsx("div",{className:"h-64 lg:h-80",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ul,{children:[e.jsx(ml,{data:r,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({cx:Y,cy:ae,midAngle:ye,innerRadius:oe,outerRadius:me,percent:W,name:se})=>{const ge=Math.PI/180,Me=25+oe+(me-oe),pe=Y+Me*Math.cos(-ye*ge),_e=ae+Me*Math.sin(-ye*ge);return e.jsx("text",{x:pe,y:_e,fill:"#888",textAnchor:pe>Y?"start":"end",dominantBaseline:"central",children:`${se} (${(W*100).toFixed(0)}%)`})},children:r.map(Y=>e.jsx(fl,{fill:Qg[Y%Qg.length]},`cell-${Y}`))}),e.jsx(Fs,{})]})})})]})})]})})]})}),e.jsx(n5,{tasks:S,open:m,onOpenChange:p}),e.jsx(a5,{tasks:S,onUpdate:R,open:x,onOpenChange:g}),e.jsx(kl,{isOpen:E,onClose:()=>O(),onConfirm:Y=>{k==="complete"?I(Y):k==="edit"?R(T.id,Y):M(Y)},task:T||{id:"",title:"",completed:!1,category:"personal",createdAt:{seconds:Date.now()/1e3}},mode:k}),e.jsx(yt,{open:o,onOpenChange:c,children:e.jsxs(xt,{className:"max-w-4xl",children:[e.jsxs(bt,{children:[e.jsx(jt,{children:"Importar Tareas"}),e.jsx(mn,{children:"Pega el JSON con las tareas a importar. Puedes incluir fechas en varios formatos."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(vt,{placeholder:`Ejemplo - Importa tareas con fechas en diferentes formatos:
[
  {
    "title": "Completar proyecto importante",
    "description": "Terminar la implementación",
    "dueDate": "2024-12-31",
    "category": "work",
    "priority": "do",
    "size": "grande"
  },
  {
    "title": "Revisión médica anual", 
    "description": "Chequeo general de salud",
    "dueDate": "2024-07-15T09:00:00Z",
    "category": "health",
    "priority": "decide"
  },
  {
    "title": "Tarea flexible",
    "description": "Esta tarea no tiene fecha límite específica",
    "category": "personal",
    "isRecurrent": true
  }
]

Formatos de fecha soportados:
- "2024-12-31" (solo fecha)
- "2024-06-15T14:30:00Z" (fecha y hora ISO)
- "2024-06-15T14:30:00" (fecha y hora local)
- Sin campo "dueDate" = sin fecha asignada

Campos opcionales:
- description, dueDate, priority, size, isRecurrent`,value:d,onChange:Y=>u(Y.target.value),rows:20,className:"font-mono text-sm"}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(F,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),e.jsx(F,{onClick:K,disabled:!d.trim(),children:"Importar Tareas"})]})]})]})})]})},sL=()=>e.jsx(Nj,{defaultTab:"kanban"}),nL=()=>{const[t,n]=f.useState(new Date),[s]=f.useState([]);return e.jsxs(Ss,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Seguimiento de Hábitos"}),e.jsx("p",{className:"text-gray-500",children:"Registra y analiza tus hábitos diarios para mejorar tu estilo de vida"})]}),e.jsx(kr,{selectedDate:t,onChange:n}),e.jsxs(mr,{defaultValue:"tracker",children:[e.jsxs(fr,{children:[e.jsx(qt,{value:"tracker",children:"Registro Diario"}),e.jsx(qt,{value:"analytics",children:"Análisis"})]}),e.jsx(At,{value:"tracker",children:e.jsx("div",{className:"grid grid-cols-1",children:e.jsx(qb,{selectedDate:t})})}),"        ",e.jsx(At,{value:"analytics",className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 gap-4 lg:gap-6 xl:gap-8 desktop-grid-responsive",children:[e.jsx(je,{className:"desktop-card-enhanced",children:e.jsxs(we,{className:"p-4 lg:p-6",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Tendencias de Hábitos"}),e.jsx("div",{className:"h-64 md:h-80 lg:h-96",children:e.jsx(zs,{children:e.jsxs(ri,{data:s,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"date"}),e.jsx(Mn,{}),e.jsx(Fs,{}),e.jsx(Qr,{}),Ma.map(r=>e.jsx(Aa,{type:"monotone",dataKey:r.name,name:`${r.icon} ${r.name}`,stroke:`var(--${r.name.toLowerCase()}-color)`},r.id))]})})})]})}),e.jsx(je,{className:"desktop-card-enhanced",children:e.jsx(we,{className:"p-4 lg:p-6",children:e.jsx("h3",{className:"font-medium mb-4",children:"Resumen del Mes"})})})]})})]})]})},_s={breakfast:{icon:Tm,title:"Desayuno",color:"bg-amber-100",hoverColor:"hover:bg-amber-200",order:1},morningSnack:{icon:Kv,title:"Media Mañana",color:"bg-orange-100",hoverColor:"hover:bg-orange-200",order:2},lunch:{icon:Uv,title:"Almuerzo",color:"bg-emerald-100",hoverColor:"hover:bg-emerald-200",order:3},afternoonSnack:{icon:g_,title:"Merienda",color:"bg-purple-100",hoverColor:"hover:bg-purple-200",order:4},dinner:{icon:Jv,title:"Cena",color:"bg-indigo-100",hoverColor:"hover:bg-indigo-200",order:5}},op={breakfast:8,morningSnack:11,lunch:14,afternoonSnack:17,dinner:20},rL=(t,n)=>{const[s,r,i]=t.split("-").map(Number);return new Date(s,r-1,i,op[n]||0,0,0,0).getTime()<Date.now()},aL=(t=new Date)=>{const n=new Date(t);let s=n.getDay();s=s===0?6:s-1;const r=[];for(let i=0;i<7;i++){const o=new Date(n);o.setDate(n.getDate()-s+i),r.push({dayName:["L","M","X","J","V","S","D"][i],fullDate:Oe(o),isCurrentMonth:o.getMonth()===n.getMonth(),date:new Date(o)})}return r},iL=()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`},oL=1,lL=1e6;let vm=0;function cL(){return vm=(vm+1)%Number.MAX_SAFE_INTEGER,vm.toString()}const ym=new Map,ev=t=>{if(ym.has(t))return;const n=setTimeout(()=>{ym.delete(t),Go({type:"REMOVE_TOAST",toastId:t})},lL);ym.set(t,n)},dL=(t,n)=>{switch(n.type){case"ADD_TOAST":return{...t,toasts:[n.toast,...t.toasts].slice(0,oL)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(s=>s.id===n.toast.id?{...s,...n.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=n;return s?ev(s):t.toasts.forEach(r=>{ev(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===s||s===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return n.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(s=>s.id!==n.toastId)}}},$c=[];let zc={toasts:[]};function Go(t){zc=dL(zc,t),$c.forEach(n=>{n(zc)})}function uL({...t}){const n=cL(),s=i=>Go({type:"UPDATE_TOAST",toast:{...i,id:n}}),r=()=>Go({type:"DISMISS_TOAST",toastId:n});return Go({type:"ADD_TOAST",toast:{...t,id:n,open:!0,onOpenChange:i=>{i||r()}}}),{id:n,dismiss:r,update:s}}function Md(){const[t,n]=f.useState(zc);return f.useEffect(()=>($c.push(n),()=>{const s=$c.indexOf(n);s>-1&&$c.splice(s,1)}),[t]),{...t,toast:uL,dismiss:s=>Go({type:"DISMISS_TOAST",toastId:s})}}const mL=({day:t,mealPlan:n,onOpenModal:s})=>{const r=new Date,i=new Date(t.fullDate),o=i.toDateString()===r.toDateString(),c=i<r&&!o,[d,u]=f.useState(!c),m=Object.keys(n[t.fullDate]||{}).length,p=Object.keys(_s).length;return e.jsxs("div",{className:`mx-2 my-3 rounded-xl shadow-sm border transition-all duration-200 ${c?"bg-gray-50 border-gray-200 opacity-75":"bg-white border-gray-100"}`,children:[e.jsxs("div",{className:`flex justify-between items-center p-4 ${c?"cursor-pointer hover:bg-gray-100":""} ${d?"border-b border-gray-100 rounded-t-xl":"rounded-xl"}`,onClick:c?()=>u(!d):void 0,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c&&e.jsx("div",{className:"text-gray-400",children:d?e.jsx(Dr,{className:"w-4 h-4"}):e.jsx(ia,{className:"w-4 h-4"})}),e.jsxs("h3",{className:`font-semibold text-base ${c?"text-gray-500":o?"text-blue-600":"text-gray-900"}`,children:[t.dayName,o&&" (Hoy)"]}),c&&!d&&e.jsxs("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded-md",children:[m,"/",p]})]}),e.jsx("span",{className:`text-sm px-2 py-1 rounded-md ${c?"text-gray-400 bg-gray-100":"text-gray-500 bg-gray-50"}`,children:t.fullDate.split("-").slice(1).join("/")})]}),d&&e.jsx("div",{className:"p-4 pt-0 space-y-3",children:Object.entries(_s).sort(([,x],[,g])=>x.order-g.order).map(([x,g])=>{var y;const v=(y=n[t.fullDate])==null?void 0:y[x],{color:j,hoverColor:b}=g;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex flex-col items-center w-12 shrink-0",children:[e.jsx(g.icon,{className:`w-5 h-5 mb-1 ${c?"text-gray-400":"text-gray-600"}`}),e.jsxs("span",{className:`text-xs text-center leading-tight ${c?"text-gray-400":"text-gray-500"}`,children:[op[x],":00"]})]}),v?e.jsxs("div",{className:`flex-1 p-3 rounded-lg transition-all duration-200 cursor-pointer border active:scale-95 ${c?"bg-gray-100 border-gray-200 hover:bg-gray-150":`${j} ${b} border-gray-200`}`,onClick:()=>s(t.fullDate,x,v),children:[e.jsx("div",{className:`font-medium text-sm mb-1 line-clamp-1 ${c?"text-gray-500":"text-gray-900"}`,children:v.name}),v.notes&&e.jsx("div",{className:`text-xs line-clamp-2 mb-2 ${c?"text-gray-400":"text-gray-600"}`,children:v.notes}),v.recipe&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-gray-400":"bg-blue-500"}`}),e.jsx("span",{className:`text-xs ${c?"text-gray-400":"text-blue-600"}`,children:"Receta"})]})]}):e.jsxs(F,{variant:"outline",disabled:c,className:`flex-1 justify-start border-dashed h-auto py-3 text-sm transition-all ${c?"border-gray-200 text-gray-400 bg-gray-50 cursor-not-allowed":"border-gray-300 text-gray-600 hover:bg-gray-50 active:scale-95"}`,onClick:()=>!c&&s(t.fullDate,x),children:[e.jsx(Ns,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"truncate",children:c?"No agregado":`Agregar ${g.title.toLowerCase()}`})]})]},x)})})]})},fL=({date:t,type:n,meal:s,disabled:r,onOpenModal:i})=>{const{color:o,hoverColor:c}=_s[n],d=rL(t,n);return s?e.jsxs("div",{className:`h-full p-2 rounded ${o} relative group cursor-pointer transition-all duration-200 ease-in-out hover:shadow-md ${d?"opacity-50 grayscale":""}`,onClick:()=>i(t,n,s),children:[e.jsx("p",{className:"text-sm font-medium line-clamp-2",children:s.name}),s.notes&&e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:s.notes}),s.recipe&&e.jsx("div",{className:"absolute bottom-1 right-1",children:e.jsx("div",{className:"w-2 h-2 bg-sky-500 rounded-full"})}),e.jsx("div",{className:`absolute inset-0 flex items-center justify-center 
        bg-background/75 opacity-0 group-hover:opacity-100 rounded transition-opacity ${c}`,children:e.jsx(md,{className:"h-4 w-4 text-gray-700"})})]}):e.jsx(F,{variant:"outline",className:`w-full h-full border-dashed ${d?"opacity-50":""}`,onClick:()=>i(t,n),disabled:r,children:e.jsx(Ns,{className:"h-4 w-4"})})},pL=({day:t,mealPlan:n,disabled:s,onOpenModal:r})=>e.jsxs("div",{className:`px-2 ${t.isCurrentMonth?"":"bg-muted"}`,children:[e.jsxs("div",{className:"text-center py-2 border-b",children:[e.jsx("div",{className:"font-medium",children:t.dayName}),e.jsx("div",{className:"text-xs text-gray-500",children:t.fullDate.split("-").slice(1).join("/")})]}),Object.entries(_s).sort(([,i],[,o])=>i.order-o.order).map(([i])=>{var o;return e.jsx("div",{className:"h-32 py-2",children:e.jsx(fL,{date:t.fullDate,type:i,meal:(o=n[t.fullDate])==null?void 0:o[i],disabled:s,onOpenModal:r})},i)})]}),Dl=()=>{const{user:t}=He(),[n,s]=f.useState([]),[r,i]=f.useState("idle"),[o,c]=f.useState(null);f.useEffect(()=>{if(!t){s([]);return}i("loading");const x=_r($t(fe,"shopping-list"),un("userId","==",t.uid)),g=ns(x,v=>{if(v.empty){s([]),i("idle");return}const j=v.docs.map(b=>{const y=b.data();return{id:b.id,name:y.name||"",quantity:y.quantity||0,status:y.status||"to-buy",...y.price!==void 0&&{price:y.price},...y.category&&{category:y.category},...y.place&&{place:y.place},...y.consumeBy&&{consumeBy:y.consumeBy},...y.nextPurchase&&{nextPurchase:y.nextPurchase}}});s(j),i("idle")},v=>{(v==null?void 0:v.code)==="permission-denied"?(c("Error de permisos - Verificar reglas de Firestore"),i("error")):(c(v instanceof Error?v.message:"Error al cargar"),i("error"),s([]))});return()=>{g()}},[t]);const d=async x=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{const g=n.find(j=>j.name.toLowerCase()===x.name.toLowerCase());if(g){const j=g.quantity+Number(x.quantity);g.status==="low-stock"?await u(g.id,{quantity:j}):g.status==="to-buy"?await u(g.id,{quantity:j,status:"in-stock"}):await u(g.id,{quantity:j}),i("idle");return}const v={userId:t.uid,name:x.name,quantity:Number(x.quantity),status:x.status,createdAt:lt(),updatedAt:lt()};x.price!==void 0&&x.price!==null&&!isNaN(Number(x.price))&&(v.price=Number(x.price)),x.category&&typeof x.category=="string"&&x.category.trim()!==""&&(v.category=x.category.trim()),x.place&&typeof x.place=="string"&&x.place.trim()!==""&&(v.place=x.place.trim()),x.consumeBy&&typeof x.consumeBy=="string"&&x.consumeBy.trim()!==""&&(v.consumeBy=x.consumeBy.trim()),x.nextPurchase&&(v.nextPurchase=!0),await Jo($t(fe,"shopping-list"),v),i("idle")}catch(g){const v=g instanceof Error?g.message:"Error al guardar";c(v),i("error")}},u=async(x,g)=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{const v=be(fe,"shopping-list",x),j={updatedAt:lt()};g.name!==void 0&&(j.name=g.name),g.quantity!==void 0&&(j.quantity=Number(g.quantity)),g.status!==void 0&&(j.status=g.status),g.price!==void 0&&g.price!==null&&!isNaN(Number(g.price))&&(j.price=Number(g.price)),g.category!==void 0&&typeof g.category=="string"&&g.category.trim()!==""&&(j.category=g.category.trim()),g.place!==void 0&&typeof g.place=="string"&&g.place.trim()!==""&&(j.place=g.place.trim()),g.consumeBy!==void 0&&typeof g.consumeBy=="string"&&g.consumeBy.trim()!==""&&(j.consumeBy=g.consumeBy.trim()),g.nextPurchase!==void 0&&(j.nextPurchase=g.nextPurchase),await jn(v,j),i("idle")}catch(v){const j=v instanceof Error?v.message:"Error al actualizar";c(j),i("error")}};return{items:n,status:r,error:o,addItem:d,updateItem:u,deleteItem:async x=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{await ci(be(fe,"shopping-list",x)),i("idle")}catch(g){const v=g instanceof Error?g.message:"Error al eliminar";c(v),i("error")}},moveItem:(x,g)=>{u(x,{status:g})}}},Qn=dr("meal"),tv=Qn?`https://generativelanguage.googleapis.com/v1beta/models/${Qn.model}:generateContent`:"",hL=({selectedMeal:t,onFormChange:n,onOverwriteDay:s})=>{var ae,ye,oe;const{items:r}=Dl(),[i,o]=f.useState(!1),[c,d]=f.useState(!1),[u,m]=f.useState(null),[p,x]=f.useState(""),[g,v]=f.useState(""),[j,b]=f.useState(0),[y,N]=f.useState(!1),[S,E]=f.useState(null),[T,k]=f.useState("meal"),M="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",R=((ae=Qn==null?void 0:Qn.prompts)==null?void 0:ae.meal)??"Genera una comida en formato JSON utilizando los ingredientes disponibles.",I=((ye=Qn==null?void 0:Qn.prompts)==null?void 0:ye.day)??"Genera todas las comidas del día en formato JSON.",O=Qn==null?void 0:Qn.params;f.useEffect(()=>{b(ur(p))},[p]);const H=()=>r.filter(W=>{if(W.category){const se=W.category.toLowerCase();if(["aseo","limpieza","cuidado personal","otro"].some(Me=>se.includes(Me)))return!1}return W.status==="in-stock"||W.status==="low-stock"}).map(W=>`${W.name} (${W.quantity})`).join(", "),$=me=>{const W=H(),se=g.trim();if(me==="meal"){let ge=`${R}
Dia: ${t.date}
Tipo: ${t.type}
Ingredientes: ${W}`;se&&(ge+=`
Preferencias: ${se}`),ge+=`
Devuelve JSON {"name":"","notes":"","recipe":""}`,x(ge)}else{let ge=`${I}
Dia completo: ${t.date}
Ingredientes: ${W}`;se&&(ge+=`
Preferencias: ${se}`),ge+=`
Devuelve JSON con llaves ${Object.keys(_s).join(", ")}.`,x(ge)}m(me)},D=()=>{m(null),x(""),b(0),N(!1),E(null)},P=async()=>{u==="meal"?(k("meal"),await K(p)):u==="day"&&(k("day"),await X(p))},K=async me=>{var W,se,ge,Me,pe;o(!0),N(!0),E(null);try{const _e=me,Pe=await(await fetch(`${tv}?key=${M}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:_e}]}],...O})})).json(),le=(((pe=(Me=(ge=(se=(W=Pe==null?void 0:Pe.candidates)==null?void 0:W[0])==null?void 0:se.content)==null?void 0:ge.parts)==null?void 0:Me[0])==null?void 0:pe.text)||"").match(/\{[\s\S]*\}/);if(le){const Re=JSON.parse(le[0]);E({name:Re.name||"",notes:Re.notes||"",recipe:Re.recipe||"",type:t.type})}}catch(_e){console.error("AI meal error",_e),E(null)}finally{o(!1)}},X=async me=>{var W,se,ge,Me,pe;d(!0),N(!0),E(null);try{const _e=me,Pe=await(await fetch(`${tv}?key=${M}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:_e}]}],...O})})).json(),le=(((pe=(Me=(ge=(se=(W=Pe==null?void 0:Pe.candidates)==null?void 0:W[0])==null?void 0:se.content)==null?void 0:ge.parts)==null?void 0:Me[0])==null?void 0:pe.text)||"").match(/\{[\s\S]*\}/);if(le){const Re=JSON.parse(le[0]);E(Re)}}catch(_e){console.error("AI day error",_e),E(null)}finally{d(!1)}},G=()=>{if(S){if(T==="meal")n("name",S.name||""),n("notes",S.notes||""),n("recipe",S.recipe||"");else{const me={};Object.keys(_s).forEach(W=>{S[W]&&(me[W]={type:W,name:S[W].name||"",notes:S[W].notes||"",recipe:S[W].recipe||""})}),s(me)}D()}},U=()=>{T==="meal"?K(p):X(p)},Y=()=>{N(!1),E(null)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(vt,{placeholder:"Preferencias (opcional)",value:g,onChange:me=>v(me.target.value),className:"h-20"}),e.jsxs(F,{type:"button",onClick:()=>$("meal"),disabled:i||!M,variant:"secondary",className:"w-full flex items-center gap-2",children:[i&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(Cc,{className:"w-4 h-4"})," Generar comida"]}),e.jsxs(F,{type:"button",onClick:()=>$("day"),disabled:c||!M,variant:"ghost",className:"w-full flex items-center gap-2",children:[c&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(Vx,{className:"w-4 h-4"})," Regenerar día"]}),(i||c)&&e.jsx(oa,{className:"mt-2"})]}),e.jsx(yt,{open:u!==null,onOpenChange:me=>me?null:D(),children:e.jsxs(xt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(bt,{className:"flex-shrink-0",children:[e.jsx(jt,{className:"text-xl",children:u==="meal"?"Generar Comida con IA":"Regenerar Día Completo con IA"}),e.jsx(mn,{children:u==="meal"?"La IA generará una comida específica basada en tus ingredientes disponibles y preferencias.":"La IA generará un plan completo del día con todas las comidas basándose en tus ingredientes disponibles."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(vt,{value:p,onChange:me=>x(me.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Instrucciones para generar comidas..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",j]}),j>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),!y&&e.jsxs(F,{onClick:P,disabled:(u==="meal"?i:c)||!M||j>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[(u==="meal"?i:c)&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(Cc,{className:"w-4 h-4"}),(u==="meal"?i:c)?"Generando...":"Generar comidas"]}),(i||c)&&e.jsx(oa,{className:"mt-2"})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:y?"Previsualización":"Información del proceso"})}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:y?e.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[e.jsx("div",{className:"flex-1 overflow-auto",children:(i||c)&&!S?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12 space-y-4",children:[e.jsx(Qt,{className:"w-8 h-8 animate-spin text-blue-500"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Generando ",T==="meal"?"comida":"plan del día","..."]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["La IA está creando tu ",T==="meal"?"comida personalizada":"plan completo del día"]})]})]}):S?T==="meal"?e.jsxs(je,{className:"h-full",children:[e.jsx(Mt,{className:"pb-3",children:e.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[e.jsx(Cc,{className:"w-4 h-4 text-blue-500"}),"Comida Generada"]})}),e.jsxs(we,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Nombre:"}),e.jsx("p",{className:"text-sm mt-1",children:S.name||"Sin nombre"})]}),S.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Notas:"}),e.jsx("p",{className:"text-sm mt-1 text-gray-600",children:S.notes})]}),S.recipe&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Receta:"}),e.jsx("div",{className:"text-sm mt-1 text-gray-600 bg-gray-50 p-3 rounded-md max-h-32 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap font-sans",children:S.recipe})})]})]})]}):e.jsx("div",{className:"space-y-3",children:Object.keys(_s).map(me=>{var se;const W=S[me];return W?e.jsxs(je,{className:"border border-gray-200",children:[e.jsx(Mt,{className:"pb-2",children:e.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[e.jsx(Cc,{className:"w-3 h-3 text-blue-500"}),(se=_s[me])==null?void 0:se.title]})}),e.jsxs(we,{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nombre:"}),e.jsx("span",{className:"ml-1",children:W.name||"Sin nombre"})]}),W.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Notas:"}),e.jsx("span",{className:"ml-1 text-gray-600",children:W.notes})]}),W.recipe&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Receta:"}),e.jsx("div",{className:"mt-1 text-gray-600 bg-gray-50 p-2 rounded text-xs max-h-16 overflow-y-auto",children:e.jsxs("pre",{className:"whitespace-pre-wrap font-sans",children:[W.recipe.substring(0,100),"..."]})})]})]})]},me):null})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-12 space-y-4",children:[e.jsx(Js,{className:"w-8 h-8 text-red-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Error al generar"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No se pudo generar el contenido. Intenta nuevamente."})]})]})}),S&&e.jsxs("div",{className:"flex flex-col gap-2 pt-3 border-t",children:[e.jsxs(F,{onClick:G,className:"w-full gap-2",size:"sm",children:[e.jsx(Hi,{className:"w-4 h-4"}),"Insertar"]}),e.jsxs(F,{onClick:U,variant:"secondary",className:"w-full gap-2",size:"sm",disabled:i||c,children:[i||c?e.jsx(Qt,{className:"w-4 h-4 animate-spin"}):e.jsx(Vx,{className:"w-4 h-4"}),"Regenerar"]}),e.jsxs(F,{onClick:Y,variant:"outline",className:"w-full gap-2",size:"sm",children:[e.jsx(Js,{className:"w-4 h-4"}),"Cancelar"]})]}),!S&&e.jsx("div",{className:"flex justify-center pt-3 border-t",children:e.jsxs(F,{onClick:Y,variant:"outline",className:"gap-2",size:"sm",children:[e.jsx(Js,{className:"w-4 h-4"}),"Cancelar"]})})]}):e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-md p-4 overflow-auto",children:e.jsx("div",{className:"text-sm text-gray-700 space-y-3",children:u==="meal"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Tipo de comida:"})," ",(oe=_s[t.type])==null?void 0:oe.title]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Fecha:"})," ",t.date]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ingredientes disponibles:"})," ",H()||"Ninguno disponible"]}),i||c?e.jsx("div",{className:"text-blue-600",children:"✨ Generando comida personalizada..."}):e.jsx("div",{className:"text-gray-500",children:"La comida se generará y podrás previsualizarla antes de insertarla."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Fecha completa:"})," ",t.date]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Comidas a generar:"})," ",Object.values(_s).map(me=>me.title).join(", ")]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ingredientes disponibles:"})," ",H()||"Ninguno disponible"]}),i||c?e.jsx("div",{className:"text-blue-600",children:"✨ Generando plan completo del día..."}):e.jsx("div",{className:"text-gray-500",children:"Se generará el plan del día y podrás previsualizarlo antes de insertarlo."})]})})})})]})]}),e.jsxs("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"💡 Tip: Mantén tu lista de compras actualizada para mejores sugerencias"}),!M]}),e.jsx(en,{className:"flex justify-end gap-2 mt-3",children:e.jsx(F,{type:"button",variant:"outline",onClick:D,children:"Cancelar"})})]})]})})]})},xL=({show:t,onClose:n,selectedMealInfo:s,formData:r,onFormChange:i,onSubmit:o,onDelete:c,onOverwriteDay:d,weekDays:u})=>{if(!s)return null;const m=async g=>{g.preventDefault(),await o()},p=u.find(g=>g.fullDate===s.date),x=!!s.meal;return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsx(xt,{className:"sm:max-w-[700px]",children:e.jsxs("form",{onSubmit:m,children:[e.jsxs(bt,{children:[e.jsx(jt,{children:x?"Editar Comida":"Agregar Comida"}),e.jsxs(mn,{children:[p==null?void 0:p.dayName," - ",s.date.split("-").slice(1).join("/")]})]}),e.jsxs("div",{className:"space-y-4 py-4 sm:grid sm:grid-cols-2 sm:gap-4 sm:space-y-0",children:[e.jsxs("div",{className:"space-y-1 sm:col-span-2",children:[e.jsx(Ye,{htmlFor:"mealName",children:"Nombre de la Comida *"}),e.jsx(Ve,{id:"mealName",type:"text",value:r.name,onChange:g=>i("name",g.target.value),placeholder:"Ej: Ensalada César",required:!0})]}),e.jsxs("div",{className:"space-y-1 sm:col-span-2",children:[e.jsx(Ye,{htmlFor:"mealNotes",children:"Notas Adicionales"}),e.jsx(Ve,{id:"mealNotes",type:"text",value:r.notes,onChange:g=>i("notes",g.target.value),placeholder:"Ej: Sin crutones"})]}),e.jsxs("div",{className:"space-y-1 sm:col-span-2",children:[e.jsx(Ye,{htmlFor:"mealRecipe",children:"Receta"}),e.jsx(vt,{id:"mealRecipe",value:r.recipe,onChange:g=>i("recipe",g.target.value),placeholder:"Ingredientes y preparación...",className:"h-40 resize-none"})]}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(hL,{selectedMeal:s,onFormChange:i,onOverwriteDay:g=>d(s.date,g)})})]}),e.jsxs(en,{className:"flex flex-col sm:flex-row sm:justify-between gap-2",children:[e.jsx("div",{className:"flex-grow sm:flex-grow-0",children:x&&e.jsxs(Sd,{children:[e.jsx(Af,{asChild:!0,children:e.jsxs(F,{type:"button",variant:"destructive",className:"w-full sm:w-auto",children:[e.jsx(dl,{className:"w-4 h-4 mr-2"}),"Eliminar"]})}),e.jsxs(xl,{children:[e.jsxs(gl,{children:[e.jsx(yl,{children:"¿Estás seguro?"}),e.jsx(bl,{children:"Esta acción no se puede deshacer. Se eliminará permanentemente la comida."})]}),e.jsxs(vl,{children:[e.jsx(wl,{children:"Cancelar"}),e.jsx(jl,{onClick:c,children:"Eliminar"})]})]})]})}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-end justify-end",children:[e.jsxs("div",{children:[e.jsx(Ye,{htmlFor:"mealType",className:"sr-only",children:"Tipo"}),e.jsxs(ft,{value:r.type,onValueChange:g=>i("type",g),name:"mealType",required:!0,children:[e.jsx(ct,{id:"mealType",className:"sm:w-40 w-full",children:e.jsx(pt,{placeholder:"Selecciona un tipo"})}),e.jsx(dt,{children:Object.entries(_s).sort(([,g],[,v])=>g.order-v.order).map(([g,{title:v}])=>e.jsx(De,{value:g,children:v},g))})]})]}),e.jsx(F,{type:"button",variant:"outline",onClick:n,children:"Cancelar"}),e.jsx(F,{type:"submit",disabled:!r.name,children:x?"Actualizar":"Agregar"})]})]})]})})})},gL=({mealPlan:t,onAddMeal:n,onRemoveMeal:s,disabled:r,selectedDate:i=new Date})=>{const{toast:o}=Md(),c=i,[d,u]=f.useState(!1),[m,p]=f.useState(null),[x,g]=f.useState({type:"breakfast",name:"",notes:"",recipe:""}),v=aL(c),j=(E,T,k)=>{p({date:E,type:T,meal:k}),g({type:(k==null?void 0:k.type)||T,name:(k==null?void 0:k.name)||"",notes:(k==null?void 0:k.notes)||"",recipe:(k==null?void 0:k.recipe)||""}),u(!0)},b=(E,T)=>{g(k=>({...k,[E]:T}))},y=async()=>{if(m)try{m.meal&&m.meal.type!==x.type&&await s(m.date,m.meal.type),await n(m.date,x.type,{type:x.type,name:x.name,notes:x.notes,recipe:x.recipe}),u(!1)}catch(E){console.error("Error al guardar:",E),o({title:"Error al Guardar",description:"No se pudo guardar la comida.",variant:"destructive"})}},N=async()=>{if(m!=null&&m.meal)try{await s(m.date,m.meal.type),u(!1)}catch(E){console.error("Error al eliminar:",E),o({title:"Error al Eliminar",description:"No se pudo eliminar la comida.",variant:"destructive"})}},S=async(E,T)=>{for(const[k,M]of Object.entries(T))await n(E,k,M);if(m){const k=T[m.type];k&&g({type:m.type,name:k.name,notes:k.notes||"",recipe:k.recipe||""})}};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsx("div",{className:"md:hidden flex-1 overflow-y-auto",children:e.jsxs("div",{className:"pb-20 px-2",children:[" ",v.map(E=>e.jsx(mL,{day:E,mealPlan:t,onOpenModal:j},E.fullDate))]})}),"      ",e.jsx("div",{className:"hidden md:block flex-1 overflow-auto",children:e.jsx("div",{className:"min-h-full p-4 lg:p-6 xl:p-8",children:e.jsxs("div",{className:"grid grid-cols-8 gap-2 lg:gap-4 xl:gap-6 min-w-[900px] lg:min-w-[1200px] xl:min-w-[1400px] h-full",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 lg:p-4 xl:p-6",children:Object.entries(_s).sort(([,E],[,T])=>E.order-T.order).map(([E,T])=>e.jsx("div",{className:"h-32 lg:h-36 xl:h-40 flex items-center justify-center border-b border-gray-200 last:border-b-0",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx(T.icon,{className:"h-6 w-6 lg:h-7 lg:w-7 xl:h-8 xl:w-8 text-gray-600"}),e.jsx("span",{className:"font-medium text-sm lg:text-base",children:T.title}),e.jsxs("span",{className:"text-xs lg:text-sm text-gray-500",children:[op[E],":00"]})]})},E))}),v.map(E=>e.jsx(pL,{day:E,mealPlan:t,disabled:r,onOpenModal:j},E.fullDate))]})})}),e.jsx(xL,{show:d,onClose:()=>u(!1),selectedMealInfo:m,formData:x,onFormChange:b,onSubmit:y,onDelete:N,onOverwriteDay:S,weekDays:v})]})},vL=({onImport:t,disabled:n})=>{const{toast:s}=Md(),r=o=>!o||typeof o!="object"?!1:Object.entries(o).every(([c,d])=>!/^\d{4}-\d{2}-\d{2}$/.test(c)||!d||typeof d!="object"?!1:Object.entries(d).every(([m,p])=>!(!Object.keys(_s).includes(m)||!p||typeof p!="object"||typeof p.name!="string"||!p.name||p.notes&&typeof p.notes!="string"||p.recipe&&typeof p.recipe!="string"))),i=o=>{var u;const c=(u=o.target.files)==null?void 0:u[0];if(!c)return;const d=new FileReader;d.onload=async m=>{var p;try{const x=(p=m.target)==null?void 0:p.result,g=JSON.parse(x);if(!r(g))throw new Error("El formato del archivo no es válido. Revisa la documentación para ver el formato correcto.");await t(g)}catch(x){console.error("Error importing:",x),s({title:"Error de Importación",description:x instanceof Error?x.message:"Formato inválido",variant:"destructive"})}},d.readAsText(c)};return e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",title:"Importar Plan",accept:"application/json",onChange:i,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:n}),e.jsxs(F,{variant:"outline",size:"sm",className:"w-full",disabled:n,children:[e.jsx(Oi,{className:"h-4 w-4 mr-2"}),"Importar Plan"]})]})},yL=({onImport:t,disabled:n})=>{const[s,r]=f.useState(!1),[i,o]=f.useState(""),{toast:c}=Md(),d=m=>!m||typeof m!="object"?!1:Object.entries(m).every(([p,x])=>!/^\d{4}-\d{2}-\d{2}$/.test(p)||!x||typeof x!="object"?!1:Object.entries(x).every(([v,j])=>!(!Object.keys(_s).includes(v)||!j||typeof j!="object"||typeof j.name!="string"||!j.name||j.notes&&typeof j.notes!="string"||j.recipe&&typeof j.recipe!="string"))),u=async()=>{try{const m=JSON.parse(i);if(!d(m))throw new Error("El formato del JSON no es válido. Revisa la documentación para ver el formato correcto.");await t(m),o(""),r(!1)}catch(m){console.error("Error importing from text:",m),c({title:"Error de Importación",description:m instanceof Error?m.message:"Formato inválido",variant:"destructive"})}};return e.jsxs(yt,{open:s,onOpenChange:r,children:[e.jsxs(F,{variant:"outline",size:"sm",type:"button",onClick:()=>r(!0),disabled:n,children:[e.jsx(v_,{className:"h-4 w-4 mr-2"}),"Pegar JSON"]}),e.jsxs(xt,{children:[e.jsx(bt,{children:e.jsx(jt,{children:"Pegar Plan de Comidas"})}),e.jsx(vt,{value:i,onChange:m=>o(m.target.value),placeholder:"Pegue aquí el JSON del plan de comidas",className:"mt-4 min-h-[200px]"}),e.jsxs(en,{className:"gap-2 sm:gap-0",children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>r(!1),className:"flex-1 sm:flex-none",children:"Cancelar"}),e.jsx(F,{type:"button",onClick:u,className:"flex-1 sm:flex-none",disabled:!i.trim(),children:"Importar"})]})]})]})},Sj=()=>{const[t,n]=f.useState({}),[s,r]=f.useState("idle"),[i,o]=f.useState(null),{user:c}=He(),d=Object.values(t).reduce((g,v)=>({...g,...v}),{});f.useEffect(()=>{if(!c)return;r("loading");const g=iL(),v=be(fe,"meals",`${c.uid}_${g}`),j=ns(v,y=>{if(y.exists()){const N=y.data();n(S=>({...S,[g]:N.meals||{}})),y.metadata.hasPendingWrites?r("pending"):r("saved")}else n(N=>({...N,[g]:{}})),r("saved")},y=>{console.error("Error loading meal plan:",y),o(y instanceof Error?y.message:"Error al cargar el plan"),r("error")});return(async()=>{const y=bL(),N=$t(fe,"meals");for(const S of y)if(S!==g)try{const E=_r(N,un("userId","==",c.uid),un("yearMonth","==",S)),T=await Wi(E);T.empty?n(k=>({...k,[S]:{}})):T.forEach(k=>{const M=k.data();n(R=>({...R,[S]:M.meals||{}}))})}catch(E){console.error(`Error fetching month ${S}:`,E)}})(),()=>j()},[c]);const u=async(g,v,j)=>{if(!c)return;r("saving"),o(null);const[b,y]=g.split("-"),N=`${b}-${y}`,S=`${g}_${v}`;try{const E=t[N]||{},T={...E,[g]:{...E[g],[v]:{id:S,...j}}};n(M=>({...M,[N]:T}));const k=be(fe,"meals",`${c.uid}_${N}`);await ht(k,{userId:c.uid,yearMonth:N,meals:T,updatedAt:lt()},{merge:!0})}catch(E){throw console.error("Error adding meal:",E),o(E instanceof Error?E.message:"Error al guardar"),r("error"),E}},m=async(g,v)=>{if(!c)return;r("saving"),o(null);const[j,b]=g.split("-"),y=`${j}-${b}`;try{const N=JSON.parse(JSON.stringify(t[y]||{}));if(N[g]){const E={...N[g]};delete E[v],Object.keys(E).length===0?delete N[g]:N[g]=E}n(E=>({...E,[y]:N}));const S=be(fe,"meals",`${c.uid}_${y}`);await ht(S,{userId:c.uid,yearMonth:y,meals:N,updatedAt:lt()})}catch(N){throw console.error("Error removing meal:",N),o(N instanceof Error?N.message:"Error al eliminar"),r("error"),N}},p=async g=>{if(c){r("saving"),o(null);try{const v=Object.entries(g).reduce((b,[y,N])=>{const[S,E]=y.split("-"),T=`${S}-${E}`;return b[T]||(b[T]={}),b[T][y]=Object.entries(N).reduce((k,[M,R])=>{const I=`${y}_${M}`;return k[M]={...R,id:I,type:M},k},{}),b},{});n(b=>({...b,...v}));const j=qk(fe);Object.entries(v).forEach(([b,y])=>{const N=be(fe,"meals",`${c.uid}_${b}`);j.set(N,{userId:c.uid,yearMonth:b,meals:y,updatedAt:lt()},{merge:!0})}),await j.commit()}catch(v){throw console.error("Error importing meal plan:",v),o(v instanceof Error?v.message:"Error al importar"),r("error"),v}}},x=Rr("Meal plan");return{mealPlan:d,status:s,error:i,addMeal:u,removeMeal:m,importMealPlan:p,resync:x}},bL=()=>{const t=new Date,n=t.getFullYear(),s=t.getMonth()+1,r=t.getDate(),i=new Date(n,s,0).getDate(),o=String(s).padStart(2,"0"),c=[`${n}-${o}`];if(i-r<7){let d=s+1,u=n;d>12&&(d=1,u=n+1);const m=String(d).padStart(2,"0");c.push(`${u}-${m}`)}return c},Ld=()=>{const{user:t}=He(),[n,s]=f.useState([]),[r,i]=f.useState("idle"),[o,c]=f.useState(null);return f.useEffect(()=>{if(!t){s([]);return}i("loading");const p=_r($t(fe,"recipes"),un("userId","==",t.uid)),x=ns(p,g=>{const v=g.docs.map(j=>{const b=j.data();return{id:j.id,name:b.name,ingredients:b.ingredients||[],instructions:b.instructions||"",nutrition:b.nutrition||{calories:0,protein:0,carbs:0,fat:0},mealType:b.mealType,...b.description&&{description:b.description},...b.difficulty&&{difficulty:b.difficulty},...b.prepTime!==void 0&&{prepTime:b.prepTime},...b.favorite!==void 0&&{favorite:b.favorite}}});s(v),i("idle")},g=>{c(g instanceof Error?g.message:"Error al cargar"),i("error")});return()=>x()},[t]),{recipes:n,status:r,error:o,addRecipe:async p=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{const x={name:p.name,ingredients:p.ingredients,instructions:p.instructions,nutrition:p.nutrition,mealType:p.mealType,userId:t.uid,createdAt:lt(),updatedAt:lt()};p.description&&(x.description=p.description),p.difficulty&&(x.difficulty=p.difficulty),p.prepTime!==void 0&&(x.prepTime=p.prepTime),p.favorite!==void 0&&(x.favorite=p.favorite),await Jo($t(fe,"recipes"),x),i("idle")}catch(x){c(x instanceof Error?x.message:"Error al guardar"),i("error")}},updateRecipe:async(p,x)=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{const g=be(fe,"recipes",p),v={updatedAt:lt()};x.name!==void 0&&(v.name=x.name),x.ingredients!==void 0&&(v.ingredients=x.ingredients),x.instructions!==void 0&&(v.instructions=x.instructions),x.nutrition!==void 0&&(v.nutrition=x.nutrition),x.mealType!==void 0&&(v.mealType=x.mealType),x.description!==void 0&&(v.description=x.description),x.difficulty!==void 0&&(v.difficulty=x.difficulty),x.prepTime!==void 0&&(v.prepTime=x.prepTime),x.favorite!==void 0&&(v.favorite=x.favorite),await jn(g,v),i("idle")}catch(g){c(g instanceof Error?g.message:"Error al actualizar"),i("error")}},deleteRecipe:async p=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{await ci(be(fe,"recipes",p)),i("idle")}catch(x){c(x instanceof Error?x.message:"Error al eliminar"),i("error")}}}},lp=()=>{const{user:t}=He(),[n,s]=f.useState([]),[r,i]=f.useState("idle"),[o,c]=f.useState(null);return f.useEffect(()=>{if(!t){s([]);return}i("loading");const p=_r($t(fe,"prepared-meals"),un("userId","==",t.uid)),x=ns(p,g=>{const v=g.docs.map(j=>{const b=j.data(),y={id:j.id,name:b.name||""};return b.portions!==void 0&&(y.portions=b.portions),y});s(v),i("idle")},g=>{c(g instanceof Error?g.message:"Error al cargar"),i("error")});return()=>x()},[t]),{meals:n,status:r,error:o,addMeal:async p=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{const x={name:p.name,userId:t.uid,createdAt:lt(),updatedAt:lt()};p.portions!==void 0&&(x.portions=p.portions),await Jo($t(fe,"prepared-meals"),x),i("idle")}catch(x){const g=x instanceof Error?x.message:"Error al guardar";c(g),i("error")}},updateMeal:async(p,x)=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{const g=be(fe,"prepared-meals",p),v={updatedAt:lt()};x.name!==void 0&&(v.name=x.name),x.portions!==void 0&&(v.portions=x.portions),await jn(g,v),i("idle")}catch(g){const v=g instanceof Error?g.message:"Error al actualizar";c(v),i("error")}},deleteMeal:async p=>{if(!t){c("Usuario no autenticado");return}i("saving"),c(null);try{await ci(be(fe,"prepared-meals",p)),i("idle")}catch(x){const g=x instanceof Error?x.message:"Error al eliminar";c(g),i("error")}}}},jL=[{path:"/meal",label:"Plan de Comidas",icon:e.jsx(Nn,{className:"h-4 w-4"})},{path:"/shopping-list",label:"Lista de Compras",icon:e.jsx(Fa,{className:"h-4 w-4"})},{path:"/recipes",label:"Recetas",icon:e.jsx(Ui,{className:"h-4 w-4"})},{path:"/prepared-meals",label:"Comidas Preparadas",icon:e.jsx(Vi,{className:"h-4 w-4"})}],$d=({title:t,children:n,className:s})=>{const r=lr();return e.jsx("div",{className:ce("",s),children:e.jsx("div",{className:"container mx-auto",children:e.jsxs("div",{className:"bg-background/50 flex items-center justify-between gap-2 py-4 backdrop-blur-md lg:mt-4 lg:rounded-2xl lg:border lg:px-4",children:[e.jsx("div",{className:"flex items-center gap-5",children:e.jsxs("div",{className:"flex items-center gap-12",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-sm",children:e.jsx(y_,{className:"h-4 w-4 text-white"})}),e.jsx("h2",{className:"text-lg font-bold text-foreground",children:t})]}),e.jsx("nav",{className:"hidden md:flex gap-2 lg:gap-4",children:jL.map(i=>{const o=r.pathname===i.path;return e.jsxs(Ds,{to:i.path,className:ce("flex items-center space-x-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200 group","hover:bg-white/90 hover:shadow-lg",o?"bg-white text-blue-700 shadow-lg border border-blue-200":"text-gray-700 hover:text-gray-900"),children:[e.jsx("span",{className:ce("p-1.5 rounded-lg transition-colors",o?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600 group-hover:bg-gray-200"),children:i.icon}),e.jsx("span",{className:"whitespace-nowrap",children:i.label})]},i.path)})})]})}),n&&e.jsx("div",{className:"flex items-center gap-3",children:n})]})})})},cp=({open:t,onOpenChange:n,config:s,customFieldValues:r={},onCustomFieldChange:i})=>{const[o,c]=f.useState(0),[d,u]=f.useState([]),[m,p]=f.useState({}),[x,g]=f.useState(""),[v,j]=f.useState(!1),b=d.map(G=>s.modules.find(U=>U.id===G)).filter(G=>G!==void 0),y=b.filter(G=>G.fields&&G.fields.length>0),N=1+y.length+1,S=G=>{u(U=>U.includes(G)?U.filter(Y=>Y!==G):[...U,G])},E=(G,U)=>{p(Y=>{const ae=Y[G]||[],ye=ae.includes(U)?ae.filter(oe=>oe!==U):[...ae,U];return{...Y,[G]:ye}})},T=()=>{o===0?y.length>0?c(1):(M(),c(N-1)):o<N-1&&(o===y.length&&M(),c(o+1))},k=()=>{o>0&&c(o-1)},M=()=>{const G={};b.forEach(U=>{if(U){const Y=m[U.id]||[],ae=r[U.id]||{},ye=U.dataGenerator(Y,ae);ye&&Object.keys(ye).length>0&&Object.assign(G,ye)}}),g(JSON.stringify(G,null,2))},R=async()=>{try{await navigator.clipboard.writeText(x),j(!0),kt.success("JSON copiado al portapapeles"),setTimeout(()=>j(!1),2e3)}catch{kt.error("Error al copiar al portapapeles")}},I=()=>{c(0),u([]),p({}),g(""),j(!1),n(!1)},O=()=>{var G,U;if(o===0)return d.length>0;if(o>0&&o<=y.length){const Y=o-1,ae=y[Y];if(!ae||((G=ae.fields)==null?void 0:G.every(W=>W.type==="custom")))return!0;const oe=m[ae.id]||[];return((U=ae.fields)==null?void 0:U.some(W=>W.type!=="custom"))?oe.length>0:!0}return!0},H=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Selecciona los módulos que deseas exportar:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:s.modules.map(G=>e.jsxs("div",{className:"flex items-start space-x-3 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(As,{id:G.id,checked:d.includes(G.id),onCheckedChange:()=>S(G.id),className:"mt-1"}),G.icon&&e.jsx("div",{className:"mt-1 text-gray-600",children:G.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:G.id,className:"text-sm font-medium cursor-pointer block",children:G.label}),G.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:G.description})]})]},G.id))})]}),$=G=>{const U=y[G];return!U||!U.fields?null:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["Configura los campos para ",e.jsx("strong",{children:U.label}),":"]}),e.jsxs(je,{children:[e.jsx(Mt,{className:"pb-3",children:e.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[U.icon,U.label]})}),e.jsx(we,{className:"space-y-3",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:U.fields.map(Y=>{var ae;return e.jsx("div",{children:Y.type==="custom"&&Y.component?e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium block",children:Y.label}),Y.description&&e.jsx("p",{className:"text-xs text-gray-500",children:Y.description}),Y.component]}):e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(As,{id:`${U.id}-${Y.id}`,checked:((ae=m[U.id])==null?void 0:ae.includes(Y.id))||!1,onCheckedChange:()=>E(U.id,Y.id)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{htmlFor:`${U.id}-${Y.id}`,className:"text-sm font-medium cursor-pointer block",children:Y.label}),Y.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Y.description})]})]})},Y.id)})})})]})]})},D=()=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Aquí está tu JSON generado. Puedes copiarlo al portapapeles:"}),e.jsxs("div",{className:"relative",children:[e.jsx("pre",{className:"bg-gray-100 p-4 rounded-lg text-xs overflow-auto max-h-96 border",children:x}),e.jsxs(F,{onClick:R,variant:"outline",size:"sm",className:"absolute top-2 right-2 gap-2",disabled:v,children:[v?e.jsx(Hi,{className:"w-4 h-4"}):e.jsx(Ar,{className:"w-4 h-4"}),v?"Copiado":"Copiar"]})]})]}),P=()=>o===0?H():o<=y.length?$(o-1):D(),K=()=>{if(o===0)return"Seleccionar Módulos";if(o<=y.length){const G=y[o-1];return`Configurar ${G==null?void 0:G.label}`}else return"Resultado"},X=()=>{const G=[{label:"Módulos",isCompleted:o>0,isCurrent:o===0}];return y.forEach((U,Y)=>{const ae=Y+1;U&&G.push({label:U.label,isCompleted:o>ae,isCurrent:o===ae})}),G.push({label:"Resultado",isCompleted:!1,isCurrent:o===N-1}),e.jsxs("div",{className:"bg-gray-50 border-b",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2 py-4 px-6",children:G.map((U,Y)=>e.jsxs(ne.Fragment,{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium ${U.isCompleted?"bg-green-500 text-white":U.isCurrent?"bg-blue-500 text-white":"bg-gray-300 text-gray-600"}`,children:U.isCompleted?e.jsx(dd,{className:"w-4 h-4"}):Y+1}),e.jsx("span",{className:`ml-2 text-sm font-medium ${U.isCurrent?"text-blue-600":U.isCompleted?"text-green-600":"text-gray-500"}`,children:U.label})]}),Y<G.length-1&&e.jsx(ia,{className:"w-4 h-4 text-gray-400"})]},Y))}),o>0&&b.length>0&&e.jsxs("div",{className:"px-6 pb-3",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Módulos seleccionados:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:b.map(U=>U&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:[U.icon,U.label]},U.id))})]})]})};return e.jsx(yt,{open:t,onOpenChange:I,children:e.jsxs(xt,{className:"sm:max-w-5xl max-h-[85vh] overflow-y-auto p-0",children:[e.jsx(bt,{className:"px-6 pt-6 pb-0",children:e.jsxs(jt,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s.title}),e.jsx("span",{className:"text-sm font-normal text-gray-500 mt-1",children:K()})]}),e.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["Paso ",o+1," de ",N]})]})}),X(),e.jsx("div",{className:"px-6 pb-6",children:P()}),e.jsxs("div",{className:"flex justify-between px-6 py-4 border-t bg-gray-50",children:[e.jsxs(F,{variant:"outline",onClick:k,disabled:o===0,className:"gap-2",children:[e.jsx(yf,{className:"w-4 h-4"}),"Anterior"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"outline",onClick:I,children:"Cancelar"}),o<N-1?e.jsxs(F,{onClick:T,disabled:!O(),className:"gap-2",children:["Siguiente",e.jsx(ia,{className:"w-4 h-4"})]}):e.jsx(F,{onClick:I,children:"Finalizar"})]})]})]})})},wL=({open:t,onOpenChange:n})=>{var p;const{items:s}=Dl(),{recipes:r}=Ld(),{meals:i}=lp(),{mealPlan:o}=Sj(),[c,d]=f.useState({mealPlan:{dateRange:"today"}}),u=(x,g,v)=>{d(j=>({...j,[x]:{...j[x],[g]:v}}))},m={title:"Exportar Datos de Comidas",modules:[{id:"ingredients",label:"Ingredientes",description:"Lista de ingredientes disponibles con cantidades",icon:e.jsx(Vi,{className:"w-4 h-4"}),fields:[{id:"in-stock",label:"En stock",description:"Elementos que ya tienes disponibles"},{id:"low-stock",label:"Stock bajo",description:"Elementos que necesitas reponer pronto"},{id:"to-buy",label:"Pendientes de compra",description:"Elementos que planeas comprar"},{id:"excludeNonFood",label:"Excluir no comestibles",description:"Filtrar elementos de aseo y limpieza"},{id:"withQuantities",label:"Incluir cantidades",description:"Agregar cantidades específicas de cada ingrediente"},{id:"groupByStatus",label:"Agrupar por estado",description:"Organizar por en stock, stock bajo, pendiente"}],dataGenerator:(x,g)=>{const v=["aseo","otro","limpieza"];let j=s;x.includes("excludeNonFood")&&(j=j.filter(S=>{if(!S.category)return!0;const E=S.category.toLowerCase();return!v.some(T=>E.includes(T))}));const b=[];x.includes("in-stock")&&b.push("in-stock"),x.includes("low-stock")&&b.push("low-stock"),x.includes("to-buy")&&b.push("to-buy"),b.length>0&&(j=j.filter(S=>b.includes(S.status)));const y=x.includes("withQuantities");return x.includes("groupByStatus")?{ingredientes:j.reduce((E,T)=>{const M={"in-stock":"en_stock","low-stock":"stock_bajo","to-buy":"pendiente_compra"}[T.status]||T.status;E[M]||(E[M]=[]);const R=y?{name:T.name,quantity:T.quantity}:{name:T.name};return E[M].push(R),E},{})}:{ingredientes:j.map(E=>y?{name:E.name,quantity:E.quantity,status:E.status}:{name:E.name,status:E.status})}}},{id:"preparedMeals",label:"Comidas Preparadas",description:"Lista de comidas ya preparadas",icon:e.jsx(Ui,{className:"w-4 h-4"}),dataGenerator:(x,g)=>({comidasPreparadas:i.map(v=>({name:v.name,...v.portions!==void 0&&{porciones:v.portions}}))})},{id:"mealPlan",label:"Plan de Comidas",description:"Plan de comidas con selector de rango",icon:e.jsx(Nn,{className:"w-4 h-4"}),fields:[{id:"dateRange",label:"Rango de fechas",description:"Selecciona qué período exportar",type:"custom",component:e.jsxs(ft,{value:((p=c.mealPlan)==null?void 0:p.dateRange)||"today",onValueChange:x=>u("mealPlan","dateRange",x),children:[e.jsx(ct,{className:"w-full",children:e.jsx(pt,{placeholder:"Selecciona el rango"})}),e.jsxs(dt,{children:[e.jsxs(De,{value:"today",children:["Solo hoy (",Pt(new Date,"dd/MM/yyyy",{locale:Ln}),")"]}),e.jsx(De,{value:"yesterday-today",children:"Ayer y hoy"}),e.jsx(De,{value:"current-week",children:"Semana actual"}),e.jsx(De,{value:"all",children:"Todo el plan"})]})]})}],dataGenerator:(x,g)=>{const v=(g==null?void 0:g.dateRange)||"today",j=new Date,b=Pt(j,"yyyy-MM-dd");let y={...o};switch(v){case"today":y={[b]:o[b]||{}};break;case"yesterday-today":const N=Fo(j,1),S=Pt(N,"yyyy-MM-dd");y={[S]:o[S]||{},[b]:o[b]||{}};break;case"current-week":const E=Cr(j,{weekStartsOn:1}),T=$n(j,{weekStartsOn:1});y={};for(let k=new Date(E);k<=T;k.setDate(k.getDate()+1)){const M=Pt(k,"yyyy-MM-dd");o[M]&&(y[M]=o[M])}break;case"all":default:y=o;break}return{planComidas:y,rango:v,fechas:Object.keys(y).sort()}}},{id:"recipes",label:"Recetas",description:"Recetas disponibles con campos personalizables",icon:e.jsx(ld,{className:"w-4 h-4"}),fields:[{id:"allRecipes",label:"Todas las recetas",description:"Incluir todas las recetas (por defecto solo favoritas)"},{id:"name",label:"Nombre",description:"Nombre de la receta"},{id:"description",label:"Descripción",description:"Descripción de la receta"},{id:"ingredients",label:"Ingredientes",description:"Lista de ingredientes y cantidades"},{id:"instructions",label:"Pasos de preparación",description:"Instrucciones paso a paso"},{id:"prepTime",label:"Tiempo estimado",description:"Tiempo de preparación en minutos"},{id:"mealType",label:"Tipo de comida",description:"Categoría de la comida"},{id:"difficulty",label:"Dificultad",description:"Nivel de dificultad"},{id:"nutrition",label:"Información nutricional",description:"Calorías, proteínas, carbohidratos, grasas"}],dataGenerator:(x,g)=>{const v=x.includes("allRecipes"),b=(v?r:r.filter(y=>y.favorite===!0)).map(y=>{const N={};return x.length===0||x.length===1&&x[0]==="allRecipes"?{name:y.name,description:y.description,ingredients:y.ingredients,instructions:y.instructions,mealType:y.mealType,favorite:y.favorite}:(x.includes("name")&&(N.name=y.name),x.includes("description")&&y.description&&(N.description=y.description),x.includes("ingredients")&&(N.ingredients=y.ingredients),x.includes("instructions")&&(N.instructions=y.instructions),x.includes("prepTime")&&y.prepTime&&(N.prepTime=y.prepTime),x.includes("mealType")&&(N.mealType=y.mealType),x.includes("difficulty")&&y.difficulty&&(N.difficulty=y.difficulty),x.includes("nutrition")&&(N.nutrition=y.nutrition),N)});return{recetas:b,total:b.length,tipo:v?"todas":"favoritas"}}}]};return e.jsx(cp,{open:t,onOpenChange:n,config:m,customFieldValues:c,onCustomFieldChange:u})},NL=({selectedDate:t})=>{const{user:n}=He(),{toast:s}=Md(),r=lr(),[i,o]=f.useState(!1),[c,d]=f.useState(!1),{mealPlan:u,status:m,error:p,addMeal:x,removeMeal:g,importMealPlan:v,resync:j}=Sj(),{isOnline:b}=cr();if(Dl(),Ld(),lp(),!n)return e.jsx(je,{className:"w-full h-full",children:e.jsx(we,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para planificar tus comidas"})})});const y=async(...T)=>{try{await x(...T)}catch(k){console.error("Error adding meal:",k),s({title:"Error al Agregar",description:"No se pudo agregar la comida.",variant:"destructive"})}},N=async(...T)=>{try{await g(...T)}catch(k){console.error("Error removing meal:",k),s({title:"Error al Eliminar",description:"No se pudo eliminar la comida.",variant:"destructive"})}},S=async(...T)=>{try{await v(...T),s({title:"Importación Exitosa",description:"El plan de comidas se ha importado correctamente."}),o(!1)}catch(k){console.error("Error importing meal plan:",k),s({title:"Error al Importar",description:"No se pudo importar el plan de comidas.",variant:"destructive"})}},E=()=>{d(!0)};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs($d,{title:"Plan de Comidas",children:[e.jsx(zn,{children:e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>o(!0),children:[e.jsx(Oi,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Importar Plan"})]})}),e.jsx(rs,{children:e.jsx("p",{children:"Importar Plan"})})]}),e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:E,children:[e.jsx(Fn,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Exportar"})]})}),e.jsx(rs,{children:e.jsx("p",{children:"Exportar"})})]})]})}),e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(pl,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(or,{align:"end",children:[e.jsxs(ut,{onClick:()=>o(!0),children:[e.jsx(Oi,{className:"mr-2 h-4 w-4"}),"Importar Plan"]}),e.jsxs(ut,{onClick:E,children:[e.jsx(Fn,{className:"mr-2 h-4 w-4"}),"Exportar"]}),e.jsx(Xi,{}),r.pathname!=="/meal"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/meal",className:"flex items-center",children:[e.jsx(Nn,{className:"mr-2 h-4 w-4"}),"Plan de Comidas"]})}),r.pathname!=="/shopping-list"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/shopping-list",className:"flex items-center",children:[e.jsx(Fa,{className:"mr-2 h-4 w-4"}),"Lista de Compras"]})}),r.pathname!=="/recipes"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/recipes",className:"flex items-center",children:[e.jsx(Ui,{className:"mr-2 h-4 w-4"}),"Recetas"]})}),r.pathname!=="/prepared-meals"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/prepared-meals",className:"flex items-center",children:[e.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Comidas Preparadas"]})})]})]})]}),e.jsxs("div",{className:"flex-1 bg-gray-50 overflow-hidden",children:[e.jsx(gL,{mealPlan:u,onAddMeal:y,onRemoveMeal:N,disabled:m==="saving"||!b,selectedDate:t}),p&&e.jsxs(Zi,{variant:"destructive",className:"m-4",children:[e.jsx(cd,{className:"h-4 w-4"}),e.jsx(Qi,{className:"text-sm",children:p})]})]}),e.jsx(yt,{open:i,onOpenChange:o,children:e.jsxs(xt,{className:"sm:max-w-md",children:[e.jsx(bt,{children:e.jsx(jt,{children:"Importar Plan de Comidas"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Puedes importar un plan de comidas desde un archivo JSON o pegando el contenido directamente."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(vL,{onImport:S,disabled:m==="saving"||!b}),e.jsx(yL,{onImport:S,disabled:m==="saving"||!b})]})]})]})}),e.jsx(wL,{open:c,onOpenChange:d}),e.jsxs("div",{className:"flex justify-center items-center gap-2 text-xs p-2 border-t bg-white",children:[m==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),m==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),m==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),m==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!b&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:j,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]})},SL=()=>e.jsx(Ss,{noPadding:!0,className:"h-full",children:e.jsx(NL,{selectedDate:new Date})});function CL(t,n=[]){let s=[];function r(o,c){const d=f.createContext(c),u=s.length;s=[...s,c];function m(x){const{scope:g,children:v,...j}=x,b=(g==null?void 0:g[t][u])||d,y=f.useMemo(()=>j,Object.values(j));return e.jsx(b.Provider,{value:y,children:v})}function p(x,g){const v=(g==null?void 0:g[t][u])||d,j=f.useContext(v);if(j)return j;if(c!==void 0)return c;throw new Error(`\`${x}\` must be used within \`${o}\``)}return m.displayName=o+"Provider",[m,p]}const i=()=>{const o=s.map(c=>f.createContext(c));return function(d){const u=(d==null?void 0:d[t])||o;return f.useMemo(()=>({[`__scope${t}`]:{...d,[t]:u}}),[d,u])}};return i.scopeName=t,[r,EL(i,...n)]}function EL(...t){const n=t[0];if(t.length===1)return n;const s=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const c=r.reduce((d,{useScope:u,scopeName:m})=>{const x=u(o)[`__scope${m}`];return{...d,...x}},{});return f.useMemo(()=>({[`__scope${n.scopeName}`]:c}),[c])}};return s.scopeName=n.scopeName,s}var TL="Toggle",dp=f.forwardRef((t,n)=>{const{pressed:s,defaultPressed:r=!1,onPressedChange:i,...o}=t,[c=!1,d]=aa({prop:s,onChange:i,defaultProp:r});return e.jsx(It.button,{type:"button","aria-pressed":c,"data-state":c?"on":"off","data-disabled":t.disabled?"":void 0,...o,ref:n,onClick:ot(t.onClick,()=>{t.disabled||d(!c)})})});dp.displayName=TL;var Cj=dp,to="ToggleGroup",[Ej,T$]=CL(to,[Fv]),Tj=Fv(),up=ne.forwardRef((t,n)=>{const{type:s,...r}=t;if(s==="single"){const i=r;return e.jsx(kL,{...i,ref:n})}if(s==="multiple"){const i=r;return e.jsx(_L,{...i,ref:n})}throw new Error(`Missing prop \`type\` expected on \`${to}\``)});up.displayName=to;var[kj,_j]=Ej(to),kL=ne.forwardRef((t,n)=>{const{value:s,defaultValue:r,onValueChange:i=()=>{},...o}=t,[c,d]=aa({prop:s,defaultProp:r,onChange:i});return e.jsx(kj,{scope:t.__scopeToggleGroup,type:"single",value:c?[c]:[],onItemActivate:d,onItemDeactivate:ne.useCallback(()=>d(""),[d]),children:e.jsx(Dj,{...o,ref:n})})}),_L=ne.forwardRef((t,n)=>{const{value:s,defaultValue:r,onValueChange:i=()=>{},...o}=t,[c=[],d]=aa({prop:s,defaultProp:r,onChange:i}),u=ne.useCallback(p=>d((x=[])=>[...x,p]),[d]),m=ne.useCallback(p=>d((x=[])=>x.filter(g=>g!==p)),[d]);return e.jsx(kj,{scope:t.__scopeToggleGroup,type:"multiple",value:c,onItemActivate:u,onItemDeactivate:m,children:e.jsx(Dj,{...o,ref:n})})});up.displayName=to;var[DL,AL]=Ej(to),Dj=ne.forwardRef((t,n)=>{const{__scopeToggleGroup:s,disabled:r=!1,rovingFocus:i=!0,orientation:o,dir:c,loop:d=!0,...u}=t,m=Tj(s),p=cl(c),x={role:"group",dir:p,...u};return e.jsx(DL,{scope:s,rovingFocus:i,disabled:r,children:i?e.jsx(xk,{asChild:!0,...m,orientation:o,dir:p,loop:d,children:e.jsx(It.div,{...x,ref:n})}):e.jsx(It.div,{...x,ref:n})})}),td="ToggleGroupItem",Aj=ne.forwardRef((t,n)=>{const s=_j(td,t.__scopeToggleGroup),r=AL(td,t.__scopeToggleGroup),i=Tj(t.__scopeToggleGroup),o=s.value.includes(t.value),c=r.disabled||t.disabled,d={...t,pressed:o,disabled:c},u=ne.useRef(null);return r.rovingFocus?e.jsx(gk,{asChild:!0,...i,focusable:!c,active:o,ref:u,children:e.jsx(sv,{...d,ref:n})}):e.jsx(sv,{...d,ref:n})});Aj.displayName=td;var sv=ne.forwardRef((t,n)=>{const{__scopeToggleGroup:s,value:r,...i}=t,o=_j(td,s),c={role:"radio","aria-checked":t.pressed,"aria-pressed":void 0},d=o.type==="single"?c:void 0;return e.jsx(dp,{...d,...i,ref:n,onPressedChange:u=>{u?o.onItemActivate(r):o.onItemDeactivate(r)}})}),Rj=up,Pj=Aj;const Ij=Bi("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),RL=f.forwardRef(({className:t,variant:n,size:s,...r},i)=>e.jsx(Cj,{ref:i,className:ce(Ij({variant:n,size:s,className:t})),...r}));RL.displayName=Cj.displayName;const Oj=f.createContext({size:"default",variant:"default"}),Mj=f.forwardRef(({className:t,variant:n,size:s,children:r,...i},o)=>e.jsx(Rj,{ref:o,className:ce("flex items-center justify-center gap-1",t),...i,children:e.jsx(Oj.Provider,{value:{variant:n,size:s},children:r})}));Mj.displayName=Rj.displayName;const rf=f.forwardRef(({className:t,children:n,variant:s,size:r,...i},o)=>{const c=f.useContext(Oj);return e.jsx(Pj,{ref:o,className:ce(Ij({variant:c.variant||s,size:c.size||r}),t),...i,children:n})});rf.displayName=Pj.displayName;const PL=({open:t,onOpenChange:n})=>{const{items:s}=Dl(),r={title:"Exportar Lista de Compras",modules:[{id:"shoppingList",label:"Lista de Compras",description:"Elementos de la lista con opciones de formato",icon:e.jsx(Fa,{className:"w-4 h-4"}),fields:[{id:"in-stock",label:"En stock",description:"Elementos que ya tienes disponibles"},{id:"low-stock",label:"Stock bajo",description:"Elementos que necesitas reponer pronto"},{id:"to-buy",label:"Pendientes de compra",description:"Elementos que planeas comprar"},{id:"nextPurchase",label:"Solo próximas compras",description:"Filtrar solo elementos marcados para próxima compra"},{id:"excludeCategories",label:"Excluir no comestibles",description:"Filtrar elementos de aseo y otros no comestibles"},{id:"withQuantities",label:"Incluir cantidades",description:"Agregar información de cantidades"},{id:"withPrices",label:"Incluir precios",description:"Agregar información de precios cuando esté disponible"},{id:"withDates",label:"Incluir fechas de consumo",description:"Agregar fechas de consumo preferente"},{id:"withPlaces",label:"Incluir lugares de compra",description:"Agregar información de dónde comprar"},{id:"byStatus",label:"Agrupar por estado",description:"Organizar elementos por estado (en stock, stock bajo, pendiente)"},{id:"byCategory",label:"Agrupar por categoría",description:"Organizar elementos por categorías"}],dataGenerator:(i,o)=>{let c=[...s];if(i.includes("excludeCategories")){const m=["aseo","otro","limpieza"];c=c.filter(p=>{if(!p.category)return!0;const x=p.category.toLowerCase();return!m.some(g=>x.includes(g))})}i.includes("nextPurchase")&&(c=c.filter(m=>m.nextPurchase===!0));const d=[];i.includes("in-stock")&&d.push("in-stock"),i.includes("low-stock")&&d.push("low-stock"),i.includes("to-buy")&&d.push("to-buy"),d.length>0&&(c=c.filter(m=>d.includes(m.status)));const u=m=>{const p={name:m.name};return i.includes("withQuantities")&&(p.quantity=m.quantity),i.includes("withPrices")&&m.price&&(p.price=m.price),i.includes("withDates")&&m.consumeBy&&(p.consumeBy=m.consumeBy),i.includes("withPlaces")&&m.place&&(p.place=m.place),p};if(i.includes("byStatus")&&i.includes("byCategory"))return{listaCompras:c.reduce((p,x)=>{const v={"in-stock":"en_stock","low-stock":"stock_bajo","to-buy":"pendiente_compra"}[x.status]||x.status,j=x.category||"sin_categoria";return p[v]||(p[v]={}),p[v][j]||(p[v][j]=[]),p[v][j].push(u(x)),p},{})};if(i.includes("byStatus")){const m={"in-stock":"en_stock","low-stock":"stock_bajo","to-buy":"pendiente_compra"};return{listaCompras:c.reduce((x,g)=>{const v=m[g.status]||g.status;return x[v]||(x[v]=[]),x[v].push(u(g)),x},{})}}else return i.includes("byCategory")?{listaCompras:c.reduce((p,x)=>{const g=x.category||"sin_categoria";return p[g]||(p[g]=[]),p[g].push(u(x)),p},{})}:{listaCompras:c.map(u),total:c.length}}}]};return e.jsx(cp,{open:t,onOpenChange:n,config:r})},Lj=[{value:"Aseo y Limpieza",emoji:"🧹"},{value:"Bebidas",emoji:"🥤"},{value:"Carnes y Pescados",emoji:"🥩"},{value:"Cereales y Granos",emoji:"🌾"},{value:"Condimentos y Especias",emoji:"🧂"},{value:"Congelados",emoji:"❄️"},{value:"Cuidado Personal",emoji:"🧴"},{value:"Enlatados y Conservas",emoji:"🥫"},{value:"Frutas y Verduras",emoji:"🍎"},{value:"Lácteos y Huevos",emoji:"🥛"},{value:"Panadería",emoji:"🍞"},{value:"Snacks y Dulces",emoji:"🍪"},{value:"Mascotas",emoji:"🐶"},{value:"Otro",emoji:"📦"}],IL=Lj.reduce((t,n)=>(t[n.value]=n.emoji,t),{}),OL=Lj.map(t=>t.value),zd=t=>{if(!t)return"";const n=IL[t];return n?`${n} ${t}`:t},ML=["Éxito","D1","Ara","Dollarcity","Olimpica (SAO)","Jumbo","Plaza de mercado","Panadería","Droguería","Otro"],LL=({open:t,onOpenChange:n,onSave:s,onDelete:r,item:i})=>{const[o,c]=f.useState(""),[d,u]=f.useState(1),[m,p]=f.useState(""),[x,g]=f.useState(""),[v,j]=f.useState(""),[b,y]=f.useState(""),[N,S]=f.useState("to-buy");f.useEffect(()=>{i?(c(i.name),u(i.quantity),p(i.price?String(i.price):""),g(i.category||""),j(i.place||""),y(i.consumeBy||""),S(i.status)):(c(""),u(1),p(""),g(""),j(""),y(""),S("to-buy"))},[i,t]),f.useEffect(()=>{N==="to-buy"&&y("")},[N]);const E=()=>{const T={quantity:Number(d),status:N};m&&m.trim()!==""&&(T.price=Number(m)),x&&x.trim()!==""&&(T.category=x),v&&v.trim()!==""&&(T.place=v),N!=="to-buy"&&b&&b.trim()!==""&&(T.consumeBy=b),i?s({...T,name:o},i.id):o.split(`
`).map(M=>M.trim()).filter(Boolean).forEach(M=>s({...T,name:M})),n(!1)};return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"sm:max-w-md",children:[e.jsx(bt,{children:e.jsxs(jt,{children:[i?"Editar":"Agregar"," Ítem"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(Ye,{htmlFor:"names",children:["Nombre",i?"":"s"]}),i?e.jsx(Ve,{id:"names",value:o,onChange:T=>c(T.target.value)}):e.jsx(vt,{id:"names",value:o,onChange:T=>c(T.target.value),placeholder:"Un producto por línea",className:"min-h-[120px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"quantity",children:"Cantidad"}),e.jsx(Ve,{id:"quantity",type:"number",value:d,onChange:T=>u(Number(T.target.value))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"price",children:"Precio"}),e.jsx(Ve,{id:"price",type:"number",value:m,onChange:T=>p(T.target.value)})]})]}),"          ",e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"category",children:"Categoría"}),e.jsxs(ft,{value:x,onValueChange:g,children:[e.jsx(ct,{id:"category",children:e.jsx(pt,{placeholder:"Seleccionar categoría"})}),e.jsx(dt,{children:OL.map(T=>e.jsx(De,{value:T,children:zd(T)},T))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"place",children:"Lugar de compra"}),e.jsxs(ft,{value:v,onValueChange:j,children:[e.jsx(ct,{id:"place",children:e.jsx(pt,{placeholder:"Seleccionar lugar"})}),e.jsx(dt,{children:ML.map(T=>e.jsx(De,{value:T,children:T},T))})]})]}),N!=="to-buy"&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"consumeBy",children:"Consumir antes de"}),e.jsx(Ve,{id:"consumeBy",type:"date",value:b,onChange:T=>y(T.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"status",children:"Estado"}),e.jsxs(ft,{value:N,onValueChange:T=>S(T),children:[e.jsx(ct,{id:"status",children:e.jsx(pt,{})}),e.jsxs(dt,{children:[e.jsx(De,{value:"in-stock",children:"En Stock"}),e.jsx(De,{value:"to-buy",children:"Por Comprar"}),e.jsx(De,{value:"low-stock",children:"Poco Stock"})]})]})]})]}),e.jsxs(en,{className:"flex justify-between",children:[i&&r?e.jsx(F,{variant:"destructive",onClick:()=>{r(i.id),n(!1)},children:"Eliminar"}):e.jsx("span",{}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"outline",onClick:()=>n(!1),children:"Cancelar"}),e.jsx(F,{onClick:E,children:"Guardar"})]})]})]})})},$L=vk,zL=yk,FL=bk,$j=({query:t,onQueryChange:n,sort:s,onSortChange:r,placeFilter:i,onPlaceFilterChange:o,statusFilter:c,onStatusFilterChange:d,categoryFilter:u,onCategoryFilterChange:m,onlyToBuy:p,onOnlyToBuyChange:x,nextOnly:g,onNextOnlyChange:v,expireSoonOnly:j,onExpireSoonOnlyChange:b,noPriceOnly:y=!1,onNoPriceOnlyChange:N,places:S,categories:E,filtersOpen:T,setFiltersOpen:k,isMobile:M})=>e.jsxs($L,{open:!M||T,onOpenChange:k,children:[e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx(Ve,{placeholder:"Buscar",value:t,onChange:R=>n(R.target.value),className:"flex-1 sm:w-60"}),M&&e.jsx(zL,{asChild:!0,children:e.jsx(F,{variant:"outline",size:"icon",children:e.jsx(bf,{className:"w-4 h-4"})})})]}),e.jsx(FL,{className:"mt-2",children:e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(ft,{value:s,onValueChange:R=>r(R),children:[e.jsx(ct,{className:"w-36",children:e.jsx(pt,{placeholder:"Ordenar"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"az",children:"Nombre A-Z"}),e.jsx(De,{value:"za",children:"Nombre Z-A"}),e.jsx(De,{value:"category",children:"Categoría"})]})]}),e.jsxs(ft,{value:i||"all",onValueChange:R=>o(R==="all"?"":R),children:[e.jsx(ct,{className:"w-36",children:e.jsx(pt,{placeholder:"Lugar"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"all",children:"Todos los lugares"}),S.map(R=>e.jsx(De,{value:R,children:R},R))]})]}),e.jsxs(ft,{value:c||"all",onValueChange:R=>d(R==="all"?"":R),children:[e.jsx(ct,{className:"w-36",children:e.jsx(pt,{placeholder:"Estado"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"all",children:"Todos"}),e.jsx(De,{value:"to-buy",children:"Por Comprar"}),e.jsx(De,{value:"in-stock",children:"En Stock"}),e.jsx(De,{value:"low-stock",children:"Poco Stock"})]})]}),e.jsxs(ft,{value:u||"all",onValueChange:R=>m(R==="all"?"":R),children:[e.jsx(ct,{className:"w-44",children:e.jsx(pt,{placeholder:"Categoría"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"all",children:"Todas"}),N&&e.jsx(De,{value:"__empty",children:"Sin categoría"}),E.map(R=>e.jsx(De,{value:R,children:zd(R)},R))]})]}),N&&e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(As,{checked:y,onCheckedChange:R=>N(!!R)}),"Sin precio"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(As,{checked:p,onCheckedChange:R=>x(!!R)}),e.jsx(Fa,{className:"w-4 h-4"}),"Lista activa"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(As,{checked:g,onCheckedChange:R=>v(!!R)}),"Próxima compra"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(As,{checked:j,onCheckedChange:R=>b(!!R)}),"Próximos a vencer"]})]})})]}),nv=[{key:"to-buy",title:"Por Comprar"},{key:"low-stock",title:"Poco Stock"},{key:"in-stock",title:"En Stock"}],rv={"to-buy":Fa,"low-stock":w_,"in-stock":Hi},BL=({items:t,onMove:n,onView:s,onToggleNext:r})=>{const[i,o]=f.useState(""),[c,d]=f.useState("az"),[u,m]=f.useState(""),[p,x]=f.useState(""),[g,v]=f.useState(""),[j,b]=f.useState(!1),[y,N]=f.useState(!1),[S,E]=f.useState(!1),[T,k]=f.useState(!1),{isMobile:M}=xd(),R=f.useMemo(()=>Array.from(new Set(t.map(D=>D.place).filter(Boolean))),[t]),I=f.useMemo(()=>Array.from(new Set(t.map(D=>D.category).filter(Boolean))),[t]),O=f.useMemo(()=>{let D=t.filter(K=>K.name.toLowerCase().includes(i.toLowerCase()));if(u&&(D=D.filter(K=>K.place===u)),p&&(D=D.filter(K=>K.status===p)),g&&(D=D.filter(K=>K.category===g)),j&&(D=D.filter(K=>K.status==="to-buy")),S&&(D=D.filter(K=>K.nextPurchase)),y){const K=Vt(new Date,3);D=D.filter(X=>{if(!X.consumeBy)return!1;const G=new Date(X.consumeBy);return os(G,K)})}let P=[...D];switch(c){case"az":P.sort((K,X)=>K.name.localeCompare(X.name));break;case"za":P.sort((K,X)=>X.name.localeCompare(K.name));break;case"category":P.sort((K,X)=>(K.category||"").localeCompare(X.category||""));break}return P},[t,i,u,p,g,j,S,y,c]),H=f.useMemo(()=>{const D={"to-buy":0,"low-stock":0,"in-stock":0};return O.forEach(P=>{P.price!==void 0&&(D[P.status]+=P.price*P.quantity)}),D},[O]),$=f.useMemo(()=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}),[]);return e.jsx(zn,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:e.jsx($j,{query:i,onQueryChange:o,sort:c,onSortChange:d,placeFilter:u,onPlaceFilterChange:m,statusFilter:p,onStatusFilterChange:x,categoryFilter:g,onCategoryFilterChange:v,onlyToBuy:j,onOnlyToBuyChange:b,nextOnly:S,onNextOnlyChange:E,expireSoonOnly:y,onExpireSoonOnlyChange:N,places:R,categories:I,filtersOpen:T,setFiltersOpen:k,isMobile:M})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8",children:nv.map(D=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-base text-gray-700 flex items-center gap-2",children:[ne.createElement(rv[D.key],{className:"w-4 h-4"}),D.title]}),e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full",children:O.filter(P=>P.status===D.key).length})]}),e.jsx("div",{className:"text-sm text-gray-600 font-medium",children:$.format(H[D.key])}),e.jsxs("div",{className:"space-y-2 h-full max-h-[calc(100vh-300px)] overflow-y-auto",children:[O.filter(P=>P.status===D.key).map(P=>{const K=Vt(new Date,3),X=P.consumeBy?new Date(P.consumeBy):null,G=X?os(X,new Date):!1,U=X?os(X,K):!1;return e.jsxs(je,{className:`cursor-pointer transition-all duration-200 hover:shadow-md border-l-4 ${D.key==="in-stock"?"border-l-green-500 hover:border-l-green-600":D.key==="low-stock"?"border-l-yellow-500 hover:border-l-yellow-600":"border-l-blue-500 hover:border-l-blue-600"} ${U||G?"border-red-500 bg-red-50/30":""} ${G?"bg-red-50/50":""}`,onClick:()=>s(P),children:[e.jsxs(we,{className:"p-2 pb-1 md:p-2 md:pb-1",children:[e.jsx("div",{className:"font-medium text-sm leading-tight mb-1",children:P.name}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[e.jsx("span",{className:"font-medium",children:P.quantity}),P.category&&e.jsx("span",{className:"bg-gray-100 text-gray-700 px-1.5 py-0.5 rounded text-xs",children:zd(P.category)})]}),P.consumeBy&&e.jsxs("div",{className:`text-xs mt-1 ${G?"text-red-600 font-medium":U?"text-orange-600":"text-gray-500"}`,children:[G?"⚠️ Vencido":U?"⏰ Por vencer":"Hasta"," ",P.consumeBy]})]}),e.jsx(Xs,{className:"bg-gray-50/70 border-t border-gray-100 p-0 md:p-0",children:e.jsxs("div",{className:"flex justify-center gap-1 w-full px-2 py-2",children:[nv.filter(Y=>Y.key!==D.key).map(Y=>{const ae=rv[Y.key],ye=Y.key==="in-stock"?"text-green-600 hover:bg-green-50":Y.key==="low-stock"?"text-yellow-600 hover:bg-yellow-50":"text-blue-600 hover:bg-blue-50";return e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(F,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 ${ye}`,onClick:oe=>{oe.stopPropagation(),n(P.id,Y.key)},children:e.jsx(ae,{className:"w-4 h-4"})})}),e.jsxs(rs,{children:["Mover a ",Y.title]})]},Y.key)}),e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-600 hover:bg-gray-50",onClick:Y=>{Y.stopPropagation(),s(P)},children:e.jsx(b_,{className:"w-4 h-4"})})}),e.jsx(rs,{children:"Ver detalles"})]}),e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(F,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 ${P.nextPurchase?"text-yellow-600 hover:bg-yellow-50":"text-gray-600 hover:bg-gray-50"}`,onClick:Y=>{Y.stopPropagation(),r(P)},children:e.jsx(j_,{className:"w-4 h-4",...P.nextPurchase&&{fill:"currentColor"}})})}),e.jsx(rs,{children:P.nextPurchase?"Quitar de próxima compra":"Marcar próxima compra"})]})]})})]},P.id)}),O.filter(P=>P.status===D.key).length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400 border-2 border-dashed border-gray-200 rounded-lg",children:e.jsx("div",{className:"text-sm",children:"Sin elementos"})})]})]},D.key))})]})})},WL=({items:t,onEdit:n,onDelete:s,onUpdate:r})=>{const[i,o]=f.useState(""),[c,d]=f.useState("az"),[u,m]=f.useState(""),[p,x]=f.useState(""),[g,v]=f.useState(""),[j,b]=f.useState(!1),[y,N]=f.useState(!1),[S,E]=f.useState(!1),[T,k]=f.useState(!1),[M,R]=f.useState(!1),{isMobile:I}=xd(),O=f.useMemo(()=>Array.from(new Set(t.map(P=>P.place).filter(Boolean))),[t]),H=f.useMemo(()=>Array.from(new Set(t.map(P=>P.category).filter(Boolean))),[t]),$=f.useMemo(()=>{let P=t.filter(X=>X.name.toLowerCase().includes(i.toLowerCase()));if(u&&(P=P.filter(X=>X.place===u)),p&&(P=P.filter(X=>X.status===p)),g&&(g==="__empty"?P=P.filter(X=>!X.category):P=P.filter(X=>X.category===g)),S&&(P=P.filter(X=>X.price===void 0)),j&&(P=P.filter(X=>X.status==="to-buy")),y&&(P=P.filter(X=>X.nextPurchase)),T){const X=Vt(new Date,3);P=P.filter(G=>{if(!G.consumeBy)return!1;const U=new Date(G.consumeBy);return os(U,X)})}let K=[...P];switch(c){case"az":K.sort((X,G)=>X.name.localeCompare(G.name));break;case"za":K.sort((X,G)=>G.name.localeCompare(X.name));break;case"category":K.sort((X,G)=>(X.category||"").localeCompare(G.category||""));break}return K},[t,i,u,p,g,S,j,y,T,c]),D=f.useMemo(()=>$.reduce((P,K)=>K.status==="to-buy"&&K.price!==void 0?P+K.price*K.quantity:P,0),[$]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx($j,{query:i,onQueryChange:o,sort:c,onSortChange:d,placeFilter:u,onPlaceFilterChange:m,statusFilter:p,onStatusFilterChange:x,categoryFilter:g,onCategoryFilterChange:v,onlyToBuy:j,onOnlyToBuyChange:b,nextOnly:y,onNextOnlyChange:N,expireSoonOnly:T,onExpireSoonOnlyChange:k,noPriceOnly:S,onNoPriceOnlyChange:E,places:O,categories:H,filtersOpen:M,setFiltersOpen:R,isMobile:I}),e.jsxs("div",{className:"text-right font-medium",children:["Total pendiente: ",new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(D)]}),e.jsx("div",{className:"space-y-2",children:$.map(P=>e.jsxs("div",{className:"bg-white shadow-sm border rounded-lg p-3 flex justify-between items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:P.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Cantidad: ",P.quantity,P.category&&` • ${zd(P.category)}`,P.place&&` • ${P.place}`,P.consumeBy&&` • Consumir antes de ${P.consumeBy}`]}),e.jsx("div",{className:"text-sm",children:e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs ${P.status==="in-stock"?"bg-green-100 text-green-800":P.status==="low-stock"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:P.status==="in-stock"?"En Stock":P.status==="low-stock"?"Poco Stock":"Por Comprar"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>r(P.id,{quantity:P.quantity+1}),children:e.jsx(ud,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>P.quantity>1&&r(P.id,{quantity:P.quantity-1}),children:e.jsx(Dr,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>n(P),children:e.jsx(vf,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>s(P.id),children:e.jsx(dl,{className:"h-4 w-4"})})]})]},P.id))})]})},HL=()=>{const{items:t,addItem:n,updateItem:s,deleteItem:r,moveItem:i}=Dl(),[o,c]=f.useState(!1),d=lr(),[u,m]=f.useState(null),[p,x]=f.useState("kanban"),[g,v]=f.useState(!1),j=(b,y)=>{y?s(y,b):n(b)};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs($d,{title:"Lista de Compras",children:[e.jsx(zn,{children:e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(Mj,{type:"single",value:p,onValueChange:b=>b&&x(b),children:[e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(rf,{value:"kanban","aria-label":"Kanban",children:e.jsx(Vv,{className:"w-4 h-4"})})}),e.jsx(rs,{children:e.jsx("p",{children:"Vista Kanban"})})]}),e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(rf,{value:"list","aria-label":"Lista",children:e.jsx(N_,{className:"w-4 h-4"})})}),e.jsx(rs,{children:e.jsx("p",{children:"Vista Lista"})})]})]}),e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>c(!0),children:[e.jsx(Ns,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Agregar"})]})}),e.jsx(rs,{children:e.jsx("p",{children:"Agregar"})})]}),e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>v(!0),children:[e.jsx(Fn,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Exportar"})]})}),e.jsx(rs,{children:e.jsx("p",{children:"Exportar"})})]})]})}),e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(pl,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(or,{align:"end",children:[e.jsxs(ut,{onClick:()=>c(!0),children:[e.jsx(Ns,{className:"mr-2 h-4 w-4"}),"Agregar"]}),e.jsxs(ut,{onClick:()=>v(!0),children:[e.jsx(Fn,{className:"mr-2 h-4 w-4"}),"Exportar ingredientes"]}),e.jsx(Xi,{}),d.pathname!=="/meal"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/meal",className:"flex items-center",children:[e.jsx(Nn,{className:"mr-2 h-4 w-4"}),"Plan de Comidas"]})}),d.pathname!=="/shopping-list"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/shopping-list",className:"flex items-center",children:[e.jsx(Fa,{className:"mr-2 h-4 w-4"}),"Lista de Compras"]})}),d.pathname!=="/recipes"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/recipes",className:"flex items-center",children:[e.jsx(Ui,{className:"mr-2 h-4 w-4"}),"Recetas"]})}),d.pathname!=="/prepared-meals"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/prepared-meals",className:"flex items-center",children:[e.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Comidas Preparadas"]})})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4 space-y-4",children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-lg",children:"No hay elementos en tu lista"}),e.jsx("p",{className:"text-sm",children:'Haz clic en "Agregar" para comenzar'})]}):p==="kanban"?e.jsx(BL,{items:t,onMove:i,onView:m,onToggleNext:b=>s(b.id,{nextPurchase:!b.nextPurchase})}):e.jsx(WL,{items:t,onEdit:m,onDelete:r,onUpdate:s})}),e.jsx(LL,{open:o||!!u,onOpenChange:()=>{c(!1),m(null)},onSave:j,onDelete:b=>r(b),item:u||void 0}),e.jsx(PL,{open:g,onOpenChange:v})]})},UL=()=>e.jsx(Ss,{noPadding:!0,className:"h-full",children:e.jsx(HL,{})}),VL=({open:t,onOpenChange:n,onSave:s,recipe:r})=>{const[i,o]=f.useState(""),[c,d]=f.useState(""),[u,m]=f.useState(""),[p,x]=f.useState(""),[g,v]=f.useState("fácil"),[j,b]=f.useState(""),[y,N]=f.useState(""),[S,E]=f.useState(""),[T,k]=f.useState(""),[M,R]=f.useState(""),[I,O]=f.useState("breakfast");f.useEffect(()=>{r?(o(r.name),d(r.description||""),m(r.ingredients.map($=>`${$.quantity} ${$.name}`).join(`
`)),x(r.instructions),v(r.difficulty||"fácil"),b(r.prepTime!==void 0?String(r.prepTime):""),N(String(r.nutrition.calories)),E(String(r.nutrition.protein)),k(String(r.nutrition.carbs)),R(String(r.nutrition.fat)),O(r.mealType)):(o(""),d(""),m(""),x(""),v("fácil"),b(""),N(""),E(""),k(""),R(""),O("breakfast"))},[r,t]);const H=()=>{const $=u.split(`
`).map(P=>P.trim()).filter(Boolean).map(P=>{const[K,...X]=P.split(" ");return{quantity:K,name:X.join(" ")}}),D={name:i,ingredients:$,description:c.trim()||void 0,difficulty:g,prepTime:j?Number(j):void 0,instructions:p,nutrition:{calories:Number(y)||0,protein:Number(S)||0,carbs:Number(T)||0,fat:Number(M)||0},mealType:I};r?s(D,r.id):s(D),n(!1)};return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"sm:max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx(bt,{children:e.jsxs(jt,{children:[r?"Editar":"Agregar"," Receta"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"name",children:"Nombre"}),e.jsx(Ve,{id:"name",value:i,onChange:$=>o($.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"description",children:"Descripción (opcional)"}),e.jsx(vt,{id:"description",value:c,onChange:$=>d($.target.value),className:"min-h-[80px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"difficulty",children:"Dificultad"}),e.jsxs(ft,{value:g,onValueChange:$=>v($),children:[e.jsx(ct,{id:"difficulty",children:e.jsx(pt,{})}),e.jsxs(dt,{children:[e.jsx(De,{value:"fácil",children:"Fácil"}),e.jsx(De,{value:"media",children:"Media"}),e.jsx(De,{value:"difícil",children:"Difícil"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"prepTime",children:"Tiempo (min)"}),e.jsx(Ve,{id:"prepTime",type:"number",value:j,onChange:$=>b($.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"ingredients",children:"Ingredientes (uno por línea)"}),e.jsx(vt,{id:"ingredients",value:u,onChange:$=>m($.target.value),className:"min-h-[120px]"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"instructions",children:"Instrucciones"}),e.jsx(vt,{id:"instructions",value:p,onChange:$=>x($.target.value),className:"min-h-[120px]"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"calories",children:"Calorías"}),e.jsx(Ve,{id:"calories",type:"number",value:y,onChange:$=>N($.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"protein",children:"Proteína (g)"}),e.jsx(Ve,{id:"protein",type:"number",value:S,onChange:$=>E($.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"carbs",children:"Carbs (g)"}),e.jsx(Ve,{id:"carbs",type:"number",value:T,onChange:$=>k($.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"fat",children:"Grasa (g)"}),e.jsx(Ve,{id:"fat",type:"number",value:M,onChange:$=>R($.target.value)})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"mealType",children:"Tipo de comida"}),e.jsxs(ft,{value:I,onValueChange:$=>O($),children:[e.jsx(ct,{id:"mealType",children:e.jsx(pt,{})}),e.jsx(dt,{children:Object.entries(_s).map(([$,D])=>e.jsx(De,{value:$,children:D.title},$))})]})]})]}),e.jsx(en,{children:e.jsx(F,{onClick:H,children:"Guardar"})})]})})},GL=({open:t,onOpenChange:n})=>{const{recipes:s}=Ld(),r={title:"Exportar Recetas",modules:[{id:"recipes",label:"Recetas",description:"Recetas con campos y opciones personalizables",icon:e.jsx(ld,{className:"w-4 h-4"}),fields:[{id:"allRecipes",label:"Todas las recetas",description:"Incluir todas las recetas (por defecto solo favoritas)"},{id:"groupByMealType",label:"Agrupar por tipo de comida",description:"Organizar por desayuno, almuerzo, cena, etc."},{id:"groupByDifficulty",label:"Agrupar por dificultad",description:"Organizar por nivel de dificultad"},{id:"name",label:"Nombre",description:"Nombre de la receta"},{id:"description",label:"Descripción",description:"Descripción de la receta"},{id:"difficulty",label:"Dificultad",description:"Nivel de dificultad (fácil, media, difícil)"},{id:"prepTime",label:"Tiempo de preparación",description:"Tiempo estimado en minutos"},{id:"ingredients",label:"Ingredientes",description:"Lista de ingredientes con cantidades"},{id:"instructions",label:"Pasos de preparación",description:"Instrucciones detalladas"},{id:"nutrition",label:"Información nutricional",description:"Calorías, proteínas, carbohidratos, grasas"},{id:"mealType",label:"Tipo de comida",description:"Categoría de la comida"},{id:"favorite",label:"Estado favorito",description:"Si la receta está marcada como favorita"}],dataGenerator:(i,o)=>{const c=i.includes("allRecipes"),d=c?s:s.filter(m=>m.favorite===!0),u=m=>{const p={};return i.filter(g=>g!=="allRecipes"&&g!=="groupByMealType"&&g!=="groupByDifficulty").length===0?{name:m.name,description:m.description,difficulty:m.difficulty,prepTime:m.prepTime,ingredients:m.ingredients,instructions:m.instructions,nutrition:m.nutrition,mealType:m.mealType,favorite:m.favorite}:(i.includes("name")&&(p.name=m.name),i.includes("description")&&m.description&&(p.description=m.description),i.includes("difficulty")&&m.difficulty&&(p.difficulty=m.difficulty),i.includes("prepTime")&&m.prepTime&&(p.prepTime=m.prepTime),i.includes("ingredients")&&(p.ingredients=m.ingredients),i.includes("instructions")&&(p.instructions=m.instructions),i.includes("nutrition")&&(p.nutrition=m.nutrition),i.includes("mealType")&&(p.mealType=m.mealType),i.includes("favorite")&&(p.favorite=m.favorite),p)};return i.includes("groupByMealType")&&i.includes("groupByDifficulty")?{recetas:d.reduce((p,x)=>{const g=x.mealType,v=x.difficulty||"sin_especificar";return p[g]||(p[g]={}),p[g][v]||(p[g][v]=[]),p[g][v].push(u(x)),p},{})}:i.includes("groupByMealType")?{recetas:d.reduce((p,x)=>{const g=x.mealType;return p[g]||(p[g]=[]),p[g].push(u(x)),p},{})}:i.includes("groupByDifficulty")?{recetas:d.reduce((p,x)=>{const g=x.difficulty||"sin_especificar";return p[g]||(p[g]=[]),p[g].push(u(x)),p},{})}:{recetas:d.map(u),total:d.length,tipo:c?"todas":"favoritas",exportedAt:new Date().toISOString()}}}]};return e.jsx(cp,{open:t,onOpenChange:n,config:r})},av=({recipes:t,iconOnly:n=!1,className:s})=>{const[r,i]=f.useState(!1),o=()=>{i(!0)};return e.jsxs(e.Fragment,{children:[n?e.jsxs(F,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 ${s}`,onClick:o,children:[e.jsx(Fn,{className:"w-4 h-4"}),e.jsx("span",{className:"sr-only",children:"Exportar"})]}):e.jsxs(F,{variant:"outline",size:"sm",onClick:o,className:`flex items-center gap-2 ${s}`,children:[e.jsx(Fn,{className:"w-4 h-4"}),"Exportar"]}),e.jsx(GL,{open:r,onOpenChange:i})]})},qL=()=>{const{recipes:t,addRecipe:n,updateRecipe:s}=Ld(),[r,i]=f.useState(!1),o=lr(),[c,d]=f.useState(null),[u,m]=f.useState(""),[p,x]=f.useState(""),[g,v]=f.useState("az"),j=f.useMemo(()=>{let y=t.filter(S=>S.name.toLowerCase().includes(u.toLowerCase()));p&&(y=y.filter(S=>S.mealType===p));const N=[...y];return N.sort((S,E)=>g==="az"?S.name.localeCompare(E.name):E.name.localeCompare(S.name)),N},[t,u,p,g]),b=(y,N)=>{N?s(N,y):n(y)};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs($d,{title:"Recetas",children:[e.jsx(zn,{children:e.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>i(!0),children:[e.jsx(Ns,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Agregar"})]})}),e.jsx(rs,{children:e.jsx("p",{children:"Agregar"})})]}),e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(av,{recipes:t,iconOnly:!0})}),e.jsx(rs,{children:e.jsx("p",{children:"Exportar"})})]})]})}),e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(pl,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(or,{align:"end",children:[e.jsxs(ut,{onClick:()=>i(!0),children:[e.jsx(Ns,{className:"mr-2 h-4 w-4"}),"Agregar"]}),e.jsx(ut,{asChild:!0,children:e.jsx(av,{recipes:t})}),e.jsx(Xi,{}),o.pathname!=="/meal"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/meal",className:"flex items-center",children:[e.jsx(Nn,{className:"mr-2 h-4 w-4"}),"Plan de Comidas"]})}),o.pathname!=="/shopping-list"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/shopping-list",className:"flex items-center",children:[e.jsx(Fa,{className:"mr-2 h-4 w-4"}),"Lista de Compras"]})}),o.pathname!=="/recipes"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/recipes",className:"flex items-center",children:[e.jsx(Ui,{className:"mr-2 h-4 w-4"}),"Recetas"]})}),o.pathname!=="/prepared-meals"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/prepared-meals",className:"flex items-center",children:[e.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Comidas Preparadas"]})})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs("div",{className:"p-4 space-y-4 h-full overflow-y-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:[e.jsx(Ve,{placeholder:"Buscar",value:u,onChange:y=>m(y.target.value),className:"sm:w-60"}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs(ft,{value:g,onValueChange:y=>v(y),children:[e.jsx(ct,{className:"w-32",children:e.jsx(pt,{placeholder:"Ordenar"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"az",children:"Nombre A-Z"}),e.jsx(De,{value:"za",children:"Nombre Z-A"})]})]}),e.jsxs(ft,{value:p||"all",onValueChange:y=>x(y==="all"?"":y),children:[e.jsx(ct,{className:"w-40",children:e.jsx(pt,{placeholder:"Tipo"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"all",children:"Todos"}),Object.entries(_s).map(([y,N])=>e.jsx(De,{value:y,children:N.title},y))]})]})]})]}),j.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No hay recetas guardadas"}):e.jsx("div",{className:"space-y-4",children:j.map(y=>e.jsxs(je,{children:[e.jsxs(Mt,{className:"flex flex-row items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(Lt,{className:"text-base",children:y.name}),e.jsx(A0,{children:_s[y.mealType].title})]}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>{d(y),i(!0)},children:"Editar"})]}),e.jsxs(we,{className:"space-y-2",children:[y.description&&e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:y.description}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Dificultad:"})," ",y.difficulty||"N/A"," |"," ",e.jsx("span",{className:"font-medium",children:"Tiempo:"})," ",y.prepTime?`${y.prepTime} min`:"N/A"]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Ingredientes:"}),e.jsx("ul",{className:"list-disc pl-4 text-sm",children:y.ingredients.map((N,S)=>e.jsxs("li",{children:[N.quantity," ",N.name]},S))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Instrucciones:"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:y.instructions})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Información Nutricional:"}),e.jsxs("p",{className:"text-sm",children:[y.nutrition.calories," kcal |"," ",y.nutrition.protein,"g P |"," ",y.nutrition.carbs,"g C |"," ",y.nutrition.fat,"g G"]})]})]})]},y.id))})]})}),e.jsx(VL,{open:r,onOpenChange:y=>{y||d(null),i(y)},onSave:b,recipe:c||void 0})]})},YL=()=>e.jsx(Ss,{noPadding:!0,className:"h-full",children:e.jsx(qL,{})}),KL=({open:t,onOpenChange:n,onSave:s,meal:r})=>{const[i,o]=f.useState(""),[c,d]=f.useState("");f.useEffect(()=>{r?(o(r.name),d(r.portions!==void 0?String(r.portions):"")):(o(""),d(""))},[r,t]);const u=()=>{const m={name:i};c&&(m.portions=Number(c)),s(m,r==null?void 0:r.id),n(!1)};return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"sm:max-w-md",children:[e.jsx(bt,{children:e.jsxs(jt,{children:[r?"Editar":"Agregar"," Comida Preparada"]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"pm-name",children:"Nombre"}),e.jsx(Ve,{id:"pm-name",value:i,onChange:m=>o(m.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Ye,{htmlFor:"pm-portions",children:"Cantidad/Porciones (opcional)"}),e.jsx(Ve,{id:"pm-portions",type:"number",value:c,onChange:m=>d(m.target.value)})]})]}),e.jsx(en,{children:e.jsx(F,{onClick:u,children:"Guardar"})})]})})},JL=()=>{const{meals:t,addMeal:n,updateMeal:s,deleteMeal:r}=lp(),[i,o]=f.useState(!1),c=lr(),[d,u]=f.useState(null),m=(p,x)=>{x?s(x,p):n(p)};return e.jsxs("div",{className:"w-full h-full flex flex-col",children:[e.jsxs($d,{title:"Comidas Preparadas",children:[e.jsx(zn,{children:e.jsx("div",{className:"hidden md:flex items-center gap-2",children:e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>o(!0),children:[e.jsx(Ns,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Agregar"})]})}),e.jsx(rs,{children:e.jsx("p",{children:"Agregar"})})]})})}),e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 md:hidden",children:[e.jsx(pl,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Opciones"})]})}),e.jsxs(or,{align:"end",children:[e.jsxs(ut,{onClick:()=>o(!0),children:[e.jsx(Ns,{className:"mr-2 h-4 w-4"}),"Agregar"]}),e.jsx(Xi,{}),c.pathname!=="/meal"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/meal",className:"flex items-center",children:[e.jsx(Nn,{className:"mr-2 h-4 w-4"}),"Plan de Comidas"]})}),c.pathname!=="/shopping-list"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/shopping-list",className:"flex items-center",children:[e.jsx(Fa,{className:"mr-2 h-4 w-4"}),"Lista de Compras"]})}),c.pathname!=="/recipes"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/recipes",className:"flex items-center",children:[e.jsx(Ui,{className:"mr-2 h-4 w-4"}),"Recetas"]})}),c.pathname!=="/prepared-meals"&&e.jsx(ut,{asChild:!0,children:e.jsxs(Ds,{to:"/prepared-meals",className:"flex items-center",children:[e.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Comidas Preparadas"]})})]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx("div",{className:"p-4 space-y-4 h-full overflow-y-auto",children:t.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No hay comidas guardadas"}):e.jsx("div",{className:"space-y-2",children:t.map(p=>e.jsxs("div",{className:"flex justify-between items-center border p-2 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:p.name}),p.portions!==void 0&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Porciones: ",p.portions]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>{u(p),o(!0)},children:"Editar"}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>r(p.id),children:"Eliminar"})]})]},p.id))})})}),e.jsx(KL,{open:i||!!d,onOpenChange:p=>{p||u(null),o(p)},onSave:m,meal:d||void 0})]})},XL=()=>e.jsx(Ss,{noPadding:!0,className:"h-full",children:e.jsx(JL,{})}),af={cardio:{name:"Cardio",description:"Ejercicios cardiovasculares",icon:"❤️"},strength:{name:"Fuerza",description:"Ejercicios de fuerza y resistencia",icon:"💪"},flexibility:{name:"Flexibilidad",description:"Ejercicios de estiramiento",icon:"🤸"}},ii=[{id:1,name:"Pasos",icon:"👣",category:"cardio",targetMuscles:["piernas"],caloriesPerHour:200,description:"Registro de pasos diarios",stepsPerKm:1312},{id:2,name:"Trotar",icon:"🏃",category:"cardio",targetMuscles:["piernas","core"],defaultDuration:30,caloriesPerHour:500,description:"Trote suave a ritmo constante",stepsPerKm:1200},{id:3,name:"Bicicleta",icon:"🚲",category:"cardio",targetMuscles:["piernas","core"],defaultDuration:45,defaultDistance:1e4,caloriesPerHour:450,description:"Ciclismo recreativo"},{id:4,name:"Caminata",icon:"🚶",category:"cardio",targetMuscles:["piernas"],defaultDuration:30,caloriesPerHour:250,description:"Caminata a paso moderado",stepsPerKm:1400},{id:5,name:"Natación",icon:"🏊",category:"cardio",targetMuscles:["todo el cuerpo"],defaultDuration:30,caloriesPerHour:550,description:"Natación estilo libre"},{id:6,name:"Tenis",icon:"🎾",category:"cardio",targetMuscles:["todo el cuerpo"],defaultDuration:60,caloriesPerHour:500,description:"Partido recreativo de tenis"},{id:7,name:"Abdominales",icon:"💪",category:"strength",targetMuscles:["abdominales","core"],defaultSets:3,defaultReps:15,caloriesPerHour:300,description:"Series de abdominales básicos"},{id:8,name:"Pesas de mano",icon:"🏋️",category:"strength",targetMuscles:["brazos","hombros"],defaultSets:3,defaultReps:12,caloriesPerHour:250,description:"Ejercicios con mancuernas ligeras"},{id:9,name:"Flexiones",icon:"💪",category:"strength",targetMuscles:["pecho","tríceps","hombros"],defaultSets:3,defaultReps:10,caloriesPerHour:350,description:"Flexiones de pecho (pushups)"},{id:10,name:"Sentadillas",icon:"🏋️",category:"strength",targetMuscles:["cuádriceps","glúteos","core"],defaultSets:3,defaultReps:12,caloriesPerHour:400,description:"Sentadillas sin peso adicional"},{id:11,name:"Burpees",icon:"💥",category:"strength",targetMuscles:["todo el cuerpo"],defaultSets:3,defaultReps:15,caloriesPerHour:700,description:"Ejercicio completo de cardio y fuerza"},{id:12,name:"Yoga",icon:"🧘",category:"flexibility",targetMuscles:["todo el cuerpo"],defaultDuration:20,caloriesPerHour:250,description:"Rutina básica de yoga"},{id:13,name:"Estiramientos",icon:"🤸",category:"flexibility",targetMuscles:["todo el cuerpo"],defaultDuration:15,caloriesPerHour:150,description:"Rutina de estiramientos generales"}],ZL={cardio:"bg-red-500",strength:"bg-blue-500",flexibility:"bg-green-500"},QL=t=>{const[n,s]=f.useState(null),[r,i]=f.useState("idle"),[o,c]=f.useState(null),{user:d}=He(),u=v=>v.reduce((j,b)=>{const y=ii.find(S=>S.id===b.exerciseId);if(!y)return j;j.totalCalories+=b.calories||0,j.totalSteps+=b.steps||0,j.totalDuration+=b.duration||0,j.totalDistance+=b.distance||0;const N=j.categoryStats[y.category];return N.count+=1,N.duration+=b.duration||0,N.calories+=b.calories||0,j},{totalCalories:0,totalSteps:0,totalDuration:0,totalDistance:0,categoryStats:{cardio:{count:0,duration:0,calories:0},strength:{count:0,duration:0,calories:0},flexibility:{count:0,duration:0,calories:0}}});f.useEffect(()=>{if(!d)return;i("loading");const v=Oe(t),j=be(fe,"exercises",`${d.uid}_${v}`),b=ns(j,y=>{y.exists()?s(y.data()):s(null),y.metadata.hasPendingWrites?i("pending"):i("saved")},y=>{c(y instanceof Error?y.message:"Error al cargar ejercicios"),i("error")});return()=>b()},[d,t]);const m=async v=>{if(!d)return;i("saving"),c(null);const j=Oe(t),b=be(fe,"exercises",`${d.uid}_${j}`);try{const y=(n==null?void 0:n.exercises)||[];y.push(v);const N=u(y),S={userId:d.uid,date:j,exercises:y,summary:N,createdAt:(n==null?void 0:n.createdAt)||lt(),updatedAt:lt()};await ht(b,S),s(S)}catch(y){c(y instanceof Error?y.message:"Error al guardar ejercicio"),i("error")}},p=async(v,j)=>{if(!(!d||!n)){i("saving"),c(null);try{const b=Oe(t),y=be(fe,"exercises",`${d.uid}_${b}`),N=[...n.exercises];N[v]={...N[v],...j};const S=u(N),E={...n,exercises:N,summary:S,updatedAt:lt()};await ht(y,E),s(E)}catch(b){c(b instanceof Error?b.message:"Error al actualizar ejercicio"),i("error")}}},x=async v=>{if(!(!d||!n)){i("saving"),c(null);try{const j=Oe(t),b=be(fe,"exercises",`${d.uid}_${j}`),y=n.exercises.filter((N,S)=>S!==v);if(y.length===0)await ci(b),s(null);else{const N=u(y),S={...n,exercises:y,summary:N,updatedAt:lt()};await ht(b,S),s(S)}}catch(j){c(j instanceof Error?j.message:"Error al eliminar ejercicio"),i("error")}}},g=Rr("Exercise data");return{exerciseLogs:(n==null?void 0:n.exercises)||[],summary:n==null?void 0:n.summary,status:r,error:o,logExercise:m,updateExerciseLog:p,deleteExerciseLog:x,resync:g}},e3=({exerciseLogs:t,onUpdate:n,onDelete:s,isLoading:r})=>{if(r)return e.jsx("div",{className:"text-center py-8",children:"Cargando ejercicios..."});if(t.length===0)return e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay ejercicios registrados para este día"});const i=d=>{if(!ii.find(p=>p.id===d.exerciseId))return"";const m=[];return d.sets&&d.reps&&m.push(`${d.sets} series x ${d.reps} repeticiones`),d.duration&&m.push(`${d.duration} minutos`),d.distance&&m.push(`${(d.distance/1e3).toFixed(2)} km`),d.steps&&m.push(`${d.steps.toLocaleString()} pasos`),d.weight&&m.push(`${d.weight}kg`),m.join(" • ")},o=d=>{const u=ii.find(m=>m.id===d.exerciseId);return u?u.defaultDuration&&d.duration?d.duration/u.defaultDuration*100:u.defaultDistance&&d.distance?d.distance/u.defaultDistance*100:u.defaultSets&&u.defaultReps&&d.sets&&d.reps?d.sets*d.reps/(u.defaultSets*u.defaultReps)*100:100:0},c=()=>{const d=t.reduce((p,x)=>p+(x.calories||0),0),u=t.reduce((p,x)=>p+(x.steps||0),0),m=t.reduce((p,x)=>p+(x.duration||0),0);return d===0&&u===0?null:e.jsx(je,{className:"mb-6",children:e.jsxs(we,{className:"p-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Resumen del día"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[d>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zo,{className:"w-4 h-4 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:d}),e.jsx("p",{className:"text-xs text-gray-500",children:"calorías"})]})]}),u>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(e0,{className:"w-4 h-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:u.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"pasos"})]})]}),m>0&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:m}),e.jsx("p",{className:"text-xs text-gray-500",children:"minutos"})]})})]})]})})};return e.jsxs("div",{className:"space-y-4",children:[c(),t.map((d,u)=>{const m=ii.find(p=>p.id===d.exerciseId);return m?e.jsx(je,{children:e.jsxs(we,{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:m.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:m.name}),e.jsx("p",{className:"text-sm text-gray-500",children:i(d)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>n(u),children:e.jsx(S_,{className:"w-4 h-4"})}),e.jsx(F,{variant:"ghost",size:"icon",onClick:()=>s(u),children:e.jsx(dl,{className:"w-4 h-4 text-red-500"})})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"flex justify-between text-sm",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("span",{className:`px-2 py-1 rounded-full ${ZL[m.category]} text-white`,children:m.category}),d.calories&&e.jsxs("span",{className:"flex items-center gap-1 text-orange-500",children:[e.jsx(Zo,{className:"w-4 h-4"}),d.calories," kcal"]})]})}),e.jsx(ca,{value:o(d),className:"h-2"}),d.notes&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:d.notes})]})]})},u):null})]})},iv=({isOpen:t,onClose:n,onSubmit:s,initialData:r})=>{var v,j,b,y,N,S,E;const[i,o]=ne.useState(r?ii.find(T=>T.id===r.exerciseId):null),[c,d]=ne.useState({sets:((v=r==null?void 0:r.sets)==null?void 0:v.toString())||"",reps:((j=r==null?void 0:r.reps)==null?void 0:j.toString())||"",weight:((b=r==null?void 0:r.weight)==null?void 0:b.toString())||"",duration:((y=r==null?void 0:r.duration)==null?void 0:y.toString())||"",distance:((N=r==null?void 0:r.distance)==null?void 0:N.toString())||"",steps:((S=r==null?void 0:r.steps)==null?void 0:S.toString())||"",calories:((E=r==null?void 0:r.calories)==null?void 0:E.toString())||"",notes:(r==null?void 0:r.notes)||""}),[u,m]=ne.useState(0);f.useEffect(()=>{if(p(),i!=null&&i.stepsPerKm&&c.distance){const T=parseFloat(c.distance),k=Math.round(T*i.stepsPerKm);d(M=>({...M,steps:k.toString()}))}},[c.distance,c.duration,c.weight,i]);const p=()=>{if(!(i!=null&&i.caloriesPerHour))return;let T=parseInt(c.duration)||0;!T&&c.sets&&c.reps&&(T=parseInt(c.sets)*parseInt(c.reps)*3/60);let k=i.caloriesPerHour*T/60;if(c.weight&&i.category==="strength"){const R=parseInt(c.weight)/5;k*=1+R*.1}const M=Math.round(k);m(M),d(R=>({...R,calories:M.toString()}))},x=T=>{var k,M,R;o(T),d({sets:((k=T.defaultSets)==null?void 0:k.toString())||"",reps:((M=T.defaultReps)==null?void 0:M.toString())||"",weight:"",duration:((R=T.defaultDuration)==null?void 0:R.toString())||"",distance:T.defaultDistance?(T.defaultDistance/1e3).toString():"",steps:"",calories:"",notes:""})},g=T=>{if(T.preventDefault(),!i)return;const k={exerciseId:i.id,calories:c.calories?parseInt(c.calories):u,...c.sets&&{sets:parseInt(c.sets)},...c.reps&&{reps:parseInt(c.reps)},...c.weight&&{weight:parseFloat(c.weight)},...c.duration&&{duration:parseInt(c.duration)},...c.distance&&{distance:parseFloat(c.distance)*1e3},...c.steps&&{steps:parseInt(c.steps)},...c.notes&&{notes:c.notes}};s(k),n()};return e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"sm:max-w-[700px] max-h-[90vh] sm:h-auto overflow-y-auto",children:[e.jsx(bt,{className:"sticky top-0 bg-background z-10 pb-4 mb-4 border-b",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs(jt,{className:"flex items-center gap-2 text-xl",children:[i&&!r&&e.jsx(F,{type:"button",variant:"ghost",size:"icon",onClick:()=>o(null),className:"h-8 w-8",children:e.jsx(C_,{className:"h-5 w-5"})}),r?"Editar ejercicio":"Agregar ejercicio"]})})}),e.jsx("form",{onSubmit:g,className:"space-y-6 pt-2",children:i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("span",{className:"text-3xl",children:i.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-lg",children:i.name}),e.jsx("p",{className:"text-sm text-gray-500",children:i.description})]})]}),i.category==="strength"&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"sets",children:"Series"}),e.jsx(Ve,{id:"sets",type:"number",min:"1",value:c.sets,onChange:T=>d(k=>({...k,sets:T.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"reps",children:"Repeticiones"}),e.jsx(Ve,{id:"reps",type:"number",min:"1",value:c.reps,onChange:T=>d(k=>({...k,reps:T.target.value}))})]}),i.name==="Pesas de mano"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"weight",children:"Peso (kg)"}),e.jsx(Ve,{id:"weight",type:"number",min:"0",step:"0.5",value:c.weight,onChange:T=>d(k=>({...k,weight:T.target.value}))})]})]}),(i.category==="cardio"||i.category==="flexibility")&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"duration",children:"Duración (min)"}),e.jsx(Ve,{id:"duration",type:"number",min:"1",value:c.duration,onChange:T=>d(k=>({...k,duration:T.target.value}))})]}),i.category==="cardio"&&i.name!=="Natación"&&i.name!=="Tenis"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"distance",children:"Distancia (km)"}),e.jsx(Ve,{id:"distance",type:"number",min:"0",step:"0.1",value:c.distance,onChange:T=>d(k=>({...k,distance:T.target.value}))})]})]}),i.stepsPerKm&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Ye,{htmlFor:"steps",children:["Pasos ",c.steps&&`(calculado: ${c.steps})`]}),e.jsx(Ve,{id:"steps",type:"number",min:"0",value:c.steps,onChange:T=>d(k=>({...k,steps:T.target.value})),placeholder:"Número de pasos"})]}),u>0&&e.jsx("div",{className:"p-4 bg-muted rounded-md",children:e.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:["Calorías estimadas: ",u," kcal"]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"calories",children:"Calorías"}),e.jsx(Ve,{id:"calories",type:"number",min:"0",value:c.calories,onChange:T=>d(k=>({...k,calories:T.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"notes",children:"Notas"}),e.jsx(vt,{id:"notes",value:c.notes,onChange:T=>d(k=>({...k,notes:T.target.value})),placeholder:"Añade notas sobre el ejercicio..."})]}),e.jsxs(en,{className:"gap-3 sm:gap-0",children:[e.jsx(F,{type:"button",variant:"outline",className:"flex-1 sm:flex-none",onClick:n,children:"Cancelar"}),e.jsx(F,{type:"submit",className:"flex-1 sm:flex-none",children:r?"Actualizar":"Guardar"})]})]}):e.jsxs(mr,{defaultValue:"cardio",className:"w-full",children:[e.jsx(fr,{className:"w-full h-12 grid grid-cols-3 mb-4",children:Object.entries(af).map(([T,k])=>e.jsxs(qt,{value:T,className:"flex items-center gap-2 text-base p-3",children:[e.jsx("span",{className:"text-xl",children:k.icon}),e.jsx("span",{children:k.name})]},T))}),Object.entries(af).map(([T])=>e.jsx(At,{value:T,className:"mt-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ii.filter(k=>k.category===T).map(k=>e.jsxs(F,{type:"button",variant:"outline",className:"flex flex-col items-center p-6 h-auto gap-3",onClick:()=>x(k),children:[e.jsx("span",{className:"text-3xl",children:k.icon}),e.jsx("span",{className:"text-sm font-normal text-center",children:k.name})]},k.id))})},T))]})})]})})},t3=({exerciseLogs:t,summary:n})=>{const s=ne.useMemo(()=>n||{totalCalories:t.reduce((c,d)=>c+(d.calories||0),0),totalSteps:t.reduce((c,d)=>c+(d.steps||0),0),totalDuration:t.reduce((c,d)=>c+(d.duration||0),0),totalDistance:t.reduce((c,d)=>c+(d.distance||0),0),categoryStats:t.reduce((c,d)=>{const u=ii.find(m=>m.id===d.exerciseId);return u&&(c[u.category]||(c[u.category]={count:0,duration:0,calories:0}),c[u.category].count+=1,c[u.category].duration+=d.duration||0,c[u.category].calories+=d.calories||0),c},{})},[t,n]),r=c=>new Date(c).toLocaleDateString("es-ES",{month:"short",day:"numeric"}),i=(c,d)=>typeof c=="string"?new Date(c).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):[c.toLocaleString(),d],o=ne.useMemo(()=>{const c=new Date,d=[];for(let u=6;u>=0;u--){const m=new Date(c);m.setDate(m.getDate()-u);const p=Oe(m);d.push({date:p,calories:0,steps:0,duration:0,distance:0})}return t.forEach(u=>{const m=d.find(p=>p.date===Oe(new Date));m&&(m.calories+=u.calories||0,m.steps+=u.steps||0,m.duration+=u.duration||0,m.distance+=(u.distance||0)/1e3)}),d},[t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(je,{children:e.jsxs(we,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(Zo,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Calorías"}),e.jsx("h4",{className:"text-2xl font-bold",children:s.totalCalories})]})]})}),e.jsx(je,{children:e.jsxs(we,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(e0,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Pasos"}),e.jsx("h4",{className:"text-2xl font-bold",children:s.totalSteps.toLocaleString()})]})]})}),e.jsx(je,{children:e.jsxs(we,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(xf,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Tiempo"}),e.jsxs("h4",{className:"text-2xl font-bold",children:[s.totalDuration," min"]})]})]})}),e.jsx(je,{children:e.jsxs(we,{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-muted rounded-lg",children:e.jsx(E_,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Distancia"}),e.jsxs("h4",{className:"text-2xl font-bold",children:[(s.totalDistance/1e3).toFixed(1)," km"]})]})]})})]}),e.jsxs(je,{children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Progreso"})}),e.jsx(we,{children:e.jsxs(mr,{defaultValue:"calories",children:[e.jsxs(fr,{className:"grid grid-cols-4 h-12",children:[e.jsx(qt,{value:"calories",className:"text-base",children:"Calorías"}),e.jsx(qt,{value:"steps",className:"text-base",children:"Pasos"}),e.jsx(qt,{value:"duration",className:"text-base",children:"Tiempo"}),e.jsx(qt,{value:"distance",className:"text-base",children:"Distancia"})]}),e.jsx(At,{value:"calories",className:"h-[300px] pt-4",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ri,{data:o,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"date",tickFormatter:r}),e.jsx(Mn,{}),e.jsx(Fs,{formatter:i,labelFormatter:r}),e.jsx(Qr,{}),e.jsx(Aa,{type:"monotone",dataKey:"calories",stroke:"#f97316",name:"Calorías",dot:!0})]})})}),e.jsx(At,{value:"steps",className:"h-[300px] pt-4",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ri,{data:o,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"date",tickFormatter:r}),e.jsx(Mn,{}),e.jsx(Fs,{formatter:i,labelFormatter:r}),e.jsx(Qr,{}),e.jsx(Aa,{type:"monotone",dataKey:"steps",stroke:"#3b82f6",name:"Pasos",dot:!0})]})})}),e.jsx(At,{value:"duration",className:"h-[300px] pt-4",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ri,{data:o,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"date",tickFormatter:r}),e.jsx(Mn,{}),e.jsx(Fs,{formatter:i,labelFormatter:r}),e.jsx(Qr,{}),e.jsx(Aa,{type:"monotone",dataKey:"duration",stroke:"#22c55e",name:"Minutos",dot:!0})]})})}),e.jsx(At,{value:"distance",className:"h-[300px] pt-4",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(ri,{data:o,children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"date",tickFormatter:r}),e.jsx(Mn,{}),e.jsx(Fs,{formatter:i,labelFormatter:r}),e.jsx(Qr,{}),e.jsx(Aa,{type:"monotone",dataKey:"distance",stroke:"#a855f7",name:"Kilómetros",dot:!0})]})})})]})})]}),e.jsxs(je,{children:[e.jsx(Mt,{children:e.jsx(Lt,{children:"Resumen por categoría"})}),e.jsx(we,{children:e.jsx("div",{className:"h-[300px]",children:e.jsx(zs,{width:"100%",height:"100%",children:e.jsxs(pd,{data:Object.entries(af).map(([c,d])=>{const u=s.categoryStats[c]||{count:0,duration:0,calories:0};return{category:d.name,minutos:u.duration,calorias:u.calories}}),children:[e.jsx(br,{strokeDasharray:"3 3"}),e.jsx(tr,{dataKey:"category"}),e.jsx(Mn,{yAxisId:"left",orientation:"left",stroke:"#f97316"}),e.jsx(Mn,{yAxisId:"right",orientation:"right",stroke:"#22c55e"}),e.jsx(Fs,{}),e.jsx(Qr,{}),e.jsx(Qo,{yAxisId:"left",dataKey:"calorias",fill:"#f97316",name:"Calorías"}),e.jsx(Qo,{yAxisId:"right",dataKey:"minutos",fill:"#22c55e",name:"Minutos"})]})})})})]})]})},s3=(t,n)=>{const[s,r]=f.useState(null),[i,o]=f.useState(!0),[c,d]=f.useState(null),{user:u}=He();return f.useEffect(()=>{(async()=>{if(r(null),!!u){o(!0),d(null);try{const p=[],x=new Date(t);for(;x<=n;)p.push(Oe(x)),x.setDate(x.getDate()+1);const v=(await Promise.all(p.map(j=>ds(be(fe,"exercises",`${u.uid}_${j}`))))).map((j,b)=>{var y;return{date:p[b],calories:j.exists()&&((y=j.data().summary)==null?void 0:y.totalCalories)||0}});r({dailyStats:v})}catch(p){console.error("Error al cargar estadísticas:",p),d(p instanceof Error?p.message:"Error al cargar estadísticas")}finally{o(!1)}}})()},[u,t,n]),{stats:s,loading:i,error:c}},n3=({selectedDate:t,goal:n=500})=>{const[s,r]=f.useState(_t(t));f.useEffect(()=>{r(_t(t))},[t]);const i=f.useMemo(()=>_t(s),[s]),o=f.useMemo(()=>wn(s),[s]),{stats:c,loading:d}=s3(i,o),u=f.useMemo(()=>{const p={};return c==null||c.dailyStats.forEach(({date:x,calories:g})=>{p[x]=g}),p},[c]),m=p=>{const x=Oe(p.date),g=u[x]||0,v=Math.min(g/n,1),j=28,b=3,y=(j-b)/2,N=2*Math.PI*y,S=N-v*N,E=g>=n;return e.jsxs("div",{className:"relative flex items-center justify-center w-7 h-7",children:[e.jsxs("svg",{width:j,height:j,className:"absolute",children:[e.jsx("circle",{cx:j/2,cy:j/2,r:y,stroke:E?"#fed7aa":"#e5e7eb",strokeWidth:b,fill:"none"}),e.jsx("circle",{cx:j/2,cy:j/2,r:y,stroke:E?"#f97316":"#9ca3af",strokeWidth:b,fill:"none",strokeDasharray:N,strokeDashoffset:S,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%"}})]}),e.jsx("span",{className:"text-[10px] font-medium z-10",children:p.date.getDate()})]})};return e.jsxs(je,{className:"w-full",children:[e.jsxs(Mt,{className:"flex flex-col items-center gap-2",children:[e.jsx(Zo,{className:"w-5 h-5 text-orange-600"}),e.jsx(Lt,{className:"text-center",children:"Historial Mensual"})]}),e.jsxs(we,{className:"relative p-4",children:[d&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 z-10",children:e.jsx(Qt,{className:"w-6 h-6 animate-spin"})}),e.jsx(Ed,{month:s,onMonthChange:r,showOutsideDays:!0,components:{DayContent:m},className:"p-0 w-full"})]})]})},zj=f.forwardRef(({selectedDate:t},n)=>{const{user:s}=He(),{exerciseLogs:r,summary:i,status:o,error:c,logExercise:d,updateExerciseLog:u,deleteExerciseLog:m,resync:p}=QL(t),{isOnline:x}=cr(),[g,v]=f.useState(!1),[j,b]=f.useState(null);return f.useImperativeHandle(n,()=>({openAddExercise:()=>v(!0)})),s?e.jsxs(je,{className:"w-full",children:[e.jsxs(we,{className:"p-6",children:[e.jsxs(mr,{defaultValue:"list",className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(fr,{children:[e.jsx(qt,{value:"list",children:"Lista"}),e.jsxs(qt,{value:"stats",className:"gap-2",children:[e.jsx(gf,{className:"w-4 h-4"}),"Estadísticas"]})]}),e.jsxs(F,{onClick:()=>v(!0),className:"gap-2 hidden sm:flex",disabled:o==="saving"||!x,children:[e.jsx(Ns,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Agregar"})]})]}),e.jsx(At,{value:"list",className:"m-0",children:e.jsx(e3,{exerciseLogs:r,onUpdate:b,onDelete:m,isLoading:o==="loading"})}),e.jsx(At,{value:"stats",className:"m-0",children:e.jsx(t3,{exerciseLogs:r,summary:i})})]}),c&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:c}),e.jsx(iv,{isOpen:g,onClose:()=>v(!1),onSubmit:d,selectedDate:t}),j!==null&&e.jsx(iv,{isOpen:!0,onClose:()=>b(null),onSubmit:y=>{u(j,y),b(null)},initialData:r[j],selectedDate:t})]}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[o==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),o==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),o==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),o==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!x&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:p,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]}):e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tus ejercicios"})})})});zj.displayName="Exercise";const r3=()=>{const[t,n]=f.useState(new Date),{user:s}=He(),r=f.useRef(null),{settings:i,saveSettings:o}=rp("exercise",{dailyCalories:500}),[c,d]=f.useState(i.dailyCalories);f.useEffect(()=>{d(i.dailyCalories)},[i.dailyCalories]);const u=()=>{var m;(m=r.current)==null||m.openAddExercise()};return s?e.jsxs(Ss,{showFloatingButton:!0,onFloatingButtonClick:u,floatingButtonLabel:"Agregar ejercicio",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Registro de Ejercicio"}),e.jsx("p",{className:"text-gray-500",children:"Registra y monitorea tus actividades físicas diarias"})]}),e.jsxs(mr,{defaultValue:"daily",className:"w-full",children:[e.jsxs(fr,{className:"mb-6",children:[e.jsx(qt,{value:"daily",children:"Registro Diario"}),e.jsx(qt,{value:"settings",children:"Configuración"})]}),e.jsxs(At,{value:"daily",children:[e.jsx(kr,{selectedDate:t,onChange:n}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-[1fr_300px] mt-4",children:[e.jsx(zj,{ref:r,selectedDate:t}),e.jsx(n3,{selectedDate:t,goal:i.dailyCalories})]})]}),e.jsx(At,{value:"settings",className:"space-y-4",children:e.jsx(je,{children:e.jsxs(we,{className:"pt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(Ye,{htmlFor:"calGoal",children:"Calorías diarias objetivo"}),e.jsx(Ve,{id:"calGoal",type:"number",value:c,onChange:m=>d(Number(m.target.value))})]}),e.jsx(F,{onClick:()=>o({dailyCalories:c}),children:"Guardar"})]})})})]})]}):e.jsx("div",{className:"container max-w-4xl mx-auto py-6",children:e.jsx(je,{children:e.jsxs(we,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Inicia sesión"}),e.jsx("p",{className:"text-gray-500",children:"Necesitas iniciar sesión para registrar y ver tus ejercicios"})]})})})},mp=(t,n)=>be(fe,"negative-habits",`${t}_${n}`),a3=async(t,n,s,r,i,o)=>{const c={habitId:r,timestamp:new Date().getTime(),...o?{note:o}:{}},u={...i[s]||{},[r]:c},m={userId:t,yearMonth:n,habits:{...i,[s]:u},updatedAt:lt()},p=mp(t,n);await ht(p,m,{merge:!0})},i3=async(t,n,s,r,i)=>{const o={...i[s]||{}};delete o[r];const c={userId:t,yearMonth:n,habits:{...i,[s]:o},updatedAt:lt()},d=mp(t,n);await ht(d,c,{merge:!0})},o3=async(t,n)=>{const s={},r=$t(fe,"negative-habits");for(const i of n)try{(await Wi(_r(r,un("userId","==",t),un("yearMonth","==",i)))).forEach(c=>{const d=c.data();s[i]=d.habits||{}})}catch(o){console.error(`Error fetching month ${i}:`,o)}return s},fp=t=>{const n={totalCount:0,byHabitId:{},byDate:{}};return Object.entries(t).forEach(([s])=>{const[r,i]=s.split("_"),o=parseInt(r);n.totalCount++,n.byHabitId[o]=(n.byHabitId[o]||0)+1,n.byDate[i]=(n.byDate[i]||0)+1}),n},l3=(t,n=5)=>{const s=fp(t);return Object.entries(s.byHabitId).sort(([,r],[,i])=>i-r).slice(0,n).map(([r,i])=>({habitId:parseInt(r),count:i}))},c3=(t,n=3)=>{const s=fp(t);return Object.entries(s.byDate).sort(([,r],[,i])=>i-r).slice(0,n).map(([r,i])=>({date:r,count:i}))},d3=t=>{const n=[],s=new Date(t),r=s.getDay(),i=r===0?-6:1-r;s.setDate(s.getDate()+i);for(let o=0;o<7;o++){const c=new Date(s);c.setDate(s.getDate()+o),n.push({dayName:c.toLocaleDateString("es-ES",{weekday:"short"}),fullDate:Oe(c)})}return n},u3=t=>{const n=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0");return`${n}-${s}`},m3=t=>{const n=t.getFullYear(),s=t.getMonth()+1,r=[];for(let i=1;i<=s;i++){const o=String(i).padStart(2,"0");r.push(`${n}-${o}`)}return r},f3=()=>{const[t,n]=f.useState({}),[s,r]=f.useState("idle"),[i,o]=f.useState(null),{user:c}=He(),d=f.useMemo(()=>{const g={};return Object.values(t).forEach(v=>{Object.entries(v).forEach(([j,b])=>{Object.entries(b).forEach(([y,N])=>{g[`${y}_${j}`]=N})})}),g},[t]),u=f.useMemo(()=>({...fp(d),topHabits:l3(d),frequentDays:c3(d)}),[d,t]);f.useEffect(()=>{if(!c)return;const g=new Date,v=u3(g);r("loading");const j=ns(mp(c.uid,v),y=>{if(y.exists()){const N=y.data();n(S=>({...S,[v]:N.habits||{}}))}y.metadata.hasPendingWrites?r("pending"):r("saved")},y=>{o(y instanceof Error?y.message:"Error al cargar los datos"),r("error")});return(async()=>{const y=m3(g),N=await o3(c.uid,y);n(S=>({...S,...N}))})(),()=>j()},[c]);const m=async(g,v,j)=>{if(c)try{r("saving"),o(null);const[b,y]=v.split("-"),N=`${b}-${y}`,S=t[N]||{};await a3(c.uid,N,v,g,S,j)}catch(b){o(b instanceof Error?b.message:"Error al guardar"),r("error")}},p=async(g,v)=>{if(c)try{r("saving"),o(null);const[j,b]=v.split("-"),y=`${j}-${b}`,N=t[y]||{};await i3(c.uid,y,v,g,N)}catch(j){o(j instanceof Error?j.message:"Error al eliminar"),r("error")}},x=Rr("Negative habit data");return{habits:d,status:s,error:i,stats:u,logHabit:m,removeLog:p,resync:x}},p3=({view:t,onViewChange:n})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{variant:t==="weekly"?"default":"outline",size:"sm",onClick:()=>n("weekly"),className:"gap-2",children:[e.jsx(Nn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Semanal"})]}),e.jsxs(F,{variant:t==="yearly"?"default":"outline",size:"sm",onClick:()=>n("yearly"),className:"gap-2",children:[e.jsx(Yv,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Anual"})]})]}),ov=({habits:t,completedHabits:n,weekDays:s,onLogHabit:r,onRemoveLog:i,disabled:o})=>e.jsx(zn,{children:e.jsxs("div",{className:"grid grid-cols-[minmax(100px,1fr)_repeat(7,minmax(32px,1fr))] gap-1",children:[e.jsx("div",{}),s.map(c=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium",children:c.dayName}),e.jsx("div",{className:"text-[10px] text-gray-400",children:c.fullDate.split("-").slice(1).join("/")})]},c.fullDate)),t.map(c=>e.jsxs(ne.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:c.icon}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm",children:c.name}),e.jsx("span",{className:"text-xs text-gray-500",children:c.category})]})]}),s.map(d=>{const u=`${c.id}_${d.fullDate}`,m=n[u];return e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(F,{variant:m?"destructive":"outline",size:"icon",className:"w-8 h-8 p-0",onClick:()=>m?i(c.id,d.fullDate):r(c.id,d.fullDate),disabled:o,children:m?e.jsx(Js,{className:"w-4 h-4 text-white"}):e.jsx(cd,{className:"w-4 h-4 text-muted-foreground"})})}),e.jsx(rs,{children:m?"Eliminar registro":"Registrar hábito"})]})},u)})]},c.id))]})}),Ii={health:{icon:"🏥",label:"Salud",description:"Hábitos que afectan tu salud física"},productivity:{icon:"⏰",label:"Productividad",description:"Hábitos que reducen tu eficiencia"},social:{icon:"👥",label:"Social",description:"Hábitos que afectan tus relaciones"},emotional:{icon:"😔",label:"Emocional",description:"Hábitos que afectan tu bienestar emocional"},finance:{icon:"💰",label:"Finanzas",description:"Hábitos que impactan tus finanzas"},digital:{icon:"📱",label:"Digital",description:"Hábitos digitales nocivos"},environment:{icon:"🌍",label:"Ambiente",description:"Hábitos que impactan al medio ambiente"}},Pa=[{id:1,name:"Saltarse comidas",icon:"🍽️",category:"health"},{id:2,name:"Dormir poco",icon:"😴",category:"health"},{id:3,name:"No hacer ejercicio",icon:"🏃",category:"health"},{id:4,name:"Comer en exceso",icon:"🫃🏻",category:"health"},{id:25,name:"Comida chatarra",icon:"🍔",category:"health"},{id:26,name:"Exceso de azúcar",icon:"🍭",category:"health"},{id:27,name:"Masturbación",icon:"🍆",category:"health"},{id:5,name:"Procrastinar",icon:"⏰",category:"productivity"},{id:6,name:"Distracciones",icon:"🎯",category:"productivity"},{id:7,name:"Multitarea",icon:"🔄",category:"productivity"},{id:8,name:"Desorganización",icon:"📋",category:"productivity"},{id:24,name:"Exceso de trabajo (Workaholic)",icon:"🍽️",category:"productivity"},{id:9,name:"Aislamiento",icon:"🚶",category:"social"},{id:10,name:"Conflictos",icon:"💢",category:"social"},{id:11,name:"No escuchar",icon:"👂",category:"social"},{id:29,name:"Dejar en visto",icon:"👀",category:"social"},{id:15,name:"Sobrepensar cosas",icon:"😰",category:"emotional"},{id:16,name:"Negatividad / Pesimismo",icon:"🌧️",category:"emotional"},{id:17,name:"Ser grosero/estresarme",icon:"🤬",category:"emotional"},{id:28,name:"Celos compulsivos",icon:"💁🏻‍♂️",category:"emotional"},{id:12,name:"Gastos impulsivos",icon:"💳",category:"finance"},{id:13,name:"No ahorrar",icon:"💰",category:"finance"},{id:14,name:"Más Deudas",icon:"📉",category:"finance"},{id:18,name:"Exceso de Redes sociales",icon:"📱",category:"digital"},{id:19,name:"Exceso de Videojuegos",icon:"🎮",category:"digital"},{id:20,name:"Exceso de Netflix",icon:"🎬",category:"digital"},{id:21,name:"Desperdiciar agua",icon:"💧",category:"environment"},{id:22,name:"No reciclar",icon:"♻️",category:"environment"},{id:23,name:"Consumo excesivo",icon:"🛍️",category:"environment"}],h3=({habits:t,onLogHabit:n,onRemoveLog:s,disabled:r})=>{const i=d3(new Date),[o,c]=f.useState(""),[d,u]=f.useState(["health"]),[m,p]=f.useState(!1),x=f.useMemo(()=>{const b={};return Pa.forEach(y=>{b[y.category]||(b[y.category]=[]),!(o&&!y.name.toLowerCase().includes(o.toLowerCase()))&&b[y.category].push(y)}),b},[o]),g=f.useMemo(()=>{const b=Pa.length,y=Object.values(x).reduce((E,T)=>E+T.length,0),N={},S=new Date().toISOString().split("T")[0];return Object.entries(t).forEach(([E])=>{const[T,k]=E.split("_");if(k===S){const M=Pa.find(R=>R.id===Number(T));M&&(N[M.category]=(N[M.category]||0)+1)}}),{totalHabits:b,filteredHabits:y,loggedByCategory:N,isFiltered:o.length>0}},[x,t,o]),v=f.useMemo(()=>{const b=new Map;return Object.entries(t).forEach(([y])=>{const[N]=y.split("_"),S=b.get(Number(N))||0;b.set(Number(N),S+1)}),Pa.filter(y=>b.has(y.id)).sort((y,N)=>(b.get(N.id)||0)-(b.get(y.id)||0)).slice(0,5)},[t]),j=b=>{u(y=>y.includes(b)?y.filter(N=>N!==b):[...y,b])};return e.jsxs("div",{className:"space-y-4",children:["      ",e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(fd,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(Ve,{placeholder:"Buscar hábito...",value:o,onChange:b=>c(b.target.value),className:"pl-8 pr-16"}),g.isFiltered&&e.jsxs("div",{className:"absolute right-2 top-2 bg-blue-100 text-blue-800 px-2 py-0.5 rounded-md text-xs font-medium",children:[g.filteredHabits,"/",g.totalHabits]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(F,{variant:"outline",onClick:()=>p(!m),className:"flex-1 sm:flex-none",children:m?"Mostrar más frecuentes":"Mostrar todos"}),Object.keys(g.loggedByCategory).length>0&&e.jsxs("div",{className:"bg-green-100 text-green-800 px-3 py-1.5 rounded-md text-sm font-medium",children:[Object.values(g.loggedByCategory).reduce((b,y)=>b+y,0)," hoy"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"sm:min-w-[640px]",children:m?e.jsx("div",{className:"space-y-6",children:Object.entries(x).map(([b,y])=>{if(y.length===0)return null;const N=d.includes(b),S=Ii[b];return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{variant:"ghost",onClick:()=>j(b),className:"w-full flex items-center justify-between p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:S.icon}),e.jsx("span",{className:"font-medium",children:S.label}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",y.length,")"]}),g.loggedByCategory[b]&&e.jsxs("span",{className:"bg-red-100 text-red-800 px-2 py-0.5 rounded-full text-xs font-medium ml-1",children:[g.loggedByCategory[b]," hoy"]})]}),N?e.jsx(Dr,{size:20}):e.jsx(ia,{size:20})]}),N&&e.jsx(ov,{habits:y,completedHabits:t,weekDays:i,onLogHabit:n,onRemoveLog:s,disabled:r})]},b)})}):e.jsx(ov,{habits:v,completedHabits:t,weekDays:i,onLogHabit:n,onRemoveLog:s,disabled:r})})}),"      ",e.jsxs(Zi,{variant:"destructive",children:[" ",e.jsx(Qi,{children:m?`Visualización completa de hábitos agrupados por categoría${g.isFiltered?` (${g.filteredHabits} de ${g.totalHabits} hábitos mostrados)`:""}. Usa el buscador para encontrar hábitos específicos.`:`Mostrando solo tus ${v.length} hábitos más frecuentes. Haz clic en "Mostrar todos" para ver la lista completa.`})]})]})},lv=({habits:t,completedHabits:n,onLogHabit:s,onRemoveLog:r})=>{const i=new Date().getFullYear();return e.jsx(zn,{children:e.jsx("div",{className:"space-y-6",children:t.map(o=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 sticky top-0 bg-white z-10 py-2",children:[e.jsx("span",{className:"text-xl",children:o.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:o.name}),e.jsx("p",{className:"text-sm text-gray-500",children:o.category})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx(kb,{year:i,renderCell:c=>{const d=`${o.id}_${c}`,u=n[d],m=new Date().toISOString().split("T")[0]===c;return e.jsxs(ls,{children:[e.jsx(cs,{asChild:!0,children:e.jsx(F,{variant:u?"destructive":"ghost",onClick:()=>u?r(o.id,c):s(o.id,c),className:ce("w-1 h-1 p-0 rounded-full border transition-all duration-200 hover:scale-110",u?"bg-red-600 border-red-700 hover:bg-red-700":"bg-gray-100 border-gray-200 hover:bg-gray-200 hover:border-gray-300",m&&"ring-2 ring-blue-400 ring-offset-1"),"aria-label":u?"Eliminar registro":"Registrar hábito"})}),e.jsx(rs,{children:e.jsx("p",{className:"text-sm",children:new Date(c).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})})]},c)}})})]},o.id))})})},x3=({habits:t,onLogHabit:n,onRemoveLog:s})=>{const[r,i]=f.useState(""),[o,c]=f.useState("all"),[d,u]=f.useState(["health"]),[m,p]=f.useState(!1),x=f.useMemo(()=>{const j=new Map;return Object.entries(t).forEach(([b])=>{const[y]=b.split("_"),N=j.get(Number(y))||0;j.set(Number(y),N+1)}),Pa.filter(b=>j.has(b.id)).sort((b,y)=>(j.get(y.id)||0)-(j.get(b.id)||0)).slice(0,5)},[t]),g=f.useMemo(()=>{const j={};return Pa.forEach(b=>{r&&!b.name.toLowerCase().includes(r.toLowerCase())||o!=="all"&&b.category!==o||(j[b.category]||(j[b.category]=[]),j[b.category].push(b))}),j},[r,o]),v=j=>{u(b=>b.includes(j)?b.filter(y=>y!==j):[...b,j])};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(fd,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(Ve,{placeholder:"Buscar hábito...",value:r,onChange:j=>i(j.target.value),className:"pl-8"})]}),e.jsxs(ft,{value:o,onValueChange:c,children:[e.jsx(ct,{className:"w-full sm:w-[180px]",children:e.jsx(pt,{placeholder:"Categoría"})}),e.jsxs(dt,{children:[e.jsx(De,{value:"all",children:"Todas las categorías"}),Object.keys(Ii).map(j=>e.jsx(De,{value:j,children:Ii[j].label},j))]})]}),e.jsx(F,{variant:"outline",onClick:()=>p(!m),className:"whitespace-nowrap",children:m?"Ver frecuentes":"Ver todos"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"sm:min-w-[800px] pb-4",children:m?e.jsx("div",{className:"space-y-8",children:Object.entries(g).map(([j,b])=>{if(b.length===0)return null;const y=d.includes(j),N=Ii[j];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(F,{variant:"ghost",onClick:()=>v(j),className:"w-full flex items-center justify-between p-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:N.icon}),e.jsx("span",{className:"font-medium",children:N.label}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",b.length,")"]})]}),y?e.jsx(Dr,{size:20}):e.jsx(ia,{size:20})]}),y&&e.jsx(lv,{habits:b,completedHabits:t,onLogHabit:n,onRemoveLog:s})]},j)})}):e.jsx(lv,{habits:x,completedHabits:t,onLogHabit:n,onRemoveLog:s})})}),e.jsxs(Zi,{variant:"destructive",children:[" ",e.jsx(Qi,{children:m?"Vista completa de hábitos por categoría. Usa los filtros para encontrar hábitos específicos.":'Mostrando tus hábitos más frecuentes. Cambia a "Ver todos" para la lista completa.'})]})]})},g3=({category:t,habits:n,onSelectHabit:s})=>{const r=Ii[t];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:r.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:r.label}),e.jsx("p",{className:"text-sm text-gray-500",children:r.description})]})]}),e.jsx(Uf,{className:"h-[300px] pr-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3",children:n.map(i=>e.jsxs(F,{variant:"outline",className:"h-auto py-3 px-2 flex flex-col items-center gap-2 group",onClick:()=>s(i.id),children:[e.jsx("span",{className:"text-2xl group-hover:scale-110 transition-transform",children:i.icon}),e.jsx("span",{className:"text-xs text-center line-clamp-2",children:i.name})]},i.id))})})]})},v3=({onSelectHabit:t})=>{const[n,s]=f.useState("health"),r=Pa.reduce((i,o)=>(i[o.category]||(i[o.category]=[]),i[o.category].push(o),i),{});return e.jsx("div",{className:"w-full",children:e.jsxs(mr,{defaultValue:n,onValueChange:i=>s(i),className:"w-full",children:[e.jsx(fr,{className:"grid grid-cols-4 gap-2 h-auto sm:grid-cols-7",children:Object.entries(Ii).map(([i,{icon:o,label:c}])=>e.jsxs(qt,{value:i,className:"text-sm flex flex-col gap-1 py-2 h-auto",children:[e.jsx("span",{className:"text-xl",children:o}),e.jsx("span",{className:"hidden sm:inline text-xs",children:c})]},i))}),Object.entries(r).map(([i,o])=>e.jsx(At,{value:i,className:"mt-4",children:e.jsx(g3,{category:i,habits:o,onSelectHabit:t})},i))]})})},y3=({isOpen:t,onClose:n,onLogHabit:s,selectedDate:r})=>e.jsx(yt,{open:t,onOpenChange:n,children:e.jsxs(xt,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col",children:[e.jsxs(bt,{children:[e.jsx(jt,{children:"Registrar Hábito Negativo"}),e.jsx("p",{className:"text-sm text-gray-500",children:Ef(r)})]}),e.jsx("div",{className:"flex-1 overflow-hidden py-4",children:e.jsx(v3,{onSelectHabit:s})})]})}),er=dr("negativeHabit"),b3=er?`https://generativelanguage.googleapis.com/v1beta/models/${er.model}:generateContent`:"",j3=({habits:t,open:n,onOpenChange:s})=>{var M,R;const[r,i]=f.useState(!1),o=n!==void 0?n:r,c=s??i,[d,u]=f.useState(""),[m,p]=f.useState(""),[x,g]=f.useState(!1),[v,j]=f.useState(0),b="AIzaSyAW4Ot-z7OH4ZR3OeaN7vcbkEDlWpo1aMY",y=((M=er==null?void 0:er.prompts)==null?void 0:M.impact)??"Explica el impacto de mis hábitos negativos de acuerdo con mis registros.",N=((R=er==null?void 0:er.prompts)==null?void 0:R.action)??"Recomienda acciones para reducirlos cada vez que los registro.",S=er==null?void 0:er.params;f.useEffect(()=>{if(o){const I=E();p(`${y}
${N}
${I}`)}else p(""),u("")},[o,t]),f.useEffect(()=>{j(ur(m))},[m]);const E=()=>{const I={};let O=null,H=null;Object.keys(t).forEach(P=>{const[K,X]=P.split("_"),G=parseInt(K,10);I[G]=(I[G]||0)+1,(!O||X<O)&&(O=X),(!H||X>H)&&(H=X)});const $=O&&H?`Datos del ${O} al ${H}`:"Sin registros",D=Pa.map(P=>`- ${P.name}: ${I[P.id]||0}`).join(`
`);return`${$}
${D}`},T=async()=>{var I,O,H,$,D;g(!0);try{const K=await(await fetch(`${b3}?key=${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:m}]}],...S})})).json(),X=(D=($=(H=(O=(I=K==null?void 0:K.candidates)==null?void 0:I[0])==null?void 0:O.content)==null?void 0:H.parts)==null?void 0:$[0])==null?void 0:D.text;u(X||"No se pudo obtener sugerencia")}catch{u("Error al consultar la API")}finally{g(!1)}},k=()=>{c(!1),u(""),p(""),j(0)};return e.jsxs(yt,{open:o,onOpenChange:I=>I?c(!0):k(),children:[n===void 0&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>c(!0),className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"}),"Analizar hábitos"]}),e.jsxs(xt,{className:"w-[95vw] h-[90vh] max-w-none max-h-none overflow-hidden flex flex-col sm:w-[90vw] sm:h-[85vh]",children:[e.jsxs(bt,{className:"flex-shrink-0",children:[e.jsx(jt,{className:"text-xl",children:"Análisis de Hábitos Negativos con IA"}),e.jsx(mn,{children:"La IA analizará el impacto de tus hábitos negativos y te recomendará acciones específicas para reducirlos. Usa el panel izquierdo para editar el prompt y visualiza el resultado en el panel derecho."})]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-4 min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2 flex-shrink-0",children:"Prompt para IA"}),e.jsx(vt,{value:m,onChange:I=>p(I.target.value),className:"flex-1 resize-none min-h-0",placeholder:"Datos de hábitos negativos para analizar..."})]}),e.jsxs("div",{className:"flex flex-col gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Tokens: ",v]}),v>3500&&e.jsx("span",{className:"text-red-500 font-medium",children:"¡Prompt demasiado largo!"})]}),e.jsxs(F,{onClick:T,disabled:x||!b||v>3500,className:"w-full flex items-center justify-center gap-2",size:"lg",children:[x&&e.jsx(Qt,{className:"w-4 h-4 animate-spin"}),e.jsx(as,{className:"w-4 h-4"}),x?"Consultando IA...":"Obtener análisis"]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 sm:border-l sm:border-gray-200 sm:pl-4 border-t sm:border-t-0 border-gray-200 pt-4 sm:pt-0",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Impacto y recomendaciones"}),d&&e.jsxs(F,{type:"button",size:"sm",variant:"outline",onClick:()=>{navigator.clipboard.writeText(d),kt.success("Análisis copiado al portapapeles")},className:"flex items-center gap-1",children:[e.jsx(Ar,{className:"w-4 h-4"}),"Copiar"]})]}),e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:e.jsx("div",{className:"flex-1 bg-gray-50 border border-gray-200 rounded-md p-4 overflow-auto",children:d?e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:$a.sanitize(d.replace(/\n/g,"<br>"))}}):x?e.jsx("div",{className:"text-sm text-gray-500",children:"Analizando impacto de hábitos negativos..."}):e.jsx("div",{className:"text-sm text-gray-500",children:"El análisis del impacto de tus hábitos negativos aparecerá aquí. La IA te dará recomendaciones específicas para reducir cada hábito."})})})]})]}),e.jsx("div",{className:"flex-shrink-0 mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-xs text-gray-500",children:[e.jsx("span",{children:"💡 Tip: Sé honesto con tus registros para obtener mejores recomendaciones"}),!b]})})]})]})},w3=({habits:t})=>{const[n,s]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Er,{children:[e.jsx(Tr,{asChild:!0,children:e.jsxs(F,{size:"sm",variant:"outline",className:"flex items-center gap-2 text-blue-600",children:[e.jsx(as,{className:"w-4 h-4"}),"IA"]})}),e.jsx(or,{align:"end",children:e.jsx(ut,{onSelect:()=>s(!0),children:"Analizar hábitos"})})]}),e.jsx(j3,{habits:t,open:n,onOpenChange:s})]})},N3=()=>{const[t,n]=f.useState("weekly"),[s,r]=f.useState(new Date),[i,o]=f.useState(!1),{user:c}=He(),{habits:d,status:u,error:m,logHabit:p,removeLog:x,resync:g}=f3(),{isOnline:v}=cr(),j=async(b,y)=>{await p(b,Oe(s),y),o(!1)};return c?e.jsxs(Ss,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Hábitos Negativos"}),e.jsx("p",{className:"text-gray-500",children:"Identifica y reduce comportamientos que quieres cambiar"})]}),e.jsx(kr,{selectedDate:s,onChange:r}),e.jsxs(je,{className:"w-full",children:[e.jsxs(we,{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Registro de Hábitos"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Identifica y registra los hábitos que deseas cambiar"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w3,{habits:d}),e.jsx(p3,{view:t,onViewChange:n})]})]}),t==="weekly"?e.jsx(h3,{habits:d,onLogHabit:p,onRemoveLog:x,disabled:u==="saving"||!v}):e.jsx(x3,{habits:d,onLogHabit:p,onRemoveLog:x}),m&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:m})]}),e.jsxs(Xs,{className:"justify-center gap-2 text-xs p-2",children:[u==="saving"&&e.jsx("span",{className:"text-blue-500",children:"Guardando..."}),u==="pending"&&e.jsx("span",{className:"text-yellow-600",children:"Pendiente de sincronizar"}),u==="saved"&&e.jsx("span",{className:"text-green-600",children:"Sincronizado"}),u==="error"&&e.jsx("span",{className:"text-red-600",children:"Error de sincronización"}),!v&&e.jsx("span",{className:"text-orange-600",children:"Offline"}),e.jsx(F,{onClick:g,variant:"link",className:"p-0 h-auto",children:"Reintentar"})]})]}),e.jsx(y3,{isOpen:i,onClose:()=>o(!1),onLogHabit:j,selectedDate:s})]}):e.jsx(Ss,{children:e.jsx(je,{className:"w-full",children:e.jsx(we,{className:"p-4 text-center",children:e.jsx("p",{children:"Inicia sesión para registrar tus hábitos negativos"})})})})},S3=(t,n)=>{const s=Ma.length,r=t!=null&&t.habits?Object.entries(t.habits).filter(([d,u])=>d.endsWith(`_${n}`)&&u).map(([d])=>{const u=parseInt(d.split("_")[0]);return Ma.find(m=>m.id===u)}).filter(Boolean):[],i=r.length,o=Ma.filter(d=>!r.some(u=>(u==null?void 0:u.id)===d.id)),c=["morning","afternoon","night","anytime"].map(d=>{const u=o.filter(m=>m.timeOfDay===d);return{timeOfDay:d,habits:u.map(m=>({id:m.id,name:m.name,icon:m.icon,goal:m.goal}))}}).filter(d=>d.habits.length>0);return{completed:i,total:s,incompletedByTimeOfDay:c}},C3=t=>{if(!(t!=null&&t.drinks)||!Array.isArray(t.drinks))return[];const n=new Map;return t.drinks.forEach(s=>{const r=s.type,i=s.amount||0;if(n.has(r)){const o=n.get(r);n.set(r,{amount:o.amount+i,count:o.count+1})}else n.set(r,{amount:i,count:1})}),Array.from(n.entries()).map(([s,r])=>({type:s,amount:r.amount,count:r.count})).sort((s,r)=>r.amount-s.amount)},E3=t=>{if(!(t!=null&&t.moods)||!Array.isArray(t.moods))return{count:0,average:0,highest:0,lowest:0,details:[]};const n=t.moods,s=n.length;if(s===0)return{count:0,average:0,highest:0,lowest:0,details:[]};const r=n4(n),i=n.map(u=>u.value??Qc(u.text)),o=Math.max(...i),c=Math.min(...i),d=n.map(u=>({emoji:u.emoji,text:u.text,value:u.value??Qc(u.text),time:u.time}));return{count:s,average:r,highest:o,lowest:c,details:d}},cv={journal:{words:0},mood:{count:0,average:0,highest:0,lowest:0,details:[]},habits:{completed:0,total:Ma.length,incompletedByTimeOfDay:[]},negativeHabits:{count:0},exercise:{minutes:0},tasks:{completed:0,todayPlanned:0,pending:0,overdue:0},pomodoro:{count:0,expectedMinutes:0,workMinutes:0,completionRate:0,averageSessionLength:0},water:{intake:0,drinkDetails:[]}},Fj=(t,n,s)=>{const r=Oe(n),[i,o]=r.split("-"),c=Bo.fromDate(ys(n)),d=Bo.fromDate(wr(n)),u=be(fe,"journal",`${t}_${r}`),m=be(fe,"moods",`${t}_${r}`),p=be(fe,"water",`${t}_${r}`),x=be(fe,"exercises",`${t}_${r}`),g=be(fe,"pomodoro",`${t}_${r}`),v=be(fe,"habits",`${t}_${i}-${o}`),j=be(fe,"negative-habits",`${t}_${i}-${o}`);let b=null,y=null,N=null,S=null,E=null,T=null,k=null,M=[],R=[],I=[];const O=()=>{const D=T3(n,r,b,y,N,S,E,T,k,M,R,I);s(D)},H=[];H.push(ns(u,D=>{b=D.exists()?D.data():null,O()},D=>console.error("❌ Journal listener error:",D))),H.push(ns(m,D=>{y=D.exists()?D.data():null,O()},D=>console.error("❌ Mood listener error:",D))),H.push(ns(p,D=>{N=D.exists()?D.data():null,O()},D=>console.error("❌ Water listener error:",D))),H.push(ns(x,D=>{S=D.exists()?D.data():null,O()},D=>console.error("❌ Exercise listener error:",D))),H.push(ns(g,D=>{E=D.exists()?D.data():null,O()},D=>console.error("❌ Pomodoro listener error:",D))),H.push(ns(v,D=>{T=D.exists()?D.data():null,O()},D=>console.error("❌ Habit listener error:",D))),H.push(ns(j,D=>{k=D.exists()?D.data():null,O()},D=>console.error("❌ Negative habit listener error:",D)));const $=_r($t(fe,"tasks"),un("userId","==",t));return H.push(ns($,D=>{const P=D.docs.map(K=>({id:K.id,...K.data()}));M=P.filter(K=>{if(!K.completed||!K.updatedAt)return!1;const X=K.updatedAt.toDate();return X>=c.toDate()&&X<=d.toDate()}),R=P.filter(K=>{if(!K.dueDate)return!1;const X=K.dueDate.toDate();return X>=c.toDate()&&X<=d.toDate()}),I=P.filter(K=>!K.completed),O()},D=>console.error("❌ Task listener error (all tasks):",D))),H},T3=(t,n,s,r,i,o,c,d,u,m,p,x)=>{var b,y;const g=ys(t);let v=0,j=0;return x.forEach(N=>{N.dueDate&&typeof N.dueDate.toDate=="function"&&ys(N.dueDate.toDate())<g?j++:v++}),{journal:{words:s!=null&&s.text?s.text.split(/\s+/).filter(Boolean).length:0},mood:E3(r),water:{intake:(i==null?void 0:i.totalWater)||0,drinkDetails:C3(i)},exercise:{minutes:((b=o==null?void 0:o.summary)==null?void 0:b.totalDuration)||0},pomodoro:(()=>{var I;const N=c;console.log("🍅 Pomodoro data for",n,":",N);const S=(N==null?void 0:N.count)||0;let E=0;N!=null&&N.sessions&&Array.isArray(N.sessions)&&(E=N.sessions.reduce((O,H)=>{const $=H.duration?Math.round(H.duration/60):0;return console.log("🍅 Session duration:",H.duration,"seconds =",$,"minutes"),O+$},0)),console.log("🍅 Pomodoro extracted - count:",S,"workMinutes:",E),console.log("🍅 Sessions found:",((I=N==null?void 0:N.sessions)==null?void 0:I.length)||0),console.log("🍅 Available keys in data:",N?Object.keys(N):"no data");const T=300,k=Math.min(100,E/T*100),M=S>0?E/S:0,R={count:S,expectedMinutes:T,workMinutes:E,completionRate:parseFloat(k.toFixed(1)),averageSessionLength:parseFloat(M.toFixed(1))};return console.log("🍅 Final pomodoro result:",R),R})(),habits:S3(d,n),negativeHabits:{count:(y=u==null?void 0:u.habits)!=null&&y[n]?Object.keys(u.habits[n]).length:0},tasks:{completed:m.length,todayPlanned:p.length,pending:v,overdue:j}}},_i=new Map,k$=t=>{const{user:n}=He(),[s,r]=f.useState(cv),[i,o]=f.useState(!0);return f.useEffect(()=>{if(!n){console.log("❌ useDailySummary - No user authenticated"),o(!1);return}const d=`${n.uid}_${Oe(t)}`,u=(m,p)=>{r(m),o(p)};if(_i.has(d)){const m=_i.get(d);m.subscribers.add(u),r(m.summary),o(m.loading)}else{o(!0);const m=x=>{const g=_i.get(d);g&&(g.summary=x,g.loading=!1,g.subscribers.forEach(v=>v(x,!1)))},p=Fj(n.uid,t,m);_i.set(d,{summary:cv,loading:!0,subscribers:new Set([u]),unsubscribes:p})}return()=>{const m=_i.get(d);m&&(m.subscribers.delete(u),m.subscribers.size===0&&(m.unsubscribes.forEach(p=>p()),_i.delete(d)))}},[n,t]),{summary:s,loading:i,refetch:()=>{console.log("🔄 Refetch requested - listeners will automatically update")}}},bm={journal:{words:0},mood:{count:0,average:0,highest:0,lowest:0},habits:{completed:0,total:18,incompletedByTimeOfDay:[]},negativeHabits:{count:0},exercise:{minutes:0},tasks:{completed:0,todayPlanned:0,pending:0,overdue:0},pomodoro:{count:0,expectedMinutes:0,workMinutes:0,completionRate:0,averageSessionLength:0},water:{intake:0,drinkDetails:[]}},k3=t=>{const{user:n}=He(),[s,r]=f.useState({daily:[],totals:{...bm}}),[i,o]=f.useState(!0);return f.useEffect(()=>{if(!n){o(!1);return}o(!0);const d=[];for(let x=0;x<7;x++){const g=new Date(t);g.setDate(t.getDate()+x),d.push(g)}const u={},m=()=>{const x=[],g={...bm};d.forEach(j=>{const b=Oe(j),y=u[b]||{...bm};x.push({date:b,summary:y}),g.journal.words+=y.journal.words,g.mood.count+=y.mood.count,g.habits.completed+=y.habits.completed,g.negativeHabits.count+=y.negativeHabits.count,g.exercise.minutes+=y.exercise.minutes,g.water.intake+=y.water.intake,g.tasks.completed+=y.tasks.completed,g.tasks.todayPlanned+=y.tasks.todayPlanned,g.tasks.pending+=y.tasks.pending,g.tasks.overdue+=y.tasks.overdue,g.pomodoro.count+=y.pomodoro.count,g.pomodoro.workMinutes+=y.pomodoro.workMinutes});const v=300*7;g.pomodoro.expectedMinutes=v,g.pomodoro.completionRate=Math.min(100,g.pomodoro.workMinutes/v*100),g.pomodoro.averageSessionLength=g.pomodoro.count>0?g.pomodoro.workMinutes/g.pomodoro.count:0,g.pomodoro.completionRate=parseFloat(g.pomodoro.completionRate.toFixed(1)),g.pomodoro.averageSessionLength=parseFloat(g.pomodoro.averageSessionLength.toFixed(1)),r({daily:x,totals:g}),o(!1)},p=[];return d.forEach(x=>{const g=Oe(x),v=b=>{u[g]=b,m()},j=Fj(n.uid,x,v);p.push(...j)}),()=>{p.forEach(x=>x())}},[n,t]),{summary:s,loading:i,refetch:()=>{}}},_3=f.lazy(()=>Yi(()=>import("../chunks/DailySummary-bhlymI5q.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(t=>({default:t.DailySummary}))),D3=f.lazy(()=>Yi(()=>import("../chunks/WeeklySummary-CWvrPaoL.js"),__vite__mapDeps([8,1,2,3,7,5,6])).then(t=>({default:t.WeeklySummary}))),dv=f.lazy(()=>Yi(()=>import("../chunks/AiInsightCard-CrXGL7tN.js"),__vite__mapDeps([9,1,2,3,5,6])).then(t=>({default:t.AiInsightCard}))),A3=f.lazy(()=>Yi(()=>import("../chunks/DailyDashboard-D7a56Wt7.js"),__vite__mapDeps([10,1,2,3,4,5,6])).then(t=>({default:t.DailyDashboard}))),R3=f.lazy(()=>Yi(()=>import("../chunks/WeeklyDashboard-COkvA9id.js"),__vite__mapDeps([11,1,2,3,4,5,6])).then(t=>({default:t.WeeklyDashboard}))),uv=t=>Pt(t,"PP",{locale:Ln}),P3=()=>{const[t,n]=f.useState(new Date),[s,r]=f.useState(()=>{const o=new Date;return o.setDate(o.getDate()-o.getDay()),o}),{summary:i}=k3(s);return e.jsxs(Ss,{children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Estadísticas"})}),e.jsxs(mr,{defaultValue:"daily",className:"space-y-4",children:[e.jsxs(fr,{children:[e.jsx(qt,{value:"daily",children:"Diario"}),e.jsx(qt,{value:"weekly",children:"Semanal"})]}),e.jsxs(At,{value:"daily",className:"space-y-4",children:[e.jsx(kr,{selectedDate:t,onChange:n}),e.jsx(f.Suspense,{fallback:e.jsx("div",{className:"h-24"}),children:e.jsx(A3,{date:t})}),e.jsx(f.Suspense,{fallback:e.jsx("div",{className:"h-24"}),children:e.jsx(_3,{date:t})}),e.jsx(f.Suspense,{fallback:e.jsx("div",{className:"h-24"}),children:e.jsx(dv,{date:uv(t),dayDate:t})})]}),e.jsxs(At,{value:"weekly",className:"space-y-4",children:[e.jsx(kr,{selectedDate:s,onChange:r}),e.jsx(f.Suspense,{fallback:e.jsx("div",{className:"h-24"}),children:e.jsx(R3,{startDate:s})}),e.jsx(f.Suspense,{fallback:e.jsx("div",{className:"h-24"}),children:e.jsx(D3,{startDate:s})}),e.jsx(f.Suspense,{fallback:e.jsx("div",{className:"h-24"}),children:e.jsx(dv,{data:i,date:`Semana del ${uv(s)}`})})]})]})]})};var Al=t=>t.type==="checkbox",Ai=t=>t instanceof Date,Ys=t=>t==null;const Bj=t=>typeof t=="object";var ms=t=>!Ys(t)&&!Array.isArray(t)&&Bj(t)&&!Ai(t),I3=t=>ms(t)&&t.target?Al(t.target)?t.target.checked:t.target.value:t,O3=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,M3=(t,n)=>t.has(O3(n)),L3=t=>{const n=t.constructor&&t.constructor.prototype;return ms(n)&&n.hasOwnProperty("isPrototypeOf")},pp=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function On(t){let n;const s=Array.isArray(t);if(t instanceof Date)n=new Date(t);else if(t instanceof Set)n=new Set(t);else if(!(pp&&(t instanceof Blob||t instanceof FileList))&&(s||ms(t)))if(n=s?[]:{},!s&&!L3(t))n=t;else for(const r in t)t.hasOwnProperty(r)&&(n[r]=On(t[r]));else return t;return n}var Fd=t=>Array.isArray(t)?t.filter(Boolean):[],ss=t=>t===void 0,Te=(t,n,s)=>{if(!n||!ms(t))return s;const r=Fd(n.split(/[,[\].]+?/)).reduce((i,o)=>Ys(i)?i:i[o],t);return ss(r)||r===t?ss(t[n])?s:t[n]:r},yr=t=>typeof t=="boolean",hp=t=>/^\w*$/.test(t),Wj=t=>Fd(t.replace(/["|']|\]/g,"").split(/\.|\[/)),Wt=(t,n,s)=>{let r=-1;const i=hp(n)?[n]:Wj(n),o=i.length,c=o-1;for(;++r<o;){const d=i[r];let u=s;if(r!==c){const m=t[d];u=ms(m)||Array.isArray(m)?m:isNaN(+i[r+1])?{}:[]}if(d==="__proto__")return;t[d]=u,t=t[d]}return t};const mv={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},sr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Kr={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"};ne.createContext(null);var $3=(t,n,s,r=!0)=>{const i={defaultValues:n._defaultValues};for(const o in t)Object.defineProperty(i,o,{get:()=>{const c=o;return n._proxyFormState[c]!==sr.all&&(n._proxyFormState[c]=!r||sr.all),t[c]}});return i},ln=t=>ms(t)&&!Object.keys(t).length,z3=(t,n,s,r)=>{s(t);const{name:i,...o}=t;return ln(o)||Object.keys(o).length>=Object.keys(n).length||Object.keys(o).find(c=>n[c]===sr.all)},Fc=t=>Array.isArray(t)?t:[t];function F3(t){const n=ne.useRef(t);n.current=t,ne.useEffect(()=>{const s=!t.disabled&&n.current.subject&&n.current.subject.subscribe({next:n.current.next});return()=>{s&&s.unsubscribe()}},[t.disabled])}var Nr=t=>typeof t=="string",B3=(t,n,s,r,i)=>Nr(t)?(r&&n.watch.add(t),Te(s,t,i)):Array.isArray(t)?t.map(o=>(r&&n.watch.add(o),Te(s,o))):(r&&(n.watchAll=!0),s),W3=(t,n,s,r,i)=>n?{...s[t],types:{...s[t]&&s[t].types?s[t].types:{},[r]:i||!0}}:{},fv=t=>({isOnSubmit:!t||t===sr.onSubmit,isOnBlur:t===sr.onBlur,isOnChange:t===sr.onChange,isOnAll:t===sr.all,isOnTouch:t===sr.onTouched}),pv=(t,n,s)=>!s&&(n.watchAll||n.watch.has(t)||[...n.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const qo=(t,n,s,r)=>{for(const i of s||Object.keys(t)){const o=Te(t,i);if(o){const{_f:c,...d}=o;if(c){if(c.refs&&c.refs[0]&&n(c.refs[0],i)&&!r)return!0;if(c.ref&&n(c.ref,c.name)&&!r)return!0;if(qo(d,n))break}else if(ms(d)&&qo(d,n))break}}};var H3=(t,n,s)=>{const r=Fc(Te(t,s));return Wt(r,"root",n[s]),Wt(t,s,r),t},xp=t=>t.type==="file",na=t=>typeof t=="function",sd=t=>{if(!pp)return!1;const n=t?t.ownerDocument:0;return t instanceof(n&&n.defaultView?n.defaultView.HTMLElement:HTMLElement)},Bc=t=>Nr(t),gp=t=>t.type==="radio",nd=t=>t instanceof RegExp;const hv={value:!1,isValid:!1},xv={value:!0,isValid:!0};var Hj=t=>{if(Array.isArray(t)){if(t.length>1){const n=t.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:n,isValid:!!n.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!ss(t[0].attributes.value)?ss(t[0].value)||t[0].value===""?xv:{value:t[0].value,isValid:!0}:xv:hv}return hv};const gv={isValid:!1,value:null};var Uj=t=>Array.isArray(t)?t.reduce((n,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:n,gv):gv;function vv(t,n,s="validate"){if(Bc(t)||Array.isArray(t)&&t.every(Bc)||yr(t)&&!t)return{type:s,message:Bc(t)?t:"",ref:n}}var Di=t=>ms(t)&&!nd(t)?t:{value:t,message:""},yv=async(t,n,s,r,i)=>{const{ref:o,refs:c,required:d,maxLength:u,minLength:m,min:p,max:x,pattern:g,validate:v,name:j,valueAsNumber:b,mount:y,disabled:N}=t._f,S=Te(n,j);if(!y||N)return{};const E=c?c[0]:o,T=D=>{r&&E.reportValidity&&(E.setCustomValidity(yr(D)?"":D||""),E.reportValidity())},k={},M=gp(o),R=Al(o),I=M||R,O=(b||xp(o))&&ss(o.value)&&ss(S)||sd(o)&&o.value===""||S===""||Array.isArray(S)&&!S.length,H=W3.bind(null,j,s,k),$=(D,P,K,X=Kr.maxLength,G=Kr.minLength)=>{const U=D?P:K;k[j]={type:D?X:G,message:U,ref:o,...H(D?X:G,U)}};if(i?!Array.isArray(S)||!S.length:d&&(!I&&(O||Ys(S))||yr(S)&&!S||R&&!Hj(c).isValid||M&&!Uj(c).isValid)){const{value:D,message:P}=Bc(d)?{value:!!d,message:d}:Di(d);if(D&&(k[j]={type:Kr.required,message:P,ref:E,...H(Kr.required,P)},!s))return T(P),k}if(!O&&(!Ys(p)||!Ys(x))){let D,P;const K=Di(x),X=Di(p);if(!Ys(S)&&!isNaN(S)){const G=o.valueAsNumber||S&&+S;Ys(K.value)||(D=G>K.value),Ys(X.value)||(P=G<X.value)}else{const G=o.valueAsDate||new Date(S),U=ye=>new Date(new Date().toDateString()+" "+ye),Y=o.type=="time",ae=o.type=="week";Nr(K.value)&&S&&(D=Y?U(S)>U(K.value):ae?S>K.value:G>new Date(K.value)),Nr(X.value)&&S&&(P=Y?U(S)<U(X.value):ae?S<X.value:G<new Date(X.value))}if((D||P)&&($(!!D,K.message,X.message,Kr.max,Kr.min),!s))return T(k[j].message),k}if((u||m)&&!O&&(Nr(S)||i&&Array.isArray(S))){const D=Di(u),P=Di(m),K=!Ys(D.value)&&S.length>+D.value,X=!Ys(P.value)&&S.length<+P.value;if((K||X)&&($(K,D.message,P.message),!s))return T(k[j].message),k}if(g&&!O&&Nr(S)){const{value:D,message:P}=Di(g);if(nd(D)&&!S.match(D)&&(k[j]={type:Kr.pattern,message:P,ref:o,...H(Kr.pattern,P)},!s))return T(P),k}if(v){if(na(v)){const D=await v(S,n),P=vv(D,E);if(P&&(k[j]={...P,...H(Kr.validate,P.message)},!s))return T(P.message),k}else if(ms(v)){let D={};for(const P in v){if(!ln(D)&&!s)break;const K=vv(await v[P](S,n),E,P);K&&(D={...K,...H(P,K.message)},T(K.message),s&&(k[j]=D))}if(!ln(D)&&(k[j]={ref:E,...D},!s))return k}}return T(!0),k};function U3(t,n){const s=n.slice(0,-1).length;let r=0;for(;r<s;)t=ss(t)?r++:t[n[r++]];return t}function V3(t){for(const n in t)if(t.hasOwnProperty(n)&&!ss(t[n]))return!1;return!0}function vs(t,n){const s=Array.isArray(n)?n:hp(n)?[n]:Wj(n),r=s.length===1?t:U3(t,s),i=s.length-1,o=s[i];return r&&delete r[o],i!==0&&(ms(r)&&ln(r)||Array.isArray(r)&&V3(r))&&vs(t,s.slice(0,-1)),t}var jm=()=>{let t=[];return{get observers(){return t},next:i=>{for(const o of t)o.next&&o.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(o=>o!==i)}}),unsubscribe:()=>{t=[]}}},rd=t=>Ys(t)||!Bj(t);function Da(t,n){if(rd(t)||rd(n))return t===n;if(Ai(t)&&Ai(n))return t.getTime()===n.getTime();const s=Object.keys(t),r=Object.keys(n);if(s.length!==r.length)return!1;for(const i of s){const o=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const c=n[i];if(Ai(o)&&Ai(c)||ms(o)&&ms(c)||Array.isArray(o)&&Array.isArray(c)?!Da(o,c):o!==c)return!1}}return!0}var Vj=t=>t.type==="select-multiple",G3=t=>gp(t)||Al(t),wm=t=>sd(t)&&t.isConnected,Gj=t=>{for(const n in t)if(na(t[n]))return!0;return!1};function ad(t,n={}){const s=Array.isArray(t);if(ms(t)||s)for(const r in t)Array.isArray(t[r])||ms(t[r])&&!Gj(t[r])?(n[r]=Array.isArray(t[r])?[]:{},ad(t[r],n[r])):Ys(t[r])||(n[r]=!0);return n}function qj(t,n,s){const r=Array.isArray(t);if(ms(t)||r)for(const i in t)Array.isArray(t[i])||ms(t[i])&&!Gj(t[i])?ss(n)||rd(s[i])?s[i]=Array.isArray(t[i])?ad(t[i],[]):{...ad(t[i])}:qj(t[i],Ys(n)?{}:n[i],s[i]):s[i]=!Da(t[i],n[i]);return s}var Ic=(t,n)=>qj(t,n,ad(n)),Yj=(t,{valueAsNumber:n,valueAsDate:s,setValueAs:r})=>ss(t)?t:n?t===""?NaN:t&&+t:s&&Nr(t)?new Date(t):r?r(t):t;function Nm(t){const n=t.ref;if(!(t.refs?t.refs.every(s=>s.disabled):n.disabled))return xp(n)?n.files:gp(n)?Uj(t.refs).value:Vj(n)?[...n.selectedOptions].map(({value:s})=>s):Al(n)?Hj(t.refs).value:Yj(ss(n.value)?t.ref.value:n.value,t)}var q3=(t,n,s,r)=>{const i={};for(const o of t){const c=Te(n,o);c&&Wt(i,o,c._f)}return{criteriaMode:s,names:[...t],fields:i,shouldUseNativeValidation:r}},Mo=t=>ss(t)?t:nd(t)?t.source:ms(t)?nd(t.value)?t.value.source:t.value:t;const bv="AsyncFunction";var Y3=t=>(!t||!t.validate)&&!!(na(t.validate)&&t.validate.constructor.name===bv||ms(t.validate)&&Object.values(t.validate).find(n=>n.constructor.name===bv)),K3=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate);function jv(t,n,s){const r=Te(t,s);if(r||hp(s))return{error:r,name:s};const i=s.split(".");for(;i.length;){const o=i.join("."),c=Te(n,o),d=Te(t,o);if(c&&!Array.isArray(c)&&s!==o)return{name:s};if(d&&d.type)return{name:o,error:d};i.pop()}return{name:s}}var J3=(t,n,s,r,i)=>i.isOnAll?!1:!s&&i.isOnTouch?!(n||t):(s?r.isOnBlur:i.isOnBlur)?!t:(s?r.isOnChange:i.isOnChange)?t:!0,X3=(t,n)=>!Fd(Te(t,n)).length&&vs(t,n);const Z3={mode:sr.onSubmit,reValidateMode:sr.onChange,shouldFocusError:!0};function Q3(t={}){let n={...Z3,...t},s={submitCount:0,isDirty:!1,isLoading:na(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1},r={},i=ms(n.defaultValues)||ms(n.values)?On(n.defaultValues||n.values)||{}:{},o=n.shouldUnregister?{}:On(i),c={action:!1,mount:!1,watch:!1},d={mount:new Set,unMount:new Set,array:new Set,watch:new Set},u,m=0;const p={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},x={values:jm(),array:jm(),state:jm()},g=fv(n.mode),v=fv(n.reValidateMode),j=n.criteriaMode===sr.all,b=z=>Z=>{clearTimeout(m),m=setTimeout(z,Z)},y=async z=>{if(p.isValid||z){const Z=n.resolver?ln((await I()).errors):await H(r,!0);Z!==s.isValid&&x.state.next({isValid:Z})}},N=(z,Z)=>{(p.isValidating||p.validatingFields)&&((z||Array.from(d.mount)).forEach(ee=>{ee&&(Z?Wt(s.validatingFields,ee,Z):vs(s.validatingFields,ee))}),x.state.next({validatingFields:s.validatingFields,isValidating:!ln(s.validatingFields)}))},S=(z,Z=[],ee,he,ve=!0,ue=!0)=>{if(he&&ee){if(c.action=!0,ue&&Array.isArray(Te(r,z))){const Ce=ee(Te(r,z),he.argA,he.argB);ve&&Wt(r,z,Ce)}if(ue&&Array.isArray(Te(s.errors,z))){const Ce=ee(Te(s.errors,z),he.argA,he.argB);ve&&Wt(s.errors,z,Ce),X3(s.errors,z)}if(p.touchedFields&&ue&&Array.isArray(Te(s.touchedFields,z))){const Ce=ee(Te(s.touchedFields,z),he.argA,he.argB);ve&&Wt(s.touchedFields,z,Ce)}p.dirtyFields&&(s.dirtyFields=Ic(i,o)),x.state.next({name:z,isDirty:D(z,Z),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else Wt(o,z,Z)},E=(z,Z)=>{Wt(s.errors,z,Z),x.state.next({errors:s.errors})},T=z=>{s.errors=z,x.state.next({errors:s.errors,isValid:!1})},k=(z,Z,ee,he)=>{const ve=Te(r,z);if(ve){const ue=Te(o,z,ss(ee)?Te(i,z):ee);ss(ue)||he&&he.defaultChecked||Z?Wt(o,z,Z?ue:Nm(ve._f)):X(z,ue),c.mount&&y()}},M=(z,Z,ee,he,ve)=>{let ue=!1,Ce=!1;const Ue={name:z},Ze=!!(Te(r,z)&&Te(r,z)._f&&Te(r,z)._f.disabled);if(!ee||he){p.isDirty&&(Ce=s.isDirty,s.isDirty=Ue.isDirty=D(),ue=Ce!==Ue.isDirty);const it=Ze||Da(Te(i,z),Z);Ce=!!(!Ze&&Te(s.dirtyFields,z)),it||Ze?vs(s.dirtyFields,z):Wt(s.dirtyFields,z,!0),Ue.dirtyFields=s.dirtyFields,ue=ue||p.dirtyFields&&Ce!==!it}if(ee){const it=Te(s.touchedFields,z);it||(Wt(s.touchedFields,z,ee),Ue.touchedFields=s.touchedFields,ue=ue||p.touchedFields&&it!==ee)}return ue&&ve&&x.state.next(Ue),ue?Ue:{}},R=(z,Z,ee,he)=>{const ve=Te(s.errors,z),ue=p.isValid&&yr(Z)&&s.isValid!==Z;if(t.delayError&&ee?(u=b(()=>E(z,ee)),u(t.delayError)):(clearTimeout(m),u=null,ee?Wt(s.errors,z,ee):vs(s.errors,z)),(ee?!Da(ve,ee):ve)||!ln(he)||ue){const Ce={...he,...ue&&yr(Z)?{isValid:Z}:{},errors:s.errors,name:z};s={...s,...Ce},x.state.next(Ce)}},I=async z=>{N(z,!0);const Z=await n.resolver(o,n.context,q3(z||d.mount,r,n.criteriaMode,n.shouldUseNativeValidation));return N(z),Z},O=async z=>{const{errors:Z}=await I(z);if(z)for(const ee of z){const he=Te(Z,ee);he?Wt(s.errors,ee,he):vs(s.errors,ee)}else s.errors=Z;return Z},H=async(z,Z,ee={valid:!0})=>{for(const he in z){const ve=z[he];if(ve){const{_f:ue,...Ce}=ve;if(ue){const Ue=d.array.has(ue.name),Ze=ve._f&&Y3(ve._f);Ze&&p.validatingFields&&N([he],!0);const it=await yv(ve,o,j,n.shouldUseNativeValidation&&!Z,Ue);if(Ze&&p.validatingFields&&N([he]),it[ue.name]&&(ee.valid=!1,Z))break;!Z&&(Te(it,ue.name)?Ue?H3(s.errors,it,ue.name):Wt(s.errors,ue.name,it[ue.name]):vs(s.errors,ue.name))}!ln(Ce)&&await H(Ce,Z,ee)}}return ee.valid},$=()=>{for(const z of d.unMount){const Z=Te(r,z);Z&&(Z._f.refs?Z._f.refs.every(ee=>!wm(ee)):!wm(Z._f.ref))&&Me(z)}d.unMount=new Set},D=(z,Z)=>(z&&Z&&Wt(o,z,Z),!Da(oe(),i)),P=(z,Z,ee)=>B3(z,d,{...c.mount?o:ss(Z)?i:Nr(z)?{[z]:Z}:Z},ee,Z),K=z=>Fd(Te(c.mount?o:i,z,t.shouldUnregister?Te(i,z,[]):[])),X=(z,Z,ee={})=>{const he=Te(r,z);let ve=Z;if(he){const ue=he._f;ue&&(!ue.disabled&&Wt(o,z,Yj(Z,ue)),ve=sd(ue.ref)&&Ys(Z)?"":Z,Vj(ue.ref)?[...ue.ref.options].forEach(Ce=>Ce.selected=ve.includes(Ce.value)):ue.refs?Al(ue.ref)?ue.refs.length>1?ue.refs.forEach(Ce=>(!Ce.defaultChecked||!Ce.disabled)&&(Ce.checked=Array.isArray(ve)?!!ve.find(Ue=>Ue===Ce.value):ve===Ce.value)):ue.refs[0]&&(ue.refs[0].checked=!!ve):ue.refs.forEach(Ce=>Ce.checked=Ce.value===ve):xp(ue.ref)?ue.ref.value="":(ue.ref.value=ve,ue.ref.type||x.values.next({name:z,values:{...o}})))}(ee.shouldDirty||ee.shouldTouch)&&M(z,ve,ee.shouldTouch,ee.shouldDirty,!0),ee.shouldValidate&&ye(z)},G=(z,Z,ee)=>{for(const he in Z){const ve=Z[he],ue=`${z}.${he}`,Ce=Te(r,ue);(d.array.has(z)||!rd(ve)||Ce&&!Ce._f)&&!Ai(ve)?G(ue,ve,ee):X(ue,ve,ee)}},U=(z,Z,ee={})=>{const he=Te(r,z),ve=d.array.has(z),ue=On(Z);Wt(o,z,ue),ve?(x.array.next({name:z,values:{...o}}),(p.isDirty||p.dirtyFields)&&ee.shouldDirty&&x.state.next({name:z,dirtyFields:Ic(i,o),isDirty:D(z,ue)})):he&&!he._f&&!Ys(ue)?G(z,ue,ee):X(z,ue,ee),pv(z,d)&&x.state.next({...s}),x.values.next({name:c.mount?z:void 0,values:{...o}})},Y=async z=>{c.mount=!0;const Z=z.target;let ee=Z.name,he=!0;const ve=Te(r,ee),ue=()=>Z.type?Nm(ve._f):I3(z),Ce=Ue=>{he=Number.isNaN(Ue)||Da(Ue,Te(o,ee,Ue))};if(ve){let Ue,Ze;const it=ue(),fs=z.type===mv.BLUR||z.type===mv.FOCUS_OUT,pr=!K3(ve._f)&&!n.resolver&&!Te(s.errors,ee)&&!ve._f.deps||J3(fs,Te(s.touchedFields,ee),s.isSubmitted,v,g),Rs=pv(ee,d,fs);Wt(o,ee,it),fs?(ve._f.onBlur&&ve._f.onBlur(z),u&&u(0)):ve._f.onChange&&ve._f.onChange(z);const Sn=M(ee,it,fs,!1),fn=!ln(Sn)||Rs;if(!fs&&x.values.next({name:ee,type:z.type,values:{...o}}),pr)return p.isValid&&(t.mode==="onBlur"?fs&&y():y()),fn&&x.state.next({name:ee,...Rs?{}:Sn});if(!fs&&Rs&&x.state.next({...s}),n.resolver){const{errors:Ws}=await I([ee]);if(Ce(it),he){const Xt=jv(s.errors,r,ee),Ps=jv(Ws,r,Xt.name||ee);Ue=Ps.error,ee=Ps.name,Ze=ln(Ws)}}else N([ee],!0),Ue=(await yv(ve,o,j,n.shouldUseNativeValidation))[ee],N([ee]),Ce(it),he&&(Ue?Ze=!1:p.isValid&&(Ze=await H(r,!0)));he&&(ve._f.deps&&ye(ve._f.deps),R(ee,Ze,Ue,Sn))}},ae=(z,Z)=>{if(Te(s.errors,Z)&&z.focus)return z.focus(),1},ye=async(z,Z={})=>{let ee,he;const ve=Fc(z);if(n.resolver){const ue=await O(ss(z)?z:ve);ee=ln(ue),he=z?!ve.some(Ce=>Te(ue,Ce)):ee}else z?(he=(await Promise.all(ve.map(async ue=>{const Ce=Te(r,ue);return await H(Ce&&Ce._f?{[ue]:Ce}:Ce)}))).every(Boolean),!(!he&&!s.isValid)&&y()):he=ee=await H(r);return x.state.next({...!Nr(z)||p.isValid&&ee!==s.isValid?{}:{name:z},...n.resolver||!z?{isValid:ee}:{},errors:s.errors}),Z.shouldFocus&&!he&&qo(r,ae,z?ve:d.mount),he},oe=z=>{const Z={...c.mount?o:i};return ss(z)?Z:Nr(z)?Te(Z,z):z.map(ee=>Te(Z,ee))},me=(z,Z)=>({invalid:!!Te((Z||s).errors,z),isDirty:!!Te((Z||s).dirtyFields,z),error:Te((Z||s).errors,z),isValidating:!!Te(s.validatingFields,z),isTouched:!!Te((Z||s).touchedFields,z)}),W=z=>{z&&Fc(z).forEach(Z=>vs(s.errors,Z)),x.state.next({errors:z?s.errors:{}})},se=(z,Z,ee)=>{const he=(Te(r,z,{_f:{}})._f||{}).ref,ve=Te(s.errors,z)||{},{ref:ue,message:Ce,type:Ue,...Ze}=ve;Wt(s.errors,z,{...Ze,...Z,ref:he}),x.state.next({name:z,errors:s.errors,isValid:!1}),ee&&ee.shouldFocus&&he&&he.focus&&he.focus()},ge=(z,Z)=>na(z)?x.values.subscribe({next:ee=>z(P(void 0,Z),ee)}):P(z,Z,!0),Me=(z,Z={})=>{for(const ee of z?Fc(z):d.mount)d.mount.delete(ee),d.array.delete(ee),Z.keepValue||(vs(r,ee),vs(o,ee)),!Z.keepError&&vs(s.errors,ee),!Z.keepDirty&&vs(s.dirtyFields,ee),!Z.keepTouched&&vs(s.touchedFields,ee),!Z.keepIsValidating&&vs(s.validatingFields,ee),!n.shouldUnregister&&!Z.keepDefaultValue&&vs(i,ee);x.values.next({values:{...o}}),x.state.next({...s,...Z.keepDirty?{isDirty:D()}:{}}),!Z.keepIsValid&&y()},pe=({disabled:z,name:Z,field:ee,fields:he,value:ve})=>{if(yr(z)&&c.mount||z){const ue=z?void 0:ss(ve)?Nm(ee?ee._f:Te(he,Z)._f):ve;Wt(o,Z,ue),M(Z,ue,!1,!1,!0)}},_e=(z,Z={})=>{let ee=Te(r,z);const he=yr(Z.disabled)||yr(t.disabled);return Wt(r,z,{...ee||{},_f:{...ee&&ee._f?ee._f:{ref:{name:z}},name:z,mount:!0,...Z}}),d.mount.add(z),ee?pe({field:ee,disabled:yr(Z.disabled)?Z.disabled:t.disabled,name:z,value:Z.value}):k(z,!0,Z.value),{...he?{disabled:Z.disabled||t.disabled}:{},...n.progressive?{required:!!Z.required,min:Mo(Z.min),max:Mo(Z.max),minLength:Mo(Z.minLength),maxLength:Mo(Z.maxLength),pattern:Mo(Z.pattern)}:{},name:z,onChange:Y,onBlur:Y,ref:ve=>{if(ve){_e(z,Z),ee=Te(r,z);const ue=ss(ve.value)&&ve.querySelectorAll&&ve.querySelectorAll("input,select,textarea")[0]||ve,Ce=G3(ue),Ue=ee._f.refs||[];if(Ce?Ue.find(Ze=>Ze===ue):ue===ee._f.ref)return;Wt(r,z,{_f:{...ee._f,...Ce?{refs:[...Ue.filter(wm),ue,...Array.isArray(Te(i,z))?[{}]:[]],ref:{type:ue.type,name:z}}:{ref:ue}}}),k(z,!1,void 0,ue)}else ee=Te(r,z,{}),ee._f&&(ee._f.mount=!1),(n.shouldUnregister||Z.shouldUnregister)&&!(M3(d.array,z)&&c.action)&&d.unMount.add(z)}}},We=()=>n.shouldFocusError&&qo(r,ae,d.mount),Pe=z=>{yr(z)&&(x.state.next({disabled:z}),qo(r,(Z,ee)=>{const he=Te(r,ee);he&&(Z.disabled=he._f.disabled||z,Array.isArray(he._f.refs)&&he._f.refs.forEach(ve=>{ve.disabled=he._f.disabled||z}))},0,!1))},Le=(z,Z)=>async ee=>{let he;ee&&(ee.preventDefault&&ee.preventDefault(),ee.persist&&ee.persist());let ve=On(o);if(x.state.next({isSubmitting:!0}),n.resolver){const{errors:ue,values:Ce}=await I();s.errors=ue,ve=Ce}else await H(r);if(vs(s.errors,"root"),ln(s.errors)){x.state.next({errors:{}});try{await z(ve,ee)}catch(ue){he=ue}}else Z&&await Z({...s.errors},ee),We(),setTimeout(We);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ln(s.errors)&&!he,submitCount:s.submitCount+1,errors:s.errors}),he)throw he},le=(z,Z={})=>{Te(r,z)&&(ss(Z.defaultValue)?U(z,On(Te(i,z))):(U(z,Z.defaultValue),Wt(i,z,On(Z.defaultValue))),Z.keepTouched||vs(s.touchedFields,z),Z.keepDirty||(vs(s.dirtyFields,z),s.isDirty=Z.defaultValue?D(z,On(Te(i,z))):D()),Z.keepError||(vs(s.errors,z),p.isValid&&y()),x.state.next({...s}))},Re=(z,Z={})=>{const ee=z?On(z):i,he=On(ee),ve=ln(z),ue=ve?i:he;if(Z.keepDefaultValues||(i=ee),!Z.keepValues){if(Z.keepDirtyValues)for(const Ce of d.mount)Te(s.dirtyFields,Ce)?Wt(ue,Ce,Te(o,Ce)):U(Ce,Te(ue,Ce));else{if(pp&&ss(z))for(const Ce of d.mount){const Ue=Te(r,Ce);if(Ue&&Ue._f){const Ze=Array.isArray(Ue._f.refs)?Ue._f.refs[0]:Ue._f.ref;if(sd(Ze)){const it=Ze.closest("form");if(it){it.reset();break}}}}r={}}o=t.shouldUnregister?Z.keepDefaultValues?On(i):{}:On(ue),x.array.next({values:{...ue}}),x.values.next({values:{...ue}})}d={mount:Z.keepDirtyValues?d.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!p.isValid||!!Z.keepIsValid||!!Z.keepDirtyValues,c.watch=!!t.shouldUnregister,x.state.next({submitCount:Z.keepSubmitCount?s.submitCount:0,isDirty:ve?!1:Z.keepDirty?s.isDirty:!!(Z.keepDefaultValues&&!Da(z,i)),isSubmitted:Z.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:ve?{}:Z.keepDirtyValues?Z.keepDefaultValues&&o?Ic(i,o):s.dirtyFields:Z.keepDefaultValues&&z?Ic(i,z):Z.keepDirty?s.dirtyFields:{},touchedFields:Z.keepTouched?s.touchedFields:{},errors:Z.keepErrors?s.errors:{},isSubmitSuccessful:Z.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1})},Ke=(z,Z)=>Re(na(z)?z(o):z,Z);return{control:{register:_e,unregister:Me,getFieldState:me,handleSubmit:Le,setError:se,_executeSchema:I,_getWatch:P,_getDirty:D,_updateValid:y,_removeUnmounted:$,_updateFieldArray:S,_updateDisabledField:pe,_getFieldArray:K,_reset:Re,_resetDefaultValues:()=>na(n.defaultValues)&&n.defaultValues().then(z=>{Ke(z,n.resetOptions),x.state.next({isLoading:!1})}),_updateFormState:z=>{s={...s,...z}},_disableForm:Pe,_subjects:x,_proxyFormState:p,_setErrors:T,get _fields(){return r},get _formValues(){return o},get _state(){return c},set _state(z){c=z},get _defaultValues(){return i},get _names(){return d},set _names(z){d=z},get _formState(){return s},set _formState(z){s=z},get _options(){return n},set _options(z){n={...n,...z}}},trigger:ye,register:_e,handleSubmit:Le,watch:ge,setValue:U,getValues:oe,reset:Ke,resetField:le,clearErrors:W,unregister:Me,setError:se,setFocus:(z,Z={})=>{const ee=Te(r,z),he=ee&&ee._f;if(he){const ve=he.refs?he.refs[0]:he.ref;ve.focus&&(ve.focus(),Z.shouldSelect&&ve.select())}},getFieldState:me}}function e$(t={}){const n=ne.useRef(),s=ne.useRef(),[r,i]=ne.useState({isDirty:!1,isValidating:!1,isLoading:na(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,defaultValues:na(t.defaultValues)?void 0:t.defaultValues});n.current||(n.current={...Q3(t),formState:r});const o=n.current.control;return o._options=t,F3({subject:o._subjects.state,next:c=>{z3(c,o._proxyFormState,o._updateFormState)&&i({...o._formState})}}),ne.useEffect(()=>o._disableForm(t.disabled),[o,t.disabled]),ne.useEffect(()=>{if(o._proxyFormState.isDirty){const c=o._getDirty();c!==r.isDirty&&o._subjects.state.next({isDirty:c})}},[o,r.isDirty]),ne.useEffect(()=>{t.values&&!Da(t.values,s.current)?(o._reset(t.values,o._options.resetOptions),s.current=t.values,i(c=>({...c}))):o._resetDefaultValues()},[t.values,o]),ne.useEffect(()=>{t.errors&&o._setErrors(t.errors)},[t.errors,o]),ne.useEffect(()=>{o._state.mount||(o._updateValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),ne.useEffect(()=>{t.shouldUnregister&&o._subjects.values.next({values:o._getWatch()})},[t.shouldUnregister,o]),n.current.formState=$3(r,o),n.current}const t$={"--background":"0 0% 100%","--foreground":"222.2 84% 4.9%","--card":"0 0% 100%","--card-foreground":"222.2 84% 4.9%","--popover":"0 0% 100%","--popover-foreground":"222.2 84% 4.9%","--primary":"262.1 83.3% 57.8%","--primary-foreground":"210 40% 98%","--secondary":"220 14.3% 95.9%","--secondary-foreground":"222.2 47.4% 11.2%","--muted":"220 14.3% 95.9%","--muted-foreground":"220 8.9% 46.1%","--accent":"220 14.3% 95.9%","--accent-foreground":"222.2 47.4% 11.2%","--destructive":"0 84.2% 60.2%","--destructive-foreground":"210 40% 98%","--border":"220 13% 91%","--input":"220 13% 91%","--ring":"262.1 83.3% 57.8%","--radius":"0.75rem","--chart-1":"262.1 83.3% 57.8%","--chart-2":"173 58% 39%","--chart-3":"197 37% 24%","--chart-4":"43 74% 66%","--chart-5":"27 87% 67%","--desktop-nav-width":"64px","--font-family":"system-ui, sans-serif"},s$={"--background":"0 0% 100%","--foreground":"222.2 84% 4.9%","--primary":"212 100% 50%","--primary-foreground":"210 40% 98%","--secondary":"220 14% 95%","--secondary-foreground":"222.2 47.4% 11.2%","--muted":"220 14.3% 95.9%","--muted-foreground":"220 8.9% 46.1%","--accent":"212 100% 50%","--accent-foreground":"210 40% 98%","--border":"220 13% 91%","--input":"220 13% 91%","--ring":"212 100% 60%","--font-family":"'Menlo', 'Courier New', monospace"},wv={default:t$,programmer:s$},Kj=f.createContext(null),n$=()=>{const t=f.useContext(Kj);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t},r$=({children:t,defaultTheme:n="default"})=>{const{user:s}=He(),[r,i]=f.useState(n);return f.useEffect(()=>{if(!s)return;const o=be(fe,"settings",s.uid);return ns(o,d=>{const u=d.data();i((u==null?void 0:u.theme)||n)})},[s,n]),f.useEffect(()=>{const o=wv[r]||wv[n];if(Object.entries(o).forEach(([c,d])=>{document.documentElement.style.setProperty(c,d)}),s){const c=be(fe,"settings",s.uid);ht(c,{userId:s.uid,theme:r},{merge:!0}).catch(console.error)}},[r,s,n]),e.jsx(Kj.Provider,{value:{theme:r,setTheme:i},children:t})};function a$(){const{user:t}=He(),[n,s]=f.useState(null);return f.useEffect(()=>{if(!t)return;const i=be(fe,"settings",t.uid);return ns(i,c=>{s(c.data())})},[t]),{settings:n,saveSettings:async i=>{if(!t)return;const o=be(fe,"settings",t.uid);await ht(o,{userId:t.uid,...i},{merge:!0})}}}const i$=()=>{const{settings:t,saveSettings:n}=a$(),{setTheme:s}=n$(),{register:r,handleSubmit:i,reset:o}=e$();f.useEffect(()=>{t&&o(t)},[t,o]);const c=async d=>{await n(d),d.theme&&s(d.theme)};return e.jsx(Ss,{children:e.jsxs("div",{className:"space-y-4 max-w-md",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Perfil"}),e.jsxs("form",{onSubmit:i(c),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"name",children:"Nombre"}),e.jsx(Ve,{id:"name",...r("name")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"birthDate",children:"Fecha de nacimiento"}),e.jsx(Ve,{id:"birthDate",type:"date",...r("birthDate")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ye,{htmlFor:"theme",children:"Tema"}),e.jsxs("select",{id:"theme",className:"border rounded-md p-2",...r("theme"),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"programmer",children:"Programador Claro"})]})]}),e.jsx(F,{type:"submit",children:"Guardar"})]})]})})},o$=({taskId:t,onComplete:n})=>{const[s,r]=f.useState(0),[i,o]=f.useState(!1),[c,d]=f.useState(!1),[u,m]=f.useState(null),[p,x]=f.useState(0),[g,v]=f.useState(null),j=f.useRef(),b=f.useRef(),y=f.useRef(!1),N=f.useCallback(()=>{j.current&&(clearInterval(j.current),j.current=void 0),b.current&&(clearInterval(b.current),b.current=void 0)},[]),S=f.useCallback(()=>{if(!i||c||!u)return p;const O=Date.now(),H=Math.floor((O-u)/1e3);return p+H},[i,c,u,p]);f.useEffect(()=>{if(!i||c){N();return}return j.current=setInterval(()=>{r(S())},1e3),N},[i,c,S,N]),f.useEffect(()=>((async()=>{try{Gt.logRead("tasks","useTaskTimer.loadTaskData",t);const H=be(fe,"tasks",t),$=await ds(H);if(!$.exists())return;const D=$.data();if(o(D.timerActive||!1),d(D.timerPaused||!1),x(D.elapsedSeconds||0),v({title:D.title||"",description:D.description||""}),D.timerActive&&!D.timerPaused&&D.timerStartTime){const P=Date.now(),K=Math.floor((P-D.timerStartTime.timestamp)/1e3);m(P-K*1e3),r(D.elapsedSeconds||0)}else m(null),r(D.elapsedSeconds||0)}catch(H){console.error("Error loading task data:",H)}})(),N),[t,N]),f.useEffect(()=>{if(!i||c||y.current){b.current&&(clearInterval(b.current),b.current=void 0);return}return b.current=setInterval(async()=>{try{const O=S();Gt.logWrite("tasks","useTaskTimer.autoSave",t),await jn(be(fe,"tasks",t),{elapsedSeconds:O}),x(O)}catch(O){console.error("Error saving timer progress:",O)}},3e4),()=>{b.current&&(clearInterval(b.current),b.current=void 0)}},[i,c,t,S]);const E=f.useCallback(async()=>{if(!(i||y.current)){y.current=!0;try{const O=Date.now(),H=new Date,$=ks(H,H.getHours(),H.getMinutes());o(!0),d(!1),m(O),Gt.logWrite("tasks","useTaskTimer.startTimer",t),await jn(be(fe,"tasks",t),{timerStartTime:$,timerActive:!0,timerPaused:!1,pausedDuration:0})}catch(O){console.error("Error starting timer:",O),o(!1),m(null)}finally{y.current=!1}}},[i,t]),T=f.useCallback(async()=>{if(!(!i||c||y.current)){y.current=!0;try{const O=S();d(!0),x(O),Gt.logWrite("tasks","useTaskTimer.pauseTimer",t),await jn(be(fe,"tasks",t),{elapsedSeconds:O,timerPaused:!0})}catch(O){console.error("Error pausing timer:",O),d(!1)}finally{y.current=!1}}},[i,c,t,S]),k=f.useCallback(async()=>{if(!(!i||!c||y.current)){y.current=!0;try{const O=Date.now(),H=new Date,$=ks(H,H.getHours(),H.getMinutes());d(!1),m(O),Gt.logWrite("tasks","useTaskTimer.resumeTimer",t),await jn(be(fe,"tasks",t),{timerStartTime:$,timerPaused:!1})}catch(O){console.error("Error resuming timer:",O),d(!0)}finally{y.current=!1}}},[i,c,t]),M=f.useCallback(async()=>{if(!(!i||y.current)){y.current=!0;try{const O=S();o(!1),d(!1),m(null),x(O),r(O),Gt.logWrite("tasks","useTaskTimer.stopTimer",t),await jn(be(fe,"tasks",t),{elapsedSeconds:O,timerActive:!1,timerPaused:!1,timerStartTime:null})}catch(O){console.error("Error stopping timer:",O),o(!0)}finally{y.current=!1}}},[i,t,S]),R=f.useCallback(async()=>{if(!y.current){y.current=!0;try{const O=S();o(!1),d(!1),m(null),x(O),r(O),Gt.logWrite("tasks","useTaskTimer.completeTask",t),await jn(be(fe,"tasks",t),{completed:!0,elapsedSeconds:O,timerActive:!1,timerPaused:!1,timerStartTime:null,progress:100}),n(O)}catch(O){console.error("Error completing task:",O)}finally{y.current=!1}}},[t,S,n]);return{time:s,isActive:i,isPaused:c,formattedTime:(O=>{const H=Math.floor(O/3600),$=Math.floor(O%3600/60),D=O%60;return[H,$,D].map(K=>String(K).padStart(2,"0")).join(":")})(s),taskData:g,startTimer:E,pauseTimer:T,resumeTimer:k,stopTimer:M,completeTask:R}},l$=t=>{const n=t.split(`
`),s=[],r=[];for(const i of n){const o=i.match(/^\s*- \[( |x|X)\] ?(.*)/);o?r.push({text:o[2],checked:o[1].toLowerCase()==="x"}):s.push(i)}return{body:s.join(`
`),checklist:r}},c$=(t,n)=>{const s=t?t.split(`
`):[],r=n.map(i=>`- [${i.checked?"x":" "}] ${i.text}`);return[...s,...r].join(`
`).trim()},d$=t=>{const n=["bg-gradient-to-br from-slate-800 via-slate-900 to-black","bg-gradient-to-br from-blue-900 via-blue-950 to-slate-900","bg-gradient-to-br from-indigo-900 via-purple-900 to-slate-900","bg-gradient-to-br from-emerald-900 via-teal-900 to-slate-900","bg-gradient-to-br from-purple-900 via-indigo-900 to-slate-900","bg-gradient-to-br from-teal-900 via-cyan-900 to-slate-900","bg-gradient-to-br from-gray-900 via-slate-900 to-zinc-900","bg-gradient-to-br from-neutral-900 via-gray-900 to-black","bg-gradient-to-br from-stone-900 via-neutral-900 to-slate-900","bg-gradient-to-br from-zinc-900 via-gray-900 to-black"];let s=0;if(t)for(let i=0;i<t.length;i++){const o=t.charCodeAt(i);s=(s<<5)-s+o,s=s&s}const r=Math.abs(s)%n.length;return n[r]};function u$(){const{taskId:t}=rD(),n=qi(),{formattedTime:s,isActive:r,isPaused:i,taskData:o,startTimer:c,pauseTimer:d,resumeTimer:u,stopTimer:m,completeTask:p}=o$({taskId:t,onComplete:()=>n(-1)}),{body:x,checklist:g}=f.useMemo(()=>l$((o==null?void 0:o.description)||""),[o==null?void 0:o.description]),v=f.useMemo(()=>d$(t||""),[t]),j=async b=>{const y=g.map((S,E)=>E===b?{...S,checked:!S.checked}:S),N=c$(x,y);await jn(be(fe,"tasks",t),{description:N,progress:zo(N)})};return e.jsx("div",{className:`min-h-screen flex flex-col items-center ${v} text-white p-6`,children:e.jsxs("div",{className:"w-full max-w-4xl space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(F,{variant:"ghost",className:"text-white hover:bg-white/20 text-lg font-semibold drop-shadow-lg px-6 py-3",onClick:()=>n(-1),children:"← Volver"}),e.jsx("div",{className:"text-4xl font-mono font-bold drop-shadow-xl bg-black/30 px-6 py-2 rounded-lg backdrop-blur-sm border border-white/20",children:s})]}),e.jsx("h1",{className:"text-5xl font-bold break-words drop-shadow-xl text-center leading-tight",children:(o==null?void 0:o.title)||""}),x&&e.jsx("div",{className:"prose prose-xl max-w-none text-white drop-shadow-md prose-headings:drop-shadow-lg prose-headings:text-white prose-p:text-white prose-strong:text-white prose-em:text-white",dangerouslySetInnerHTML:{__html:Qb(x)}}),g.length>0&&e.jsx("div",{className:"space-y-6",children:g.map((b,y)=>e.jsxs("label",{className:"flex items-center space-x-4 text-2xl bg-black/20 p-4 rounded-lg backdrop-blur-sm",children:[e.jsx(As,{checked:b.checked,onCheckedChange:()=>j(y),className:"scale-125"}),e.jsx("span",{className:"select-none drop-shadow-md font-medium",children:b.text})]},y))}),e.jsxs("div",{className:"flex flex-col gap-6 mt-12",children:[e.jsx("div",{className:"flex gap-4 justify-center",children:r?e.jsxs(e.Fragment,{children:[i?e.jsxs(F,{onClick:u,className:"bg-green-700 hover:bg-green-800 text-white px-8 py-4 text-xl font-semibold shadow-xl drop-shadow-lg border border-green-600",children:[e.jsx(Xo,{className:"w-6 h-6 mr-3"}),"Reanudar"]}):e.jsxs(F,{onClick:d,className:"bg-amber-600 hover:bg-amber-700 text-white px-8 py-4 text-xl font-semibold shadow-xl drop-shadow-lg border border-amber-500",children:[e.jsx(T_,{className:"w-6 h-6 mr-3"}),"Pausar"]}),e.jsxs(F,{onClick:m,className:"bg-red-700 hover:bg-red-800 text-white px-8 py-4 text-xl font-semibold shadow-xl drop-shadow-lg border border-red-600",children:[e.jsx(Gv,{className:"w-6 h-6 mr-3"}),"Detener"]})]}):e.jsxs(F,{onClick:c,className:"bg-green-700 hover:bg-green-800 text-white px-8 py-4 text-xl font-semibold shadow-xl drop-shadow-lg border border-green-600",children:[e.jsx(Xo,{className:"w-6 h-6 mr-3"}),"Iniciar"]})}),e.jsxs(Sd,{children:[e.jsx(Af,{asChild:!0,children:e.jsxs(F,{className:"bg-blue-700 hover:bg-blue-800 text-white px-8 py-4 text-xl font-semibold w-full shadow-xl drop-shadow-lg border border-blue-600",children:[e.jsx(dd,{className:"w-6 h-6 mr-3"}),"Completar Tarea"]})}),e.jsxs(xl,{children:[e.jsxs(gl,{children:[e.jsx(yl,{children:"Completar Tarea"}),e.jsx(bl,{children:"¿Estás seguro de que quieres completar esta tarea? El timer se detendrá automáticamente y la tarea será marcada como completada."})]}),e.jsxs(vl,{children:[e.jsx(wl,{children:"Cancelar"}),e.jsx(jl,{onClick:p,className:"bg-blue-600 hover:bg-blue-700",children:"Sí, completar"})]})]})]})]})]})})}function m$(){return e.jsxs(jD,{children:[e.jsxs(gs,{path:"/",element:e.jsx(P2,{}),children:[e.jsx(gs,{index:!0,element:e.jsx(N5,{})}),e.jsx(gs,{path:"habit",element:e.jsx(nL,{})}),e.jsx(gs,{path:"task",element:e.jsx(Nj,{})}),e.jsx(gs,{path:"kanban",element:e.jsx(sL,{})}),e.jsx(gs,{path:"journal",element:e.jsx(tL,{})}),e.jsx(gs,{path:"mood",element:e.jsx(X5,{})}),e.jsx(gs,{path:"water",element:e.jsx(K5,{})}),e.jsx(gs,{path:"pomodoro",element:e.jsx(J5,{})}),e.jsx(gs,{path:"exercise",element:e.jsx(r3,{})}),e.jsx(gs,{path:"negative",element:e.jsx(N3,{})}),e.jsx(gs,{path:"stats",element:e.jsx(P3,{})}),e.jsx(gs,{path:"meal",element:e.jsx(SL,{})}),e.jsx(gs,{path:"shopping-list",element:e.jsx(UL,{})}),e.jsx(gs,{path:"recipes",element:e.jsx(YL,{})}),e.jsx(gs,{path:"prepared-meals",element:e.jsx(XL,{})}),e.jsx(gs,{path:"settings",element:e.jsx(i$,{})})]}),e.jsx(gs,{path:"task/:taskId/run",element:e.jsx(u$,{})})]})}"serviceWorker"in navigator&&ID({onNeedRefresh(){window.dispatchEvent(new CustomEvent("sw-update-available"))},onOfflineReady(){console.log("La aplicación está lista para usar sin conexión"),window.dispatchEvent(new CustomEvent("sw-offline-ready"))},onRegisterError(t){console.warn("Error al registrar el service worker:",t)},immediate:!0});km.createRoot(document.getElementById("root")).render(e.jsx(ne.StrictMode,{children:e.jsx(kD,{basename:"/life-tracker",children:e.jsx(r$,{children:e.jsx(m$,{})})})}));export{F as B,je as C,dn as D,ca as P,Mt as a,Lt as b,we as c,k3 as d,ce as e,dr as g,k$ as u};
